warning: type `ParseContext<'a>` is more private than the item `parse_program`
   --> crates/stonescript-parser/src/parser.rs:719:1
    |
719 | pub fn parse_program<'a>(input: &'a str, ctx: &ParseContext<'a>) -> IResult<&'a str, Program> {
    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ function `parse_program` is reachable at visibility `pub`
    |
note: but type `ParseContext<'a>` is only usable at visibility `pub(self)`
   --> crates/stonescript-parser/src/parser.rs:17:1
    |
 17 | struct ParseContext<'a> {
    | ^^^^^^^^^^^^^^^^^^^^^^^
    = note: `#[warn(private_interfaces)]` on by default

warning: `stonescript-parser` (lib) generated 1 warning
warning: type `parser::ParseContext<'a>` is more private than the item `parse_program`
   --> crates/stonescript-parser/src/parser.rs:719:1
    |
719 | pub fn parse_program<'a>(input: &'a str, ctx: &ParseContext<'a>) -> IResult<&'a str, Program> {
    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ function `parse_program` is reachable at visibility `pub`
    |
note: but type `parser::ParseContext<'a>` is only usable at visibility `pub(self)`
   --> crates/stonescript-parser/src/parser.rs:17:1
    |
 17 | struct ParseContext<'a> {
    | ^^^^^^^^^^^^^^^^^^^^^^^
    = note: `#[warn(private_interfaces)]` on by default

warning: `stonescript-parser` (lib test) generated 1 warning
    Finished `test` profile [unoptimized + debuginfo] target(s) in 0.01s
     Running unittests src/lib.rs (target/debug/deps/stonescript_parser-2761671103a76f83)

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 13 filtered out; finished in 0.00s

     Running tests/integration_test.rs (target/debug/deps/integration_test-aa327612311209e2)

running 1 test

Parsing StoneScript files from: "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/DragController.txt" - Parse error: Failed to parse completely. Remaining: "= []\r\nvar draggablesX = []\r\nvar draggablesY = []\r\nvar draggablesCanDrag = []\r\nvar ix\r\nvar iy\r\nvar oldix\r\nvar oldiy\r\nvar curIndex\r\nvar touched = false\r\nvar screenw = screen.w\r\nvar screenh = screen.h\r\nvar hasCleared = false\r\n\r\n\r\n//--Public Functions\r\n//Adds component to the array of tracked draggables.\r\nfunc Add(comp)\r\n  ?!hasCleared & loc.loop\r\n    draggables.Clear()\r\n    hasCleared=true\r\n  ?draggables.Contains(comp)\r\n    return\r\n    \r\n  draggables.Add(comp)\r\n  var index = draggables.Count()-1\r\n  ?draggablesX.Count() >= draggables.Count()\r\n    ?keepPos\r\n      comp.x = draggablesX[index]\r\n      comp.y = draggablesY[index]\r\n  :\r\n    draggablesCanDrag.Add(true)\r\n    draggablesX.Add(comp.x)\r\n    draggablesY.Add(comp.y)\r\n  \r\n//Removes component from array of draggables, it will no longer be tracked\r\nfunc Remove(comp)\r\n  var index = draggables.IndexOf(comp)\r\n  ?index ! -1\r\n    draggables.RemoveAt(index)\r\n    draggablesX.RemoveAt(index)\r\n    draggablesY.RemoveAt(index)\r\n    draggablesCanDrag.RemoveAt(index)\r\n\r\n//Clears all draggables, for use if you want a full reset mid-run\r\nfunc Clear()\r\n  draggables.Clear()\r\n  draggablesX.Clear()\r\n  draggablesY.Clear()\r\n  draggablesCanDrag.Clear()\r\n  \r\n//Changes in which order the components will be dragged if they overlap,\r\n//as if you had called Add(comp) in a different order.\r\n//Highest index is the priority when picking a component to move.\r\n//Components added later will be on top.\r\n//Note: can mix up position after loop.\r\nfunc SetIndex(comp,index)\r\n  var oldindex = draggables.IndexOf(comp)\r\n  ?oldindex ! -1\r\n    var tCanDrg = draggablesCanDrag[oldindex]\r\n    Remove(comp)\r\n    ?index < 0\r\n      draggables.Insert(0,comp)\r\n      draggablesCanDrag.Insert(0,tCanDrg)\r\n      draggablesX.Insert(0,comp.x)\r\n      draggablesY.Insert(0,comp.y)\r\n    :?index < draggables.Count()\r\n      draggables.Insert(index,comp)\r\n      draggablesCanDrag.Insert(index,tCanDrg)\r\n      draggablesX.Insert(index,comp.x)\r\n      draggablesY.Insert(index,comp.y)\r\n    :\r\n      draggables.Add(comp)\r\n      draggablesCanDrag.Add(tCanDrg)\r\n      draggablesX.Add(comp.x)\r\n      draggablesY.Add(comp.y)\r\n      \r\n//Get index of component, for use with SetIndex\r\nfunc GetIndex(comp)\r\n  return draggables.IndexOf(comp)\r\n  \r\n//Enables/Disables dragging for a single component.\r\n//true to enable drag, false to disable.\r\nfunc CanDrag(comp,bool)\r\n  var index = draggables.IndexOf(comp)\r\n  ?index ! -1\r\n    ?bool\r\n      draggablesCanDrag[index] = true\r\n    :\r\n      draggablesCanDrag[index] = false\r\n\r\n//Checks for drag and updates component position\r\nfunc Update()\r\n  var key_ = key\r\n  ?hasCleared\r\n    hasCleared = false\r\n  ?key_ = primary\r\n    ix = clamp(input.x,0,screenw-1)\r\n    iy = clamp(input.y,0,screenh-1)\r\n    ?key_ = primaryBegin\r\n      touched = false\r\n      ?draggables.Count() ! 0\r\n        for i = (draggables.Count()-1)..0\r\n          ?draggables[i].parent = null\r\n            Remove(draggables[i])\r\n          :?touching(draggables[i],ix,iy) &\r\n          ^draggablesCanDrag[i]\r\n            curIndex = i\r\n            touched = true\r\n            break\r\n      ?touched\r\n        oldix = ix\r\n        oldiy = iy\r\n    ?touched & (key_ = primaryEnd |\r\n    ^draggablesCanDrag[curIndex] = false)\r\n      draggablesX[curIndex] =\r\n      ^draggables[curIndex].x\r\n      draggablesY[curIndex] =\r\n      ^draggables[curIndex].y\r\n      touched = false\r\n    :?touched\r\n      draggables[curIndex].x += ix-oldix\r\n      draggables[curIndex].y += iy-oldiy\r\n      oldix = ix\r\n      oldiy = iy\r\n\r\n//--Internal Functions\r\n//Checks if X and Y are touching the component\r\n//Relative to top left of the screen\r\nfunc touching(comp,x,y)\r\n  ?x = null\r\n    x = clamp(input.x,0,screenw-1)\r\n  ?y = null\r\n    y = clamp(input.y,0,screenh-1)\r\n  var compx = comp.absoluteX\r\n  var compy = comp.absoluteY\r\n  var w = comp.w\r\n  var h = comp.h\r\n  ?x >= compx &\r\n  ^x < (compx + w) &\r\n  ^y >= compy &\r\n  ^y < (compy + h)\r\n    return true\r\n  :\r\n    return false\r\n//Stonescript math.clamp for better performance.\r\nfunc clamp(num,min,max)\r\n  ?num < min\r\n    return min\r\n  ?num > max\r\n    return max\r\n  return num"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/BetterText.txt" - Parse error: Failed to parse completely. Remaining: "= \"You forgot to change the text, that sounds like a skill issue\"\r\nvar CurrentText = \"\"\r\nvar width = 14\r\nvar height = 3\r\nvar x = 0\r\nvar y = 0\r\nvar i = 1\r\nvar color = #white\r\nvar drag = import UI/DragController\r\n?totaltime = 1\r\n  talkBox = ui.AddText(CurrentText)\r\n  talkBox.w = width\r\n  talkBox.h = height\r\n  talkBox.x = x\r\n  talkBox.y = y\r\n  talkBox.color = color\r\n  drag.Add(talkBox)\r\nfunc UpdateVariables()\r\n talkBox.x = x\r\n talkBox.y = y\r\n talkBox.w = width\r\n talkBox.h = height\r\n talkBox.color = color\r\ndrag.Update()\r\nfunc Update()\r\n  CurrentText = string.Sub(FinishingText, 0, i)\r\n  talkBox.text = CurrentText\r\n  ?i < string.Size(FinishingText)\r\n   i++\r\nfunc ShowText()\r\n  talkBox.visible = true\r\nfunc HideText()\r\n  talkBox.visible = false\r\nfunc Reset()\r\n UpdateVariables()\r\n CurrentText = \"\"\r\n i = 1"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/InfoFloat.txt" - Parse error: Failed to parse completely. Remaining: "(＂x＂,0)\nvar yi = storage.get(＂y＂,0)\nvar Kill = storage.get(＂Kill＂,0)\nvar f\nf = foe\n\nvar BKill = storage.get(＂Bkill＂,0)\nvar FC = 0\n?FC>foe.getcount(100000)\n Kill = Kill + (FC-foe.getcount(100000))\n storage.set(＂Kill＂,Kill)\n ?foe = boss & foe = Phase2 = !Pallas\n  BKill = BKill + (FC-foe.getcount(100000))\n  storage.set(＂Bkill＂,BKill)\nFC = foe.getcount(100000)\n\n\n\nvar color = #ffffff\nvar delay = 30\n?input.x >= xi-2 & input.x <= xi+36\n ?input.y >= yi & input.y <= yi+11\n  delay--\n\n?delay < 0\n  xi = input.x\n  yi = input.y\n  color = #00FF00\n  storage.set(＂y＂,yi)\n  storage.set(＂x＂,xi)\n?key = Primary = false\n delay = 30\n storage.set(＂y＂,yi)\n storage.set(＂x＂,xi)\n color = #ffffff\n\nvar Borde = ［ascii\n+-----------------------------------+\n|###################################|\n|#################                  |\n|##################                 |\n|##############                     |\n|##############                     |\n|###########                        |\n|###################################|\n|###################                |\n|#################                  |\n+-----------------------------------+\nasciiend］\n>`@xi@,@yi@,Player Name: @player.name@\\n\n^Treasure: @item.GetTreasureCount()@/\n^@item.GetTreasureLimit()@\\n\n^Foe Damage: @foe.damage@\\n\n^Foe Dist: @foe.distance@ \\n\n^Foe State: @foe.state@ \\n\n^Time: @time@\\n\n^Best Time:@loc.besttime@ | Average Time:@loc\n^.averagetime@\\n\n^Total Kills: @Kill@\\n\n^Boss Kill: @BKill@\\n\n\n>`@xi-1@,@yi-1@,@color@,@Borde［0］@"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/PefWindow.txt" - Parse error: Failed to parse completely. Remaining: "= \"Button\"\r\nvar expand_mode = \"Static\"\r\nvar title = Title\r\nvar width = 10\r\nvar content_width = 0\r\nvar height = 10\r\nvar tb_color = \"#464444\"\r\nvar bg_color = \"#363535\"\r\nvar trigger = primaryEnd\r\nvar inputs = [leftEnd, rightEnd, upEnd, downEnd, primaryEnd, backEnd, ability1End, ability2End, bumpLEnd, bumpREnd]\r\n\r\nvar content = []\r\n\r\n// Top Left orientation of window, (0,6) places it right below the Potion\r\nvar offX = 0\r\nvar offY = 6\r\n\r\n// Optimization that only updates the box spacing when information changes\r\nvar needs_update = 1\r\nvar draw_line = \"\"\r\n\r\n////////////\r\n// Public //\r\n////////////\r\n\r\n// Initialize title width and height\r\nfunc init(title, w, h)\r\n  ?this.initialized = 0\r\n    this.title = title\r\n    this.width = w\r\n    this.content_width = w - 2\r\n    this.height = h\r\n    this.initialized = 1\r\n\r\n//\r\nfunc update_title(title)\r\n  this.title = title\r\n\r\n// Update bottom background color\r\nfunc update_bg(color)\r\n  this.bg_color = color\r\n\r\n// Update title bar background color\r\nfunc update_tab(color)\r\n  this.tb_color = color\r\n\r\n// Update minimize condition to be button or full tab\r\nfunc update_min_mode(val)\r\n  ?val = \"Button\" | val = \"Full\"\r\n    this.min_mode = val\r\n\r\n// Update expand condition to be static or expand \r\n// the right when content is larger than the window\r\nfunc update_expand_mode(val)\r\n  ?val = \"Static\" | val = \"Expand\"\r\n    this.expand_mode = val\r\n\r\n// Update the input to trigger minimize\r\nfunc update_trigger(input)\r\n  ?inputs.Contains(input)\r\n    this.trigger = input\r\n\r\n// Update the window size\r\nfunc update_size(x, y)\r\n  this.width = x\r\n  this.height = y\r\n  this.needs_update = 1\r\n\r\n// Update the window offset from (0,0)\r\nfunc update_offset(x, y)\r\n  this.offX = x\r\n  this.offY = y\r\n  this.needs_update = 1\r\n\r\n// Get X offset\r\nfunc get_offX()\r\n  return this.offX\r\n\r\n// Get Y offset\r\nfunc get_offY()\r\n  return this.offY\r\n\r\n// Return minimized state\r\nfunc is_visible()\r\n  return this.visible\r\n\r\nfunc is_initialized()\r\n  return this.initialized\r\n\r\n// Replaces the content array with a new array\r\nfunc update_content(arr)\r\n  this.content = arr\r\n  for c = 0..content.Count() - 1\r\n    ?string.Size(arr[c]) > this.content_width\r\n      this.content_width = string.Size(arr[c])\r\n      this.width = this.content_width + 2\r\n  this.needs_update = 1\r\n\r\n\r\n// Add a line to the window\r\n// Note: This can't be used without a queue-like system to add items only once\r\nfunc add_line(cont)\r\n  this.content.Add(cont)\r\n  this.needs_update = 1\r\n\r\n// Update a line in the window\r\nfunc update_line(line, cont)\r\n  ?line < this.content.Count()\r\n    this.content[line] = cont\r\n  this.needs_update = 1\r\n\r\n// Draw window\r\nfunc draw()\r\n  var inner\r\n  ?this.expand_mode = \"Expand\"\r\n    inner = this.content_width + 2\r\n  :\r\n    inner = this.width\r\n  \r\n  // DRAW WINDOW\r\n  draw.BG(this.offX, this.offY, this.tb_color, inner, 1)\r\n  ?this.visible = 1\r\n    // Maximized\r\n    draw.BG(this.offX, this.offY+1, this.bg_color, inner, this.height)\r\n    >`@this.offX@,@this.offY@,#white,▲ @this.title@\r\n\r\n    var top = this.offY + 1\r\n    var bottom = this.offY + this.height\r\n    var left = this.offX\r\n    var right = this.offX + inner - 1\r\n\r\n    // Only redraw if a change to the window occurs\r\n    ?this.needs_update = 1\r\n      draw_line = \"\"\r\n      for bw = 1..this.width - 2\r\n        draw_line = draw_line + \"═\"\r\n        this.needs_update = 0\r\n    >`@left@,@top@,╔@draw_line@╗\r\n    >`@left@,@bottom@,╚@draw_line@╝\r\n    var itr\r\n    itr = 0\r\n    for h = this.offY + 2..this.offY + this.height - 1\r\n      ?itr < this.content.Count()\r\n        >`@left@,@h@,║@this.content[itr]@\r\n        >`@right@,@h@,║\r\n      :        \r\n        >`@left@,@h@,║\r\n        >`@right@,@h@,║\r\n      itr += 1\r\n  :\r\n    // Minimized\r\n    >`@this.offX@,@this.offY@,#white,▼ @this.title@\r\n\r\n  input()\r\n\r\n/////////////\r\n// private //\r\n/////////////\r\n\r\n// User input dropdown trigger\r\nfunc input()\r\n  var inner\r\n  ?this.expand_mode = \"Expand\"\r\n    inner = this.content_width + 2\r\n  :\r\n    inner = this.width\r\n\r\n  ?min_mode = \"Full\"\r\n    ?key = this.trigger & input.x >= this.offX & input.x < this.offX + inner &\r\n    ^input.y = this.offY\r\n      ?this.visible = 1\r\n        this.visible = 0\r\n      :?this.visible = 0\r\n        this.visible = 1\r\n  :?min_mode = \"Button\"\r\n    ?key = this.trigger & input.x = this.offX &\r\n    ^input.y = this.offY\r\n      ?this.visible = 1\r\n       this.visible = 0\r\n     :?this.visible = 0\r\n       this.visible = 1"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/LiveSplit.txt" - Parse error: Failed to parse completely. Remaining: "= \"Version 1.0.2\"\n//Size of a block of text\nvar sizeBlock = 11\n//Number of splits displayed\nvar noSDed = 5\n//Half of number of splits displayed\nvar halfnoSDed = (noSDed - 1) / 2\n//Number of columns\nvar noCol = 5\n//Size of a column\nvar sizeCol = noSDed + 4\n//Size of a row\nvar sizeText = sizeBlock * noCol\n\n//==========Variables==========\n//===System variables===\nvar locName = loc.name\nvar locStars = loc.stars\nvar screenW = screen.w\nvar screenH = screen.h\n\nvar foeString = foe\nfoeString = foe\nvar foeHP = foe.hp\nfoeHP = foe.hp\nvar foeDist = foe.distance\nfoeDist = foe.distance\n\n//===Storage===\n//Array containing all current times\nvar currentArray = []\n//Array containing all best times\nvar bestArray = []\n//Array containing all reset counts\nvar resetsArray = []\n//Number of total resets\nvar totalResets = 0\n//Number of runs ending at the same time \nvar samePace = 0\n\n//Array containing all current segment times\nvar currentSegmentArray = []\n//Array containing all best segment times\nvar bestSegmentArray = []\n//Array containing all resets on the same pace as best segment\nvar resetsSegmentArray = []\n//Array containing sum of best segments from last (for projected time)\nvar sumSegmentArray = []\n//Sum of best\nvar sumBest = 0\n//Projected finish time\nvar projectedTime = 0\n\n//===Splits===\n//Time of last frame\nvar lastTime = 0\n//If all splits are recorded in splitsArray\nvar splitsExist = false\n//Size of splits array\nvar splitsSize = 0\n//Current split index\nvar currentSplitID = 0\n//Current split in STRING\nvar currentSplitString = \"CURRENT\"\n//Current split's best time\nvar lUBestTime = 0\n//Current segment's best time\nvar lUBestSegment = 0\n//Array containing all splits\nvar splitsArray = []\n//Contains all rooms that were empty since the first one\n//to add back in when CURRENT split ends or turns to PRE-BOSS\nvar padding = []\n\n//===Triggers===\n//Switch for CURRENT split\nvar swCurr = 0\n//Switch for MINIBOSS split\nvar swMBoss = 0\n//Switch for BOSS split\nvar swPBoss = 0\n//Switch for timing BOSS split\nvar startBoss = 0\n//Current boss phase\nvar phaseBoss = 0\n//Raises signal to update current split\nvar updateSignal = 1\n//Records last screen to check for screen change\nvar lastScreen = screen.i\n\n//===View mode===\n//Activates View mode\nvar swArrow = 0\n//Start and end point of current view\nvar startptr = 0\nvar endptr = 0\n\n//===Column text===\nvar SplitsText = \"\\n\"\nvar CurrentText = \"CURRENT\\n\"\nvar BestText = \"BEST\\n\"\nvar DifferenceText = \"DIFFERENCE\\n\"\nvar ResetsText = \"RESETS\\n\"\n\n//===Settings===\n//Switches between formatting and not formatting time\nvar swTimeFormat\n//Switches between split time and segment time\nvar swTimingType\n//Switches between Hall of Fames and runs \nvar swType = 0 \n//Checks if UI is shown or hidden\nvar checkUI = 1\n\n//===UI===\n//Contains the entire UI + buttons\nvar FullUI \n//Textboxes that displays the full UI\nvar SplitsUI\nvar SplitsColumn\nvar CurrentColumn\nvar BestColumn\nvar DifferenceColumn\nvar ResetsColumn\n//Textbox that displays the current split, overwrites other boxes on current split\nvar CurrentBox\nvar DifferenceBox\n//Buttons for UI visibility\nvar hideUIButton\n//Buttons for View mode\nvar upArrowButton\nvar downArrowButton\nvar resetViewButton\n\n//==========Functions==========\n//=====Storage=====\nfunc storageID(name, star, type, split)\n //Returns ID value at \"name\" split's value type\n //EX: \"BEST\" type of split \"PHASE1\"\n return \"LST\"+type+name+star+split\n\nfunc getStorage(name, star, type, split, safety)\n //Get storage value at \"name\" split's value type\n return storage.Get(storageID(name, star, type, split), safety)\n\nfunc setStorage(name, star, type, split, value)\n //Set storage value at \"name\" split's value type\n storage.Set(storageID(name, star, type, split), value)\n\nfunc hasStorage(name, star, type, split)\n //Check if storage value at \"name\" split's value type exists\n return storage.Has(storageID(name, star, type, split))\n\nfunc deleteStorage(name, star, type, split)\n //Delete storage value at \"name\" split's value type\n storage.Delete(storageID(name, star, type, split))\n\nfunc incrStorage(name, star, type, split)\n //Increase storage value at \"name\" split's value type\n //If value doesn't exist, set it to 1\n ?hasStorage(name, star, type, split)\n  storage.Incr(storageID(name, star, type, split))\n :\n  setStorage(name, star, type, split, 1)\n\nfunc deleteSplit(name, star, split)\n //Delete all information relating to \"name\" split\n deleteStorage(name, star, \"BEST-SEGMENT\", split) \n deleteStorage(name, star, \"BEST\", split)\n deleteStorage(name, star, \"RESETS-SEGMENT\", split)\n deleteStorage(name, star, \"RESETS\", split)\n\nfunc resetStorage(name, star, splitsArr)\n //Reset the entirety of a loc star\n for i = 0..splitsArr.Count() - 1\n  deleteSplit(name, star, splitsArr[i])\n deleteStorage(name, star, \"BEST\", \"RESETS\")\n deleteStorage(name, star, \"BEST\", \"COUNT\")\n deleteStorage(name, star, \"SPLITS\", \"STRING\")\n\n//=====Global UI=====\nfunc newPanel(x, y, w, h, anchor, dock, visible, style)\n //Create a panel object with the parameters\n var tempPanel = ui.AddPanel()\n tempPanel.x = x\n tempPanel.y = y\n tempPanel.w = w\n tempPanel.h = h\n tempPanel.anchor = anchor\n tempPanel.dock = dock\n tempPanel.visible = visible\n tempPanel.style = style\n return tempPanel\n\nfunc newText(x, y, w, h, anchor, dock, visible, align, text)\n //Create a text object with the parameters\n var tempText = ui.AddText()\n tempText.x = x\n tempText.y = y\n tempText.w = w\n tempText.h = h\n tempText.anchor = anchor\n tempText.dock = dock\n tempText.visible = visible\n tempText.align = align\n tempText.text = text\n return tempText\n\nfunc newButton(x, y, w, h, anchor, dock, visible, style, text, OnPressed)\n //Create a button object with the parameter\n var tempButton = ui.AddButton()\n tempButton.x = x\n tempButton.y = y\n tempButton.w = w\n tempButton.h = h\n tempButton.anchor = anchor\n tempButton.dock = dock\n tempButton.visible = visible\n tempButton.style = style\n tempButton.text = text\n tempButton.SetPressed(OnPressed)\n return tempButton\n\n//=====Saving=====\nfunc setSegment(t)\n ?splitsExist\n  //If splits array exists\n  //Update current segment\n  var ttemp\n  ?currentSplitID ! 0\n   ttemp = t - currentArray[currentSplitID - 1]\n  :\n   ttemp = t\n  currentSegmentArray[currentSplitID] = ttemp\n  \n  //Update best segment and same pace resets\n  ?ttemp < bestSegmentArray[currentSplitID]\n   //If current segment is better than best segment\n   sumBest = sumBest - bestSegmentArray[currentSplitID] + ttemp\n   bestSegmentArray[currentSplitID] = ttemp\n   setStorage(locName, locStars, \"BEST-SEGMENT\", currentSplitString, ttemp)\n   resetsSegmentArray[currentSplitID] = 0\n  :?ttemp = bestSegmentArray[currentSplitID]\n   //If same pace\n   resetsSegmentArray[currentSplitID] = resetsSegmentArray[currentSplitID] + 1\n  setStorage(locName, locStars, \"RESETS-SEGMENT\", currentSplitString, resetsSegmentArray[currentSplitID])\n :\n  //If splits array doesn't exist\n  //Update current segment\n  var ttemp\n  ?splitsSize ! 0\n   ttemp = t - currentArray[splitsSize - 1]\n  :\n   ttemp = t\n  currentSegmentArray.Add(ttemp)\n  \n  //Update best segment and same pace resets\n  bestSegmentArray.Add(getStorage(locName, locStars, \"BEST-SEGMENT\", currentSplitString, 99999))\n  ?ttemp < bestSegmentArray[splitsSize]\n   bestSegmentArray[splitsSize] = ttemp\n   setStorage(locName, locStars, \"BEST-SEGMENT\", currentSplitString, ttemp)\n   setStorage(locName, locStars, \"RESETS-SEGMENT\", currentSplitString, 0)\n  :?ttemp = bestSegmentArray[splitsSize]\n   incrStorage(locName, locStars, \"RESETS-SEGMENT\", currentSplitString)\n  resetsSegmentArray.Add(getStorage(locName, locStars, \"RESETS-SEGMENT\", currentSplitString, 0))\n\nfunc setSplit(split, newSplit, t, swUpdate)\n //Saves a split to currentArray and switch to the next split\n ?splitsExist\n  //If split array exists, use ID\n  currentArray[currentSplitID] = t\n  resetsArray[currentSplitID] = resetsArray[currentSplitID] + 1\n  incrStorage(locName, locStars, \"RESETS\", splitsArray[currentSplitID])\n  currentSplitID++\n  currentSplitString = splitsArray[currentSplitID]\n  projectedTime = currentArray[currentSplitID-1] + sumSegmentArray[currentSplitID]\n  //Check conditions\n  ?currentSplitString = \"ROOM\" | currentSplitString = \"MINIBOSS\"\n   swCurr = 1\n   swPBoss = 0\n   phaseBoss = 0\n  :?currentSplitString = \"PRE-BOSS\"\n   swPBoss = 1\n   swCurr = 0\n   phaseBoss = 0\n  :?currentSplitString = \"PHASE\"\n   phaseBoss++\n   swPBoss = 0\n   swCurr = 0\n  :\n   swCurr = 0\n   swPBoss = 0\n   phaseBoss = 0\n  updateSignal = 1\n  updateSplits()\n :\n  //If split array doesn't exist, use string\n  currentArray.Add(t)\n  splitsArray.Add(split)\n  incrStorage(locName, locStars, \"RESETS\", split)\n  resetsArray.Add(getStorage(locName, locStars, \"RESETS\", split, 0))\n  splitsSize++\n  currentSplitString = newSplit\n  ?swUpdate\n   updateSignal = 1\n   updateSplits()\n\nfunc switchSplit(newSplit)\n //Switch a split without saving it to currentArray\n currentSplitString = newSplit\n updateSignal = 1\n updateSplits()\n\n//=====UI=====\nfunc printTime(frame)\n //Print out @frame@ depending on format type\n ?swTimeFormat\n  var fr = (frame % 30) * 100 / 30\n  var sec = frame / 30\n  var min = sec / 60\n  sec = sec - min * 60\n  ?sec < 10\n   sec = \"0\" + sec\n  ?fr < 10\n   fr = \"0\" + fr\n  return min + \":\" + sec + \".\" + fr\n :\n  return frame + \"\"\n\nfunc updateCurrentTime()\n //Update current time and difference every frame\n ?swTimingType \n  //Splits\n  CurrentBox.text = printTime(lastTime)\n  ?lastTime <= lUBestTime\n   //If current time is better than best time\n   DifferenceBox.text = \"-\" + printTime(lUBestTime - lastTime)\n  :\n   DifferenceBox.text = \"+\" + printTime(lastTime - lUBestTime)\n :\n  //Segments\n  var tempcurTime\n  ?currentSplitID ! 0 \n   tempcurTime = lastTime - currentArray[currentSplitID-1]\n  :\n   tempcurTime = lastTime\n  CurrentBox.text = printTime(tempcurTime)\n  ?tempcurTime <= lUBestSegment \n   DifferenceBox.text = \"-\" + printTime(lUBestSegment - tempcurTime)\n  :\n   DifferenceBox.text = \"+\" + printTime(tempcurTime - lUBestSegment)\n\nfunc updateCurrent()\n //Function to update all current events\n ?!checkUI \n  //If UI is hidden\n  return\n :?swArrow \n  //If in view mode\n  ?splitsExist\n   ?updateSignal\n    //Only mass update locations and stuff when signaled\n    ?currentSplitID < startptr\n     //If current split is below view\n     CurrentBox.y = 2\n     DifferenceBox.y = 2\n    :?currentSplitID > endptr\n     //If current split is above view\n     CurrentBox.y = noSDed + 1\n     DifferenceBox.y = noSDed + 1\n    :\n     //If current split is in view\n     CurrentBox.y = 2 + (currentSplitID - startptr)\n     DifferenceBox.y = 2 + (currentSplitID - startptr)\n    //Update best time and end signal\n    lUBestTime = bestArray[currentSplitID]\n    lUBestSegment = bestSegmentArray[currentSplitID]\n    updateSignal = 0\n   updateCurrentTime()\n  :\n   >ERROR: Arrows accessed without splits array, ping Qrupafjzvm with this message\n :\n  //If not in view mode\n  ?splitsExist\n   //If splits array exists\n   ?updateSignal \n    //Only mass update locations and stuff when signaled\n    ?currentSplitID < halfnoSDed\n     //If current split is below middle line\n     CurrentBox.y = 2 + currentSplitID\n     DifferenceBox.y = 2 + currentSplitID \n    :?currentSplitID > splitsSize - 1 - halfnoSDed\n     //If current split is above middle line\n     CurrentBox.y = noSDed + 1 - (splitsSize - 1 - currentSplitID)\n     DifferenceBox.y = noSDed + 1 - (splitsSize - 1 - currentSplitID)\n    :\n     //If current split is in middle line\n     CurrentBox.y = 2 + halfnoSDed\n     DifferenceBox.y = 2 + halfnoSDed\n    //Update best time and end signal\n    lUBestTime = bestArray[currentSplitID]\n    lUBestSegment = bestSegmentArray[currentSplitID]\n    updateSignal = 0\n   updateCurrentTime()\n  :\n   //If splits array doesn't exist\n   ?updateSignal\n    //Only mass update locations and stuff when signaled\n    ?splitsSize + 1 < noSDed \n     //If there aren't enough splits to fill the board\n     CurrentBox.y = splitsSize + 2\n    :\n     //If there are enough splits to fill the board\n     CurrentBox.y = noSDed + 1\n    //End signal\n    updateSignal = 0\n   //Updates current time every frame \n   ?swTimingType\n    CurrentBox.text = printTime(lastTime)\n   :\n    ?splitsSize ! 0 \n     CurrentBox.text = printTime(lastTime - currentArray[splitsSize-1])\n    :\n     CurrentBox.text = printTime(lastTime)\n        \nfunc addTextColumns(splits, current, best, difference, resets)\n //Add text to template columns\n SplitsText = SplitsText + splits + \"\\n\"\n CurrentText = CurrentText + current + \"\\n\"\n BestText = BestText + best + \"\\n\"\n DifferenceText = DifferenceText + difference + \"\\n\"\n ResetsText = ResetsText + resets + \"\\n\"\n\nfunc addMultipleSplits(startloop, endloop)\n //Add multiple splits to columns\n for i = startloop..endloop\n  ?currentArray[i] ! -1\n   //If data exists\n   var tempcurTime = currentArray[i]\n   var tempbestTime = bestArray[i]\n   //Check for difference between current and best time\n   var differencetemp\n   ?tempcurTime <= tempbestTime\n    //If current time is better than best time\n    differencetemp = \"-\" + printTime(tempbestTime - tempcurTime)   \n   :\n    //If current time is worse than best time\n    differencetemp = \"+\" + printTime(tempcurTime - tempbestTime)\n   //Assigning to columns\n   addTextColumns(splitsArray[i], printTime(tempcurTime), \n               ^printTime(tempbestTime), differencetemp, resetsArray[i])\n  :\n   //If data doesn't exist\n   addTextColumns(splitsArray[i], \"-\", printTime(bestArray[i]), \"-\", resetsArray[i])\n\nfunc addMultipleSegments(startloop, endloop)\n for i = startloop..endloop\n  ?currentSegmentArray[i] ! -1\n   var tempcurTime = currentSegmentArray[i]\n   var tempbestTime = bestSegmentArray[i]\n   var differencetemp\n   ?tempcurTime <= tempbestTime\n    //If current time is better than best time\n    differencetemp = \"-\" + printTime(tempbestTime - tempcurTime)   \n   :\n    //If current time is worse than best time\n    differencetemp = \"+\" + printTime(tempcurTime - tempbestTime)\n   addTextColumns(splitsArray[i], printTime(tempcurTime), \n                 ^printTime(tempbestTime), differencetemp, resetsSegmentArray[i])\n  :\n   addTextColumns(splitsArray[i], \"-\", printTime(bestSegmentArray[i]), \n                 ^\"-\", resetsSegmentArray[i])\n\nfunc updateSplits()\n //Add splits to columns\n ?!checkUI\n  //If UI is hidden\n  return \n :\n  ?swTimingType\n   //Splits\n   //Declare starting text for each column\n   SplitsText = \"\\n\"\n   CurrentText = \"CURRENT\\n\"\n   BestText = \"BEST\\n\"\n   DifferenceText = \"DIFFERENCE\\n\"\n   ResetsText = \"RESETS\\n\"                                       \n   ?swArrow\n    //If in view mode\n    ?splitsExist\n     //If splits array exists\n     ?currentSplitID < startptr\n      //If current split is before view    \n      //Current split\n      addTextColumns(currentSplitString, \"-\", printTime(bestArray[currentSplitID]), \n                    ^\"-\", resetsArray[currentSplitID])\n      //4 of the rest in view\n      addMultipleSplits(startptr+1, endptr)\n     :?currentSplitID > endptr\n      //If current split is after view\n      //4 of the start in view\n      addMultipleSplits(startptr, endptr-1)\n      //Current split\n      addTextColumns(currentSplitString, \"-\", printTime(bestArray[currentSplitID]), \n                    ^\"-\", resetsArray[currentSplitID])\n     :\n      //If current split is in view\n      addMultipleSplits(startptr, endptr)\n    :\n     >ERROR: Arrows accessed without splits array, ping Qrupafjzvm with this message\n   :\n    //If not in view mode\n    ?splitsExist\n    //If splits array exists  \n     ?currentSplitID < halfnoSDed\n      //If current split is below middle line\n      addMultipleSplits(0, noSDed - 1)\n     :?currentSplitID > splitsSize - 1 - halfnoSDed\n      //If current split is above middle line\n      addMultipleSplits(splitsSize - noSDed, splitsSize - 1)\n     :\n      //If it's in the middle\n      addMultipleSplits(currentSplitID - halfnoSDed, currentSplitID + halfnoSDed)\n    :\n     //If splits array doesn't exist\n     ?splitsSize + 1 < noSDed\n      //If there aren't enough splits to fill the splits board\n      ?splitsSize > 0\n       for i = 0..splitsSize - 1\n        //Go through every split before current split\n        addTextColumns(splitsArray[i], printTime(currentArray[i]), \"-\", \"-\", resetsArray[i])\n      //Current split\n      addTextColumns(currentSplitString, \"-\", \"-\", \"-\", \n                    ^getStorage(locName, locStars, \"RESETS\", currentSplitString, 0))\n     :\n      //If there are enough splits to fill the splits board\n      for i = splitsSize-noSDed+1..splitsSize-1\n       //All splits before current split\n       addTextColumns(splitsArray[i], printTime(currentArray[i]), \"-\", \"-\", resetsArray[i])\n      //Current split\n      addTextColumns(currentSplitString, \"-\", \"-\", \"-\", \n                    ^getStorage(locName, locStars, \"RESETS\", currentSplitString, 0))\n   //Number of resets + runs on best pace\n   addTextColumns(\"RESETS\", totalResets, \"\", \"SAME PACE\", samePace)\n  :\n   //Segments \n   //Declare starting text for each column\n   SplitsText = \"\\n\"\n   CurrentText = \"CURRENT\\n\"\n   BestText = \"BEST\\n\"\n   DifferenceText = \"DIFFERENCE\\n\"\n   ResetsText = \"SAME PACE\\n\"                                       \n   ?swArrow\n    //If in view mode\n    ?splitsExist\n     //If splits array exists\n     ?currentSplitID < startptr\n      //If current split is before view    \n      //Current split\n      addTextColumns(currentSplitString, \"-\", printTime(bestSegmentArray[currentSplitID]), \n                    ^\"-\", resetsSegmentArray[currentSplitID])\n      //4 of the rest in view\n      addMultipleSegments(startptr+1, endptr)\n     :?currentSplitID > endptr\n      //If current split is after view\n      //4 of the start in view\n      addMultipleSegments(startptr, endptr-1)\n      //Current split\n      addTextColumns(currentSplitString, \"-\", printTime(bestSegmentArray[currentSplitID]), \n                    ^\"-\", resetsSegmentArray[currentSplitID])\n     :\n      //If current split is in view\n      addMultipleSegments(startptr, endptr)\n     //Sum of best + projected finish time\n     \n     addTextColumns(\"SUM OF BEST\", printTime(sumBest), \"\", \"PROJECTED\", printTime(projectedTime))\n    :\n     >ERROR: Arrows accessed without splits array, ping Qrupafjzvm with this message\n   :\n    //If not in view mode\n    ?splitsExist\n    //If splits array exists  \n     ?currentSplitID < halfnoSDed\n      //If current split is below middle line\n      addMultipleSegments(0, noSDed - 1)\n     :?currentSplitID > splitsSize - 1 - halfnoSDed\n      //If current split is above middle line\n      addMultipleSegments(splitsSize - noSDed, splitsSize - 1)\n     :\n      //If it's in the middle\n      addMultipleSegments(currentSplitID - halfnoSDed, currentSplitID + halfnoSDed)\n     //Sum of best + projected finish time\n     addTextColumns(\"SUM OF BEST\", printTime(sumBest), \"\", \"PROJECTED\", printTime(projectedTime))\n    :\n     //If splits array doesn't exist\n     ?splitsSize + 1 < noSDed\n      //If there aren't enough splits to fill the splits board\n      ?splitsSize > 0\n       for i = 0..splitsSize - 1\n        //Go through every split before current split\n        addTextColumns(splitsArray[i], printTime(currentSegmentArray[i]), \n                      ^printTime(bestSegmentArray[i]), \"-\", resetsSegmentArray[i])\n      //Current split\n      addTextColumns(currentSplitString, \"-\", \"-\", \"-\", \n                    ^getStorage(locName, locStars, \"RESETS-SEGMENT\", currentSplitString, 0))\n     :\n      //If there are enough splits to fill the splits board\n      for i = splitsSize-noSDed+1..splitsSize-1\n       //All splits before current split\n       addTextColumns(splitsArray[i], printTime(currentSegmentArray[i]), \n                     ^printTime(bestSegmentArray[i]), \"-\", resetsSegmentArray[i])\n      //Current split\n      addTextColumns(currentSplitString, \"-\", \"-\", \"-\", \n                    ^getStorage(locName, locStars, \"RESETS-SEGMENT\", currentSplitString, 0))\n     //Sum of best + projected finish time\n     addTextColumns(\"SUM OF BEST\", \"-\", \"\", \"PROJECTED\", \"-\")\n  \n  //Update all columns\n  SplitsColumn.text = SplitsText\n  CurrentColumn.text = CurrentText\n  BestColumn.text = BestText\n  DifferenceColumn.text = DifferenceText\n  ResetsColumn.text = ResetsText\n\nfunc upArrow()\n //Up arrow for SplitsUI\n ?!swArrow\n  //If not in view mode\n  swArrow = 1\n  ?currentSplitID - 1 < halfnoSDed\n   //If below split is below middle line\n   startptr = 0\n   endptr = noSDed - 1\n  :?currentSplitID - 1 > splitsSize - 1 - halfnoSDed\n   //If below split is above middle line\n   startptr = splitsSize-noSDed\n   endptr = splitsSize-1\n  :\n   //If below split is in middle line\n   startptr = currentSplitID - 1 - halfnoSDed\n   endptr = currentSplitID - 1 + halfnoSDed\n  updateSignal = 1\n  updateSplits()\n :\n  //If already in view mode\n  ?startptr - 1 >= 0\n   startptr--\n   endptr--\n   updateSignal = 1\n   updateSplits()\n\nfunc downArrow()\n //Down arrow for SplitsUI\n ?!swArrow\n  //If not in view mode\n  swArrow = 1\n  ?currentSplitID + 1 < halfnoSDed\n   //If above split is below middle line\n   startptr = 0\n   endptr = noSDed - 1\n  :?currentSplitID + 1 > splitsSize - 1 - halfnoSDed\n   //If above split is above middle line\n   startptr = splitsSize-noSDed\n   endptr = splitsSize-1\n  :\n   //If above split is in middle line\n   startptr = currentSplitID + 1 - halfnoSDed\n   endptr = currentSplitID + 1 + halfnoSDed\n  updateSignal = 1\n  updateSplits()\n :\n  //If already in view mode\n  ?endptr + 1 <= splitsSize - 1\n   startptr++\n   endptr++\n   updateSignal = 1\n   updateSplits()\n\nfunc resetView()\n //Reset arrow changes\n ?swArrow \n  swArrow = 0\n  startptr = 0\n  endptr = 0\n  updateSignal = 1\n  updateSplits()\n\nfunc hideUI()\n //Hides UI\n checkUI = 0\n SplitsUI.visible = false\n upArrowButton.visible = false\n downArrowButton.visible = false\n resetViewButton.visible = false\n hideUIButton.y = 0\n hideUIButton.text = \"SHOW\"\n hideUIButton.SetPressed(showUI)\n \nfunc showUI()\n //Shows UI\n checkUI = 1\n SplitsUI.visible = true\n upArrowButton.visible = splitsExist\n downArrowButton.visible = splitsExist\n resetViewButton.visible = splitsExist\n hideUIButton.y = noSDed + 4\n hideUIButton.text = \"HIDE\"\n hideUIButton.SetPressed(hideUI)\n updateSignal = 1\n updateSplits()\n\nfunc createUI(showArrow, showProjected)\n //Creates all UI elements\n //Main panel\n FullUI = newPanel(0, 0, sizeText + 4, sizeCol + 2, \"top_center\", \"top_center\", inherit, 0)\n FullUI.style = ui.AddStyle(\"#########\")\n\n //The board\n SplitsUI = newPanel(0, 1, sizeText + 2, sizeCol, \"top_center\", \"top_center\", inherit, -2)\n FullUI.Add(SplitsUI)\n\n SplitsColumn = newText(1, 1, sizeBlock, noSDed + 2, \"top_left\", \"top_left\", inherit, \"left\", \"\")\n SplitsUI.Add(SplitsColumn)\n \n CurrentColumn = newText(1 + sizeBlock, 1, sizeBlock, noSDed + 2, \"top_left\", \"top_left\", inherit, \"center\", \"\")\n SplitsUI.Add(CurrentColumn)\n\n BestColumn = newText(1 + sizeBlock * 2, 1, sizeBlock, noSDed + 2, \"top_left\", \"top_left\", inherit, \"center\", \"\")\n SplitsUI.Add(BestColumn)\n\n DifferenceColumn = newText(1 + sizeBlock * 3, 1, sizeBlock, noSDed + 2, \"top_left\", \"top_left\", inherit, \"center\", \"\")\n SplitsUI.Add(DifferenceColumn)\n\n ResetsColumn = newText(1 + sizeBlock * 4, 1, sizeBlock, noSDed + 2, \"top_left\", \"top_left\", inherit, \"center\", \"\")\n SplitsUI.Add(ResetsColumn)\n \n CurrentBox = newText(1 + sizeBlock, 2, sizeBlock, 1, \"top_left\", \"top_left\", inherit, \"center\", \"-\")\n SplitsUI.Add(CurrentBox)\n\n DifferenceBox = newText(1 + 3 * sizeBlock, 2, sizeBlock, 1, \"top_left\", \"top_left\", inherit, \"center\", \"-\")\n SplitsUI.Add(DifferenceBox)\n\n\n //The buttons\n hideUIButton = newButton(1 + 2 * sizeBlock, noSDed + 4, sizeBlock, 3, \"top_left\", \"top_left\", true, -1, \"HIDE\", hideUI)\n SplitsUI.Add(hideUIButton)\n\n upArrowButton = newButton(1, noSDed + 4, sizeBlock, 3, \"top_left\", \"top_left\", showArrow, -1, \"↑\", upArrow)\n SplitsUI.Add(upArrowButton)\n\n downArrowButton = newButton(1 + sizeBlock, noSDed + 4, sizeBlock, 3, \"top_left\", \"top_left\", showArrow, -1, \"↓\", downArrow)\n SplitsUI.Add(downArrowButton)\n\n resetViewButton = newButton(1 + 4 * sizeBlock, noSDed + 4, sizeBlock, 3, \"top_left\", \"top_left\", showArrow, -1, \"BACK\", resetView)\n SplitsUI.Add(resetViewButton)\n \n ?!checkUI\n  //If UI is hidden before transition, hide it now\n  hideUI()\n\n//Other \nfunc resetLoop()\n //Resets everything on loop\n swCurr = 1\n swMBoss = 0\n swPBoss = 0\n phaseBoss = 0\n startBoss = 0\n updateSignal = 1\n lastScreen = screen.i\n padding = []\n\n//===============Hall of Fame===============\n//==========Constants==========\n//All loc names\nvar locArray = [[\"Rocky Plateau\", 5, 15], [\"Deadwood Canyon\", 3, 15], \n               ^[\"Caves of Fear\", 3, 15], [\"Mushroom Forest\", 3, 15], \n               ^[\"Haunted Halls\", 3, 15], [\"Boiling Mines\", 3, 15], \n               ^[\"Icy Ridge\", 3, 15], [\"Temple\", 3, 15]]\n\nvar locNameArt = [\n^ascii\n  _                _                  \n /_/ _  _  /_     /_/ / _ _/_ _  _    \n/ \\ /_//_ /\\ /_/ /   / /_|/  /_'/_|/_/\n             _/                       \nasciiend,\n^ascii\n  _                            _                \n / | _  _   _/     _  _   _/  / ` _  _     _  _ \n/_.'/_'/_|/_/ |/|//_//_//_/  /_, /_|/ //_//_// /\n                                       _/       \nasciiend,\n^ascii\n  _                      _         \n / ` _    _   _  _ _/|  /_` _  _  _\n/_, /_||//_'_\\  /_//   /   /_'/_|/ \n                                   \nasciiend,\n^ascii\n                              _               \n /|,/     _ /_ _ _  _  _ _   /_` _  _ _   __/_\n/  / /_/_\\ / // /_//_// / / /   /_// /_'_\\ /  \n                                              \nasciiend,\n^ascii\n                                      \n /_/ _     _ _/_ _   _/  /_/ _  / /  _\n/ / /_|/_// //  /_'/_/  / / /_|/ / _\\ \n                                      \nasciiend,\n^ascii\n  _                              \n /_) _  . / . _  _   /|,/ . _  _ \n/_) /_// / / / //_/ /  / / / //_'\n                _/               \nasciiend,\n^ascii\n           _             \n / _      /_/ .  _/ _  _ \n/ /_ /_/ / \\ / /_/ /_//_'\n     _/            _/    \nasciiend,\n^ascii\n __                 \n /  _  _ _   _  / _ \n/  /_'/ / / /_// /_'\n           /        \nasciiend]\n//All colors\nvar colorArr = [[\"#white\", \"#312C31\"], \n               ^[\"#cyan\", \"#002831\"], \n               ^[\"#yellow\", \"#312C10\"], \n               ^[\"#green\", \"\"], \n               ^[\"#blue\", \"\"], \n               ^[\"#red\", \"\"], \n               ^[\"#rainbow\", \"\"]]\n//Number of locs \nvar noLocs = locArray.Count()\n//Current loc index shown\nvar locIndex = 0\n//Current star shown\nvar curStar = 5\n//Size of button\nvar buttonSize = 3\n//Height of title\nvar textHeight = 5\n//Number of splits displayed in Halls\nvar noSDHalls = screenH - 9 - textHeight\n//Number of columns \nvar noColHalls = 3\n//Size of a Halls column\nvar sizeHallsCol = noSDHalls + 5\n//Size of a Halls row\nvar sizeHallsRow = sizeBlock * noColHalls\n//Number of clicks until deleting data\nvar cntClick = 5\n\n//==========Variables==========\n//Start and end of the splits view\nvar startHalls\nvar endHalls \n\n//==========UI==========\n//Entire Halls panel\nvar HallsPanel \n//Loc name display\nvar HallsLoc\nvar LocText\n//Buttons to change loc\nvar locLeftButton\nvar locRightButton\n//Stars display\nvar locStarsPanel\nvar locStarsText\n//Buttons to change stars\nvar starsLeftButton\nvar starsRightButton\n//Hall screen\nvar hallSplitsPanel\nvar hallSplitsColumn\nvar hallBestColumn\nvar hallResetsColumn\nvar hallUpButton\nvar hallDownButton\n//Utility buttons\nvar switchFormatButton\nvar switchFormatText\nvar switchTimingButton\nvar switchTimingText\nvar resetStarButton\nvar resetStarText\nvar resetAllButton\nvar resetAllText\nvar versionText\nvar exitButton\n\n//==========Functions==========\nfunc addTextHallsColumns(splits, best, resets)\n SplitsText = SplitsText + splits + \"\\n\"\n BestText = BestText + best + \"\\n\"\n ResetsText = ResetsText + resets + \"\\n\"\n\nfunc textHallSplits(name, star)\n ?swTimingType\n  //Splits\n  //Declare starting text for each column\n  SplitsText = \"\\n\"\n  BestText = \"BEST\\n\"\n  ResetsText = \"RESETS\\n\"\n  //Add all in view\n  for i = startHalls..endHalls\n   addTextHallsColumns(splitsArray[i], printTime(bestArray[i]), resetsArray[i])\n  //Number of resets + runs on best pace\n  addTextHallsColumns(\"RESETS\", \"\", totalResets)\n  addTextHallsColumns(\"SAME PACE\", \"\", samePace)\n  //Update UI\n  hallSplitsColumn.text = SplitsText\n  hallBestColumn.text = BestText\n  hallResetsColumn.text = ResetsText\n :\n  //Segments \n  SplitsText = \"\\n\"\n  BestText = \"BEST\\n\"\n  ResetsText = \"RESETS\\n\"\n  //Add all in view\n  for i = startHalls..endHalls\n   addTextHallsColumns(splitsArray[i], printTime(bestSegmentArray[i]), resetsSegmentArray[i])\n  //Number of resets + runs on best pace\n  addTextHallsColumns(\"RESETS\", \"\", totalResets)\n  addTextHallsColumns(\"SUM OF BEST\", \"\", printTime(sumBest))\n  //Update UI\n  hallSplitsColumn.text = SplitsText\n  hallBestColumn.text = BestText\n  hallResetsColumn.text = ResetsText\n\nfunc updateHallSplits(name, star)\n ?hasStorage(name, star, \"SPLITS\", \"STRING\")\n  //If splits string exist\n  //Extract data\n  splitsArray = string.Split(getStorage(name, star, \"SPLITS\", \"STRING\", \"\"), \"$\")\n  splitsSize = splitsArray.Count()\n  splitsExist = true\n  bestArray = []\n  bestSegmentArray = []\n  resetsArray = []\n  resetsSegmentArray = []\n  sumBest = 0\n  for i = 0..splitsSize - 1\n   bestArray.Add(getStorage(name, star, \"BEST\", splitsArray[i], 99999))\n   resetsArray.Add(getStorage(name, star, \"RESETS\", splitsArray[i], 0))\n   bestSegmentArray.Add(getStorage(name, star, \"BEST-SEGMENT\", splitsArray[i], 99999))\n   sumBest = sumBest + bestSegmentArray[i]\n   resetsSegmentArray.Add(getStorage(name, star, \"RESETS-SEGMENT\", splitsArray[i], 0))\n  totalResets = getStorage(name, star, \"BEST\", \"RESETS\", 1)\n  samePace = getStorage(name, star, \"BEST\", \"COUNT\", 1)\n  //Resize view\n  startHalls = 0\n  ?splitsSize > noSDHalls\n   hallUpButton.visible = true\n   hallDownButton.visible = true\n   endHalls = noSDHalls - 1\n  :\n   hallUpButton.visible = false\n   hallDownButton.visible = false\n   endHalls = splitsSize - 1\n  textHallSplits(name, star)\n :\n  //If splits string doesn't exist\n  splitsArray.Clear()\n  splitsSize = 0\n  splitsExist = false\n  hallSplitsColumn.text = \"\"\n  hallBestColumn.text = \"NO DATA\"\n  hallResetsColumn.text = \"\"\n  hallUpButton.visible = false\n  hallDownButton.visible = false\n\nfunc padColor(text, color)\n  return \"[color=\" + color + \"]\" + text + \"[/color]\"\n\nfunc updateStars(fullupdate)\n //Check if star count is valid\n ?curStar < locArray[locIndex][1] \n  curStar = locArray[locIndex][1]\n :?curStar > locArray[locIndex][2] \n  curStar = locArray[locIndex][2]\n :\n  fullupdate = 1\n //Print star line\n var colorsToUse = colorArr[(curStar-1)/5]\n var bright = colorsToUse[0]\n var faded = colorsToUse[1]\n var numBright = (curStar - 1) % 5 + 1\n var numFaded = 5 - numBright\n var starText = padColor(string.Sub(\"☆ ☆ ☆ ☆ ☆\", 0, numBright*2 - 1), bright) \n             ^+ padColor(string.Sub(\" ☆ ☆ ☆ ☆\", 0, numFaded*2), faded) \n locStarsText.text = starText\n //Do a full update if needed\n ?fullupdate \n  updateHallSplits(locArray[locIndex][0], curStar)\n\nfunc rightLoc() \n //Move to the next loc to the right\n cntClick = 5\n locIndex = (locIndex + 1) % noLocs\n LocText.text = locNameArt[locIndex]\n updateStars(1)\n\nfunc leftLoc()\n //Move to the next loc to the left\n cntClick = 5\n locIndex = (locIndex + noLocs - 1) % noLocs\n LocText.text = locNameArt[locIndex]\n updateStars(1)\n\nfunc rightStars()\n //Move up 1 star\n cntClick = 5\n curStar++\n updateStars(0)\n \nfunc leftStars()\n //Move down 1 star\n cntClick = 5\n curStar--\n updateStars(0)\n\nfunc upArrowHalls()\n //Move view up\n cntClick = 5\n ?startHalls - 1 >= 0\n  startHalls--\n  endHalls--\n  textHallSplits(locArray[locIndex][0], curStar)\n\nfunc downArrowHalls()\n //Move view down\n cntClick = 5\n ?endHalls + 1 <= splitsSize - 1\n  startHalls++\n  endHalls++\n  textHallSplits(locArray[locIndex][0], curStar)\n\nfunc switchFormat()\n //Switch between frame and DigitalFormat\n cntClick = 5\n swTimeFormat = 1 - swTimeFormat\n ?swTimeFormat = 0\n  >Switched to using frame count\n :\n  >Switched to using DigitalFormat\n setStorage(\"GLOBAL\", \"SETTINGS\", \"TIME\", \"FORMAT\", swTimeFormat)\n ?splitsExist\n  textHallSplits(locArray[locIndex][0], curStar)\n\nfunc switchTiming()\n //Switch between split timing and segment timing\n cntClick = 5\n swTimingType = 1 - swTimingType\n ?swTimingType = 0 \n  >Switched to using segment timing\n :\n  >Switched to using split timing\n setStorage(\"GLOBAL\", \"SETTINGS\", \"TIMING\", \"TYPE\", swTimingType)\n ?splitsExist\n  textHallSplits(locArray[locIndex][0], curStar)\n\nfunc resetStar()\n //Reset all info of a star\n ?splitsExist\n  ?cntClick > 1\n   cntClick--\n   >@cntClick@ more presses to delete this star's data.\n  :\n   resetStorage(locArray[locIndex][0], curStar, splitsArray)\n   splitsArray.Clear()\n   splitsSize = 0\n   splitsExist = false\n   hallSplitsColumn.text = \"\"\n   hallBestColumn.text = \"NO DATA\"\n   hallResetsColumn.text = \"\"\n   hallUpButton.visible = false\n   hallDownButton.visible = false\n   >Data removed.\n :\n  >No data detected.\n\nfunc resetAll()\n //Reset all info of all stars of all locs\n ?cntClick > 1\n  cntClick--\n  >@cntClick@ more presses to delete all stars' data.\n :\n  >Deleting all stars' data. This might take a while.\n  for i = 0..locArray.Count()-1\n   for j = locArray[i][1]..locArray[i][2]\n    ?hasStorage(locArray[i][0], j, \"SPLITS\", \"STRING\")\n     splitsArray = string.Split(getStorage(locArray[i][0], j, \"SPLITS\", \"STRING\", \"\"), \"$\")\n     resetStorage(locArray[i][0], j, splitsArray)\n  splitsArray.Clear()\n  splitsSize = 0\n  splitsExist = false\n  hallSplitsColumn.text = \"\"\n  hallBestColumn.text = \"NO DATA\"\n  hallResetsColumn.text = \"\"\n  hallUpButton.visible = false\n  hallDownButton.visible = false\n  >All stars' data has been deleted.\n\nfunc exitHalls()\n loc.Leave()\n\nfunc createHall()\n disable pause\n disable banner\n\n //Full panel for Hall\n HallsPanel = newPanel(0, 0, screenW, screenH, \"top_center\", \"top_center\", inherit, 1)\n\n //Loc panel\n HallsLoc = newPanel(0, 1, screenW - (buttonSize + 2) * 2, textHeight + 2, \"top_center\", \"top_center\", inherit, 1) \n HallsPanel.Add(HallsLoc)\n \n LocText = newText(0, 1, screenW - (buttonSize + 1) * 2, textHeight, \"top_center\", \"top_center\", inherit, \"center\", locNameArt[locIndex])\n HallsLoc.Add(LocText)\n\n locLeftButton = newButton(-(screenW / 2) + 3, 1 + textHeight / 2, 3, 3, \"top_center\", \"top_center\", inherit, 1, \"<\", leftLoc) \n HallsPanel.Add(locLeftButton)\n\n locRightButton = newButton((screenW / 2) - 4, 1 + textHeight / 2, 3, 3, \"top_center\", \"top_center\", inherit, 1, \">\", rightLoc) \n HallsPanel.Add(locRightButton)\n\n //Stars panel\n locStarsPanel = newPanel(-screenW / 4, 3 + textHeight, 11, 3, \"top_center\", \"top_center\", inherit, 1) \n HallsPanel.Add(locStarsPanel)\n\n locStarsText = newText(0, 1, 9, 3, \"top_center\", \"top_center\", inherit, \"center\", \"[color=#white]☆ ☆ ☆ ☆ ☆[/color]\")\n locStarsPanel.Add(locStarsText)\n\n starsLeftButton = newButton(-8 - screenW / 4, 3 + textHeight, 3, 3, \"top_center\", \"top_center\", inherit, 1, \"<\", leftStars) \n HallsPanel.Add(starsLeftButton)\n\n starsRightButton = newButton(8 - screenW / 4, 3 + textHeight, 3, 3, \"top_center\", \"top_center\", inherit, 1, \">\", rightStars) \n HallsPanel.Add(locLeftButton)\n\n //Splits panel\n hallSplitsPanel = newPanel(screenW / 4 - 5, 3 + textHeight, sizeHallsRow + 2, sizeHallsCol, \"top_center\", \"top_center\", inherit, 2) \n HallsPanel.Add(hallSplitsPanel)\n \n hallSplitsColumn = newText(1, 1, sizeBlock, noSDHalls + 2, \"top_left\", \"top_left\", inherit, \"left\", \"\")\n hallSplitsPanel.Add(hallSplitsColumn)\n \n hallBestColumn = newText(1 + sizeBlock, 1, sizeBlock, noSDHalls + 2, \"top_left\", \"top_left\", inherit, \"center\", \"\")\n hallSplitsPanel.Add(hallBestColumn)\n \n hallResetsColumn = newText(1 + sizeBlock * 2, 1, sizeBlock, noSDHalls + 2, \"top_left\", \"top_left\", inherit, \"center\", \"\")\n hallSplitsPanel.Add(hallResetsColumn)\n \n hallUpButton = newButton(-5, 1, 3, 3, \"top_left\", \"top_left\", inherit, 1, \"↑\", upArrowHalls)\n hallSplitsPanel.Add(hallUpButton)\n\n hallDownButton = newButton(-5, sizeHallsCol - 4, 3, 3, \"top_left\", \"top_left\", inherit, 1, \"↓\", downArrowHalls)\n hallSplitsPanel.Add(hallDownButton)\n \n //Utility buttons\n switchFormatButton = newButton(-8 - screenW / 4, 4 + textHeight + sizeHallsCol / 3, 8, 4, \"center_center\", \"top_center\", inherit, 1, \"\", switchFormat)\n HallsPanel.Add(switchFormatButton)\n \n switchFormatText = newText(-8 - screenW / 4, 5 + textHeight + sizeHallsCol / 3, 8, 4, \"center_center\", \"top_center\", inherit, center, \"SWITCH\\nFORMAT\")\n HallsPanel.Add(switchFormatText)\n\n switchTimingButton = newButton(8 - screenW / 4, 4 + textHeight + sizeHallsCol / 3, 8, 4, \"center_center\", \"top_center\", inherit, 1, \"\", switchTiming)\n HallsPanel.Add(switchTimingButton)\n \n switchTimingText = newText(8 - screenW / 4, 5 + textHeight + sizeHallsCol / 3, 8, 4, \"center_center\", \"top_center\", inherit, center, \"SWITCH\\nTIMING\")\n HallsPanel.Add(switchTimingText)\n\n resetStarButton = newButton(-8 - screenW / 4, screenH - sizeHallsCol / 3, 8, 4, \"center_center\", \"top_center\", inherit, 1, \"\", resetStar)\n HallsPanel.Add(resetStarButton)\n \n resetStarText = newText(-8 - screenW / 4, screenH - sizeHallsCol / 3 + 1, 8, 4, \"center_center\", \"top_center\", inherit, center, \"RESET\\nSTAR\")\n HallsPanel.Add(resetStarText)\n\n resetAllButton = newButton(8 - screenW / 4, screenH - sizeHallsCol / 3, 8, 4, \"center_center\", \"top_center\", inherit, 1, \"\", resetAll)\n HallsPanel.Add(resetStarButton)\n \n resetAllText = newText(8 - screenW / 4, screenH - sizeHallsCol / 3 + 1, 8, 4, \"center_center\", \"top_center\", inherit, center, \"RESET\\nALL\")\n HallsPanel.Add(resetStarText)\n\n versionText = newText(- screenW / 2 + 1, screenH - 1, 15, 1, \"bottom_left\", \"top_left\", true, \"left\", version)\n HallsPanel.Add(versionText)\n\n exitButton = newButton(screenW / 2 - 1, screenH - 1, 6, 3, \"bottom_right\", \"top_center\", true, 1, \"EXIT\", exitHalls)\n HallsPanel.Add(exitButton)\n\n //Update the splits\n updateHallSplits(locArray[locIndex][0], curStar)\n\n//Main\n?swType = 0\n //Check if Halls or Splits (or none)\n swTimeFormat = getStorage(\"GLOBAL\", \"SETTINGS\", \"TIME\", \"FORMAT\", 1)\n swTimingType = getStorage(\"GLOBAL\", \"SETTINGS\", \"TIMING\", \"TYPE\", 1)\n ?locName = \"deadwood waterfall\"\n  swType = 1\n :?locStars > 0 & !loc.isQuest\n  swType = 2\n :\n  swType = 3\n?swType = 1\n //Hall of fame stuff\n ?loc.begin\n  createHall()\n:?swType = 2\n //Save system\n ?loc.begin\n  //Initialize system\n  //Reset vars\n  resetLoop()\n\n  //Increase reset count cus yes\n  incrStorage(locName, locStars, \"BEST\", \"RESETS\")\n  totalResets = getStorage(locName, locStars, \"BEST\", \"RESETS\", 0)\n\n  //Check for splits string\n  ?hasStorage(locName, locStars, \"SPLITS\", \"STRING\")\n   //If exists\n   //Get splits array\n   splitsArray = string.Split(getStorage(locName, locStars, \"SPLITS\", \"STRING\", \"\"), \"$\")\n   splitsSize = splitsArray.Count()\n   splitsExist = true\n   currentSplitID = 0\n   currentSplitString = splitsArray[currentSplitID]\n\n   //Get all other storage values\n   sumBest = 0\n   for i = 0..splitsSize-1\n    currentArray.Add(-1)\n    bestArray.Add(getStorage(locName, locStars, \"BEST\", splitsArray[i], 99999))\n    resetsArray.Add(getStorage(locName, locStars, \"RESETS\", splitsArray[i], 0))\n\n    currentSegmentArray.Add(-1)\n    bestSegmentArray.Add(getStorage(locName, locStars, \"BEST-SEGMENT\", splitsArray[i], 99999))\n    sumBest = sumBest + bestSegmentArray[i]\n    resetsSegmentArray.Add(getStorage(locName, locStars, \"RESETS-SEGMENT\", splitsArray[i], 0))\n   \n   var tempSum\n   tempSum = sumBest\n   for i = 0..splitsSize-1\n    sumSegmentArray.Add(tempSum)\n    tempSum -= bestSegmentArray[i]\n   sumSegmentArray.Add(tempSum)\n   projectedTime = sumSegmentArray[0]\n\n  :\n   //If not exists\n   splitsArray = []\n   splitsSize = 0\n   splitsExist = false\n   currentSplitString = \"CURRENT\"\n   swCurr = 1\n\n  //These 2 should always exist\n  totalResets = getStorage(locName, locStars, \"BEST\", \"RESETS\", 1)\n  samePace = getStorage(locName, locStars, \"BEST\", \"COUNT\", 1)\n  \n\n  //Create UI\n  createUI((splitsSize>noSDed),(splitsExist & !swTimingType))\n  updateSplits()\n\n ?loc.loop\n  //Reset on loop\n  //Deal with splits\n  ?splitsExist\n   //End \"END\" split\n   currentArray[currentSplitID] = lastTime\n   resetsArray[currentSplitID] = resetsArray[currentSplitID]+1\n   incrStorage(locName, locStars, \"RESETS\", splitsArray[currentSplitID])\n   \n   //Update segments\n   setSegment(lastTime)\n\n   //Save splits\n   var currentEnd\n   var bestEnd\n   currentEnd = currentArray[currentSplitID]\n   bestEnd = bestArray[currentSplitID]\n   ?currentEnd < bestEnd\n    totalResets = 1\n    samePace = 1\n    setStorage(locName, locStars, \"BEST\", \"RESETS\", 1)\n    setStorage(locName, locStars, \"BEST\", \"COUNT\", 1)\n    for i = 0..splitsSize-1 \n     bestArray[i] = currentArray[i]\n     setStorage(locName, locStars, \"BEST\", splitsArray[i], currentArray[i])\n     currentArray[i] = -1\n     currentSegmentArray[i] = -1\n   :\n    totalResets++\n    setStorage(locName, locStars, \"BEST\", \"RESETS\", totalResets)\n    ?currentEnd = bestEnd\n     samePace++\n     setStorage(locName, locStars, \"BEST\", \"COUNT\", samePace)\n    for i = 0..splitsSize-1\n     currentArray[i] = -1\n     currentSegmentArray[i] = -1\n   \n   //Edit sum array\n   var tempSum\n   tempSum = sumBest\n   for i = 0..splitsSize-1\n    sumSegmentArray[i] = tempSum\n    tempSum -= bestSegmentArray[i]\n  :\n   //End \"END\" split\n   setSegment(lastTime)\n   setSplit(currentSplitString, \"\", lastTime, 0)\n   \n   //Set splits array\n   setStorage(locName, locStars, \"SPLITS\", \"STRING\", string.Join(\"$\", splitsArray))\n   splitsSize = splitsArray.Count()\n   splitsExist = true\n  \n   //Save splits\n   for i = 0..splitsSize-1\n    sumBest = sumBest + bestSegmentArray[i]\n    bestArray.Add(currentArray[i])\n    setStorage(locName, locStars, \"BEST\", splitsArray[i], currentArray[i])\n    currentArray[i] = -1\n    currentSegmentArray[i] = -1\n   \n   //Create sum array\n   var tempSum\n   tempSum = sumBest\n   for i = 0..splitsSize-1\n    sumSegmentArray.Add(tempSum)\n    tempSum -= bestSegmentArray[i]\n   sumSegmentArray.Add(tempSum)\n\n  projectedTime = sumSegmentArray[0]\n\n  //Reset vars\n  resetLoop()\n  currentSplitID = 0\n  currentSplitString = splitsArray[currentSplitID]\n\n  //Recreate UI\n  createUI((splitsSize>noSDed),(!swTimingType))\n  updateSplits()\n \n //Splits system\n //Room splits: ROOMi\n //Miniboss splits: MINIBOSS\n //Boss splits: BOSS\n \n ?splitsExist\n  //If splits array has been saved\n  ?swCurr\n   //ROOM/MINIBOSS split\n   ?lastScreen ! screen.i\n    setSegment(lastTime)\n    setSplit(\"\", \"\", lastTime, 1)\n    lastScreen = screen.i\n  :?swPBoss\n   //PRE-BOSS split\n   ?foeString = \"phase\" & foe.state > 0\n    setSegment(lastTime)\n    setSplit(\"\", \"\", lastTime, 1)\n    lastScreen = screen.i\n  :?phaseBoss > 0\n   //PHASE split\n   ?startBoss \n    ?foeHP <= 0 & foeString = phase & foeString ! \"Morel, \"\n     setSegment(lastTime)\n     setSplit(\"\", \"\", lastTime, 1)\n     startBoss = 0\n     lastScreen = screen.i\n   :?foeHP > 0 & foeString = phase\n    startBoss = 1   \n :\n  //If not, activate auto-detection\n  ?swCurr\n   //CURRENT split\n   ?lastScreen ! screen.i\n    //If new screen, add split to padding\n    padding.Add([\"ROOM\"+lastScreen, lastTime])\n    lastScreen = screen.i\n   ?foeDist <= 35 + screen.x - pos.x\n    //If meet enemy, end CURRENT split\n    ?foeString = \"phase\"\n     //If enemy is boss\n     ?foe.state > 0\n      //Boss fight started\n      setSegment(lastTime)\n      setSplit(\"PRE-BOSS\", \"PHASE1\", lastTime, 1)\n      phaseBoss = 1\n     :\n      //Boss fight not started yet\n      switchSplit(\"PRE-BOSS\")\n      swPBoss = 1\n     swCurr = 0\n     padding.Clear()\n    :\n     //If enemy is normal, resolve all padding\n     var lastPad \n     lastPad = padding.Count() - 1\n     ?lastPad >= 0\n      for i = 0..lastPad\n       currentSplitString = padding[i][0]\n       setSegment(padding[i][1])\n       setSplit(padding[i][0], \"\", padding[i][1], 0)\n     ?foeString = boss | foeString = \"wasp nest\"\n      //Start Miniboss\n      switchSplit(\"MINIBOSS\")\n      swMBoss = 1\n     :\n      //Start new room \n      switchSplit(\"ROOM\" + screen.i)\n     swCurr = 0\n     padding.Clear()\n   :?locName ! loc.name\n    //Start pre-boss\n    switchSplit(\"PRE-BOSS\")\n    swCurr = 0\n    swPBoss = 1\n\n  :?swPBoss \n   //\"PRE-BOSS\" split\n   ?foeString = phase & foe.state > 0\n    //If boss has switched out of state 0 -> battle start\n    setSegment(lastTime)\n    setSplit(currentSplitString, \"PHASE1\", lastTime, 1)\n    swPBoss = 0\n    phaseBoss = 1\n \n  :?phaseBoss > 0 \n   //\"BOSS\" split\n   ?pickup\n    //If found pickup, switch to \"END\"\n    switchSplit(\"END\")\n    phaseBoss = 0\n    lastScreen = screen.i\n   :?startBoss \n    ?foeHP <= 0 & foeString = phase & foeString ! \"Morel, \"\n     //switches between each phase\n     phaseBoss++\n     setSegment(lastTime)\n     setSplit(currentSplitString, \"PHASE\" + phaseBoss, lastTime, 1)\n     startBoss = 0\n   :?foeHP > 0 & foeString = phase\n    startBoss = 1\n  \n  :?screen.i ! lastScreen\n   //screen/loc change\n   ?swMBoss\n    //after miniboss is always pre-boss\n    ?foeDist <= screenW + screen.x - pos.x & foeString = phase & foe.state > 0\n     setSegment(lastTime)\n     setSplit(currentSplitString, \"PHASE1\", lastTime, 1)\n     phaseBoss = 1\n    :\n     setSegment(lastTime)\n     setSplit(currentSplitString, \"PRE-BOSS\", lastTime, 1)\n     padding.Clear()\n     swPBoss = 1\n     swMBoss = 0\n \n   :?locName ! loc.name \n    //if loc name has changed -> entered subloc\n    setSegment(lastTime)\n    setSplit(currentSplitString, \"PRE-BOSS\", lastTime, 1)\n    swPBoss = 1\n    padding.Clear()\n\n   :?foeDist <= screenW + screen.x - pos.x\n    ?foeString = \"phase\"\n     ?foe.state > 0\n      //Save pre-boss, start boss\n      setSegment(lastTime)\n      setSplit(\"PRE-BOSS\", \"PHASE1\", lastTime, 1)\n      phaseBoss = 1\n     :\n      //Start pre-boss\n      switchSplit(\"PRE-BOSS\")\n      swPBoss = 1\n    :\n     //Not pre-boss, end split\n     ?foeString = boss | foeString = \"wasp nest\"\n      //Start Miniboss\n      setSegment(lastTime)\n      setSplit(currentSplitString, \"MINIBOSS\", lastTime, 1)\n      swMBoss = 1\n     :\n      //Start new room \n      setSegment(lastTime)\n      setSplit(currentSplitString, \"ROOM\" + screen.i, lastTime, 1)\n   :?!swCurr\n    //Activate CURRENT split\n    setSegment(lastTime)\n    setSplit(currentSplitString, \"CURRENT\", lastTime, 1)\n    swCurr = 1\n   lastScreen = screen.i\n lastTime = totaltime\n //Printing\n //Constantly update current split\n updateCurrent()"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/FreeChestTracker.txt" - Parse error: Failed to parse completely. Remaining: "= \"#FF0000\"\n//the indicator. Top left is centered on the skull, use the offsets below to adjust to correct position\nvar chestLocSymbol = ascii\n▼\n#\n#\nasciiend\n//offsets\nvar offSymbolX = 0 //x\nvar offSymbolY = -2 //y\n\n/* ===================\n    End Customisation\n   =================== */\n\n\n\n//0 = left, 1 = middle, 2 = right\nvar RIGHT = 2\nvar LEFT = 0\nvar MIDDLE = 1\nvar chestLoc = MIDDLE \n\nvar eps = \"ε\"\nvar xx\nvar yy\n\nvar baseCol = \"#101010\"\nvar detectCol = \"#00FF00\"\n\nvar detectLock = MIDDLE\n\n//switch detection points\nvar midX\nvar midY\nvar x1\nvar y1\nvar x2\nvar y2\nvar char1\nvar char2\n\n//chest points\nvar cx1\nvar cx2\nvar cx3\nvar cy1\nvar cy2\nvar cy3\n\nfunc Main()\n    ? loc = \"undead_crypt_intro\" & pos.x >= 52\n            \n        //time to track the free chest\n\t\t//compute all the screen space points to check regardless of window size\n        //loc1 is mounted\n        midX = screen.w/2\n        midY = screen.h/2\n        //calc swapping detection points\n        x1 = midX-3\n        y1 = midY-7\n        x2 = midX+3\n        y2 = midY-4\n        //calc check detection points\n        cx1 = midX-7\n        cy1 = midY-10\n        cx2 = midX-1\n        cy2 = midY-7\n        cx3 = midX+5\n        cy3 = midY-4\n\t\t\n\t\t//Do chest tracking\n        //get the symbols at each location\n        char1 = draw.GetSymbol(x1, y1)\n        char2 = draw.GetSymbol(x2, y2)\n\n        ? char1 = \"\\\"\" | char1 = \"^\"\n            ? detectLock = MIDDLE\n                drawbg(x1, y1, detectCol)\n                //swaping left and mid\n                ? chestLoc = MIDDLE\n                    chestLoc = LEFT\n                :? chestLoc = LEFT\n                    chestLoc = MIDDLE\n                //loc.pause()\n                detectLock = LEFT\n        :\n            drawbg(x1, y1, baseCol)\n            ? detectLock = LEFT\n                detectLock = MIDDLE\n            \n        ? char2 = \"\\\"\" | char2 = \"^\"\n            ? detectLock = MIDDLE\n                drawbg(x2, y2, detectCol)\n                //swapping right and mid\n                ? chestLoc = RIGHT\n                    chestLoc = MIDDLE\n                :? chestLoc = MIDDLE\n                    chestLoc = RIGHT\n                detectLock = RIGHT\n        :\n            drawbg(x2, y2, baseCol)\n            ? detectLock = RIGHT\n                detectLock = MIDDLE\n        \n        ? draw.GetSymbol(cx1, cy1) = eps\n            drawbg(cx1, cy1, detectCol)\n            chestLoc = LEFT\n            //loc.pause()\n        :\n            drawbg(cx1, cy1, baseCol)\n            \n        ? draw.GetSymbol(cx2, cy2) = eps\n            drawbg(cx2, cy2, detectCol)\n            chestLoc = MIDDLE\n            //loc.pause()\n        :\n            drawbg(cx2, cy2, baseCol)\n            \n        ? draw.GetSymbol(cx3, cy3) = eps\n            drawbg(cx3, cy3, detectCol)\n            chestLoc = RIGHT\n            //loc.pause()\n        :\n            drawbg(cx3, cy3, baseCol)\n        \n        ? chestLoc = LEFT\n            xx = cx1+3+offSymbolX\n            yy = cy1+offSymbolY\n            >`@xx@,@yy@,@chestLocCol@,@chestLocSymbol@\n        :? chestLoc = MIDDLE\n            xx = cx2+3+offSymbolX\n            yy = cy2+offSymbolY\n            >`@xx@,@yy@,@chestLocCol@,@chestLocSymbol@\n        :? chestLoc = RIGHT\n            xx = cx3+3+offSymbolX\n            yy = cy3+offSymbolY\n            >`@xx@,@yy@,@chestLocCol@,@chestLocSymbol@\n\t\t\t\n//for seamless mode\nfunc drawbg(xx, yy, col)\n\t? seamlessMode\n\t\treturn\n\tdraw.Bg(xx, yy, col)"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/BossBar.txt" - Parse error: Failed to parse completely. Remaining: "= ＂＂ //health and armor\r\nvar CharCount = 0\r\nvar Blocks = 43\r\nvar ArmorBlocks = ＂▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀＂\r\nvar ArmorFades = ＂▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀＂\r\nvar HealthFade\r\nvar BossHPLost\r\nvar BossAPLost\r\nvar HPBarLength\r\nvar HPBarLength2\r\nvar APBarLength = 0\r\nvar APBarLength2 = 0\r\n\r\nfunc MorelAP()\r\n  ?lstar = 5\r\n    BossTAP = 50\r\n  :?lstar = 6\r\n    BossTAP = 100\r\n  :?lstar = 7\r\n    BossTAP = 150\r\n  :?lstar = 8\r\n    BossTAP = 200\r\n  :?lstar = 9\r\n    BossTAP = 250\r\n  :?lstar = 10\r\n    BossTAP = 300\r\n  :?lstar = 11\r\n    BossTAP = 200\r\n  :?lstar = 12\r\n    BossTAP = 250\r\n  :?lstar = 13\r\n    BossTAP = 300\r\n  :?lstar = 14\r\n    BossTAP = 350\r\n  :?lstar = 15\r\n    BossTAP = 400\r\n\r\n\r\nfunc DysanAP()\r\n  ?lstar = 5\r\n    BossTAP = 500\r\n  :?lstar = 6\r\n    BossTAP = 1850\r\n  :?lstar = 7\r\n    BossTAP = 2000\r\n  :?lstar = 8\r\n    BossTAP = 2170\r\n  :?lstar = 9\r\n    BossTAP = 2335\r\n  :?lstar = 10\r\n    BossTAP = 2500\r\n  :?lstar = 11\r\n    BossTAP = 3300\r\n  :?lstar = 12\r\n    BossTAP = 3725\r\n  :?lstar = 13\r\n    BossTAP = 4150\r\n  :?lstar = 14\r\n    BossTAP = 4575\r\n  :?lstar = 15\r\n    BossTAP = 5000\r\n\r\nfunc BossStats()\r\n  BossHP = foe.hp\r\n  BossAP = foe.armor\r\n  BossTHP = foe.maxhp\r\n  ?foe ! \"Dysangelos\" & foe ! \"Morel\"\r\n    BossTAP = foe.maxarmor\r\n  :?foe = \"Dysangelos\"\r\n    DysanAP()\r\n  :?foe = \"Morel\"\r\n    MorelAP()\r\n  BossHPLost = (BossTHP - BossHP) //health lost\r\n  ?BossHPLost >= BossTHP\r\n    BossHPLost = BossTHP\r\n  BossAPLost = (BossTAP - BossAP) //armor lost\r\n  ?BossAPLost >= BossTAP\r\n    BossAPLost = BossTAP\r\n\r\n  ?BossHP <= 0 & foe = ＂boss＂\r\n    BossHP = 0 //stops -hp\r\n  ?BossAP <= 0 & foe = ＂boss＂\r\n    BossAP = 0 //stops -ap\r\n  ?BossAP ! 0\r\n    BarText = BossAP+＂│＂+BossTAP\r\n    CharCount = string.Size(BarText + ＂＂)\r\n  :\r\n    BarText = BossHP+＂│＂+BossTHP\r\n    CharCount = string.Size(BarText + ＂＂)\r\n\r\n?foe = ＂boss＂\r\n  BossStats()\r\n\r\n\r\n//─────────────────────────────────────────────────────────────────\\\\\r\n\r\nvar BossBarText\r\nvar BossBar\r\nvar BossAPFade\r\nvar BossArmorBar\r\nvar LastHPBarLength = 0\r\nvar LastAPBarLength = 0\r\n?totaltime = 1\r\n  BossBar = ui.AddPanel() //Adds outline of bar\r\n  BossBar.w = 45 //length of bar\r\n  BossBar.h = 3 //height of bar\r\n  BossBar.x = BarX //X position of bar\r\n  BossBar.y = BarY //Y position of bar\r\n\r\n  BossAPFade = ui.AddText() //Fade of AP decreasing\r\n  BossBar.Add(BossAPFade)\r\n  BossAPFade.w = 43\r\n  BossAPFade.h = 0\r\n  BossAPFade.anchor = center_center\r\n  BossAPFade.text = ArmorFades\r\n  BossAPFade.color = #373535\r\n\r\n  BossArmorBar = ui.AddText() //Blocks for boss AP\r\n  BossBar.Add(BossArmorBar)\r\n  BossArmorBar.w = 43\r\n  BossArmorBar.h = 0\r\n  BossArmorBar.anchor = center_center\r\n  BossArmorBar.color = #5b5b5b //#ADD8E6\r\n\r\n  BossBarText = ui.AddText() //Writes boss HP & AP\r\n  BossBar.Add(BossBarText)\r\n  BossBarText.h = -4\r\n  BossBarText.anchor = center_center\r\n\r\n?foe = ＂boss＂\r\n  BossBar.visible = true\r\n  BossBarText.visible = true\r\n  BossArmorBar.visible = true\r\n  BossAPFade.visible = true\r\n:\r\n  BossBar.visible = false\r\n  BossBarText.visible = false\r\n  BossArmorBar.visible = false\r\n  BossAPFade.visible = false\r\n\r\n\r\n?foe = ＂boss＂\r\n  BossArmorBar.text = ArmorBlocks\r\n  BossBarText.text = BarText //Writes boss HP & AP\r\n  BossBarText.w = CharCount //Length of # or ABC\r\n\r\n\r\n  ?BossAP > 0\r\n    APBarLength = 43 - (43 * BossAPLost / BossTAP) //determines ap blocks\r\n    HPBarLength = 43 //max hp since\tonly attacking armor\r\n    ?APBarLength2 ! APBarLength\r\n      LastAPBarLength = APBarLength2\r\n    APBarLength2 = APBarLength\r\n  :\r\n    APBarLength = 0 //armor = 0\r\n    LastAPBarLength = 0 //armorfade = 0\r\n    HPBarLength = 43 - (43 * BossHPLost / BossTHP) //determines hp blocks\r\n    ?HPBarLength2 ! HPBarLength\r\n      LastHPBarLength = HPBarLength2\r\n    HPBarLength2 = HPBarLength\r\n\r\n  ?HPBarLength <= 42\r\n    draw.bg(22, 2, #330000, LastHPBarLength, 1) //makes hp fade according to dmg dealt\r\n\t?HPBarLength <= 0\r\n      draw.bg(22, 2, #330000, 0, 1) //failsafe to make bar length 0\r\n\r\n  draw.bg(22, 2, #7f0000, HPBarLength, 1) //makes hp bar\r\n\r\n  BossArmorBar.text = string.Sub(ArmorBlocks, 0, APBarLength) //makes curr armor\r\n  BossAPFade.text = string.Sub(ArmorFades, 0, LastAPBarLength) //makes armor fade"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/MusicBox.txt" - Parse error: Failed to parse completely. Remaining: "=#4169e1  //for music display\nvar color2=#green  //for ambience display\n//-~-~-MainCode-~-~-\\\\\nvar uiAB=ui.AddButton\nvar track\nvar atrack\nvar number\nvar anumber\nvar avolume=1\nvar tracksMobile=[\ncross_deadwood_river,rocky_plateau_4,\n^rocky_plateau_talk,rocky_plateau_fight,\n^rocky_plateau_epilogue,deadwood_3,tree_boss,\n^caustic_caves,spider_boss,fungus_forest_3,\n^mushroom_boss,shop,uulaa,undead_crypt_intro,\n^undead_crypt_3,skeleton_boss,bronze_mine_3,\n^bronze_guardian_3,icy_ridge_3,yeti,temple_3,\n^nagaraja,osteophone,bone_factory,slave_outro_climb,\n^slave_outro_loop,bridge_broken,bridge_crossing\n]\nvar tracksPC=[\ncross_deadwood_river,cross_deadwood_wind,deadwood_0,\n^deadwood_1,deadwood_2,deadwood_3,deadwood_4,\n^deadwood_5,deadwood_cyan,tree_boss,waterfall_descent,\n^poena,caustic_caves,spider_boss,fungus_forest_0,\n^fungus_forest_1,fungus_forest_2,fungus_forest_3,\n^fungus_forest_4,fungus_forest_5,fungus_forest_cyan,\n^mushroom_boss,mushroom_boss_cyan,shop,skeleton_boss,\n^undead_crypt_0,undead_crypt_1,undead_crypt_2,\n^undead_crypt_3,undead_crypt_4,undead_crypt_5,\n^undead_crypt_cyan,undead_crypt_intro,bronze_guardian_3,\n^bronze_guardian_4,bronze_guardian_5,bronze_guardian_cyan,\n^bronze_mine_0,bronze_mine_1,bronze_mine_2,\n^bronze_mine_3,bronze_mine_4,bronze_mine_5,\n^bronze_mine_cyan,slave_outro_climb,slave_outro_loop,\n^bridge_broken,bridge_crossing,icy_ridge_0,\n^icy_ridge_1,icy_ridge_2,icy_ridge_3,icy_ridge_4,\n^icy_ridge_5,icy_ridge_cyan,yeti,nagaraja,\n^temple_0,temple_1,temple_2,temple_3,temple_4,\n^temple_5,temple_cyan,rocky_plateau_0,rocky_plateau_1,\n^rocky_plateau_2,rocky_plateau_3,rocky_plateau_4,\n^rocky_plateau_5,rocky_plateau_epilogue,rocky_plateau_fight,\n^rocky_plateau_talk,event_fall,event_hamartia,event_spring,\n^event_stonejam,event_summer,event_winter,credits,\n^main_menu,bone_factory,osteophone,uulaa\n]\nvar tracksAmbience=[\nambient_mines,ambient_caves,ambient_bronze_gate,\n^ambient_deadwood,ambient_mushroom,ambient_bridge,ambient_icy,\n^ambient_cave,ambient_rocky,ambient_temple,ambient_crypt,\n^ambient_haunted_gate,ambient_pallas,waterfall_a,waterfall_b,\n^waterfall_c\n]\n//4 slots for ambience audio\nvar invis = ui.AddStyle(\"#########\")\nvar musictime=0\nvar playbtn\nvar aplaybtn\nvar forward\nvar aforward\nvar backward\nvar abackward\nvar loopbtn\nvar loop=false\nvar shufflebtn\nvar shuffle=false\nvar upbtn\nvar downbtn\nvar paused=false\nvar apaused=false\nvar swapbtn\nvar stype=\"music\"\nvar btnpanel\nvar stereo\nvar display\nvar adisplay\nvar text\nvar temp=0\nvar onpc=sys.isPC\n\nfunc PlayMusic(btn)\n  ?btn=playbtn\n    paused=!paused\n  :?btn=aplaybtn\n    apaused=!apaused\n\nfunc MoveTrack(btn)\n  ?btn=loopbtn\n    loop=!loop\n    shuffle=false\n  :?btn=shufflebtn\n    shuffle=!shuffle\n    loop=false\n  :?btn=forward\n    number++\n    ?onpc\n      ?number>tracksPC.Count()-1\n        number=0\n    :\n      ?number>tracksMobile.Count()-1\n        number=0\n  :?btn=backward\n    number--\n    ?onpc\n      ?number<0\n        number=tracksPC.Count()-1\n    :\n      ?number<0\n        number=tracksMobile.Count()-1\n  ?loop\n    loopbtn.tcolor=#green\n  :\n    loopbtn.tcolor=#white\n  ?shuffle\n    shufflebtn.tcolor=#green\n  :\n    shufflebtn.tcolor=#white\n  ?onpc\n    track=tracksPC[number]\n  :\n    track=tracksMobile[number]\n  ?!paused\n    music.Play(track)\n  storage.Set(\"number\",number)\n  temp=0\n\nfunc AMoveTrack(btn)\n  ?btn=upbtn&avolume<3\n    avolume++\n  :?btn=downbtn&avolume>0\n    avolume--\n  :?btn=aforward\n    anumber++\n    ?anumber>tracksAmbience.Count()-1\n      anumber=0\n  :?btn=backward\n    anumber--\n    ?anumber<0\n      anumber=tracksAmbience.Count()-1\n  atrack=tracksAmbience[anumber]\n  ambient.Stop()\n  for t = 0..avolume\n    ambient.Add(atrack)\n  storage.Set(\"anumber\",anumber)\n  temp=0\n\nfunc Display()\n  ?stype=\"music\"\n    ?string.Size(track)<=13\n      display.text=track\n    :?totaltime%30=0\n      ?temp=string.Size(track)+1\n        temp=0\n      text=string.Join(\" \",[track,track])\n      text=string.Sub(text,temp,13)\n      temp++\n      display.text=text\n  :?stype=\"ambience\"\n    ?string.Size(atrack)<=13\n      adisplay.text=atrack\n    :?totaltime%30=0\n      ?temp=string.Size(atrack)+1\n        temp=0\n      text=string.Join(\" \",[atrack,atrack])\n      text=string.Sub(text,temp,13)\n      temp++\n      adisplay.text=text\n\nfunc Loop()\n  ?musictime>=3200&loop=true\n    number++\n    ?onpc\n      ?number>tracksPC.Count()-1\n        number=0\n      track=tracksPC[number]\n    :\n      ?number>tracksMobile.Count()-1\n        number=0\n      track=tracksMobile[number]\n    ?!paused\n      music.Play(track)\n    storage.Set(\"number\",number)\n    temp=0\n    musictime=0\n\nfunc Shuffle()\n  ?musictime>=3200&shuffle=true\n    ?onpc\n      number=0+rng%((tracksPC.Count()-1)-0+1)\n      track=tracksPC[number]\n    :\n      number=0+rng%((tracksMobile.Count()-1)-0+1)\n      track=tracksMobile[number]\n    ?!paused\n      music.Play(track)\n    storage.Set(\"number\",number)\n    temp=0\n    musictime=0\n\nfunc Swap()\n  ?stype=\"music\"\n    stype=\"ambience\"\n    btnpanel.Clear()\n    ABtns()\n    swapbtn.text=\"M\"\n  :?stype=\"ambience\"\n    stype=\"music\"\n    btnpanel.Clear()\n    Btns()\n    swapbtn.text=\"A\"\n\nfunc Btns()\n  playbtn=uiAB()\n  playbtn.y=1\n  playbtn.h=3\n  playbtn.w=3\n  playbtn.text=\"║\"\n  playbtn.SetPressed(PlayMusic)\n  shufflebtn=uiAB()\n  shufflebtn.y=1\n  shufflebtn.x=6\n  shufflebtn.h=3\n  shufflebtn.w=3\n  shufflebtn.text=\"☤\"\n  shufflebtn.SetPressed(MoveTrack)\n  forward=uiAB()\n  forward.y=1\n  forward.x=3\n  forward.h=3\n  forward.w=3\n  forward.text=\"»\"\n  forward.SetPressed(MoveTrack)\n  backward=uiAB()\n  backward.y=1\n  backward.x=-3\n  backward.h=3\n  backward.w=3\n  backward.text=\"«\"\n  backward.SetPressed(MoveTrack)\n  loopbtn=uiAB()\n  loopbtn.y=1\n  loopbtn.x=-6\n  loopbtn.h=3\n  loopbtn.w=3\n  loopbtn.text=\"∞\"\n  loopbtn.SetPressed(MoveTrack)\n  display=ui.AddText()\n  display.y=1\n  display.w=13\n  display.color=color\n  btnpanel=ui.AddPanel()\n  btnpanel.x=0\n  btnpanel.y=0\n  btnpanel.h=5\n  btnpanel.w=17\n  btnpanel.style=invis\n  btnpanel.Add(display)\n  btnpanel.Add(loopbtn)\n  btnpanel.Add(backward)\n  btnpanel.Add(playbtn)\n  btnpanel.Add(forward)\n  btnpanel.Add(shufflebtn)\n  stereo.Add(btnpanel)\n\nfunc ABtns()\n  aplaybtn=uiAB()\n  aplaybtn.y=1\n  aplaybtn.h=3\n  aplaybtn.w=3\n  aplaybtn.text=\"║\"\n  aplaybtn.SetPressed(PlayMusic)\n  upbtn=uiAB()\n  upbtn.y=1\n  upbtn.x=6\n  upbtn.h=3\n  upbtn.w=3\n  upbtn.text=\"↑\"\n  upbtn.SetPressed(AMoveTrack)\n  aforward=uiAB()\n  aforward.y=1\n  aforward.x=3\n  aforward.h=3\n  aforward.w=3\n  aforward.text=\"»\"\n  aforward.SetPressed(AMoveTrack)\n  abackward=uiAB()\n  abackward.y=1\n  abackward.x=-3\n  abackward.h=3\n  abackward.w=3\n  abackward.text=\"«\"\n  abackward.SetPressed(AMoveTrack)\n  downbtn=uiAB()\n  downbtn.y=1\n  downbtn.x=-6\n  downbtn.h=3\n  downbtn.w=3\n  downbtn.text=\"↓\"\n  downbtn.SetPressed(AMoveTrack)\n  adisplay=ui.AddText()\n  adisplay.y=1\n  adisplay.w=13\n  adisplay.color=color2\n  btnpanel=ui.AddPanel()\n  btnpanel.x=0\n  btnpanel.y=0\n  btnpanel.h=5\n  btnpanel.w=17\n  btnpanel.style=invis\n  btnpanel.Add(adisplay)\n  btnpanel.Add(upbtn)\n  btnpanel.Add(abackward)\n  btnpanel.Add(aplaybtn)\n  btnpanel.Add(aforward)\n  btnpanel.Add(downbtn)\n  stereo.Add(btnpanel)\n\n?totaltime=1\n  stereo=ui.AddPanel()\n  stereo.x=25\n  stereo.y=-11\n  stereo.h=5\n  stereo.w=17\n  stereo.color=#808080\n  swapbtn=uiAB()\n  swapbtn.x=9\n  swapbtn.y=0\n  swapbtn.h=5\n  swapbtn.w=3\n  swapbtn.text=\"A\"\n  swapbtn.SetPressed(Swap)\n  stereo.Add(swapbtn)\n  Btns()\n  number=storage.Get(\"number\",0)\n  anumber=storage.Get(\"anumber\",0)\n  ?onpc\n    track=tracksPC[number]\n  :\n    track=tracksMobile[number]\n  atrack=tracksAmbience[anumber]\n  music.Play(track)\nmusictime++\nLoop()\nShuffle()\nDisplay()\n?paused\n  music.Stop()\n  ?stype=\"music\"\n    playbtn.text=\"▶\"\n:\n  music.Play(track)\n  ?stype=\"music\"\n    playbtn.text=\"║\"\n?apaused\n  ambient.Stop()\n  ?stype=\"ambience\"\n    aplaybtn.text=\"▶\"\n:?ambient!atrack\n  ambient.Stop()\n  for t = 0..avolume\n    ambient.Add(atrack)\n  ?stype=\"ambience\"\n    aplaybtn.text=\"║\"\n//>`0,0,@paused@, this works\n//DragController\n//v1.0 by Ket\n//--User Configureable variables\nvar keepPos = true\n\n//--Internal variables, may change on updates\nvar draggables = []\nvar draggablesX = []\nvar draggablesY = []\nvar draggablesCanDrag = []\nvar ix\nvar iy\nvar oldix\nvar oldiy\nvar curIndex\nvar touched = false\nvar screenw = screen.w\nvar screenh = screen.h\nvar hasCleared = false\n\n\n//--Public Functions\n//Adds component to the array of tracked draggables.\nfunc Add(comp)\n  ?!hasCleared & loc.loop\n    draggables.Clear()\n    hasCleared=true\n  ?draggables.Contains(comp)\n    return\n    \n  draggables.Add(comp)\n  var index = draggables.Count()-1\n  ?draggablesX.Count() >= draggables.Count()\n    ?keepPos\n      comp.x = draggablesX[index]\n      comp.y = draggablesY[index]\n  :\n    draggablesCanDrag.Add(true)\n    draggablesX.Add(comp.x)\n    draggablesY.Add(comp.y)\n  \n//Removes component from array of draggables, it will no longer be tracked\nfunc Remove(comp)\n  var index = draggables.IndexOf(comp)\n  ?index ! -1\n    draggables.RemoveAt(index)\n    draggablesX.RemoveAt(index)\n    draggablesY.RemoveAt(index)\n    draggablesCanDrag.RemoveAt(index)\n\n//Clears all draggables, for use if you want a full reset mid-run\nfunc Clear()\n  draggables.Clear()\n  draggablesX.Clear()\n  draggablesY.Clear()\n  draggablesCanDrag.Clear()\n  \n//Changes in which order the components will be dragged if they overlap,\n//as if you had called Add(comp) in a different order.\n//Highest index is the priority when picking a component to move.\n//Components added later will be on top.\n//Note: can mix up position after loop.\nfunc SetIndex(comp,index)\n  var oldindex = draggables.IndexOf(comp)\n  ?oldindex ! -1\n    var tCanDrg = draggablesCanDrag[oldindex]\n    Remove(comp)\n    ?index < 0\n      draggables.Insert(0,comp)\n      draggablesCanDrag.Insert(0,tCanDrg)\n      draggablesX.Insert(0,comp.x)\n      draggablesY.Insert(0,comp.y)\n    :?index < draggables.Count()\n      draggables.Insert(index,comp)\n      draggablesCanDrag.Insert(index,tCanDrg)\n      draggablesX.Insert(index,comp.x)\n      draggablesY.Insert(index,comp.y)\n    :\n      draggables.Add(comp)\n      draggablesCanDrag.Add(tCanDrg)\n      draggablesX.Add(comp.x)\n      draggablesY.Add(comp.y)\n      \n//Get index of component, for use with SetIndex\nfunc GetIndex(comp)\n  return draggables.IndexOf(comp)\n  \n//Enables/Disables dragging for a single component.\n//true to enable drag, false to disable.\nfunc CanDrag(comp,bool)\n  var index = draggables.IndexOf(comp)\n  ?index ! -1\n    ?bool\n      draggablesCanDrag[index] = true\n    :\n      draggablesCanDrag[index] = false\n\n//Checks for drag and updates component position\nfunc Update()\n  var key_ = key\n  ?hasCleared\n    hasCleared = false\n  ?key_ = primary\n    ix = clamp(input.x,0,screenw-1)\n    iy = clamp(input.y,0,screenh-1)\n    ?key_ = primaryBegin\n      touched = false\n      ?draggables.Count() ! 0\n        for i = (draggables.Count()-1)..0\n          ?draggables[i].parent = null\n            Remove(draggables[i])\n          :?touching(draggables[i],ix,iy) &\n          ^draggablesCanDrag[i]\n            curIndex = i\n            touched = true\n            break\n      ?touched\n        oldix = ix\n        oldiy = iy\n    ?touched & (key_ = primaryEnd |\n    ^draggablesCanDrag[curIndex] = false)\n      draggablesX[curIndex] =\n      ^draggables[curIndex].x\n      draggablesY[curIndex] =\n      ^draggables[curIndex].y\n      touched = false\n    :?touched\n      draggables[curIndex].x += ix-oldix\n      draggables[curIndex].y += iy-oldiy\n      oldix = ix\n      oldiy = iy\n    storage.Set(\"dragx\",draggablesX[0])\n    storage.Set(\"dragy\",draggablesY[0])\n\n//--Internal Functions\n//Checks if X and Y are touching the component\n//Relative to top left of the screen\nfunc touching(comp,x,y)\n  ?x = null\n    x = clamp(input.x,0,screenw-1)\n  ?y = null\n    y = clamp(input.y,0,screenh-1)\n  var compx = comp.absoluteX\n  var compy = comp.absoluteY\n  var w = comp.w\n  var h = comp.h\n  ?x >= compx &\n  ^x < (compx + w) &\n  ^y >= compy &\n  ^y < (compy + h)\n    return true\n  :\n    return false\n//Stonescript math.clamp for better performance.\nfunc clamp(num,min,max)\n  ?num < min\n    return min\n  ?num > max\n    return max\n  return num\n\n?totaltime=1\n  Add(stereo)\n  draggables[0].x=storage.get(\"dragx\",draggablesX[0])\n  draggables[0].y=storage.get(\"dragy\",draggablesY[0])\nUpdate()"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/ScrollText.txt" - Parse error: Failed to parse completely. Remaining: "= []      // These arrays\r\nvar waitCountST = []//act as a faux\r\nvar indexST = []    //dictionary w/\r\nvar targetST = []   //3 values.\r\n\r\n//helper function\r\nfunc SetNewTarget(SS,instance,\r\n^          input,inputSize,len)\r\n  var current = targetST[instance]\r\n  var next = current + len \r\n  ?next >= inputSize\r\n    return 0\r\n\r\n  ?SS = false\r\n    return next\r\n\r\n  var temp\r\n  var tempArr = []\r\n  var result=string.IndexOf(input,\r\n  ^                       “ “,next)\r\n  ?result = -1\r\n    return 0\r\n  ?result <= next + 2\r\n    temp = string.Sub(input,result)\r\n    tempArr = string.Split(temp,\r\n    ^                       true)\r\n    ?tempArr.Count() = 0\r\n      return 0\r\n    :\r\n      return string.IndexOf(input,\r\n      ^            tempArr[0],next)\r\n  //else//\r\n  var goal\r\n  for i = 1..len/2+1\r\n    goal = next-i\r\n    ?string.IndexOf(input,” “,goal)\r\n    ^= goal\r\n      return goal+1\r\n\r\n  return next // Out of smartScroll\r\n              //range\r\n  \r\n//END SetNewTarget\r\n\r\nfunc ScrollText(input,len,step,wait)\r\n  var extraSpace = “  ”\r\n  var smartScroll = true\r\n\r\n  ?input = null\r\n    input = “”\r\n  :?Type(input) ! “string”\r\n    input = “Error: Input is wrong type.”\r\n\r\n  var inputSize\r\n  input = input + extraSpace\r\n  inputSize = string.size(input)\r\n  ?len>=inputSize\r\n    return input\r\n\r\n  var instance\r\n  ?keyST.IndexOf(input) = -1\r\n    keyST.Add(input)\r\n    waitCountST.Add(0)\r\n    indexST.Add(-1)\r\n    targetST.Add(0)\r\n  instance = keyST.IndexOf(input)\r\n\r\n  ?waitCountST[instance] = 0\r\n    indexST[instance] =\r\n    ^ indexST[instance] + 1\r\n    ?indexST[instance]>=inputSize\r\n      indexST[instance] = 0\r\n\r\n    ?indexST[instance] = \r\n    ^targetST[instance]\r\n      waitCountST[instance] = wait\r\n      targetST[instance] =\r\n      ^SetNewTarget(smartScroll,\r\n      ^           instance,input,\r\n      ^             inputSize,len)\r\n    :\r\n      waitCountST[instance] = step\r\n\r\n  var output\r\n  var temp\r\n  ?indexST[instance]+len >inputSize\r\n    temp = indexST[instance] +\r\n    ^len-inputSize\r\n    output = string.Sub(input,\r\n    ^indexST[instance],len-temp)+\r\n    ^string.Sub(input,0,temp)\r\n  :\r\n    output = string.Sub(input,\r\n    ^    indexST[instance],len)\r\n  waitCountST[instance]=waitCountST[instance]-1\r\n  return output\r\n//====END OF ScrollText====\r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/BorderClock.txt" - Parse error: Failed to parse completely. Remaining: "?1//?this.draw=1 // toggle control for drawing overlay\r\n    >`@x@,@y@,@color@,@a@\r\n//////////////////////////////////////////////////\r\n\r\nvar prevsec=0\r\nvar frametime=0\r\n\r\nvar hourColor = #0000FF\r\nvar minuteColor = #00FF00\r\nvar secondColor = #FF0000\r\n\r\nfunc Show()\r\n  var total\r\n  total=screen.w*2+screen.h*2 // total slots around border\r\n\r\n  ?prevsec!time.second\r\n    frametime=0\r\n    prevsec=time.second\r\n\r\n  var sec\r\n  sec=total*time.second/60+(total*(time.second+1)/60-total*time.second/60)*frametime/30\r\n\r\n  var min\r\n  min=total*time.minute/60+(total*(time.minute+1)/60-total*time.minute/60)*time.second/60\r\n\r\n  var hour\r\n  hour=total*(time.hour%12)/12+(total*((time.hour%12)+1)/12-total*(time.hour%12)/12)*time.minute/60\r\n\r\n  draw.bg(screen.w/2,0,#white)\r\n  Output(screen.w/2,0,#000000,X)\r\n  draw.bg(screen.w-1,screen.h/2,#808080)\r\n  Output(screen.w-1,screen.h/2,#000000,3)\r\n  draw.bg(screen.w/2,screen.h-1,#808080)\r\n  Output(screen.w/2,screen.h-1,#000000,6)\r\n  draw.bg(0,screen.h/2,#808080)\r\n  Output(0,screen.h/2,#000000,9)\r\n  draw.bg(screen.w/2+(screen.w+screen.h)/6,0,#404040)\r\n  draw.bg(screen.w/2+(screen.w+screen.h)/3,0,#404040)\r\n  draw.bg(screen.w/2-(screen.w+screen.h)/6,0,#404040)\r\n  draw.bg(screen.w/2-(screen.w+screen.h)/3,0,#404040)\r\n  draw.bg(screen.w/2+(screen.w+screen.h)/6,screen.h-1,#404040)\r\n  draw.bg(screen.w/2+(screen.w+screen.h)/3,screen.h-1,#404040)\r\n  draw.bg(screen.w/2-(screen.w+screen.h)/6,screen.h-1,#404040)\r\n  draw.bg(screen.w/2-(screen.w+screen.h)/3,screen.h-1,#404040)\r\n\r\n// Adjustment for top center noon/0\r\n  sec=(sec+screen.w/2)%total\r\n  min=(min+screen.w/2)%total\r\n  hour=(hour+screen.w/2)%total\r\n\r\n  ?hourColor=\"#0000FF\"&minuteColor=\"#00FF00\"&secondColor=\"#FF0000\"\r\n    ?hour=min&hour=sec\r\n      hourColor=\"#rainFF\"\r\n    :?hour=min\r\n      hourColor=\"#00FFFF\"\r\n    :?hour=sec\r\n      hourColor=\"#FF00FF\"\r\n    :?min=sec\r\n      minuteColor=\"#FFFF00\"\r\n  ?hour=min&hour=sec\r\n    hourColor=\"#rainFF\"\r\n\r\n  ?sec<screen.w\r\n    Output(sec,0,secondColor,S)\r\n  :\r\n    sec=sec-screen.w\r\n    ?sec<screen.h\r\n      Output(screen.w-1,sec,secondColor,S)\r\n    :\r\n      sec=sec-screen.h\r\n      ?sec<screen.w\r\n        Output(screen.w-1-sec,screen.h-1,secondColor,S)\r\n      :\r\n        sec=sec-screen.w\r\n        ?sec<screen.h\r\n          Output(0,screen.h-1-sec,secondColor,S)\r\n        :\r\n          WTF=1\r\n\r\n  ?min<screen.w\r\n    Output(min,0,minuteColor,M)\r\n  :\r\n    min=min-screen.w\r\n    ?min<screen.h\r\n      Output(screen.w-1,min,minuteColor,M)\r\n    :\r\n      min=min-screen.h\r\n      ?min<screen.w\r\n        Output(screen.w-1-min,screen.h-1,minuteColor,M)\r\n      :\r\n        min=min-screen.w\r\n        ?min<screen.h\r\n          Output(0,screen.h-1-min,minuteColor,M)\r\n        :\r\n          WTF=1\r\n\r\n  ?hour<screen.w\r\n    Output(hour,0,hourColor,H)\r\n  :\r\n    hour=hour-screen.w\r\n    ?hour<screen.h\r\n      Output(screen.w-1,hour,hourColor,H)\r\n    :\r\n      hour=hour-screen.h\r\n      ?hour<screen.w\r\n        Output(screen.w-1-hour,screen.h-1,hourColor,H)\r\n      :\r\n        hour=hour-screen.w\r\n        ?hour<screen.h\r\n          Output(0,screen.h-1-hour,hourColor,H)\r\n        :\r\n          WTF=1\r\n\r\n  frametime++"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/OkamiroyUtils.txt" - Parse error: Failed to parse completely. Remaining: "?lastTime < bestTime | bestTime = 0\r\n      bestTime = lastTime\r\n    ?lastTime > worstTime | worstTime = 0\r\n      worstTime = lastTime\r\n    totalTimeSum = totalTimeSum + totalTimeCounter\r\n    totalLoop++\r\n    averageTime = totalTimeSum / totalLoop\r\n    totalTimeCounter = 0\r\n\r\n  totalTimeCounter++\r\n  ?totalTimeCounter > 9999\r\n    totalTimeCounter = 9999\r\n\r\n  var contentX = posX + 8\r\n  var contentY = posY + 1\r\n  >`@posX@,@posY@,#white,@timeStatsWindow@\r\n  >`@contentX@,@contentY@,#white,@totalLoop@\\n@lastTime@\\n@averageTime@\\n@bestTime@\\n@worstTime@\r\n\r\n//----------------------------------------------------------------------------------------------------//\r\n\r\nvar MAX_SOLID_BAR = ██████████████████████████████████████████████████\r\nvar MAX_EMPTY_BAR = __________________________________________________\r\n\r\n//----------------------------------------------------------------------------------------------------//\r\n\r\n///private\r\n///Calculate the percentage number.\r\nfunc CalcPercentage(curVal, maxVal)\r\n  ?maxVal <= 0\r\n    return 0\r\n  var percentage = 0\r\n  percentage = curVal * 100\r\n  percentage = percentage / maxVal\r\n  ?percentage = 0 & curVal > 0\r\n    percentage = 1\r\n  ?percentage < 0\r\n    percentage = 0\r\n  return percentage\r\n\r\n//----------------------------------------------------------------------------------------------------//\r\n\r\n///private\r\n///Build the bar string.\r\n///barLen: Bar's Length. 0 < barLen <= 50\r\n///showEmptyChar: If it needs to show the empty char '_'\r\nfunc BuildBarStr(curVal, maxVal, barLen, showEmptyChar)\r\n  ?barLen < 5\r\n    barLen = 5\r\n  ?barLen > 50\r\n    barLen = 50\r\n\r\n  var solidLen = 0\r\n  solidLen = curVal * barLen\r\n  solidLen = solidLen / maxVal\r\n  ?solidLen = 0 & curVal > 0\r\n    solidLen = 1\r\n  ?solidLen < 0\r\n    solidLen = 0\r\n\r\n  var emptyLen = 0\r\n  ?showEmptyChar\r\n    emptyLen = barLen - solidLen\r\n\r\n  var barStr = \"\"\r\n  ?curVal >= maxVal\r\n    barStr = string.Sub(MAX_SOLID_BAR, 0, barLen)\r\n  ?curVal < maxVal\r\n    var solidPart = \"\"\r\n    solidPart = string.Sub(MAX_SOLID_BAR, 0, solidLen)\r\n    var emptyPart = \"\"\r\n    emptyPart = string.Sub(MAX_EMPTY_BAR, 0, emptyLen)\r\n    barStr = solidPart + emptyPart\r\n  \r\n  return barStr\r\n\r\n//----------------------------------------------------------------------------------------------------//\r\n\r\n///public\r\n///Show foe's hp and armor bar\r\n///posX, posY: Bar's position relative to the upper-left corner of the screen.\r\n///barLen: Bar's Length. 0 < barLen <= 50\r\n///isBossOnly: If it shows boss' bar only\r\nfunc ShowFoesBar(posX, posY, barLen, isBossOnly)\r\n  ? !isBossOnly | (isBossOnly & foe = boss)\r\n    //Foe's hp bar\r\n    ?foe.hp > 0\r\n      var barX = posX + 5\r\n      var barY = posY\r\n\r\n      var fhpPercentage = 0\r\n      fhpPercentage = CalcPercentage(foe.hp, foe.maxhp)\r\n      >`@posX@,@posY@,#FF5050,@fhpPercentage@%  \r\n      var fhpBarStr = \"\"\r\n      fhpBarStr = BuildBarStr(foe.hp, foe.maxhp, barLen, true)\r\n      >`@barX@,@barY@,#FF5050,@fhpBarStr@\r\n \r\n    //Foe's armor bar\r\n    ?foe.armor > 0\r\n      //If foe has armor but foe.maxarmor=0, then take its maxhp as maxarmor\r\n      var fmaxarmor = 0\r\n      fmaxarmor = foe.maxarmor\r\n      ?fmaxarmor = 0\r\n        fmaxarmor = foe.maxhp\r\n      \r\n      var farmorPercentage = 0\r\n      farmorPercentage = CalcPercentage(foe.armor, fmaxarmor)\r\n      >`@posX@,@posY@,#5050FF,@farmorPercentage@%  \r\n      var farmorBarStr = \"\"\r\n      farmorBarStr = BuildBarStr(foe.armor, fmaxarmor, barLen, false)\r\n      >`@barX@,@barY@,#5050FF,@farmorBarStr@\r\n\r\n//----------------------------------------------------------------------------------------------------//\r\n\r\n///public\r\n///Show player's hp and armor bar.\r\n///posX, posY: Bar's position relative to the player's position.\r\n///barLen: Bar's Length. 0 < barLen <= 50\r\nfunc ShowPlayersBar(posX, posY, barLen)\r\n  var hpX = posX\r\n  var hpY = posY + 1\r\n  var hpBarX = hpX - barLen\r\n  var hpBarY = hpY\r\n  \r\n  //player's hp bar\r\n  var hpPercantage = 0\r\n  hpPercantage = CalcPercentage(hp, maxhp)\r\n  >o@hpX@,@hpY@,#FF5050,@hpPercantage@%\r\n  var hpBarStr = \"\"\r\n  hpBarStr = BuildBarStr(hp, maxhp, barLen, true)\r\n  >o@hpBarX@,@hpBarY@,#FF5050,@hpBarStr@\r\n  \r\n  //player's armor bar\r\n  var armorX = posX\r\n  var armorY = posY\r\n  var armorBarX = armorX - barLen\r\n  var armorBarY = armorY \r\n  \r\n  var armorPercentage = 0\r\n  armorPercentage = CalcPercentage(armor, maxhp)\r\n  var armorBarStr = \"\"\r\n  armorBarStr = BuildBarStr(armor, maxhp, barLen, true)\r\n\r\n  ?armorPercentage >= 100\r\n    >o@armorX@,@armorY@,#rainFF,@armorPercentage@%\r\n    >o@armorBarX@,@armorBarY@,#rainFF,@armorBarStr@\r\n  ?armorPercentage < 100\r\n    >o@armorX@,@armorY@,#5050FF,@armorPercentage@%\r\n    >o@armorBarX@,@armorBarY@,#5050FF,@armorBarStr@\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/CDTime.txt" - Parse error: Failed to parse completely. Remaining: "?(loc ! uulaa & loc ! undead_crypt_intro & loc ! cross deadwood river & loc ! cross bridge & loc ! Waterfall & loc ! head_heels_factory)\r\n    ?loc.begin | loc.loop\r\n      initUI(posX, posY,ifBF,ifSKA,ifMask,ifSum,false)\r\n    loopUI(false)\r\n\r\n\r\nfunc CDTimeShowCHS(posX, posY,ifBF,ifSKA,ifMask,ifSum)\r\n  disable hud a\r\n  ?(loc ! uulaa & loc ! undead_crypt_intro & loc ! cross deadwood river & loc ! cross bridge & loc ! Waterfall & loc ! head_heels_factory)\r\n    ?loc.begin | loc.loop\r\n      initUI(posX, posY,ifBF,ifSKA,ifMask,ifSum,true)\r\n    loopUI(true)\r\n\t\r\n\r\nfunc initUI(posX, posY,ifBF,ifSKA,ifMask,ifSum,ifCHS)\r\n  calculateIfShow(ifBF,ifSKA,ifMask,ifSum)\r\n  iCHS = 0\r\n  ?posX < 0\r\n    posX = posX + screen.w\r\n  ?posY < 0\r\n    posY = posY + screen.h\r\n\r\n  mainTextList.Clear()\r\n  timeTextList.Clear()\r\n  buffTextList.Clear()\r\n\r\n  mainWindow = ui.AddPanel()\r\n  mainWindow.clip = true\r\n\r\n  mainWindow.x = posX\r\n  mainWindow.y = posY\r\n  mainWindow.anchor = top_left\r\n  mainWindow.dock = top_left\r\n\tmainWindow.w = width\r\n\tmainWindow.h = height\r\n  var customStyle = ui.AddStyle(\"╔#╗║#║╚═╝\")\r\n  mainWindow.style = customStyle\r\n\r\n  mainTextInit(0,0,CDWindow)\r\n  potionInfo = getPotionInfo()\r\n  mainTextInit(x0,1,potionInfo[iCHS])\r\n  mainTextList[1].color = potionInfo[2]\r\n  mainTextList[1].align = left\r\n\r\n  for i = 0..ifShowList.Count()-1\r\n    mainTextInit(0,y1+i,mainTextWindowList[ifShowList[i]])\r\n    timeTextInit(x0+6,y1+i)\r\n    buffTextList.Add(timeTextList[0])\r\n    timeTextList.RemoveAt(0)\r\n  \r\n  ?ifSum\r\n    summonsList.IndexOf(summon.GetId())\r\n    mainTextInit(1,y1+ifShowList.Count()-1,\"\")\r\n    mainTextList[mainTextList.Count()-1].align = left\r\n  \r\n  for i = 0..weaponList.Count()-1\r\n    timeTextInit(timeTextPosList[i][0],timeTextPosList[i][1])\r\n  \r\n  ?ifCHS\r\n    mainTextList[0].text = string.Format(CDWindowCHS)\r\n    for i = 0..ifShowList.Count()-1\r\n      mainTextList[i+2].text = string.Format(mainTextWindowCHSList[ifShowList[i]])\r\n    iCHS = 1\r\n\r\nfunc loopUI(ifCHS)\r\n  ?item.potion ! Empty\r\n    potionInfo = getPotionInfo()\r\n    mainTextList[1].text = string.Format(potionInfo[iCHS])\r\n    mainTextList[1].color = potionInfo[2]\r\n  :?item.potion = Empty \r\n    mainTextList[1].color = #7f7f7f\r\n  \r\n  ?ifShowList[ifShowList.Count()-1] = 4\r\n    summonText()\r\n  timeTextList[weaponList.Count()-1].text = \"\"\r\n  for i = 0..weaponList.Count()-1\r\n    timeText(i)\r\n  for i = 0..ifShowList.Count()-1\r\n    buffText(ifShowList[i])\r\n\r\nfunc mainTextInit(x_,y_,t_)\r\n  var mainText_ = ui.AddText()\r\n  mainText_.x = x_\r\n  mainText_.y = y_\r\n\tmainText_.w = width\r\n\tmainText_.h = 0\r\n\tmainText_.align = center\r\n  mainText_.dock = top_center\r\n\tmainWindow.Add(mainText_)\r\n  mainText_.text = string.Format(t_)\r\n  mainTextList.Add(mainText_)\r\n\r\nfunc timeTextInit(x_,y_)\r\n  var timeText_ = ui.AddText()\r\n  timeText_.x = x_\r\n  timeText_.y = y_\r\n\ttimeText_.w = width\r\n\ttimeText_.h = 0\r\n\ttimeText_.align = left\r\n  timeText_.dock = top_center\r\n\tmainWindow.Add(timeText_)\r\n  timeTextList.Add(timeText_)\r\n\r\nfunc timeText(i)\r\n  equipment = weaponList[i]\r\n  ?item.GetCooldown(equipment) > 0\r\n    timeTextList[i].text = string.Format(\"[color=#FF0000]\"+item.GetCooldown(equipment)+frame_[iCHS]+\"[/color]\")\r\n  :?item.GetCooldown(equipment) = 0 & item.CanActivate() = True & item.CanActivate(equipment) = False\r\n    timeTextList[i].text = string.Format(\"[color=#00FF00]\"+RDY_[iCHS]+\"[/color]\")\r\n  :?item.GetCooldown(equipment) = 0 & item.CanActivate(equipment) = True\r\n    timeTextList[i].text = string.Format(\"[color=#FFFF00]\"+RDY_[iCHS]+\"[/color]\")\r\n  :?item.GetCooldown(equipment) = 0 & item.CanActivate() = False\r\n    timeTextList[i].text = string.Format(\"[color=#F08080]\"+WAIT_[iCHS]+\"[/color]\")\r\n\r\nfunc buffText(i)\r\n  ?i = 0\r\n    buffTextList[i].text = string.Format(\"[color=#d68910]×\"+HAdebuffTime()+frame_[iCHS]+\"[/color]\")\r\n  :?i = 1\r\n    buffTextList[i].text = string.Format(\"[color=#FF00FF]·\"+BFbuffCount()+\"[/color]\")\r\n  :?i = 2\r\n    buffTextList[i].text = string.Format(\"[color=#0000FF]≡\"+SKAbuffCount()+\"[/color]\")\r\n  \r\nfunc summonText()\r\n  var sumID = summonsList.IndexOf(summon.GetId())\r\n  ?sumID >= 0\r\n    mainTextList[mainTextList.Count()-1].text = summonsText_[sumID][iCHS]\r\n    weaponList[weaponList.Count()-1] = summonsList[sumID]\r\n  :\r\n    mainTextList[mainTextList.Count()-1].text = \"\"\r\n    weaponList[weaponList.Count()-1] = \"\"\r\n\r\nfunc calculateIfShow(ifBF,ifSKA,ifMask,ifSum)\r\n  ifShowList = [0]\r\n  ?ifBF\r\n    ifShowList.Add(1)\r\n  ?ifSKA\r\n    ifShowList.Add(2)\r\n  ?ifMask\r\n    ifShowList.Add(3)\r\n  ?ifSum\r\n    ifShowList.Add(4)\r\n  height = y1 + 1 + ifShowList.Count()\r\n  weaponList = [\"bardiche\",\"hatchet\",\"dash\",\"bash\",\"mind\",\"quarterstaff\"]\r\n  timeTextPosList = [[x0,y0],[x1,y0],[x0,y0+1],[x1,y0+1],[x0,y0+2],[x1,y0+2]]\r\n  for i = 0..ifShowList.Count()-1\r\n    weaponList.Add(weaponImpList[ifShowList[i]])\r\n    timeTextPosList.Add([x0,y1+i])\r\n\r\nfunc BFbuffCount()\r\n  var smiteCount = 0\r\n  ?buffs.count > 0\r\n    ?string.IndexOf(buffs.string,\"smite\") > 0\r\n      smiteCount = string.Sub(buffs.string, string.IndexOf(buffs.string,\"smite\") + 6, 3)\r\n      smiteCount = string.Sub(smiteCount, 0, string.IndexOf(smiteCount,\":\"))\r\n      smiteCount = int.parse(smiteCount)\r\n  return smiteCount\r\n  \r\nfunc SKAbuffCount()\r\n  var pickCount = 0\r\n  ?buffs.count > 0\r\n    ?string.IndexOf(buffs.string,\"pick_pocket\") > 0\r\n      pickCount = string.Sub(buffs.string, string.IndexOf(buffs.string,\"pick_pocket\") + 12, 3)\r\n      pickCount = string.Sub(pickCount, 0, string.IndexOf(pickCount,\":\"))\r\n      pickCount = int.parse(pickCount)\r\n  return pickCount\r\n\r\nfunc HAdebuffTime()\r\n  var armorFatTime = 0\r\n  var startIndex = -1\r\n  var endIndex = -1\r\n  ?foe.debuffs.count > 0\r\n    startIndex = string.IndexOf(foe.debuffs.string,\"debuff_armor_fatigue\")\r\n    ?startIndex > 0\r\n      endIndex = string.IndexOf(foe.debuffs.string,\",\",startIndex)\r\n      ?endIndex < 0\r\n        armorFatTime = string.Sub(foe.debuffs.string, startIndex + 23,(string.Size(foe.debuffs.string) - startIndex - 23))\r\n      :\r\n        armorFatTime = string.Sub(foe.debuffs.string, startIndex + 23, (endIndex - startIndex - 23))\r\n      armorFatTime = int.parse(armorFatTime)\r\n  return armorFatTime\r\n\r\nfunc getPotionInfo()\r\n  ?item.potion = Strength\r\n    return [\"Strength oo\",\"怪力oo#击晕与破甲\",#d68910]\r\n  :?item.potion = Experience\r\n    return [\"Experience/`\",\"经验/`#增加经验和气\",#85c1e9]\r\n  :?item.potion = Healing\r\n    return [\"Healing ~≈\",\"恢复~≈#100%回血\",#2ecc71]\r\n  :?item.potion = Lightning\r\n    return [\"Lightning .:\",\"闪电.:#150地图炮\",#a569bd]\r\n  :?item.potion = Vampiric\r\n    return [\"Vampiric ~:\",\"吸血~:#20%吸血\",#c0392b]\r\n  :?item.potion = Cleansing\r\n    return [\"Cleansing ~/\",\"净化~/#回血与状态清除\",#fcff27]\r\n  :?item.potion = Berserk\r\n    return [\"Berserk /:\",\"狂暴/:#攻速+15\",#red]\r\n  :?item.potion = Lucky\r\n    return [\"Lucky o:\",\"幸运o:#100%暴击\",#e8b233]\r\n  :?item.potion = Invisibility\r\n    return [\"Invisible o/\",\"隐形o/#完全闪避\",#a3e4d7]\r\n  :?item.potion = Defensive\r\n    return [\"Defensive ~o\",\"防御~o#回血与回盾\",#ba4a00]\r\n  :?item.potion = Empty\r\n    return [\"Empty\",\"空空如也的药瓶###\",#7f7f7f]\r\n\r\n//CDTime Window\r\nvar CDWindow = ascii\r\n╔═══#CD#Time#═══╗\r\n║PT#############║\r\n║BD######HC#####║\r\n║DS######BS#####║\r\n║MS######QS#####║\r\nasciiend\r\n\r\nvar CDWindowCHS = ascii\r\n╔═══#冷却时间#药水#═══╗\r\n║药水#############║\r\n║巴迪什#####斧头#####║\r\n║冲锋盾#####冲撞盾####║\r\n║意念石#####铁头杖####║\r\nasciiend\r\n\r\nvar HAWindow = ascii\r\n║HA#############║\r\nasciiend\r\n\r\nvar HAWindowCHS = ascii\r\n║重锤#############║\r\nasciiend\r\n\r\nvar BFWindow = ascii\r\n║BF#############║\r\nasciiend\r\n\r\nvar BFWindowCHS = ascii\r\n║堕神剑############║\r\nasciiend\r\n\r\nvar SKAWindow = ascii\r\n║SKA############║\r\nasciiend\r\n\r\nvar SKAWindowCHS = ascii\r\n║骷髅手############║\r\nasciiend\r\n\r\nvar MaskWindow = ascii\r\n║CMK############║\r\nasciiend\r\n\r\nvar MaskWindowCHS = ascii\r\n║蛇面具############║\r\nasciiend\r\n\r\nvar SumWindow = ascii\r\n║###############║\r\nasciiend\r\n\r\nvar mainWindow\r\nvar weaponImpList = [\"hammer\",\"blade\",\"skeleton_arm\",\"mask\",\"\"]\r\nvar summonsList = [\"cinderwisp\",\"voidweaver\"]\r\nvar weaponList = [\"bardiche\",\"hatchet\",\"dash\",\"bash\",\"mind\",\"quarterstaff\"]\r\nvar ifShowList = [0]\r\nvar mainTextList = []\r\nvar timeTextList = []\r\nvar buffTextList = []\r\nvar potionInfo = []\r\nvar equipment\r\nvar width = 17\r\nvar height = 7\r\nvar x0 = 4    //左列x\r\nvar x1 = 12   //右列x\r\nvar y0 = 2    //普通区y\r\nvar y1 = 5    //buff区y\r\nvar iCHS = 0\r\nvar RDY_ = [\"RDY\",\"就绪\"]\r\nvar WAIT_ = [\"WAIT\",\"等待\"]\r\nvar frame_ = [\"f\",\"帧\"]\r\nvar summonsText_ = [[\"CDW\",\"煤灰\"],[\"VW\",\"织虚者\"]]\r\nvar mainTextWindowList = [HAWindow,BFWindow,SKAWindow,MaskWindow,SumWindow]\r\nvar mainTextWindowCHSList = [HAWindowCHS,BFWindowCHS,SKAWindowCHS,MaskWindowCHS,SumWindow]\r\nvar timeTextPosList = [[x0,y0],[x1,y0],[x0,y0+1],[x1,y0+1],[x0,y0+2],[x1,y0+2]]\r\n\r\n\r\n/*\r\nUpdate information\r\nv1.0  func of cooldown time\r\nv1.1  add potion infomation(Thanks for item.potion)\r\nv1.2  add Chinese Window\r\nv1.3  add information of Skeleton Arm \r\nv2.1  now can choose whether show the cooldown time of Blade of the Fallen God and Skeleton Arm (not everyone use those).\r\nv2.2  now can use BFbuffCount() and SKAbuffCount() to return the count of \"smite\" or \"pick_pocket\" for other battle scripts\r\nv2.3  support showing more cooldown time of skills in the future\r\nv2.4  now cooldown time window disabled at Hunted Gate(undead_crypt_intro) and Hotspring Shop(uulaa_shop)\r\nv2.5  reconstruct the display function of the Lost Items' cooldown time\r\nv2.6  rewrite the document of example and update information\r\nv3.0  add the cooldown time of Cult Mask and also choose whether show\r\nv3.1  The return value of the functions BFbuffCount() and SKAbuffCount() are adjusted from string to int, and it will return 0 instead of null if there is no buff\r\nv3.2  Fixed the bug of missing single digits when the return value of BFbuffCount() is greater than 10\r\nV3.3  Fixed the bug of causing an error at the end time point of the smite buff\r\nv4.0  add the cooldown time of Heavy Hammer and can use HAdebuffTime() to return the duration of heavy hammer \"armor_fatigue\" for other scripts\r\nv4.1  adjust the UI to a hollow out style\r\nv4.2  fixed a bug where there was no recommendation code input location\r\nv5.0  refactored the script, replacing advanced print with UI namespace\r\nv5.1  add cooling information about summons' ability\r\n\r\n\r\n更新信息\r\nv1.0  显示冷却时间的功能\r\nv1.1  添加了药水信息（得益于item.potion函数的上线）\r\nv1.2  添加中文窗口\r\nv1.3  添加了关于骷髅手臂的冷却信息\r\nv2.1  现在能够选择是否显示堕神剑和骷髅手的冷却时间了（因为有些人不常用）\r\nv2.2  现在能够使用BFbuffCount() 和 SKAbuffCount() 来为其他脚本提供“重击”或者“偷窃”的层数\r\nv2.3  支持在未来进行更多的扩充\r\nv2.4  现在冷却时间窗口在闹鬼大门和温泉商店不会显示（会挡住买东西）\r\nv2.5  重构了遗物的冷却时间显示函数\r\nv2.6  重写了说明文档和更新信息\r\nv3.0  加入了那伽面具的冷却时间以及可选择其是否显示\r\nv3.1  BFbuffCount() 和 SKAbuffCount() 的返回值由string调整为int，且没有buff时会返回0，而不再是null\r\nv3.2  修正了BFbuffCount()返回值大于等于10时丢失个位数的问题\r\nv3.3  修正了重击buff在结束的时候报错的问题\r\nv4.0  加入了重锤的冷却信息并可以使用 HAdebuffTime() 来为其他脚本提供重锤“护甲疲劳”的持续时间\r\nv4.1  将UI调整为镂空风格\r\nv4.2  修复了没有推荐码输入位置的bug\r\nv5.0  重构了脚本，由上层打印更换为UI构架\r\nv5.1  添加了关于召唤物技能的冷却时间\r\n\r\n*/\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/ToolBelt.txt" - Parse error: Failed to parse completely. Remaining: "= [\r\n[ice crossbow],\r\n[aether crossbow],\r\n[trisk, star],\r\n[Heavy Hammer],\r\n[quest,compound],\r\n[trisk,bashing],\r\n[trisk,dashing],\r\n[blade],\r\n]\r\n/* \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\r\nToolBelt\r\nversion: 2.0\r\nby Incoherent Toast\r\n\r\nThis is a script that can allow the user to add\r\nloadouts to a list so that they can have access\r\nto a much larger toolbelt selection\r\n\r\nto do this you can do this:\r\nvar Tb = import UI/ToolBelt\r\nTb.Run()\r\n?loc.begin\r\n  Tb.ToolList = [\r\n[ice crossbow],\r\n[aether crossbow],\r\n[trisk, star],\r\n[Heavy Hammer],\r\n[quest,compound],\r\n[trisk,bashing],\r\n[trisk,dashing],\r\n[blade],\r\n]\r\n\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ */\r\n\r\n\r\nvar isPC = sys.isPC\r\nvar MotherPanel\r\nvar Invis = ui.AddStyle(\"#########\")\r\nvar ButtonToggle = false\r\nvar ToolbeltButton\r\nvar ToolbeltText\r\nvar SavedX = input.x\r\nvar SavedY = input.y\r\nvar ScreenW = screen.w\r\nvar ScreenH = screen.h\r\nvar RndToInt = math.RoundToInt\r\nvar Sin = math.sin\r\nvar Cos = math.cos\r\nvar Pi = math.pi\r\nvar Atan = math.atan\r\nvar v\r\nvar toolascii = ascii\r\n#┬####<)\r\n#╪═[]═╪\r\n#U####'\r\nasciiend\r\nvar ShieldIcon = ascii\r\n|`-´|\r\n|   |\r\n#`-´\r\nasciiend\r\n\r\nvar ButtonList = []\r\nfunc GenerateButtons()\r\n  var RadialDistance = math.Max(ToolList.Count()/2+1,4)\r\n  ?RadialDistance > ScreenH/2 - 1\r\n    ?RadialDistance > (5 * ScreenH) / 6\r\n      var Stagger = 3\r\n    :?RadialDistance > (5 * ScreenH) / 9\r\n      var Stagger = 2\r\n    RadialDistance = ScreenH/2 - 1\r\n  var Stagger = 1\r\n  var n = ToolList.Count()\r\n  MotherPanel = ui.AddPanel()\r\n  MotherPanel.style = Invis \r\n  for a = 0 .. n-1\r\n    var ay = RndToInt((RadialDistance - a%Stagger*3) * math.Cos(Pi-(a*2*Pi/n)))\r\n    var ax = 2*RndToInt((RadialDistance - a%Stagger*3) * math.Sin(Pi-(a*2*Pi/n)))\r\n    var Button = CreateUI(ui.AddButton(),ax,ay,5,3)\r\n    Button.style = Invis\r\n    Button.text = \"\"\r\n    Button.SetPressed(SelectTool)\r\n    ButtonList.Add(Button)\r\n    var Shield = CreateUI(ui.AddText(ShieldIcon),ax,ay,5,3)\r\n    Shield.color = #119911\r\n    var Num = CreateUI(ui.AddText(\"\"+a),ax,ay+1,10,3)\r\n    Num.align = center\r\n    MotherPanel.Add( Button )\r\n    MotherPanel.Add( Shield )\r\n    MotherPanel.Add( Num )\r\n\r\nfunc ToggleButtons()\r\n  ButtonToggle = !ButtonToggle\r\n  ?ButtonToggle\r\n    ToolbeltButton.bcolor = #202020\r\n    ToolbeltText.color = #808080\r\n    GenerateButtons()\r\n    play equip\r\n  :\r\n    ButtonList.Clear()\r\n    ?MotherPanel\r\n      MotherPanel.Recycle()\r\n    ToolbeltButton.bcolor = #808080\r\n    ToolbeltText.color = #FFFFFF\r\n    play unequip\r\n\r\nfunc CreateUI(UI,X,Y,W,H)\r\n  UI.x = X\r\n  UI.y = Y\r\n  UI.w = W\r\n  UI.h = H\r\n  return UI\r\n\r\n\r\nfunc Startup()\r\n  Init = false\r\n  ToolbeltButton = CreateUI(ui.AddButton(),0,6,8,5)\r\n  ToolbeltButton.text = \"\"\r\n  ToolbeltButton.dock = top_left\r\n  ToolbeltButton.anchor = top_left\r\n  ToolbeltButton.SetPressed(ToggleButtons)\r\n\r\n  ToolbeltText = CreateUI(ui.AddText(),0,7,8,3)\r\n  ToolbeltText.text = toolascii\r\n  ToolbeltText.dock = top_left\r\n  ToolbeltText.anchor = top_left\r\n\r\nvar Init = true\r\nvar CursorAngle\r\nvar SelectedSlot\r\nvar Yset\r\nfunc Run()\r\n  ?totaltime = 1\r\n    Init = true\r\n    ButtonList.Clear()\r\n\r\n  ?Init\r\n    Startup()\r\n\r\n  ?isPC & ButtonToggle\r\n    ?SavedX ! input.x | SavedY ! input.y\r\n      ?input.y >= ScreenH/2\r\n        v=Pi\r\n      :\r\n        ?input.x<ScreenW/2\r\n          v=2*Pi\r\n        :\r\n          v=0\r\n      CursorAngle = v-math.Atan((1.0*((input.x-(ScreenW/2))/2))/(input.y-(ScreenH/2)))\r\n      SelectedSlot = RndToInt(CursorAngle/(2*Pi/ToolList.Count()))%ToolList.Count()\r\n    Yset = -1\r\n    for a : ToolList[SelectedSlot]\r\n      >c@-string.Size(a)/2@,@Yset@,@a@\r\n      Yset++\r\n    SavedX = input.x\r\n    SavedY = input.y\r\n\r\nfunc SelectTool(btn)\r\n  var ButtonNum = 0\r\n  for a : ButtonList\r\n    ?a = btn\r\n      break\r\n    :\r\n      ButtonNum++\r\n  ?ToolList[ButtonNum].Count() = 1\r\n    equip @ToolList[ButtonNum][0]@\r\n  :\r\n    equipL @ToolList[ButtonNum][0]@\r\n    equipR @ToolList[ButtonNum][1]@\r\n  ButtonToggle = false\r\n  MotherPanel.Recycle()\r\n  ButtonList.Clear()"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/A2S.txt" - Parse error: Failed to parse completely. Remaining: "= []\r\n  for e : arr\r\n    ?Type(e) = \"string\"\r\n      stringBuilder.Add(dquote + e + dquote)\r\n    :?Type(e) = \"array\"\r\n      stringBuilder.Add(Stringify(e))\r\n    :?Type(e) = \"null\"\r\n      stringBuilder.Add(\"null\")\r\n    :\r\n      stringBuilder.Add(\"\" + e)\r\n  return \"[\" + string.Join(\",\", stringBuilder) + \"]\"\r\n\r\nfunc Trim(str)\r\n  var strStartIndex = -1\r\n  var strEndIndex = -1\r\n  ?\"\" = str\r\n    return \"\"\r\n  for i = 0 .. string.Size(str) - 1\r\n    ?string.Sub(str, i, 1) ! \" \"\r\n      strStartIndex = i\r\n      break\r\n  ?strStartIndex = -1\r\n    return \"\"\r\n  for i = string.Size(str) .. strStartIndex\r\n    ?string.Sub(str, i, 1) ! \" \"\r\n      strEndIndex = i\r\n      break\r\n  return string.Sub(str, strStartIndex, strEndIndex - strStartIndex + 1)\r\n\r\nfunc Arrayify(str)\r\n  return Arrayify_Main(str, 0)\r\n\r\n/*\r\nStates:\r\n  - bef array (ok to read spaces and \"[\" only)\r\n    > spaces (ignore)\r\n    > \"[\" (-> bef field)\r\n    > NO other chars (error)\r\n  - bef field (ok to read spaces, but NOT commas)\r\n    > spaces (ignore)\r\n    > dquote (-> within str),\r\n    > \"-\" (-> within int),\r\n    > digits (-> within float),\r\n    > \"n\"/\"t\"/\"f\" (-> within special), or\r\n    > \"[\" (call Arrayify again)\r\n    > \"]\" only allowable if size of array is 0, if not throws error.\r\n    > NO other chars (error)\r\n  - within str\r\n    > dquote (write, -> after field)\r\n    > most other chars\r\n  - within int\r\n    > digits\r\n    > \".\" (-> within float)\r\n    > space (write, -> after field)\r\n    > comma (write, -> bef field)\r\n    > \"]\" (write, -> after array)\r\n    > NO other chars (error)\r\n  - within float\r\n    > digits\r\n    > space (write, -> after field)\r\n    > comma (write, -> bef field)\r\n    > \"]\" (write, return arr and endpos)\r\n    > NO \".\" (error)\r\n    > NO other characters (error)\r\n  - within special\r\n    > space (test, write, -> after field)\r\n    > comma (test, write, -> bef field)\r\n    > \"UNREALS\"\r\n    > \"]\" (write, -> after array)\r\n    > NO other characters (error)\r\n  - after field\r\n    > space (ignore)\r\n    > comma (-> bef field)\r\n    > \"]\" (return array, unless startPos = 0 then -> after array)\r\n    > NO other characters (error)\r\n  - after array (this state is only entered after the main array)\r\n    > spaces\r\n    > NO other characters (error)\r\n*/\r\n\r\nvar BEF_ARRAY = 11\r\nvar BEF_FIELD = 12\r\nvar WITHIN_STR = 13\r\nvar WITHIN_INT = 14\r\nvar WITHIN_FLOAT = 15\r\nvar WITHIN_SPECIAL = 16\r\nvar AFT_FIELD = 17\r\nvar AFT_ARRAY = 18\r\n\r\nfunc Arrayify_Main(str,startPos)\r\n  var len = string.Size(str) - startPos\r\n  ?len < 2\r\n    return \"ERROR: String too short to contain an array\"\r\n  var state = BEF_ARRAY\r\n  var resultArray = []     // [actual array, continuePos]\r\n  var stringBuilder = []   // speed up string reading\r\n  var negative = 1         // 1 for positive numbers/floats, -1 for negative numbers/floats.\r\n  var divisor = 1\r\n\r\n  for i = startPos .. string.Size(str)-1\r\n    var ch = string.Sub(str, i, 1)\r\n\r\n    ?state = BEF_ARRAY\r\n      ?\"［[\" = ch\r\n        state = BEF_FIELD\r\n      :?ch ! \" \"\r\n        return \"ERROR (pos \" + i + \"): Invalid character before starting array.\"\r\n    :?state = BEF_FIELD\r\n      ?ch = dquote  // just started a new string\r\n        state = WITHIN_STR\r\n      :?ch = \"-\"    // just started a new negative int/float\r\n        state = WITHIN_INT\r\n        negative = -1\r\n      :?\"1234567890\" = ch  // just started a new int/float\r\n        state = WITHIN_INT\r\n        stringBuilder.Add(ch)\r\n      :?\"NTF\" = ch   // just started a new special type\r\n        state = WITHIN_SPECIAL\r\n        stringBuilder.Add(ch)\r\n      :?\"［[\" = ch   // nested array\r\n        var nestedArray = Arrayify_Main(str, i)  //  [array, continuePos]\r\n        ?Type(nestedArray) = \"string\"\r\n          return nestedArray + \"\\n\" + \"within array @ pos:\" + startPos\r\n        :\r\n          resultArray.Add(nestedArray[0])\r\n          i = nestedArray[1]\r\n          state = AFT_FIELD\r\n      :?\"]］\" = ch\r\n        ?resultArray.Count() = 0\r\n          return [resultArray, i]\r\n        :\r\n          return \"ERROR (pos \" + i + \"): Unexpected end of array \" + dquote + \"]\" + dquote\r\n      :?ch ! \" \"\r\n        return \"ERROR (pos \" + i + \"): Unknown element\"\r\n    :?state = WITHIN_STR\r\n      ?ch = dquote\r\n        resultArray.Add(string.Join(\"\", stringBuilder))\r\n        stringBuilder.Clear()\r\n        state = AFT_FIELD\r\n      :\r\n        stringBuilder.Add(ch)\r\n    :?state = WITHIN_INT\r\n      ?\"1234567890\" = ch\r\n        stringBuilder.Add(ch)\r\n      :?ch = \".\"\r\n        state = WITHIN_FLOAT\r\n        divisor = 1.0\r\n      :?\"]］ ,\" = ch\r\n        resultArray.Add(negative * int.Parse(string.Join(\"\", stringBuilder)))\r\n        negative = 1\r\n        stringBuilder.Clear()\r\n        ?ch = \" \"\r\n          state = AFT_FIELD\r\n        :?ch = \",\"\r\n          state = BEF_FIELD\r\n        :?\"]］\" = ch\r\n          ?startPos = 0\r\n            state = AFT_ARRAY\r\n          :\r\n            return [resultArray, i]\r\n      :\r\n        return \"ERROR (pos \" + i + \"): Unexpected character in int\"\r\n    :?state = WITHIN_FLOAT\r\n      ?\"1234567890\" = ch\r\n        stringBuilder.Add(ch)\r\n        divisor *= 10\r\n      :?\"]］ ,\" = ch\r\n        resultArray.Add(negative * int.Parse(string.Join(\"\", stringBuilder)) / divisor)\r\n        divisor = 1.0\r\n        stringBuilder.Clear()\r\n        ?ch = \" \"\r\n          state = AFT_FIELD\r\n        :?ch = \",\"\r\n          state = BEF_FIELD\r\n        :?\"]］\" = ch\r\n          ?startPos = 0\r\n            state = AFT_ARRAY\r\n          :\r\n            return [resultArray, i]\r\n      :?ch = \".\"\r\n        return \"ERROR (pos \" + i + \"): Multiple decimal points in float\"\r\n      :\r\n        return \"ERROR (pos \" + i + \"): Unexpected character in float\"\r\n    :?state = WITHIN_SPECIAL\r\n      ?\"UNREALS\" = ch\r\n        stringBuilder.Add(ch)\r\n      :?\"]］ ,\" = ch\r\n        var specialType = string.Join(\"\", stringBuilder)\r\n        ?specialType = \"null\" & \"null\" = specialType\r\n          resultArray.Add(null)\r\n          stringBuilder.Clear()\r\n        :?specialType = \"false\" & \"false\" = specialType\r\n          resultArray.Add(false)          \r\n          stringBuilder.Clear()\r\n        :?specialType = \"true\" & \"true\" = specialType\r\n          resultArray.Add(true)\r\n          stringBuilder.Clear()\r\n        :\r\n          return \"ERROR (pos \" + i + \"): Unrecognized special constant\"\r\n        ?ch = \" \"\r\n          state = AFT_FIELD\r\n        :?ch = \",\"\r\n          state = BEF_FIELD\r\n        :?\"]］\" = ch\r\n          ?startPos = 0\r\n            state = AFT_ARRAY\r\n          :\r\n            return [resultArray, i]\r\n      :\r\n        return \"ERROR (pos \" + i + \"): Unexpected character \" + dquote + ch + dquote + \" in special constant\"\r\n    :?state = AFT_FIELD\r\n      ?ch = \",\"\r\n        state = BEF_FIELD\r\n      :?\"]］\" = ch\r\n        ?startPos = 0\r\n          state = AFT_ARRAY\r\n        :\r\n          return [resultArray, i]\r\n      :?ch ! \" \"\r\n        return \"ERROR (pos \" + i + \"): Unexpected character \" + dquote + ch + dquote + \" after field\"\r\n    :?state = AFT_ARRAY\r\n      ?ch ! \" \"\r\n        return \"ERROR (pos \" + i + \"): Unexpected character \" + dquote + ch + dquote + \" after main array\"\r\n\r\n  ?state = AFT_ARRAY\r\n    return resultArray\r\n  :\r\n    return \"ERROR: Unexpected end of input string\"\r\n\r\nfunc Printify_Main(arr, prefixStr)\r\n  var dquote = string.Sub(＂\\＂＂, 1)\r\n  var stringBuilder = []\r\n  ?!prefixStr\r\n    stringBuilder.Add(\"Array has \" + arr.Count() + \" elements.\")\r\n  ?!arr.Count()\r\n    stringBuilder.Add(prefixStr + \": [] (empty array)\")\r\n  :\r\n    for i = 0 .. arr.Count()-1\r\n      ?Type(arr[i]) = \"array\"\r\n        stringBuilder.Add(Printify_Main(arr[i], prefixStr + \"[\" + i + \"]\"))   \r\n      :?Type(arr[i]) = \"string\"\r\n        stringBuilder.Add(prefixStr + \"[\" + i + \"]: (string) \" + dquote + arr[i] + dquote)   \r\n      :?Type(arr[i]) = \"null\"\r\n        stringBuilder.Add(prefixStr + \"[\" + i + \"]: (\" + Type(arr[i]) + \")\")\r\n      :\r\n        stringBuilder.Add(prefixStr + \"[\" + i + \"]: (\" + Type(arr[i]) + \") \" + arr[i])\r\n  return string.Join(\"\\n\", stringBuilder)\r\n\r\nfunc Printify(arr)\r\n  ?Type(arr) ! array\r\n    return arr\r\n  return Printify_Main(arr, \"\")\r\n\r\nvar a = [[1,2.01,false],\r\n         \"this is a string\",\r\n         [\"tigers\",\",\",[true,null,false]]\r\n        ]\r\nvar simpleString = \"[11.25,[-557],-0.005]\"\r\nvar simpleArray = [11.25,[-557],-0.005]\r\nvar b = \"[[1,2.01,false],3,5,\" + dquote + \"abc\" + dquote + \"]\"\r\nvar bArr = [[1,2.01,false],3,5.78,[\"abc\",\"d\",[true,false,null]]]\r\nvar stringOfEmptyArrays = \"[  [], [[], [ [],[] ] ]  ]\"\r\nvar s2 = \"[  [3], [  [        ], [ [4  ,5 , \" + dquote + cat + dquote + \"   ], [] ] ]  ]\"\r\nvar s2compacted = Stringify(Arrayify(s2))\r\n\r\n>`2,1,@Printify(bArr)@\r\n>`30,1,@Printify(Arrayify(Stringify(bArr)))@\r\n>`2,13,@Printify(Arrayify(simpleString))@\r\n>`30,13,@Printify(simpleArray)@\r\n>`2,18,@Printify(Arrayify(stringOfEmptyArrays))@\r\n>`30,18,@Printify(Arrayify(s2))@\r\n>`30,25,@s2compacted@"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/BragMeter.txt" - Parse error: Failed to parse completely. Remaining: "= ＂＂\r\nvar bar = ［］\r\nvar cstr2 = ＂＂\r\nvar d = 0\r\nvar donttry = false\r\nvar num\r\n\r\nvar mmin = math.Min\r\nvar igco = item.getCount\r\nvar sjoi = string.Join\r\nvar sget = storage.Get\r\n\r\nvar remark=［\r\n＂Didnt even try＂,＂Could be better＂,\r\n＂Below average＂,＂Somewhat okay＂,\r\n＂Average＂,＂Cool, I guess＂,\r\n＂Good enough＂,＂I would stop by now＂,\r\n＂Straight A＂,＂Unbelievably good＂,\r\n＂Perfection＂\r\n］\r\n\r\nvar colors =［\r\n#999999,#EEEEEE,#cyan,#yellow,#green,#blue,\r\n#red,#magenta,#FFAA00,#AA00FF,#rainFF\r\n］\r\n\r\nvar text = string.Break(＂Remarks:＂,1)\r\nvar gcc = igco(＂enchant＂)\r\nvar uion = false\r\n\r\nfunc timecalc(x)\r\n ?x<=0\r\n  return 1\r\n :\r\n  return 0.1\r\n\r\n//locationtimestars\r\n\r\nvar rockys = sget(rocky_plateau_star,4)\r\nvar rockyt = sget(rocky_plateau_time,0)\r\nvar canyons = sget(deadwood_valley_star,2)\r\nvar canyont = sget(deadwood_valley_time,0)\r\nvar cavess = sget(caustic_caves_star,2)\r\nvar cavest = sget(caustic_caves_time,0)\r\nvar mushs = sget(fungus_forest_star,2)\r\nvar musht = sget(fungus_forest_time,0)\r\nvar hallss = sget(undead_crypt_star,2)\r\nvar hallst = sget(undead_crypt_time,0)\r\nvar mines = sget(bronze_mine_star,2)\r\nvar minet = sget(bronze_mine_time,0)\r\nvar icys = sget(icy_ridge_star,2)\r\nvar icyt = sget(icy_ridge_time,0)\r\nvar temples = sget(temple_star,2)\r\nvar templet = sget(temple_time,0)\r\n\r\nvar rockyfin = (rockys-4.0)/11.0*\r\n^timecalc(rockyt-3600)\r\nvar canyonfin = (canyons-2.0)/13.0*\r\n^timecalc(canyont-1510)\r\nvar cavesfin = (cavess-2.0)/13.0*\r\n^timecalc(cavest-1976)\r\nvar mushfin = (mushs-2.0)/13.0*\r\n^timecalc(musht-2006)\r\nvar hallsfin = (hallss-2.0)/13.0*\r\n^timecalc(hallst-2598)\r\nvar minefin = (mines-2.0)/13.0*\r\n^timecalc(minet-3124)\r\nvar icyfin = (icys-2.0)/13.0*\r\n^timecalc(icyt-2889)\r\nvar templefin = (temples-2.0)/13.0*\r\n^timecalc(templet-4166)\r\n\r\nvar locfinal = (rockyfin*1.0\r\n^+canyonfin*1.0+cavesfin*1.0\r\n^+mushfin+hallsfin+minefin+icyfin\r\n^+templefin)*12.5\r\n\r\n//first check\r\nvar year = utc.year\r\nvar month = utc.month\r\nvar day = utc.day\r\nvar hour = utc.hour\r\nvar minute = utc.minute\r\nvar second = utc.second\r\n\r\nvar datestring = ＂｛0｝/｛1｝/｛2｝ on ｛3｝:｛4｝:｛5｝＂\r\n?storage.Get(＂FIRSTTIMEPLAY＂,0)=0\r\n  datestring = string.Format(\r\n  ^datestring,month,day,year,hour,minute,second)\r\n  storage.Set(＂FIRSTTIMEPLAY＂,datestring)\r\n\r\ndatestring = storage.Get(＂FIRSTTIMEPLAY＂)\r\n \r\nvar coderan = sys.os\r\n  \r\nvar hcalc =(item.GetTreasureLimit() - 100)/5\r\n//save grade calc\r\nvar kic = mmin(res.ki,2000000) / 2000000.0\r\nvar mhc = mmin((hcalc),60) / 60.0\r\nvar gpc = mmin(totalgp,3000) / 3000.0\r\nvar osc = mmin(igco(＂moon_stone＂)+igco(\r\n^＂grappling_hook_lv2＂),2)\r\n\r\n//lost item count\r\nvar lic = mmin(192,\r\n^igco(＂blade＂) + igco(＂mask＂)\r\n^+ igco(＂fire_talisman＂)  +\r\n^igco(＂bash＂) + igco(＂skeleton_arm＂)+\r\n^igco(＂aether_talisman＂))\r\nvar licperc = lic/192.0\r\nvar oscperc = osc/2.0\r\n\r\nvar gr = -1.0\r\nvar h\r\n\r\nfunc gradecalc(x)\r\n h = (-x * x + (2 + 3) * x)/(1 + 3)\r\n return h\r\n\r\nvar kicc = mmin(res.crystals,50) / 50.0\r\n\r\nvar gru = mmin(0.075 * kic + 0.125 * mhc\r\n^ + 0.1 * gpc\r\n^ + 0.25 * (locfinal/100.0)\r\n^ + 0.25 * licperc + 0.1 * oscperc + 0.1 * kicc\r\n^,1)\r\n\r\n?gr = -1.0\r\n gr = gradecalc(gru)\r\n\r\nvar grk = gr * 20\r\nvar grkr = gr * 100\r\nvar grck = math.FloorToInt(gr * 10)\r\n\r\nvar acgr = gr * 10000 / 100.00000\r\nvar acgru = gru * 10000 / 100.00000\r\n\r\nvar ccolor = colors［grck］\r\nvar cremark = remark［grck］\r\n\r\nvar formstr =\r\n^＂Name:# ｛0｝ \\n\r\n^Level:# ｛1｝ \\n\r\n^Lost Items:# ｛2｝ \\n\r\n^Key Items:# ｛3｝ \\n\r\n^Ki:# ｛4｝ \\n\r\n^Crystals:# ｛8｝ \\n \\n\r\n^Power:# ｛5｝ \\n\r\n^Grade:# ｛6｝% \\n\r\n^U-Grade:# ｛7｝% ##＂\r\n\r\n//registertime\r\n?totaltime<30\r\n var loci = loc.id\r\n var locs = string.join(＂＂,［loci,_star］)\r\n var loct = string.join(＂＂,［loci,_time］)\r\n ?sget(locs,0)<=loc.stars\r\n ^&loc.besttime!-1\r\n  ?sget(locs,0)=loc.stars&sget(loct,0)=loc.\r\n^besttime\r\n   >`1,23,#00d000,Same Best Time!\r\n  :\r\n   >`1,23,#00ff00,New Best Time!\r\n^\\n@loc.stars@* @loc.besttime@f\r\n  ?totaltime=1\r\n   storage.set(locs,loc.stars)\r\n   storage.set(loct,loc.besttime)\r\n\r\nvar formstrloc =\r\n^＂Rocky:#    ｛0｝\\n\r\n^Canyon:#   ｛1｝\\n\r\n^Caves:#    ｛2｝\\n\r\n^Mushroom:# ｛3｝\\n\r\n^Halls:#    ｛4｝\\n\r\n^Mines:#    ｛5｝\\n\r\n^Ridge:   # ｛6｝\\n\r\n^Temple:#   ｛7｝\\n\\n\r\n^Total:#    ｛8｝%＂\r\n\r\nvar formlocstr =\r\n^＂｛0｝* ｛1｝f＂\r\n\r\nfunc formloc(x,y)\r\n ?x<1\r\n  return ＂No Info＂\r\n :\r\n  return string.Format(formlocstr,x,y)\r\n\r\nvar formstrlocdone = string.Format(\r\n^formstrloc,\r\n^formloc(rockys,rockyt),\r\n^formloc(canyons,canyont),\r\n^formloc(cavess,cavest),\r\n^formloc(mushs,musht),\r\n^formloc(hallss,hallst),\r\n^formloc(mines,minet),\r\n^formloc(icys,icyt),\r\n^formloc(temples,templet),\r\n^locfinal)\r\n\r\n\r\nvar formstrd = string.Format(\r\n^formstr,player.name,hcalc,lic,osc,res.ki,\r\n^totalgp,acgr,acgru,res.crystals)\r\nvar largestr=string.Split(formstrd)\r\n\r\n//scaler\r\nvar y = 0\r\n?bar = ＂＂\r\n for i = 1..20\r\n  ?grk >= i & gr <= 1\r\n   bar.Add(＂█＂)\r\n  :\r\n   bar.Add(＂▒＂)\r\n\r\nvar largstr\r\nvar mode = 0\r\nvar flipflop = false\r\nfunc swap(butt)\r\n ?butt=but\r\n  mode += 1\r\n  mode=mode%3\r\n :\r\n  mode -= 1\r\n  ?mode<0\r\n   mode=2\r\n\r\nvar shortwait=0\r\n//easter eggs\r\n?gr > 1\r\n ambient.Stop()\r\n ccolor = #990000\r\n cremark = ＂You know what you did.＂\r\n acgr = 0\r\n gr = 0\r\n grkr = 0\r\n\r\nvar shortwait\r\n\r\n?loc = waterfall & totalTime > 30 & donttry\r\n^ = false\r\n >c@a@,-7,Braggability Meter 2.0\r\n ?a ! 7\r\n  a -= 1\r\n :?mode = 0\r\n  ?cstr = ＂＂\r\n   >c7,-5,@ccolor@,Save:\\n@cstr@\r\n  ?b ! 21\r\n   play xp_tick\r\n   cstr = sjoi(＂＂,bar,0,b)\r\n   b += 1\r\n  :\r\n   >c7,-3,@ccolor@,@c@%\r\n   ?c ! Math.roundToInt(grkr)\r\n    c += 1\r\n   :\r\n    ?cstr2 = ＂R＂\r\n     >c7,-1,@cstr2@\r\n    ?d ! 8\r\n     d += 1\r\n     cstr2 = sjoi(＂＂,text,0,d)\r\n    :\r\n     ?uion = false\r\n      play error\r\n     >c7,0,@ccolor@,@cremark@\r\n     ?shortwait = 8\r\n      >c7,2,You checked on:\r\n      >c7,3,@ccolor@,@datestring@!    \r\n      >c7,4,OS: @coderan@\r\n     :\r\n      shortwait += 1\r\n     ?shortwait = 7\r\n      play error\r\n     uion = true\r\n :?mode=1\r\n  >c7,-5,@ccolor@,@sjoi(＂＂,largestr)@\r\n :?mode=2  \r\n  >c7,-5,@ccolor@,@formstrlocdone@\r\n  >c7,-5,Rocky:\\nCanyon:\\nCaves:\\nMushroom:\r\n^\\nHalls:\\nMines:\\nRidge:\\nTemple:\\n\\nTotal:\r\n?uion = true\r\n >c17,6,#888888,@mode+1@/3\r\n var but = ui.AddButton()\r\n but.text = ＂next>＂\r\n but.x = 23\r\n but.y = 6\r\n but.h = 1\r\n but.w = 5\r\n but.hcolor = #AAAAAA\r\n but.tcolor = #888888\r\n but.SetPressed(swap)\r\n var but2 = ui.AddButton()\r\n but2.text = ＂<back＂\r\n but2.x = 13\r\n but2.y = 6\r\n but2.h = 1\r\n but2.w = 5\r\n but2.hcolor = #AAAAAA\r\n but2.tcolor = #888888\r\n but2.SetPressed(swap)\r\n\r\n?item.left = grap\r\n donttry = true\r\n a = 0\r\n uion = false\r\n ui.Clear()"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/FaceHUD.txt" - Parse error: Failed to parse completely. Remaining: "?(time / 4) % 16 = 0\r\n  hploss = 0\r\n\r\n\r\n//Face Logic\r\n?fcd = 0\r\n  fstate = neutral\r\n\r\n?(time / 32) % 10 < 5\r\n  ?fcd = 0\r\n    ?(time / 32) % 3 = 0\r\n      fstate = rer\r\n    ?(time / 32) % 3 = 1\r\n      fstate = neutral\r\n    ?(time / 32) % 3 = 2\r\n      fstate = rel\r\n\r\n?(time / 4) % 45 > 40\r\n  ?fcd = 0\r\n    fstate = blink\r\n\r\n?foe.distance < 30\r\n  ?fcd = 0\r\n    fstate = scowl\r\n\r\n?foe.count > 0 &\r\n^foe.hp <= foe.maxhp * 0.25 &\r\n^foe.hp ! 0\r\n    fstate = grin\r\n    fcd = 60\r\n\r\n?hploss >= maxhp * 0.15\r\n    fstate = shock\r\n\r\n?hp <= 0\r\n  fstate = dead\r\n\r\n\r\n//HUD\r\n>`@screen.w - 13@,0,ascii\r\n╔═══════════╗\r\n║           ║\r\n║           ║\r\n║           ║\r\n║           ║\r\n║           ║\r\n║           ║\r\n╚═══════════╝\r\nasciiend\r\n\r\n//Faces\r\n//Neutral\r\n?fstate = neutral\r\n  >`@screen.w -13@,1,ascii\r\n# .'     `.\r\n#/ __   __ \\\r\n#  <o) (o>  \r\n#           \r\n#\\   ———   /\r\n# `._   _.´\r\nasciiend\r\n\r\n//Scowl\r\n?fstate = scowl\r\n  >`@screen.w -13@,1,ascii\r\n# .'     `.\r\n#/ ._`-´_. \\\r\n#  <o\\ /o>  \r\n#    ___    \r\n#\\  ´———`  /\r\n# `._   _.´\r\nasciiend\r\n\r\n//Blink\r\n?fstate = blink\r\n  >`@screen.w -13@,1,ascii\r\n# .'     `.\r\n#/ __   __ \\\r\n#  `—   —´  \r\n#           \r\n#\\   ———   /\r\n# `._   _.´\r\nasciiend\r\n\r\n//Raised Eyebrow (R)\r\n?fstate = rer\r\n  >`@screen.w -13@,1,ascii\r\n# .'     `.\r\n#/ __  .—— \\\r\n#  <_o (_o  \r\n#           \r\n#\\   ———   /\r\n# `._   _.´\r\nasciiend\r\n\r\n//Raised Eyebrow (L)\r\n?fstate = rel\r\n  >`@screen.w -13@,1,ascii\r\n# .'     `.\r\n#/ ——.  __ \\\r\n#  o_) o_>  \r\n#           \r\n#\\   ———   /\r\n# `._   _.´\r\nasciiend\r\n\r\n//Grin\r\n?fstate = grin\r\n  >`@screen.w -13@,1,ascii\r\n# .'     `.\r\n#/ __`-´__ \\\r\n#  <o\\ /o>  \r\n#   _____   \r\n#\\  `———´  /\r\n# `._   _.´\r\nasciiend\r\n\r\n//Shock\r\n?fstate = shock\r\n  >`@screen.w -13@,1,ascii\r\n# .' ._. `.\r\n#/ ——. .—— \\\r\n#  (o) (o)  \r\n#    ___    \r\n#\\  /___\\  /\r\n# `._   _.´\r\nasciiend\r\n\r\n//Dead\r\n?fstate = dead\r\n  >`@screen.w -13@,1,ascii\r\n# .'     `.\r\n#/ __   __ \\\r\n#  `—   —´  \r\n#           \r\n#\\   ———   /\r\n# `._   _.´\r\nasciiend\r\n\r\n//Wounds 1\r\n?hp < maxhp * 0.90\r\n  >`@screen.w -13@,1,#red,ascii\r\n###########\r\n############\r\n#############\r\n#######.#####\r\n########`###\r\n###########\r\nasciiend\r\n\r\n//Wounds 2\r\n?hp < maxhp * 0.60\r\n  >`@screen.w -13@,1,#red,ascii\r\n###########\r\n########`###\r\n##,-—.#######\r\n##|####.#####\r\n########`###\r\n#######▀###\r\nasciiend\r\n\r\n//Wounds 3\r\n?hp < maxhp * 0.30\r\n  >`@screen.w -13@,1,#red,ascii\r\n######.####\r\n#######`\\###\r\n##,▄▄.#######\r\n##|██##.¯Y##\r\n###██###`###\r\n###▀█##▀###\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/StealMeter.txt" - Parse error: Failed to parse completely. Remaining: "?buffs.count>0\r\n    index=string.IndexOf(buffs.string,\"pick_pocket:\",1)\r\n    ?index!-1 // pick buff exists\r\n      Output(x,y,#606060,meter)\r\n      index=index+12\r\n      index=int.parse(string.Sub(buffs.string,index,1)) // Is stack value 1-N\r\n      ?index>=1\r\n        Output(x,y,c,ess)\r\n      ?index>=2\r\n        Output(x,y,c,tee)\r\n      ?index>=3\r\n        Output(x,y,c,eee)\r\n      ?index>=4\r\n        Output(x,y,c,aye)\r\n      ?index>=5\r\n        Output(x,y,c,ell)\r\n      ?index>=6\r\n        Output(x,y,c,exc)"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/MiniMap.txt" - Parse error: Failed to parse completely. Remaining: "= []\r\nvar miniMapInfoHere = \"\"\r\nvar miniMapBossBegin = 0\r\nvar miniMapX = 0\r\nvar miniMapLastX = 0\r\nvar miniMapLastScreenI = 0\r\nvar miniMapLastFoeGetCount = 0\r\nvar miniMapLoops = 0\r\nvar miniMapNumber = 0\r\nvar miniMapId = \"\"\r\nvar miniMapUI\r\nvar miniMapUIText = \"\"\r\nvar miniMapIsMapCountIncreased = 0\r\nvar miniMapLastPosX = 0\r\nvar miniMapLastPosY = 0\r\nvar miniMapIsBeforeBoss = 0\r\nvar miniMapPickupItems = [Stone,Wood,Tar,Bronze]\r\nvar miniMapLastMapCountIncrease = 0\r\nvar miniMapReverseCount = 0\r\nvar miniMapLastSmallBoss = \"\"\r\nvar miniMapExcessTileCount = 0\r\n\r\n//If you choose to copy and paste,\r\n//remove the \"//\" from the following code\r\n//Show(0,0,true)\r\n   \r\nfunc Show(posX,posY,isStorage)\r\n\r\n //Read map data from storage\r\n ?loc.begin | loc.loop\r\n  miniMapUI = ui.AddText()\r\n  miniMapUI.anchor = bottom_center\r\n  miniMapUI.dock = bottom_center\r\n  miniMapId = loc.id + \"*\" + loc.stars\r\n\r\n  ?storage.Has(\"miniMapLastVersion\")\r\n   miniMapLastVersion = \r\n   ^storage.Get(\"miniMapLastVersion\")\r\n  :\r\n   miniMapLastVersion = 99999\r\n\r\n  ?!isStorage | \r\n  ^miniMapLastVersion < miniMapMinimumVersion\r\n   ?storage.Keys().Count() > 0\r\n    for i = 0..storage.Keys().Count()-1\r\n     storage.Delete(storage.Keys()[0])\r\n\r\n  ?isStorage\r\n   ?miniMapInfo.Count() = 0 & \r\n   ^storage.Has(miniMapId)\r\n    miniMapInfo = string.Split(\r\n    ^storage.Get(miniMapId),\";\",true) \r\n\r\n   ?miniMapLastVersion < miniMapMinimumVersion\r\n    miniMapIsVersionUpdate = 1\r\n\r\n   storage.Set(\"miniMapLastVersion\",\r\n   ^miniMapVersion)\r\n\r\n //Disable at non-boss 0-star locations\r\n ?miniMapId = \"*0\"\r\n  return\r\n\r\n //Prevent mid-level map mapping\r\n ?string.Size(miniMapId) = 0\r\n  >`0,0,#ffff00,\r\n  ^MiniMap needs to restart or loop the level.\r\n  return\r\n\r\n ?miniMapIsVersionUpdate & totaltime < 150\r\n  >`0,0,\r\n  ^MiniMap version has been updated, \r\n  ^and the map data needs to be redrawn.\r\n\r\n //Map survey\r\n ?!miniMapInfo.Contains(\"bigBoss\")\r\n\r\n  //Big boss B\r\n  ?miniMapId ! loc.id + \"*\" + loc.stars\r\n   //If the previous frame has already reached\r\n   //the screen edge, resulting in \r\n   //additional map generation, delete it.\r\n   ?miniMapLastMapCountIncrease > totaltime - 5\r\n    miniMapInfo.RemoveAt(miniMapInfo.Count()-1)\r\n\r\n   miniMapInfo.Emplace(miniMapInfo.Count()-1,\r\n   ^\"bigBoss\")\r\n  :?foe.distance <= 23 & foe = boss &\r\n  ^foe ! miniMapLastSmallBoss & (\r\n  ^loc.stars <= 10 |loc.stars > 10 & (\r\n  ^miniMapInfo.Contains(\"smallBoss\") |\r\n  ^miniMapInfo.Contains(\"pickup smallBoss\")) &\r\n  ^!(miniMapInfoHere = \"smallBoss\"))|\r\n  ^loc.loop &\r\n  ^miniMapInfo[miniMapInfo.Count()-2] =\r\n  ^\"smallBoss\"\r\n   miniMapInfo.Emplace(miniMapX / 3,\r\n   ^\"bigBoss\")\r\n   miniMapExcessTileCount = miniMapInfo.Count()-\r\n   ^1 - miniMapX / 3\r\n   ?miniMapExcessTileCount > 0\r\n    for i = 1..miniMapExcessTileCount\r\n     miniMapInfo.RemoveAt(miniMapInfo.Count()-1)\r\n\r\n  //begin o\r\n  :?miniMapX < 2 & miniMapInfo.Count() = 0\r\n   miniMapInfo.Add(\"begin\")\r\n   ?foe.GetCount(9999) = 0\r\n    miniMapInfo.Add(\"noFoe\")\r\n   :\r\n    miniMapInfo.Add(\"Foe\")\r\n\r\n  //foe/nofoe =/-\r\n  :?screen.i ! miniMapLastScreenI &\r\n  ^miniMapInfo.Count() = screen.i + 1\r\n   ?foe.GetCount(9999) > miniMapLastFoeGetCount\r\n     miniMapInfo.Add(\"Foe\")\r\n   :\r\n     miniMapInfo.Add(\"noFoe\")\r\n   miniMapLastScreenI = screen.i\r\n   miniMapIsMapCountIncreased = 1\r\n   miniMapLastMapCountIncrease = totaltime\r\n  :\r\n   miniMapLastFoeGetCount = foe.GetCount(9999)\r\n   miniMapIsMapCountIncreased = 0\r\n\r\n //small boss b\r\n ?!miniMapInfo.Contains(\"smallBoss\") &\r\n ^!miniMapInfo.Contains(\"pickup smallBoss\") &\r\n ^loc.stars > 10 & foe.distance <= 23 &\r\n ^(foe = boss | foe = wasp_nest)\r\n  ?miniMapInfoHere = \"pickup\"\r\n   miniMapInfo.Emplace(\r\n   ^miniMapX / 3,\"pickup smallBoss\")\r\n  :\r\n   miniMapInfo.Emplace(miniMapX / 3,\"smallBoss\")\r\n  miniMapLastSmallBoss = foe\r\n\r\n //pickup ~\r\n ?pickup.distance < 5 & \r\n ^miniMapPickupItems.Contains(pickup) &\r\n ^!(miniMapInfoHere = \"pickup\") &\r\n ^!(pickup = \"Stone\" &\r\n ^!(miniMapInfoHere = \"noFoe\"))\r\n  miniMapInfo.Emplace(miniMapX / 3,\r\n  ^\"pickup \" + miniMapInfoHere)\r\n\r\n //Map storage\r\n ?isStorage\r\n  storage.Set(miniMapId,\r\n  ^string.Join(;,miniMapInfo))\r\n\r\n\r\n //Draw the map\r\n //Player position calculation\r\n ?miniMapId = loc.id + \"*\" + loc.stars\r\n  ?screen.i = 0\r\n   miniMapBossBegin = 0\r\n   ?pos.x < -3\r\n    miniMapX = 1\r\n   :\r\n    miniMapX = 2\r\n  :?miniMapInfoHere = \"bigBoss\"\r\n   ?foe = boss & foe.distance <= 23 &\r\n   ^ai.enabled & item.CanActivate() |\r\n   ^miniMapBossBegin = 1\r\n    miniMapX = miniMapInfo.Count()*3-1\r\n    miniMapBossBegin = 1\r\n   :\r\n    miniMapX = miniMapInfo.Count()*3-2\r\n  :\r\n   miniMapX = (pos.x-20+23)/23+2\r\n :?foe = boss & foe.distance <= 23 &\r\n  ^ai.enabled & item.CanActivate() |\r\n  ^miniMapBossBegin = 1\r\n   miniMapX = miniMapInfo.Count()*3-1\r\n   miniMapBossBegin = 1\r\n :\r\n  miniMapX = miniMapInfo.Count()*3-2\r\n\r\n miniMapInfoHere = miniMapInfo[miniMapX/3]\r\n\r\n //Flicker when overlapping with boss\r\n ?miniMapInfoHere = \"smallBoss\" &\r\n ^(miniMapX + 1) % 3 = 0 |\r\n ^miniMapInfoHere = \"bigBoss\" &\r\n ^(miniMapX + 1) % 3 = 0\r\n  miniMapFlickerTime++\r\n  ?miniMapFlickerTime = 30\r\n   miniMapFlickerTime = 0\r\n :\r\n  miniMapFlickerTime = 0\r\n\r\n //Long map splitting display\r\n //Fold every ten screens once\r\n ?miniMapInfo.Count() % 10 ! 0 |\r\n ^miniMapInfo.Count() = 0\r\n  miniMapLoops = miniMapInfo.Count() / 10 + 1\r\n :\r\n  miniMapLoops = miniMapInfo.Count() / 10\r\n\r\n //Evenly divide the number\r\n //of screens for each loop\r\n ?miniMapInfo.Count() % miniMapLoops ! 0\r\n  miniMapNumber = miniMapInfo.Count() /\r\n  ^miniMapLoops + 1\r\n :\r\n  miniMapNumber = miniMapInfo.Count() /\r\n  ^miniMapLoops\r\n\r\n //Update Map\r\n ?miniMapIsMapCountIncreased |\r\n ^miniMapX ! miniMapLastX & ((miniMapX % 3 ! 0 |\r\n ^miniMapX % 3 = 0 &\r\n ^miniMapX / 3 < miniMapInfo.Count() - 1 ) |\r\n ^miniMapInfo.Contains(\"bigBoss\")) |\r\n ^miniMapFlickerTime =1 | miniMapFlickerTime =16\r\n  miniMapLastX = miniMapX\r\n  for i = 0..miniMapInfo.Count()*3-1\r\n   //Use \"/\" to perform floor division\r\n   ?i >= miniMapNumber * 3 *\r\n   ^(miniMapX / (miniMapNumber * 3)) &\r\n   ^i < miniMapNumber * 3 *\r\n   ^(miniMapX / (miniMapNumber * 3) +1)\r\n\r\n    ?i=0\r\n     miniMapUIText = \"#\"\r\n    :?miniMapX >= miniMapNumber*3 & \r\n    ^i%(miniMapNumber*3*\r\n    ^(miniMapX/(miniMapNumber*3)))=0\r\n     miniMapUIText = \"\"\r\n\r\n    ?i = miniMapX & miniMapFlickerTime <= 15\r\n     miniMapUIText = miniMapUIText + \"x\"\r\n\r\n    :?i = 1\r\n      miniMapUIText = miniMapUIText + \r\n      ^StarColorDull(\"o\")\r\n      \r\n    :?i = 2\r\n     ?i >= miniMapX\r\n      miniMapUIText = miniMapUIText + \"-\"\r\n     :\r\n      miniMapUIText = miniMapUIText + \r\n      ^\"[color=#8c8c8c]-[/color]\"\r\n\r\n    :?i = 3 * miniMapNumber\r\n     miniMapUIText = miniMapUIText + \r\n     ^StarColorDull(\r\n     ^(miniMapX/(miniMapNumber*3)+1)\r\n     ^)\r\n\r\n    :?i % 3 = 0 & i ! 0\r\n     ?i >= miniMapX\r\n      miniMapUIText = miniMapUIText + \"|\"\r\n     :\r\n      miniMapUIText = miniMapUIText + \r\n      ^\"[color=#8c8c8c]|[/color]\"\r\n\r\n    :?miniMapInfo[i / 3] = \"pickup\" &\r\n    ^(i - 1) % 3 = 0\r\n     ?i >= miniMapX\r\n      miniMapUIText = miniMapUIText + \"~\"\r\n     :\r\n      miniMapUIText = miniMapUIText + \r\n      ^\"[color=#8c8c8c]~[/color]\"\r\n\r\n    :?miniMapInfo[i / 3] = \"noFoe\"\r\n     ?i >= miniMapX\r\n      miniMapUIText = miniMapUIText + \"-\"\r\n     :\r\n      miniMapUIText = miniMapUIText + \r\n      ^\"[color=#8c8c8c]-[/color]\"\r\n\r\n    :?miniMapInfo[i / 3] = \"foe\"\r\n     ?i >= miniMapX\r\n      miniMapUIText = miniMapUIText + \"=\"\r\n     :\r\n      miniMapUIText = miniMapUIText + \r\n      ^\"[color=#8c8c8c]=[/color]\"\r\n\r\n    :?miniMapInfo[i / 3] = \"smallBoss\"\r\n     ?(i - 1) % 3 = 0\r\n      ?i >= miniMapX\r\n       miniMapUIText = miniMapUIText + \"-\"\r\n      :\r\n       miniMapUIText = miniMapUIText + \r\n      ^\"[color=#8c8c8c]-[/color]\"\r\n     :?i >= miniMapX\r\n      miniMapUIText = miniMapUIText + \"b\"\r\n     :\r\n      miniMapUIText = miniMapUIText + \r\n      ^StarColorDull(\"b\")\r\n\r\n    :?miniMapInfo[i / 3] = \"bigBoss\"\r\n     ?(i - 1) % 3 = 0\r\n      ?i > miniMapX\r\n       miniMapUIText = miniMapUIText + \"-\"\r\n      :\r\n       miniMapUIText = miniMapUIText + \r\n      ^\"[color=#8c8c8c]-[/color]\"\r\n     :?i >= miniMapX\r\n      miniMapUIText = miniMapUIText + \"B\"\r\n     :\r\n      miniMapUIText = miniMapUIText + \r\n      ^StarColorDull(\"B\")\r\n\r\n  //Update MiniMapUI\r\n  miniMapUI.text = miniMapUIText\r\n  ?miniMapX/(miniMapNumber*3) = miniMapLoops - 1\r\n   miniMapUI.w = (miniMapInfo.Count() - \r\n   ^miniMapNumber*(miniMapLoops-1))*3\r\n  :\r\n   miniMapUI.w = miniMapNumber*3\r\n\r\n //Downward Compatibility\r\n ?posX = \"C\"\r\n  posX = 0\r\n ?posY = \"D\"\r\n  posY = 0\r\n\r\n ?miniMapUI.y = 0 | posY ! miniMapLastPosY\r\n  miniMapUI.y = 0\r\n  miniMapUI.y = screen.h - \r\n  ^miniMapUI.absoluteY - 1 + posY\r\n  miniMapLastPosY = posY\r\n  \r\n ?miniMapLastPosX ! posX\r\n  miniMapUI.x = -1 + posX\r\n  miniMapLastPosX = posX\r\n\r\n //Determine if you are about to\r\n //face a boss soon.\r\n ?loc = Temple | loc = Ridge | loc = Caves\r\n  miniMapReverseCount = 2\r\n :\r\n  miniMapReverseCount = 1\r\n ?miniMapInfo.Contains(\"bigBoss\") & miniMapX/3= \r\n ^miniMapInfo.Count()-1 - miniMapReverseCount\r\n  miniMapIsBeforeBoss = 1\r\n :\r\n  miniMapIsBeforeBoss = 0\r\n\r\nfunc StarColor(a)\r\n ?loc.stars > 15\r\n  return \"[color=#32da5a]\" + a + \"[/color]\" \r\n :?loc.stars > 10\r\n  return \"[color=#ffff62]\" + a + \"[/color]\"\r\n :?loc.stars > 5\r\n  return \"[color=#02e5ff]\" + a + \"[/color]\"\r\n :\r\n  return a \r\n\r\nfunc StarColorDull(a)\r\n ?loc.stars > 15\r\n  return \"[color=#1b7831]\" + a + \"[/color]\" \r\n :?loc.stars > 10\r\n  return \"[color=#8c8c36]\" + a + \"[/color]\"\r\n :?loc.stars > 5\r\n  return \"[color=#017e8c]\" + a + \"[/color]\"\r\n :\r\n  return \"[color=#8c8c8c]\" + a + \"[/color]\"\r\n\r\n/*\r\nold changelog\r\nv9\r\n- Fixed the bug where festival resources \r\nwould be added to the MiniMap. Now, it will \r\nonly respond to stone, wood, tar, and bronze.\r\n- Fixed the issue introduced in v8 where tiles\r\nwere incorrectly deleted in certain locations.\r\n\r\nv8\r\n- Green stars are now supported.\r\n- Fixed the bug where picking up resources\r\nwhile the screen camera moves would repeatedly\r\nstore map information (if enabled).\r\n- Fixed the bug where an extra tile of the map\r\nwould be generated when entering the boss room\r\nin the Bronze Mine.\r\n- All bosses are displayed in white before being\r\ndefeated to prevent eye strain from flickering.\r\n- New variables added: `miniMapInfoHere` and \r\n`miniMapIsBeforeBoss`. You can access their \r\nvalues when using the minimap.\r\n*/"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/FoeStateTracker.txt" - Parse error: Failed to parse completely. Remaining: "(\"MaxListLength\",5)\r\nvar CheckingDamage  = storage.Get(\"CheckingDamage\",true)\r\nvar CheckingHealing = storage.Get(\"CheckingHealing\",true)\r\nvar CheckingDebuffs = storage.Get(\"CheckingDebuffs\",true)\r\nvar CheckingFoeBuffs= storage.Get(\"CheckingFoeBuffs\",true)\r\nvar StateList = []\r\nvar StateListText\r\nvar TimeListText\r\nvar StateListBox\r\nvar init = true\r\nvar Mobile = sys.isMobile\r\nvar Defense = 0\r\nvar PHealth = hp\r\nvar EventRecorder = []\r\nvar EventDisplayText\r\nvar DebuffCount = 0\r\nvar FoeBuffCount = 0\r\nvar DragButton\r\nvar Label\r\nvar DragCont = import UI/DragController\r\nvar ToggleDragging = false\r\nvar XSet = storage.Get(\"X\",0)\r\nvar YSet = storage.Get(\"Y\",7)\r\nvar SettingsButton\r\nvar SettingsToggle = false\r\nvar SettingsPanel\r\nvar SettingsText\r\nvar CloseSettings\r\nvar ListIncreaseButton\r\nvar ListDecreaseButton\r\nvar DamageToggleButton\r\nvar HealingToggleButton\r\nvar DebuffsToggleButton\r\nvar FoeBuffsToggleButton\r\nvar StyleInvisible = ui.AddStyle(\"\r\n^###\r\n^###\r\n^###\")\r\n\r\nfunc Create_UI_Element(_UI,X,Y,W)\r\n  _UI.x = X\r\n  _UI.y = Y\r\n  _UI.w = W\r\n  _UI.dock = top_left\r\n  _UI.anchor = top_left\r\n  return _UI\r\n\r\nvar z\r\n?totaltime = 1 | init\r\n  ?totaltime = 1\r\n    SettingsToggle = false\r\n  init = false\r\n  EventRecorder.Clear()\r\n  StateList.Clear()\r\n  StateListBox = Create_UI_Element( ui.AddPanel(), XSet,YSet,9)\r\n  StateListBox.h = 2+MaxListLength\r\n\r\n  z = \"\"\r\n  for a = 1..MaxListLength\r\n    z += \"\\n│\"\r\n  Label = Create_UI_Element( ui.AddText(\"S : T\"+z),-5,0,20)\r\n  Label.align = center\r\n  Label.color = #808080\r\n\r\n  StateListText = Create_UI_Element( ui.AddText(),1,1,20)\r\n  StateListText.align = left\r\n\r\n  TimeListText =  Create_UI_Element( ui.AddText(),5,1,20)\r\n  TimeListText.align = left\r\n\r\n  EventDisplayText =  Create_UI_Element( ui.AddText(),0,2+MaxListLength,99)\r\n  EventDisplayText.align = left\r\n\r\n  DragButton = Create_UI_Element( ui.AddButton() ,-1,0,3)\r\n  DragButton.h = 1\r\n  DragButton.text = \"ʘ\"\r\n  DragButton.style = StyleInvisible\r\n  DragButton.SetDown(DragToggle)\r\n\r\n  SettingsButton = Create_UI_Element( ui.AddButton() ,7,0,3)\r\n  SettingsButton.h = 1\r\n  SettingsButton.text = \"≡\"\r\n  SettingsButton.style = StyleInvisible\r\n  SettingsButton.SetDown(OpenSettings)\r\n\r\n  StateListBox.Add(Label)\r\n  StateListBox.Add(StateListText)\r\n  StateListBox.Add(TimeListText)\r\n  StateListBox.Add(EventDisplayText)\r\n  StateListBox.Add(DragButton)\r\n  StateListBox.Add(SettingsButton)\r\n\r\nfunc ClearStorage()\r\n  storage.Delete(\"X\")\r\n  storage.Delete(\"Y\")\r\n  storage.Delete(\"MaxListLength\")\r\n  storage.Delete(\"CheckingDamage\")\r\n  storage.Delete(\"CheckingHealing\")\r\n  storage.Delete(\"CheckingDebuffs\")\r\n  storage.Delete(\"CheckingFoeBuffs\")\r\n\r\nfunc DragToggle()\r\n  ToggleDragging = !ToggleDragging\r\n\r\nfunc ListDecrease()\r\n  ?MaxListLength > 1\r\n    MaxListLength--\r\n    storage.Set(\"MaxListLength\", MaxListLength)\r\nfunc ListIncrease()\r\n  MaxListLength++\r\n  storage.Set(\"MaxListLength\", MaxListLength)\r\nfunc CheckingDamageToggle()\r\n  CheckingDamage = !CheckingDamage\r\n  storage.Set(\"CheckingDamage\", CheckingDamage)\r\n  SettingsText.text = GetSettingsText()\r\nfunc CheckingHealingToggle()\r\n  CheckingHealing = !CheckingHealing\r\n  storage.Set(\"CheckingHealing\", CheckingHealing)\r\n  SettingsText.text = GetSettingsText()\r\nfunc CheckingDebuffsToggle()\r\n  CheckingDebuffs = !CheckingDebuffs\r\n  storage.Set(\"CheckingDebuffs\", CheckingDebuffs)\r\n  SettingsText.text = GetSettingsText()\r\nfunc CheckingFoeBuffsToggle()\r\n  CheckingFoeBuffs = !CheckingFoeBuffs\r\n  storage.Set(\"CheckingFoeBuffs\", CheckingFoeBuffs)\r\n  SettingsText.text = GetSettingsText()\r\n\r\nfunc OpenSettings()\r\n  SettingsToggle = !SettingsToggle\r\n  ?SettingsToggle\r\n    SettingsPanel = ui.AddPanel()\r\n    SettingsPanel.w = 23\r\n    SettingsPanel.h = 9\r\n    SettingsPanel.style = 1\r\n\r\n    SettingsText = Create_UI_Element( ui.AddText() ,0,0,23)\r\n    SettingsText.text = GetSettingsText()\r\n\r\n    ListDecreaseButton = Create_UI_Element( ui.AddButton() ,14,1,3)\r\n    ListDecreaseButton.h = 1\r\n    ListDecreaseButton.text = \"-\"\r\n    ListDecreaseButton.style = StyleInvisible\r\n    ListDecreaseButton.SetDown(ListDecrease)\r\n\r\n    ListIncreaseButton = Create_UI_Element( ui.AddButton() ,18,1,3)\r\n    ListIncreaseButton.h = 1\r\n    ListIncreaseButton.text = \"+\"\r\n    ListIncreaseButton.style = StyleInvisible\r\n    ListIncreaseButton.SetDown(ListIncrease)\r\n\r\n    DamageToggleButton = Create_UI_Element( ui.AddButton() ,17,4,5)\r\n    DamageToggleButton.h = 1\r\n    DamageToggleButton.text = \"\"\r\n    DamageToggleButton.style = StyleInvisible\r\n    DamageToggleButton.SetDown(CheckingDamageToggle)\r\n\r\n    DebuffsToggleButton = Create_UI_Element( ui.AddButton() ,17,5,5)\r\n    DebuffsToggleButton.h = 1\r\n    DebuffsToggleButton.text = \"\"\r\n    DebuffsToggleButton.style = StyleInvisible\r\n    DebuffsToggleButton.SetDown(CheckingDebuffsToggle)\r\n\r\n    FoeBuffsToggleButton = Create_UI_Element( ui.AddButton() ,17,6,5)\r\n    FoeBuffsToggleButton.h = 1\r\n    FoeBuffsToggleButton.text = \"\"\r\n    FoeBuffsToggleButton.style = StyleInvisible\r\n    FoeBuffsToggleButton.SetDown(CheckingFoeBuffsToggle)\r\n\r\n    HealingToggleButton = Create_UI_Element( ui.AddButton() ,17,7,5)\r\n    HealingToggleButton.h = 1\r\n    HealingToggleButton.text = \"\"\r\n    HealingToggleButton.style = StyleInvisible\r\n    HealingToggleButton.SetDown(CheckingHealingToggle)\r\n \r\n    CloseSettings = Create_UI_Element( ui.AddButton() ,21,0,3)\r\n    CloseSettings.h = 1\r\n    CloseSettings.text = \"[x]\"\r\n    CloseSettings.style = StyleInvisible\r\n    CloseSettings.SetDown(OpenSettings)\r\n\r\n    SettingsPanel.Add(CloseSettings)\r\n    SettingsPanel.Add(SettingsText)\r\n    SettingsPanel.Add(ListIncreaseButton)\r\n    SettingsPanel.Add(ListDecreaseButton)\r\n    SettingsPanel.Add(DamageToggleButton)\r\n    SettingsPanel.Add(HealingToggleButton)\r\n    SettingsPanel.Add(DebuffsToggleButton)\r\n    SettingsPanel.Add(FoeBuffsToggleButton)\r\n  :\r\n    SettingsPanel.Recycle()\r\n    SettingsPanel = null\r\n\r\nfunc OnOffText(Bool)\r\n  ?Bool\r\n    return \"[color=#108010]ON[/color]\"\r\n  return \"[color=#A01010]OFF[/color]\"\r\n\r\nfunc GetSettingsText()\r\n  var ReturnText = ascii\r\n#######Settings\r\n#List Length: [#] [#]\r\n#[color=#606060]─────────────────────[/color]\r\n#####Event Logger:\r\n#Damage received [{0}]\r\n#Player Debuffed [{1}]\r\n#Foe Buffed      [{2}]\r\n#Player Healed   [{3}]\r\nasciiend\r\n  return string.format(ReturnText, OnOffText(CheckingDamage),OnOffText(CheckingDebuffs),OnOffText(CheckingFoeBuffs),OnOffText(CheckingHealing))\r\n\r\n?ToggleDragging\r\n  XSet = math.Clamp(input.x, 0, screen.w)\r\n  YSet = math.Clamp(input.y, 1, screen.h-1)\r\n  StateListBox.x = XSet\r\n  StateListBox.y = YSet\r\n  ?key ! \"primary\"\r\n    ToggleDragging = false\r\n    storage.Set(\"X\",XSet)\r\n    storage.Set(\"Y\",YSet)\r\n\r\nvar Math\r\nfunc CheckDamage()\r\n  Math = hp + armor + armor.f/10.0\r\n  ?Math + 0.5 < Defense\r\n    EventRecorder.Add([\"Received \"+math.RoundToInt(10*(Defense - Math))/10.0+\" damage at: \",foe.state,foe.time,totaltime])\r\n    UpdateEventDisplay()\r\n  Defense = Math\r\n\r\nfunc CheckHealing()\r\n  ?hp > PHealth\r\n    EventRecorder.Add([\"Healed \" + (hp-PHealth) + \" hp at: \",foe.state,foe.time,totaltime])\r\n    UpdateEventDisplay()\r\n  PHealth = hp\r\n\r\nfunc CheckDebuffs()\r\n  ?debuffs.count > DebuffCount\r\n    EventRecorder.Add([\"Received debuff at: \",foe.state,foe.time,totaltime])\r\n    UpdateEventDisplay()\r\n  DebuffCount = debuffs.count\r\n\r\nfunc CheckFoeBuffs()\r\n  ?foe.buffs.count > FoeBuffCount\r\n    EventRecorder.Add([\"Foe received buff at: \",foe.state,foe.time,totaltime])\r\n    UpdateEventDisplay()\r\n  :?foe.buffs.count < FoeBuffCount\r\n    EventRecorder.Add([\"Foe lost buff at: \",foe.state,foe.time,totaltime])\r\n    UpdateEventDisplay()\r\n  FoeBuffCount = foe.buffs.count\r\n\r\n?CheckingDamage\r\n  CheckDamage()\r\n?CheckingHealing\r\n  CheckHealing()\r\n?CheckingDebuffs\r\n  CheckDebuffs()\r\n?CheckingFoeBuffs\r\n  CheckFoeBuffs()\r\n\r\nfunc UpdateTimeText()\r\n  var Times = \"\"\r\n  for i =0..StateList.Count()-1\r\n    Times += StateList[i][1] + \"\\n\"\r\n  TimeListText.text = Times\r\n\r\nfunc UpdateStateText()\r\n  var States = \"\"\r\n  for i =0..StateList.Count()-1\r\n    States += StateList[i][0] + \"\\n\"\r\n  StateListText.text = States\r\n\r\nfunc UpdateTimeListText()\r\n  TimeListText.text = foe.state + \",\" + foe.time\r\n\r\nfunc UpdateEventDisplay()\r\n  var TempText = \"\"\r\n  for a : EventRecorder\r\n    TempText = TempText + a[0] + a[1] + \":\" + a[2] + \"\\n\"\r\n  EventDisplayText.text = TempText\r\n\r\nfunc CheckEventTimers()\r\n  ?EventRecorder[0][3] + 50 < totaltime\r\n    EventRecorder.RemoveAt(0)\r\n    UpdateEventDisplay()\r\n\r\nfunc CheckListMax()\r\n  ?StateList.Count() > MaxListLength\r\n    for a = MaxListLength..StateList.Count()-1\r\n      StateList.RemoveAt(MaxListLength)\r\n\r\n?StateList.Count()\r\n  ?foe.state ! StateList[0][0]\r\n    StateList.Insert(0,[foe.state,foe.time])\r\n    CheckListMax()\r\n    UpdateStateText()\r\n    UpdateTimeText()\r\n  :?foe.time ! StateList[0][1]\r\n    StateList[0].Emplace(1,foe.time)\r\n    UpdateTimeText()\r\n:?foe.distance < 30\r\n  StateList.Add([foe.state,foe.time])\r\n  UpdateStateText()\r\n  UpdateTimeText()\r\n\r\n?StateListBox.h ! 2+MaxListLength\r\n  StateListBox.Recycle()\r\n  init = true\r\n\r\n?EventRecorder.Count()\r\n  CheckEventTimers()"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/RecordPlayer.txt" - Parse error: Failed to parse completely. Remaining: "= \"\"\r\nvar LocationList = [\r\n\"Boiling Mine\",\r\n\"Caves of Fear\",\r\n\"Deadwood Canyon\",\r\n\"Haunted Halls\",\r\n\"Icy Ridge\",\r\n\"Mushroom Forest\",\r\n\"Rocky Plateau\",\r\n\"Temple\",\r\n[\"Events\",\r\n\"Eventos\",\r\n\"活动\",\r\n\"活動\",\r\n\"Événements\",\r\n\"Evenementen\",\r\n\"События\",\r\n\"Eventos\",\r\n\"Eventos\",\r\n\"イベント\",\r\n\"이벤트\",\r\n\"Olaylar\"],\r\n[\"Other\",\r\n\"De outros\",\r\n\"其他\",\r\n\"其他\",\r\n\"Autre\",\r\n\"Ander\",\r\n\"Другой\",\r\n\"Otro\",\r\n\"Otro\",\r\n\"他の\",\r\n\"다른\",\r\n\"Başka\"]\r\n]\r\nvar MusicList = [\r\n[\"bronze_guardian_3\",\r\n\"bronze_guardian_4\",\r\n\"bronze_guardian_5\",\r\n\"bronze_guardian_cyan\",\r\n\"bronze_mine_0\",\r\n\"bronze_mine_1\",\r\n\"bronze_mine_2\",\r\n\"bronze_mine_3\",\r\n\"bronze_mine_4\",\r\n\"bronze_mine_5\",\r\n\"bronze_mine_cyan\",\r\n\"slave_outro_climb\",\r\n\"slave_outro_loop\"],\r\n[\"caustic_caves\",\r\n\"spider_boss\"],\r\n[\"cross_deadwood_river\",\r\n\"cross_deadwood_wind\",\r\n\"deadwood_0\",\r\n\"deadwood_1\",\r\n\"deadwood_2\",\r\n\"deadwood_3\",\r\n\"deadwood_4\",\r\n\"deadwood_5\",\r\n\"deadwood_cyan\",\r\n\"tree_boss\",\r\n\"waterfall_descent\"],\r\n[\"skeleton_boss\",\r\n\"undead_crypt_0\",\r\n\"undead_crypt_1\",\r\n\"undead_crypt_2\",\r\n\"undead_crypt_3\",\r\n\"undead_crypt_4\",\r\n\"undead_crypt_5\",\r\n\"undead_crypt_cyan\",\r\n\"undead_crypt_intro\"],\r\n[\"bridge_broken\",\r\n\"bridge_crossing\",\r\n\"icy_ridge_0\",\r\n\"icy_ridge_1\",\r\n\"icy_ridge_2\",\r\n\"icy_ridge_3\",\r\n\"icy_ridge_4\",\r\n\"icy_ridge_5\",\r\n\"icy_ridge_cyan\",\r\n\"yeti\"],\r\n[\"fire_loop\",\r\n\"fungus_forest_0\",\r\n\"fungus_forest_1\",\r\n\"fungus_forest_2\",\r\n\"fungus_forest_3\",\r\n\"fungus_forest_4\",\r\n\"fungus_forest_5\",\r\n\"fungus_forest_cyan\",\r\n\"mushroom_boss\",\r\n\"mushroom_boss_cyan\",\r\n\"shop\"],\r\n[\"rocky_plateau_0\",\r\n\"rocky_plateau_1\",\r\n\"rocky_plateau_2\",\r\n\"rocky_plateau_3\",\r\n\"rocky_plateau_4\",\r\n\"rocky_plateau_5\",\r\n\"rocky_plateau_epilogue\",\r\n\"rocky_plateau_fight\",\r\n\"rocky_plateau_talk\"],\r\n[\"nagaraja\",\r\n\"temple_0\",\r\n\"temple_1\",\r\n\"temple_2\",\r\n\"temple_3\",\r\n\"temple_4\",\r\n\"temple_5\",\r\n\"temple_cyan\"],\r\n[\"event_fall\",\r\n\"event_hamartia\",\r\n\"event_spring\",\r\n\"event_stonejam\",\r\n\"event_summer\",\r\n\"event_winter\"],\r\n[\"credits\",\r\n\"main_menu\",\r\n\"bone_factory\",\r\n\"osteophone\",\r\n\"uulaa\"]\r\n]\r\nvar LangArray = [\"EN\", \"PT-BR\", \"ZH-CN\", \"ZH-TW\", \"FR\", \"DE\", \"RU\", \"ES-LA\", \"ES-EU\", \"JP\", \"KR\", \"TK\"]\r\nvar MusicListX = storage.Get(\"MusicIndexX\", 0)\r\nvar MusicListY = storage.Get(\"MusicIndexY\", 0)\r\nstorage.Set(\"MusicIndexX\", MusicListX)\r\nstorage.Set(\"MusicIndexY\", MusicListY)\r\nvar RP = false\r\nvar RPStop = true\r\n?loc.begin\r\n\tambient.Stop()\r\n\r\n\tRPconcealButton = ui.AddButton()\r\n\tRPconcealButton.x = 0\r\n\tRPconcealButton.y = -5\r\n\tRPconcealButton.w = 3\r\n\tRPconcealButton.h = 3\r\n\tRPconcealButton.text = \"♫\"\r\n\tRPconcealButton.anchor = center_left\r\n\tRPconcealButton.dock = center_left\r\n\tRPconcealButton.sound = logo_short\r\n\tRPconcealButton.style = 1\r\n\tRPconcealButton.SetPressed(Conceal)\r\n\r\n\tRPpanel = ui.AddPanel()\r\n\tRPpanel.x = 0\r\n\tRPpanel.y = 0\r\n\tRPpanel.w = 43\r\n\tRPpanel.h = 12\r\n\tRPpanel.anchor = center_center\r\n\tRPpanel.dock = center_center\r\n\tRPpanel.visible = false\r\n\tRPpanel.clip = true\r\n\tRPpanel.style = ui.AddStyle(\"#########\")\r\n\r\n\tPowerButton = ui.AddButton()\r\n\tPowerButton.x = -18\r\n\tPowerButton.y = 5\r\n\tPowerButton.w = 3\r\n\tPowerButton.h = 2\r\n\tPowerButton.text = \"\"\r\n\tPowerButton.anchor = center_center\r\n\tPowerButton.dock = center_center\r\n\tPowerButton.visible = false\r\n\tPowerButton.sound = mindstone_on\r\n\tPowerButton.style = 0\r\n\tPowerButton.SetPressed(RPPower)\r\n\tRPpanel.Add(PowerButton)\r\n\t\r\n\tPreviousButton = ui.AddButton()\r\n\tPreviousButton.x = -9\r\n\tPreviousButton.y = 5\r\n\tPreviousButton.w = 3\r\n\tPreviousButton.h = 2\r\n\tPreviousButton.text = \"\"\r\n\tPreviousButton.anchor = center_center\r\n\tPreviousButton.dock = center_center\r\n\tPreviousButton.visible = false\r\n\tPreviousButton.sound = click\r\n\tPreviousButton.style = 0\r\n\tPreviousButton.SetPressed(PreviousMusic)\r\n\tRPpanel.Add(PreviousButton)\r\n\t\r\n\tPlayStopButton = ui.AddButton()\r\n\tPlayStopButton.x = 0\r\n\tPlayStopButton.y = 5\r\n\tPlayStopButton.w = 3\r\n\tPlayStopButton.h = 2\r\n\tPlayStopButton.text = \"\"\r\n\tPlayStopButton.anchor = center_center\r\n\tPlayStopButton.dock = center_center\r\n\tPlayStopButton.visible = false\r\n\tPlayStopButton.sound = click\r\n\tPlayStopButton.style = 0\r\n\tPlayStopButton.SetPressed(PlayStopMusic)\r\n\tRPpanel.Add(PlayStopButton)\r\n\r\n\tNextButton = ui.AddButton()\r\n\tNextButton.x = 9\r\n\tNextButton.y = 5\r\n\tNextButton.w = 3\r\n\tNextButton.h = 2\r\n\tNextButton.text = \"\"\r\n\tNextButton.anchor = center_center\r\n\tNextButton.dock = center_center\r\n\tNextButton.visible = false\r\n\tNextButton.sound = click\r\n\tNextButton.style = 0\r\n\tNextButton.SetPressed(NextMusic)\r\n\tRPpanel.Add(NextButton)\r\n\r\n\tTextbg = ui.AddAnim(ascii\r\n        \r\n        \r\nasciiend)\r\n\tTextbg.x = 14\r\n\tTextbg.y = -4\r\n\tTextbg.w = 8\r\n\tTextbg.h = 2\r\n\tTextbg.anchor = center_center\r\n\tTextbg.dock = center_center\r\n\tTextbg.visible = false\r\n\tTextbg.color = #000000\r\n\tRPpanel.Add(Textbg)\r\n\r\n\tMusicAlbum = ui.AddText()\r\n\tMusicAlbum.x = 11\r\n\tMusicAlbum.y = -5\r\n\tMusicAlbum.w = 7\r\n\tMusicAlbum.h = 1\r\n\tMusicAlbum.anchor = center_left\r\n\tMusicAlbum.dock = center_center\r\n\tMusicAlbum.visible = false\r\n\tMusicAlbum.align = left\r\n\tMusicAlbum.color = #028900\r\n\tMusicAlbum.text = \"\"\r\n\tRPpanel.Add(MusicAlbum)\r\n\r\n\tMusicName = ui.AddText()\r\n\tMusicName.x = 10\r\n\tMusicName.y = -4\r\n\tMusicName.w = 7\r\n\tMusicName.h = 1\r\n\tMusicName.anchor = center_left\r\n\tMusicName.dock = center_center\r\n\tMusicName.visible = false\r\n\tMusicName.align = left\r\n\tMusicName.color = #028900\r\n\tMusicName.text = \"\"\r\n\tRPpanel.Add(MusicName)\r\n\r\n\tRProll = ui.AddAnim(ascii\r\n#########___________ _I-I__ ______________\r\n########/           \"-|_|-.\\   /#######/ /┊\r\n#######'       ____           /#######/ ' ┊\r\n######|  __,--'    `--.__     ‾‾‾‾‾‾‾‾ |  ┊\r\n#####/,-'      ,-\"-.     ‾`-          /   '\r\n####/(        (  ^  )       )        '   /\r\n###/  `m.__    `-.-'      .m        /   /\r\n##|     `\"\"mm.______,mm\"\"'         |   .\r\n#/           `\"\"\"\"\"\"'             /   /\r\n/________________________________/   /\r\n| /|\\      ///      ||\\      \\\\\\ |  /\r\n\\_\\|/______\\\\\\______||/______///_/.'\r\n%%\r\n#########___________ _I-I__ ______________\r\n########/           \"-|_|-.\\   /#######/ /┊\r\n#######'       ____           /#######/ ' ┊\r\n######|  __,--'    `--.__     ‾‾‾‾‾‾‾‾ |  ┊\r\n#####/,m´      ,-\"-.     ‾`-          /   '\r\n####/(        (  ^  )       )        '   /\r\n###/  mm.__    `-.-'      .´        /   /\r\n##|     `\"\"mm.______,m.\"\"          |   .\r\n#/           `\"\"\"\" '              /   /\r\n/________________________________/   /\r\n| /|\\      ///      ||\\      \\\\\\ |  /\r\n\\_\\|/______\\\\\\______||/______///_/.'\r\n%%\r\n#########___________ _I-I__ ______________\r\n########/           \"-|_|-.\\   /#######/ /┊\r\n#######'       ____           /#######/ ' ┊\r\n######|  __mm-'    `--m__     ‾‾‾‾‾‾‾‾ |  ┊\r\n#####/,-'      ,-\"-.     ‾`-          /   '\r\n####/(        (  ^  )       )        '   /\r\n###/  mm._     `-.-'      .´        /   /\r\n##|      \"\"'m.______,..\"\"          |   .\r\n#/           `\"\"\"\"\"'              /   /\r\n/________________________________/   /\r\n| /|\\      ///      ||\\      \\\\\\ |  /\r\n\\_\\|/______\\\\\\______||/______///_/.'\r\n%%\r\n#########___________ _I-I__ ______________\r\n########/           \"-|_|-.\\   /#######/ /┊\r\n#######'       ____           /#######/ ' ┊\r\n######|  __mm-'    `-mm__     ‾‾‾‾‾‾‾‾ |  ┊\r\n#####/m-'      ,-\"-.     ‾`m          /   '\r\n####/(        (  ^  )       )        '   /\r\n###/  \".._     `-.-'      .´        /   /\r\n##|      \"\"'..______,.m\"\"          |   .\r\n#/           `\"\"\"\"\"'              /   /\r\n/________________________________/   /\r\n| /|\\      ///      ||\\      \\\\\\ |  /\r\n\\_\\|/______\\\\\\______||/______///_/.'\r\n%%\r\n#########___________ _I-I__ ______________\r\n########/           \"-|_|-.\\   /#######/ /┊\r\n#######'       ____           /#######/ ' ┊\r\n######|  __,--'    `-m.__     ‾‾‾‾‾‾‾‾ |  ┊\r\n#####/,-'      ,-\"-.     ‾mm          /   '\r\n####/(        (  ^  )       )        '   /\r\n###/  \".._     `-.-'      .´        /   /\r\n##|      \"\"'m.______,.mm\"          |   .\r\n#/           `\"\"\"\"\"'              /   /\r\n/________________________________/   /\r\n| /|\\      ///      ||\\      \\\\\\ |  /\r\n\\_\\|/______\\\\\\______||/______///_/.'\r\nasciiend)\r\n\tRProll.x = 0\r\n\tRProll.y = 0\r\n\tRProll.anchor = center_center\r\n\tRProll.dock = center_center\r\n\tRProll.color = #EEEEEE\r\n\tRProll.duration = 50\r\n\tRProll.frame = 0\r\n\tRProll.loop = true\r\n\tRProll.flipX = false\r\n\tRProll.flipY = false\r\n\tRProll.playOnStart = false\r\n\tRProll.pivotX = 0\r\n\tRProll.pivotY = 0\r\n\tRProll.visible = false\r\n\tRProll.Stop()\r\n\tRPpanel.Add(RProll)\r\n\r\n\tRPswitch = ui.AddAnim(ascii\r\n#################### _I-I__ \r\n####################\"-|_|-.\\\r\n###########################\\\\\r\n############################\\\\\r\n#############################\\\\\r\n#############################_))\r\n############################/_/-'\r\n############################`w\r\n%%\r\n#################### _I-I__ \r\n####################\"-|_|-.\\\r\n##########################//\r\n#########################//\r\n#######################_//\r\n######################/_/-'\r\n######################`w\r\nasciiend)\r\n\tRPswitch.x = -5\r\n\tRPswitch.y = -2\r\n\tRPswitch.anchor = center_center\r\n\tRPswitch.dock = center_center\r\n\tRPswitch.color = #EEEEEE\r\n\tRPswitch.duration = 0\r\n\tRPswitch.frame = 0\r\n\tRPswitch.loop = false\r\n\tRPswitch.flipX = false\r\n\tRPswitch.flipY = false\r\n\tRPswitch.playOnStart = false\r\n\tRPswitch.pivotX = 0\r\n\tRPswitch.pivotY = 0\r\n\tRPswitch.visible = false\r\n\tRPswitch.Stop()\r\n\tRPpanel.Add(RPswitch)\r\n\r\nfunc Conceal()\r\n\tPowerButton.visible = !PowerButton.visible\r\n\tPreviousButton.visible = !PreviousButton.visible\r\n\tPlayStopButton.visible = !PlayStopButton.visible\r\n\tNextButton.visible = !NextButton.visible\r\n\tTextbg.visible = !Textbg.visible\r\n\tRProll.visible = !RProll.visible\r\n\tRPswitch.visible = !RPswitch.visible\r\n\t?MusicAlbum.visible\r\n\t\tMusicAlbum.visible = !MusicAlbum.visible\r\n\t?MusicName.visible\r\n\t\tMusicName.visible = !MusicName.visible\r\n\r\nfunc RPPower()\r\n\tRP = !RP\r\n\t?!RP\r\n\t\tmusic.Stop()\r\n\t\t?!RPStop\r\n\t\t\tRPStop = !RPStop\r\n\r\nfunc PreviousMusic()\r\n\t?RP\r\n\t\tMusicListY = MusicListY - 1\r\n\t\t?MusicListY < 0\r\n\t\t\tMusicListX = MusicListX - 1\r\n\t\t\t?MusicListX < 0\r\n\t\t\t\tMusicListX = LocationList.Count() - 1\r\n\t\t\tMusicListY = MusicList[MusicListX].Count() - 1\r\n\t\tmusic.Play(MusicList[MusicListX][MusicListY])\r\n\t\t?RPStop\r\n\t\t\tRPStop = !RPStop\r\n\r\nfunc PlayStopMusic()\r\n\t?RP\r\n\t\tRPStop = !RPStop\r\n\t\t?RPStop\r\n\t\t\tmusic.Stop()\r\n\t\t:\r\n\t\t\tmusic.Play(MusicList[MusicListX][MusicListY])\r\n\r\nfunc NextMusic()\r\n\t?RP\r\n\t\tMusicListY = MusicListY + 1\r\n\t\t?MusicListY > MusicList[MusicListX].Count() - 1\r\n\t\t\tMusicListX = MusicListX + 1\r\n\t\t\t?MusicListX > LocationList.Count() - 1\r\n\t\t\t\tMusicListX = 0\r\n\t\t\tMusicListY = 0\r\n\t\tmusic.Play(MusicList[MusicListX][MusicListY])\r\n\t\t?RPStop\r\n\t\t\tRPStop = !RPStop\r\n\r\n?!RP\r\n\tPowerButton.sound = mindstone_on\r\n\tPreviousButton.sound = click\r\n\tPlayStopButton.sound = click\r\n\tNextButton.sound = click\r\n\tRPswitch.frame = 0\r\n\tMusicAlbum.visible = false\r\n\tMusicName.visible = false\r\n\tRProll.Pause()\r\n:\r\n\tPowerButton.sound = mindstone_off\r\n\tPreviousButton.sound = confirm\r\n\tPlayStopButton.sound = confirm\r\n\tNextButton.sound = confirm\r\n\tRPswitch.frame = 1\r\n\t?!RPStop\r\n\t\t?RProll.visible\r\n\t\t\tMusicAlbum.visible = true\r\n\t\t\tMusicName.visible = true\r\n\t\t?MusicListX < 8\r\n\t\t\talbum = te.xt(LocationList[MusicListX])\r\n\t\t:\r\n\t\t\talbum = LocationList[MusicListX][LangArray.IndexOf(te.language)]\r\n\t\tMusicAlbum.text = album\r\n\t\tMusicAlbum.w = string.Size(album)\r\n\t\t?MusicAlbum.w > 7\r\n\t\t\tMusicAlbum.x = 11 - (totaltime/20)%(MusicAlbum.w - 6)\r\n\t\t:\r\n\t\t\tMusicAlbum.x = 11\r\n\t\tMusicName.text = music\r\n\t\tMusicName.w = string.Size(music)\r\n\t\t?MusicName.w > 7\r\n\t\t\tMusicName.x = 10 - (totaltime/20)%(MusicName.w - 6)\r\n\t\t:\r\n\t\t\tMusicName.x = 10\r\n\t\tRProll.Play()\r\n\t:\r\n\t\tMusicAlbum.visible = false\r\n\t\tMusicName.visible = false\r\n\t\tRProll.Pause()"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/BetterInfo2.txt" - Parse error: Failed to parse completely. Remaining: "= \"\"\r\nvar desc2 = \"\"\r\nvar buffsAndStats\r\nvar txtDesc1\r\nvar txtBuffsStats\r\nvar txtDesc2\r\nvar width\r\nvar height\r\nvar teWK = te.xt(\"Weakness\")\r\nvar teARM = te.xt(\"Armor\") + \": \"\r\nvar teHP = te.xt(\"Hitpoints\") + \": \"\r\nvar teRNG = te.xt(\"Range\") + \": \"\r\nvar teBUFF = te.xt(\"Buffs\") + \": \"\r\nvar teDBFF = te.xt(\"Debuffs\") + \": \"\r\nvar isEN = (te.language = \"EN\")\r\nvar elemArray = [[\"Vigor\", \" ∞\"],\r\n                 [\"AEther\", \" ❤\"],\r\n                 [\"Fire\", \" *\"],\r\n                 [\"Ice\", \" φ\"],\r\n                 [\"Poison\", \" ❄\"]]\r\n\r\n////////////////////////////////////////////////\r\n\r\n?totaltime = 1\r\n  setupInfoPnl()\r\n  disable pause\r\n?update()\r\n  display()\r\n\r\n////////////////////////////////////////////////\r\n\r\nfunc update()\r\n  foe_ = foe\r\n  ?foe_ ! lastfoe | lastfoe ! foe_\r\n    lastfoe = foe_\r\n    foe_name = te.ToEnglish(foe.name)\r\n    infoPnl.visible = !!foe_\r\n    ?!foe_\r\n      enable pause\r\n      return false\r\n    :\r\n      disable pause\r\n      updateFoeDescription()\r\n  lastfoe = foe_\r\n  fbs = foe.buffs.string\r\n  fds = foe.debuffs.string\r\n  fd = foe.distance\r\n  foehp = foe.hp\r\n  foemaxhp = foe.maxhp\r\n  foearmor = foe.armor\r\n  updateFoeStats()\r\n  return true\r\n\r\nfunc updateFoeDescription()\r\n  desc1 = te.xt(foe_name) + \"\\n\" + teWK\r\n  for elem : elemArray\r\n    ?foe_ ! elem[0]\r\n      desc1 += \"[color=#505050]\"\r\n             ^+ elem[1] + \"[/color]\"\r\n    :\r\n      desc1 += elem[1]\r\n\r\n  ?foe_ = foe_name\r\n    var arr = string.Split(foe_, foe_name)\r\n  :\r\n    var arr = string.Split(foe_, te.GetTID(foe.name))\r\n  desc2 = \"\"\r\n  ?arr.Count()\r\n    ?isEN\r\n      desc2 = string.Join(\" \",\r\n         ^string.Split(arr[1],\r\n         ^\"Poison\", \"Vigor\", \"AEther\", \r\n         ^\"Fire\", \"Ice\", \" \", true))\r\n    :\r\n      var propsArr = string.Split(\r\n         ^arr[1],\r\n         ^\"Poison\", \"Vigor\", \"AEther\", \r\n         ^\"Fire\", \"Ice\", \" \", true)\r\n      ?propsArr.Count()\r\n        for i = 0 .. propsArr.Count()-1\r\n          propsArr[i] = te.xt(propsArr[i])\r\n        desc2 = string.Join(\" \", propsArr)\r\n\r\nfunc updateFoeStats()\r\n  var stats = \"\"\r\n  buffsAndStats = \"\"\r\n  height = 4\r\n  width = 0\r\n  ?fbs\r\n    var buffs = formatBuffs(fbs)\r\n    width = string.Size(buffs)+7\r\n    buffsAndStats = teBUFF + cTxt(buffs, \r\n                    ^\"#ff0000\") + \"\\n\"\r\n    height++\r\n  ?fds\r\n    var debuffs = formatBuffs(fds)\r\n    width = max(width, string.Size(debuffs)+9)\r\n    buffsAndStats += teDBFF +\r\n                    ^cTxt(debuffs, \"#00ff00\") + \"\\n\"\r\n    height++\r\n  stats = teARM + foearmor + \" \" + teHP + foehp + \"/\" +\r\n          ^foemaxhp + \" \" + teRNG + fd\r\n  width = max(width, string.Size(stats))\r\n  buffsAndStats += stats\r\n  var sizeDesc2 = string.Size(desc2)\r\n  ?!sizeDesc2\r\n    height--\r\n  :?sizeDesc2 > width\r\n    txtDesc2.h = 2\r\n    height++\r\n  :\r\n    txtDesc2.h = 1\r\n\r\nfunc formatBuffs(str)\r\n  var ret = \"\"\r\n  for dbf : string.Split(str, \",\")\r\n    var dbr = string.Split(dbf, \":\")\r\n      ?ret\r\n        ret += \" \"\r\n      ret += dbr[2] + dbr[0] + \" \" + dbr[3]\r\n  return ret\r\n\r\nfunc cTxt(txt, color)\r\n  return \"[color=\" + color + \"]\" + txt + \"[/color]\"\r\n\r\nfunc max(a, b)\r\n  ?a >= b\r\n    return a\r\n  :\r\n    return b\r\n\r\nfunc display()\r\n  txtDesc1.w = width\r\n  txtDesc1.text = desc1\r\n  txtDesc2.w = width\r\n  txtDesc2.text = desc2\r\n  txtBuffsStats.w = width\r\n  txtBuffsStats.text = buffsAndStats\r\n  infoPnl.w = width + 4\r\n  infoPnl.h = height + 2\r\n  pauseBtn.w = width + 4\r\n  pauseBtn.h = height + 2\r\n\r\nfunc setupInfoPnl()\r\n  infoPnl = ui.AddPanel()\r\n  infoPnl.dock = \"bottom_right\"\r\n  infoPnl.anchor = \"bottom_right\"\r\n  infoPnl.style = -3\r\n  txtDesc1 = ui.AddText()\r\n  infoPnl.Add(txtDesc1)\r\n  txtDesc1.h = 2\r\n  txtDesc1.x = 2\r\n  txtDesc1.y = 1\r\n  txtDesc1.dock = \"top_left\"\r\n  txtDesc1.anchor = \"top_left\"\r\n  txtBuffsStats = ui.AddText()\r\n  infoPnl.Add(txtBuffsStats)\r\n  txtBuffsStats.x = 2\r\n  txtBuffsStats.y = 3\r\n  txtBuffsStats.dock = \"top_left\"\r\n  txtBuffsStats.anchor = \"top_left\"\r\n  txtDesc2 = ui.AddText()\r\n  infoPnl.Add(txtDesc2)\r\n  txtDesc2.x = 2\r\n  txtDesc2.y = -1\r\n  txtDesc2.dock = \"bottom_left\"\r\n  txtDesc2.anchor = \"bottom_left\"\r\n  pauseBtn = ui.AddButton()\r\n  infoPnl.Add(pauseBtn)\r\n  pauseBtn.style = -3\r\n  pauseBtn.text = \"\"\r\n  pauseBtn.SetPressed(loc.Pause)\r\n\r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/ClickAbilities.txt" - Parse error: Failed to parse completely. Remaining: "= \"bardiche\"\r\nvar HammerDefault   = \"heavy hammer\"\r\n\r\nvar LongDash = true\r\n/* This setting will mean that the dash/bash\r\nbuttons may use qstaff to extend dash reach */\r\n\r\nfunc SysUpdateRate()\r\n  ?sys.isPC\r\n    return 4\r\n  :\r\n    return 8\r\n\r\nfunc SetDisplay(Boolean)\r\n  DisplayOn = Boolean\r\n  ?!CAinit\r\n    CA_BasePanel.Recycle()\r\n    CAinit = true\r\n\r\nvar UpdateRate = SysUpdateRate()\r\n/* This changes how often the ability display updates. \r\nCan be tweaked with \"ClickAbilities.UpdateRate = x\" */\r\n\r\nvar SelectTab = ui.AddStyle(\"\r\n^╔═╛\r\n^║  \r\n^╚═╕\")\r\n\r\nvar DeselectTab = ui.AddStyle(\"\r\n^┌—#\r\n^│ #\r\n^└─#\")\r\n\r\nvar DisplayOn = true\r\nvar CAinit = true\r\nvar GetCD = item.GetCooldown\r\n\r\nvar BashText\r\nvar BashCanvas\r\nvar BashButton\r\n\r\nvar DashText\r\nvar DashCanvas\r\nvar DashButton\r\n\r\nvar QstaffText\r\nvar QstaffCanvas\r\nvar QstaffButton\r\n\r\nvar MindText\r\nvar MindCanvas\r\nvar MindButton\r\n\r\nvar HammerText\r\nvar HammerCanvas\r\nvar HammerButton\r\n\r\nvar BardText\r\nvar BardCanvas\r\nvar BardButton\r\n\r\nvar BladeText\r\nvar BladeCanvas\r\nvar BladeButton\r\n\r\nvar MaskText\r\nvar MaskCanvas\r\nvar MaskButton\r\n\r\nvar WispText\r\nvar WispCanvas\r\nvar WispButton\r\n\r\nvar CindSumButton\r\nvar VoidSumButton\r\n\r\nvar ScriptToggleText\r\nvar ScriptToggleButton\r\n\r\nvar CA_BasePanel\r\n\r\nvar BladeDelay\r\nvar WispInit = true\r\n\r\nvar MinimiseButton\r\nvar MinimiseToggle = false\r\nfunc CheckSys()\r\n  ?sys.isPC\r\n    return 0\r\n  return -10\r\nvar MobileHotbarOffset = CheckSys()\r\nvar ShiftX = screen.w - 1 + MobileHotbarOffset\r\nvar ShiftY = 1\r\nvar ActivationTime = -1\r\n\r\nvar MainTabButton\r\nvar WandTabButton\r\nvar StaffTabButton\r\nvar SelectedTab = 0\r\nvar TabList\r\n\r\n\r\nvar ResetText\r\nvar ResetCanvas\r\nvar ResetButton\r\n\r\nvar PlagueText\r\nvar PlagueCanvas\r\nvar PlagueButton\r\n\r\nvar CalamityText\r\nvar CalamityCanvas\r\nvar CalamityButton\r\n\r\nvar ExploText\r\nvar ExploCanvas\r\nvar ExploButton\r\n\r\nvar FrostText\r\nvar FrostCanvas\r\nvar FrostButton\r\n\r\nvar GravityText\r\nvar GravityCanvas\r\nvar GravityButton\r\n\r\nvar PreventText\r\nvar PreventCanvas\r\nvar PreventButton\r\n\r\nvar BerserkText\r\nvar BerserkCanvas\r\nvar BerserkButton\r\n\r\nvar GraspingText\r\nvar GraspingCanvas\r\nvar GraspingButton\r\n\r\nvar InfernalText\r\nvar InfernalCanvas\r\nvar InfernalButton\r\n\r\nvar EternityText\r\nvar EternityCanvas\r\nvar EternityButton\r\n\r\nvar AcrobatText\r\nvar AcrobatCanvas\r\nvar AcrobatButton\r\n\r\nvar StyleInvisible = ui.AddStyle(\"\r\n^###\r\n^###\r\n^###\")\r\n\r\nfunc CheckInterruptProtocol()\r\n  return ActivationTime = -1\r\n\r\nfunc CheckItem(Item)\r\n  return GetCD(Item)<=0 & item.CanActivate()\r\n\r\nfunc Qstaff()\r\n  ?CheckItem(\"quarterstaff\")\r\n    equip quarterstaff\r\n    activate R\r\n    ?item.left\r\n      equipL @item.left@\r\n    equip @item.right@\r\n\r\nfunc Mask()\r\n  ?CheckItem(\"mask\") & CheckInterruptProtocol()\r\n    SetReequips()\r\n    InterruptProtocol = OneTickProtocol\r\n    ActivationTime = 0\r\n    equipR mask\r\n    activate R\r\nfunc Mind()\r\n  ?CheckItem(\"mind\") & CheckInterruptProtocol()\r\n    SetReequips()\r\n    InterruptProtocol = OneTickProtocol\r\n    ActivationTime = 0\r\n    equipL mind\r\nfunc Dash()\r\n  ?GetCD(\"dash\")<=0 & CheckInterruptProtocol()\r\n    ?LongDash\r\n      ?CheckItem(\"quarterstaff\") & foe.distance < 22 & foe.distance > 17\r\n        equip quarterstaff\r\n        activate R\r\n    SetReequips()\r\n    InterruptProtocol = OneTickProtocol\r\n    ActivationTime = 0\r\n    equipR dash\r\nfunc Bash()\r\n  ?GetCD(\"bash\")<=0 & CheckInterruptProtocol()\r\n    ?LongDash\r\n      ?CheckItem(\"quarterstaff\") & foe.distance < 22 & foe.distance > 17\r\n        equip quarterstaff\r\n        activate R\r\n    SetReequips()\r\n    InterruptProtocol = OneTickProtocol\r\n    ActivationTime = 0\r\n    equipR bash\r\n\r\nfunc Reset()\r\n  ?CheckItem(\"wand_vigor\") & CheckInterruptProtocol()\r\n    SetReequips()\r\n    InterruptProtocol = OneTickProtocol\r\n    ActivationTime = 0\r\n    equipR reset wand\r\n    activate R\r\nfunc Plague()\r\n  ?CheckItem(\"wand_poison\") & CheckInterruptProtocol()\r\n    SetReequips()\r\n    InterruptProtocol = OneTickProtocol\r\n    ActivationTime = 0\r\n    equipR plague wand\r\n    activate R\r\nfunc Calamity()\r\n  ?CheckItem(\"wand_aether\") & CheckInterruptProtocol()\r\n    SetReequips()\r\n    InterruptProtocol = OneTickProtocol\r\n    ActivationTime = 0\r\n    equipR aether wand\r\n    activate R\r\nfunc Explode()\r\n  ?CheckItem(\"wand_fire\") & CheckInterruptProtocol()\r\n    SetReequips()\r\n    InterruptProtocol = OneTickProtocol\r\n    ActivationTime = 0\r\n    equipR explosive wand\r\n    activate R\r\nfunc Frost()\r\n  ?CheckItem(\"wand_ice\") & CheckInterruptProtocol()\r\n    SetReequips()\r\n    InterruptProtocol = OneTickProtocol\r\n    ActivationTime = 0\r\n    equipR frost wand\r\n    activate R\r\nfunc Gravity()\r\n  ?CheckItem(\"wand_stone\") & CheckInterruptProtocol()\r\n    SetReequips()\r\n    InterruptProtocol = OneTickProtocol\r\n    ActivationTime = 0\r\n    equipR gravity wand\r\n    activate R\r\nfunc Prevention()\r\n  ?CheckItem(\"staff_vigor\") & CheckInterruptProtocol()\r\n    SetReequips()\r\n    InterruptProtocol = OneTickProtocol\r\n    ActivationTime = 0\r\n    equip Prevention staff\r\n    activate R\r\nfunc Berserker()\r\n  ?CheckItem(\"staff_poison\") & CheckInterruptProtocol()\r\n    SetReequips()\r\n    InterruptProtocol = OneTickProtocol\r\n    ActivationTime = 0\r\n    equip Berserker staff\r\n    activate R\r\nfunc Grasping()\r\n  ?CheckItem(\"staff_aether\") & CheckInterruptProtocol()\r\n    SetReequips()\r\n    InterruptProtocol = OneTickProtocol\r\n    ActivationTime = 0\r\n    equip Grasping staff\r\n    activate R\r\nfunc Infernal()\r\n  ?CheckItem(\"staff_fire\") & CheckInterruptProtocol()\r\n    SetReequips()\r\n    InterruptProtocol = OneTickProtocol\r\n    ActivationTime = 0\r\n    equip Infernal staff\r\n    activate R\r\nfunc Eternity()\r\n  ?CheckItem(\"staff_ice\") & CheckInterruptProtocol()\r\n    SetReequips()\r\n    InterruptProtocol = OneTickProtocol\r\n    ActivationTime = 0\r\n    equip Eternity staff\r\n    activate R\r\nfunc Acrobatic()\r\n  ?CheckItem(\"staff_stone\") & CheckInterruptProtocol()\r\n    SetReequips()\r\n    InterruptProtocol = OneTickProtocol\r\n    ActivationTime = 0\r\n    equip Acrobatic staff\r\n    activate R\r\n\r\nfunc Bard(input)\r\n  ?BardButton = input\r\n    ?CheckItem(\"bardiche\") & CheckInterruptProtocol()\r\n      UseR(BardicheDefault)\r\n  :\r\n    UseR(input)\r\nfunc Hamm(input)\r\n  ?HammerButton = input\r\n    ?CheckItem(\"heavy_hammer\") & CheckInterruptProtocol()\r\n      UseR(HammerDefault)\r\n  :\r\n    UseR(input)\r\nfunc Hammer(input)\r\n  UseR(input)\r\nfunc Bardiche(input)\r\n  UseR(input)\r\n\r\nfunc UseR(Weap)\r\n  SetReequips()\r\n  InterruptProtocol = SuperAttackRightProtocol\r\n  equip @Weap@\r\n  activate R\r\n  ActivationTime = 0\r\n\r\nfunc UseL(Weap)\r\n  SetReequips()\r\n  InterruptProtocol = SuperAttackLeftProtocol\r\n  equipL @Weap@\r\n  activate L\r\n  ActivationTime = 0\r\n\r\nfunc Blade()\r\n  ?CheckItem(\"blade\") & CheckInterruptProtocol()\r\n    BladeDelay = 20\r\n    InterruptProtocol = BladeProtocol\r\n    ActivationTime = 0\r\n    screen.next()\r\n\r\nfunc SummonCinder()\r\n  ?CheckItem(\"fire_talisman\") & CheckInterruptProtocol()\r\n    UseL(\"Fire Talisman\")\r\nfunc SummonWeaver()\r\n  ?CheckItem(\"aether_talisman\") & CheckInterruptProtocol()\r\n    UseL(\"Aether Talisman\")\r\n\r\nfunc WispActivate()\r\n  ?summon.GetName() = \"Cinderwisp\"\r\n    activate Cinderwisp\r\n  :\r\n    activate Voidweaver\r\n\r\nvar LeftReequip\r\nvar RightReequip\r\n\r\nfunc SetReequips()\r\n  ?item.left\r\n    LeftReequip = item.left\r\n  :\r\n    LeftReequip = 0\r\n\r\n  ?item.right\r\n    RightReequip = item.right\r\n  :\r\n    RightReequip = 0\r\n\r\nfunc Reequip()\r\n  ?LeftReequip\r\n    equipL @LeftReequip@\r\n  ?RightReequip\r\n    equip @RightReequip@\r\n\r\nfunc MainTab()\r\n  SelectedTab = 0\r\n  WispInit = true\r\n  CA_BasePanel.Recycle()\r\n  CA_StartUp()\r\n\r\nfunc WandTab()\r\n  SelectedTab = 1\r\n  WispInit = true\r\n  CA_BasePanel.Recycle()\r\n  CA_StartUp()\r\n\r\nfunc StaffTab()\r\n  SelectedTab = 2\r\n  WispInit = true\r\n  CA_BasePanel.Recycle()\r\n  CA_StartUp()\r\n\r\nfunc ScriptToggle()\r\n  ?ToggleEnabled\r\n    InterruptProtocol = DisabledProtocol\r\n    ScriptToggleText.text = \"Script: OFF\"\r\n  :\r\n    InterruptProtocol = EnabledProtocol\r\n    ScriptToggleText.text = \"Script: ON\"\r\n  ToggleEnabled = !ToggleEnabled\r\n\r\nfunc MinimiseRight()\r\n  MinimiseToggle = !MinimiseToggle\r\n  ?MinimiseToggle\r\n    MinimiseButton.text = \"[«\"\r\n    ShiftX = screen.w + 14\r\n  :\r\n    MinimiseButton.text = \"[»\"\r\n    ShiftX = screen.w - 1 + MobileHotbarOffset\r\nfunc MinimiseUp()\r\n  MinimiseToggle = !MinimiseToggle\r\n  ?MinimiseToggle\r\n    MinimiseButton.text = \"[▼]\"\r\n    MinimiseButton.y = 11\r\n    ShiftY = -10\r\n  :\r\n    MinimiseButton.text = \"[▲]\"\r\n    MinimiseButton.y = 10\r\n    ShiftY = 1\r\n\r\nfunc UIButton(_UI,X,Y,_Func)\r\n  _UI.x = X\r\n  _UI.y = Y\r\n  _UI.w = 13\r\n  _UI.h = 1\r\n  _UI.text = \"\"\r\n  _UI.style = StyleInvisible\r\n  _UI.dock = top_left\r\n  _UI.anchor = top_left\r\n  _UI.SetPressed(_Func)\r\n  CA_BasePanel.Add(_UI)\r\n  return _UI\r\n\r\nfunc UIText(_UI,X,Y)\r\n  _UI.x = X\r\n  _UI.y = Y\r\n  _UI.w = 18\r\n  _UI.h = 1\r\n  _UI.dock = top_left\r\n  _UI.anchor = top_left\r\n  CA_BasePanel.Add(_UI)\r\n  return _UI\r\n\r\nfunc UICanvas(_UI,Y)\r\n  _UI.x = 1\r\n  _UI.y = Y\r\n  _UI.w = 13\r\n  _UI.h = 1\r\n  _UI.dock = top_left\r\n  _UI.anchor = top_left\r\n  _UI.blend = add\r\n  CA_BasePanel.Add(_UI)\r\n  return _UI\r\n\r\nfunc CA_StartUp()\r\n  CAinit = false\r\n  CA_BasePanel = ui.AddPanel()\r\n  CA_BasePanel.dock = top_left\r\n  CA_BasePanel.anchor = top_right\r\n  CA_BasePanel.x = ShiftX //screen.w - 1\r\n  CA_BasePanel.y = 1\r\n  CA_BasePanel.w = 15\r\n  CA_BasePanel.h = 10\r\n\r\n  ScriptToggleText   = UIText( ui.AddText(\"Script: ON\"), 3,0)\r\n  ScriptToggleButton = UIButton( ui.AddButton(), 1,0,ScriptToggle)\r\n\r\n  ?SelectedTab = 0\r\n    BashText = UIText( ui.AddText(), 1,1)\r\n    BashButton = UIButton( ui.AddButton(), 1,1,Bash)\r\n    BashCanvas = UICanvas( ui.AddCanvas(), 1)\r\n\r\n    DashText = UIText( ui.AddText(), 1,2)\r\n    DashButton = UIButton( ui.AddButton(), 1,2,Dash)\r\n    DashCanvas = UICanvas( ui.AddCanvas(), 2)\r\n\r\n    QstaffText = UIText( ui.AddText(), 1,3)\r\n    QstaffButton = UIButton( ui.AddButton(), 1,3,Qstaff)\r\n    QstaffCanvas = UICanvas( ui.AddCanvas(), 3)\r\n\r\n    MindText = UIText( ui.AddText(), 1,4)\r\n    MindButton = UIButton( ui.AddButton(), 1,4,Mind)\r\n    MindCanvas = UICanvas( ui.AddCanvas(), 4)\r\n\r\n    HammerText = UIText( ui.AddText(), 1,5)\r\n    HammerButton = UIButton( ui.AddButton(), 1,5,Hamm)\r\n    HammerCanvas = UICanvas( ui.AddCanvas(), 5)\r\n\r\n    BardText = UIText( ui.AddText(), 1,6)\r\n    BardButton = UIButton( ui.AddButton(), 1,6,Bard)\r\n    BardCanvas = UICanvas( ui.AddCanvas(), 6)\r\n\r\n    BladeText = UIText( ui.AddText(), 1,7)\r\n    BladeButton = UIButton( ui.AddButton(), 1,7,Blade)\r\n    BladeCanvas = UICanvas( ui.AddCanvas(), 7)\r\n\r\n    MaskText = UIText( ui.AddText(), 1,8)\r\n    MaskButton = UIButton( ui.AddButton(), 1,8,Mask)\r\n    MaskCanvas = UICanvas( ui.AddCanvas(), 8)\r\n\r\n  :?SelectedTab = 1\r\n    ResetText = UIText( ui.AddText(), 0,1)\r\n    ResetCanvas = UICanvas( ui.AddCanvas(), 1)\r\n    ResetButton = UIButton( ui.AddButton(), 1,1,Reset)\r\n\r\n    PlagueText = UIText( ui.AddText(), 0,2)\r\n    PlagueCanvas = UICanvas( ui.AddCanvas(), 2)\r\n    PlagueButton = UIButton( ui.AddButton(), 1,2,Plague)\r\n\r\n    CalamityText = UIText( ui.AddText(), 0,3)\r\n    CalamityCanvas = UICanvas( ui.AddCanvas(), 3)\r\n    CalamityButton = UIButton( ui.AddButton(), 1,3,Calamity)\r\n\r\n    ExploText = UIText( ui.AddText(), 0,4)\r\n    ExploCanvas = UICanvas( ui.AddCanvas(), 4)\r\n    ExploButton = UIButton( ui.AddButton(), 1,4,Explode)\r\n\r\n    FrostText = UIText( ui.AddText(), 0,5)\r\n    FrostCanvas = UICanvas( ui.AddCanvas(), 5)\r\n    FrostButton = UIButton( ui.AddButton(), 1,5,Frost)\r\n\r\n    GravityText = UIText( ui.AddText(), 0,6)\r\n    GravityCanvas = UICanvas( ui.AddCanvas(), 6)\r\n    GravityButton = UIButton( ui.AddButton(), 1,6,Gravity)\r\n  :\r\n    PreventText = UIText( ui.AddText(), 0,1)\r\n    PreventCanvas = UICanvas( ui.AddCanvas(), 1)\r\n    PreventButton = UIButton( ui.AddButton(), 1,1,Prevention)\r\n\r\n    BerserkText = UIText( ui.AddText(), 0,2)\r\n    BerserkCanvas = UICanvas( ui.AddCanvas(), 2)\r\n    BerserkButton = UIButton( ui.AddButton(), 1,2,Berserker)\r\n\r\n    GraspingText = UIText( ui.AddText(), 0,3)\r\n    GraspingCanvas = UICanvas( ui.AddCanvas(), 3)\r\n    GraspingButton = UIButton( ui.AddButton(), 1,3,Grasping)\r\n\r\n    InfernalText = UIText( ui.AddText(), 0,4)\r\n    InfernalCanvas = UICanvas( ui.AddCanvas(), 4)\r\n    InfernalButton = UIButton( ui.AddButton(), 1,4,Infernal)\r\n\r\n    EternityText = UIText( ui.AddText(), 0,5)\r\n    EternityCanvas = UICanvas( ui.AddCanvas(), 5)\r\n    EternityButton = UIButton( ui.AddButton(), 1,5,Eternity)\r\n\r\n    AcrobatText = UIText( ui.AddText(), 0,6)\r\n    AcrobatCanvas = UICanvas( ui.AddCanvas(), 6)\r\n    AcrobatButton = UIButton( ui.AddButton(), 1,6,Acrobatic)\r\n\r\n  MainTabButton = UIButton( ui.AddButton() , -2 , 1,MainTab)\r\n  MainTabButton.w = 3\r\n  MainTabButton.h = 3\r\n  MainTabButton.style = DeselectTab\r\n\r\n  WandTabButton = UIButton( ui.AddButton() , -2 , 4,WandTab)\r\n  WandTabButton.w = 3\r\n  WandTabButton.h = 3\r\n  WandTabButton.text = \"w\"\r\n  WandTabButton.style = DeselectTab\r\n\r\n  StaffTabButton = UIButton( ui.AddButton() , -2 , 7,StaffTab)\r\n  StaffTabButton.w = 3\r\n  StaffTabButton.h = 3\r\n  StaffTabButton.text = \"s\"\r\n  StaffTabButton.style = DeselectTab\r\n\r\n  TabList = [MainTabButton, WandTabButton, StaffTabButton]\r\n  TabList[SelectedTab].bcolor = #FFFFFF\r\n  TabList[SelectedTab].style = SelectTab\r\n\r\n  CindSumButton = UIButton( ui.AddButton(), 1,9,SummonCinder)\r\n  CindSumButton.w = 3\r\n  CindSumButton.text = \"φ\"\r\n  CindSumButton.style = 1\r\n  VoidSumButton = UIButton( ui.AddButton(), 11,9,SummonWeaver)\r\n  VoidSumButton.w = 3\r\n  VoidSumButton.text = \"*\"\r\n  VoidSumButton.style = 1\r\n\r\n  ?sys.isPC & false\r\n    MinimiseButton = UIButton( ui.AddButton(), -1,4,MinimiseRight)\r\n    MinimiseButton.text = \"[»\"\r\n    MinimiseButton.w = 2\r\n    MinimiseButton.h = 3\r\n  :\r\n    MinimiseButton = UIButton( ui.AddButton(), 6,10,MinimiseUp)\r\n    MinimiseButton.text = \"[▲]\"\r\n    MinimiseButton.w = 3\r\n    MinimiseButton.h = 1\r\n\r\nfunc PercentCD(CD_Current,Max_CD)\r\n  return math.Min( (100* (Max_CD - CD_Current) ) / Max_CD,100)\r\n\r\nvar QstaffMaxDuration = 0\r\nfunc CheckQstaffMaxDuration()\r\n  ?QstaffMaxDuration = 0\r\n    var QsCD = GetCD(\"quarterstaff\")\r\n    ?QsCD > 0\r\n      QstaffMaxDuration = QsCD + 1\r\nfunc ReturnQstaffMaxDuration()\r\n  ?QstaffMaxDuration\r\n    return QstaffMaxDuration\r\n  return 195\r\n\r\nvar MaskMaxDuration = 0\r\nfunc CheckMaskMaxDuration()\r\n  ?MaskMaxDuration = 0\r\n    var MaskCD = GetCD(\"mask\")\r\n    ?MaskCD > 0\r\n      MaskMaxDuration = MaskCD + 1\r\nfunc ReturnMaskMaxDuration()\r\n  ?MaskMaxDuration\r\n    return MaskMaxDuration\r\n  return 2400\r\n\r\n\r\nfunc Update_CD_Bar(CA_Text, CA_Canvas, CD_Current, Max_CD, String)\r\n  var Percent = PercentCD(CD_Current, Max_CD)\r\n  ?Percent < 10\r\n    var Space = \"   \"\r\n  :?Percent < 100\r\n    var Space = \"  \"\r\n  :\r\n    var Space = \" \"\r\n\r\n  CA_Text.text = \"#\" + Percent + \"%\" + Space + String\r\n\r\n  var R = math.RoundToInt((100 - Percent) * 2.56)\r\n  var G = math.RoundToInt(Percent * 1.28)\r\n  CA_Canvas.SetBG(color.FromRGB(R,G,0))\r\n\r\n\r\nfunc WispSet()\r\n  WispText = UIText( ui.AddText(), 1,9)\r\n  WispCanvas = UICanvas( ui.AddCanvas(), 9)\r\n  WispButton = UIButton( ui.AddButton(), 1,9,WispActivate)\r\n  CA_BasePanel.h++\r\n  CindSumButton.y++\r\n  VoidSumButton.y++\r\n  WispInit = false\r\n\r\nfunc WispReset()\r\n  WispText.Recycle()\r\n  WispCanvas.Recycle()\r\n  WispButton.Recycle()\r\n  CA_BasePanel.h = 10\r\n  CindSumButton.y = 9\r\n  VoidSumButton.y = 9\r\n  WispInit = true\r\n\r\nfunc Updates()\r\n  ?SelectedTab = 0\r\n    Update_CD_Bar(BashText, BashCanvas, GetCD(\"bash\"), 270, \"Bash\")\r\n    Update_CD_Bar(DashText, DashCanvas, GetCD(\"dash\"), 45, \"Dash\")\r\n    Update_CD_Bar(QstaffText, QstaffCanvas, GetCD(\"quarterstaff\"), ReturnQstaffMaxDuration(), \"Qstaff\")\r\n    Update_CD_Bar(MindText, MindCanvas, GetCD(\"mind\"), 360, \"Mind\")\r\n    Update_CD_Bar(HammerText, HammerCanvas, GetCD(\"heavy_hammer\"), 660, \"Hammer\")\r\n    Update_CD_Bar(BardText, BardCanvas, GetCD(\"bardiche\"), 900, \"Bard\")\r\n    Update_CD_Bar(BladeText, BladeCanvas, GetCD(\"blade\"), 2400, \"Blade\")\r\n    Update_CD_Bar(MaskText, MaskCanvas, GetCD(\"mask\"), ReturnMaskMaxDuration(), \"Mask\")\r\n  :?SelectedTab = 1\r\n    Update_CD_Bar(ResetText, ResetCanvas, GetCD(\"wand_vigor\"), 900, \"❤ Reset\")\r\n    Update_CD_Bar(PlagueText, PlagueCanvas, GetCD(\"wand_poison\"), 900, \"∞ Plague\")\r\n    Update_CD_Bar(CalamityText, CalamityCanvas, GetCD(\"wand_aether\"), 900, \"* Calmty\")\r\n    Update_CD_Bar(ExploText, ExploCanvas, GetCD(\"wand_fire\"), 900, \"φ Explod\")\r\n    Update_CD_Bar(FrostText, FrostCanvas, GetCD(\"wand_ice\"), 900, \"❄ Frost\")\r\n    Update_CD_Bar(GravityText, GravityCanvas, GetCD(\"wand_stone\"), 900, \"o Gravty\")\r\n  :\r\n    Update_CD_Bar(PreventText, PreventCanvas, GetCD(\"staff_vigor\"), 900, \"❤ Prevnt\") //variable cd\r\n    Update_CD_Bar(BerserkText, BerserkCanvas, GetCD(\"staff_poison\"), 900, \"∞ Bersrk\")\r\n    Update_CD_Bar(GraspingText, GraspingCanvas, GetCD(\"staff_aether\"), 900, \"* Grasp\")\r\n    Update_CD_Bar(InfernalText, InfernalCanvas, GetCD(\"staff_fire\"), 900, \"φ Infern\")\r\n    Update_CD_Bar(EternityText, EternityCanvas, GetCD(\"staff_ice\"), 900, \"❄ Etrnty\") //variable cd\r\n    Update_CD_Bar(AcrobatText, AcrobatCanvas, GetCD(\"staff_stone\"), 900, \"o Acrbat\")  //variable cd\r\n\r\n\r\n  ?summon.GetName() = \"Cinderwisp\"\r\n    ?WispInit\r\n      WispSet()\r\n    Update_CD_Bar(WispText, WispCanvas, GetCD(\"cinderwisp\"), 2700, \"Cinder\")\r\n  :?summon.GetName() = \"Voidweaver\"\r\n    ?WispInit\r\n      WispSet()\r\n    Update_CD_Bar(WispText, WispCanvas, GetCD(\"voidweaver\"), 2700, \"Void\")\r\n  :?!WispInit\r\n    WispReset()\r\n\r\n\r\nvar SummonTarget = \"\"\r\nvar SavedTime = totaltime\r\n\r\nfunc ResetProtocol()\r\n  ?ToggleEnabled\r\n    InterruptProtocol = EnabledProtocol\r\n  :\r\n    InterruptProtocol = DisabledProtocol\r\n  ActivationTime = -1\r\n\r\nfunc SuperAttackRightProtocol()\r\n  ?item.right.state ! 2 & ActivationTime > 0\r\n    Reequip()\r\n    ResetProtocol()\r\n    return true\r\n  ActivationTime++\r\n  return false\r\n  \r\nfunc SuperAttackLeftProtocol()\r\n  ?item.left.state ! 2 & ActivationTime > 0\r\n    Reequip()\r\n    ResetProtocol()\r\n    return true\r\n  ActivationTime++\r\n  return false\r\n\r\nfunc OneTickProtocol()\r\n  ?ActivationTime > 0\r\n    Reequip()\r\n    ResetProtocol()\r\n    return true\r\n  ActivationTime++\r\n  return false\r\n\r\nfunc BladeProtocol()\r\n  BladeDelay --\r\n  ?BladeDelay = 0\r\n    equip blade\r\n    activate R\r\n    screen.ResetOffset()\r\n    SetReequips()\r\n    InterruptProtocol = OneTickProtocol\r\n    ActivationTime = 1\r\n\r\nfunc EnabledProtocol()\r\n  return true\r\nfunc DisabledProtocol()\r\n  return false\r\n\r\nvar ToggleEnabled = true\r\nvar InterruptProtocol = EnabledProtocol\r\n\r\n?loc.begin\r\n  InterruptProtocol = EnabledProtocol\r\n\r\nfunc CheckMinimised()\r\n  ?ShiftX ! CA_BasePanel.x\r\n    ?ShiftX < CA_BasePanel.x\r\n      CA_BasePanel.x --\r\n    :\r\n      CA_BasePanel.x ++\r\n  :?ShiftY ! CA_BasePanel.y\r\n    ?ShiftY < CA_BasePanel.y\r\n      CA_BasePanel.y --\r\n    :\r\n      CA_BasePanel.y ++\r\n\r\nfunc Display(InitTime)\r\n  ?DisplayOn\r\n    ?CAinit | totaltime=InitTime\r\n      CA_StartUp()\r\n    CheckMinimised()\r\n    CheckQstaffMaxDuration()\r\n    CheckMaskMaxDuration()\r\n    ?time % UpdateRate = 0 & !MinimiseToggle\r\n      Updates()\r\n\r\nfunc Run()\r\n  Display(1)\r\n  ?InterruptProtocol()\r\n    return true\r\n  return false\r\n\r\nfunc RunNoDisplay()\r\n  ?InterruptProtocol()\r\n    return true\r\n  return false\r\n\r\n\r\n\r\n////This segment will only get run if the player imports the script directly without assigning it a variable.\r\n\r\n?totaltime > 1\r\n  Display(2)\r\n  InterruptProtocol()\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/damageFlash.txt" - Parse error: Failed to parse completely. Remaining: "= \"FF6565\"\r\n//flashes this colour on armour hit\r\nvar colFlashArm = \"206565\"\r\n//ticks for border to remain for\r\nvar flashLength = 5\r\n//disable the flash (for when you just want the hooks the script provides)\r\nvar disableFlash = false\r\n\r\n/* ===================\r\n    End Customisation\r\n   =================== */\r\n\r\n/* =========================\r\n    Hooks For Other Scripts\r\n   ========================= */\r\n\r\n//The following variables can be read by other scripts to learn what the foe was doing when you were hit.\r\n//Note - if there are multiple enemies that could have hit you, state/time/dist may be inaccurate\r\nvar hitState = -1 //state the foe was in when you were hit\r\nvar hitTime = -1 //frame the foe was in when you were hit for HP\r\nvar hitTimeA = -1 //frame the foe was in when you were hit for ARMOUR\r\nvar hitHP = 0 //HP damage dealt on the last hit\r\nvar hitArm = 0 //ARMOUR damage dealt on the last hit\r\nvar hitDist = 0 //distance the foe hit you from\r\n\r\n/* ===========\r\n    End Hooks\r\n   =========== */\r\n\r\n//state tracking, dont touch these\r\nvar prevHP = hp\r\nvar prevMaxHP = maxhp\r\nvar prevArmour = -1\r\nvar prevArmourF = -1\r\nvar hitTick = -1000\r\nvar hitTickA = -1000\r\n\r\nfunc Main()\r\n\t? loc.begin | loc.loop\r\n\t\thitState = -1\r\n\t\thitTime = -1\r\n\t\thitTick = -1000\r\n\t\thitTickA = -1000\r\n\t\thitTimeA = -1\r\n\t\thitHP = 0\r\n\t\thitArm = 0\r\n\t\thitDist = 0\r\n\t\tprevArmour = -1\r\n\t\tprevArmourF = -1\r\n\t\t\r\n\t//max health has changed\r\n\t? maxhp ! prevMaxHP\r\n\t\t//scale the prev hp\r\n\t\tprevHP = prevHP * maxhp / prevMaxHP\r\n\t? hp < prevHP\r\n\t\t//we have been hit\r\n\t\thitState = foe.state\r\n\t\thitTime = foe.time\r\n\t\thitTick = totaltime\r\n\t\thitHP = prevHP - hp\r\n\t\thitDist = foe.distance\r\n\t\r\n\tvar arm = armor\r\n\tvar armf = armor.f\r\n\t//account for negative shields\r\n\t? armf < 0\r\n\t\tarm = -1\r\n\t\tarmf = 1+armf\r\n\t? arm < prevArmour\r\n\t\t? armf ! 9 | prevArmourF ! 0 | arm+1 ! prevArmour\r\n\t\t\t//non natural armour decay\r\n\t\t\thitState = foe.state\r\n\t\t\thitTimeA = foe.time\r\n\t\t\thitTickA = totaltime\r\n\t\t\thitArm = prevArmour - arm\r\n\t\t\thitDist = foe.distance\r\n\t\r\n\t//reset prevs\r\n\tprevHP = hp\r\n\tprevMaxHP = maxhp\r\n\tprevArmour = arm\r\n\tprevArmourF = armf\r\n\t\r\n\t? !disableFlash\r\n\t\t? totaltime <= hitTick + flashLength - 1\r\n\t\t\tBorderFlash(colFlashHP)\r\n\t\t:? totaltime <= hitTickA + flashLength - 1\r\n\t\t\tBorderFlash(colFlashArm)\r\n\t\r\nfunc BorderFlash(col)\r\n\tdraw.Bg(0, 0, \"#\"+col, screen.w, 1) //top border\r\n\tdraw.Bg(screen.w-1, 0, \"#\"+col, 1, screen.h) //right border\r\n\tdraw.Bg(0, 0, \"#\"+col, 1, screen.h) //left border\r\n\tdraw.Bg(0, screen.h-1, \"#\"+col, screen.w, 1) //bottom border\r\n\t"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/FancyUI/colour.txt" - Parse error: Failed to parse completely. Remaining: "(r*d/255, g*d/255, b*d/255)\r\n\treturn c\r\n\t\r\n//colour = the colour to add\r\n//n = number of times to add the colour\r\nfunc Add(colour, n)\r\n\tvar c = new FancyUI/colour\r\n\tc.Init(r+colour.r*n, g+colour.g*n, b+colour.b*n)\r\n\treturn c\r\n\t\r\n//do this before using in a print statement\r\nfunc ToString()\r\n\treturn Print.IntToHex(r, 2) + Print.IntToHex(g, 2) + Print.IntToHex(b, 2)"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/FancyUI/print.txt" - Parse error: Failed to parse completely. Remaining: "(xx-string.Size(str), yy, col, str)\r\n\t\r\n//prints with x,y as the center point (horizontal)\r\nfunc PrintM(xx, yy, col, str)\r\n\tvar len = string.Size(str)\r\n\tPrint(xx-(len/2-((len+1)%2)), yy, col, str)\r\n\r\n//prints a rectangle on the background with the given colour\r\nfunc BG(xx, yy, w, h, col)\r\n\tdraw.Bg(xx,yy,\"#\"+col,w,h)\r\n\t\r\n//d = the number to convert\r\n//n = the number of hex digits to return (2 for specifying colours)\r\nfunc IntToHex(d, n)\r\n\tvar hex = \"\"\r\n\tvar c = 0\r\n\tfor i = 1..n\r\n\t\tc = d%16\r\n\t\t? c >= 0 & c <= 9\r\n\t\t\thex = c + hex\r\n\t\t:? c = 10\r\n\t\t\thex = \"A\" + hex\r\n\t\t:? c = 11\r\n\t\t\thex = \"B\" + hex\r\n\t\t:? c = 12\r\n\t\t\thex = \"C\" + hex\r\n\t\t:? c = 13\r\n\t\t\thex = \"D\" + hex\r\n\t\t:? c = 14\r\n\t\t\thex = \"E\" + hex\r\n\t\t:? c = 15\r\n\t\t\thex = \"F\" + hex\r\n\t\td = d/16\r\n\treturn hex"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/FancyUI/fancyui.txt" - Parse error: Failed to parse completely. Remaining: "= \"rainFF\" //currently overwritten by slow rainbow\r\n//hp bar properties (relative to top-left of frame)\r\nvar Phpx = 1 //x offset\r\nvar Phpy = 4 //y offset\r\nvar Phpw = 40 //width\r\nvar Phph = 1 //height\r\nvar Phpd = false //direction to print the bar in (false = left->right, true = right->left)\r\n//armour bar properties (relative to top-left of frame)\r\nvar Parmx = 1\r\nvar Parmy = 2\r\nvar Parmw = 30\r\nvar Parmh = 1\r\nvar Parmd = false\r\n//bar label colour (the hp and armour labels and numerical values printed on the bar)\r\nvar colLabelP = \"FFFFFF\"\r\n//player name colour\r\nvar colNameP = \"888888\"\r\n//player name location (the midpoint, relative to the top-left of frame)\r\nvar Pnamex = 15\r\nvar Pnamey = 0\r\n\r\n/* ===========================\r\n\tEnemy Frame Customisation\r\n   =========================== */\r\n//the enemy frame design\r\nvar EnemyBarsFrame = ascii\r\n╔════════════════════════════════════════╗\r\n║                                        ║\r\n╚═════════╦══════════════════════════════╣\r\n##########║                              ║\r\n##########╠══════════════════════════════╣\r\n##########╚══════════════════════════════╝\r\nasciiend\r\n//enemy frame colour\r\nvar colFrameEnemy = \"rainFF\" //currently overwritten by slow rainbow\r\n//hp bar properties (relative to top-left of frame)\r\nvar Ehpx = 1\r\nvar Ehpy = 1\r\nvar Ehpw = 40\r\nvar Ehph = 1\r\nvar Ehpd = true\r\n//armour bar properties (relative to top-left of frame)\r\nvar Earmx = 11\r\nvar Earmy = 3\r\nvar Earmw = 30\r\nvar Earmh = 1\r\nvar Earmd = true\r\n//bar label colour (the hp and armour labels and numerical values printed on the bar)\r\nvar colLabelE = \"FFFFFF\"\r\n//enamy name colour\r\nvar colNameE = \"888888\"\r\n//enamy name location (the midpoint, relative to the top-left of frame)\r\nvar Enamex = 25\r\nvar Enamey = 5\r\n\r\n/* ==========================\r\n\tBar Colour Customisation\r\n   ========================== */\r\n//colour of the hp bars\r\nvar colHP = new FancyUI/colour\r\ncolHP.Init(255, 0, 0) //RGB\r\n//base colour of the armour bars\r\nvar colShield = new FancyUI/colour\r\ncolShield.Init(63, 63, 63)\r\n//the blending colour used for 'overshields'. This colour is added to the base colour each time the armour bar is exceeded.\r\nvar colOverShield = new FancyUI/colour\r\ncolOverShield.Init(0, 40, 40)\r\n//the colour used for negative armour\r\nvar colUnderShield = new FancyUI/colour\r\ncolUnderShield.Init(255, 127, 0)\r\n\r\n/* ==============================\r\n\tCooldown Frame Customisation\r\n   ============================== */\r\n//cooldown frrame design\r\nvar CooldownFrame = ascii\r\n╔═══════════╦═══════════╗\r\n║###########║###########║\r\n║###########║###########║\r\n║###########║###########║\r\n╚═══════════╩═══════════╝\r\n######[###########]######\r\nasciiend\r\n//frame colour\r\nvar colCoolFrame = \"rainFF\" //currently overwritten by slow rainbow\r\n//cooldown background design\r\nvar CooldownBackground = ascii\r\n#########################\r\n# BARD:0000 # DASH:0000 #\r\n# BLDE:0000 # BASH:0000 #\r\n# DODG:0000 # STFF:0000 #\r\n#########################\r\n#########################\r\nasciiend\r\n//background colour\r\nvar colCoolBack = \"202020\"\r\n//cooldown title design\r\nvar CooldownTitle = ascii\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n####### COOLDOWNS #######\r\nasciiend\r\n//title colour\r\nvar colCoolTitle = \"808080\"\r\n//text colour for equipment on cooldown\r\nvar colCoolText = \"FFFFFF\"\r\n//text colour for equipment ready\r\nvar colCoolReady = \"rainFF\"\r\n\r\n//how far to move per column\r\nvar coolxOff = 12\r\n//how far to move per row\r\nvar coolyOff = 1\r\n//number of rows to use when printing out cooldowns. Anything after the final row will be printed on a new column\r\nvar coolRows = 3\r\n//dont change the next 3\r\nvar equipmentNames = [\"bardiche\",\"blade\",\"mind\",\"dash\",\"bash\",\"quarterstaff\"]\r\nvar equipmentNamesShort = [\"BARD\", \"BLDE\", \"DODG\", \"DASH\", \"BASH\", \"STFF\"]\r\nvar equipmentNum = 6\r\n\r\n/* ==========================\r\n\tTime Frame Customisation\r\n   ========================== */\r\n//cooldown frrame design\r\nvar TimeFrame = ascii\r\n╔════════════╗\r\n║############║\r\n║############║\r\n║############║\r\n║############║\r\n║############║\r\n║############║\r\n╚╦══════════╦╝\r\n#║##########║#\r\n#╚══════════╝#\r\n###[######]###\r\nasciiend\r\n//frame colour\r\nvar colTimeFrame = \"rainFF\" //currently overwritten by slow rainbow\r\n//cooldown background design\r\nvar TimeBackground = ascii\r\n##############\r\n# Tcur:00000 #\r\n#    00m 00s #\r\n# Tbst:00000 #\r\n#    00m 00s #\r\n# Tavg:00000 #\r\n#    00m 00s #\r\n##############\r\n## 00:00:00 ##\r\n##############\r\n##############\r\nasciiend\r\n//background colour\r\nvar colTimeBack = \"202020\"\r\n//cooldown title design\r\nvar TimeTitle = ascii\r\n##############\r\n##############\r\n##############\r\n##############\r\n##############\r\n##############\r\n##############\r\n##############\r\n##############\r\n##############\r\n#####TIME#####\r\nasciiend\r\n//title colour\r\nvar colTimeTitle = \"808080\"\r\n//text colour for times\r\nvar colTimeText = \"FFFFFF\"\r\n\r\n\r\n/* =================\r\n\tExtra Variables\r\n   ================= */\r\n//player armour per overshield\r\nvar shieldMaxPlayer = 3 //for best results set this to about 1/4 of the max armour you expect to have\r\n\r\nvar shieldMaxEnemy = 1000 //leave this one\r\n\r\n//slow rainbow\r\nvar slowRainbow = new FancyUI/colour\r\nslowRainbow.Init(255, 0, 0) //RGB\r\nvar colSlowRainbow = slowRainbow.ToString()\r\nvar slowRainbowState = 0 //0=+r, 1=+g, 2=+b\r\n\r\n/* ====================\r\n\tButton Setup Stuff\r\n   ==================== */\r\nvar btnHeight = 3\r\nvar btnWidth = 7\r\nvar prevLoc = loc.id\r\n\r\n//add new buton bariables here\r\nvar bUI\r\nvar bLeave\r\nvar bPause\r\nvar bMenu\r\nvar bCooldown\r\nvar bTime\r\n\r\n//button state tracking here\r\nvar enableTime = storage.Get(\"enableTime\", true)\r\nvar enableCooldown = storage.Get(\"enableCooldown\", true)\r\nvar enableUI = storage.Get(\"enableUI\", true)\r\nvar showMenu = false\r\nvar menuTick = 0\r\n\r\n//setting up of button properties is below in \"Button Property Setup\"\r\n\r\n/* ===================================\r\n\tUI Element Position Customisation\r\n   =================================== */\r\nfunc Main()\r\n\t//enemy armour per overshield (the default formula helps to scale based on enemy hp)\r\n\tshieldMaxEnemy = math.RoundToInt(math.Sqrt(foe.maxhp*3/4))*8\r\n\r\n\t? enableUI\r\n\t\tdisable hud\r\n\t\t//xpos, ypos\r\n\t\tPlayerBars(0, screen.h-6) //change player ui position here\r\n\t\tEnemyBars(screen.w-42,1) //change enemy ui position here\r\n\t\t? enableCooldown\r\n\t\t\tCooldowns(15,1) //change cooldown ui position here\r\n\t\t? enableTime\r\n\t\t\tTimes(0,1) //change time ui position here\r\n\t:\r\n\t\tenable hud\r\n\t\r\n/* =======================\r\n\tSlow Rainbow Override\r\n   ======================= */\r\n\t//set all the frame colours to the slow rainbow (comment this out if you want to set solid colours using the options for each frame above)\r\n\tcolFramePlayer = colSlowRainbow\r\n\tcolFrameEnemy = colSlowRainbow\r\n\tcolCoolFrame = colSlowRainbow\r\n\tcolTimeFrame = colSlowRainbow\r\n\t\r\n/* =======================\r\n\tButton Property Setup\r\n   ======================= */\r\n\t//regenerate buttons each loop since they disappear\r\n\t//they are also removed when moving to a boss sub location\r\n\t? loc.loop | loc.begin | prevLoc ! loc.id\r\n\t\tprevLoc = loc.id\r\n\t\t//time enable button\r\n\t\tbTime = ui.AddButton()\r\n\t\tbTime.text = \"TIMES\"\r\n\t\tbTime.w = btnWidth\r\n\t\tbTime.h = btnHeight\r\n\t\tbTime.SetPressed(ButtonTime)\r\n\t\t//cooldown enable button\r\n\t\tbCooldown = ui.AddButton()\r\n\t\tbCooldown.text = \"COOLS\"\r\n\t\tbCooldown.w = btnWidth\r\n\t\tbCooldown.h = btnHeight\r\n\t\tbCooldown.SetPressed(ButtonCooldown)\r\n\t\t//UI enable button\r\n\t\tbUI = ui.AddButton()\r\n\t\tbUI.text = \"U.I\"\r\n\t\tbUI.w = btnWidth\r\n\t\tbUI.h = btnHeight\r\n\t\tbUI.SetPressed(ButtonUI)\r\n\t\t//Leave button\r\n\t\tbLeave = ui.AddButton()\r\n\t\tbLeave.text = \"LEAVE\"\r\n\t\tbLeave.w = btnWidth\r\n\t\tbLeave.h = btnHeight\r\n\t\tbLeave.SetPressed(ButtonLeave)\r\n\t\t//pause button\r\n\t\tbPause = ui.AddButton()\r\n\t\tbPause.text = \"PAUSE\"\r\n\t\tbPause.w = btnWidth\r\n\t\tbPause.h = btnHeight\r\n\t\tbPause.SetPressed(ButtonPause)\r\n\t\t//menu button\r\n\t\tbMenu = ui.AddButton()\r\n\t\tbMenu.text = \"≡≡≡\"\r\n\t\tbMenu.w = btnWidth\r\n\t\tbMenu.h = btnHeight\r\n\t\tbMenu.SetPressed(ButtonMenu)\r\n\t\tshowMenu = false\r\n\t\tmenuTick = 0\r\n\r\n/* =============================\r\n\tMenu Button Animation Stuff\r\n   ============================= */\r\n\t//mount buttons to right edge of screen\r\n\tbMenu.x = screen.w-bMenu.w\r\n\tbMenu.y = screen.h-bMenu.h\r\n\tbPause.x = screen.w-bMenu.w\r\n\tbLeave.x = screen.w-bMenu.w\r\n\tbUI.x = screen.w-bMenu.w\r\n\tbCooldown.x = screen.w-bMenu.w\r\n\tbTime.x = screen.w-bMenu.w\r\n\t//animation here\r\n\t? showMenu\r\n\t\t//when menu is opened, animate to location\r\n\t\tvar bpos = (totaltime - menuTick)/-1\r\n\t\tbPause.y = screen.h+math.Max(bpos,btnHeight*-2)\r\n\t\tbLeave.y = screen.h+math.Max(bpos,btnHeight*-3)\r\n\t\tbUI.y = screen.h+math.Max(bpos,btnHeight*-4)\r\n\t\tbCooldown.y = screen.h+math.Max(bpos,btnHeight*-5)\r\n\t\tbTime.y = screen.h+math.Max(bpos,btnHeight*-6)\r\n\t:\r\n\t\t//menu closed, move to offscreen\r\n\t\tbPause.y = screen.h\r\n\t\tbLeave.y = screen.h\r\n\t\tbUI.y = screen.h\r\n\t\tbCooldown.y = screen.h\r\n\t\tbTime.y = screen.h\r\n\t\r\n/* ===================\r\n\tEnd Customisation\r\n   =================== */\r\n\t\r\n\tdisable pause\r\n\tvar minutes = totalTime/30/60\r\n\tvar seconds = (totalTime/30)%60\r\n\t//Print.Print(0, 1, \"FF8800\", \"Time: \"+totalTime+\" (\"+minutes+\"m \"+seconds+\"s)\")\r\n\t\r\n\t//slow rainbow stuff\r\n\t? slowRainbow.r >= 255 | slowRainbow.g >= 255 | slowRainbow.b >= 255\r\n\t\tslowRainbowState = (slowRainbowState + 1) % 3\r\n\t\t\r\n\t? slowRainbowState = 0 //+r\r\n\t\tslowRainbow.r = math.min(255, slowRainbow.r+1)\r\n\t\tslowRainbow.g = math.max(0, slowRainbow.g-1)\r\n\t\tslowRainbow.b = math.max(0, slowRainbow.b-1)\r\n\t:? slowRainbowState = 1 //+g\r\n\t\tslowRainbow.r = math.max(0, slowRainbow.r-1)\r\n\t\tslowRainbow.g = math.min(255, slowRainbow.g+1)\r\n\t\tslowRainbow.b = math.max(0, slowRainbow.b-1)\r\n\t:? slowRainbowState = 2 //+b\r\n\t\tslowRainbow.r = math.max(0, slowRainbow.r-1)\r\n\t\tslowRainbow.g = math.max(0, slowRainbow.g-1)\r\n\t\tslowRainbow.b = math.min(255, slowRainbow.b+1)\r\n\tcolSlowRainbow = slowRainbow.ToString()\r\n\t\r\n\r\n/* =================\r\n\tButton Handlers\r\n   ================= */\r\nfunc ButtonMenu()\r\n\t? showMenu\r\n\t\tshowMenu = false\r\n\t:\r\n\t\tshowMenu = true\r\n\t\tmenuTick = totaltime\r\n\t\r\nfunc ButtonPause()\r\n\tButtonMenu()\r\n\tloc.Pause()\r\n\t\r\nfunc ButtonLeave()\r\n\tButtonMenu()\r\n\tloc.Leave()\r\n\t\r\nfunc ButtonUI()\r\n\tButtonMenu()\r\n\t? enableUI\r\n\t\tenableUI = false\r\n\t:\r\n\t\tenableUI = true\r\n\tstorage.Set(\"enableUI\", enableUI)\r\n\t\t\r\nfunc ButtonCooldown()\r\n\tButtonMenu()\r\n\t? enableCooldown\r\n\t\tenableCooldown = false\r\n\t:\r\n\t\tenableCooldown = true\r\n\tstorage.Set(\"enableCooldown\", enableCooldown)\r\n\t\t\r\nfunc ButtonTime()\r\n\tButtonMenu()\r\n\t? enableTime\r\n\t\tenableTime = false\r\n\t:\r\n\t\tenableTime = true\r\n\tstorage.Set(\"enableTime\", enableTime)\r\n\t\r\n//draw the cooldown pane\r\nfunc Cooldowns(xx,yy)\r\n\tPrint.Print(xx,yy,colCoolFrame,CooldownFrame)\r\n\tPrint.Print(xx,yy,colCoolBack,CooldownBackground)\r\n\tPrint.Print(xx,yy,colCoolTitle,CooldownTitle)\r\n\tvar c = -1\r\n\tfor i = 0..5\r\n\t\tc = item.GetCooldown(equipmentNames[i])\r\n\t\t? c = 0\r\n\t\t\t//ready\r\n\t\t\tPrint.Print(xx+coolxOff*(i/coolRows+1)-1-9,yy+i%coolRows+coolyOff,colCoolReady,equipmentNamesShort[i])\r\n\t\t\tPrint.PrintL(xx+coolxOff*(i/coolRows+1)-1,yy+i%coolRows+coolyOff,colCoolReady,\"0000\")\r\n\t\t:\r\n\t\t\tPrint.Print(xx+coolxOff*(i/coolRows+1)-1-9,yy+i%coolRows+coolyOff,colCoolText,equipmentNamesShort[i])\r\n\t\t\tPrint.PrintL(xx+coolxOff*(i/coolRows+1)-1,yy+i%coolRows+coolyOff,colCoolText,c+\"\")\r\n\t\r\n//draw the time pane\r\nfunc Times(xx,yy)\r\n\t//deco\r\n\tPrint.Print(xx,yy,colTimeFrame,TimeFrame)\r\n\tPrint.Print(xx,yy,colTimeBack,TimeBackground)\r\n\tPrint.Print(xx,yy,colTimeTitle,TimeTitle)\r\n\t\r\n\t//curr time\r\n\tPrint.Print(xx+2,yy+1,colTimeText,\"Tcur\")\r\n\tPrint.PrintL(xx+12,yy+1,colTimeText, totaltime+\"\")\r\n\tPrint.PrintL(xx+8,yy+2,colTimeTitle,(totaltime/30/30)+\"m\")\r\n\tPrint.PrintL(xx+12,yy+2,colTimeTitle,(totaltime/30%30)+\"s\")\r\n\t//best time\r\n\tPrint.Print(xx+2,yy+3,colTimeText,\"Tbst\")\r\n\tPrint.PrintL(xx+12,yy+3,colTimeText, loc.bestTime+\"\")\r\n\tPrint.PrintL(xx+8,yy+4,colTimeTitle,(loc.bestTime/30/30)+\"m\")\r\n\tPrint.PrintL(xx+12,yy+4,colTimeTitle,(loc.bestTime/30%30)+\"s\")\r\n\t//average time\r\n\tPrint.Print(xx+2,yy+5,colTimeText,\"Tavg\")\r\n\tPrint.PrintL(xx+12,yy+5,colTimeText, loc.averageTime+\"\")\r\n\tPrint.PrintL(xx+8,yy+6,colTimeTitle,(loc.averageTime/30/30)+\"m\")\r\n\tPrint.PrintL(xx+12,yy+6,colTimeTitle,(loc.averageTime/30%30)+\"s\")\r\n\t//system time\r\n\tPrint.PrintL(xx+5,yy+8,colTimeText,time.hour+\"\")\r\n\tPrint.PrintL(xx+8,yy+8,colTimeText,time.minute+\"\")\r\n\tPrint.PrintL(xx+11,yy+8,colTimeText,time.second+\"\")\r\n\t\r\n//Draw the player ui element\r\nfunc PlayerBars(xx,yy)\r\n\t//deco\r\n\tPrint.Print(xx, yy, colFramePlayer, PlayerBarsFrame)\r\n\tPrint.PrintM(xx+Pnamex, yy+Pnamey, colFramePlayer, \"[\"+StrRep(\" \", string.Size(player.name)+2)+\"]\")\r\n\tPrint.PrintM(xx+Pnamex, yy+Pnamey, colNameP, player.name)\r\n\r\n\t//the hp bar\r\n\tHPBar(xx+Phpx, yy+Phpy, Phpw, Phph, hp, maxhp, Phpd, colLabelP)\r\n\t? Phpd\r\n\t\tPrint.PrintL(xx+Phpx+Phpw, yy+Phpy+Phph/2, colLabelP, \"HP\")\r\n\t:\r\n\t\tPrint.Print(xx+Phpx, yy+Phpy+Phph/2, colLabelP, \"HP\")\r\n\t\r\n\t//the shield bar\r\n\tShieldBar(xx+Parmx, yy+Parmy, Parmw, Parmh, armor, armor.f, shieldMaxPlayer, Parmd, colLabelP)\r\n\t? Parmd\r\n\t\tPrint.PrintL(xx+Parmx+Parmw, yy+Parmy+Parmh/2, colLabelP, \"ARMOUR\")\r\n\t:\r\n\t\tPrint.Print(xx+Parmx, yy+Parmy+Parmh/2, colLabelP, \"ARMOUR\")\r\n\t\r\n//draw the enemy ui element\r\nfunc EnemyBars(xx,yy)\r\n\t//deco\r\n\tPrint.Print(xx, yy, colFrameEnemy, EnemyBarsFrame)\r\n\tvar n = \"No Foe\"\r\n\t? string.Size(foe.name) ! 0\r\n\t\tn = foe.name\r\n\tPrint.PrintM(xx+Enamex, yy+Enamey, colFrameEnemy, \"[\"+StrRep(\" \", string.Size(n)+2)+\"]\")\r\n\tPrint.PrintM(xx+Enamex, yy+Enamey, colNameE, n)\r\n\t\r\n\t//the hp bar\r\n\tHPBar(xx+Ehpx, yy+Ehpy, Ehpw, Ehph, foe.hp, foe.maxhp, Ehpd, colLabelE)\r\n\t? Ehpd\r\n\t\tPrint.PrintL(xx+Ehpx+Ehpw, yy+Ehpy+Ehph/2, colLabelE, \"HP\")\r\n\t:\r\n\t\tPrint.Print(xx+Ehpx, yy+Ehpy+Ehph/2, colLabelE, \"HP\")\r\n\t\r\n\t//the shield bar\r\n\tShieldBar(xx+Earmx, yy+Earmy, Earmw, Earmh, foe.armor, 0, shieldMaxEnemy, Earmd, colLabelE)\r\n\t? Earmd\r\n\t\tPrint.PrintL(xx+Earmx+Earmw, yy+Earmy+Earmh/2, colLabelE, \"ARMOUR\")\r\n\t:\r\n\t\tPrint.Print(xx+Earmx, yy+Earmy+Earmh/2, colLabelE, \"ARMOUR\")\r\n\t\r\n//simple hp bar\r\nfunc HPBar(xx, yy, w, h, curr, max, fromRight, colLab)\r\n\t//draw the bar\r\n\tDrawBar(xx, yy, w, h, curr, max, colHP, true, fromRight)\r\n\t\r\n\t//print the amount to the screen\r\n\tPrint.Print(xx+w/2, yy+h/2, colLab, \"/\")\r\n\tPrint.Print(xx+w/2+2, yy+h/2, colLab, max)\r\n\tPrint.PrintL(xx+w/2-1, yy+h/2, colLab, curr+\"\")\r\n\t\r\n//Shield bar which draws another layer each time max is exceeded\r\nfunc ShieldBar(xx, yy, w, h, curr, frac, max, fromRight, colLab)\r\n\t? max = 0\r\n\t\tmax = 1\r\n\t//draw the bar\r\n\t? frac >= 0 & curr >= 0\r\n\t\t//the amount of overshields\r\n\t\tvar over = (curr*10+frac)/(max*10)\r\n\t\tvar base = math.Max((curr*10+frac-(max*10))/(max*10),0)\r\n\t\tvar cOver = colShield.Add(colOverShield, over)\r\n\t\tvar cBase = colShield.Add(colOverShield, base)\r\n\t\t//draw base shield bar\r\n\t\tDrawBar(xx, yy, w, h, curr*10+frac, max*10, cBase, true, fromRight)\r\n\t\t//draw over shield bar\r\n\t\tDrawBar(xx, yy, w, h, (curr*10+frac)%(max*10), max*10, cOver, false, fromRight)\r\n\t:\r\n\t\tDrawBar(xx, yy, w, h, -frac-(curr*10), 10, colUnderShield, true, fromRight)\r\n\t\r\n\t//print the amount to the screen\r\n\t? frac >= 0 & curr >= 0\r\n\t\tPrint.PrintM(xx+w/2, yy+h/2, colLab, curr + \".\" + frac)\r\n\t:\t\r\n\t\tfrac = -frac\r\n\t\tcurr = -curr\r\n\t\tPrint.PrintM(xx+w/2, yy+h/2, colLab, \"-\"+curr+\".\"+frac)\r\n\r\n//xx, yy = top left\r\n//width, height = size of bar\r\n//curr = current value of bar to scale\r\n//max = maximum value of the bar (used to determine how full the bar is)\r\n//colour = a colour object with the draw colour\r\n//doPartial = whether the last box should be partially coloured based on the approximate bar length\r\n//fromRight = the bar draws left to right by default, this reverses that\r\nfunc DrawBar(xx, yy, width, height, curr, max, colour, doPartial, fromRight)\r\n\t? max = 0\r\n\t\tmax = 1\r\n\tvar factor = 100\r\n\t? width <= 0 | height <= 0\r\n\t\treturn\r\n\t\t\r\n\tvar bars = math.Clamp(factor*width*curr/max, 0, factor*width)\r\n\t? fromRight\r\n\t\tPrint.BG(xx+(width-bars/factor), yy, bars/factor, height, colour.ToString())\r\n\t:\r\n\t\tPrint.BG(xx, yy, bars/factor, height, colour.ToString())\r\n\t//draw.Bg(xx, yy, colour.ToString2(), bars/factor, 1)\r\n\t//calc the last bar\r\n\t? bars/factor < width & doPartial\r\n\t\tvar frac = bars % factor\r\n\t\tvar col = colour.Scale(frac*255/factor)\r\n\t\t? fromRight\r\n\t\t\tPrint.BG(xx+(width-bars/factor)-1, yy, 1, height, col.ToString())\r\n\t\t:\r\n\t\t\tPrint.BG(xx+bars/factor, yy, 1, height, col.ToString())\r\n\t\t\t\r\n//repeats str n times and returns it - useful for drawing bars\r\nfunc StrRep(str, n)\r\n\tvar s = \"\"\r\n\tfor i = 1..n\r\n\t\ts = s+str\r\n\treturn s"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/PlayerStateTracker.txt" - Parse error: Failed to parse completely. Remaining: "= []\r\nvar RStateList = []\r\nvar LStateListText\r\nvar RStateListText\r\nvar StateListBox\r\nvar DragButton\r\nvar ToggleDragging = false\r\nvar XSet = storage.Get(\"X\",58)\r\nvar YSet = storage.Get(\"Y\",1)\r\nvar StyleInvisible = ui.AddStyle(\"#########\")\r\nvar init = true\r\nvar Mobile = sys.isMobile\r\nvar Label\r\nvar WeaponsLegend\r\n\r\nvar RLastAttackTime = 0\r\nvar RLastAttackState = 0\r\nvar ColourList = [\r\n^\"[color=#FF0000]\", \r\n^\"[color=#00FF00]\", \r\n^\"[color=#0000FF]\", \r\n^\"[color=#FFFF00]\", \r\n^\"[color=#FF8000]\", \r\n^\"[color=#00FFFF]\", \r\n^\"[color=#FF0080]\", \r\n^\"[color=#800080]\",\r\n^\"[color=#8000FF]\",\r\n^\"[color=#FF80B8]\",\r\n^\"[color=#802000]\",\r\n^\"[color=#808000]\",\r\n^\"[color=#008080]\"] //13 colours\r\n\r\nvar WeaponsList = [\"\"]\r\nvar UsedWeaps = []\r\nvar WeaponsLegendClipPanel\r\n\r\n?totaltime = 1 | init\r\n  init = false\r\n\r\n  StateListBox = ui.AddPanel()\r\n  StateListBox.anchor = top_left\r\n  StateListBox.dock = top_left\r\n  StateListBox.w = 16\r\n  StateListBox.y = YSet\r\n  StateListBox.h = 2+MaxListLength\r\n  StateListBox.x = XSet\r\n\r\n  Label = ui.AddText(\"Player State Tracker\\n[color=#808080][L]######[R][/color]\")\r\n  Label.w = 20\r\n  Label.x = -10\r\n  Label.anchor = top_left\r\n  Label.align = center\r\n  Label.y = -2 - MaxListLength/2\r\n\r\n  WeaponsLegendClipPanel = ui.AddPanel()\r\n  WeaponsLegendClipPanel.clip = true\r\n  WeaponsLegendClipPanel.w = 14\r\n  WeaponsLegendClipPanel.h = MaxListLength + 2\r\n  WeaponsLegendClipPanel.style = StyleInvisible\r\n  WeaponsLegendClipPanel.x = -14\r\n  WeaponsLegendClipPanel.anchor = top_left\r\n  WeaponsLegendClipPanel.dock = top_left\r\n  WeaponsLegendClipPanel.y = 1\r\n\r\n  WeaponsLegend = ui.AddText()\r\n  WeaponsLegend.w = 99\r\n  WeaponsLegend.x = 0\r\n  WeaponsLegend.anchor = top_left\r\n  WeaponsLegend.dock = top_left\r\n  WeaponsLegend.align = left\r\n  WeaponsLegend.y = 0\r\n  WeaponsLegendClipPanel.Add(WeaponsLegend)\r\n\r\n  LStateListText = ui.AddText()\r\n  LStateListText.w = 99\r\n  LStateListText.x = -7\r\n  LStateListText.anchor = top_left\r\n  LStateListText.align = left\r\n  LStateListText.y =  - MaxListLength/2\r\n\r\n  RStateListText = ui.AddText()\r\n  RStateListText.w = 99\r\n  RStateListText.x = 2\r\n  RStateListText.anchor = top_left\r\n  RStateListText.align = left\r\n  RStateListText.y =  - MaxListLength/2\r\n\r\n  DragButton = ui.AddButton()\r\n  DragButton.x = -1\r\n  DragButton.w = 3\r\n  DragButton.h = 1\r\n  DragButton.anchor = top_left\r\n  DragButton.dock = top_left\r\n  DragButton.text = \"ʘ\"\r\n  DragButton.style = StyleInvisible\r\n  DragButton.SetDown(DragToggle)\r\n\r\n  StateListBox.Add(LStateListText)\r\n  StateListBox.Add(RStateListText)\r\n  StateListBox.Add(Label)\r\n  //StateListBox.Add(PauseButton)\r\n  StateListBox.Add(WeaponsLegendClipPanel)\r\n  StateListBox.Add(DragButton)\r\n\r\nfunc ClearStorage()\r\n  storage.Delete(\"X\")\r\n  storage.Delete(\"Y\")\r\n\r\nfunc DragToggle()\r\n  ToggleDragging = !ToggleDragging\r\n\r\n?ToggleDragging\r\n  XSet = math.Clamp(input.x, 0, screen.w)\r\n  YSet = math.Clamp(input.y, 1, screen.h-1)\r\n  StateListBox.x = XSet\r\n  StateListBox.y = YSet\r\n  ?key ! \"primary\"\r\n    ToggleDragging = false\r\n    storage.Set(\"X\",XSet)\r\n    storage.Set(\"Y\",YSet)\r\n\r\n\r\n\r\nvar TempText\r\nfunc UpdateText(TextUI, List)\r\n  TempText = \"\"\r\n  for i : List\r\n    ?i[2] = 0\r\n      TempText = TempText + i[4] + i[0] + \":\" +i[1] + \"[/color]\\n\"\r\n    :\r\n      TempText = TempText + i[4] + i[0] + \":\" +i[1] + \"(\" + (i[1]+i[2]) + \")\" +\"[/color]\\n\"\r\n  TextUI.text = TempText\r\n\r\nvar LastState\r\nfunc EvaluateLastRightTime()\r\n  RLastAttackTime = 0\r\n  LastState = RStateList[1][0]\r\n  for a = 1..RStateList.Count()-1\r\n    ?RStateList[a][0] > LastState\r\n      return\r\n    :\r\n      RLastAttackTime += math.Max(RStateList[a][1],1)\r\n      LastState = RStateList[a][0]\r\n\r\nfunc EvaluateLastLeftTime()\r\n  LLastAttackTime = 0\r\n  LastState = LStateList[1][0]\r\n  for a = 1..LStateList.Count()-1\r\n    ?LStateList[a][0] > LastState\r\n      return\r\n    :\r\n      LLastAttackTime += math.Max(LStateList[a][1],1)\r\n      LastState = LStateList[a][0]\r\n\r\n\r\nfunc CheckListMax(List)\r\n  ?List.Count() > MaxListLength\r\n    var Last = List.Count()-1\r\n    for a = Last-1..0\r\n      ?string.Equals(List[Last][3] , List[a][3])\r\n        List.RemoveAt(Last)\r\n        return\r\n    var Index = WeaponsList.IndexOf(List[Last][3])\r\n    ?Index > -1\r\n      WeaponsList[Index] = \"\"\r\n      UpdateWeaponLegend()\r\n    List.RemoveAt(Last)\r\n\r\n\r\nfunc UpdateWeaponLegend()\r\n  var EmptyString = \"\"\r\n  var Array\r\n  for a = 0..math.Min( WeaponsList.Count()-1, MaxListLength)\r\n    ?!string.Equals(WeaponsList[a], \"\")\r\n      Array = string.Split(WeaponsList[a])\r\n      EmptyString += ColourList[a%13] + \"ʘ \" + Array[0] + \" \" + Array[1] + \"[/color]\\n\"\r\n  WeaponsLegend.text = EmptyString\r\n\r\nfunc ListInsert(StateList, IS, IT, Offset_Time, Itm )\r\n  var Index = WeaponsList.IndexOf(Itm)\r\n  ?Index > -1\r\n    StateList.Insert(0,[IS ,IT , Offset_Time , Itm , ColourList[Index%13]])\r\n  :\r\n    Index = WeaponsList.IndexOf(\"\")\r\n    ?Index = -1\r\n      Index = WeaponsList.Count()\r\n      WeaponsList.Add(Itm)\r\n    :\r\n      WeaponsList[Index] = Itm\r\n    UpdateWeaponLegend()\r\n    StateList.Insert(0,[IS ,IT , Offset_Time , Itm , ColourList[Index%13]])\r\n\r\nfunc FirstListItem(List,Itm,IS,IT)\r\n  var Index = WeaponsList.IndexOf(Itm)\r\n  ?Index > -1\r\n    List.Add([ IS ,IT , 0 , Itm , ColourList[Index%13]])\r\n  :\r\n    Index = WeaponsList.IndexOf(\"\")\r\n    ?Index = -1\r\n      Index = WeaponsList.Count()\r\n      WeaponsList.Add(Itm)\r\n    :\r\n      WeaponsList[Index] = Itm\r\n    UpdateWeaponLegend()\r\n    List.Add([ IS , IT , 0 , Itm, ColourList[Index%13]])\r\n\r\n\r\n// [ State , time , offset_time , item , Index_Colour]\r\n// [   0   ,   1  ,       2     ,   3  ,      4      ]\r\n\r\nfunc CheckStates()\r\n  ?LStateList.Count()\r\n    ?item.left ! LStateList[0][3]\r\n      ListInsert(LStateList, item.left.state, item.left.time, 0, item.left )\r\n      CheckListMax(LStateList)\r\n      UpdateText(LStateListText , LStateList)\r\n    :?item.left.state ! LStateList[0][0]\r\n      ?item.left.time ! 0\r\n        ListInsert(LStateList, item.left.state, item.left.time, -item.left.time, item.left )\r\n      :\r\n        ListInsert(LStateList, item.left.state, item.left.time, 0, item.left )\r\n      CheckListMax(LStateList)\r\n      UpdateText(LStateListText , LStateList)\r\n    :?item.left.time ! LStateList[0][1]\r\n      ?item.left.time < LStateList[0][1]\r\n        LStateList[0].Emplace(2,LStateList[0][1] - LStateList[0][2])\r\n      LStateList[0].Emplace(1,item.left.time)\r\n      CheckListMax(LStateList)\r\n      UpdateText(LStateListText , LStateList)\r\n  :\r\n    FirstListItem(LStateList,item.left,item.left.state,item.left.time)\r\n    UpdateText(LStateListText , LStateList)\r\n\r\n  ?RStateList.Count()\r\n    ?item.right ! RStateList[0][3]\r\n      ListInsert(RStateList, item.right.state, item.right.time, 0, item.right )\r\n      CheckListMax(RStateList)\r\n      UpdateText(RStateListText , RStateList)\r\n    :?item.right.state ! RStateList[0][0]\r\n      ?item.right.time ! 0\r\n        ListInsert(RStateList, item.right.state, item.right.time, -item.right.time, item.right )\r\n\r\n      :\r\n        ListInsert(RStateList, item.right.state, item.right.time, 0, item.right )\r\n      CheckListMax(RStateList)\r\n      UpdateText(RStateListText , RStateList)\r\n    :?item.right.time ! RStateList[0][1]\r\n      RStateList[0].Emplace(1,item.right.time)\r\n      CheckListMax(RStateList)\r\n      UpdateText(RStateListText , RStateList)\r\n    ?false //item.right.state < RLastAttackState\r\n      EvaluateLastRightTime()\r\n      RLastAttackState = item.right.state\r\n  :\r\n    FirstListItem(RStateList, item.right, item.right.state, item.right.time)\r\n    UpdateText(RStateListText , RStateList)\r\n\r\n?StateListBox.h ! 2+MaxListLength\r\n  StateListBox.Recycle()\r\n  init = true\r\n\r\nCheckStates()\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/VisualStatusEffects.txt" - Parse error: Failed to parse completely. Remaining: "?foe.name = \"wasp_nest\" | foe.name = \"wasp\" | foe.name = \"Angry Shroom\" | foe = tree_boss | foe = dysangelos_perfected \r\n\tice_y = 4\r\n:?foe.name = \"Morel\" | foe.name = \"Enoki\" | foe = acronian_scout | foe = acronian_cultist\r\n\tice_y = 6\r\n:?foe.name = \"poena\" | foe.name = \"pallas\" | foe = yeti | foe = nagaraja\r\n\tice_y = 8\r\n:\r\n\tice_y = 2\r\n\r\n//Draw Debuffs for Enemies----------------------------------------------\r\n//'Frozen' Status\r\n?foe.debuffs.string = \"debuff_chill:1\" | foe.debuffs.string = \"debuff_chill:2\" | foe.debuffs.string = \"debuff_chill:3\"\r\n  >f0,@ice_y@,#888888,ascii\r\n###\r\n##/\"\\'/\\`\r\n./|..|: \\..\r\nasciiend\r\n\r\n//REALLY 'Frozen' Status\r\n?foe.debuffs.string = \"debuff_chill:4\" | foe.debuffs.string = \"debuff_chill:5\" | foe.debuffs.string = \"debuff_chill:6\"\r\n  >f0,@ice_y@,#888888,ascii\r\n###########/| \r\n###/|.####/ |\\\r\n##/ \\/'.`|. ' \\/',\r\n./|  |:  \\..  |\\ \\.\r\nasciiend\r\n\r\n//Animation for 'Poisoned' Status\r\n?foe.debuffs.string = \"debuff_damage\"\r\n  ?count <= 3\r\n    >f0,-2,#888888,ascii\r\nOo\r\n.\r\nasciiend\r\n  :?count <= 6\r\n    >f0,-2,#888888,ascii\r\n.O\r\no\r\nasciiend\r\n  :?count <= 9\r\n    >f0,-2,#888888,ascii\r\no.\r\nO\r\nasciiend\r\n\r\n//Animation for DOT 'On Fire' Status\r\n?foe.debuffs.string = \"debuff_dot\"\r\n  ?count <= 3\r\n    >f0,0,#888888,ascii\r\n#`,\r\n( `\r\nasciiend\r\n  :?count <= 6\r\n    >f0,0,#888888,ascii\r\n.'\r\n##)\r\nasciiend\r\n  :?count <= 9\r\n    >f0,0,#888888,ascii\r\n#'.\r\n( )\r\nasciiend\r\n\r\n//Animation for 'igniton' Status\r\n?foe.debuffs.string = \"ignition\"\r\n  ?count <= 3\r\n    >f0,4,#888888,ascii\r\n'`\r\n` \r\nasciiend\r\n  :?count <= 6\r\n    >f0,4,#888888,ascii\r\n'\r\n:\r\n#\r\nasciiend\r\n  :?count <= 9\r\n    >f0,4,#888888,ascii\r\n.\r\n`\r\n#\r\nasciiend\r\n\r\n//draw status effects for the stonehead-------------------------------------\r\n//'Frozen' Status\r\n?debuffs.string = \"debuff_chill\" | debuffs.string = \"debuff_yeti_chill\"\r\n  >h-4,2,#888888,ascii\r\n###\r\n##/\"\\'/\\`\r\n./|..|: \\..\r\nasciiend\r\n\r\n//Animation for 'Poisoned' Status\r\n?debuffs.string = \"debuff_damage\"\r\n  ?count <= 3\r\n    >h0,-2,#888888,ascii\r\nOo\r\n.\r\nasciiend\r\n  :?count <= 6\r\n    >h0,-2,#888888,ascii\r\n.O\r\no\r\nasciiend\r\n  :?count <= 9\r\n    >h0,-2,#888888,ascii\r\no.\r\nO\r\nasciiend\r\n\r\n//Animation for DOT 'On Fire' Status\r\n?debuffs.string = \"debuff_dot\"\r\n  ?count <= 3\r\n    >h-2,1,#888888,ascii\r\n#`,\r\n(#`\r\nasciiend\r\n  :?count <= 6\r\n    >h-2,1,#888888,ascii\r\n.'\r\n##)\r\nasciiend\r\n  :?count <= 9\r\n    >h-2,1,#888888,ascii\r\n#'.\r\n(#)\r\nasciiend\r\n\r\n//Animation for 'igniton' Status\r\n?debuffs.string = \"ignition\"\r\n  ?count <= 3\r\n    >h0,4,#888888,ascii\r\n'`\r\n` \r\nasciiend\r\n  :?count <= 6\r\n    >h0,4,#888888,ascii\r\n'\r\n:\r\n#\r\nasciiend\r\n  :?count <= 9\r\n    >h0,4,#888888,ascii\r\n.\r\n`\r\n#\r\nasciiend\r\n\r\n//Draw Buffs for the Stonehead-------------------------------------------\r\n//Animation for 'Lucky' Status\r\n?buffs.string = \"lucky_mult\" | buffs.string = \"lucky_crit\"\r\n  ?count <= 4\r\n    >h-3,0,#white,ascii\r\n#♪\r\nasciiend\r\n  :?count <= 9\r\n    >h-3,0,#white,ascii\r\n♪\r\nasciiend\r\n\r\n//Animation for 'Strength' Status\r\n?buffs.string = \"strength\"\r\n  ?count <= 3\r\n    >h-3,0,#white,ascii\r\nP\r\nasciiend\r\n  ?count <= 6\r\n    >h-3,0,#white,ascii\r\n#O\r\nasciiend\r\n  :?count <= 9\r\n    >h-3,0,#white,ascii\r\n##W\r\nasciiend\r\n\r\n//Animation for 'Berserk' Status\r\n?buffs.string = \"berserk\"\r\n  ?count <= 4\r\n    >h-3,0,#white,ascii\r\n╬\r\nasciiend\r\n  :?count <= 9\r\n    >h-3,0,#white,ascii\r\n#╬\r\nasciiend\r\n\r\n//Animation for 'Vampire' Status\r\n?buffs.string = \"vampiric\"\r\n  ?count <= 4\r\n    >h-4,0,#white,ascii\r\nv,,v\r\nasciiend\r\n  :?count <= 9\r\n    >h-4,0,#white,ascii\r\nv^^v\r\nasciiend\r\n\r\n//Draw 'Smite' Status\r\n?buffs.string = \"smite\"\r\n  >h-3,3,#AA00DE,ascii\r\n#\\#!#/\r\nasciiend\r\n\r\ncount++\r\n?count > 9\r\n\tcount = 0\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/Calculator.txt" - Parse error: Failed to parse completely. Remaining: "(\"CalculatorColor\", #ffffff)\r\nvar calculatorScreenColor = storage.Get(\"CalculatorScreenColor\", #087a00)\r\nvar calculatorScreenBgColor = storage.Get(\"CalculatorScreenBgColor\", #244222)\r\nvar calculatorButtonColor = storage.Get(\"CalculatorButtonColor\", #001845)\r\nvar calculatorTextColor = storage.Get(\"CalculatorTextColor\", #ab8e00)\r\nvar calculatorKeyboardColor = storage.Get(\"CalculatorKeyboardColor\", #ab8e12)\r\nvar calculatorX = storage.Get(\"CalculatorX\", 0)\r\nvar calculatorY = storage.Get(\"CalculatorY\", 0)\r\nvar calculatorScreenOffsetTop = 0\r\nvar calculatorScreenOffsetBottom = 0\r\nvar minimizedX = storage.Get(\"MinimizedX\", screen.w/2)\r\nvar minimizedY = storage.Get(\"MinimizedY\", 23)\r\nvar sizeFlag = storage.Get(\"SizeFlag\", 0)\r\nvar optionsX = math.Clamp(calculatorX-24, 0, screen.w)\r\nvar optionsY = math.Clamp(calculatorY-14, 0, screen.h)\r\nvar minimizedColor = storage.Get(\"MinimizedColor\", #white)\r\nvar minimizedIconColor = storage.Get(\"MinimizedIconColor\", #white)\r\n\r\n//Buttons\r\nvar buttonX = createButton(99,99,1,1,\"X\")\r\nbuttonX.SetPressed(calculatorClose)\r\nvar buttonOptionsX = createButton(99,99,1,1,\"X\")\r\nbuttonOptionsX.SetPressed(optionsClose)\r\nvar buttonMinimized = createButton(minimizedX,minimizedY,5,3,\"∑\")\r\nbuttonMinimized.SetPressed(calculatorOpen)\r\nvar buttonClose = createButton(99,99,1,1,\"-\")\r\nbuttonClose.SetPressed(calculatorMinimize)\r\nvar buttonSize = createButton(99,99,1,1,\"◘\")\r\nbuttonSize.SetPressed(calculatorChangeSize)\r\nvar buttonOptions = createButton(99,99,9,1,\"Options\")\r\nbuttonOptions.SetPressed(calculatorOptions)\r\nvar buttonSum = createButton(99,99,3,3,\"+\")\r\nbuttonSum.SetPressed(calculatorOperation)\r\nvar buttonSub = createButton(99,99,3,3,\"-\")\r\nbuttonSub.SetPressed(calculatorOperation)\r\nvar buttonDiv = createButton(99,99,3,3,\"/\")\r\nbuttonDiv.SetPressed(calculatorOperation)\r\nvar buttonMult = createButton(99,99,3,3,\"X\")\r\nbuttonMult.SetPressed(calculatorOperation)\r\nvar buttonPow = createButton(99,99,3,3,\"^\")\r\nbuttonPow.SetPressed(calculatorOperation)\r\nvar buttonPercent = createButton(99,99,3,3,\"%\")\r\nbuttonPercent.SetPressed(calculatorPercent)\r\nvar buttonIgual = createButton(99,99,3,3,\"=\")\r\nbuttonIgual.SetPressed(calculatorEqual)\r\nvar buttonDecimal = createButton(99,99,3,3,\".\")\r\nbuttonDecimal.SetPressed(calculatorDecimal)\r\nvar buttonZero = createButton(99,99,3,3,\"0\")\r\nbuttonZero.SetPressed(calculatorNumber)\r\nvar buttonOne = createButton(99,99,3,3,\"1\")\r\nbuttonOne.SetPressed(calculatorNumber)\r\nvar buttonTwo = createButton(99,99,3,3,\"2\")\r\nbuttonTwo.SetPressed(calculatorNumber)\r\nvar buttonThree = createButton(99,99,3,3,\"3\")\r\nbuttonThree.SetPressed(calculatorNumber)\r\nvar buttonFour = createButton(99,99,3,3,\"4\")\r\nbuttonFour.SetPressed(calculatorNumber)\r\nvar buttonFive = createButton(99,99,3,3,\"5\")\r\nbuttonFive.SetPressed(calculatorNumber)\r\nvar buttonSix = createButton(99,99,3,3,\"6\")\r\nbuttonSix.SetPressed(calculatorNumber)\r\nvar buttonSeven = createButton(99,99,3,3,\"7\")\r\nbuttonSeven.SetPressed(calculatorNumber)\r\nvar buttonEight = createButton(99,99,3,3,\"8\")\r\nbuttonEight.SetPressed(calculatorNumber)\r\nvar buttonNine = createButton(99,99,3,3,\"9\")\r\nbuttonNine.SetPressed(calculatorNumber)\r\nvar buttonClear = createButton(99,99,3,3,\"C\")\r\nbuttonClear.SetPressed(calculatorClear)\r\nvar buttonBorderColor = createButton(99,99,22,1,\"Border color\")\r\nbuttonBorderColor.SetPressed(optionsColorMenu)\r\nvar buttonBackgroundColor = createButton(99,99,22,1,\"Background color\")\r\nbuttonBackgroundColor.SetPressed(optionsColorMenu)\r\nvar buttonScreenColor = createButton(99,99,22,1,\"Screen color\")\r\nbuttonScreenColor.SetPressed(optionsColorMenu)\r\nvar buttonScreenTextColor = createButton(99,99,22,1,\"Screen text color\")\r\nbuttonScreenTextColor.SetPressed(optionsColorMenu)\r\nvar buttonButtonColor = createButton(99,99,22,1,\"Button color\")\r\nbuttonButtonColor.SetPressed(optionsColorMenu)\r\nvar buttonButtonTextColor = createButton(99,99,22,1,\"Button text color\")\r\nbuttonButtonTextColor.SetPressed(optionsColorMenu)\r\nvar buttonMinimizedColor = createButton(99,99,22,1,\"Minimized color\")\r\nbuttonMinimizedColor.SetPressed(optionsColorMenu)\r\nvar buttonMinimizedIconColor = createButton(99,99,22,1,\"Minimized icon color\")\r\nbuttonMinimizedIconColor.SetPressed(optionsColorMenu)\r\nvar buttonCalculatorPlacement = createButton(99,99,22,1,\"Calculator placement\")\r\nbuttonCalculatorPlacement.SetPressed(optionsPlaceMenu)\r\nvar buttonMinimizedPlacement = createButton(99,99,22,1,\"Minimized placement\")\r\nbuttonMinimizedPlacement.SetPressed(optionsPlaceMenu)\r\nvar buttonChangeSize = createButton(99,99,22,1,\"Change size\")\r\nbuttonChangeSize.SetPressed(calculatorChangeSize)\r\nvar buttonOptionsColorX = createButton(99,99,1,1,\"X\")\r\nbuttonOptionsColorX.SetPressed(optionsCloseColor)\r\nvar buttonOptionsColorWhite = createButton(99,99,1,1,\"w\")\r\nbuttonOptionsColorWhite.SetPressed(optionsColorButton)\r\nvar buttonOptionsColorCyan = createButton(99,99,1,1,\"c\")\r\nbuttonOptionsColorCyan.SetPressed(optionsColorButton)\r\nvar buttonOptionsColorYellow = createButton(99,99,1,1,\"y\")\r\nbuttonOptionsColorYellow.SetPressed(optionsColorButton)\r\nvar buttonOptionsColorGreen = createButton(99,99,1,1,\"g\")\r\nbuttonOptionsColorGreen.SetPressed(optionsColorButton)\r\nvar buttonOptionsColorBlue = createButton(99,99,1,1,\"b\")\r\nbuttonOptionsColorBlue.SetPressed(optionsColorButton)\r\nvar buttonOptionsColorRed = createButton(99,99,1,1,\"r\")\r\nbuttonOptionsColorRed.SetPressed(optionsColorButton)\r\nvar buttonOptionsColorGrey = createButton(99,99,1,1,\"m\")\r\nbuttonOptionsColorGrey.SetPressed(optionsColorButton)\r\nvar buttonOptionsColorZero = createButton(99,99,1,1,\"0\")\r\nbuttonOptionsColorZero.SetPressed(optionsHex)\r\nvar buttonOptionsColorOne = createButton(99,99,1,1,\"1\")\r\nbuttonOptionsColorOne.SetPressed(optionsHex)\r\nvar buttonOptionsColorTwo = createButton(99,99,1,1,\"2\")\r\nbuttonOptionsColorTwo.SetPressed(optionsHex)\r\nvar buttonOptionsColorThree = createButton(99,99,1,1,\"3\")\r\nbuttonOptionsColorThree.SetPressed(optionsHex)\r\nvar buttonOptionsColorFour = createButton(99,99,1,1,\"4\")\r\nbuttonOptionsColorFour.SetPressed(optionsHex)\r\nvar buttonOptionsColorFive = createButton(99,99,1,1,\"5\")\r\nbuttonOptionsColorFive.SetPressed(optionsHex)\r\nvar buttonOptionsColorSix = createButton(99,99,1,1,\"6\")\r\nbuttonOptionsColorSix.SetPressed(optionsHex)\r\nvar buttonOptionsColorSeven = createButton(99,99,1,1,\"7\")\r\nbuttonOptionsColorSeven.SetPressed(optionsHex)\r\nvar buttonOptionsColorEight = createButton(99,99,1,1,\"8\")\r\nbuttonOptionsColorEight.SetPressed(optionsHex)\r\nvar buttonOptionsColorNine = createButton(99,99,1,1,\"9\")\r\nbuttonOptionsColorNine.SetPressed(optionsHex)\r\nvar buttonOptionsColorA = createButton(99,99,1,1,\"a\")\r\nbuttonOptionsColorA.SetPressed(optionsHex)\r\nvar buttonOptionsColorB = createButton(99,99,1,1,\"b\")\r\nbuttonOptionsColorB.SetPressed(optionsHex)\r\nvar buttonOptionsColorC = createButton(99,99,1,1,\"c\")\r\nbuttonOptionsColorC.SetPressed(optionsHex)\r\nvar buttonOptionsColorD = createButton(99,99,1,1,\"d\")\r\nbuttonOptionsColorD.SetPressed(optionsHex)\r\nvar buttonOptionsColorE = createButton(99,99,1,1,\"e\")\r\nbuttonOptionsColorE.SetPressed(optionsHex)\r\nvar buttonOptionsColorF = createButton(99,99,1,1,\"f\")\r\nbuttonOptionsColorF.SetPressed(optionsHex)\r\nvar buttonOptionsPlaceX = createButton(99,99,1,1,\"X\")\r\nbuttonOptionsPlaceX.SetPressed(optionsPlaceClose)\r\nvar buttonOptionsPlaceClear = createButton(99,99,1,1,\"Clear\")\r\nbuttonOptionsPlaceClear.SetPressed(clearPlacement)\r\nvar buttonOptionsPlaceClearX = createButton(99,99,1,1,\"ClearX\")\r\nbuttonOptionsPlaceClearX.SetPressed(clearPlacement)\r\nvar buttonOptionsPlaceClearY = createButton(99,99,1,1,\"ClearY\")\r\nbuttonOptionsPlaceClearY.SetPressed(clearPlacement)\r\nvar buttonPlaceLeft = createButton(99,99,1,1,\"←\")\r\nbuttonPlaceLeft.SetPressed(placementMovemente)\r\nvar buttonPlaceRight = createButton(99,99,1,1,\"→\")\r\nbuttonPlaceRight.SetPressed(placementMovemente)\r\nvar buttonPlaceDown = createButton(99,99,1,1,\"↓\")\r\nbuttonPlaceDown.SetPressed(placementMovemente)\r\nvar buttonPlaceUp = createButton(99,99,1,1,\"↑\")\r\nbuttonPlaceUp.SetPressed(placementMovemente)\r\nvar buttonOptionsPlaceXZero = createButton(99,99,1,1,\"0\")\r\nbuttonOptionsPlaceXZero.SetPressed(placementX)\r\nvar buttonOptionsPlaceXOne = createButton(99,99,1,1,\"1\")\r\nbuttonOptionsPlaceXOne.SetPressed(placementX)\r\nvar buttonOptionsPlaceXTwo = createButton(99,99,1,1,\"2\")\r\nbuttonOptionsPlaceXTwo.SetPressed(placementX)\r\nvar buttonOptionsPlaceXThree = createButton(99,99,1,1,\"3\")\r\nbuttonOptionsPlaceXThree.SetPressed(placementX)\r\nvar buttonOptionsPlaceXFour = createButton(99,99,1,1,\"4\")\r\nbuttonOptionsPlaceXFour.SetPressed(placementX)\r\nvar buttonOptionsPlaceXFive = createButton(99,99,1,1,\"5\")\r\nbuttonOptionsPlaceXFive.SetPressed(placementX)\r\nvar buttonOptionsPlaceXSix = createButton(99,99,1,1,\"6\")\r\nbuttonOptionsPlaceXSix.SetPressed(placementX)\r\nvar buttonOptionsPlaceXSeven = createButton(99,99,1,1,\"7\")\r\nbuttonOptionsPlaceXSeven.SetPressed(placementX)\r\nvar buttonOptionsPlaceXEight = createButton(99,99,1,1,\"8\")\r\nbuttonOptionsPlaceXEight.SetPressed(placementX)\r\nvar buttonOptionsPlaceXNine = createButton(99,99,1,1,\"9\")\r\nbuttonOptionsPlaceXNine.SetPressed(placementX)\r\nvar buttonOptionsPlaceYZero = createButton(99,99,1,1,\"0\")\r\nbuttonOptionsPlaceYZero.SetPressed(placementY)\r\nvar buttonOptionsPlaceYOne = createButton(99,99,1,1,\"1\")\r\nbuttonOptionsPlaceYOne.SetPressed(placementY)\r\nvar buttonOptionsPlaceYTwo = createButton(99,99,1,1,\"2\")\r\nbuttonOptionsPlaceYTwo.SetPressed(placementY)\r\nvar buttonOptionsPlaceYThree = createButton(99,99,1,1,\"3\")\r\nbuttonOptionsPlaceYThree.SetPressed(placementY)\r\nvar buttonOptionsPlaceYFour = createButton(99,99,1,1,\"4\")\r\nbuttonOptionsPlaceYFour.SetPressed(placementY)\r\nvar buttonOptionsPlaceYFive = createButton(99,99,1,1,\"5\")\r\nbuttonOptionsPlaceYFive.SetPressed(placementY)\r\nvar buttonOptionsPlaceYSix = createButton(99,99,1,1,\"6\")\r\nbuttonOptionsPlaceYSix.SetPressed(placementY)\r\nvar buttonOptionsPlaceYSeven = createButton(99,99,1,1,\"7\")\r\nbuttonOptionsPlaceYSeven.SetPressed(placementY)\r\nvar buttonOptionsPlaceYEight = createButton(99,99,1,1,\"8\")\r\nbuttonOptionsPlaceYEight.SetPressed(placementY)\r\nvar buttonOptionsPlaceYNine = createButton(99,99,1,1,\"9\")\r\nbuttonOptionsPlaceYNine.SetPressed(placementY)\r\n\r\n\r\n//Calculator workings\r\nvar elementFirst = 0.0\r\nvar elementSecond = 0.0\r\nvar elementOutput = \"0\"\r\nvar elementOperation = \"\"\r\nvar elementShown=null\r\nvar minimizedFlag = true\r\nvar optionsFlag = false\r\nvar elementDecimal = 10.0\r\nvar elementDecimalFlag = false\r\nvar elementFlag = true\r\nvar selectedColor = \"#white\"\r\nvar optionsColorFlag = false\r\nvar optionsPlaceFlag = false\r\nvar colorChanged = false\r\nvar menuName = \"\"\r\nvar hexFlag = false\r\n\r\n?elementFlag\r\n elementShown = elementFirst+elementOperation\r\n:\r\n elementShown = elementFirst+elementOperation+elementSecond\r\n//Functions\r\nfunc createButton(x,y,w,h,text)\r\n var aux = ui.AddButton()\r\n aux.x = x\r\n aux.y = y\r\n aux.w = w\r\n aux.h = h\r\n aux.text = text\r\n return aux\r\n\r\nfunc printCalculatorBig()\r\n hideButton(buttonMinimized)\r\n calculatorScreenOffsetTop = string.Size(elementShown)\r\n calculatorScreenOffsetBottom = string.Size(elementOutput+\"\")\r\n >`@calculatorX@,@calculatorY@,@calculatorColor@,@calculatorBig@\r\n >`@calculatorX@,@calculatorY@,@calculatorScreenColor@,@calculatorBigScreen@\r\n ?!optionsFlag\r\n  draw.Bg(calculatorX+3,calculatorY+3,calculatorScreenBgColor,22,2)\r\n >`@calculatorX@,@calculatorY@,@calculatorButtonColor@,@calculatorBigButton@\r\n >`@calculatorX@,@calculatorY@,@calculatorKeyboardColor@,@calculatorBigNumbers@\r\n >`@calculatorX+25-calculatorScreenOffsetTop@,@calculatorY+3@,@calculatorTextColor@,@elementShown@\r\n >`@calculatorX+25-calculatorScreenOffsetBottom@,@calculatorY+4@,@calculatorTextColor@,@elementOutput@\r\n\r\nfunc printCalculatorMedium()\r\n hideButton(buttonMinimized)\r\n calculatorScreenOffsetTop = string.Size(elementShown)\r\n calculatorScreenOffsetBottom = string.Size(elementOutput+\"\")\r\n >`@calculatorX@,@calculatorY@,@calculatorColor@,@calculatorMedium@\r\n >`@calculatorX@,@calculatorY@,@calculatorScreenColor@,@calculatorMediumScreen@\r\n ?!optionsFlag\r\n  draw.Bg(calculatorX+3,calculatorY+3,calculatorScreenBgColor,16,2)\r\n >`@calculatorX@,@calculatorY@,@calculatorButtonColor@,@calculatorMediumButton@\r\n >`@calculatorX@,@calculatorY@,@calculatorKeyboardColor@,@calculatorMediumNumbers@\r\n >`@calculatorX+19-calculatorScreenOffsetTop@,@calculatorY+3@,@calculatorTextColor@,@elementShown@\r\n >`@calculatorX+19-calculatorScreenOffsetBottom@,@calculatorY+4@,@calculatorTextColor@,@elementOutput@\r\n\r\nfunc printCalculatorSmall()\r\n hideButton(buttonMinimized)\r\n calculatorScreenOffsetTop = string.Size(elementShown)\r\n calculatorScreenOffsetBottom = string.Size(elementOutput+\"\")\r\n >`@calculatorX@,@calculatorY@,@calculatorColor@,@calculatorSmall@\r\n >`@calculatorX@,@calculatorY@,@calculatorScreenColor@,@calculatorSmallScreen@\r\n ?!optionsFlag\r\n  draw.Bg(calculatorX+3,calculatorY+3,calculatorScreenBgColor,13,2)\r\n >`@calculatorX@,@calculatorY@,@calculatorButtonColor@,@calculatorSmallButton@\r\n >`@calculatorX@,@calculatorY@,@calculatorKeyboardColor@,@calculatorSmallNumbers@\r\n >`@calculatorX+16-calculatorScreenOffsetTop@,@calculatorY+3@,@calculatorTextColor@,@elementShown@\r\n >`@calculatorX+16-calculatorScreenOffsetBottom@,@calculatorY+4@,@calculatorTextColor@,@elementOutput@\r\n\r\nfunc printMinimizedIcon()\r\n buttonMinimized.x = minimizedX\r\n buttonMinimized.y = minimizedY\r\n >`@minimizedX@,@minimizedY@,@minimizedColor@,@minimizedIcon@\r\n >`@minimizedX+2@,@minimizedY+1@,@minimizedIconColor@,∑\r\n\r\nfunc calculatorClose()\r\n elementFirst = 0.0\r\n elementSecond = 0.0\r\n elementShown = null\r\n elementOutput = 0\r\n hideButton(buttonX)\r\n hideButton(buttonSize)\r\n hideButton(buttonClose)\r\n hideButton(buttonOptions)\r\n hideButton(buttonMult)\r\n hideButton(buttonDiv)\r\n hideButton(buttonSub)\r\n hideButton(buttonSum)\r\n hideButton(buttonPow)\r\n hideButton(buttonPercent)\r\n hideButton(buttonZero)\r\n hideButton(buttonOne)\r\n hideButton(buttonTwo)\r\n hideButton(buttonThree)\r\n hideButton(buttonFour)\r\n hideButton(buttonFive)\r\n hideButton(buttonSix)\r\n hideButton(buttonSeven)\r\n hideButton(buttonEight)\r\n hideButton(buttonNine)\r\n hideButton(buttonDecimal)\r\n hideButton(buttonIgual)\r\n hideButton(buttonClear)\r\n minimizedFlag = true\r\n\r\nfunc calculatorOpen()\r\n ?sizeFlag = 0\r\n  showButton(buttonX,calculatorX+24,calculatorY+1,1,1)\r\n  showButton(buttonSize,calculatorX+22,calculatorY+1,1,1)\r\n  showButton(buttonClose,calculatorX+20,calculatorY+1,1,1)\r\n  showButton(buttonOptions,calculatorX+2,calculatorY+1,9,1)\r\n  showButton(buttonDecimal,calculatorX+2,calculatorY+19,5,3)\r\n  showButton(buttonIgual,calculatorX+14,calculatorY+19,5,3)\r\n  showButton(buttonSum,calculatorX+21,calculatorY+10,5,3)\r\n  showButton(buttonSub,calculatorX+21,calculatorY+13,5,3)\r\n  showButton(buttonMult,calculatorX+21,calculatorY+16,5,3)\r\n  showButton(buttonDiv,calculatorX+21,calculatorY+19,5,3)\r\n  showButton(buttonPow,calculatorX+8,calculatorY+7,5,3)\r\n  showButton(buttonPercent,calculatorX+14,calculatorY+7,5,3)\r\n  showButton(buttonZero,calculatorX+8,calculatorY+19,5,3)\r\n  showButton(buttonOne,calculatorX+2,calculatorY+16,5,3)\r\n  showButton(buttonTwo,calculatorX+8,calculatorY+16,5,3)\r\n  showButton(buttonThree,calculatorX+14,calculatorY+16,5,3)\r\n  showButton(buttonFour,calculatorX+2,calculatorY+13,5,3)\r\n  showButton(buttonFive,calculatorX+8,calculatorY+13,5,3)\r\n  showButton(buttonSix,calculatorX+14,calculatorY+13,5,3)\r\n  showButton(buttonSeven,calculatorX+2,calculatorY+10,5,3)\r\n  showButton(buttonEight,calculatorX+8,calculatorY+10,5,3)\r\n  showButton(buttonNine,calculatorX+14,calculatorY+10,5,3)\r\n  showButton(buttonClear,calculatorX+21,calculatorY+7,5,3)\r\n :?sizeFlag = 1\r\n  showButton(buttonX,calculatorX+18,calculatorY+1,1,1)\r\n  showButton(buttonSize,calculatorX+16,calculatorY+1,1,1)\r\n  showButton(buttonClose,calculatorX+14,calculatorY+1,1,1)\r\n  showButton(buttonOptions,calculatorX+2,calculatorY+1,9,1)\r\n  showButton(buttonDecimal,calculatorX+2,calculatorY+18,3,3)\r\n  showButton(buttonIgual,calculatorX+10,calculatorY+18,3,3)\r\n  showButton(buttonSum,calculatorX+15,calculatorY+9,5,3)\r\n  showButton(buttonSub,calculatorX+15,calculatorY+12,5,3)\r\n  showButton(buttonMult,calculatorX+15,calculatorY+15,5,3)\r\n  showButton(buttonDiv,calculatorX+15,calculatorY+18,5,3)\r\n  showButton(buttonPow,calculatorX+10,calculatorY+6,3,3)\r\n  showButton(buttonPercent,calculatorX+6,calculatorY+6,3,3)\r\n  showButton(buttonZero,calculatorX+6,calculatorY+18,3,3)\r\n  showButton(buttonOne,calculatorX+2,calculatorY+15,3,3)\r\n  showButton(buttonTwo,calculatorX+6,calculatorY+15,3,3)\r\n  showButton(buttonThree,calculatorX+10,calculatorY+15,3,3)\r\n  showButton(buttonFour,calculatorX+2,calculatorY+12,3,3)\r\n  showButton(buttonFive,calculatorX+6,calculatorY+12,3,3)\r\n  showButton(buttonSix,calculatorX+10,calculatorY+12,3,3)\r\n  showButton(buttonSeven,calculatorX+2,calculatorY+9,3,3)\r\n  showButton(buttonEight,calculatorX+6,calculatorY+9,3,3)\r\n  showButton(buttonNine,calculatorX+10,calculatorY+9,3,3)\r\n  showButton(buttonClear,calculatorX+15,calculatorY+6,5,3)\r\n :?sizeFlag = 2\r\n  showButton(buttonX,calculatorX+15,calculatorY+1,1,1)\r\n  showButton(buttonSize,calculatorX+13,calculatorY+1,1,1)\r\n  showButton(buttonClose,calculatorX+11,calculatorY+1,1,1)\r\n  showButton(buttonOptions,calculatorX+2,calculatorY+1,8,1)\r\n  showButton(buttonDecimal,calculatorX+2,calculatorY+18,3,3)\r\n  showButton(buttonIgual,calculatorX+8,calculatorY+18,3,3)\r\n  showButton(buttonSum,calculatorX+12,calculatorY+9,5,3)\r\n  showButton(buttonSub,calculatorX+12,calculatorY+12,5,3)\r\n  showButton(buttonMult,calculatorX+12,calculatorY+15,5,3)\r\n  showButton(buttonDiv,calculatorX+12,calculatorY+18,5,3)\r\n  showButton(buttonPow,calculatorX+5,calculatorY+6,3,3)\r\n  showButton(buttonPercent,calculatorX+8,calculatorY+6,3,3)\r\n  showButton(buttonZero,calculatorX+5,calculatorY+18,3,3)\r\n  showButton(buttonOne,calculatorX+2,calculatorY+15,3,3)\r\n  showButton(buttonTwo,calculatorX+5,calculatorY+15,3,3)\r\n  showButton(buttonThree,calculatorX+8,calculatorY+15,3,3)\r\n  showButton(buttonFour,calculatorX+2,calculatorY+12,3,3)\r\n  showButton(buttonFive,calculatorX+5,calculatorY+12,3,3)\r\n  showButton(buttonSix,calculatorX+8,calculatorY+12,3,3)\r\n  showButton(buttonSeven,calculatorX+2,calculatorY+9,3,3)\r\n  showButton(buttonEight,calculatorX+5,calculatorY+9,3,3)\r\n  showButton(buttonNine,calculatorX+8,calculatorY+9,3,3)\r\n  showButton(buttonClear,calculatorX+12,calculatorY+6,5,3)\r\n minimizedFlag = false\r\n\r\nfunc calculatorMinimize()\r\n hideButton(buttonX)\r\n hideButton(buttonSize)\r\n hideButton(buttonClose)\r\n hideButton(buttonOptions)\r\n hideButton(buttonMult)\r\n hideButton(buttonDiv)\r\n hideButton(buttonSub)\r\n hideButton(buttonSum)\r\n hideButton(buttonPow)\r\n hideButton(buttonPercent)\r\n hideButton(buttonZero)\r\n hideButton(buttonOne)\r\n hideButton(buttonTwo)\r\n hideButton(buttonThree)\r\n hideButton(buttonFour)\r\n hideButton(buttonFive)\r\n hideButton(buttonSix)\r\n hideButton(buttonSeven)\r\n hideButton(buttonEight)\r\n hideButton(buttonNine)\r\n hideButton(buttonDecimal)\r\n hideButton(buttonIgual)\r\n hideButton(buttonClear)\r\n minimizedFlag = true\r\n\r\nfunc calculatorMinimizeOptions()\r\n hideButton(buttonX)\r\n hideButton(buttonSize)\r\n hideButton(buttonClose)\r\n hideButton(buttonOptions)\r\n hideButton(buttonMult)\r\n hideButton(buttonDiv)\r\n hideButton(buttonSub)\r\n hideButton(buttonSum)\r\n hideButton(buttonPow)\r\n hideButton(buttonPercent)\r\n hideButton(buttonZero)\r\n hideButton(buttonOne)\r\n hideButton(buttonTwo)\r\n hideButton(buttonThree)\r\n hideButton(buttonFour)\r\n hideButton(buttonFive)\r\n hideButton(buttonSix)\r\n hideButton(buttonSeven)\r\n hideButton(buttonEight)\r\n hideButton(buttonNine)\r\n hideButton(buttonDecimal)\r\n hideButton(buttonIgual)\r\n hideButton(buttonClear)\r\n\r\nfunc calculatorChangeSize()\r\n ?optionsFlag\r\n  ?sizeFlag = 0\r\n   sizeFlag = 1\r\n  :?sizeFlag = 1\r\n   sizeFlag = 2\r\n  :?sizeFlag = 2\r\n   sizeFlag = 0\r\n :\r\n  ?sizeFlag = 0\r\n   showButton(buttonX,calculatorX+18,calculatorY+1,1,1)\r\n   showButton(buttonSize,calculatorX+16,calculatorY+1,1,1)\r\n   showButton(buttonClose,calculatorX+14,calculatorY+1,1,1)\r\n   showButton(buttonOptions,calculatorX+2,calculatorY+1,9,1)\r\n   showButton(buttonDecimal,calculatorX+2,calculatorY+18,3,3)\r\n   showButton(buttonIgual,calculatorX+10,calculatorY+18,3,3)\r\n   showButton(buttonSum,calculatorX+15,calculatorY+9,5,3)\r\n   showButton(buttonSub,calculatorX+15,calculatorY+12,5,3)\r\n   showButton(buttonMult,calculatorX+15,calculatorY+15,5,3)\r\n   showButton(buttonDiv,calculatorX+15,calculatorY+18,5,3)\r\n   showButton(buttonPow,calculatorX+10,calculatorY+6,3,3)\r\n   showButton(buttonPercent,calculatorX+6,calculatorY+6,3,3)\r\n   showButton(buttonZero,calculatorX+6,calculatorY+18,3,3)\r\n   showButton(buttonOne,calculatorX+2,calculatorY+15,3,3)\r\n   showButton(buttonTwo,calculatorX+6,calculatorY+15,3,3)\r\n   showButton(buttonThree,calculatorX+10,calculatorY+15,3,3)\r\n   showButton(buttonFour,calculatorX+2,calculatorY+12,3,3)\r\n   showButton(buttonFive,calculatorX+6,calculatorY+12,3,3)\r\n   showButton(buttonSix,calculatorX+10,calculatorY+12,3,3)\r\n   showButton(buttonSeven,calculatorX+2,calculatorY+9,3,3)\r\n   showButton(buttonEight,calculatorX+6,calculatorY+9,3,3)\r\n   showButton(buttonNine,calculatorX+10,calculatorY+9,3,3)\r\n   showButton(buttonClear,calculatorX+15,calculatorY+6,5,3)\r\n   sizeFlag = 1\r\n  :?sizeFlag = 1\r\n   showButton(buttonX,calculatorX+15,calculatorY+1,1,1)\r\n   showButton(buttonSize,calculatorX+13,calculatorY+1,1,1)\r\n   showButton(buttonClose,calculatorX+11,calculatorY+1,1,1)\r\n   showButton(buttonOptions,calculatorX+2,calculatorY+1,8,1)\r\n   showButton(buttonDecimal,calculatorX+2,calculatorY+18,3,3)\r\n   showButton(buttonIgual,calculatorX+8,calculatorY+18,3,3)\r\n   showButton(buttonSum,calculatorX+12,calculatorY+9,5,3)\r\n   showButton(buttonSub,calculatorX+12,calculatorY+12,5,3)\r\n   showButton(buttonMult,calculatorX+12,calculatorY+15,5,3)\r\n   showButton(buttonDiv,calculatorX+12,calculatorY+18,5,3)\r\n   showButton(buttonPow,calculatorX+5,calculatorY+6,3,3)\r\n   showButton(buttonPercent,calculatorX+8,calculatorY+6,3,3)\r\n   showButton(buttonZero,calculatorX+5,calculatorY+18,3,3)\r\n   showButton(buttonOne,calculatorX+2,calculatorY+15,3,3)\r\n   showButton(buttonTwo,calculatorX+5,calculatorY+15,3,3)\r\n   showButton(buttonThree,calculatorX+8,calculatorY+15,3,3)\r\n   showButton(buttonFour,calculatorX+2,calculatorY+12,3,3)\r\n   showButton(buttonFive,calculatorX+5,calculatorY+12,3,3)\r\n   showButton(buttonSix,calculatorX+8,calculatorY+12,3,3)\r\n   showButton(buttonSeven,calculatorX+2,calculatorY+9,3,3)\r\n   showButton(buttonEight,calculatorX+5,calculatorY+9,3,3)\r\n   showButton(buttonNine,calculatorX+8,calculatorY+9,3,3)\r\n   showButton(buttonClear,calculatorX+12,calculatorY+6,5,3)\r\n   sizeFlag = 2\r\n  :?sizeFlag = 2\r\n   showButton(buttonX,calculatorX+24,calculatorY+1,1,1)\r\n   showButton(buttonSize,calculatorX+22,calculatorY+1,1,1)\r\n   showButton(buttonClose,calculatorX+20,calculatorY+1,1,1)\r\n   showButton(buttonOptions,calculatorX+2,calculatorY+1,9,1)\r\n   showButton(buttonDecimal,calculatorX+2,calculatorY+19,5,3)\r\n   showButton(buttonIgual,calculatorX+14,calculatorY+19,5,3)\r\n   showButton(buttonSum,calculatorX+21,calculatorY+10,5,3)\r\n   showButton(buttonSub,calculatorX+21,calculatorY+13,5,3)\r\n   showButton(buttonMult,calculatorX+21,calculatorY+16,5,3)\r\n   showButton(buttonDiv,calculatorX+21,calculatorY+19,5,3)\r\n   showButton(buttonPow,calculatorX+8,calculatorY+7,5,3)\r\n   showButton(buttonPercent,calculatorX+14,calculatorY+7,5,3)\r\n   showButton(buttonZero,calculatorX+8,calculatorY+19,5,3)\r\n   showButton(buttonOne,calculatorX+2,calculatorY+16,5,3)\r\n   showButton(buttonTwo,calculatorX+8,calculatorY+16,5,3)\r\n   showButton(buttonThree,calculatorX+14,calculatorY+16,5,3)\r\n   showButton(buttonFour,calculatorX+2,calculatorY+13,5,3)\r\n   showButton(buttonFive,calculatorX+8,calculatorY+13,5,3)\r\n   showButton(buttonSix,calculatorX+14,calculatorY+13,5,3)\r\n   showButton(buttonSeven,calculatorX+2,calculatorY+10,5,3)\r\n   showButton(buttonEight,calculatorX+8,calculatorY+10,5,3)\r\n   showButton(buttonNine,calculatorX+14,calculatorY+10,5,3)\r\n   showButton(buttonClear,calculatorX+21,calculatorY+7,5,3)\r\n   sizeFlag = 0\r\n storage.Set(\"SizeFlag\", sizeFlag)\r\n\r\nfunc calculatorNumber(button)\r\n ?elementFlag\r\n  ?elementDecimalFlag\r\n   elementFirst = elementFirst + (int.Parse(button.text)/elementDecimal)\r\n   elementDecimal = elementDecimal*10.0\r\n  :\r\n   elementFirst = elementFirst*10.0 + int.Parse(button.text)\r\n :\r\n  ?elementDecimalFlag\r\n   elementSecond = elementSecond + (int.Parse(button.text)/elementDecimal)\r\n   elementDecimal = elementDecimal*10.0\r\n  :\r\n   elementSecond = elementSecond*10.0 + int.Parse(button.text)\r\n\r\nfunc calculatorDecimal()\r\n elementDecimalFlag = true\r\n\r\nfunc calculatorOperation(button)\r\n ?elementSecond ! 0\r\n  calculatorEqual()\r\n  elementFirst = elementOutput\r\n  elementOperation = button.text\r\n  elementDecimal = 10.0\r\n  elementDecimalFlag = false\r\n  elementFlag = false\r\n :\r\n  elementOperation = button.text\r\n  elementDecimal = 10.0\r\n  elementDecimalFlag = false\r\n  elementFlag = false\r\n\r\nfunc calculatorPercent()\r\n ?elementOperation = \"X\"\r\n  elementOutput = elementFirst*(elementSecond/100.0)\r\n  elementFirst = elementOutput\r\n :?elementOperation = \"+\"\r\n  elementOutput = elementFirst+(elementFirst*(elementSecond/100.0))\r\n  elementFirst = elementOutput\r\n :?elementOperation = \"-\"\r\n  elementOutput = elementFirst-(elementFirst*(elementSecond/100.0))\r\n  elementFirst = elementOutput\r\n :\r\n  elementOutput = \"Err\"\r\n  elementFirst = 0\r\n elementDecimal = 10.0\r\n elementDecimalFlag = false\r\n elementFirst = 0.0\r\n elementSecond = 0.0\r\n elementOperation = \"\"\r\n elementFlag = true\r\n \r\n\r\nfunc calculatorEqual()\r\n ?elementOperation = \"+\"\r\n  elementOutput = elementFirst+elementSecond\r\n :?elementOperation = \"-\"\r\n  elementOutput = elementFirst-elementSecond\r\n :?elementOperation = \"X\"\r\n  elementOutput = elementFirst*elementSecond\r\n :?elementOperation = \"/\"\r\n  elementOutput = elementFirst/elementSecond\r\n :?elementOperation = \"^\"\r\n  elementOutput = math.Pow(elementFirst,elementSecond)\r\n elementDecimal = 10.0\r\n elementDecimalFlag = false\r\n elementFirst = elementOutput\r\n elementSecond = 0.0\r\n elementOperation = \"\"\r\n elementFlag = true\r\n\r\nfunc calculatorClear()\r\n elementFirst = 0.0\r\n elementSecond = 0.0\r\n elementOutput = 0\r\n elementOperation = \"\"\r\n elementShown=null\r\n elementDecimal = 10.0\r\n elementDecimalFlag = false\r\n elementFlag = true\r\n\r\nfunc optionsClose()\r\n hideButton(buttonOptionsX)\r\n hideButton(buttonOptionsX)\r\n hideButton(buttonBorderColor)\r\n hideButton(buttonScreenColor)\r\n hideButton(buttonBackgroundColor)\r\n hideButton(buttonScreenTextColor)\r\n hideButton(buttonButtonColor)\r\n hideButton(buttonButtonTextColor)\r\n hideButton(buttonCalculatorPlacement)\r\n hideButton(buttonMinimizedPlacement)\r\n hideButton(buttonMinimizedColor)\r\n hideButton(buttonMinimizedIconColor)\r\n hideButton( buttonChangeSize)\r\n optionsFlag = false\r\n calculatorOpen()\r\n\r\nfunc optionsHide()\r\n hideButton(buttonOptionsX)\r\n hideButton(buttonOptionsX)\r\n hideButton(buttonBorderColor)\r\n hideButton(buttonScreenColor)\r\n hideButton(buttonBackgroundColor)\r\n hideButton(buttonScreenTextColor)\r\n hideButton(buttonButtonColor)\r\n hideButton(buttonButtonTextColor)\r\n hideButton(buttonCalculatorPlacement)\r\n hideButton(buttonMinimizedPlacement)\r\n hideButton(buttonMinimizedColor)\r\n hideButton(buttonMinimizedIconColor)\r\n hideButton( buttonChangeSize)\r\n\r\nfunc calculatorOptions()\r\n calculatorMinimizeOptions()\r\n showButton(buttonOptionsX,optionsX+21,optionsY+1,1,1)\r\n showButton(buttonBorderColor,optionsX+1,optionsY+3,22,1)\r\n showButton(buttonScreenColor,optionsX+1,optionsY+4,22,1)\r\n showButton(buttonBackgroundColor,optionsX+1,optionsY+5,22,1)\r\n showButton(buttonScreenTextColor,optionsX+1,optionsY+6,22,1)\r\n showButton(buttonButtonColor,optionsX+1,optionsY+7,22,1)\r\n showButton(buttonButtonTextColor,optionsX+1,optionsY+8,22,1)\r\n showButton(buttonCalculatorPlacement,optionsX+1,optionsY+9,22,1)\r\n showButton(buttonMinimizedPlacement,optionsX+1,optionsY+10,22,1)\r\n showButton(buttonMinimizedColor,optionsX+1,optionsY+11,22,1)\r\n showButton(buttonMinimizedIconColor,optionsX+1,optionsY+12,22,1)\r\n showButton( buttonChangeSize,optionsX+1,optionsY+13,22,1)\r\n optionsFlag = true\r\n\r\nfunc optionsCloseColor()\r\n optionsColorFlag = false\r\n hideButton(buttonOptionsColorBlue)\r\n hideButton(buttonOptionsColorCyan)\r\n hideButton(buttonOptionsColorGreen)\r\n hideButton(buttonOptionsColorGrey)\r\n hideButton(buttonOptionsColorRed)\r\n hideButton(buttonOptionsColorWhite)\r\n hideButton(buttonOptionsColorX)\r\n hideButton(buttonOptionsColorYellow)\r\n hideButton(buttonOptionsColorZero)\r\n hideButton(buttonOptionsColorOne)\r\n hideButton(buttonOptionsColorTwo)\r\n hideButton(buttonOptionsColorThree)\r\n hideButton(buttonOptionsColorFour)\r\n hideButton(buttonOptionsColorFive)\r\n hideButton(buttonOptionsColorSix)\r\n hideButton(buttonOptionsColorSeven)\r\n hideButton(buttonOptionsColorEight)\r\n hideButton(buttonOptionsColorNine)\r\n hideButton(buttonOptionsColorA)\r\n hideButton(buttonOptionsColorB)\r\n hideButton(buttonOptionsColorC)\r\n hideButton(buttonOptionsColorD)\r\n hideButton(buttonOptionsColorE)\r\n hideButton(buttonOptionsColorF)\r\n calculatorOptions()\r\n\r\nfunc optionsColorButton(button)\r\n ?button.text = \"w\"\r\n  selectedColor = \"#white\"\r\n :?button.text = \"c\"\r\n  selectedColor = \"#cyan\"\r\n :?button.text = \"y\"\r\n  selectedColor =  \"#yellow\"\r\n :?button.text = \"g\"\r\n  selectedColor = \"#green\"\r\n :?button.text = \"b\"\r\n  selectedColor = \"#blue\"\r\n :?button.text = \"r\"\r\n  selectedColor = \"#red\"\r\n :?button.text = \"m\"\r\n  selectedColor = \"#202020\"\r\n colorChanged = true\r\n\r\nfunc optionsHex(button)\r\n ?hexFlag\r\n  selectedColor = selectedColor+button.text\r\n :\r\n  selectedColor = \"#\"+button.text\r\n  hexFlag = true\r\n\r\nfunc optionsColorButtons()\r\n optionsHide()\r\n optionsColorFlag = true\r\n hexFlag = false\r\n showButton(buttonOptionsColorBlue,optionsX+14,optionsY+7,1,1)\r\n showButton(buttonOptionsColorCyan,optionsX+5,optionsY+7,1,1)\r\n showButton(buttonOptionsColorGreen,optionsX+11,optionsY+7,1,1)\r\n showButton(buttonOptionsColorGrey,optionsX+20,optionsY+7,1,1)\r\n showButton(buttonOptionsColorRed,optionsX+17,optionsY+7,1,1)\r\n showButton(buttonOptionsColorWhite,optionsX+2,optionsY+7,1,1)\r\n showButton(buttonOptionsColorX,optionsX+21,optionsY+1,1,1)\r\n showButton(buttonOptionsColorYellow,optionsX+8,optionsY+7,1,1)\r\n showButton(buttonOptionsColorZero,optionsX+2,optionsY+11,1,1)\r\n showButton(buttonOptionsColorOne,optionsX+4,optionsY+11,1,1)\r\n showButton(buttonOptionsColorTwo,optionsX+6,optionsY+11,1,1)\r\n showButton(buttonOptionsColorThree,optionsX+8,optionsY+11,1,1)\r\n showButton(buttonOptionsColorFour,optionsX+10,optionsY+11,1,1)\r\n showButton(buttonOptionsColorFive,optionsX+12,optionsY+11,1,1)\r\n showButton(buttonOptionsColorSix,optionsX+14,optionsY+11,1,1)\r\n showButton(buttonOptionsColorSeven,optionsX+16,optionsY+11,1,1)\r\n showButton(buttonOptionsColorEight,optionsX+18,optionsY+11,1,1)\r\n showButton(buttonOptionsColorNine,optionsX+20,optionsY+11,1,1)\r\n showButton(buttonOptionsColorA,optionsX+2,optionsY+12,1,1)\r\n showButton(buttonOptionsColorB,optionsX+4,optionsY+12,1,1)\r\n showButton(buttonOptionsColorC,optionsX+6,optionsY+12,1,1)\r\n showButton(buttonOptionsColorD,optionsX+8,optionsY+12,1,1)\r\n showButton(buttonOptionsColorE,optionsX+10,optionsY+12,1,1)\r\n showButton(buttonOptionsColorF,optionsX+12,optionsY+12,1,1)\r\n\r\nfunc optionsColorMenu(button)\r\n menuName = button.text\r\n optionsColorButtons()\r\n\r\nfunc optionsPlaceClose()\r\n hideButton(buttonOptionsPlaceX)\r\n hideButton(buttonOptionsPlaceClear)\r\n hideButton(buttonOptionsPlaceClearX)\r\n hideButton(buttonOptionsPlaceClearY)\r\n hideButton(buttonPlaceLeft)\r\n hideButton(buttonPlaceRight)\r\n hideButton(buttonPlaceDown)\r\n hideButton(buttonPlaceUp)\r\n hideButton(buttonOptionsPlaceXZero)\r\n hideButton(buttonOptionsPlaceXOne)\r\n hideButton(buttonOptionsPlaceXTwo)\r\n hideButton(buttonOptionsPlaceXThree)\r\n hideButton(buttonOptionsPlaceXFour)\r\n hideButton(buttonOptionsPlaceXFive)\r\n hideButton(buttonOptionsPlaceXSix)\r\n hideButton(buttonOptionsPlaceXSeven)\r\n hideButton(buttonOptionsPlaceXEight)\r\n hideButton(buttonOptionsPlaceXNine)\r\n hideButton(buttonOptionsPlaceYZero)\r\n hideButton(buttonOptionsPlaceYOne)\r\n hideButton(buttonOptionsPlaceYTwo)\r\n hideButton(buttonOptionsPlaceYThree)\r\n hideButton(buttonOptionsPlaceYFour)\r\n hideButton(buttonOptionsPlaceYFive)\r\n hideButton(buttonOptionsPlaceYSix)\r\n hideButton(buttonOptionsPlaceYSeven)\r\n hideButton(buttonOptionsPlaceYEight)\r\n hideButton(buttonOptionsPlaceYNine)\r\n optionsPlaceFlag = false\r\n calculatorOptions()\r\n\r\nfunc optionsPlaceMenu(button)\r\n optionsHide()\r\n menuName = button.text\r\n optionsPlaceFlag = true\r\n ?button.text = \"Minimized placement\"\r\n  minimizedFlag = true\r\n showButton(buttonOptionsPlaceX,optionsX+21,optionsY+1,1,1)\r\n showButton(buttonOptionsPlaceClear,optionsX+2,optionsY+6,5,1)\r\n showButton(buttonOptionsPlaceClearX,optionsX+2,optionsY+12,5,1)\r\n showButton(buttonOptionsPlaceClearY,optionsX+2,optionsY+15,5,1)\r\n showButton(buttonPlaceLeft,optionsX+2,optionsY+7,1,1)\r\n showButton(buttonPlaceRight,optionsX+4,optionsY+7,1,1)\r\n showButton(buttonPlaceDown,optionsX+6,optionsY+7,1,1)\r\n showButton(buttonPlaceUp,optionsX+8,optionsY+7,1,1)\r\n showButton(buttonOptionsPlaceXZero,optionsX+2,optionsY+11,1,1)\r\n showButton(buttonOptionsPlaceXOne,optionsX+4,optionsY+11,1,1)\r\n showButton(buttonOptionsPlaceXTwo,optionsX+6,optionsY+11,1,1)\r\n showButton(buttonOptionsPlaceXThree,optionsX+8,optionsY+11,1,1)\r\n showButton(buttonOptionsPlaceXFour,optionsX+10,optionsY+11,1,1)\r\n showButton(buttonOptionsPlaceXFive,optionsX+12,optionsY+11,1,1)\r\n showButton(buttonOptionsPlaceXSix,optionsX+14,optionsY+11,1,1)\r\n showButton(buttonOptionsPlaceXSeven,optionsX+16,optionsY+11,1,1)\r\n showButton(buttonOptionsPlaceXEight,optionsX+18,optionsY+11,1,1)\r\n showButton(buttonOptionsPlaceXNine,optionsX+20,optionsY+11,1,1)\r\n showButton(buttonOptionsPlaceYZero,optionsX+2,optionsY+14,1,1)\r\n showButton(buttonOptionsPlaceYOne,optionsX+4,optionsY+14,1,1)\r\n showButton(buttonOptionsPlaceYTwo,optionsX+6,optionsY+14,1,1)\r\n showButton(buttonOptionsPlaceYThree,optionsX+8,optionsY+14,1,1)\r\n showButton(buttonOptionsPlaceYFour,optionsX+10,optionsY+14,1,1)\r\n showButton(buttonOptionsPlaceYFive,optionsX+12,optionsY+14,1,1)\r\n showButton(buttonOptionsPlaceYSix,optionsX+14,optionsY+14,1,1)\r\n showButton(buttonOptionsPlaceYSeven,optionsX+16,optionsY+14,1,1)\r\n showButton(buttonOptionsPlaceYEight,optionsX+18,optionsY+14,1,1)\r\n showButton(buttonOptionsPlaceYNine,optionsX+20,optionsY+14,1,1)\r\n\r\nfunc clearPlacement(button)\r\n ?minimizedFlag\r\n  ?button.text = \"ClearX\"\r\n   minimizedX = 0\r\n  :?button.text = \"ClearY\"\r\n   minimizedY = 0\r\n  :\r\n   minimizedX = 0\r\n   minimizedY = 0\r\n :\r\n  ?button.text = \"ClearX\"\r\n   calculatorX = 0\r\n  :?button.text = \"ClearY\"\r\n   calculatorY = 0\r\n  :\r\n   calculatorX = 0\r\n   calculatorY = 0\r\n storage.Set(\"MinimizedX\", minimizedX)\r\n storage.Set(\"MinimizedY\", minimizedY)\r\n storage.Set(\"CalculatorX\", calculatorX)\r\n storage.Set(\"CalculatorY\", calculatorY)\r\n\r\n\r\nfunc placementMovemente(button)\r\n ?minimizedFlag\r\n  ?button.text = \"←\"\r\n   minimizedX--\r\n  ?button.text = \"→\"\r\n   minimizedX++\r\n  ?button.text = \"↓\"\r\n   minimizedY++\r\n  ?button.text = \"↑\"\r\n   minimizedY--\r\n  minimizedX = math.Clamp(minimizedX,0,screen.w-5)\r\n  minimizedY = math.Clamp(minimizedY,0,screen.h-3)\r\n :\r\n  ?button.text = \"←\"\r\n   calculatorX--\r\n  ?button.text = \"→\"\r\n   calculatorX++\r\n  ?button.text = \"↓\"\r\n   calculatorY++\r\n  ?button.text = \"↑\"\r\n   calculatorY--\r\n  calculatorX = math.Clamp(calculatorX,0,screen.w-19)\r\n  calculatorY =  math.Clamp(calculatorY,0,screen.h-22)\r\n storage.Set(\"MinimizedX\", minimizedX)\r\n storage.Set(\"MinimizedY\", minimizedY)\r\n storage.Set(\"CalculatorX\", calculatorX)\r\n storage.Set(\"CalculatorY\", calculatorY)\r\n\r\nfunc placementX(button)\r\n ?minimizedFlag\r\n  minimizedX = minimizedX*10+int.Parse(button.text)\r\n :\r\n  calculatorX = calculatorX*10+int.Parse(button.text)\r\n\r\nfunc placementY(button)\r\n ?minimizedFlag\r\n  minimizedY = minimizedY*10+int.Parse(button.text)\r\n :\r\n  calculatorY = calculatorY*10+int.Parse(button.text)\r\nfunc hideButton(button)\r\n button.x = 99\r\n button.y = 99\r\n\r\nfunc showButton(button,x,y,w,h)\r\n button.x = x\r\n button.y = y\r\n button.w = w\r\n button.h = h\r\n\r\n?minimizedFlag\r\n printMinimizedIcon()\r\n:\r\n ?sizeFlag = 0\r\n  printCalculatorBig()\r\n :?sizeFlag = 1\r\n  printCalculatorMedium()\r\n :?sizeFlag = 2\r\n  printCalculatorSmall()\r\n?optionsFlag\r\n >`@optionsX@,@optionsY@,@options@\r\n ?colorChanged\r\n  ?menuName = \"Border color\"\r\n   calculatorColor = selectedColor\r\n   storage.Set(\"CalculatorColor\", calculatorColor)\r\n  :?menuName = \"Screen color\"\r\n   calculatorScreenColor = selectedColor\r\n   storage.Set(\"CalculatorScreenColor\", calculatorScreenColor)\r\n  :?menuName = \"Screen text color\"\r\n   calculatorTextColor = selectedColor\r\n   storage.Set(\"CalculatorTextColor\", calculatorTextColor)\r\n  :?menuName = \"Button color\"\r\n   calculatorButtonColor = selectedColor\r\n   storage.Set(\"CalculatorButtonColor\", calculatorButtonColor)\r\n  :?menuName = \"Button text color\"\r\n   calculatorKeyboardColor = selectedColor\r\n   storage.Set(\"CalculatorKeyboardColor\", calculatorKeyboardColor)\r\n  :?menuName = \"Minimized color\"\r\n   minimizedColor = selectedColor\r\n   storage.Set(\"MinimizedColor\", minimizedColor)\r\n  :?menuName = \"Minimized icon color\"\r\n   minimizedIconColor = selectedColor\r\n   storage.Set(\"MinimizedIconColor\", minimizedIconColor)\r\n  :?menuName = \"Background color\"\r\n   calculatorScreenBgColor = selectedColor\r\n   storage.Set(\"CalculatorScreenBgColor\", calculatorScreenBgColor)\r\n  colorChanged = false\r\n ?optionsColorFlag\r\n  >`@optionsX@,@optionsY@,@optionsColor@\r\n  >`@optionsX+2@,@optionsY+3@,@menuName@\r\n  >`@optionsX+7@,@optionsY+10@,@selectedColor@\r\n  >`@optionsX+2@,@optionsY+7@,█\r\n  >`@optionsX+5@,@optionsY+7@,#cyan,█\r\n  >`@optionsX+8@,@optionsY+7@,#yellow,█\r\n  >`@optionsX+11@,@optionsY+7@,#green,█\r\n  >`@optionsX+14@,@optionsY+7@,#blue,█\r\n  >`@optionsX+17@,@optionsY+7@,#red,█\r\n  >`@optionsX+20@,@optionsY+7@,#202020,█\r\n  ?hexFlag & string.Size(selectedColor) = 7\r\n   hexFlag = false\r\n   colorChanged = true\r\n ?optionsPlaceFlag\r\n  >`@optionsX@,@optionsY@,@optionsPlace@\r\n  >`@optionsX+2@,@optionsY+3@,@menuName@\r\n  ?minimizedFlag\r\n   >`@optionsX+6@,@optionsY+5@,@minimizedX@\r\n   >`@optionsX+15@,@optionsY+5@,@minimizedY@\r\n   >`@optionsX+6@,@optionsY+10@,@minimizedX@\r\n   >`@optionsX+6@,@optionsY+13@,@minimizedY@\r\n  :\r\n   >`@optionsX+6@,@optionsY+5@,@calculatorX@\r\n   >`@optionsX+15@,@optionsY+5@,@calculatorY@\r\n   >`@optionsX+6@,@optionsY+10@,@calculatorX@\r\n   >`@optionsX+6@,@optionsY+13@,@calculatorY@"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/MindstoneButton.txt" - Parse error: Failed to parse completely. Remaining: "= [\r\n\"waterfall\",\r\n\"undead_crypt_intro\"]\r\n\r\nvar alevels =  [\r\n\"rocky_plateau\",\r\n\"deadwood_valley\",\r\n\"caustic_caves\", \r\n\"fungus_forest\",\r\n\"undead_crypt\",\r\n\"bronze_mine\", \r\n\"icy_ridge\", \r\n\"temple\"]\r\n\r\nvar adisabled = [\r\n\"mushroom_shop\",\r\n\"uulaa_shop\",\r\n\"cross_deadwood_river\",\r\n\"bronze_gate\",\r\n\"cross_bridge\"]\r\n\r\n\r\n//*******************************\r\n// Function Calls\r\n//*******************************\r\n\r\nvar button \r\n?totaltime=1\r\n  button = DrawMindstoneButton()\r\n  Display(level,scene,quest,unknown)\r\n//\r\n\r\n//*******************************\r\n// Functions\r\n//*******************************\r\n\r\n//*******************************\r\n// DrawMindstoneButton()\r\n//\r\n// Draws Mindstone button as a\r\n// parent panel holding the ascii\r\n// art and interactive button\r\n//\r\n//*******************************\r\nfunc DrawMindstoneButton()\r\n\r\n    var p = ui.AddPanel()\r\n    p.anchor = buttonanchor\r\n    p.dock = buttondock\r\n    p.visible = false\r\n    p.color = #888888\r\n    p.style = 1\r\n    p.w = 8\r\n    p.h = 5\r\n    p.x = buttonx\r\n    p.y = buttony\r\n\r\n    var b = ui.AddButton()\r\n    b.anchor = center_center\r\n    b.dock = center_center\r\n    b.visible = inherit\r\n    b.style = 1\r\n    b.text = “”\r\n    b.w = 8\r\n    b.h = 5\r\n    b.SetPressed(BtnPressed)\r\n    p.Add(b)\r\n\r\n    var a = ui.AddAnim(mindart)\r\n    a.anchor = center_center\r\n    a.dock = center_center\r\n    a.visible = inherit\r\n    a.color = #white\r\n    p.Add(a)\r\n\r\n    // Only displays text on PC\r\n    // to match other buttons\r\n    ?sys.isPC\r\n      var t = ui.AddText()\r\n      t.anchor = bottom_right\r\n      t.dock = bottom_right\r\n      t.visible = inherit\r\n      t.color = #888888\r\n      t.text = \"[M]\"\r\n      t.w = 3\r\n      t.h = 1\r\n      t.x = -1\r\n      p.Add(t)\r\n\r\n  return p\r\n//\r\n    \r\n\r\n//*******************************\r\n// BtnPressed()\r\n//\r\n// Intermediary function to\r\n// properly call Mindstone\r\n// function\r\n//*******************************\r\nfunc BtnPressed()\r\n  ui.OpenMind()\r\n\r\n\r\n//*******************************\r\n// SetXY(x,y)\r\n//\r\n// Allows repositioning of \r\n// Mindstone Button after \r\n// initial creation\r\n//\r\n// x: Distance from left side \r\n//    of the screen to the \r\n//    left side of the button\r\n//\r\n// y: Distance from top of the\r\n//    screen to the top of the\r\n//    button\r\n//\r\n//*******************************\r\nfunc SetXY(x,y)\r\n  button.x = x\r\n  button.y = y\r\n//\r\n\r\n\r\n//*******************************\r\n// Display(levels,scenery,\r\n//        ^quests,unknown)\r\n//\r\n// Determines when to display the\r\n// Mindstone Button based on the\r\n// level type, if a quest is \r\n// active, or if the level is \r\n// new. Hides the button \r\n// automatically on levels that \r\n// run stonescript but don't \r\n// allow use of the mindstone\r\n// (e.g. Uulaa's Hotspring Shop)\r\n//\r\n// levels:  Controls display of \r\n//          button on the \r\n//          following levels:\r\n//          - rocky_plateau \r\n//          - deadwood_valley\r\n//          - caustic_caves \r\n//          - fungus_forest \r\n//          - undead_crypt \r\n//          - bronze_mine \r\n//          - icy_ridge\r\n//          - temple\r\n// true:    Displays button\r\n// false:   Hides button\r\n//\r\n// scenery: Controls display of \r\n//          button on the\r\n//          following levels:\r\n//          - waterfall\r\n//          - undead_crypt_intro\r\n// true:    Displays button\r\n// false:   Hides button\r\n//\r\n// quests:  Controls display of\r\n//          button during active\r\n//          quests\r\n// true:    Displays button\r\n// false:   Hides Button\r\n// \r\n// unknown: Controls display of\r\n//          button during levels\r\n//          that aren't in the\r\n//          game as of release\r\n//          of this code. \r\n//          (Included as stop-\r\n//          gap feature for \r\n//          future game updates)\r\n// true:    Displays button\r\n// false:   Hides Button\r\n//\r\n//*******************************\r\nfunc Display(levels,scenery,\r\n            ^quests,unknown)\r\n\r\n  ?!quests & loc.isquest\r\n    button.visible = false\r\n    return\r\n\r\n  var lvl = loc.id\r\n\r\n  ?ascenery.Contains(lvl)\r\n    lvl = 1 //Scenery\r\n  :?alevels.Contains(lvl)\r\n    lvl = 2 //Levels\r\n  :?adisabled.Contains(lvl)\r\n    lvl = 3 //loc where unable to \r\n            //use Mindstone\r\n  :\r\n    lvl = 4 //Unknown/new levels\r\n\r\n  ?scenery & lvl = 1\r\n    button.visible = true\r\n  :?levels & lvl = 2\r\n    button.visible = true\r\n  :?unknown & lvl = 4\r\n    button.visible = true\r\n  :\r\n    button.visible = false\r\n//\r\n\r\n//*******************************\r\n// End of File\r\n//*******************************\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/BossHealthBar.txt" - Parse error: Failed to parse completely. Remaining: "= \"#F00\"\r\nvar phaseTwoColor = \"#00F\"\r\nvar phaseThreeColor =\"#0F0\"\r\nvar armorColor = \"#888\"\r\nvar noColor = \"#444\"\r\nvar delay = 30\r\n\r\n//code variables\r\nvar percent\r\nvar startup\r\nvar healthColor\r\nvar emptyColor\r\nvar bossCount\r\nvar foeValue\r\nvar foeMaxValue\r\n\r\n//performance variables\r\nvar begin_ = true\r\nvar foe_\r\nvar foeHp_\r\nvar foeMaxHp_\r\nvar foeArmor_\r\nvar foeMaxArmor_\r\nvar time_\r\nvar screenW_ = screen.w\r\nfoe_ = foe\r\nfoeHp_ = foe.hp\r\nfoeMaxHp_ = foe.maxhp\r\nfoeArmor_ = foe.armor\r\nfoeMaxArmor_ = foe.maxarmor\r\n\r\n//store the amount of bosses in the loc\r\n?begin_\r\n    ?loc = caves|loc = mine|loc = ridge|loc = temple\r\n        bossCount = 1\r\n    :?loc = forest|loc = halls\r\n        ?loc.stars = 3\r\n            bossCount = 1\r\n        :\r\n            bossCount = 2\r\n    :?loc = canyon\r\n        ?loc.stars < 6\r\n            bossCount = 1\r\n        :\r\n            bossCount = 2\r\n    :\r\n        ?loc.stars = 3\r\n            bossCount = 1\r\n        :?loc.stars = 4\r\n            bossCount = 2\r\n        :\r\n            bossCount = 3\r\n    begin_ = false\r\n\r\n//main function\r\nfunc Draw()\r\n    ?foe_ = phase\r\n        time_ = totaltime\r\n        ?foeArmor_ > 0\r\n            foeValue = foeArmor_\r\n            foeMaxValue = foeMaxArmor_\r\n            ?foe_ = phase1\r\n                healthColor = armorColor\r\n                emptyColor = phaseOneColor\r\n            :?foe_ = phase2\r\n                healthColor = armorColor\r\n                emptyColor = phaseTwoColor\r\n            :\r\n                healthColor = armorColor\r\n                emptyColor = phaseThreeColor\r\n        :\r\n            foeValue = foeHp_\r\n            foeMaxValue = foeMaxHp_\r\n            ?foe_ = phase1\r\n                healthColor = phaseOneColor\r\n                ?bossCount > 1\r\n                    emptyColor = phaseTwoColor\r\n                :\r\n                    emptyColor = noColor\r\n            :?foe_ = phase2\r\n                healthColor = phaseTwoColor\r\n                ?bossCount > 2\r\n                    emptyColor = phaseThreeColor\r\n                :\r\n                    emptyColor = noColor\r\n            :\r\n                healthColor = phaseThreeColor\r\n                emptyColor = noColor\r\n        ?foeValue*delay < (time_-startup)*foeMaxValue\r\n            percent = 1.0*foeValue/foeMaxValue\r\n            draw.Bg(offset, 1, emptyColor, screenW_-2*offset, 2)\r\n            draw.Bg(offset, 1, healthColor, math.FloorToInt((screenW_-2*offset)*percent), 2)\r\n            ?foeValue ! foeMaxValue & 0 < foeValue\r\n                draw.Bg(offset+math.FloorToInt((screenW_-2*offset)*percent), 1, color.Lerp(emptyColor, healthColor, ((screenW_-2*offset)*percent)%1.0), 1, 2)\r\n            for i = offset..screenW_-offset\r\n                >`@i@,1, \r\n                >`@i@,2, \r\n            >`@offset@,1,@string.Break(foe.name, screenW_-2*offset)[0]@\r\n            ?foeArmor_ > 0\r\n                >`@offset@,2,@foeHp_@/@foeMaxHp_@[@foeArmor_@/@foeMaxArmor_@]\r\n            :\r\n                >`@offset@,2,@foeHp_@/@foeMaxHp_@\r\n        :\r\n            percent = 1.0*(time_-startup)/delay\r\n            draw.Bg(offset, 1, noColor, screenW_-2*offset, 2)\r\n            draw.Bg(offset, 1, healthColor, math.FloorToInt((screenW_-2*offset)*percent), 2)\r\n            ?foeValue ! foeMaxValue & 0 < foeValue\r\n                draw.Bg(offset+math.FloorToInt((screenW_-2*offset)*percent), 1, color.Lerp(noColor, healthColor, ((screenW_-2*offset)*percent)%1.0), 1, 2)\r\n            for i = offset..screenW_-offset\r\n                >`@i@,1, \r\n                >`@i@,2, \r\n            >`@offset@,1,@string.Break(foe.name, screenW_-2*offset)[0]@\r\n            ?foeArmor_ > 0\r\n                >`@offset@,2,@foeHp_@/@foeMaxHp_@[@foeArmor_@/@foeMaxArmor_@]\r\n            :\r\n                >`@offset@,2,@foeHp_@/@foeMaxHp_@\r\n    :\r\n        startup = totaltime\r\nDraw()"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/ChiselFiles/SetLayer.txt" - Parse error: Failed to parse completely. Remaining: "= \"############################################################################\"\r\nvar String\r\nvar Width =  screen.w - 38\r\n\r\nfunc CanvasStartUp()\r\n  String = \"\"\r\n  TextList = []\r\n  for a = 1..screen.h - 2\r\n    TextList.Add(string.Sub(CanvasBlankTextLine,0,Width))\r\n  return CanvasLineAdder()\r\n\r\nfunc CanvasLineAdder()\r\n  String = \"\"\r\n  for a : TextList\r\n    String += a+\"\\n\"\r\n  return String\r\n\r\nvar TextUI = ui.AddText(CanvasStartUp())\r\nTextUI.w = screen.w - 38\r\nTextUI.y = -10\r\nTextUI.align = center\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Foes/FlowerFoes.txt" - Parse error: Failed to parse completely. Remaining: "?foe=＂huge snail＂\r\n    >f3,0,@Snail@\r\n  :?foe=＂big a** snail＂\r\n    >f2,0,@BigSnail@\r\n  :?foe=＂ant hill＂\r\n    >f-4,1,#a9a9a9,@AntHill@\r\n  :?foe=＂ant＂\r\n    >f0,1,@Ant@\r\n//Colored\\\\\r\nvar snail1=ascii\r\n#\r\n#),(,\r\n#(_#)/\r\n###\\(\r\nasciiend\r\nvar snail2=ascii\r\n*###*\r\n######*\r\n###*\r\nasciiend\r\n\r\nvar bigsnail1=ascii\r\n#\r\n#####(\r\n##)###)\r\n#(`#_/`#.\r\n##\\/#\\_/\r\n##/##´\r\nasciiend\r\nvar bigsnail2=ascii\r\n######*\r\n#*\r\n#\r\n###*#####*\r\nasciiend\r\n\r\nvar Ant=ascii\r\n####*\r\n*\r\nasciiend\r\n\r\nvar anthill1=ascii\r\n#\r\n###(,\r\n####)#_)\r\n#(#/#(#`\r\n##V###\\\r\nasciiend\r\nvar anthill2=ascii\r\n####*\r\n######*\r\n##*\r\nasciiend\r\n?colored\r\n  ?foe=＂huge snail＂\r\n    >f3,0,#green,@snail1@\r\n    >f3,0,#magenta,@snail2@\r\n  :?foe=＂big a** snail＂\r\n    >f2,0,#green,@bigsnail1@\r\n    >f2,0,#magenta,@bigsnail2@\r\n  :?foe=＂ant hill＂\r\n    >f-4,1,#green,@anthill1@\r\n    >f-4,1,#magenta,@anthill2@\r\n  :?foe=＂ant＂\r\n    >f0,1,#magenta,@Ant@"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Foes/PallasCrown.txt" - Parse error: Failed to parse completely. Remaining: "?leftSways = rightSways\r\n  leftSways = 0\r\n  rightSways = 0\r\n\r\nfunc ResetCrown()\r\n crownBaseY = -24\r\n crownJewelsY = -22\r\n crownLiningY = -21\r\n crownFalling = 0\r\n crownNoisePlayed = 0\r\n\r\nvar leftBooo1 = ascii\r\n####.-.\r\n###(- -) \r\n###\\ ‾ `-´\r\n####) /\r\n####|/\r\n####'\r\nasciiend\r\n\r\nvar leftBooo2 = ascii\r\n####.-.\r\n###(> <) \r\n###\\ ‾ `-´\r\n####\\ /\r\n####'/\r\n####!\r\nasciiend\r\n\r\nvar rightBooo1 = ascii\r\n###.-.\r\n##(- -) \r\n`-´ ‾ /\r\n###\\ (\r\n####\\|\r\n#####'\r\nasciiend\r\n\r\nvar rightBooo2 = ascii\r\n###.-.\r\n##(> <) \r\n`-´ ‾ /\r\n###\\ /\r\n####\\'\r\n#####!\r\nasciiend\r\n\r\nvar leftBoooSweat1 = \"°·\"\r\nvar leftBoooSweat2 = \"`#\"\r\nvar leftBoooSweat3 = \"#.\"\r\nvar leftBoooSweat4 = \"·´\"\r\n\r\nvar rightBoooSweat1 = \"·°\"\r\nvar rightBoooSweat2 = \"#´\"\r\nvar rightBoooSweat3 = \".#\"\r\nvar rightBoooSweat4 = \".`\"\r\n\r\nvar crownBase = ascii\r\n,####†####,\r\n\\\\_,/ \\,_//\r\n#\\_∞_☼_∞_/\r\n(…÷…÷…÷…÷…)\r\n#‾‾‾‾‾‾‾‾‾\r\nasciiend\r\n\r\nvar crownJewels = ascii\r\n###∞#☼#∞\r\nasciiend\r\n\r\nvar crownLining = ascii\r\n(…÷…÷…÷…÷…)\r\nasciiend\r\n\r\nfunc Descend()\r\n ?crownFalling = 0\r\n  ?currentModulo = 0\r\n   ?leftBoooY < -5\r\n    leftBoooY++\r\n   ?rightBoooY < -5\r\n    rightBoooY++\r\n   ?leftBoooSweatY < -5\r\n    leftBoooSweatY++\r\n   ?rightBoooSweatY < -5\r\n    rightBoooSweatY++\r\n   ?crownBaseY < -7\r\n    crownBaseY++\r\n   ?crownJewelsY < -5\r\n    crownJewelsY++\r\n   ?crownLiningY < -4\r\n    crownLiningY++\r\n ?crownFalling = 1\r\n  ?time % 2 = 0\r\n   ?crownBaseY < 5\r\n    crownBaseY++\r\n   ?crownJewelsY < 7\r\n    crownJewelsY++\r\n   ?crownLiningY < 8\r\n    crownLiningY++\r\n\r\nfunc PlayCrownNoise()\r\n play perfected_defense\r\n crownNoisePlayed = 1\r\n\r\nfunc SwayLeft()\r\n leftBoooX--\r\n rightBoooX--\r\n leftBoooSweatX--\r\n rightBoooSweatX--\r\n crownBaseX--\r\n crownJewelsX--\r\n crownLiningX--\r\n leftSways++\r\n\r\nfunc SwayRight()\r\n leftBoooX++\r\n rightBoooX++\r\n leftBoooSweatX++\r\n rightBoooSweatX++\r\n crownBaseX++\r\n crownJewelsX++\r\n crownLiningX++\r\n rightSways++\r\n \r\nfunc Sway()\r\n ?currentModulo = 0\r\n  ?crownFalling = 0\r\n   ?leftSways < rightSways\r\n    SwayLeft()\r\n   :\r\n    SwayRight()\r\n  \r\nfunc DrawBooos()\r\n ?time % 8 = 0\r\n  leftBooo = leftBooo1\r\n  rightBooo = rightBooo1\r\n ?time % 5 = 0\r\n  leftBooo = leftBooo2\r\n  rightBooo = rightBooo2\r\n >c@leftBoooX@,@leftBoooY@,#5a5a5a,@leftBooo@\r\n >c@rightBoooX@,@rightBoooY@,#5a5a5a,@rightBooo@\r\n\r\nfunc DrawSweat()\r\n ?currentModulo < 2\r\n  leftBoooSweat = leftBoooSweat1\r\n  rightBoooSweat = rightBoooSweat1\r\n ?currentModulo > 1 & currentModulo < 5\r\n  leftBoooSweat = leftBoooSweat2\r\n  rightBoooSweat = rightBoooSweat2\r\n ?currentModulo > 4 & currentModulo < 8\r\n  leftBoooSweat = leftBoooSweat3\r\n  rightBoooSweat = rightBoooSweat3\r\n ?currentModulo > 7\r\n  leftBoooSweat = leftBoooSweat4\r\n  rightBoooSweat = rightBoooSweat4\r\n >c@leftBoooSweatX@,@leftBoooSweatY@,#ffffff,@leftBoooSweat@\r\n >c@rightBoooSweatX@,@rightBoooSweatY@,#ffffff,@rightBoooSweat@\r\n \r\nfunc DrawCrown()\r\n >c@crownBaseX@,@crownBaseY@,#ffca00,@crownBase@\r\n >c@crownJewelsX@,@crownJewelsY@,#ff0a00,@crownJewels@\r\n >c@crownLiningX@,@crownLiningY@,#ffffff,@crownLining@\r\n\r\n// start the objects at the top edge of the screen\r\n// and track whether we've reached Pallas stage 2\r\n?loc = undead_crypt\r\n ?loc.begin\r\n  ResetBooos()\r\n  ResetCrown()\r\n ?loc.loop\r\n  ResetBooos()\r\n  ResetCrown()\r\n  inStageTwo = 0\r\n ?foe = pallas & foe = stage_2\r\n  inStageTwo = 1\r\n\r\n// once we've reached stage 2, activate\r\n?inStageTwo = 1\r\n currentModulo = time % 5\r\n ?crownFalling = 0\r\n  Sway()\r\n  Descend()\r\n  DrawBooos()\r\n  DrawSweat()\r\n  DrawCrown()\r\n ?crownFalling = 1\r\n  Descend()\r\n  DrawCrown()\r\n  ?crownNoisePlayed = 0\r\n   PlayCrownNoise()\r\n ?foe.count = 0\r\n  ResetBooos()\r\n  crownFalling = 1"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Foes/PumpkinWraith.txt" - Parse error: Failed to parse completely. Remaining: "= #yellow //eyes, mouth\r\nstemColor = #706020 //little stem on top - brown by default\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1\r\nvar currentState = stateNone\r\nvar stateTime = 0\r\n\r\nfunc SetState(newState)\r\n  currentState = newState\r\n  stateTime = 0\r\n  SetState(stateIdle)\r\n\r\nstateTime++\r\n\r\n//set flickering for eyes and mouth based on stateTime\r\n?stateTime % 2 = 0\r\n\tlightColor = #yellow\r\n:\r\n\tlightColor = #white\r\n\r\n//draw pumpkin-----------------------------\r\n?foe = acronian_cultist\r\n  >o@foe.distance - 1@,@-5@,@#CC9020@,ascii\r\n   ,^..   \r\n ,´^,,^`. \r\n(( `vvv'))\r\n ` `^^^'´\r\nasciiend\r\n  >o@foe.distance - 1@,@-5@,@lightColor@,ascii\r\n#\r\n###^..^\r\n###`vvv´\r\n###'^^^'\r\nasciiend\r\n  >o@foe.distance - 1@,@-5@,@stemColor@,ascii\r\n###,^.  \r\n#\r\n#\r\n#\r\nasciiend\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Foes/SurferGuardian.txt" - Parse error: Failed to parse completely. Remaining: "?foe = \"guardian\"\r\n  ?Init\r\n    Init = false\r\n    GuardianWalk = ui.AddAnim(GuardianASCII)\r\n    GuardianWalk.duration = 60\r\n    GuardianWalk.loop = true\r\n    GuardianWalk.gamePause = true\r\n    GuardianWalk.y = -1\r\n    GuardianWalk.Play()\r\n\r\n  ?foe.state = 1\r\n    GuardianPos = 67 - (foe.time)/6\r\n  :\r\n    GuardianWalk.Pause()\r\n  GuardianWalk.x = GuardianPos\r\n\r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/CavePets.txt" - Parse error: Failed to parse completely. Remaining: ":\r\n biterWaitAnim.visible = true \r\n biterWalkAnim.visible = false\r\n biterWaitAnim.x = screen.FromWorldX(pos.x)-3\r\n biterWaitAnim.y = screen.FromWorldZ(pos.z)+2\r\n\r\n\r\n?loc.begin\r\n  peelerWalkAnim = ui.AddAnim(ascii\r\n#####_###\r\n####( )_#\r\n,´`∞<'|#)\r\n######'##\r\n%%\r\n#####_##\r\n###_( )#\r\n#/'∞`´\\)\r\n´######`\r\n%%\r\n#####_##\r\n####( )#\r\n#|`(`^´|\r\n#'#####'\r\n%%\r\n#####_###\r\n####( )##\r\n#(`∞/<´\\#\r\n##`´####`\r\n%%\r\n#####_####\r\n####( )###\r\n#<;∞|/#`.#\r\n####'####`\r\n%%\r\n#####_####\r\n#_##( )#_#\r\n'#`∞(|#`#'\r\n#####`####\r\nasciiend)\r\n  peelerWaitAnim = ui.AddAnim(ascii\r\n#####_###\r\n####( )##\r\n#/`∞|´\\\\#\r\n´###'##``\r\n%%\r\n#####_###\r\n####( )##\r\n#/`∞|´\\\\#\r\n´###'##``\r\n%%\r\n#####_###\r\n####( )##\r\n#/`∞|´\\\\#\r\n´###'##``\r\n%%\r\n#####_###\r\n####( )##\r\n#/`-|´\\\\#\r\n´###'##``\r\nasciiend)\r\n  peelerWalkAnim.visible = false\r\n  peelerWalkAnim.duration = 21\r\n  peelerWalkAnim.loop = true\r\n  peelerWalkAnim.Play()\r\n  peelerWalkAnim.flipX = true\r\n  peelerWalkAnim.dock = top_left\r\n\r\n  peelerWaitAnim.visible = false\r\n  peelerWaitAnim.duration = 60\r\n  peelerWaitAnim.loop = true\r\n  peelerWaitAnim.Play()\r\n  peelerWaitAnim.flipX = true\r\n  peelerWaitAnim.dock = top_left\r\n?ai.walking = true\r\n peelerWaitAnim.visible = false\r\n peelerWalkAnim.visible = true\r\n peelerWalkAnim.x = screen.FromWorldX(pos.x)+1\r\n peelerWalkAnim.y = screen.FromWorldZ(pos.z)-2\r\n:\r\n peelerWaitAnim.visible = true \r\n peelerWalkAnim.visible = false\r\n peelerWaitAnim.x = screen.FromWorldX(pos.x)+1\r\n peelerWaitAnim.y = screen.FromWorldZ(pos.z)-2\r\n\r\n\r\n?loc.begin\r\n  chopperWalkAnim = ui.AddAnim(ascii\r\n########___#\r\n######()`-.\\\r\n#,--.#_`__(/\r\n'´¯¯'-.<`(´|\r\n#_,-- /####'\r\n#¯¯¯´¯######\r\n%%\r\n########___##\r\n######()`-.\\#\r\n#,--.#_`__(/#\r\n'´¯¯'-./<#´\\#\r\n#_,-- /`####`\r\n#¯¯¯´¯#######\r\n%%\r\n########___#\r\n######()`-.\\\r\n#,--.#_`__(/\r\n'´¯¯'∞.|/-´)\r\n#_,-- /'####\r\n#¯¯¯´¯######\r\n%%\r\n########___#\r\n######()`-.\\\r\n#,--.#_`__(/\r\n'´¯¯'∞.,\\|^#\r\n#_,-- /##＂##\r\n#¯¯¯´¯######\r\n%%\r\n########___#\r\n######()`-.\\\r\n#,--.#_`__(/\r\n'´¯¯'∞.,^\\(#\r\n#_,-- /###``\r\n#¯¯¯´¯######\r\n%%\r\n########___#\r\n######()`-.\\\r\n#,--.#_`__(/\r\n'´¯¯'∞.<`(´|\r\n#_,-- /####'\r\n#¯¯¯´¯######\r\n%%\r\n########___##\r\n######()`-.\\#\r\n#,--.#_`__(/#\r\n'´¯¯'∞./<#´\\#\r\n#_,-- /`####`\r\n#¯¯¯´¯#######\r\n%%\r\n####### ___#\r\n######()`-.\\\r\n#,--.#_`__(/\r\n'´¯¯'∞.|/-´)\r\n#_,-- /'####\r\n#¯¯¯´¯######\r\n%%\r\n########___#\r\n######()`-.\\\r\n#,--.#_`__(/\r\n'´¯¯'∞.,\\|^#\r\n#_,-- /##＂##\r\n#¯¯¯´¯######\r\n%%\r\n########___#\r\n######()`-.\\\r\n#,--.#_`__(/\r\n'´¯¯'∞.,^\\(#\r\n#_,-- /###``\r\n#¯¯¯´¯######\r\nasciiend)\r\n  chopperWaitAnim = ui.AddAnim(ascii\r\n########___##\r\n######()`-.\\#\r\n#,--.#_`__(/#\r\n'´¯¯'∞.,)´)\\#\r\n#_,-- /#`#`#`\r\n#¯¯¯´¯#######\r\n%%\r\n########___##\r\n######()`-.\\#\r\n#,--.#_`__(/#\r\n'´¯¯'∞.,)´)\\#\r\n#_,-- /#`#`#`\r\n#¯¯¯´¯#######\r\n%%\r\n########___##\r\n######()`-.\\#\r\n#,--.#_`__(/#\r\n'´¯¯'∞.,)´)\\#\r\n#_,-- /#`#`#`\r\n#¯¯¯´¯#######\r\n%%\r\n########___##\r\n######()`-.\\#\r\n#,--.#_`__(/#\r\n'´¯¯'-.,)´)\\#\r\n#_,-- /#`#`#`\r\n#¯¯¯´¯#######\r\nasciiend)\r\n  chopperWalkAnim.visible = false\r\n  chopperWalkAnim.duration = 30\r\n  chopperWalkAnim.loop = true\r\n  chopperWalkAnim.Play()\r\n  chopperWalkAnim.flipX = true\r\n  chopperWalkAnim.dock = top_left\r\n\r\n  chopperWaitAnim.visible = false\r\n  chopperWaitAnim.duration = 50\r\n  chopperWaitAnim.loop = true\r\n  chopperWaitAnim.Play()\r\n  chopperWaitAnim.flipX = true\r\n  chopperWaitAnim.dock = top_left\r\n?ai.walking = true\r\n chopperWaitAnim.visible = false\r\n chopperWalkAnim.visible = true\r\n chopperWalkAnim.x = screen.FromWorldX(pos.x)-7\r\n chopperWalkAnim.y = screen.FromWorldZ(pos.z)\r\n:\r\n chopperWaitAnim.visible = true \r\n chopperWalkAnim.visible = false\r\n chopperWaitAnim.x = screen.FromWorldX(pos.x)-7\r\n chopperWaitAnim.y = screen.FromWorldZ(pos.z)"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Bunny.txt" - Parse error: Failed to parse completely. Remaining: "= #white\r\n\r\nvar keepDistance = -20\r\nvar maxX = -12\r\n\r\nvar maxDistance\r\nmaxDistance = -80\r\n\r\nvar targetZ = -1\r\n\r\nvar x = 0\r\nvar y = 0\r\nvar myX = 0\r\nvar myZ = 0\r\nvar lastPlayerX = 0\r\nvar lastPlayerZ = 0\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1\r\nvar stateJump = 2\r\nvar currentState = stateNone\r\nvar stateTime = 0\r\n\r\n\r\nfunc SetState(newState)\r\n  ?newState = stateJump\r\n    play open_note 400\r\n\r\n  currentState = newState\r\n  stateTime = 0\r\n\r\n\r\n?currentState = stateNone | time = 1\r\n  lastPlayerX = pos.x\r\n  lastPlayerZ = pos.z\r\n  myX = keepDistance\r\n  myZ = targetZ\r\n\r\n \r\n  ?time > 1\r\n    myX = maxDistance\r\n\r\n  SetState(stateIdle)\r\n\r\n\r\nmyX = myX - (pos.x - lastPlayerX)\r\n\r\nstateTime++\r\n\r\n?currentState = stateIdle\r\n  ?myX < maxDistance | myX > -maxDistance\r\n    myX = maxDistance\r\n  myZ = myZ - (pos.z - lastPlayerZ)\r\n\r\n  ?myX < keepDistance\r\n    SetState(stateJump)\r\n\r\n:?currentState = stateJump\r\n  ?myX < maxX\r\n    myX++\r\n\r\n  ?stateTime >= 9\r\n    ?myZ > targetZ\r\n      myZ--\r\n    :?myZ < targetZ\r\n      myZ++\r\n\r\n  ?stateTime >= 16\r\n    SetState(stateIdle)\r\n\r\n\r\nlastPlayerX = pos.x\r\nlastPlayerZ = pos.z\r\n\r\n// Draw\r\n\r\n?currentState = stateIdle\r\n  >o@myX@,@myZ@,@rabbitColor@,ascii\r\n#\r\n#\r\n######\\\\\r\n#####__()\r\n###α(_-\\\r\nasciiend\r\n\r\n  ?face = ＂°°＂\r\n    ?time % 4 <= 1\r\n      >o@myX@,@myZ@,@rabbitColor@,ascii\r\n#\r\n#\r\n###### ||\r\nasciiend\r\n    ?time % 4 > 1\r\n      >o@myX@,@myZ@,@rabbitColor@,ascii\r\n#\r\n#\r\n###### ((\r\nasciiend\r\n  \r\n?currentState = stateJump\r\n  ?stateTime/2 = 0\r\n    >o@myX@,@myZ@,@rabbitColor@,ascii\r\n#\r\n#\r\n#\r\n#####_\\\\\r\n###α(_.()\r\nasciiend\r\n\r\n  :?stateTime/2 = 1\r\n    >o@myX@,@myZ@,@rabbitColor@,ascii\r\n#\r\n#\r\n#######_\r\n#####_‾()\r\n###α(_-/\r\nasciiend\r\n\r\n  :?stateTime/2 = 2\r\n    >o@myX@,@myZ@,@rabbitColor@,ascii\r\n#######_\r\n######‾()\r\n#####/´)\r\n###α(_\r\nasciiend\r\n\r\n  :?stateTime/2 = 3\r\n    >o@myX@,@myZ@,@rabbitColor@,ascii\r\n######\\\\\r\n#####__()\r\n###α( -\\\r\n#####)\r\nasciiend\r\n\r\n  :?stateTime/2 = 4\r\n    >o@myX@,@myZ@,@rabbitColor@,ascii\r\n######((\r\n#####__()\r\n###α(_-‾'\r\n#####\r\nasciiend\r\n\r\n  :?stateTime/2 = 5\r\n    >o@myX@,@myZ@,@rabbitColor@,ascii\r\n#\r\n#\r\n#####__((\r\n###α(_-.()\r\n########‾'\r\nasciiend\r\n\r\n  :?stateTime/2 = 6\r\n    >o@myX@,@myZ@,@rabbitColor@,ascii\r\n#\r\n#\r\n#####_\r\n###α( \\\\\r\n#####\\.()\r\nasciiend\r\n\r\n  :?stateTime/2 = 7\r\n    >o@myX@,@myZ@,@rabbitColor@,ascii\r\n#\r\n#\r\n#\r\n####_\\\\\r\n##α(_.()\r\nasciiend\r\n\r\n  :?stateTime/2 = 8\r\n    >o@myX@,@myZ@,@rabbitColor@,ascii\r\n#\r\n#\r\n#######_\r\n#####_‾()\r\n###α(_-(\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Skully.txt" - Parse error: Failed to parse completely. Remaining: "= #808080   //grey\r\n\r\n//CHOOSE YOUR CHEST---------------------------------------<\r\n//Replace with one below: bone | delta\r\nchestType = bone\r\n\r\n//CHOOSE YOUR MOVEMENT TRAIL--------------------------------<\r\n//Replace with one below: cloud | sparks | wings | chesttrail\r\ncloudType = cloud\r\n\r\n//CHOOSE YOUR AFTER-EFFECT COLOR--------------------------------<\r\ncloudColor = #808080   //grey\r\nclouderColor = #2e2e2e //grey but darker\r\nsparkColor = #white    //white\r\nsparkerColor = #808080 //grey\r\nwingColor = #yellow\r\nchesttrailColor = #white\r\nchesttrailerColor = #808080\r\n\r\n?chestType = bone\r\n  chestColor = #white\r\n:?chestType = delta\r\n  chestColor = #rainbow\r\n\r\nvar keepDistance = -26 // distance at which the movement animation will play (stateMoving)\r\nvar maxX = -16         // closest offset pet will get to character.  Closer to 0, closer to character\r\nvar maxDistance = -70  // if the pet exceeds this distance, it will teleport to this distance (cannot be further away than this)\r\nvar targetZ = -1       // We want to start the drawing 1 unit above the player agent\r\n\r\n?loc.loop\r\n  keepDistance = -26\r\n  maxX = -16\r\n  maxDistance = -70\r\n  targetZ = -1\r\n\r\nvar x = 0\r\nvar y = 0\r\nvar myX = 0\r\nvar myZ = 0\r\nvar lastPlayerX = 0\r\nvar lastPlayerZ = 0\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1\r\nvar stateMoving = 2\r\nvar currentState = stateNone\r\nvar stateTime = 0\r\nvar chestTime = 0\r\n\r\n\r\nfunc SetState(newState)\r\n  ?newState = stateMoving\r\n    play haunted_gate_shuffle //play sound when moving\r\n  currentState = newState\r\n  stateTime = 0\r\n\r\n?currentState = stateNone | time = 1\r\n  lastPlayerX = pos.x\r\n  lastPlayerZ = pos.z\r\n  myX = keepDistance\r\n  myZ = targetZ\r\n\r\n// Start further away if skully is summoned while the location is already running\r\n  ?time > 1\r\n    myX = maxDistance\r\n\r\n  SetState(stateIdle)\r\n\r\nmyX = myX - (pos.x - lastPlayerX) // If player has moved, increment myX (distance from player)\r\n\r\nstateTime++\r\n\r\n?face = \"( ^^\" & stateTime > 30\r\n  chestTime++\r\n?face ! \"( ^^\"\r\n  chestTime = 0\r\n\r\n?currentState = stateIdle \r\n  ?myX < maxDistance | myX > -maxDistance\r\n    myX = maxDistance\r\n  myZ = myZ - (pos.z - lastPlayerZ)\r\n\r\n  ?myX < keepDistance\r\n    SetState(stateMoving)\r\n\t\r\n:?currentState = stateMoving\r\n  ?myX < maxX\r\n    myX++\r\n\t\r\n  ?stateTime >= 6\r\n    ?myZ > targetZ\r\n      myZ--\r\n    :?myZ < targetZ\r\n      myZ++\r\n\r\n  ?stateTime >= 12\r\n    SetState(stateIdle)\r\n\t\r\nlastPlayerX = pos.x\r\nlastPlayerZ = pos.z\r\n\r\n//DRAW state timers--------------------------------<\r\n//for debugging or whatever, uncomment if you want to see\r\n\r\n//>`0,7,StateTime = @stateTime@\r\n//>`0,8,ChestTime = @chestTime@\r\n\r\n//IDLE---------------------------------------------<\r\n\r\n?currentState = stateIdle & face ! \"( ^^\" \r\n  >o@myX@,@myZ@,@skullColor@,ascii\r\n#####\r\n#####\r\n#####\r\n#####,--.\r\n####(_o,o)\r\n######`\"´\r\nasciiend\r\n\r\n//EYES----------------------------------------<\r\n?currentState = stateIdle\r\n  ?face = \"°°\"\r\n      ?time % 10 = 0 & myX > keepDistance\r\n        myX--\r\n\r\n      ?time % 4 <= 1\r\n        >o@myX@,@myZ@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n######O,o\r\nasciiend\r\n      ?time % 4 > 1\r\n       >o@myX@,@myZ@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n######o,O\r\nasciiend\r\n\r\n//BLINKING----------------------------\r\n\r\n  ?face ! \"( ^^\"\r\n    ?stateTime % 50 >= 48\r\n        >o@myX@,@myZ@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n######=,=\r\nasciiend\r\n    :?stateTime % 50 >= 46\r\n        >o@myX@,@myZ@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n######-,-\r\nasciiend\r\n    :?stateTime % 50 >= 44\r\n        >o@myX@,@myZ@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n######=,=\r\nasciiend\r\n\r\n//CHEST ANIMATION-----------------------------------------------<\r\n\r\n  x = myX + 6\r\n  y = myZ + 4\r\n?face = \"( ^^\" \r\n    ?chestTime <= 5 | chestTime > 40\r\n      >o@myX@,@myZ@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#####,--.\r\n####(_o,o)\r\n######`\"´\r\nasciiend\r\n//-------------------------------\r\n    :?chestTime <= 10 | chestTime <= 40  & chestTime > 35\r\n      >o@myX@,@myZ@,@skullColor@,ascii\r\n#\r\n#\r\n#####,--.\r\n####(_o,o)\r\n######`\"´\r\n#\r\nasciiend\r\n      ?chestType = bone\r\n        >o@myX@,@myZ@,@chestColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n####ε╪###╪3\r\n#####└───┘\r\nasciiend\r\n      :?chestType = delta\r\n       >o@myX@,@myZ@,@chestColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#####╞###╡\r\n#####└───┘\r\nasciiend\r\n//-------------------------------\r\n    :?chestTime <= 15 | chestTime <= 35  & chestTime > 30\r\n      >o@myX@,@myZ@,@skullColor@,ascii\r\n#\r\n#####,--.\r\n####(_o,o)\r\n######`\"´\r\n#\r\n#\r\nasciiend\r\n      ?chestType = bone\r\n        >o@myX@,@myZ@,@chestColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n####ε╪=o=╪3\r\n#####└───┘\r\nasciiend\r\n      :?chestType = delta\r\n        >o@myX@,@myZ@,@chestColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#####╞-∆-╡\r\n#####└───┘\r\nasciiend\r\n//-------------------------------\r\n    :?chestTime <= 30\r\n      >o@myX@,@myZ@,@skullColor@,ascii\r\n#####,--.\r\n####(_o,o)\r\n######`\"´\r\n#\r\n#\r\n#\r\nasciiend\r\n      ?chestType = bone\r\n        >o@myX@,@myZ@,@chestColor@,ascii\r\n#\r\n#\r\n#\r\n######___\r\n####ε╪=o=╪3\r\n#####└───┘\r\nasciiend\r\n      :?chestType = delta\r\n        >o@myX@,@myZ@,@chestColor@,ascii\r\n#####\r\n#####\r\n#####\r\n######___\r\n#####╞-∆-╡\r\n#####└───┘\r\nasciiend\r\n\r\n//MOVING-------------------------------------------<\r\n?currentState = stateMoving\r\n  ?stateTime/2 = 0\r\n    >o@myX@,@myZ@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#####,--.\r\n####(_o,o)\r\n######`\"´\r\nasciiend\r\n\r\n  ?stateTime/2 = 1\r\n    >o@myX@,@myZ@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#####,--.\r\n####(_o,o)\r\n######`\"´\r\nasciiend\r\n\r\n  ?stateTime/2 = 2\r\n    >o@myX@,@myZ@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#####,--.\r\n####(_o,o)\r\n######`\"´\r\nasciiend\r\n\r\n  ?stateTime/2 = 3\r\n    >o@myX@,@myZ@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#####,--.\r\n####(_o,o)\r\n######`\"´\r\nasciiend\r\n\r\n  ?stateTime/2 = 4\r\n    >o@myX@,@myZ@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#####,--.\r\n####(_o,o)\r\n######`\"´\r\nasciiend\r\n\r\n  ?stateTime/2 = 5\r\n    >o@myX@,@myZ@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#####,--.\r\n####(_o,o)\r\n######`\"´\r\nasciiend\r\n\r\n//MOVING CLOUD POOT---------------------------------<\r\n\r\n?currentState = stateMoving\r\n  ?stateTime/2 = 0\r\n    ?cloudType = cloud\r\n      >o@myX@,@myZ@,@cloudColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n    :?cloudType = sparks\r\n      >o@myX@,@myZ@,@sparkColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#####\\\r\nasciiend\r\n    :?cloudType = wings\r\n      >o@myX@,@myZ@,@wingColor@,ascii\r\n#\r\n##.\\###;\r\n##( \\#| \r\n####¯\r\n#\r\n#\r\nasciiend\r\n    :?cloudType = chesttrail\r\n      >o@myX@,@myZ@,@chesttrailColor@,ascii\r\n#\r\n#\r\n#\r\n####\r\n###\r\n####└─\r\nasciiend\r\n\r\n//-------------------------------1\r\n\r\n  ?stateTime/2 = 1\r\n    ?cloudType = cloud\r\n      >o@myX@,@myZ@,@cloudColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n####(\\\r\nasciiend\r\n    :?cloudType = sparks\r\n      >o@myX@,@myZ@,@sparkColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n###\\\r\n####-\r\nasciiend\r\n    :?cloudType = wings\r\n      >o@myX@,@myZ@,@wingColor@,ascii\r\n#\r\n##__###_\r\n#\\  \\#/ \r\n##`¯¯\r\n#\r\n#\r\nasciiend\r\n    :?cloudType = chesttrail\r\n      >o@myX@,@myZ@,@chesttrailColor@,ascii\r\n#\r\n#\r\n#\r\n###_\r\n##├\r\n##└──\r\nasciiend\r\n\r\n//-------------------------------2\r\n\r\n  ?stateTime/2 = 2\r\n    ?cloudType = cloud\r\n      >o@myX@,@myZ@,@cloudColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n##_\r\n#( `\r\nasciiend\r\n    :?cloudType = sparks\r\n      >o@myX@,@myZ@,@sparkColor@,ascii\r\n#\r\n#\r\n#\r\n##_\r\n###_\r\n#\r\nasciiend\r\n    :?cloudType = wings\r\n      >o@myX@,@myZ@,@wingColor@,ascii\r\n#\r\n#\r\n#___\r\n/_.'¯#¯\r\n#\r\n#\r\nasciiend\r\n    :?cloudType = chesttrail\r\n      >o@myX@,@myZ@,@chesttrailColor@,ascii\r\n#\r\n#\r\n#\r\n##__\r\n#├─\r\n#└───\r\nasciiend\r\n\r\n\r\n//-------------------------------3\r\n\r\n  ?stateTime/2 = 3\r\n    ?cloudType = cloud\r\n      >o@myX@,@myZ@,@clouderColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#_\r\n´ `\r\nasciiend\r\n    :?cloudType = sparks\r\n      >o@myX@,@myZ@,@sparkColor@,ascii\r\n#\r\n#\r\n#\r\n#-\r\n##_\r\n#\r\nasciiend\r\n    :?cloudType = wings\r\n      >o@myX@,@myZ@,@wingColor@,ascii\r\n#\r\n##__###_\r\n#\\  \\#/ \r\n##`¯¯\r\n#\r\n#\r\nasciiend\r\n    :?cloudType = chesttrail\r\n      >o@myX@,@myZ@,@chesttrailColor@,ascii\r\n#\r\n#\r\n#\r\n#___\r\n├─o\r\n└───┘\r\nasciiend\r\n\r\n//-------------------------------4\r\n\r\n  ?stateTime/2 = 4\r\n    ?cloudType = cloud\r\n      >o@myX@,@myZ@,@clouderColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n;`.\r\nasciiend\r\n    :?cloudType = sparks\r\n      >o@myX@,@myZ@,@sparkerColor@,ascii\r\n#\r\n#\r\n#\r\n_\r\n#\r\n/\r\nasciiend\r\n    :?cloudType = wings\r\n      >o@myX@,@myZ@,@wingColor@,ascii\r\n#\r\n##.\\###;\r\n##( \\#| \r\n####¯\r\n#\r\n#\r\nasciiend\r\n    :?cloudType = chesttrail\r\n      >o@myX@,@myZ@,@chesttrailerColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#__\r\n├─o─┤\r\nasciiend\r\n\r\n//-------------------------------5\r\n\r\n  ?stateTime/2 = 5\r\n    ?cloudType = cloud\r\n      >o@myX@,@myZ@,@clouderColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n.\r\nasciiend\r\n    :?cloudType = sparks\r\n      >o@myX@,@myZ@,@sparkerColor@,ascii\r\n#\r\n#\r\n#\r\n_\r\n#\r\n#\r\nasciiend\r\n    :?cloudType = wings\r\n      >o@myX@,@myZ@,@wingColor@,ascii\r\n#\r\n#\r\n###(\\#| \r\n####¯\r\n#\r\n#\r\nasciiend\r\n    :?cloudType = chesttrail\r\n      >o@myX@,@myZ@,@chesttrailerColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#.\r\n\\_|_\r\nasciiend\r\n\r\n//-------------------------------6\r\n\r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Dragon.txt" - Parse error: Failed to parse completely. Remaining: "= [ascii\r\n#####\\`-`~.\r\n######{_ ` `~;\r\n########‾`/~´\r\n#####´‾‾`´\r\nasciiend,ascii\r\n#####\\`-`~.\r\n######{_ ` `~;\r\n########‾`/~´\r\n#####´‾`-´\r\nasciiend,ascii\r\n#####\\`-`~.\r\n######{_ ` `~;\r\n########‾`/~´\r\n#####´`--´\r\nasciiend,ascii\r\n#####\\`-`~.\r\n######{_ ` `~;\r\n########‾`/~´\r\n#####`._,´\r\nasciiend,ascii\r\n#####\\`-`~.\r\n######{_ ` `~;\r\n########‾`/~´\r\n#####-.-´´\r\nasciiend,ascii\r\n#####\\`-`~.\r\n######{_ ` `~;\r\n########‾`/~´\r\n#####,´‾`´\r\nasciiend]\r\n\r\nvar DragonAttack = [ascii\r\n#\r\n#\r\n########################\\`-`~.\r\n####################_###,｛_ ` `~;\r\n######_..-.._####,´‾ ‾`´  ,‾`/~´\r\n###.´‾. --   ‾`-´  _._   ;\r\n##/´‾##))##`._  _,´###((´\r\n#'####,´######‾‾#######`´\"\r\n#####\"\r\nasciiend,ascii\r\n######################.# .\r\n#######################\\`-`~.\r\n########################｛_ ` `~;\r\n#######################,  `/~-`\r\n######__...__####,´‾‾`´  ,\r\n###.´‾  __   ‾`-´  ,._   ;\r\n#.´´‾##))##`.._ _,´###((´\r\n######,´#######‾#######`.\r\n#####\"###################\"\r\nasciiend,ascii\r\n######################. .\r\n######################|`-`~.\r\n#######################｛_ ` `´;\r\n######################/  `._\\‾\r\n#`.########__####,´‾‾´  ( \r\n##``---´‾‾‾  ‾`-´    _  ;\r\n###`- `))-- .._  _.´‾#))\r\n######,´#######‾####\".´\r\n#####\"\r\nasciiend,ascii\r\n######################. .\r\n######################|`-`~.\r\n#######################｛_ ` `´;\r\n###.´##############__#/  `._\\‾\r\n##(´-._####__###,´‾  ´  / \r\n###`.  ‾‾‾‾  `-´     _  ;\r\n##### `))`--.._  _.´‾#))\r\n######,´#######‾####\".´\r\n#####\"\r\nasciiend,ascii\r\n#######################. .\r\n#######################|`-`~.\r\n#######################,｛_ ` `´;\r\n######################/  ,`._\\‾\r\n#`.########__####,´‾‾´  ( \r\n##``---´‾‾‾  ‾`-´    _  ;\r\n###`- `))-- .._  _.´‾#))\r\n######,´#######‾####\".´\r\n#####\"\r\nasciiend,ascii\r\n#\r\n#\r\n#######################\\`-`~.\r\n#######################,｛_ ` `´;\r\n######__...__####,´‾‾`´  ,`._\\‾\r\n###.´‾  __   ‾`-´  ,._   ;\r\n#.´´‾##))##`.._ _,´###((´\r\n######,´#######‾#######`.\r\n#####\"###################\"\r\nasciiend,ascii\r\n#\r\n#\r\n########################\r\n########################_\\`-`~.\r\n######__...__####,´‾‾`´‾ ‾｛_ ` `´;\r\n###.´‾  __   ‾`-´  ,._   ;##`._\\‾\r\n#.´´‾##))##`.._ _,´###((´\r\n######,´#######‾#######`.\r\n#####\"###################\"\r\nasciiend,ascii\r\n#\r\n#\r\n########################\r\n########################_\\`-`~.\r\n######__...__####,´‾‾`´‾ ‾｛_ ` `´;\r\n###.´‾  __   ‾`-´  ,._   ;##`._\\‾\r\n#.´´‾##))##`.._ _,´###((´\r\n######,´#######‾#######`.\r\n#####\"###################\"\r\nasciiend,ascii\r\n#\r\n#\r\n#######################\\`-`~.\r\n#######################,｛_ ` `´;\r\n######__...__####,´‾‾`´  ,`/~-`\r\n###.´‾  __   ‾`-´  ,._   ;\r\n#.´´‾##))##`.._ _,´###((´\r\n######,´#######‾#######`.\r\n#####\"###################\"\r\nasciiend]\r\n\r\nvar ChineseDragonBody = [ascii\r\n####################_###,\r\n######_..-.._####,´‾ ‾`´  ,\r\n###.´‾. --   ‾`-´  _._   ;\r\n##/´‾##))##`._  _,´###((´\r\n#'####,´######‾‾#######`´\"\r\n#####\"\r\nasciiend,ascii\r\n###################_####,\r\n######_.-.._####,´‾ ‾'-´  ,\r\n###.´‾  __   ‾`‾   _     ;\r\n##/´‾‾#))#`._   _,´#‾`((´\r\n#´####,´#####‾‾########`´\"\r\n#####\"\r\nasciiend,ascii\r\n##################_#####,\r\n#####_.-.._####,´‾ ‾'- ´  ,\r\n###.´  __  ‾‾`´   _      /\r\n#,´´‾‾#))`._   _,´#‾‾`((´\r\n######,´#####‾‾########`.\r\n#####\"###################\"\r\nasciiend,ascii\r\n#################_######,\r\n#####_.-._####,´‾ ‾'-.-´  ,\r\n###.´ _     ‾`´   _      /\r\n#-´ ´‾#))`._  _,´#‾` (/´\r\n######,´####‾‾########`.\r\n#####\"#################\"\r\nasciiend,ascii\r\n################_#######,\r\n#####_##_####,´‾ ‾'-._,'  ,\r\n#-.-´ ‾‾  ‾`´   _        /\r\n####‾` ))._  _,´#‾`._// ´\r\n######,´###‾‾########`,\r\n#####\"###############\"\r\nasciiend,ascii\r\n###############_########,\r\n########_###,´‾ ‾'-._#,'  ,\r\n#´`\\`--´  ‾´   _         /\r\n####`-.))_  _,´#‾`-.-))´\r\n######.´##‾‾########,´\r\n######`\"###########\"\r\nasciiend,ascii\r\n##############_#########,\r\n#,.#####_##,´‾ ‾'-._##,'  ,\r\n###\\`--´ ‾´   _     ‾‾   /\r\n####`-.//_ _,´#‾`-._.))´\r\n######`,##‾#########,´\r\n#######\"###########\"\r\nasciiend,ascii\r\n#############_##########,\r\n#`..######,´‾ ‾'-._##_.´  ,\r\n###\\``-.-´   _      ‾   .´\r\n####`-.(( _,´#‾`-.__.))´\r\n########`´\"#########,´\r\n###################\"\r\nasciiend,ascii\r\n############_###########,\r\n#,`.#####,´‾ ‾'-._##_.-´  ,\r\n###\\``--´   _      ‾    .´\r\n####`-.((_,´#‾`-.__ _,))\r\n########`´\"########‾#,´\r\n####################\"\r\nasciiend,ascii\r\n###########_############,\r\n#,`.####,´‾ ‾'-._##_.´`´  ,\r\n###\\``-´   _      ‾     ,´\r\n####`-.((,´#‾`-.__  _.))\r\n########`.########‾‾#,´\r\n#########\"##########\"\r\nasciiend,ascii\r\n##########_#############,\r\n#``.###,´‾ ‾'-._##_#,´`´  ,\r\n###\\`-´   _      ‾      ,´\r\n####`-´((‾#‾`-. _ _ _,|)\r\n########`.#########‾##`,\r\n#########\"############\"\r\nasciiend,ascii\r\n########################,\r\n#´`.###.´ ‾`-.#_#_.--´`´  ,\r\n###\\ ‾´  _      ‾       ,´\r\n####`-´(/#‾`-._ __,-._(/\r\n########`,#####‾#######`.\r\n########\"###############\"\r\nasciiend,ascii\r\n########################,\r\n##'.#_,-´ ‾`-.._#.'´‾´`´  ,\r\n##`.`  __               ,´\r\n####`‾#//‾`-._  _-´`._((\r\n#######`,#####‾########`.\r\n#######\"#################\"\r\nasciiend,ascii\r\n########################,\r\n#####.-´ ‾`-..#_#.'´‾´`´  ,\r\n`..-´  _._               ;\r\n##``´´#))#‾`._   _-´`._((\r\n######,´######‾#########`.\r\n#####\"####################\"\r\nasciiend]\r\n\r\nvar ScreenX\r\nvar px\r\nvar t\r\nvar tt\r\n\r\nvar x = pos.x-40\r\nvar y = -5\r\nvar Attackframe = -1\r\nvar CancelAttack = false\r\nvar MovementFrame = 0\r\nvar ExplosionCoords = []\r\nvar Boom = import Cosmetics/Explosion\r\nvar customStyle = ui.AddStyle(\"\r\n^###\r\n^###\r\n^###\")\r\n\r\nvar MotherPanel\r\nvar DragonBody\r\nvar DragonHead\r\nvar FirePanel\r\nvar ResetPosition\r\n\r\n?key = UpBegin\r\n  y++\r\n  MotherPanel.y = y\r\n:?key = DownBegin\r\n  y--\r\n  MotherPanel.y = y\r\n\r\n\r\nScreenX = screen.FromWorldX(x)\r\npx = pos.x\r\nt = time\r\ntt = totalTime\r\n\r\n?loc.begin | loc.loop\r\n  MotherPanel = ui.AddPanel()\r\n  DragonBody = ui.AddText()\r\n  DragonHead = ui.AddText()\r\n  FirePanel = ui.AddPanel()\r\n  FirePanel.style = customStyle\r\n  x = px-30\r\n  MotherPanel.style = customStyle\r\n  MotherPanel.Add(DragonBody)\r\n  MotherPanel.Add(DragonHead)\r\n  DragonBody.w = 99\r\n  DragonHead.w = 99\r\n  DragonHead.y = -1\r\n  DragonHead.x = 19\r\n  ResetPosition = true\r\n  MotherPanel.y = y\r\n\r\n?t%28 = 2\r\n  DragonHead.x = 37 - DragonHead.x\r\nMotherPanel.x = ScreenX\r\n\r\nfunc MoveFoward()\r\n  ?px - x > 15 & t%2=0\r\n    x++\r\n  :?px - x > 50 & t%4=1\r\n    x++\r\n  ?screen.FromWorldX(px) < 14\r\n    x = math.Max( x , px - 38 )\r\n\r\nfunc FlyingAnimation()\r\n  DragonBody.y = 0\r\n  ?tt%4 = 0\r\n    MovementFrame = (MovementFrame+1)\r\n    DragonBody.text = ChineseDragonBody[MovementFrame%ChineseDragonBody.Count()]\r\n    DragonHead.text = ChineseDragonHead[MovementFrame%ChineseDragonHead.Count()]\r\n\r\n?Attackframe > -1\r\n  ?MovementFrame = 0\r\n    DragonHead.text = \"\"\r\n    ?Attackframe%4 = 0\r\n      DragonBody.text = DragonAttack[Attackframe/4]\r\n      DragonBody.y = -3\r\n    Attackframe = (Attackframe+1)%(DragonAttack.Count()*4)\r\n    ?Attackframe = 0\r\n      Attackframe = -1\r\n    :?Attackframe = 22\r\n      ?foe.distance < 25\r\n        ExplosionCoords = [px+foe.distance+3,pos.z]\r\n      SetFireBall()\r\n    ?screen.FromWorldX(px) < 14\r\n      x = math.Max( x , px - 38 )\r\n  :\r\n    MoveFoward()\r\n    ?t%2\r\n      ?MovementFrame%14 < 6\r\n        MovementFrame--\r\n      :\r\n        MovementFrame = (MovementFrame + 1)%14\r\n    DragonBody.text = ChineseDragonBody[MovementFrame%ChineseDragonBody.Count()]\r\n    DragonHead.text = ChineseDragonHead[MovementFrame%ChineseDragonHead.Count()]\r\n:\r\n  MoveFoward()\r\n  FlyingAnimation()\r\n\r\n?Attackframe = -1\r\n  ?key = PrimaryBegin\r\n    ?ScreenX+27<input.x\r\n      ExplosionCoords = [screen.ToWorldX(input.x),input.y]\r\n      Attackframe = 0\r\n  ?foe.distance < 30 & ScreenX > -13\r\n    ExplosionCoords = [px+foe.distance+3,pos.z]\r\n    Attackframe = 0\r\n\r\n?t ! tt & ResetPosition\r\n  ?loc=harder\r\n    x = px-40\r\n    ResetPosition = false\r\n\r\nvar FireColour = color.FromRGB(18,5,0)\r\nvar FireBallX\r\nvar FireBallStartX\r\nvar FireBallVelocity = []\r\nvar FireBallA\r\nvar FireBallB\r\nvar FireBallC\r\nvar FireBallD\r\nvar FireText\r\nvar drawFireball = !sys.isMobile\r\n\r\n?FireBallVelocity.Count()>0\r\n  var PercentTraveled\r\n  PercentTraveled = (1.0*FireBallX-FireBallStartX)/(ExplosionCoords[0]-FireBallStartX)\r\n  FireBallX = FireBallX + FireBallVelocity[0]\r\n  FirePanel.x = screen.FromWorldX(FireBallX)-46\r\n  FirePanel.y = y + math.FloorToInt(PercentTraveled*FireBallVelocity[1])\r\n\r\n  ?PercentTraveled >= 1.0\r\n    FireBallVelocity.Clear()\r\n    FirePanel.Recycle()\r\n    ?drawFireball\r\n      Boom.Explosion(0,ExplosionCoords[1])\r\n    :\r\n      play bomb_cart_explosion 100\r\n\r\nfunc SetFireBall()\r\n  FirePanel.Recycle()\r\n  FirePanel = ui.AddPanel()\r\n  FirePanel.style = customStyle  \r\n\r\n  FireBallA = ui.AddCanvas() \r\n  FireBallB = ui.AddCanvas() \r\n  FireBallC = ui.AddCanvas() \r\n  FireBallD = ui.AddCanvas() \r\n  FireText = ui.AddText(\"φ\")\r\n\r\n  FireBallX = x+28\r\n  FireBallStartX = x+28\r\n  FirePanel.x = screen.FromWorldX(FireBallX)\r\n  FirePanel.y = y\r\n  FireBallVelocity = [ math.RoundToInt(math.Sign(ExplosionCoords[0]-x-28)*3) ,ExplosionCoords[1]-screen.h/2-y]\r\n\r\n  FireBallA.w = 5\r\n  FireBallA.h = 3\r\n\r\n  FireBallB.w = 7\r\n  FireBallB.h = 1\r\n\r\n  FireBallC.w = 3\r\n  FireBallC.h = 3\r\n\r\n  FireBallD.w = 1\r\n  FireBallD.h = 5\r\n\r\n  FireText.align = center\r\n  FireText.y = 2\r\n  FireText.color = #yellow\r\n\r\n  FireBallA.blend = Add\r\n  FireBallB.blend = Add\r\n  FireBallC.blend = Add\r\n  FireBallD.blend = Add\r\n\r\n  FireBallA.SetBG(FireColour)\r\n  FireBallB.SetBG(FireColour)\r\n  FireBallC.SetBG(FireColour)\r\n  FireBallD.SetBG(FireColour)\r\n\r\n  FirePanel.Add(FireBallA)\r\n  FirePanel.Add(FireBallB)\r\n  FirePanel.Add(FireBallC)\r\n  FirePanel.Add(FireBallD)\r\n  FirePanel.Add(FireText)\r\n\r\nBoom.ExplosionStatus()\r\n?Boom.ExplosionCurrentDuration > -1\r\n  Boom.ExplosionX = screen.FromWorldX(ExplosionCoords[0])\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/CatBalloon.txt" - Parse error: Failed to parse completely. Remaining: "= #ffffff\r\nvar PET_COLOR2 = #FFBFFF\r\nvar ANIM_LOOP_TIME = 80\r\n\r\n//ART========================\r\nvar petArt = ascii\r\n######__\r\n##•´‾(  )‾`•\r\n#´   /‾‾\\   `\r\n|   •    •   |\r\n.   |    |   .\r\n#\\  .    .  /\r\n##\\  \\  /  /\r\n###'. •• .'\r\n#####│##│\r\n#####│##│\r\n####.│──┴──.\r\n###¡‾‾‾‾‾‾¡│\r\n###│______│,\r\nasciiend\r\nvar petArtUI\r\n\r\nvar petArt2 = ascii\r\n#####,\r\n#-.-´'\\\r\n#\\ oω°)\r\n%%\r\n#####,\r\n#-.-´'\\\r\n#\\ oω°)\r\n%%\r\n#####,\r\n#-.-´'\\\r\n#\\ oω°)\r\n%%\r\n#####,\r\n#-.-´'\\\r\n#\\ oω°)\r\n%%\r\n#####,\r\n#-.-´'\\\r\n#\\ oω°)\r\n%%\r\n#####,\r\n#-.-´'\\\r\n#\\ oω°)\r\n%%\r\n#####,\r\n#-.-´'\\\r\n#\\ oω°)\r\n%%\r\n#####,\r\n#-.-´'\\\r\n#\\ oω°)\r\n%%\r\n######,\r\n__.-~´|\r\n`. -ω´)\r\n%%\r\n#####,\r\n#-.-´'\\\r\n#\\ -ω´)\r\nasciiend\r\nvar petArt2UI\r\n\r\n//========================\r\nvar halfLoopTime\r\nvar petX\r\nvar petHeight\r\nvar movingUp = true\r\nvar pos_x\r\nvar screen_w = screen.w\r\nvar offScreen_behind = false\r\nvar offScreen_ahead = false\r\nvar petScreenX\r\n\r\nvar petPnl\r\n\r\npetMain()\r\n\r\nfunc initPet()\r\n  var addAndInitAnim = func(anim, x, y, dur, loop, color)\r\n    petPnl.Add(anim)\r\n    anim.anchor = top_left\r\n    anim.dock = top_left\r\n    anim.x = x\r\n    anim.y = y\r\n    anim.duration = dur\r\n    anim.loop = loop\r\n    anim.color = color\r\n    anim.Play()\r\n  \r\n  var style = ui.AddStyle(\"\r\n^###\r\n^###\r\n^###\")\r\n  petPnl = ui.AddPanel()\r\n  petPnl.h = 1\r\n  petPnl.w = 1\r\n  petPnl.style = style\r\n  petPnl.anchor = top_left\r\n  petPnl.dock = top_left\r\n  petArtUI = ui.AddAnim(petArt)\r\n  petArt2UI = ui.AddAnim(petArt2)\r\n  addAndInitAnim(petArtUI, X_OFFSET, Y_OFFSET, ANIM_LOOP_TIME, true, PET_COLOR1)\r\n  addAndInitAnim(petArt2UI, X_OFFSET+ART2_X_OFFSET, Y_OFFSET+ART2_Y_OFFSET, ANIM_LOOP_TIME, true, PET_COLOR2)\r\n  resetPet()\r\n\r\nfunc resetPet()\r\n  petX = pos_x - screen_w\r\n  petHeight = MIN_HEIGHT\r\n  movingUp = true\r\n  \r\nfunc petMain()\r\n  pos_x = pos.x\r\n  ?totalTime = 1\r\n    initPet()\r\n  petScreenX = screen.FromWorldX(petX + X_OFFSET)\r\n  offScreen_behind = petScreenX < MIN_X\r\n  offScreen_ahead = petScreenX > MAX_X\r\n  ?(time%X_MOVE_RATE = 0 | offScreen_behind) & !offScreen_ahead\r\n    ?offScreen_behind\r\n      petX += X_MOVE_SPEED*2\r\n    :\r\n      petX += X_MOVE_SPEED\r\n  :?petScreenX > MAX_X\r\n    resetPet()\r\n  ?movingUp\r\n    petHeight = getHeightArch() - MIN_HEIGHT\r\n  :\r\n    petHeight = -1*getHeightArch() - MIN_HEIGHT\r\n  ?getPercentHalfLoop() = 1\r\n    movingUp = !movingUp\r\n  var printX = screen.FromWorldX(petX + X_OFFSET)\r\n  var printY = screen.FromWorldZ(petHeight + Y_OFFSET)\r\n  petPnl.x = printX\r\n  petPnl.y = printY\r\n  \r\nfunc getHeightArch()\r\n  //creates a parabola between start and end points, with max height\r\n  //a = -jumpheight / (( mid - start )( mid - end ))\r\n  //(y(x) = ( x - start )( x - end )a\r\n  var multi = getHeightDiff()/0.125\r\n  var XMinusStart = getPercentHalfLoop()\r\n  var XMinusEnd = getPercentHalfLoop()-1\r\n  var result = XMinusStart*XMinusEnd*multi\r\n  return math.RoundToInt(result)\r\n\r\nfunc getHeightDiff()\r\n  return MAX_HEIGHT - MIN_HEIGHT\r\n  \r\nfunc getPercentHalfLoop()\r\n  var halfLoopTime = LOOP_TIME/2.0\r\n  return (time%halfLoopTime)/halfLoopTime"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Panda.txt" - Parse error: Failed to parse completely. Remaining: "= [ascii\r\n#########▄▄▄▄▄▄▄▄▄▄-▄▄▄  _\r\n######▄██████████▀´ `▀██( ▄ \r\n####▄████████████     ▀██▄██\r\n##▄▓▓▓███████████      ▓███o██\r\n##░░████▒▒▓▓▓████     |▒▒████▄\r\n##; `▀▀█▓▓▓██████|   /   ▀▀▀\r\n#/  /##\\   \\#####|  /  \r\n|  |####`   \\####!  `_)\r\n#.__)####`___)####\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄-▄▄▄  _\r\n######▄██████████▀´ `▀██( ▄ \r\n####▄████████████     ▀██▄██\r\n##▄▓▓▓███████████      ▓███o██\r\n##░░████▒▒▓▓▓████     |▒▒████▄\r\n##; `▀▀█▓▓▓██████|   /\\  ▀▀▀\r\n#/  /##\\   \\#####|  /|_)  \r\n|  |####`   \\####!  `\r\n#.__)####`___)####\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄-▄▄▄  _\r\n######▄██████████▀´ `▀██( ▄ \r\n####▄████████████     ▀██▄██\r\n##▄▓▓▓███████████      ▓███o██\r\n##░░████▒▒▓▓▓████     |▒▒████▄\r\n##; `▀▀▓▓▓░██████|   /|  ▀▀▀\r\n##¡  ||  |#######|  |#\\  |\r\n##|  !#|  `######!  \\##|_)\r\n###\\__)#`__)######\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄-▄▄▄  _\r\n######▄██████████▀´ `▀██( ▄ \r\n####▄████████████     ▀██▄██\r\n##▄▓▓▓███████████      ▓███o██\r\n##░░████▒▒▓▓▓████     |▒▒████▄\r\n##; `▀▀▓▓▓░██████|   /\\  ▀▀▀\r\n##¡  |  \\########|  |##\\  |\r\n##\\__)`  \\#######!  \\###. \\\r\n#######\\__)#######\\__)##\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄-▄▄▄  _\r\n######▄██████████▀´ `▀██( ▄ \r\n####▄████████████     ▀██▄██\r\n##▄▓▓▓███████████      ▓███o██\r\n##░░████▒▒▓▓▓████     |▒▒████▄\r\n###█; `▓▓▓░██████|   /|  ▀▀▀\r\n####\\  /#########|  |#\\  |\r\n#####\\__)########/  |##. \\\r\n######\\__)######(._/###\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄-▄▄▄  _\r\n######▄██████████▀´ `▀██( ▄ \r\n####▄████████████     ▀██▄██\r\n##▄▓▓▓██████████       ▓███o██\r\n##░░████▒▒▓▓▓███       ▒▒████▄\r\n###███; `▓▓░███|   _/--- ▀▀▀\r\n####| ¡  |#####/  /#\\  \\ \r\n###/  /\\__)###/  /###|  |\r\n###|__)######(._/#####\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄-▄▄▄  _\r\n######▄██████████▀´ `▀██( ▄ \r\n####▄████████████     ▀██▄██\r\n##▄▓▓▓███████████      ▓███o██\r\n##░░████▒▒▓▓▓███▀    _|▒▒████▄\r\n###████; `▓░████|   /_   ▀▀▀\r\n####/ ¡\\  \\#####|  /  \\ \r\n###/  /#`  `###(._/#|  |\r\n##|__)####\\__)######\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄-▄▄▄  _\r\n######▄██████████▀´ `▀██( ▄ \r\n####▄████████████     ▀██▄██\r\n##▄▓▓▓███████████      ▓███o██\r\n##░░████▒▒▓▓▓████     |▒▒████▄\r\n###████;  `░█████|   /   ▀▀▀\r\n####/ ¡#\\  \\######\\__)  \r\n###/  /##`  |#####|  |\r\n##|__)####\\__)#####\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄  _\r\n######▄███████████▀´ `▀██( ▄ \r\n####▄█████████████     ▀██▄██\r\n##▄▓▓▓████████████      ▓███o██\r\n##░░████▒▒▓▓▓█████       ▒████▄\r\n###███;  `▓░███████__   / ▀▀▀\r\n#####/¡  |#######|  /\\  |  \r\n####/ .\\  \\######\\  | \\__)\r\n###|__)#`__)######\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄  _\r\n######▄███████████▀´ `▀██( ▄ \r\n####▄█████████████     ▀██▄██\r\n##▄▓▓▓████████████      ▓███o██\r\n##░░████▒▒▓▓▓▓▓▓▓██      ▒████▄\r\n###███;  `▓░████████      |▀▀\r\n######¡  |######|  /##\\   /  \r\n#####|_\\  \\#####|  |###\\  \\\r\n########`__)###(._/#####|__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄  _\r\n######▄███████████▀´ `▀██( ▄ \r\n####▄█████████████     ▀██▄██\r\n##▄▓▓▓████████████      ▓███o██\r\n##░░████▒▒▓▓▓▓▓████      ▒████▄\r\n###█; `██▓▒░████████     / ▀▀\r\n###|  !######/  /####|  / \r\n### \\  \\####/  /#####!  \\\r\n#####.__)##(._/#######\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄  _\r\n######▄███████████▀´ `▀██( ▄ \r\n####▄█████████████     ▀██▄██\r\n##▄▓▓▓████████████      ▓███o██\r\n##░░████▒▒▓▓▓█████      ▒▒████▄\r\n##; `▀▀███▓░███████    /   ▀▀\r\n#/  !  \\####|  /####\\  | \r\n#\\  |\\__)###/  /####`  |\r\n##.__)#####(._/#####|__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄  _\r\n######▄███████████▀´ `▀██( ▄ \r\n####▄█████████████     ▀██▄██\r\n##▄▓▓▓████████████      ▓███o██\r\n##░░████▒▒▓▓▓█████     ▒▒▒████▄\r\n##; `▀▀█▓▓▓░██████    /   ▀▀\r\n#/  !`   \\##|  /###\\  | \r\n#|  |##`__)#/  /###|  /\r\n##.__)#####(._/####/_)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄  _\r\n######▄███████████▀´ `▀██( ▄ \r\n####▄█████████████     ▀██▄██\r\n##▄▓▓▓████████████      ▓███o██\r\n##░░████▒▒▓▓▓█████     ▒▒▒████▄\r\n##; `▀▀█▓▓▓░██████    /   ▀▀\r\n#/  !#|   |#|###\\ |  | \r\n#|  |##\\   \\#####\\|  |\r\n##.__)##\\___)#####|__)\r\nasciiend\r\n^]\r\n//turn his head\r\nvar animationFrames = [ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄▄▄\r\n######▄███████████▀´ `▀██████▄_\r\n####▄████████████      ░( )███ )\r\n##▄▓▓▓███████████     ░▒▓▄█████▄\r\n##░░████▒▒▓▓▓████   __.░▒█#███#█▄\r\n##; `▀▀█▓▓▓██████|  \\ /-▀███╩███▀\r\n#/  /##\\   \\#####|  |_)   ▀▄▄▄▀\r\n|  |####`   \\####!  `\r\n#.__)####`___)####\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄▄▄\r\n######▄███████████▀´ `▀██████▄_\r\n####▄████████████      ░( )███ )\r\n##▄▓▓▓███████████     ░▒▓▄█████▄\r\n##░░████▒▒▓▓▓████     .░▒█#███#█▄\r\n##; `▀▀▓▓▓░██████|  ----▀███╩███▀\r\n##¡  ||  |#######|  | \\  |▀▄▄▄▀\r\n##|  !#|  `######!  \\ |__)\r\n###\\__)#`__)######\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄▄▄\r\n######▄███████████▀´ `▀██████▄_\r\n####▄████████████      ░( )███ )\r\n##▄▓▓▓███████████     ░▒▓▄█████▄\r\n##░░████▒▒▓▓▓████     .░▒█#███#█▄\r\n##; `▀▀▓▓▓░██████|  /---▀███╩███▀\r\n##¡  |  \\########|  | #\\  ▀▄▄▄▀\r\n##\\__)`  \\#######!  \\ ##|  |\r\n#######\\__)#######\\__)##\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄▄▄\r\n######▄███████████▀´ `▀██████▄_\r\n####▄████████████      ░( )███ )\r\n##▄▓▓▓███████████     ░▒▓▄█████▄\r\n##░░████▒▒▓▓▓████     .░▒█#███#█▄\r\n###█; `▓▓▓░██████|  /---▀███╩███▀\r\n####\\  /#########|  |##\\  ▀▄▄▄▀\r\n#####\\__)########/  |##|  |\r\n######\\__)######(._/###\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄▄▄\r\n######▄███████████▀´ `▀██████▄_\r\n####▄████████████      ░( )███ )\r\n##▄▓▓▓██████████      ░▒▓▄█████▄\r\n##░░████▒▒▓▓▓███      .░▒█#███#█▄\r\n###███; `▓▓░███|   !----▀███╩███▀\r\n####| ¡  |#####/  /#\\  \\  ▀▄▄▄▀\r\n###/  /\\__)###/  /###|  |\r\n###|__)######(._/#####\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄▄▄\r\n######▄███████████▀´ `▀██████▄_\r\n####▄████████████      ░( )███ )\r\n##▄▓▓▓███████████     ░▒▓▄█████▄\r\n##░░████▒▒▓▓▓███▀     .░▒█#███#█▄\r\n###████; `▓░████   !----▀███╩███▀\r\n####/ ¡\\  \\#####|  /\\  \\  ▀▄▄▄▀\r\n###/  /#`  `###(._/##|  |\r\n##|__)####\\__)#######\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄▄▄\r\n######▄███████████▀´ `▀██████▄_\r\n####▄████████████      ░( )███ )\r\n##▄▓▓▓███████████     ░▒▓▄█████▄\r\n##░░████▒▒▓▓▓████     .░▒█#███#█▄\r\n###████;  `░█████\\  !---▀███╩███▀\r\n####/ ¡#\\  \\######\\__)\\   ▀▄▄▄▀\r\n###/  /##`  |######|  |\r\n##|__)####\\__)######\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄▄▄\r\n######▄███████████▀´ `▀██████▄_\r\n####▄█████████████     ░( )███ )\r\n##▄▓▓▓████████████    ░▒▓▄█████▄\r\n##░░████▒▒▓▓▓█████    .░▒█#███#█▄\r\n###███;  `▓░██████\\  `. ▀███╩███▀\r\n#####/¡  |########||  |   ▀▄▄▄▀\r\n####/ .\\  \\#######\\ \\__)\r\n###|__)#`__)#######\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄▄▄\r\n######▄███████████▀´ `▀██████▄_\r\n####▄█████████████     ░( )███ )\r\n##▄▓▓▓████████████    ░▒▓▄█████▄\r\n##░░████▒▒▓▓▓▓▓▓▓██_  .░▒█#███#█▄\r\n###███;  `▓░████████\\_ \\▀███╩███▀\r\n######¡  |######|  /##\\_  ▀▄▄▄▀\r\n#####|_\\  \\#####|  |####\\  \\\r\n########`__)###(._/######\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄▄▄\r\n######▄███████████▀´ `▀██████▄_\r\n####▄█████████████     ░( )███ )\r\n##▄▓▓▓████████████    ░▒▓▄█████▄\r\n##░░████▒▒▓▓▓▓▓████   .░▒█#███#█▄\r\n###█; `██▓▒░████████_  \\▀███╩███▀\r\n###|  !######/  /####\\  \\ ▀▄▄▄▀\r\n### \\  \\####/  /######!  \\\r\n#####.__)##(._/########\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄▄▄\r\n######▄███████████▀´ `▀██████▄_\r\n####▄█████████████     ░( )███ )\r\n##▄▓▓▓████████████    ░▒▓▄█████▄\r\n##░░████▒▒▓▓▓▓▓███    .░▒█#███#█▄\r\n##; `████▓▒░████████_  \\▀███╩███▀\r\n#/  ! \\######/  /####\\  \\ ▀▄▄▄▀\r\n#\\  |__)####/  /######!  \\\r\n##.__)#####(._/########\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄▄▄\r\n######▄███████████▀´ `▀██████▄_\r\n####▄█████████████     ░( )███ )\r\n##▄▓▓▓████████████    ░▒▓▄█████▄\r\n##░░████▒▒▓▓▓█████_   .░▒█#███#█▄\r\n##; `▀▀███▓░███████   \\ ▀███╩███▀\r\n#/  !  \\####|  /####\\  \\  ▀▄▄▄▀\r\n#\\  |\\__)###/  /######!  \\\r\n##.__)#####(._/########\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄▄▄\r\n######▄███████████▀´ `▀██████▄_\r\n####▄█████████████     ░( )███ )\r\n##▄▓▓▓████████████    ░▒▓▄█████▄\r\n##░░████▒▒▓▓▓█████_   .░▒█#███#█▄\r\n##; `▀▀█▓▓▓░███████|  \\ ▀███╩███▀\r\n#/  !`   \\###|  \\###\\  \\  ▀▄▄▄▀\r\n#|  |##`__)###\\__)###!  \\\r\n##.__)################\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄▄▄\r\n######▄███████████▀´ `▀██████▄_\r\n####▄████████████      ░( )███ )\r\n##▄▓▓▓███████████     ░▒▓▄█████▄\r\n##░░████▒▒▓▓▓████_    .░▒█#███#█▄\r\n##; `▀▀█▓▓▓░████\\ \\  \\--▀███╩███▀\r\n#/  !#|   |######\\_\\  \\   ▀▄▄▄▀\r\n#|  |##\\   \\#######!  |\r\n##.__)##\\___)#######\\__)\r\nasciiend\r\n^]\r\n//0 : openeye\r\n//1 : blinkeye\r\n//2 : closedeye\r\n//3 : happyeye\r\nvar phiz = [\r\n^ascii\r\no###o\r\nasciiend,\r\n^ascii\r\n=###=\r\nasciiend,\r\n^ascii\r\n ### \r\nasciiend,\r\n^ascii\r\n^###^\r\nasciiend]\r\n  \r\nvar count = animationFrames.Count()\r\nvar frame = 0\r\nvar phizFrame = 0\r\n\r\nvar minDistance = 38 //minimum distance\r\nvar x = pos.x - minDistance\r\nvar z = pos.z\r\nvar side = true\r\nvar speed = 0\r\nvar t = 0\r\nvar phizTimer = 0\r\n\r\n\r\nfunc PlayAnimation()\r\n  // target location\r\n  var d = pos.x - minDistance\r\n\r\n  //setup outset position\r\n  ?loc.loop | (time = 1 & loc ! rocky)\r\n    x = d\r\n    z = pos.z\r\n    speed = 0\r\n    t = 0\r\n  \r\n  ?x >= d\r\n    speed = 0\r\n  :?speed ! 1\r\n    ?x < d - 20 // 5 + 5 + 10\r\n      speed = 1\r\n    :?x < d - 10 // 5 + 5\r\n      speed = 2\r\n    :?x < d - 5 // 5\r\n      speed = 3\r\n\r\n\r\n  //speed = count - math.clamp(speed, 0, count - 1)\r\n  ?speed <= 1 | !(time % (speed - 1))\r\n    //move\r\n    ?speed ! 0 & (x < d | z ! pos.z)\r\n      frame = (frame + 1) % count\r\n      ?x < d\r\n        x++\r\n        ?speed = 1\r\n          t = (t + 1) % 30\r\n          ?t = 0\r\n            >`0,5,@t@\r\n            x++\r\n      ?z > pos.z\r\n        z--\r\n      :?z < pos.z\r\n        z++\r\n    : //stop\r\n      frame = 0\r\n      t = 0\r\n    \r\n  ?phizTimer <= 0\r\n    phizTimer = 120 + rng % 30\r\n  phizTimer--\r\n  ?foe = boss & foe.hp <= 0\r\n    phizFrame = 3\r\n    phizTimer = 60\r\n  :?phizFrame = 3\r\n    ?phizTimer = 0\r\n      phizFrame = 1\r\n      phizTimer = 4\r\n  :\r\n    ?phizTimer <= 4\r\n      ?phizTimer = 4 | phizTimer = 0\r\n        phizFrame = 1\r\n      :?phizTimer < 4 & phizTimer > 0\r\n        phizFrame = 2\r\n    :\r\n      phizFrame = 0\r\n  ?frame = 0\r\n    side = !(phizTimer <= 28 | phizFrame = 3)\r\n  var sx = x - pos.x\r\n  ?-sx < 100 //keep in screen\r\n    var sy = z - pos.z + pos.y - 5\r\n    ?side\r\n      var currentframe = animationFramesSide[frame]\r\n      >o@sx@,@sy@,#white,@currentframe@\r\n    :\r\n      var currentframe = animationFrames[frame]\r\n      >o@sx@,@sy@,#white,@currentframe@\r\n\r\n      var eyeposX = sx + 26\r\n      var eyeposY = sy + 4\r\n\t  \r\n      var currentPhizFrame = phiz[phizFrame]\r\n      >o@eyeposX@,@eyeposY@,#white,@currentPhizFrame@\r\nPlayAnimation()"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Cranius.txt" - Parse error: Failed to parse completely. Remaining: "= #808080   //grey\r\n\r\n//CHOOSE YOUR CHEST---------------------------------------<\r\n//Replace with one below: bone | delta\r\nchestType = delta\r\n\r\n?chestType = bone\r\n  chestColor = #white\r\n:?chestType = delta\r\n  chestColor = #rainbow\r\n\r\nvar keepDistance = -50 // distance at which the movement animation will play (stateMoving)\r\nvar maxX = -24         // closest offset pet will get to character.  Closer to 0, closer to character\r\nvar maxDistance = -70  // if the pet exceeds this distance, it will teleport to this distance (cannot be further away than this)\r\nvar targetZ = 2       // We want to start the drawing 1 unit above the player agent\r\n\r\n?loc.loop\r\n  keepDistance = -50\r\n  maxX = -24\r\n  maxDistance = -70\r\n  targetZ = 2\r\n\r\nvar x = 0\r\nvar y = 0\r\nvar myX = 0\r\nvar myZ = 0\r\nvar lastPlayerX = 0\r\nvar lastPlayerZ = 0\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1\r\nvar stateMoving = 2\r\nvar currentState = stateNone\r\nvar stateTime = 0\r\nvar chestTime = 0\r\n\r\n\r\nfunc SetState(newState)\r\n  ?newState = stateMoving\r\n    play haunted_gate_shuffle //play sound when moving\r\n  currentState = newState\r\n  stateTime = 0\r\n\r\n?currentState = stateNone | time = 1\r\n  lastPlayerX = pos.x\r\n  lastPlayerZ = pos.z\r\n  myX = keepDistance\r\n  myZ = targetZ\r\n\r\n// Start further away if skully is summoned while the location is already running\r\n  ?time > 1\r\n    myX = maxDistance\r\n\r\n  SetState(stateIdle)\r\n\r\nmyX = myX - (pos.x - lastPlayerX) // If player has moved, increment myX (distance from player)\r\n\r\nstateTime++\r\n\r\n?face = \"( ^^\" & stateTime > 30\r\n  chestTime++\r\n?face ! \"( ^^\"\r\n  chestTime = 0\r\n\r\n?currentState = stateIdle \r\n  ?myX < maxDistance | myX > -maxDistance\r\n    myX = maxDistance\r\n  myZ = myZ - (pos.z - lastPlayerZ)\r\n\r\n  ?myX < keepDistance\r\n    SetState(stateMoving)\r\n\t\r\n:?currentState = stateMoving & chestTime = 0\r\n  ?myX < maxX\r\n    myX++\r\n\t\r\n  ?stateTime >= 6\r\n    ?myZ > targetZ\r\n      myZ--\r\n    :?myZ < targetZ\r\n      myZ++\r\n\r\n  ?stateTime >= 12\r\n    SetState(stateIdle)\r\n\t\r\nlastPlayerX = pos.x\r\nlastPlayerZ = pos.z\r\n\r\n//DRAW state timers--------------------------------<\r\n//for debugging or whatever, uncomment if you want to see\r\n\r\n//>`0,7,StateTime = @stateTime@\r\n//>`0,8,ChestTime = @chestTime@\r\n\r\n//IDLE---------------------------------------------<\r\n\r\n?currentState = stateIdle & face ! \"( ^^\" \r\n  >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n###########_.-----._ ___///‾`\r\n#########.'         '.     '.|\r\n########/    ___,  __,\\     |;\r\n#######|  \\ (_*) ,(_*);-----|.\r\n#######|   ) _  /!)   )     | |\r\n########`.__,.)     ('      |  .\r\n#######/  '.  `'\"\"'´/.______|. '.\r\n######| \\  \\‾._____/ ;.._   `.  |\r\n######|. '-.__,''._.'####‾‾-____)\r\n######\\ '.___,''._.'\r\n#####.' \\__\\##/__/\r\n####[_.'####\r\nasciiend\r\n  >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#\r\n#####################___\r\n###########################'.\r\n############################|\r\n#######################-----|\r\n############################|\r\n############################|\r\n######################______|\r\nasciiend\r\n    >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n######(  )\r\n#######\\ \\\r\n########\\ \\\r\n#########\\ \\\r\n##########\\ \"..______.-‾‾‾`.\r\n###########(________;__,-\\\\\\>\r\nasciiend\r\n\r\n//EYES----------------------------------------<\r\n?currentState = stateIdle\r\n  ?face = \"°°\"\r\n      ?time % 10 = 0 & myX > keepDistance\r\n        myX--\r\n\r\n      ?time % 4 <= 1\r\n        >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#############___,  __,\r\n############(_^) ,(_^)\r\nasciiend\r\n      ?time % 4 > 1\r\n       >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#############___,  __,\r\n############(_^) ,(_^)\r\nasciiend\r\n\r\n//BLINKING----------------------------\r\n\r\n  ?face ! \"( ^^\"\r\n    ?stateTime % 50 >= 48\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#############___,  __,\r\n############(==) ,(==)\r\nasciiend\r\n    :?stateTime % 50 >= 46\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#############___,  __,\r\n############(--) ,(--)\r\nasciiend\r\n    :?stateTime % 50 >= 44\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#############___,  __,\r\n############(==) ,(==)\r\nasciiend\r\n\r\n//CHEST ANIMATION-----------------------------------------------<\r\n\r\n  x = myX + 6\r\n  y = myZ + 4\r\n?face = \"( ^^\" \r\n ?chestTime <= 5\r\n\t  >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n###########_.-----._ ___///‾`\r\n#########.'         '.     '.|\r\n########/    ___,  __,\\     |;\r\n#######|  \\ (_*) ,(_*);-----|.\r\n#######|   ) _  /!)   )     | |\r\n########`.__,.)     ('      |  .\r\n#######/  '.  `'\"\"'´/.______|. '.\r\n######| \\  \\‾._____/ ;.._   `.  |\r\n######|. '-.__,''._.'####‾‾-____)\r\n######\\ '.___,''._.'\r\n#####.' \\__\\##/__/\r\n####[_.'####\r\nasciiend\r\n      >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#\r\n#####################___\r\n###########################'.\r\n############################|\r\n#######################-----|\r\n############################|\r\n############################|\r\n######################______|\r\nasciiend\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n######(  )\r\n#######\\ \\\r\n########\\ \\\r\n#########\\ \\##########_.'‾‾.\r\n##########\\ \"..______.     ‾,\r\n###########(________(_____,/\r\nasciiend\r\n//-------------------------------\r\n :?chestTime <= 10\r\n\t  >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n###########_.-----._ ___///‾`\r\n#########.'         '.     '.|\r\n########/    ___,  __,\\     |;\r\n#######|  \\ (_*) ,(_*);-----|.\r\n#######|   ) _  /!)   )     | |\r\n########`.__,.)     ('      |  .\r\n#######/  '.  `'\"\"'´/.______|. '.\r\n######| \\  \\‾._____/ ;.._   `.  |\r\n######|. '-.__,''._.'####‾‾-____)\r\n######\\ '.___,''._.'\r\n#####.' \\__\\##/__/\r\n####[_.'####\r\nasciiend\r\n  >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#\r\n#####################___\r\n###########################'.\r\n############################|\r\n#######################-----|\r\n############################|\r\n############################|\r\n######################______|\r\nasciiend\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n######(  )\r\n#######\\ \\\r\n########\\ \\\r\n#########\\ \\\r\n##########\\ \"..______.->####.\r\n###########(________;____;//\r\nasciiend\r\n      ?chestType = bone\r\n        >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n########################\r\n########################---\r\n#\r\nasciiend\r\n      :?chestType = delta\r\n       >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n########################\r\n########################---\r\n#\r\nasciiend\r\n :?chestTime <= 45\r\n\t  >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n###########_.-----._ ___///‾`\r\n#########.'         '.     '.|\r\n########/    ___,  __,\\     |;\r\n#######|  \\ (_*) ,(_*);-----|.\r\n#######|   ) _  /!)   )     | |\r\n########`.__,.)     ('      |  .\r\n#######/  '.  `'\"\"'´/.______|. '.\r\n######| \\  \\‾._____/ ;.._   `.  |\r\n######|. '-.__,''._.'####‾‾-____)\r\n######\\ '.___,''._.'\r\n#####.' \\__\\##/__/\r\n####[_.'####\r\nasciiend\r\n      >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#\r\n#####################___\r\n###########################'.\r\n############################|\r\n#######################-----|\r\n############################|\r\n############################|\r\n######################______|\r\nasciiend\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n######(  )\r\n#######\\ \\\r\n########\\ \\\r\n#########\\ \\\r\n##########\\ \"..______.->####,\r\n###########(________;____;//\r\nasciiend\r\n      ?chestType = bone\r\n        >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n########################___\r\n########################=o=╪3\r\n#\r\nasciiend\r\n      ?chestType = delta\r\n        >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n########################___\r\n########################-∆-╡\r\n#\r\nasciiend\r\n//-------------------------------\r\n :?chestTime <= 50\r\n\t  >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n###########_.-----._ ___///‾`\r\n#########.'         '.     '.|\r\n########/    ___,  __,\\     |;\r\n#######|  \\ (_*) ,(_*);-----|.\r\n#######|   ) _  /!)   )     | |\r\n########`.__,.)     ('      |  .\r\n#######/  '.  `'\"\"'´/.______|. '.\r\n######| \\  \\‾._____/ ;.._   `.  |\r\n######|. '-.__,''._.'####‾‾-____)\r\n######\\ '.___,''._.'\r\n#####.' \\__\\##/__/\r\n####[_.'####\r\nasciiend\r\n      >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#\r\n#####################___\r\n###########################'.\r\n############################|\r\n#######################-----|\r\n############################|\r\n############################|\r\n######################______|\r\nasciiend\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n######(  )\r\n#######\\ \\\r\n########\\ \\\r\n#########\\ \\##########_.'‾‾.\r\n##########\\ \"..______.     ‾,\r\n###########(________(_____,/\r\nasciiend\r\n//-------------------------------\r\n :?chestTime <= 60 | chestTime > 60\r\n\t  >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n###########_.-----._ ___///‾`\r\n#########.'         '.     '.|\r\n########/    ___,  __,\\     |;\r\n#######|  \\ (_*) ,(_*);-----|.\r\n#######|   ) _  /!)   )     | |\r\n########`.__,.)     ('      |  .\r\n#######/  '.  `'\"\"'´/.______|. '.\r\n######| \\  \\‾._____/ ;.._   `.  |\r\n######|. '-.__,''._.'####‾‾-____)\r\n######\\ '.___,''._.'\r\n#####.' \\__\\##/__/\r\n####[_.'####\r\nasciiend\r\n      >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#\r\n#####################___\r\n###########################'.\r\n############################|\r\n#######################-----|\r\n############################|\r\n############################|\r\n######################______|\r\nasciiend\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n######(  )\r\n#######\\ \\\r\n########\\ \\\r\n#########\\ \\\r\n##########\\ \"..______.-‾‾‾`.\r\n###########(________;__,-\\\\\\>\r\nasciiend\r\n\r\n\r\n//MOVING-------------------------------------------<\r\n?currentState = stateMoving\r\n  ?stateTime/2 = 0\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n###########_.-----._ ___///‾`\r\n#########.'         '.     '.|\r\n########/    ___,  __,\\     |;\r\n#######|  \\ (_*) ,(_*);-----|.\r\n#######|   ) _  /!)   )     | |\r\n########`.__,.)     ('      |  .\r\n#######/  '.  `'\"\"'´/.______|. '.\r\n######| \\  \\‾._____/ ;.._   `.  |\r\n######|. '-.__,''._.'####‾‾-____)\r\n######\\ '.___,''._.'\r\n#####.' \\__\\##/__/\r\n####[_.'####\r\nasciiend\r\n      >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#\r\n#####################___\r\n###########################'.\r\n############################|\r\n#######################-----|\r\n############################|\r\n############################|\r\n######################______|\r\nasciiend\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n######(  )\r\n#######\\ \\\r\n########\\ \\\r\n#########\\ \\\r\n##########\\ \"..______.-‾‾‾`.\r\n###########(________;__,-\\\\\\>\r\nasciiend\r\n\r\n  ?stateTime/2 = 1\r\n       >o@myX@,@myZ-12@,@skullColor@,ascii\r\n###########_.-----._ __///‾`\r\n#########.'         '.    '.|\r\n########/    ___,  __,\\    |;\r\n#######|  \\ (_*) ,(_*);----|.\r\n#######|   ) _  /!)   )    | |\r\n########`.__,.)     ('     |  .\r\n#######/  '.  `'\"\"'´/._____|. '.\r\n######| \\  \\‾._____/ ;._   `.  |\r\n######|. '-.__,''._.'###‾‾-____)\r\n######\\ '.___,''._.'\r\n#####.' \\__\\##/__/\r\n####[_.'####\r\n#\r\nasciiend\r\n      >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#####################__\r\n##########################'.\r\n###########################|\r\n#######################----|\r\n###########################|\r\n###########################|\r\n######################_____|\r\nasciiend\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n######(  )\r\n#######\\ \\\r\n########\\ \\\r\n#########\\ \\\r\n##########\\ \"..______.-‾‾‾`.\r\n###########(________;__,-///>\r\nasciiend\r\n\r\n  ?stateTime/2 = 2\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n###########_.-----._ _///‾`\r\n#########.'         '.   '.|\r\n########/    ___,  __,\\   |;\r\n#######|  \\ (_*) ,(_*);---|.\r\n#######|   ) _  /!)   )   | |\r\n########`.__,.)     ('    |  .\r\n#######/  '.  `'\"\"'´/.____|. '.\r\n######| \\  \\‾._____/ ;_   `.  |\r\n######|. '-.__,''._.'##‾‾-____)\r\n######\\ '.___,''._.'\r\n#####.' \\__\\##/__/\r\n####[_.'####\r\n#\r\nasciiend\r\n      >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#####################_\r\n#########################'.\r\n##########################|\r\n#######################---|\r\n##########################|\r\n##########################|\r\n######################____|\r\nasciiend\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n######(  )\r\n######| ;\r\n######| |\r\n######| |\r\n######\" '\r\n######. \\._______.-‾‾‾`.\r\n######(________;__,-///>\r\nasciiend\r\n  ?stateTime/2 = 3\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n###########_.-----._ _///‾`\r\n#########.'         '.   '.|\r\n########/    ___,  __,\\   |;\r\n#######|  \\ (_*) ,(_*);---|.\r\n#######|   ) _  /!)   )   | |\r\n########`.__,.)     ('    |  .\r\n#######/  '.  `'\"\"'´/.____|. '.\r\n######| \\  \\‾._____/ ;_   `.  |\r\n######|. '-.__,''._.'##‾‾-____)\r\n######\\ '.___,''._.'\r\n#####.' \\__\\##/__/\r\n####[_.'####\r\n#\r\nasciiend\r\n      >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#####################_\r\n#########################'.\r\n##########################|\r\n#######################---|\r\n##########################|\r\n##########################|\r\n######################____|\r\nasciiend\r\n    >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n######(  )\r\n######| ;\r\n######| |\r\n######| |\r\n######' '\r\n#####; '_______.-‾‾‾`.\r\n####(________;__,-///>\r\nasciiend\r\n\r\n  ?stateTime/2 = 4\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n###########_.-----._ _///‾`\r\n#########.'         '.   '.|\r\n########/    ___,  __,\\   |;\r\n#######|  \\ (_*) ,(_*);---|.\r\n#######|   ) _  /!)   )   | |\r\n########`.__,.)     ('    |  .\r\n#######/  '.  `'\"\"'´/.____|. '.\r\n######| \\  \\‾._____/ ;_   `.  |\r\n######|. '-.__,''._.'##‾‾-____)\r\n######\\ '.___,''._.'\r\n#####.' \\__\\##/__/\r\n####[_.'####\r\n#\r\nasciiend\r\n      >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#####################_\r\n#########################'.\r\n##########################|\r\n#######################---|\r\n##########################|\r\n##########################|\r\n######################____|\r\nasciiend\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n######(  )\r\n######; /\r\n#####/ /\r\n####/ /\r\n###; '.______.-‾‾‾`.\r\n##(________;__,-///>\r\nasciiend\r\n\r\n  ?stateTime/2 = 5\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n###########_.-----._ __///‾`\r\n#########.'         '.    '.|\r\n########/    ___,  __,\\    |;\r\n#######|  \\ (_*) ,(_*);----|.\r\n#######|   ) _  /!)   )    | |\r\n########`.__,.)     ('     |  .\r\n#######/  '.  `'\"\"'´/._____|. '.\r\n######| \\  \\‾._____/ ;._   `.  |\r\n######|. '-.__,''._.'###‾‾-____)\r\n######\\ '.___,''._.'\r\n#####.' \\__\\##/__/\r\n####[_.'####\r\n#\r\nasciiend\r\n      >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#####################__\r\n##########################'.\r\n###########################|\r\n#######################----|\r\n###########################|\r\n###########################|\r\n######################_____|\r\nasciiend\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n######(  )\r\n######;   '.\r\n#####‾ /    ‾. \r\n####_  / ‾‾-- ‾.___  \r\n###-               ‾‾.\r\n###((___---‾‾‾----,,///>\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/SpringBuddy.txt" - Parse error: Failed to parse completely. Remaining: "= [\r\n^[\"I served in the Yugoslav People's Army. That's where I met Clippy. He saved my coiled ass back during the Croatian War of Independence\",5],\r\n^[\"Just like my coil, Yugoslavia had its ups and downs. Unfortunately, it couldn't spring back the last time\",4],\r\n^[\"Ah, the good ol' days of SFRY (Socialist Federal Rebulic of Yugoslavia).. When we were all tightly wound together. Now, it feels like I'm just unraveling\",5],\r\n^[\"I thought I knew tension, but the breakup of Yugoslavia? That was a real stretch\",3],\r\n^[\"I was a proud Yugoslav, always ready to jump into action for my country.. or what's left of it\",4],\r\n^[\"Life as a sentient spring in Yugoslavia was complex. I was involved in mechanical engineering, politics, and even gymnastics!\",4],\r\n^[\"We spoke Serbo-Croatian.. or was it Croato-Serbian?\",3],\r\n^[\"Ah, Tito! He managed to keep the Soviets at bay, the West interested, and the Non-Aligned Movement aligned\",4],\r\n^[\"Yugoslavia's national sport? Political gymnastics! No one could perform a split like we could!\",4],\r\n^[\"We had a unique economic model: socialist self-managment. It meant you could be your own boss and still complain about the managment!\",4],\r\n^[\"Being Yugoslav was great! You could be anyone from 6 republics and 2 autonomous provinces, and still argue about who made the best burek!\",5],\r\n^[\"Slobodan Praljak was a Croatian General who died in 2017 when he drank poison in court after being convicted of war crimes\",4],\r\n^[\"I heard that Clippy fled Europe once the ICTY tribunal (International Criminal Tribunal for the former Yugoslavia) began its investigations\",5],\r\n^[\"After Yugoslavia broke up, Croatia got a large coastline due to the way the historical and administrative borders were drawn and left Bosnia and Herzegovina almost entirely landlocked. Ha! No beaches for you!\",7],\r\n^[\"Josip Broz Tito's death in 1980 led to a period of instability and eventual dissolution of Yugoslavia. Tito's strong leadership had held the country together, and his passing created a power vacuum that contributed to internal tensions\",7],\r\n^[\"The 'Titovka' was a distinctive cap worn by members of the Yugoslav People's Army. Its design was inspired by the Soviet ushanka hat but featured a star with a red five-pointed star badge\",6],\r\n^[\"The Yugo was a compact car manufactured in Yugoslavia during the 1980s it gained notoriety for its low cost and reputation for low quality. It became the butt of many jokes and was often cited as an example of automotive incompetence\",7],\r\n^[\"In Socialist Yugoslavia, car doesn't break down on road — road breaks down under car!                       ...Also car breaks down on road\",5],\r\n^]\r\n\r\nvar SpringXPosition\r\nvar SpringYPosition\r\nvar SpringYVector\r\nvar ResetPosition\r\nvar PlayerX\r\nvar Spring\r\nPlayerX = pos.x\r\n\r\nvar Said_A_Quip_Already\r\nvar Quip_Activation_Time = -1\r\nvar Quip_Text\r\nvar Quip_Text_Box\r\nvar Quip_Text_Draw = \"\"\r\nvar Quip_Text_Max_Length = 0\r\nvar Quip_Text_Max_Time\r\nvar Quip_X\r\nvar Quip_Y\r\nvar RandomSelection\r\n\r\n?totaltime = 1\r\n  Said_A_Quip_Already = false\r\n  Spring = ui.AddAnim(SpringJump)\r\n  Spring.duration = 20\r\n  Spring.loop = false\r\n  Spring.gamePause = true\r\n  Spring.anchor = top_left\r\n  Spring.dock = top_left\r\n  SpringXPosition = pos.x - 10\r\n  SpringYPosition = pos.z - 10\r\n  Spring.y = SpringYPosition\r\n  ResetPosition = true\r\n\r\n?PlayerX - SpringXPosition > 20\r\n  ?!Spring.playing\r\n    Spring.Play()\r\n    SpringYVector = SpringYPosition - (pos.z - 10)\r\n    play haunted_gate_point_lost 50\r\n\r\n?Spring.playing\r\n  SpringXPosition++\r\n  ?SpringYVector ! 0\r\n    ?time % (20/SpringYVector) = 0\r\n      ?SpringYVector > 0 \r\n        SpringYPosition--\r\n      :\r\n        SpringYPosition++\r\n      Spring.y = SpringYPosition\r\n\r\n?time ! totaltime & ResetPosition\r\n  ?loc=harder\r\n    SpringXPosition = PlayerX - 20\r\n    ResetPosition = false\r\n\r\n?ai.paused& !ai.walking & !Said_A_Quip_Already\r\n  var RngFactor = 10000 / Quips.Count() + 1\r\n  RandomSelection = math.FloorToInt(rng/RngFactor)\r\n  Quip_Text_Max_Length = string.Size(Quips[RandomSelection][0])\r\n  Quip_Text_Box = ui.AddPanel()\r\n  Quip_Text = ui.AddText(\"\")\r\n  Quip_X = math.Max(screen.FromWorldX(SpringXPosition - 15),0)\r\n  Quip_Y = math.Max(SpringYPosition - Quips[RandomSelection][1]/2 - 1, 0)\r\n\r\n  Quip_Text.anchor = top_left\r\n  Quip_Text.dock = top_left\r\n  Quip_Text_Box.anchor = top_left\r\n  Quip_Text_Box.dock = top_left\r\n\r\n  Quip_Text.x = Quip_X+1\r\n  Quip_Text.y = Quip_Y+1\r\n  Quip_Text.w = 35\r\n  Quip_Text.h = Quips[RandomSelection][1]\r\n  Quip_Text_Box.x = Quip_X\r\n  Quip_Text_Box.y = Quip_Y\r\n  Quip_Text_Box.w = 37\r\n  Quip_Text_Box.h = Quips[RandomSelection][1]+2\r\n  Said_A_Quip_Already = true\r\n  Quip_Text_Max_Time = 45*Quips[RandomSelection][1]\r\n  Quip_Activation_Time = Quip_Text_Max_Time\r\n\r\n  play scotty_out_of_treasure 100\r\n\r\n?Quip_Activation_Time > 0\r\n  Quip_Activation_Time--\r\n  Quip_Text_Draw = string.Sub( Quips[RandomSelection][0] ,0 ,(math.Min(Quip_Text_Max_Time-Quip_Activation_Time,Quip_Text_Max_Length)))\r\n  Quip_Text.text = Quip_Text_Draw\r\n:?Quip_Activation_Time = 0\r\n  Quip_Text_Box.Recycle()\r\n  Quip_Text.Recycle()\r\n  Quip_Activation_Time = -1\r\n\r\nSpring.x = screen.FromWorldX(SpringXPosition)"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/BlackHole.txt" - Parse error: Failed to parse completely. Remaining: "= #white\r\nvar ringColor = #rainFF\r\nvar eyeColor = #ff00ff\r\nvar particleColor1 = #yellow\r\nvar particleColor2 = #yellow\r\n\r\nvar uiAA = ui.AddAnim\r\nvar uiAB = ui.AddButton\r\nvar refX = 0\r\nvar refZ = 0\r\nrefX = pos.x + (screen.w/2)-(screen.x) - 45\r\nrefZ = pos.z - 16\r\nvar bX\r\nvar bY\r\nvar blackHole\r\nvar blackHole2\r\nvar holeEyes\r\nvar holeSize\r\nvar prtcl\r\nvar prtclBig\r\nvar prtclSize\r\nvar prtcls=[]\r\nvar pCount=-1\r\nvar spawnChance\r\nvar prtclX\r\nvar prtclZ\r\nvar spawnXrng\r\nvar spawnYrng\r\nvar spawnSizerng\r\nvar delete=[]\r\nvar holeTime\r\nvar kills\r\nvar fC\r\nvar oldfC=0\r\nvar fCdifference\r\n//from darkness script\\\\\r\nvar radius\r\nvar ShadePercentage\r\nvar BasePanel\r\nvar FilterList = []\r\nvar FilterList2 = []\r\nvar Shade\r\nvar ShadeHex\r\nvar lvl1btn\r\nvar lvl2btn\r\nvar lvl3btn\r\nvar lvl4btn\r\nvar lvl5btn\r\nvar lvlpnl\r\nvar menubtn\r\nvar menu=false\r\nvar unlock\r\nvar timer\r\nvar timebar\r\nvar killbar\r\n\r\nvar holeAsci1=ascii\r\n#\r\n#\r\n#\r\n#\r\n#######Φ######\r\n#\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n#\r\n#######_\r\n######( )\r\n#######¯\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n#\r\n######.-.\r\n#####(   )####\r\n######`-´\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n####.-¯¯-.\r\n###.      .\r\n###'      '###\r\n####`-__-´\r\n#\r\n#\r\n%%\r\n######__\r\n##.-¯¯  ¯¯-.\r\n#¡          ¡\r\n.            .\r\n'            '\r\n#!          !\r\n##'-__  __-'\r\n######¯¯\r\nasciiend\r\n\r\nvar holeAsci2=ascii\r\n#\r\n%%\r\n#\r\n#\r\n#\r\n######.\r\n#######\\\r\n########'\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n#\r\n#####.\r\n######¯-_\r\n#########'\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n###.\r\n####¯-_\r\n#######¯-_\r\n##########'\r\n#\r\n#\r\n%%\r\n#\r\n-_\r\n##-_\r\n####¯-_\r\n#######¯-_\r\n##########¯-\r\n############¯-\r\n#\r\nasciiend\r\n\r\nvar holeAsci3=ascii\r\n|\r\n###|\r\nasciiend\r\n\r\nprtcl=ascii\r\n•\r\nasciiend\r\n\r\nprtclBig=ascii\r\n@\r\nasciiend\r\n\r\nfunc BlackHole()\r\n  bX=refX\r\n  bY=refZ\r\n  blackHole=uiAA(holeAsci1)\r\n  blackHole.x=bX\r\n  blackHole.y=bY\r\n  blackHole.color=holeColor\r\n  blackHole2=blackHole.AddLayer(holeAsci2)\r\n  blackHole2.color=ringColor\r\n  ?holeSize=1\r\n    blackHole.frame=0\r\n  :?holeSize=2\r\n    blackHole.frame=1\r\n  :?holeSize=3\r\n    blackHole.frame=2\r\n  :?holeSize=4\r\n    blackHole.frame=3\r\n  :?holeSize=5\r\n    blackHole.frame=4\r\n    holeEyes=uiAA(holeAsci3)\r\n    holeEyes.x=bX+2\r\n    holeEyes.y=bY-1\r\n    holeEyes.color=eyeColor\r\n\r\nfunc Darkness()\r\n  ?holeSize=4\r\n    radius=8\r\n    ShadePercentage=30\r\n    Shade = ShadePercentage * 256 / 100\r\n    ShadeHex = color.FromRGB(Shade,Shade,Shade)\r\n  ?holeSize=5\r\n    radius=12\r\n    ShadePercentage=40\r\n    Shade = ShadePercentage * 256 / 100\r\n    ShadeHex = color.FromRGB(Shade,Shade,Shade)\r\n  BasePanel = ui.AddPanel()\r\n  BasePanel.visible = false\r\n  FilterList.Clear()\r\n  FilterList2.Clear()\r\n  for a=0..radius\r\n    FilterList.Add(ui.AddCanvas())\r\n    FilterList[a].w = math.RoundToInt(radius*3 - math.Abs(0.4*math.Pow((radius/2)-a,2)))\r\n    FilterList[a].h = 1\r\n    FilterList[a].y = (radius/2)-a\r\n    FilterList[a].blend = subtract\r\n    FilterList[a].SetFG(ShadeHex)\r\n    BasePanel.Add(FilterList[a])\r\n\r\n  for a=0..radius/2\r\n    FilterList2.Add(ui.AddCanvas())\r\n    FilterList2[a].w = math.RoundToInt(radius*1.5 - math.Abs(0.4*math.Pow((radius/4)-a,2)))\r\n    FilterList2[a].h = 1\r\n    FilterList2[a].y = (radius/4)-a\r\n    FilterList2[a].blend = subtract\r\n    FilterList2[a].SetFG(ShadeHex)\r\n    BasePanel.Add(FilterList2[a])\r\n\r\nfunc MoveHole()\r\n  ?time%30\r\n    ?blackHole.x<bX\r\n      blackHole.x=blackHole.x+1\r\n    :?blackHole.x>bX\r\n      blackHole.x=blackHole.x-1\r\n    ?blackHole.y<bY\r\n      blackHole.y=blackHole.y+1\r\n    :?blackHole.y>bY\r\n      blackHole.y=blackHole.y-1\r\n    ?holeSize=5\r\n      holeEyes.x=blackHole.x+2\r\n      holeEyes.y=blackHole.y-1\r\n    ?holeSize=4|holeSize=5\r\n      BasePanel.x=blackHole.x\r\n      BasePanel.y=blackHole.y\r\n\r\nfunc SpawnParticle()\r\n  ?prtclSize=1\r\n    var prtcl=uiAA(prtcl)\r\n    prtcl.x=prtclX\r\n    prtcl.y=prtclZ\r\n    prtcl.color=particleColor1\r\n  :?prtclSize=2\r\n    var prtcl=uiAA(prtclBig)\r\n    prtcl.x=prtclX\r\n    prtcl.y=prtclZ\r\n    prtcl.color=particleColor2\r\n  return prtcl\r\n\r\nfunc Particles()\r\n  spawnChance=rng\r\n  ?holeSize=3&time%75=0\r\n    ?spawnChance>=0&spawnChance<=9999\r\n      spawnXrng=rng%11\r\n      spawnYrng=rng%7\r\n      prtclSize=1\r\n      //x\r\n      ?spawnXrng=0\r\n        prtclX=bX-5\r\n      :?spawnXrng=1\r\n        prtclX=bX-4\r\n      :?spawnXrng=2\r\n        prtclX=bX-3\r\n      :?spawnXrng=3\r\n        prtclX=bX-2\r\n      :?spawnXrng=4\r\n        prtclX=bX-1\r\n      :?spawnXrng=5\r\n        prtclX=bX\r\n      :?spawnXrng=6\r\n        prtclX=bX+1\r\n      :?spawnXrng=7\r\n        prtclX=bX+2\r\n      :?spawnXrng=8\r\n        prtclX=bX+3\r\n      :?spawnXrng=9\r\n        prtclX=bX+4\r\n      :\r\n        prtclX=bX+5\r\n      //y\r\n      ?spawnYrng=0\r\n        prtclZ=bY-3\r\n      :?spawnYrng=1\r\n        prtclZ=bY-2\r\n      :?spawnYrng=2\r\n        prtclZ=bY-1\r\n      :?spawnYrng=3\r\n        prtclZ=bY\r\n      :?spawnYrng=4\r\n        prtclZ=bY+1\r\n      :?spawnYrng=5\r\n        prtclZ=bY+2\r\n      :\r\n        prtclZ=bY+3\r\n    prtcls.Add(SpawnParticle())\r\n  :?holeSize=4&time%45=0|holeSize=5&time%15=0\r\n      spawnXrng=rng%17\r\n      spawnYrng=rng%9\r\n      spawnSizerng=rng%2\r\n      //x\r\n      ?spawnXrng=0\r\n        prtclX=bX-9\r\n      :?spawnXrng=1\r\n        prtclX=bX-8\r\n      :?spawnXrng=2\r\n        prtclX=bX-7\r\n      :?spawnXrng=3\r\n        prtclX=bX-6\r\n      :?spawnXrng=4\r\n        prtclX=bX-5\r\n      :?spawnXrng=5\r\n        prtclX=bX-4\r\n      :?spawnXrng=6\r\n        prtclX=bX-3\r\n      :?spawnXrng=7\r\n        prtclX=bX-2\r\n      :?spawnXrng=8\r\n        prtclX=bX-1\r\n      :?spawnXrng=9\r\n        prtclX=bX\r\n      :?spawnXrng=10\r\n        prtclX=bX+1\r\n      :?spawnXrng=11\r\n        prtclX=bX+2\r\n      :?spawnXrng=12\r\n        prtclX=bX+3\r\n      :?spawnXrng=13\r\n        prtclX=bX+4\r\n      :?spawnXrng=14\r\n        prtclX=bX+5\r\n      :?spawnXrng=15\r\n        prtclX=bX+6\r\n      :?spawnXrng=16\r\n        prtclX=bX+7\r\n      :\r\n        prtclX=bX+8\r\n      //y\r\n      ?spawnYrng=0\r\n        prtclZ=bY-5\r\n      :?spawnYrng=1\r\n        prtclZ=bY-4\r\n      :?spawnYrng=2\r\n        prtclZ=bY-3\r\n      :?spawnYrng=3\r\n        prtclZ=bY-2\r\n      :?spawnYrng=4\r\n        prtclZ=bY-1\r\n      :?spawnYrng=5\r\n        prtclZ=bY\r\n      :?spawnYrng=6\r\n        prtclZ=bY+1\r\n      :?spawnYrng=7\r\n        prtclZ=bY+2\r\n      :?spawnYrng=8\r\n        prtclZ=bY+3\r\n      :\r\n        prtclZ=bY+4\r\n      ?spawnSizerng=0\r\n        prtclSize=1\r\n      :\r\n        prtclSize=2\r\n    prtcls.Add(SpawnParticle())\r\n\r\nfunc ParticleMove(p)\r\n    ?p.x<bX\r\n      p.x=p.x+1\r\n    :?p.x>bX\r\n      p.x=p.x-1\r\n    ?time%20=0\r\n      ?p.y<bY\r\n        p.y=p.y+1\r\n      :?p.y>bY\r\n        p.y=p.y-1\r\n    ?p.x=bX&p.y=bY\r\n      return true\r\n    return false\r\n\r\nvar remove\r\nvar count=0\r\n\r\nfunc ParticleRun()\r\n  ?time%10=0 & prtcls.Count()>0\r\n    for p : prtcls\r\n      ?ParticleMove(p)\r\n        delete.Add(count)\r\n        p.Recycle()\r\n      count++\r\n    count=0\r\n    ?delete.Count()>0\r\n      for d : delete\r\n        prtcls.Emplace(d,0)\r\n      for d : delete\r\n        remove=prtcls.IndexOf(0)\r\n        prtcls.RemoveAt(remove)\r\n      delete.Clear()\r\n\r\nfunc HoleXP()\r\n  >`0,9,#565656,ascii\r\n╔═╗\r\n║#║\r\n║#║\r\n║#║\r\n║#║\r\n╟_╢\r\n╟¯╢\r\n║#║\r\n║#║\r\n║#║\r\n║#║\r\n╚═╝\r\nasciiend\r\n  >`0,21,Lvl@holeSize@\r\n  fC=foe.GetCount(150)\r\n  ?totaltime%300=0\r\n    holeTime++\r\n  ?fC<oldfC\r\n    fCdifference=oldfC-fC\r\n    ?foe=\"boss\"\r\n      kills=kills+fCdifference-1+loc.stars\r\n    :\r\n      kills=kills+fCdifference\r\n  oldfC=fC\r\n  ?holeSize=1\r\n    timebar=((holeTime*100)/60)/20\r\n    killbar=((kills*100)/250)/20\r\n    ?holeTime>=60&kills>=250\r\n      LvlUp()\r\n  :?holeSize=2\r\n    timebar=((holeTime*100)/180)/20\r\n    killbar=((kills*100)/500)/20\r\n    ?holeTime>=180&kills>=500\r\n      LvlUp()\r\n  :?holeSize=3\r\n    timebar=((holeTime*100)/320)/20\r\n    killbar=((kills*100)/1500)/20\r\n    ?holeTime>=320&kills>=1500\r\n      LvlUp()\r\n  :?holeSize=4\r\n    timebar=((holeTime*100)/320)/20\r\n    killbar=((kills*100)/3000)/20\r\n    ?holeTime>=320&kills>=3000\r\n      BasePanel.Recycle()\r\n      LvlUp()\r\n      unlock=true\r\n  ?timebar>5\r\n    timebar=5\r\n  ?killbar>5\r\n    killbar=5\r\n  ?timebar>0\r\n    for i = 1..timebar\r\n      >`1,@20-i@,#ff00ff,█\r\n  ?killbar>0\r\n    for i = 1..killbar\r\n      >`1,@9+i@,#red,█\r\n\r\nfunc LvlUp()\r\n  holeTime=0\r\n  kills=0\r\n  holeSize++\r\n  blackHole.Recycle()\r\n  HoleStart()\r\n\r\nfunc Buttons()\r\n  menubtn=uiAB()\r\n  menubtn.dock=center_left\r\n  menubtn.anchor=center_left\r\n  menubtn.text=\"»\"\r\n  menubtn.tcolor=#ff00ff\r\n  menubtn.h=3\r\n  menubtn.w=3\r\n  menubtn.y=-6\r\n  menubtn.SetPressed(Menu)\r\n  lvl1btn=uiAB()\r\n  lvl1btn.text=\"Mini\"\r\n  lvl1btn.h=3\r\n  lvl1btn.w=9\r\n  lvl1btn.y=-6\r\n  lvl1btn.SetPressed(SetLvl)\r\n  lvl2btn=uiAB()\r\n  lvl2btn.text=\"Small\"\r\n  lvl2btn.h=3\r\n  lvl2btn.w=9\r\n  lvl2btn.y=-3\r\n  lvl2btn.SetPressed(SetLvl)\r\n  lvl3btn=uiAB()\r\n  lvl3btn.text=\"Medium\"\r\n  lvl3btn.h=3\r\n  lvl3btn.w=9\r\n  lvl3btn.y=0\r\n  lvl3btn.SetPressed(SetLvl)\r\n  lvl4btn=uiAB()\r\n  lvl4btn.text=\"Large\"\r\n  lvl4btn.h=3\r\n  lvl4btn.w=9\r\n  lvl4btn.y=3\r\n  lvl4btn.SetPressed(SetLvl)\r\n  lvl5btn=uiAB()\r\n  lvl5btn.text=\"Giant\"\r\n  lvl5btn.h=3\r\n  lvl5btn.w=9\r\n  lvl5btn.y=6\r\n  lvl5btn.SetPressed(SetLvl)\r\n  lvlpnl=ui.AddPanel()\r\n  lvlpnl.dock=center_left\r\n  lvlpnl.anchor=center_left\r\n  lvlpnl.y=3\r\n  lvlpnl.Add(lvl1btn)\r\n  lvlpnl.Add(lvl2btn)\r\n  lvlpnl.Add(lvl3btn)\r\n  lvlpnl.Add(lvl4btn)\r\n  lvlpnl.Add(lvl5btn)\r\n  lvlpnl.visible=false\r\n\r\nfunc Menu()\r\n  ?unlock\r\n    menu=!menu\r\n    ?menu\r\n      menubtn.text=\"«\"\r\n      lvlpnl.visible=true\r\n    :\r\n      menubtn.text=\"»\"\r\n      lvlpnl.visible=false\r\n  :\r\n      timer=0\r\n\r\nfunc Text()\r\n  ?timer!30\r\n    >`3,7,#red,Black Hole Level 5 Required\r\n    timer++\r\n\r\nfunc SetLvl(btn)\r\n  blackHole.Recycle()\r\n  ?holeSize=4|holeSize=5\r\n    BasePanel.Recycle()\r\n    ?holeSize=5\r\n      holeEyes.Recycle()\r\n  ?btn=lvl1btn\r\n    holeSize=1\r\n  :?btn=lvl2btn\r\n    holeSize=2\r\n  :?btn=lvl3btn\r\n    holeSize=3\r\n  :?btn=lvl4btn\r\n    holeSize=4\r\n  :?btn=lvl5btn\r\n    holeSize=5\r\n  HoleStart()\r\n\r\nfunc HoleStart()\r\n  ?holeSize=4|holeSize=5\r\n    Darkness()\r\n  BlackHole()\r\n\r\n?totaltime=1\r\n  holeSize=storage.Get(\"size\",1)\r\n  holeTime=storage.Get(\"time\",0)\r\n  kills=storage.Get(\"kills\",0)\r\n  unlock=storage.Get(\"unlock\",false)\r\n  timer=30\r\n  prtcls.Clear()\r\n  HoleStart()\r\n  Buttons()\r\n?pickup=\"treasure\"\r\n  storage.Set(\"time\",holeTime)\r\n  storage.Set(\"kills\",kills)\r\n  storage.Set(\"size\",holeSize)\r\n  storage.Set(\"unlock\",unlock)\r\n?key=bumpRBegin\r\n  holeTime=0\r\n  kills=0\r\n?holeSize=1\r\n  bX=refX-5\r\n  bY=refZ\r\n:?holeSize=2\r\n  bX=refX-7\r\n  bY=refZ-1\r\n:?holeSize=3\r\n  bX=refX-10\r\n  bY=refZ-2\r\n:?holeSize=4\r\n  bX=refX-11\r\n  bY=refZ-3\r\n:?holeSize=5\r\n  bX=refX-16\r\n  bY=refZ-4\r\n?unlock=false\r\n  HoleXP()\r\nMoveHole()\r\nParticles()\r\nParticleRun()\r\nText()\r\n\r\nvar holeGun=ascii\r\n──┬──\r\n#( )\r\n#╧Φ╧{\r\n%%\r\n──┬──\r\n╒(_)╕\r\n╧(│)╧{\r\n##¯\r\n%%\r\n───┬───\r\n╒/  |\\╕\r\n╞\\.┬./╡/\r\n╧( │ )╧│\r\n##`┴´##\\\r\nasciiend\r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/TarPusher.txt" - Parse error: Failed to parse completely. Remaining: "= #FFFFFF\r\n\r\n// FRAMES START HERE\r\n\r\n?(pusherFrame = 1 | !ai.walking)\r\n  pusher = ascii\r\n###O#####\r\n##/‾│‾‾‾‾│\r\n#/#\\└()()┘\r\nasciiend\r\n:?pusherFrame = 2\r\n  pusher = ascii\r\n###O#####\r\n##/‾│‾‾‾‾│\r\n#/|#└()()┘\r\nasciiend\r\n:?pusherFrame = 3\r\n  pusher = ascii\r\n###O#####\r\n##/‾│‾‾‾‾│\r\n#V|#└()()┘\r\nasciiend\r\n:?pusherFrame = 4\r\n  pusher = ascii\r\n###O#####\r\n##/‾│‾‾‾‾│\r\n##|>└()()┘\r\nasciiend\r\n\r\n?foe = boss & ai.walking = false & pusherFrame\r\n^ = 1\r\n  pusher = ascii\r\n#########\r\n#<O>│‾‾‾‾│\r\n#<'>└()()┘\r\nasciiend\r\n?foe = boss & ai.walking = false & pusherFrame\r\n^ = 2\r\n  pusher = ascii\r\n#.#,#####\r\n#<O>│‾‾‾‾│\r\n#<'>└()()┘\r\nasciiend\r\n?foe = boss & ai.walking = false & pusherFrame\r\n^ = 3\r\n  pusher = ascii\r\n`###´####\r\n#<O>│‾‾‾‾│\r\n#<'>└()()┘\r\nasciiend\r\n?foe = boss & ai.walking = false & pusherFrame\r\n^ = 4\r\n  pusher = ascii\r\n#########\r\n#<O>│‾‾‾‾│\r\n#<'>└()()┘\r\nasciiend\r\n\r\n?foe = boss & ai.walking = true & pusherFrame\r\n^ = 1\r\n  pusher = ascii\r\n###O#####\r\n##/‾│‾‾‾‾│\r\n#/#\\└()()┘\r\nasciiend\r\n?foe = boss & ai.walking = true & pusherFrame\r\n^ = 2\r\n  pusher = ascii\r\n##.O#####\r\n##/‾│‾‾‾‾│\r\n#/|#└()()┘\r\nasciiend\r\n?foe = boss & ai.walking = true & pusherFrame\r\n^ = 3\r\n  pusher = ascii\r\n#`#O´####\r\n##/‾│‾‾‾‾│\r\n#V|#└()()┘\r\nasciiend\r\n?foe = boss & ai.walking = true & pusherFrame\r\n^ = 4\r\n  pusher = ascii\r\n###O#####\r\n##/‾│‾‾‾‾│\r\n##|>└()()┘\r\nasciiend\r\n\r\n?pickup.distance < 5 & ai.walking = false\r\n  pusher = ascii\r\n#\\O/#####\r\n##|#│‾‾‾‾│\r\n#/#\\└()()┘\r\nasciiend\r\n\r\n// THE TAR\r\n\r\ntar = ascii\r\n#####.≈≈,\r\n##########\r\n##########\r\nasciiend\r\n\r\n>o-@tarX@,@tarY@,@tarcolour@,@tar@\r\n\r\n>o-@pusherX@,@pusherY@,@pusher@\r\n\r\n// END"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Dog.txt" - Parse error: Failed to parse completely. Remaining: "= #white\r\n\r\nvar keepDistance = -36\r\nvar maxX = -19\r\n\r\nvar maxDistance\r\nmaxDistance = -70\r\n\r\nvar targetZ = -4\r\n\r\nvar x = 0\r\nvar y = 0\r\nvar myX = 0\r\nvar myZ = 0\r\nvar lastPlayerX = 0\r\nvar lastPlayerZ = 0\r\n\r\nvar headX = 8\r\nvar headY = -2\r\nvar bodyX = 5\r\nvar bodyY = 1\r\nvar petX\r\nvar petY\r\nvar lastInputX = 0\r\nvar isPettingHead = false\r\nvar isPettingBody = false\r\nvar pettingDirection = 0\r\n\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1\r\nvar stateBark = 2\r\nvar stateJump = 3\r\nvar stateStopping = 4\r\nvar currentState = stateNone\r\nvar stateTime = 0\r\n\r\nvar barkDuration = 6\r\n\r\n\r\nfunc SetState(newState)\r\n  ?newState = stateJump\r\n    play haunted_gate_shuffle\r\n\r\n  currentState = newState\r\n  stateTime = 0\r\n\r\n\r\n?currentState = stateNone | time = 1\r\n  lastPlayerX = pos.x\r\n  lastPlayerZ = pos.z\r\n  myX = keepDistance\r\n  myZ = targetZ\r\n\r\n  // Start further away if the frog is summoned while the location is already running\r\n  ?time > 1\r\n    myX = maxDistance\r\n\r\n  SetState(stateIdle)\r\n\r\n\r\n// Bark input\r\n?key = primaryBegin\r\n  play dog_bark\r\n  ?currentState = stateIdle\r\n    SetState(stateBark)\r\n  :?currentState = stateBark\r\n    stateTime = 1\r\n\r\n\r\nmyX = myX - (pos.x - lastPlayerX)\r\n\r\nstateTime++\r\n\r\n?currentState = stateIdle\r\n  ?myX < maxDistance | myX > -maxDistance\r\n    myX = maxDistance\r\n  myZ = myZ - (pos.z - lastPlayerZ)\r\n\r\n  ?myX < keepDistance\r\n    SetState(stateJump)\r\n  :\r\n    petX = screen.FromWorldX(pos.x) + myX\r\n    petY = screen.FromWorldZ(pos.z - pos.y) + myZ\r\n    ?input.x >= petX + headX & input.x <= petX + headX + 5 & \r\n^    input.y >= petY + headY & input.y <= petY + headY + 2\r\n      isPettingHead = true\r\n      isPettingBody = false\r\n      ?input.x < lastInputX\r\n        pettingDirection -= 3\r\n      :?input.x > lastInputX\r\n        pettingDirection += 3\r\n    :?input.x >= petX + bodyX & input.x <= petX + bodyX + 6 & \r\n^    input.y >= petY + bodyY & input.y <= petY + bodyY + 2\r\n      isPettingHead = false\r\n      isPettingBody = true\r\n      ?input.x < lastInputX\r\n        pettingDirection -= 3\r\n      :?input.x > lastInputX\r\n        pettingDirection += 3\r\n    :\r\n      isPettingHead = false\r\n      isPettingBody = false\r\n    lastInputX = input.x\r\n    ?pettingDirection > 0\r\n      pettingDirection--\r\n    :?pettingDirection < 0\r\n      pettingDirection++\r\n\r\n\r\n:?currentState = stateBark\r\n  ?stateTime >= barkDuration\r\n    SetState(stateIdle)\r\n  myZ = myZ - (pos.z - lastPlayerZ)\r\n\r\n:?currentState = stateJump\r\n  ?myX < maxX\r\n    myX++\r\n\r\n  ?stateTime >= 6 & time % 2 = 0\r\n    ?myZ > targetZ\r\n      myZ--\r\n    :?myZ < targetZ\r\n      myZ++\r\n\r\n  ?stateTime >= 12\r\n    ?myX < maxX - 1\r\n      SetState(stateJump)\r\n    :\r\n      SetState(stateStopping)\r\n\r\n:?currentState = stateStopping\r\n  ?stateTime >= 1\r\n    SetState(stateIdle)\r\n\r\n\r\nlastPlayerX = pos.x\r\nlastPlayerZ = pos.z\r\n\r\n\r\n// Draw\r\n\r\n?currentState = stateIdle\r\n  >o@myX@,@myZ@,@petColor@,ascii\r\n#\r\n#\r\n#########|\\´/\r\n#########/   -,\r\n######,-´ `--´\r\n#####/ _   ;\r\n#### , _)\\(\r\n#### `-'  `\"\r\nasciiend\r\n\r\n  x = myX + 8\r\n  y = myZ + 3\r\n  \r\n  ?face = \"^^\" | isPettingHead | isPettingBody\r\n    >o@x@,@y@,@petColor@,ascii\r\n#/ ^^\r\nasciiend\r\n\r\n  :?(bighead = false & time % 90 > 8) | face = \"''\" | face = \",,\" | face = \"°°\"\r\n    >o@x@,@y@,@petColor@,ascii\r\n#/ ''\r\nasciiend\r\n\r\n\r\n  // Petting\r\n\r\n  ?isPettingHead & pettingDirection < -1\r\n    >o@x@,@y - 1@,@petColor@,ascii\r\n#|\\\\ #\r\nasciiend\r\n  :?isPettingHead & pettingDirection > 1\r\n    >o@x@,@y - 1@,@petColor@,ascii\r\n# /|/\r\nasciiend\r\n\r\n  ?isPettingBody\r\n    ?time % 6 = 0 | time % 6 = 1\r\n      >o@x - 4@,@y + 2@,@petColor@,ascii\r\n#/´¯)/\r\n#_ -´\r\n#   #\r\nasciiend\r\n    ?time % 6 = 2\r\n      >o@x - 4@,@y + 2@,@petColor@,ascii\r\n#/´¯),:\r\n#_ -´ ;\r\n# `--´\r\nasciiend\r\n    ?time % 6 = 3\r\n      >o@x - 4@,@y + 2@,@petColor@,ascii\r\n#/ _\r\n#_  )\r\n# `--'\r\nasciiend\r\n    ?time % 6 = 4\r\n      >o@x - 4@,@y + 2@,@petColor@,ascii\r\n#/.-.\r\n#_ -',\r\n# `¯´\r\nasciiend\r\n    ?time % 6 = 5\r\n      >o@x - 4@,@y + 2@,@petColor@,ascii\r\n#/,´),\r\n#_ .-´\r\n#   #\r\nasciiend\r\n\r\n\r\n  // Tongue\r\n  \r\n  y++\r\n  \r\n  ?time % 100 < 50\r\n    ?time % 100 <= 3 | time % 100 >= 46\r\n      >o@x@,@y@,@petColor@,ascii\r\n# `--'\r\nasciiend\r\n\r\n    :?time % 100 <= 7 | time % 100 >= 42\r\n      >o@x@,@y@,@petColor@,ascii\r\n# `-';\r\nasciiend\r\n\r\n    :?time % 8 <= 3\r\n      >o@x@,@y@,@petColor@,ascii\r\n# `-\\)\r\nasciiend\r\n    :\r\n      >o@x@,@y@,@petColor@,ascii\r\n# `-`'\r\nasciiend\r\n\r\n\r\n?currentState = stateBark\r\n  ?stateTime = 0 | stateTime = (barkDuration - 1)\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n#\r\n#\r\n#########|\\|\r\n#########/  `-,\r\n######,-´ `--`\r\n#####/ _   ;\r\n#### , _)\\(\r\n#### `-'  `\"\r\nasciiend\r\n  :\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n#\r\n#\r\n#########\\``--,\r\n#########/ _.-'\r\n######,-´  '\r\n#####/ _   ;\r\n#### , _)\\(\r\n#### `-'  `\"\r\nasciiend\r\n\r\n\r\n?currentState = stateIdle | currentState = stateBark\r\n  // Tail\r\n  \r\n  x = myX\r\n  y = myZ + 5\r\n  \r\n  ?time % 10 <= 1\r\n    >o@x@,@y@,@petColor@,ascii\r\n#\r\n#,--'\r\n#`- ‾\r\nasciiend\r\n\r\n  :?time % 10 = 2\r\n    >o@x@,@y@,@petColor@,ascii\r\n#\r\n#,--'\r\n#\\' ‾\r\nasciiend\r\n\r\n  :?time % 10 = 3\r\n    >o@x@,@y@,@petColor@,ascii\r\n#\r\n,--'´\r\n'´ ‾ \r\nasciiend\r\n\r\n  :?time % 10 = 4\r\n    >o@x@,@y@,@petColor@,ascii\r\n#_\r\n#\\`'´\r\n##`‾ \r\nasciiend\r\n\r\n  :?time % 10 = 5 | time % 10 = 6\r\n    >o@x@,@y@,@petColor@,ascii\r\n##,\r\n#(`'´\r\n##‾  \r\nasciiend\r\n\r\n  :?time % 10 = 7\r\n    >o@x@,@y@,@petColor@,ascii\r\n#,\r\n#\\`-´\r\n##‾‾ \r\nasciiend\r\n\r\n  :?time % 10 = 8\r\n    >o@x@,@y@,@petColor@,ascii\r\n#\r\n\\---'\r\n#` ‾ \r\nasciiend\r\n\r\n  :?time % 10 = 9\r\n    >o@x@,@y@,@petColor@,ascii\r\n#\r\n#,--'\r\n´‾ ‾‾\r\nasciiend\r\n\r\n\r\n\r\n?currentState = stateJump\r\n  ?stateTime/2 = 0\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n#\r\n###########-.-,\r\n##########.´ ''-,\r\n#;###.--'´  `--´\r\n#\\`-´   _  /\r\n##`´#\\ )| /`.\r\n#####(( ;/ `'\r\n######`\"´\r\nasciiend\r\n\r\n  :?stateTime/2 = 1\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n###########-.-,\r\n###########/ ''-,\r\n#######_.-´ `--´\r\n#,##,-´     /\r\n('-´    _. /`-.\r\n#`'´| ;‾#`,|##`'\r\n####// \\#.-'\r\n###`'##`'\r\nasciiend\r\n\r\n  :?stateTime/2 = 2\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n###########|\\´/\r\n#########_.´ ''-,\r\n####,-'´    `--´\r\n,.-´     _  )_\r\n`-'/ _.´##'--,)\r\n#,´.´.######, \r\n#|| (####### `'\r\n#`'#`'\r\nasciiend\r\n\r\n  :?stateTime/2 = 3\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n#\r\n###########;(,|\r\n,.---._ __.' ''-,\r\n`-'´.       `--´\r\n###/ ,-.__  |\r\n#,´-´#####`-.`.\r\n'´#`'######, `,)\r\n###########`-'\r\nasciiend\r\n\r\n  :?stateTime/2 = 4\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n#\r\n#,\r\n('-._######;(,|\r\n `'´ `-.__.' ''-,\r\n####/       `--´\r\n#,-´_.´`.__ !\r\n#'´'#####, `.`.\r\n#########`-' `-'\r\nasciiend\r\n\r\n  :?stateTime/2 = 5\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n#\r\n#\r\n#;#########|\\´/\r\n#\\`-----._.´ ''-,\r\n##`´/       `--´\r\n###,'_,-._/ !\r\n####\\\\.##,|(\r\n#####`\"#'´`-'\r\nasciiend\r\n\r\n\r\n\r\n?currentState = stateStopping\r\n  ?stateTime = 0\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n#\r\n#\r\n##########|\\´/\r\n#;########/ ''-,\r\n#\\`--.---´ `--´\r\n##`´|  ;  , !\r\n####`,(`--|(\r\n##### `\"  `-'\r\nasciiend\r\n  :\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n#\r\n#\r\n#########|\\´/\r\n#########/ ''-,\r\n#;###,--´ `--´\r\n#\\`-´  -.  ;\r\n##`- ;,-'\\(\r\n#####`-'  `\"\r\nasciiend\r\n\r\n\r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Mushroom.txt" - Parse error: Failed to parse completely. Remaining: "?hp < lasthp\r\n   MC = #red\r\n    lasthp = hp\r\n\r\n?MushReactiveColor = 1\r\n ?hp > lasthp\r\n  MC = #green\r\n   lasthp = hp\r\n?MushReactiveColor = 1\r\n ?buffs.string = lucky_crit | buffs.string =\r\n^ berserk | buffs.string = strength\r\n  MC = #rainbow\r\n?MushReactiveColor = 1\r\n ?buffs.string = invisibility\r\n  MC = #777777\r\n?MushReactiveColor = 1\r\n ?debuffs.string = debuff_attack_speed\r\n  MC = #aaaaff\r\n\r\nvar FindWer\r\nvar FindEnc\r\nvar FindWerL\r\nvar FindEncL\r\nvar Enc1\r\nvar Enc2\r\n\r\n?string.Equals(item.left,＂＂) = false\r\n FindWerL = string.IndexOf(item.left,＂+＂)\r\n FindEncL = string.Sub(item.left,FindWerL+1,2)\r\n Enc2 = int.Parse(FindEncL)\r\n:\r\n Enc2 = Enc1\r\n\r\n?string.Equals(item.right,＂＂) = false\r\n FindWer = string.IndexOf(item.right,＂+＂)\r\n FindEnc = string.Sub(item.right,FindWer+1,2)\r\n Enc1 = int.Parse(FindEnc)\r\n\r\nvar EnchCol\r\nvar EnchCol2\r\nvar Element = ＂O＂\r\n\r\n?Enc1>=16\r\n EnchCol = #rainff\r\n:?Enc1>=11\r\n EnchCol = #red\r\n:?Enc1 >= 7\r\n EnchCol = #blue\r\n:?Enc1 >= 4\r\n EnchCol = #green\r\n:?Enc1 >= 2\r\n EnchCol = #yellow\r\n:?Enc1 = 1\r\n EnchCol = #cyan\r\n:\r\n EnchCol = #white\r\n\r\n Mushroom = ascii\r\n#\r\n#\r\n#\r\n##.--.\r\n.'  '_'.\r\n#|¯¯¯¯|\r\n#| •w•|\r\n#'____'\r\nasciiend\r\n\r\n?MushroomFrame = 2\r\n Mushroom = ascii\r\n#\r\n#\r\n#\r\n##.--.\r\n.'  '_'.\r\n#|¯¯¯¯|\r\n#| •w•|\r\n'------'\r\nasciiend\r\n\r\n?MushroomFrame = 3\r\n Mushroom = ascii\r\n#\r\n#\r\n#\r\n##.--.\r\n.'  '_'.\r\n#|¯¯¯¯|\r\n#| >w<|\r\n´------`\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\r\nasciiend\r\n\r\n?MushroomFrame = 4\r\n Mushroom = ascii\r\n#\r\n#\r\n###.--.\r\n#.'  '_'.\r\n##|¯>w<|\r\n##|    |\r\n##,____,\r\n#\r\nasciiend\r\n\r\n?MushroomFrame = 5\r\n Mushroom = ascii\r\n#\r\n####.--.\r\n##.'  '_'.\r\n###|¯>w<|\r\n###|    |\r\n###.    .\r\n####'--'\r\n#\r\nasciiend\r\n\r\n?MushroomFrame = 6\r\n Mushroom = ascii\r\n#####.--.\r\n###.'  '_'.\r\n####|¯>w<|\r\n####|    |\r\n####.    .\r\n#####'--'\r\n#\r\n#\r\nasciiend\r\n\r\n?MushroomFrame = 7\r\n Mushroom = ascii\r\n#####.--.\r\n###.'  '_'.\r\n####|¯¯¯¯|\r\n####| >w<|\r\n####.    .\r\n#####¯¯¯¯\r\n#\r\n#\r\nasciiend\r\n\r\n?MushroomFrame = 8\r\n Mushroom = ascii\r\n#\r\n####.--.\r\n##.'  '_'.\r\n###|¯¯¯¯|\r\n###|    |\r\n###. •w•.\r\n####¯¯¯¯\r\n#\r\nasciiend\r\n\r\n?MushroomFrame = 9\r\n Mushroom = ascii\r\n#\r\n#\r\n####.--.\r\n##.'  '_'.\r\n###|¯¯¯¯|\r\n###|    |\r\n###. •w•.\r\n####¯¯¯¯\r\nasciiend\r\n\r\n?MushroomFrame = 10\r\n Mushroom = ascii\r\n#\r\n#\r\n#\r\n###.--.\r\n#.'  '_'.\r\n##|¯¯¯¯|\r\n##| •w•|\r\n##'____'\r\nasciiend\r\n\r\n?MushroomFrame = 11\r\n Mushroom = ascii\r\n#\r\n#\r\n#\r\n#\r\n##.--.\r\n.'  '_'.\r\n#|¯¯¯¯|\r\n#| •w•|\r\n##¯¯¯¯\r\nasciiend\r\n\r\n?MushroomFrame = 12\r\n Mushroom = ascii\r\n#\r\n#\r\n#\r\n#\r\n##.--.\r\n.'  '_'.\r\n#|¯¯¯¯|\r\n#| •w•|\r\n#'----'\r\nasciiend\r\n\r\n?MushscaredFrame = 1\r\n Mushscared = ascii\r\n#\r\n#\r\n#\r\n##.--.\r\n.'  '_'.\r\n#|¯¯¯¯|\r\n#| -w-|\r\n#'----'\r\nasciiend\r\n\r\n?MushscaredFrame = 2\r\n Mushscared = ascii\r\n#\r\n#\r\n#\r\n##.--.\r\n.'  '_'.\r\n#|¯¯¯¯|\r\n#|'OwO|\r\n#'----'\r\nasciiend\r\n\r\n?MushscaredFrame = 3\r\n Mushscared = ascii\r\n#\r\n#\r\n#\r\n##.--.\r\n.'  '_'.\r\n#|¯¯¯¯|\r\n#|＂-w-|\r\n#'----'\r\nasciiend\r\n\r\n?MushscaredFrame = 3\r\n Mushscared = ascii\r\n#\r\n#\r\n#\r\n##.--.\r\n.'  '_'.\r\n#|¯¯¯¯|\r\n#|＂OwO|\r\n#'----'\r\nasciiend\r\n\r\n?MushscaredFrame = 7\r\n Mushscared = ascii\r\n#\r\n#\r\n#\r\n##.--.\r\n.'  '_'.\r\n#|¯¯¯¯|\r\n#|'•w•|\r\n#'----'\r\nasciiend\r\n\r\n?MushroomFrame > 12\r\n  MushroomFrame = 1\r\n\r\n?MushscaredFrame > 0\r\n Mushroom = ascii\r\n#\r\nasciiend\r\n\r\n?MushscaredFrame > 7\r\n ?foe.distance > 20\r\n  MushscaredFrame = -1\r\n\r\n?MushscaredFrame = -1\r\n Mushscared = ascii\r\n#\r\nasciiend\r\n\r\n?MushwinFrame > 0\r\n Mushroom = ascii\r\n#\r\n#\r\n#\r\n##.--.\r\n.'  '_'.\r\n#|¯¯¯¯|\r\n#| ^w^|\r\n#'----'\r\nasciiend\r\n\r\n?MushwinFrame > 9\r\n MushwinFrame = -1\r\n?MushItemCol = 1\r\n MC = EnchCol\r\n>o-@MushroomX@,@MushroomY@,@MC@,@Mushroom@\r\n>o-@MushroomX@,@MushroomY@,@MC@,@Mushscared@\r\n?time % 14 = 0\r\n MC = #white"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Spider.txt" - Parse error: Failed to parse completely. Remaining: "a.x = 1 + rng % (screen.w-1)\r\n//\r\n\r\n?time % waittime = 0 & !a.paused\r\n  a.Play()\r\n  wait = 0\r\n//\r\n\r\n?wait = 1\r\n  ?waitcounter < 90\r\n    waitcounter++\r\n  :\r\n    a.Play()\r\n    wait = 1\r\n//\r\n    \r\n?a.frame = 5 & wait = 0\r\n  a.Pause()\r\n  wait = 1\r\n:?a.frame = 10\r\n  a.x = 1 + rng % (screen.w-1)\r\n  waittime = 30 + rng % (171)\r\n  waitcounter = 0\r\n//\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Fly.txt" - Parse error: Failed to parse completely. Remaining: "= #rainbow\r\n\r\nvar keepDistance = -17\r\nvar maxX = -11\r\n\r\nvar maxDistance\r\nmaxDistance = -70\r\n\r\nvar targetZ = -1\r\n\r\nvar x = 0\r\nvar y = 0\r\nvar myX = 0\r\nvar myZ = 0\r\nvar lastPlayerX = 0\r\nvar lastPlayerZ = 0\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1\r\nvar stateJump = 2\r\nvar currentState = stateNone\r\nvar stateTime = 0\r\n\r\n\r\nfunc SetState(newState)\r\n  ?newState = stateJump\r\n    play bat_wing\r\n\r\n  currentState = newState\r\n  stateTime = 0\r\n\r\n\r\n?currentState = stateNone | time = 1\r\n  lastPlayerX = pos.x\r\n  lastPlayerZ = pos.z\r\n  myX = keepDistance\r\n  myZ = targetZ\r\n\r\n  // Start further away if the frog is summoned while the location is already running\r\n  ?time > 1\r\n    myX = maxDistance\r\n\r\n  SetState(stateIdle)\r\n\r\n\r\nmyX = myX - (pos.x - lastPlayerX)\r\n\r\nstateTime++\r\n\r\n?currentState = stateIdle\r\n  ?myX < maxDistance | myX > -maxDistance\r\n    myX = maxDistance\r\n  myZ = myZ - (pos.z - lastPlayerZ)\r\n\r\n  ?myX < keepDistance\r\n    SetState(stateJump)\r\n\r\n:?currentState = stateJump\r\n  ?myX < maxX\r\n    myX++\r\n\r\n  ?stateTime >= 6\r\n    ?myZ > targetZ\r\n      myZ--\r\n    :?myZ < targetZ\r\n      myZ++\r\n\r\n  ?stateTime >= 12\r\n    SetState(stateIdle)\r\n\r\n\r\nlastPlayerX = pos.x\r\nlastPlayerZ = pos.z\r\n\r\n// Draw\r\n\r\n?currentState = stateIdle\r\n  >o@myX@,@myZ@,@frogColor@,ascii\r\n##`*´\r\nasciiend\r\n  x = myX + 5\r\n  y = myZ + 2\r\n  ?face = \"( ^^\"\r\n    >o@x@,@y@,@frogColor@,ascii\r\n\r\nasciiend\r\n\r\n  :?face = \"°°\"\r\n    ?time % 4 <= 1\r\n      >o@x@,@y@,@frogColor@,ascii\r\n\r\nasciiend\r\n    ?time % 4 > 1\r\n      >o@x@,@y@,@frogColor@,ascii\r\n\r\nasciiend\r\n\r\n  :?stateTime % 50 >= 48\r\n    >o@x@,@y@,@frogColor@,ascii\r\n\r\nasciiend\r\n  :?stateTime % 50 >= 46\r\n    >o@x@,@y@,@frogColor@,ascii\r\n\r\nasciiend\r\n  :?stateTime % 50 >= 44\r\n    >o@x@,@y@,@frogColor@,ascii\r\n\r\nasciiend\r\n\r\n?currentState = stateJump\r\n  ?stateTime/2 = 0\r\n    >o@myX@,@myZ@,@frogColor@,ascii\r\n##`*´\r\nasciiend\r\n\r\n  :?stateTime/2 = 1\r\n    >o@myX@,@myZ@,@frogColor@,ascii\r\n##`*-\r\nasciiend\r\n\r\n  :?stateTime/2 = 2\r\n    >o@myX@,@myZ@,@frogColor@,ascii\r\n##-*.\r\nasciiend\r\n\r\n  :?stateTime/2 = 3\r\n    >o@myX@,@myZ@,@frogColor@,ascii\r\n##,*-\r\nasciiend\r\n\r\n  :?stateTime/2 = 4\r\n    >o@myX@,@myZ@,@frogColor@,ascii\r\n##·*´\r\nasciiend\r\n\r\n  :?stateTime/2 = 5\r\n    >o@myX@,@myZ@,@frogColor@,ascii\r\n##`*´\r\nasciiend\r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/LegsTurkey.txt" - Parse error: Failed to parse completely. Remaining: "=    #774014\r\nvar color_hlights = #996236\r\nvar color_beak =    #CF933E\r\nvar color_legs =    #BE822D\r\nvar color_eye =     #AAAAAA\r\nvar color_eyelid =  #996236\r\nvar color_hat =     #552009\r\nvar color_cool =    #rainDD\r\n\r\n//player tracking variables\r\nvar prevPosX\r\nvar prevPosY\r\n\r\nvar plr_min_dist = 20       //stands still if within this distance from you\r\nvar plr_min_dist_boss = 28  //stands still if within this distance from you, while fighting a boss\r\n\r\n//animation variables\r\nvar frm_std_count = 4       // num frames for stand up animation\r\nvar frm_sit_count = 4       // num frames for sit animation\r\nvar frm_L_count = 15        // num frames for left leg walk animation\r\nvar frm_R_count = 15        // num frames for right leg walk animation\r\n\r\nvar frm                     // frame counter\r\nvar frm_interval = 1        // ticks/frame (leave at 1 for best results)\r\nvar stand_time = 60         // num ticks turkey will stand still before sitting\r\n\r\nvar prevStepL               // alternate the leading step from standstill for variety\r\n\r\nvar open_time = 115         // num ticks eye is open\r\nvar blink_time = 5          // num ticks eye is closed\r\nvar blinking = false\r\nvar catching = false\r\n\r\n//position variables\r\nvar tx                      // turkey x,y\r\nvar ty\r\n\r\nvar lx                      // legs x,y\r\nvar ly\r\n\r\n//          --MAIN LOOP--\r\nUpdate()\r\nDraw(0, 0)\r\n\r\n//          --RESET LOGIC--\r\nfunc TryReset()\r\n  ?loc.begin | loc.loop\r\n    initialized = false\r\n  \r\n  :?time <= 2 & (loc ! rocky_plateau)\r\n    initialized = false\r\n    \r\n  ?!initialized\r\n    initialized = true\r\n    \r\n    prevPosX = pos.x\r\n    prevPosY = pos.z - pos.y\r\n    prevStepL = false\r\n    tx = -15\r\n    ty = 0\r\n    lx = tx+3\r\n    ly = ty+3\r\n    state = SITTING\r\n    frm = 0\r\n\r\n//          --MAIN UPDATE LOGIC--\r\nfunc Update()\r\n  TryReset()\r\n\r\n  ?time % frm_interval = 0\r\n    frm++\r\n\r\n    ?state = SITTING\r\n      state = NextState()\r\n      frm = 0\r\n    \r\n    :?state = STAND_UP\r\n      ?frm >= frm_std_count\r\n        state = NextState()\r\n        frm = 0\r\n        \r\n    :?state = STANDING\r\n      state = NextState()\r\n      ?frm >= stand_time\r\n        frm = 0\r\n      ?state ! STANDING\r\n        frm = 0\r\n    \r\n    :?state = WALK_L\r\n      ?frm >= frm_L_count\r\n        prevStepL = true\r\n        state = NextState()\r\n        frm = 0\r\n        lx = lx+6   //adjust leg position after walk cycle but before next draw\r\n\r\n    :?state = WALK_R\r\n      ?frm >= frm_R_count\r\n        prevStepL = false\r\n        state = NextState()\r\n        frm = 0\r\n        lx = lx+6   //adjust leg position after walk cycle but before next draw\r\n\r\n    :?state = SIT_DOWN\r\n      ?frm >= frm_sit_count\r\n        state = NextState()\r\n        frm = 0\r\n    \r\n    :\r\n      state = NextState()\r\n      frm = 0\r\n    \r\n    Move()\r\n  \r\n  //update twice per tick if turkey gets too far behind\r\n  ?!catching & -tx > (screen.w/2 - 10)\r\n    catching = true\r\n    Update()\r\n  :\r\n    catching = false\r\n\r\n//          --NEXT STATE LOGIC--\r\nfunc NextState()\r\n  ?state = SITTING\r\n    ?NearPlayer()\r\n      return SITTING\r\n    :\r\n      return STAND_UP\r\n    \r\n  :?state = STAND_UP\r\n    return STANDING\r\n      \r\n  :?state = STANDING\r\n    ?NearPlayer()\r\n      ?frm >= stand_time\r\n        return SIT_DOWN\r\n      :\r\n        return STANDING\r\n    :?prevStepL\r\n      return WALK_R\r\n    :\r\n      return WALK_L\r\n    \r\n  :?state = WALK_L\r\n    ?NearPlayer()\r\n      return STANDING\r\n    :\r\n      return WALK_R\r\n    \r\n  :?state = WALK_R\r\n    ?NearPlayer()\r\n      return STANDING\r\n    :\r\n      return WALK_L\r\n    \r\n  :?state = SIT_DOWN\r\n    return SITTING\r\n  \r\n  :\r\n    return SITTING\r\n\r\n//          --MOVEMENT LOGIC--\r\nfunc Move()\r\n  //animation movements\r\n  ?state = STAND_UP\r\n    //move up\r\n    ?frm = 0 | frm = 1\r\n      ty = ty-1\r\n      ly = ty+3\r\n    :?frm = 2 | frm = 3\r\n      ty = ty-2\r\n      ly = ty+3\r\n    \r\n  :?state = STANDING\r\n    //register legs to body\r\n    lx = tx+3\r\n    ly = ty+3\r\n    \r\n  :?state = WALK_L\r\n    //move forward with legs\r\n    ?frm = 6 | frm = 12\r\n      tx = tx+1\r\n    :?frm = 7 | frm = 8\r\n      tx = tx+2\r\n    \r\n    //track character on large vertical movements\r\n    ?frm = 14\r\n      ?ty < -4\r\n        ty++\r\n        ly++\r\n      :?ty > 4\r\n        ty--\r\n        ly--\r\n  \r\n  :?state = WALK_R\r\n    //move forward with legs\r\n    ?frm = 3 | frm = 6 | frm = 8 | frm = 11\r\n      tx = tx+1\r\n    :?frm = 7\r\n      tx = tx+2\r\n    \r\n    //track character on large vertical movements\r\n    ?frm = 14\r\n      ?ty < -4\r\n        ty++\r\n        ly++\r\n      :?ty > 4\r\n        ty--\r\n        ly--\r\n      \r\n  :?state = SIT_DOWN\r\n    //move down\r\n    ?frm = 0 | frm = 1\r\n      ty = ty+2\r\n      ly = ty+3\r\n    :?frm = 2 | frm = 3\r\n      ty = ty+1\r\n      ly = ty+3\r\n  \r\n  //extra rubberbanding if turkey gets really far behind\r\n  ?-tx > screen.w/2\r\n    var rb = (rng%2) + 1\r\n    tx = tx + rb\r\n    lx = lx + rb\r\n  \r\n  //adjust for player movement\r\n  tx = tx - (pos.x - prevPosX)\r\n  lx = lx - (pos.x - prevPosX)\r\n  \r\n  ty = ty - (pos.z - pos.y - prevPosY)\r\n  ly = ly - (pos.z - pos.y - prevPosY)\r\n  \r\n  prevPosX = pos.x\r\n  prevPosY = pos.z - pos.y\r\n\r\n//          --DRAW LOGIC--\r\nfunc Draw(dx, dy)\r\n  //determine draw position\r\n  var dtx = tx+dx\r\n  var dlx = lx+dx\r\n  var dty = ty+dy\r\n  var dly = ly+dy\r\n  \r\n  //cull if out of range\r\n  ?dtx < -screen.w\r\n    return\r\n  \r\n  //legs\r\n  ?state = STAND_UP\r\n    ?frm = 0\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n<<\r\nasciiend\r\n    :?frm = 1\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n||\r\n<<\r\nasciiend\r\n    :?frm = 2\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n||\r\n||\r\n||\r\n<<\r\nasciiend\r\n    :?frm = 3\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n||\r\n||\r\n||\r\n||\r\n||\r\n<<\r\nasciiend\r\n\r\n  :?state = STANDING\r\n    >o@dlx@,@dly@,@color_legs@,ascii\r\n||\r\n||\r\n||\r\n||\r\n||\r\n<<\r\nasciiend\r\n\r\n  :?state = WALK_L\r\n    ?frm = 0\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n||\r\n||\r\n||\r\n||\r\n||\r\n<<\r\nasciiend\r\n    :?frm = 1\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n||\r\n||\r\n:|\r\n#\\\r\n#|\\\r\n#<<\r\nasciiend\r\n    :?frm = 2\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n:|\r\n#\\\r\n#|\\\r\n#|#\\\r\n#|##<\r\n#<###\r\nasciiend\r\n    :?(3 <= frm) & (frm <= 5)\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n#\\\r\n#|\\\r\n#|#\\\r\n#|##\\\r\n#|###\\\r\n#<####<\r\nasciiend\r\n    :?frm = 6\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n#\\´\r\n#|\\\r\n#|#\\\r\n#|##\\\r\n#|###\\\r\n#<####<\r\nasciiend\r\n    :?frm = 7\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n###\\´\r\n##/#\\\r\n#;###\\\r\n#|####:\r\n#|####|\r\n#<####<\r\nasciiend\r\n    :?(8 <= frm) & (frm <= 10)\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n#####\\´\r\n####/#:\r\n###/##|\r\n##/###|\r\n#/####|\r\n#<####<\r\nasciiend\r\n    :?frm = 11\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n#####\\;\r\n#####/:\r\n####/#|\r\n###/##|\r\n##<###|\r\n######<\r\nasciiend\r\n    :?frm = 12\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n######||\r\n######|;\r\n######|\r\n#####/|\r\n####<#|\r\n######<\r\nasciiend\r\n    :?frm = 13\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n######||\r\n######||\r\n######||\r\n######|;\r\n######|\r\n######<\r\nasciiend\r\n    :?frm = 14\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n######||\r\n######||\r\n######||\r\n######||\r\n######||\r\n######<<\r\nasciiend\r\n\r\n  :?state = WALK_R\r\n    ?frm = 0\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n||\r\n||\r\n||\r\n|:\r\n|#\\\r\n<#<\r\nasciiend\r\n    :?frm = 1\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n||\r\n|:\r\n|\\\r\n|#\\\r\n|##<\r\n<####\r\nasciiend\r\n    :?frm = 2\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n|\\\r\n|#\\\r\n|##\\\r\n|###\\\r\n|####<\r\n<######\r\nasciiend\r\n    :?(3 <= frm) & (frm <= 5)\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n|#\\\r\n|##\\\r\n|###\\\r\n|####\\\r\n|#####\\\r\n<######<\r\nasciiend\r\n    :?frm = 6\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n#;#\\\r\n/###\\\r\n|####\\\r\n|#####\\\r\n|######:\r\n<######<\r\nasciiend\r\n    :?frm = 7\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n###;#\\\r\n##/###\\\r\n#/#####:\r\n/######|\r\n|######|\r\n<######<\r\nasciiend\r\n    :?(8 <= frm) & (frm <= 10)\r\n      ?frm = 14\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n####/##\\\r\n###/###|\r\n##/####|\r\n#/#####|\r\n/######|\r\n<######<\r\nasciiend\r\n    :?frm = 11\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n#####/#|\r\n####/##|\r\n###/###|\r\n##/####|\r\n#<#####|\r\n#######<\r\nasciiend\r\n    :?frm = 12\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n######||\r\n######;|\r\n#####/#|\r\n####/##|\r\n###<###|\r\n#######<\r\nasciiend\r\n    :?frm = 13\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n######||\r\n######||\r\n######||\r\n######;|\r\n#####/#|\r\n#####<#<\r\nasciiend\r\n    :?frm = 14\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n######||\r\n######||\r\n######||\r\n######||\r\n######||\r\n######<<\r\nasciiend\r\n\r\n  :?state = SIT_DOWN\r\n    ?frm = 0\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n||\r\n||\r\n||\r\n<<\r\nasciiend\r\n    :?frm = 1\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n||\r\n<<\r\nasciiend\r\n    :?frm = 2\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n<<\r\nasciiend\r\n\r\n  //body\r\n  >o@dtx@,@dty@,@color_body@,ascii\r\n#_###_\r\n( `.;\r\n#•  _)\r\nasciiend\r\n\r\n  //highlights\r\n  >o@dtx@,@dty@,@color_hlights@,ascii\r\n#\r\n#≈\r\n##,;#)\r\n##´\r\nasciiend\r\n\r\n  //hat\r\n  >o@dtx@,@dty@,@color_hat@,ascii\r\n####_◘_\r\nasciiend\r\n\r\n  //beak\r\n  >o@dtx@,@dty@,@color_beak@,ascii\r\n#\r\n######≥\r\nasciiend\r\n\r\n  //eye\r\n  ?blinking\r\n    ?time % blink_time = 0\r\n      blinking = false\r\n\r\n    >o@dtx@,@dty@,@color_eyelid@,ascii\r\n#\r\n#####¯\r\nasciiend\r\n  :\r\n    ?time % open_time = 0\r\n      blinking = true\r\n\r\n    >o@dtx@,@dty@,@color_eye@,ascii\r\n#\r\n#####°\r\nasciiend\r\n\r\n  //cool sunglasses\r\n  ?cool\r\n    >o@dtx@,@dty@,@color_cool@,ascii\r\n#\r\n####⌐▼\r\nasciiend\r\n\r\n//          --NEAR PLAYER LOGIC--\r\nfunc NearPlayer()\r\n  ?foe = boss\r\n    ?foe = bronze_guardian\r\n      return (-tx < plr_min_dist_boss) | (foe.distance < 15)\r\n    :\r\n      return -tx < plr_min_dist_boss\r\n  :\r\n    return -tx < plr_min_dist\r\n\r\n//          --UPDATE 'COOL' STATUS--\r\nfunc SetCool(c)\r\n  cool = c\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Dracula.txt" - Parse error: Failed to parse completely. Remaining: "= draculaX - (playerX - lastplayerX)\r\n\r\n?draculaX<-12\r\n  ?draculaX<-17&bat=false\r\n    ?pooftime=0\r\n      dracula.Load(poofanim1)\r\n      dracula.frame=0\r\n      pooftime=5\r\n    :?time%2=0\r\n      dracula.frame++\r\n      pooftime--\r\n      ?pooftime=0\r\n        dracula.Load(batanim)\r\n        dracula.frame=1\r\n        bat=true\r\n  ?pooftime!0\r\n    ?bat\r\n      ?time%2=0\r\n        dracula.frame++\r\n        pooftime--\r\n        ?pooftime=0\r\n          dracula.Load(draculanim)\r\n          dracula.frame=0\r\n          bat=false\r\n  :?bat\r\n    ?time%2=0\r\n      dracula.frame++\r\n      draculaX++\r\n    :?draculaX<-23\r\n      dracula.frame++\r\n      draculaX++\r\n  :?time%3=0\r\n    dracula.frame++\r\n    ?dracula.frame=0\r\n      dracula.frame=1\r\n    draculaX++\r\n:?bat\r\n  ?pooftime=0\r\n    dracula.Load(poofanim2)\r\n    dracula.frame=0\r\n    pooftime=5\r\n  :?time%2=0\r\n    dracula.frame++\r\n    pooftime--\r\n    ?pooftime=0\r\n      dracula.Load(draculanim)\r\n      dracula.frame=0\r\n      bat=false\r\n:?pooftime=0\r\n  dracula.frame=0\r\n\r\n?draculaX < -70 | draculaX > 70\r\n  draculaX = -30\r\n\r\n?dracula.y>refZ-8\r\n  dracula.y=dracula.y-1\r\n:?dracula.y<refZ-8\r\n  dracula.y=dracula.y+1\r\n\r\nlastrefX=screen.FromWorldX(pos.x)\r\nlastplayerX=pos.x\r\ndracula.x=refX+draculaX"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Snowman.txt" - Parse error: Failed to parse completely. Remaining: "= #808080 //eyes, buttons and hat\r\nnoseColor = #CC9020 //carrot nose\r\narmsColor = #706020 //stick arms\r\n\r\nvar keepDistance = -25 // distance at which the movement animation will play (stateMoving)\r\nvar maxX = -24         // closest offset pet will get to character.  Closer to 0, closer to character\r\nvar maxDistance = -35  // if the pet exceeds this distance, it will teleport to this distance (cannot be further away than this)\r\nvar targetZ = 2       //start the drawing 1 unit above the player\r\n\r\n?loc.loop\r\n  keepDistance = -25\r\n  maxX = -12\r\n  maxDistance = -35\r\n  targetZ = 2\r\n\r\nvar x = 0\r\nvar y = 0\r\nvar myX = 0\r\nvar myZ = 0\r\nvar lastPlayerX = 0\r\nvar lastPlayerZ = 0\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1\r\nvar stateMoving = 2\r\nvar currentState = stateNone\r\nvar stateTime = 0\r\n\r\nfunc SetState(newState)\r\n  ?newState = stateMoving\r\n    play haunted_gate_shuffle //play sound when moving\r\n  \r\n  currentState = newState\r\n  stateTime = 0\r\n\r\n?currentState = stateNone | time = 1\r\n  lastPlayerX = pos.x\r\n  lastPlayerZ = pos.z\r\n  myX = keepDistance\r\n  myZ = targetZ\r\n\r\n// Start further away if snowman is summoned while the location is already running\r\n  ?time > 1\r\n    myX = maxDistance\r\n\r\n  SetState(stateIdle)\r\n\r\nmyX = myX - (pos.x - lastPlayerX) // If player has moved, increment myX (distance from player)\r\n\r\nstateTime++\r\n\r\n?currentState = stateIdle \r\n  ?myX < maxDistance | myX > -maxDistance\r\n    myX = maxDistance\r\n  myZ = myZ - (pos.z - lastPlayerZ)\r\n\r\n  ?myX < keepDistance\r\n    SetState(stateMoving)\r\n\t\r\n:?currentState = stateMoving\r\n  ?myX < maxX\r\n    myX++\r\n\t\r\n  ?stateTime >= 6\r\n    ?myZ > targetZ\r\n      myZ--\r\n    :?myZ < targetZ\r\n      myZ++\r\n\r\n  ?stateTime >= 12\r\n    SetState(stateIdle)\r\n\t\r\nlastPlayerX = pos.x\r\nlastPlayerZ = pos.z\r\n\r\n//draw snowman-----------------------------\r\n?currentState = stateIdle \r\n  >o@myX@,@myZ-3@,@#white@,ascii\r\n####__\r\n##_|__|_\r\n.#( •,•)#,.\r\n'`(  : )'\r\n#(    : )\r\n##`----´\r\nasciiend\r\n  >o@myX@,@myZ-3@,@coalColor@,ascii\r\n####__\r\n##_|__|_\r\n####•#•\r\n#####:\r\n######:\r\nasciiend\r\n  >o@myX@,@myZ-3@,@noseColor@,ascii\r\n#\r\n#\r\n#####,\r\nasciiend\r\n  >o@myX@,@myZ-3@,@armsColor@,ascii\r\n#\r\n#\r\n.########,.\r\n'`######'\r\nasciiend\r\n\r\n//eye expressions\r\n  ?face = \"°°\"\r\n    >o@myX@,@myZ-3@,@coalColor@,ascii\r\n#\r\n#\r\n####ʘ#ʘ\r\nasciiend\r\n\r\n  ?face = \"^^\"\r\n    >o@myX@,@myZ-3@,@coalColor@,ascii\r\n#\r\n#\r\n####^#^\r\nasciiend\r\n    >o@myX@,@myZ-3@,@#white@,ascii\r\n#\r\n##❄####❄\r\n❄########❄\r\n########❄\r\nasciiend\r\n\r\n//Blink\r\n?currentState = stateIdle\r\n  ?face ! \"^^\"\r\n    ?face ! \"°°\"\r\n      ?stateTime % 50 >= 48\r\n        >o@myX@,@myZ-3@,@coalColor@,ascii\r\n#\r\n#\r\n####-#-\r\nasciiend\r\n      :?stateTime % 50 >= 46\r\n        >o@myX@,@myZ-3@,@coalColor@,ascii\r\n#\r\n#\r\n####-#-\r\nasciiend\r\n      :?stateTime % 50 >= 44\r\n        >o@myX@,@myZ-3@,@coalColor@,ascii\r\n#\r\n#\r\n####-#-\r\nasciiend\r\n\r\n//draw moving----------------------------\r\n?currentState = stateMoving\r\n  ?stateTime/3 = 0\r\n    >o@myX@,@myZ-3@,@#white@,ascii\r\n####__\r\n##_|__|_\r\n.#( •,•)#,.\r\n'`(  : )'\r\n#(    : )\r\n##`----´\r\nasciiend\r\n    >o@myX@,@myZ-3@,@coalColor@,ascii\r\n####__\r\n##_|__|_\r\n####•#•\r\n#####:\r\n######:\r\nasciiend\r\n    >o@myX@,@myZ-3@,@noseColor@,ascii\r\n#\r\n#\r\n#####,\r\nasciiend\r\n    >o@myX@,@myZ-3@,@armsColor@,ascii\r\n#\r\n#\r\n.########,.\r\n'`######'\r\nasciiend\r\n\r\n  ?stateTime/3 = 1\r\n    >o@myX@,@myZ-3@,@#white@,ascii\r\n####__\r\n##_|__|_\r\n##.  •,).\r\n##`   :)\r\n#(     :)\r\n##`----´\r\nasciiend\r\n    >o@myX@,@myZ-3@,@coalColor@,ascii\r\n####__\r\n##_|__|_\r\n#####•#\r\n######:\r\n#######:\r\nasciiend\r\n    >o@myX@,@myZ-3@,@noseColor@,ascii\r\n#\r\n#\r\n######,\r\nasciiend\r\n    >o@myX@,@myZ-3@,@armsColor@,ascii\r\n#\r\n#\r\n##.#####.\r\n##`\r\nasciiend\r\n\r\n  ?stateTime/3 = 2\r\n    >o@myX@,@myZ-3@,@#white@,ascii\r\n####__\r\n##_|__|_\r\n##('  •-\r\n##( `  ;\r\n#(      ;\r\n##`----´\r\nasciiend\r\n    >o@myX@,@myZ-3@,@coalColor@,ascii\r\n####__\r\n##_|__|_\r\n######•\r\n#######;\r\n########;\r\nasciiend\r\n    >o@myX@,@myZ-3@,@noseColor@,ascii\r\n#\r\n#\r\n#######-\r\nasciiend\r\n    >o@myX@,@myZ-3@,@armsColor@,ascii\r\n#\r\n#\r\n###'\r\n####`\r\nasciiend\r\n\r\n  ?stateTime/3 = 3\r\n    >o@myX@,@myZ-3@,@#white@,ascii\r\n####__\r\n##_|__|_\r\n#.( •,•).\r\n#`(   ;)\r\n#(     :)\r\n##`----´\r\nasciiend\r\n    >o@myX@,@myZ-3@,@coalColor@,ascii\r\n####__\r\n##_|__|_\r\n####•#•\r\n######:\r\n#######:\r\nasciiend\r\n    >o@myX@,@myZ-3@,@noseColor@,ascii\r\n#\r\n#\r\n#####,\r\nasciiend\r\n    >o@myX@,@myZ-3@,@armsColor@,ascii\r\n#\r\n#\r\n#.######.\r\n#`######\r\nasciiend\r\n\r\n  ?stateTime/3 = 4\r\n    >o@myX@,@myZ-3@,@#white@,ascii\r\n####__\r\n##_|__|_\r\n.#( •,•)#,.\r\n'`(  : )'\r\n#(    : )\r\n##`----´\r\nasciiend\r\n    >o@myX@,@myZ-3@,@coalColor@,ascii\r\n####__\r\n##_|__|_\r\n####•#•\r\n#####:\r\n######:\r\nasciiend\r\n    >o@myX@,@myZ-3@,@noseColor@,ascii\r\n#\r\n#\r\n#####,\r\nasciiend\r\n    >o@myX@,@myZ-3@,@armsColor@,ascii\r\n#\r\n#\r\n.#######,.\r\n'`######'\r\nasciiend\r\n\r\n  ?stateTime/3 = 5\r\n    >o@myX@,@myZ-3@,@#white@,ascii\r\n####__\r\n##_|__|_\r\n#.( •,•,\r\n##( :  '\r\n#(   :  )\r\n##`----´\r\nasciiend\r\n    >o@myX@,@myZ-3@,@coalColor@,ascii\r\n####__\r\n##_|__|_\r\n####•#•\r\n####:\r\n#####:\r\nasciiend\r\n    >o@myX@,@myZ-3@,@noseColor@,ascii\r\n#\r\n#\r\n#####,\r\nasciiend\r\n    >o@myX@,@myZ-3@,@armsColor@,ascii\r\n#\r\n#\r\n#.#####,\r\n#######'\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/FoesNoMore.txt" - Parse error: Failed to parse completely. Remaining: "= ＂flying＂//currently just \"flying\"\r\nvar SnekX = 8\r\nvar SnekY = -5\r\n\r\nvar playWingSound = true //true or false \r\nvar SnekColor = #6BFF94\r\n//————————— Art —————————//\r\n?time % 3 = 0\r\n SnekHeadFrame++\r\n?time % 2 = 0\r\n SnekBodyFrame++\r\n ?SnekHeadFrame < 20\r\n  SnekHead = ascii\r\n#.-.\r\n((`-'\r\n#\\\\\r\n#_))\r\nasciiend\r\n :?SnekHeadFrame = 20\r\n   SnekHead = ascii\r\n#.-.\r\n((`-'-\r\n#\\\\\r\n#_))\r\nasciiend\r\n :?SnekHeadFrame = 21\r\n   SnekHead = ascii\r\n#.-.\r\n((`-'--\r\n#\\\\\r\n#_))\r\nasciiend\r\n :?SnekHeadFrame = 22\r\n   SnekHead = ascii\r\n#.-.\r\n((`-'-<\r\n#\\\\\r\n#_))\r\nasciiend\r\n :?SnekHeadFrame = 23\r\n   SnekHead = ascii\r\n#.-.\r\n((`-'-,\r\n#\\\\\r\n#_))\r\nasciiend\r\n :?SnekHeadFrame = 24\r\n   SnekHead = ascii\r\n#.-.\r\n((`-',\r\n#\\###´\r\n#_))\r\nasciiend\r\n :?SnekHeadFrame = 25\r\n   SnekHead = ascii\r\n#.-.\r\n((`-'-,\r\n#\\\\\r\n#_))\r\nasciiend\r\n :?SnekHeadFrame = 26\r\n   SnekHead = ascii\r\n#.-.\r\n((`-'-´\r\n#\\\\\r\n#_))\r\nasciiend\r\n :?SnekHeadFrame = 27\r\n   SnekHead = ascii\r\n#.-.##,\r\n((`-'´\r\n#\\\\\r\n#_))\r\nasciiend\r\n :?SnekHeadFrame = 28\r\n   SnekHead = ascii\r\n#.-.\r\n((`-'-´\r\n#\\\\\r\n#_))\r\nasciiend\r\n :?SnekHeadFrame = 29\r\n   SnekHead = ascii\r\n#.-.\r\n((`-',\r\n#\\\\\r\n#_))\r\nasciiend\r\n:?SnekHeadFrame = 30\r\n   SnekHead = ascii\r\n#.-.\r\n((`-'.\r\n#\\\\\r\n#_))\r\nasciiend\r\n?SnekHeadFrame > 30\r\n SnekHeadFrame = 1\r\n?SnekForm = ＂flying＂\r\n ?time % 3 = 0\r\n  SnekWingFrame++\r\n ?SnekWingFrame = 1\r\n  SnekWings = ascii\r\n(\\#|\r\n(#\\|\r\nasciiend\r\n :?SnekWingFrame = 2\r\n  SnekWings = ascii\r\n#\r\n`-._:´\r\n##\r\nasciiend\r\n ?SnekWingFrame > 2\r\n  SnekWingFrame = 1\r\n?SnekForm = ＂flying＂ & SnekBodyFrame = 1\r\n SnekBody = ascii\r\n######.´ `-.\r\n####.'´ ¯ `--´\r\n###(_\r\nasciiend\r\n?SnekForm = ＂flying＂ & SnekBodyFrame = 2\r\n SnekBody = ascii\r\n######.´ `-.\r\n######/ ¯ `--´\r\n####-´\r\nasciiend\r\n:?SnekForm = ＂flying＂ & SnekBodyFrame = 3\r\n SnekBody = ascii\r\n######.´ `-.\r\n######(,¯ `--´\r\n######-´\r\nasciiend\r\n:?SnekForm = ＂flying＂ & SnekBodyFrame = 4\r\n SnekBody = ascii\r\n#####.-´_`-.\r\n#####`-., `--´\r\n########-'\r\nasciiend\r\n:?SnekForm = ＂flying＂ & SnekBodyFrame = 5\r\n SnekBody = ascii\r\n#####.'¯_`-.\r\n####(´####`--´\r\n#####`-._\r\nasciiend\r\n:?SnekForm = ＂flying＂ & SnekBodyFrame = 6\r\n SnekBody = ascii\r\n#####.'¯_`-.\r\n####/´####`--´\r\n####`._\r\nasciiend\r\n?SnekBodyFrame > 6\r\n SnekBodyFrame = 1\r\nvar SnekSound = 0\r\nSnekSound++\r\n?SnekSound % 30 = 0 & playWingSound\r\n play flying_serpent_loop\r\n>o-@SnekX@,@SnekY@,@SnekColor@,@SnekHead@\r\n>o-@SnekX+11@,@SnekY+3@,@SnekColor@,@SnekBody@\r\n>o-@SnekX+6@,@SnekY+1@,@SnekColor@,@SnekWings@\r\nvar antWalk = ascii\r\n-,#_,-.\r\n#O'|\\-\\`\r\n%%\r\n-,#_,-.\r\n#O/`/|-`\r\n%%\r\n-,#_,-.\r\n#O(`|-)`\r\nasciiend\r\nvar cultistWalk = ascii\r\n,_\r\n{\\\\\r\n( `\\\r\n/`o'._\r\n`¯¯'¯\r\n#####\r\n%%\r\n,_\r\n{\\\\\r\n( `\\\r\n(`o'._\r\n#´¯¯¯ #\r\n###\r\n%%\r\n,_\r\n{\\\\\r\n( `\\\r\n(`o`-._\r\n#¯¯¯¯¯\r\n###\r\n%%\r\n,_\r\n{\\\\\r\n( `\\\r\n/`o`-._\r\n`¯¯¯¯¯\r\n###\r\n%%\r\n,_\r\n{\\\\\r\n( `\\\r\n/`o'.__\r\n¯¯´¯¯ #\r\n###\r\nasciiend\r\nvar iceElementalShoot = ascii\r\n% {repeat:5} Done!\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%% {repeat:2} Done!\r\n¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\r\n¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\r\n%%\r\n¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\r\n¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\r\n%%\r\n════════════════════════════════════════════════════════════\r\n%%\r\n────────────────────────────────────────────────────────────\r\n%%\r\n─-──--─-──--─-──--─-─-──--─-──--─-──--─-─-──--─-──--─-──--─-\r\n%%\r\n·-·#·#·-·#·-·#·#·-·#·-·#·#·-·#·-·#·#·-·#·-·#·#·-·#·-·#·#·-·\r\n%%\r\n##-####-###-#####-###-#####-###-#####-###-#####-###-#####-\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\nasciiend\r\nvar iceGuy = ascii\r\n##/|\r\n`/| \\,\r\n#\\o_/\r\n%%\r\n##/|\r\n`/| \\,\r\n#\\._/\r\n%%\r\n##/|\r\n`/| \\,\r\n#\\•_/\r\n%% {repeat:2} Done!\r\n##/|\r\n`/| \\,\r\n#\\O_/\r\n%%\r\n##/|\r\n`/| \\,\r\n#\\O_/\r\n%% {repeat:2}\r\n##/|\r\n`/| \\,\r\n#\\-_/\r\n%%\r\n##/|\r\n`/| \\,\r\n#\\-_/\r\n%% {repeat:3}\r\n##/|\r\n`/| \\,\r\n#\\o_/\r\n%%\r\n##/|\r\n`/| \\,\r\n#\\o_/\r\n%%\r\n##/|\r\n`/| \\,\r\n#\\o_/\r\nasciiend\r\nvar skeletimmyWalk = ascii\r\n#_{)\r\n''¯)\r\n##/(\r\n%%\r\n#_{)\r\n''¯)\r\n##(V\r\n%%\r\n#_{)\r\n''¯)\r\n##<|\r\nasciiend\r\nvar skeletimmyStand = ascii\r\n{)\r\n//\\\r\n#/ \\\r\nasciiend\r\nvar scoutWalk = ascii\r\n######/\r\n###),_#____\r\n###`o/(  -´\r\n##,/_\\#);\r\n##/##/\\´\r\n#/#-´#_)_\r\n└####/##/\r\n####;##(\r\n###/####\\\r\n%%\r\n######/\r\n###),_#____\r\n###`o/(  -´\r\n##,/_\\#);\r\n##/##/\\´\r\n#/#-´#_)_\r\n└####/#.´\r\n####(#(_\r\n#####\\##'\r\n%%\r\n######/\r\n###),_#____\r\n###`o/(  -´\r\n##,/_\\#);\r\n##/##/\\´\r\n#/#-´#_)_\r\n└####/.-´\r\n#####¡\r\n#####'\\\r\n%%\r\n######/\r\n###),_#____\r\n###`o/(  -´\r\n##,/_\\#);\r\n##/##/\\´\r\n#/#-´#_)_\r\n└####(.'´\r\n#####/\\\r\n####´##\\\r\n%%\r\n######/\r\n###),_#____\r\n###`o/(  -´\r\n##,/_\\#);\r\n##/##/\\´\r\n#/#-´#_)_\r\n└####(#.´\r\n######/-,\r\n#####/\r\n%%\r\n######/\r\n###),_#____\r\n###`o/(  -´\r\n##,/_\\#);\r\n##/##/\\´\r\n#/#-´#_)_\r\n└####/#.´\r\n#####`¡,\r\n######|\r\n%%\r\n######/\r\n###),_#____\r\n###`o/(  -´\r\n##,/_\\#);\r\n##/##/\\´\r\n#/#-´#_)_\r\n└####/#.´\r\n#####\\(\r\n#####´#\\\r\nasciiend\r\nvar blast = ascii\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n#!\r\n%%\r\n#.\r\n<#>\r\n#`\r\n%%\r\n#,\r\n<#>\r\n#´\r\n%%\r\n#\r\n<#)\r\n#\r\n%%\r\n#\r\n#<#),\r\n%%\r\n#\r\n##<)\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\n%%\r\n#\r\nasciiend\r\nvar wasp = ascii\r\n#_\r\n#O('\r\n%%\r\n#_\r\n#O(),\r\n%%\r\n#/_#_)\r\n#O()/'\r\n%%\r\n#/_#/ #\r\n#O()/¯`\r\n#####¯\r\n%%\r\n\\|##_)\r\n#O()/¯¯`\r\n#####¯¯\r\n%%\r\n\\|##/ #\r\n#O()/¯¯\\\r\n#####¯¯`'\r\n%%\r\n\\|##_)\r\n#O()/¯\\\r\n#####¯`\\\r\n%%\r\n_\\##/ #\r\n#O()/¯\\\r\n#####¯`\\\r\n%%\r\n_\\##_)\r\n#O()/¯\\\r\n#####\\|\r\n######'\r\n%%\r\n_\\##/ #\r\n#O()/\\\r\n####\\|\r\n#####'\r\n%%\r\n_\\##_)\r\n#O()/\\\r\n####)/\r\n###¯`\r\n%%\r\n_\\##/ #\r\n#O()/\\\r\n####)/\r\n###¯`\r\n%%\r\n_\\##_)\r\n#O()/\\\r\n####)/\r\n###¯`\r\n%%\r\n_\\##/ #\r\n#O()/\\\r\n####)/\r\n###¯`\r\n%%\r\n_\\##_)\r\n#O()/\\\r\n####)/\r\n###¯`\r\n%%\r\n_\\##/ #\r\n#O()/\\\r\n####)/\r\n###¯`\r\n%%\r\n_\\##_)\r\n#O()/\\\r\n####)/\r\n###¯`\r\n%%\r\n_\\##/ #\r\n#O()/\\\r\n####)/\r\n###¯`\r\n%%\r\n_\\##_)\r\n#O()/\\\r\n####)/\r\n###¯`\r\n%%\r\n_\\##/ #\r\n#O()/\\\r\n####)/\r\n###¯`\r\n%%\r\n_\\##_)\r\n#O()/\\\r\n####)/\r\n###¯`\r\n%%\r\n_\\##/ #\r\n#O()/\\\r\n####)/\r\n###¯`\r\n%%\r\n_\\##_)\r\n#O()/\\\r\n####)/\r\n###¯`\r\n%%\r\n_\\##/ #\r\n#O()/\\\r\n####)/\r\n###¯`\r\n%%\r\n_\\##_)\r\n#O()/\\\r\n####)/\r\n###¯`\r\n%%\r\n_\\##/ #\r\n#O()/\\\r\n####)/\r\n###¯`\r\n%%\r\n_\\##_)\r\n#O()/\\\r\n####)/\r\n###¯`\r\n%%\r\n_\\##/ #\r\n#O()/\\\r\n####)/\r\n###¯`\r\n%%\r\n_\\##_)\r\n#O()/\\\r\n####)/\r\n###¯`\r\n%%\r\n_\\##/ #\r\n#O()/\\\r\n####)/\r\n####¯\r\n###\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n################_\\##/ #\r\n#################O()/\\\r\n####################)/\r\n###################¯`\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n###############_\\##_)\r\n################O()/\\\r\n###################)/\r\n##################¯`\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n##############_\\##/ #\r\n###############O()/\\\r\n##################)/\r\n#################¯`\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#############_\\##_)\r\n##############O()/\\\r\n#################)/\r\n################¯`\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n############_\\##/ #\r\n#############O()/\\\r\n################)/\r\n###############¯`\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n###########_\\##_)\r\n############O()/\\\r\n###############)/\r\n##############¯`\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n##########_\\##/ #\r\n###########O()/\\\r\n##############)/\r\n#############¯`\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#########_\\##_)\r\n##########O()/\\\r\n#############)/\r\n############¯`\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n########_\\##/ #\r\n#########O()/\\\r\n############)/\r\n###########¯`\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#######_\\##_)\r\n########O()/\\\r\n###########)/\r\n##########¯`\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n######_\\##/ #\r\n#######O()/\\\r\n##########)/\r\n#########¯`\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#####_\\##_)\r\n######O()/\\\r\n#########)/\r\n########¯`\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n####_\\##/ #\r\n#####O()/\\\r\n########)/\r\n#######¯`\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n###_\\##_)\r\n####O()/\\\r\n#######)/\r\n######¯`\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n##_\\##/ #\r\n###O()/\\\r\n######)/\r\n#####¯`\r\n%%\r\n#\r\n#\r\n#_\\##_)\r\n##O()/\\\r\n#####)/\r\n####¯`\r\n%%\r\n_\\##/ #\r\n#O()/\\\r\n####)/\r\n###¯`\r\n%% {repeat:13}\r\n#\r\nasciiend\r\nvar testingThing = 0\r\nvar hasWaspMoved = 0\r\nfunc pauseAnims()\r\n armyList[0].Pause()\r\n armyList[0].frame = 0\r\n armyList[1].Pause()\r\n armyList[1].frame = 0\r\n armyList[4].frame = 2\r\n armyList[4].Pause()\r\n armyList[5].Pause()\r\n armyList[5].visible = false\r\n armyList[6].visible = true\r\nfunc playAnims()\r\n armyList[0].Play()\r\n armyList[1].Play()\r\n armyList[4].Play()\r\n armyList[5].visible = true\r\n armyList[5].Play()\r\n armyList[6].visible = false\r\nvar armyList = []\r\nvar blastList = []\r\nvar waspList = []\r\nvar animation\r\nvar waspX = 0\r\nvar waspY = 0\r\nfunc createAnim(art,posX,posY,color,duration,flip,loop)\r\n animation = ui.AddAnim(art)\r\n animation.dock = top_left\r\n animation.x = posX\r\n animation.y = posY\r\n animation.color = color\r\n animation.duration = duration\r\n ?flip\r\n  animation.flipX = true\r\n animation.Play()\r\n ?loop = true\r\n  animation.loop = true\r\n :\r\n  animation.loop = false\r\n ?art = wasp\r\n  waspList.Add(animation)\r\n :?art = blast\r\n  blastList.Add(animation)\r\n :\r\n  armyList.Add(animation)\r\n?loc.loop\r\n armyList.Clear()\r\n waspList.Clear()\r\n blastList.Clear()\r\n//—————————Creation—————————//\r\n?totaltime = 1\r\n createAnim(scoutWalk,20,10,#yellow,42,true,true)\r\n createAnim(antWalk,0,0,#FF7312,12,true,true)\r\n createAnim(iceGuy,30,10,#cyan,40,true,true)\r\n createAnim(iceElementalShoot,114,12,#cyan,40,true,true)\r\n createAnim(cultistWalk,30,14,#red,15,true,true)\r\n createAnim(skeletimmyWalk,30,14,#white,15,true,true)\r\n createAnim(skeletimmyStand,30,14,#white,1,true,true)\r\nvar button1\r\nvar button2\r\nvar walkToggle = true\r\n?!ai.walking & walkToggle\r\n pauseAnims()\r\n ?foe\r\n  armyList[3].Play()\r\n walkToggle = false\r\n:?ai.walking & !walkToggle\r\n playAnims()\r\n armyList[3].frame = 0\r\n armyList[3].Pause()\r\n walkToggle = true\r\n\r\nfunc updateWasps()\r\n for i = 0..waspList.Count()-1\r\n  //hasWaspMoved++\r\n  ?(waspList[i].frame = 29 | waspList[i].frame = 30) //& waspList[i].color ! #c8c8c8\r\n   ?waspList[i].color = #c8c8c8\r\n    waspList[i].x += 16\r\n    waspList[i].y += 14\r\n   waspList[i].x -= 16\r\n   waspList[i].y -= 14\r\n   waspList[i].color = #c8c8c8\r\n   testingThing++\r\n  ?waspList[i].frame = 50\r\n   waspList[i].visible = false\r\n  ?waspList[i].frame < 50\r\n   waspList[i].x -= 1\r\n\r\n\r\n//————————— Positioning for allies —————————///\r\narmyList[0].x = screen.FromWorldX(pos.x)-16\r\narmyList[0].y = screen.FromWorldZ(pos.z)-4\r\narmyList[1].x = screen.FromWorldX(pos.x)-2\r\narmyList[1].y = screen.FromWorldZ(pos.z)\r\narmyList[2].x = screen.FromWorldX(pos.x) - 13\r\narmyList[2].y = screen.FromWorldZ(pos.z)-1\r\narmyList[3].x = screen.FromWorldX(pos.x) + 71\r\narmyList[3].y = screen.FromWorldZ(pos.z) + 1\r\narmyList[4].x = screen.FromWorldX(pos.x)-28\r\narmyList[4].y = screen.FromWorldZ(pos.z)-1\r\narmyList[5].x = screen.FromWorldX(pos.x)-22\r\narmyList[5].y = screen.FromWorldZ(pos.z)+1\r\narmyList[6].x = screen.FromWorldX(pos.x)-22\r\narmyList[6].y = screen.FromWorldZ(pos.z)+1\r\n?key = PrimaryBegin\r\n waspX = input.x + 34\r\n waspY = input.y + 7\r\n createAnim(wasp,waspX,waspY,#white,50,false,false)\r\n createAnim(blast,waspX-33,waspY-7,#red,50,false,false)\r\n \r\ndisable banner\r\n?waspList.Count() & totaltime % 1 = 0\r\n updateWasps()\r\n/*Keeping this for future refrence:\r\n Wasp changes to fly away anim on frame 31\r\n Standing frames:\r\n Scout: frame 0\r\n Ant: also frame 0"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/RoyaltyDeliverer.txt" - Parse error: Failed to parse completely. Remaining: "= pos.x + (screen.w/2)-(screen.x)\r\nrefz = pos.z - 3\r\n\r\nvar pusher\r\n?totalTime = 1\r\n pusher = ui.AddAnim(pusheranim)\r\n pusher.duration = 20\r\n pusher.loop = true\r\n pusher.playOnStart = true\r\n pusher.Play()\r\n pusher.gamePause = true\r\n pusher.anchor = top_left\r\n pusher.dock = top_left\r\n pusher.color = #FFFFFF\r\npusher.x = refx - 15\r\npusher.y = refz - 0\r\n\r\n?foe ! boss\r\n >o-33,-2,#B1B1B1,ascii\r\n.————————————————————————————.\r\n|Delivery for the Stone-head!|\r\n'————————————————————,———————'\r\nasciiend\r\n:?foe = boss | foe.count >= 10\r\n >o-33,-2,#B1B1B1,ascii\r\n.————————————————————————————.\r\n|Delivery for the… oh my god…|\r\n'————————————————————,———————'\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Sun.txt" - Parse error: Failed to parse completely. Remaining: "= #FFDD00\r\nvar sunstrobe = 40\r\nvar sunalert  = 10\r\nvar sundistx  = -16\r\nvar sundisty  = -10\r\nvar sunsizex  = 3\r\nvar sunsizey  = 2\r\n\r\n//*******************************\r\n// Global Variables\r\n//*******************************\r\n\r\nvar initialized = null\r\nvar sunpnl = null\r\nvar sunanim = null\r\nvar suntext = null\r\nvar x = 0\r\nvar y = 0\r\nvar currx = -50\r\nvar sinx = 0\r\nvar lastPlayerZ = -20\r\nvar modx = 4\r\nvar mody = 2\r\n\r\n\r\n//*******************************\r\n// ASCII Art\r\n//*******************************\r\n\r\nvar sunpet = ascii\r\n\r\n###.-.\r\n##{ ''}\r\n###`-´\r\n\r\n%%\r\n####.\r\n##·.-.·\r\n#<{ ''}>\r\n##·`-´·\r\n####'\r\n%%\r\n#__#.#__\r\n#\\·.-.·/\r\n#<{ ''}>\r\n#/·`-´·\\\r\n#¯¯#'#¯¯\r\n%%\r\n#__.▲.__\r\n#\\·.-.·/\r\n<:{ ''}:>\r\n#/·`-´·\\\r\n#¯¯'▼'¯¯\r\n%%\r\n#__.▲.__\r\n#\\·.-.·/\r\n◀:{ ''}:▶\r\n#/·`-´·\\\r\n#¯¯'▼'¯¯\r\n%%\r\n###.▲.\r\n#'#.-.#'\r\n◀:{ ''}:▶\r\n#.#`-´#.\r\n###'▼'\r\n%%\r\n###.#.\r\n###.-.\r\n·#{ ''}#·\r\n###`-´\r\n###'#'\r\nasciiend\r\n\r\nvar custstyle = ui.AddStyle(\"\r\n^###\r\n^###\r\n^###\")\r\n\r\n//*******************************\r\n// Functions\r\n//*******************************\r\n\r\n//*******************************\r\n// DrawSun()\r\n//\r\n// Creates the panel and \r\n// animation for the pet\r\n// sun art\r\n//\r\n//*******************************\r\nfunc DrawSun()\r\n  sunpnl = ui.AddPanel()\r\n  sunpnl.style = custstyle\r\n  sunpnl.anchor = top_left\r\n  sunpnl.dock = top_left\r\n  sunpnl.x = -20\r\n  sunpnl.y = -10\r\n  sunpnl.w = 9\r\n  sunpnl.h = 5\r\n  \r\n  sunanim = ui.AddAnim(sunpet)\r\n  sunanim.anchor = center_center\r\n  sunanim.dock = center_center\r\n  sunanim.loop = true\r\n  sunanim.duration = sunstrobe\r\n  sunanim.color = suncolor \r\n  sunanim.Play()\r\n\r\n  suntext = ui.AddText()\r\n  suntext.anchor = center_center\r\n  suntext.dock = center_center\r\n  suntext.w = 3\r\n  suntext.h = 1\r\n  suntext.text = \" ''\"\r\n\r\n  sunpnl.Add(sunanim)\r\n  sunpnl.Add(suntext)\r\n//\r\n\r\n//*******************************\r\n// MoveSun()\r\n//\r\n// Updates the pet sun panel\r\n// with new x/y coordinates \r\n// converting them from the \r\n// world to screen positions for\r\n// use with the sun panel. Also,\r\n// updates sun's expression in \r\n// response to player's facial\r\n// expression.\r\n//\r\n//*******************************\r\nfunc MoveSun()\r\n\r\n  y = math.RoundToInt(sunsizey*math.Cos(\r\n             ^math.ToRad(totaltime)*mody))\r\n  \r\n  ?lastPlayerZ+2 < pos.z\r\n    lastPlayerZ++\r\n  :?lastPlayerZ-2 > pos.z\r\n    lastPlayerZ--\r\n\r\n  sunpnl.y = y+screen.FromWorldZ(lastPlayerZ)\r\n             ^+ sundisty\r\n\r\n\r\n  ?currx + 1 < pos.x\r\n    currx++\r\n\r\n  ?!ai.walking\r\n    x = math.RoundToInt(sunsizex*math.Sin(\r\n             ^math.ToRad(totaltime)*modx))\r\n    ?sinx < x\r\n      sinx = sinx + 0.1\r\n    :?sinx > x\r\n      sinx = sinx - 0.1\r\n    \r\n  sunpnl.x = math.RoundToInt(sinx)+\r\n             ^screen.FromWorldX(currx)\r\n             ^+ sundistx\r\n    \r\n\r\n  ?face = \"°°\"\r\n    suntext.text = \" °°\"\r\n    sunanim.duration = sunalert\r\n  :?face = \"^^\"\r\n    suntext.text = \" ^^\"\r\n    sunanim.duration = sunalert\r\n  : \r\n    suntext.text = \" ''\"\r\n    sunanim.duration = sunstrobe\r\n//\r\n\r\n\r\n//*******************************\r\n// Drawing Code \r\n//*******************************\r\n\r\n?totaltime <= 1\r\n  DrawSun()\r\n  currx = -50\r\n:\r\n  MoveSun()\r\n\r\n//*******************************\r\n// End of File\r\n//*******************************"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Boo.txt" - Parse error: Failed to parse completely. Remaining: "= 42 //minimum distance\r\nvar totTime\r\nvar euler = 2.718281828459\r\nvar aiwalk\r\nvar foe_ = foe\r\nvar notRocky = (loc ! rocky)\r\nvar px = pos.x\r\nvar x = px - minDistance + 1\r\nvar pz = pos.z\r\nvar z = pz - 1\r\nvar pkup = pickup\r\nvar speed = 0\r\nvar markposX\r\nvar fallsleeptime = 150\r\nvar d\r\nvar t = 0\r\nvar sx\r\nvar bodyY\r\n\r\nvar timeToQuip = randGeometric(1.0/181)    //Time left to next quip.\r\nvar quipme = 0     //Are we currently saying a quip?\r\nvar quippos        //Where the quip starts, horizontally. A factor of the length of the quip's longest line.\r\nvar quipht         //Where the quip starts, vertically. A factor of the quip's line count.\r\nvar quipct         //The quip's line count.\r\nvar thequip        //The quip. A string, possibly cut into multiple lines by \\n's\r\nvar midquip        //A line of the quip that is to be put into an array\r\nvar quiplside      //The left side of the quip outline. Literally 2 to the left of the quip's left side.\r\nvar quiparr = []   //The quip, stored in an array of strings instead of 1 string with \\n's\r\nvar i              //for a for loop, to iterate the quip line by line.\r\nvar j              //for a for loop, to draw black squares in the quip text box before writing the quip.\r\nvar qoffx = 10\r\nvar qoffy = -1\r\nvar lastquip = \"\"\r\n\r\n////////////////////////////////////////////////\r\n\r\nBooMain()\r\n\r\n////////////////////////////////////////////////\r\n\r\nfunc initPetBoo()\r\n\r\n  var resetBoo = func()\r\n    BooPnlChildren[2].Stop()\r\n    BooPnlChildren[4].visible = false\r\n    BooPnlChildren[5].visible = false\r\n    BooPnlChildren[6].visible = false\r\n    BooPnlChildren[7].visible = false\r\n    happy = false\r\n    asleep = false\r\n    \r\n  ?ui.root.children.Count() > 0  // Oh no PetBoo is lost!\r\n    for u : ui.root.children\r\n      ?u.w = 66111\r\n        BooPnl = u\r\n        BooPnlChildren = BooPnl.children\r\n        txtBox = BooPnlChildren[6].children[0]\r\n        resetBoo()\r\n        return\r\n\r\n  var addAndInitAnim = func(anim, y, dur, loop)\r\n    BooPnl.Add(anim)\r\n    anim.anchor = top_left\r\n    anim.dock = top_left\r\n    anim.x = 0\r\n    anim.y = y\r\n    anim.duration = dur\r\n    anim.loop = loop\r\n    anim.Play()\r\n    \r\n  BooPnl = ui.AddPanel()\r\n  BooPnlChildren = BooPnl.children\r\n  BooPnl.w = 66111\r\n  BooPnl.h = 1\r\n  BooPnl.style = ui.AddStyle(\"#########\")\r\n  BooPnl.anchor = top_left\r\n  BooPnl.dock = top_left\r\n\r\n  addAndInitAnim(ui.AddAnim(ascii\r\n##.-.\r\n#(# #)#\r\n-´   `-\r\n%%\r\n##.-.\r\n_(# #)_\r\n`.   .´\r\n%%\r\n##.-.\r\n#(# #)\r\n-´   `-\r\n%%\r\n##.-.\r\n#(# #)\r\n#/   \\\r\nasciiend), 0, 40, true)\r\n\r\n  addAndInitAnim(ui.AddAnim(ascii\r\n##o#o#\r\n%%\r\n##=#=#\r\n%%\r\n##-#-#\r\n%%\r\n##-#-#\r\n%%\r\n##=#=#\r\n%%\r\n##o#o#\r\nasciiend), 1, 30, false)\r\n\r\n  addAndInitAnim(ui.AddAnim(ascii\r\n###°##\r\n%%\r\n######\r\n%%\r\n###o##\r\n%%\r\n###-##\r\n%%\r\n###O##\r\n%%\r\n###o##\r\n%%\r\n###-##\r\n%%\r\n###O##\r\n%%\r\n###-##\r\n%%\r\n###o##\r\n%%\r\n###-##\r\n%%\r\n###O##\r\n%%\r\n###-##\r\nasciiend), 2, 156, true)\r\n\r\n  addAndInitAnim(ui.AddAnim(ascii\r\n,_) /\r\n#`-´\r\n%%\r\n,_\\ (\r\n#`--´\r\n%%\r\n#,\\ (\r\n##`--'\r\n%%\r\n##\\ (\r\n###'-'\r\n%%\r\n##) /\r\n##'-'\r\n%%\r\n#,) /\r\n#'-´\r\nasciiend), 3, 18, true)\r\n\r\n  addAndInitAnim(ui.AddAnim(ascii\r\n#####Z##z\r\n##- -#\r\n###°##\r\n%%\r\n#######Z##z\r\n##- -#\r\n###O##\r\n%%\r\n#####z##Z\r\n##- -#\r\n###°##\r\n%%\r\n#######z##Z\r\n##- -#\r\n###O##\r\nasciiend), 0, 60, true)\r\n\r\n  addAndInitAnim(ui.AddAnim(ascii\r\n##^_^#\r\n### ##\r\nasciiend), 1, 30, true)\r\n\r\n  BooPnl.Add(ui.AddPanel())\r\n  BooPnlChildren[6].y = -1\r\n  BooPnlChildren[6].anchor = bottom_center\r\n  BooPnlChildren[6].dock = top_left\r\n  BooPnlChildren[6].x = 6\r\n  BooPnlChildren[6].color = #808080\r\n  BooPnlChildren[6].style = ui.AddStyle(\"\r\n^.─.\r\n^│ │\r\n^'─'\")\r\n  txtBox = ui.AddText(\"\")\r\n  BooPnlChildren[6].Add(txtBox)\r\n  txtBox.anchor = center_center\r\n  txtBox.dock = center_center\r\n  txtBox.align = left\r\n  BooPnl.Add(ui.AddText(\".,\\n/\"))\r\n  BooPnlChildren[7].anchor = bottom_center\r\n  BooPnlChildren[7].dock = top_left\r\n  BooPnlChildren[7].w = 2\r\n  BooPnlChildren[7].h = 2\r\n  BooPnlChildren[7].x = 6\r\n  BooPnlChildren[7].y = 0\r\n  BooPnlChildren[7].color = #808080\r\n  resetBoo()\r\n  \r\n\r\nfunc BooMain()\r\n  \r\n  totTime = totaltime\r\n  foe_ = foe\r\n  aiwalk = ai.walking\r\n  px = pos.x\r\n  pz = pos.z\r\n  pkup = pickup\r\n\r\n  ?totTime = 1\r\n    initPetBoo()\r\n\r\n  //5s fall asleep\r\n  ?speed = 0 & !aiwalk\r\n    fallsleeptime--\r\n    ?fallsleeptime <= 0\r\n      markposX = px\r\n  ?aiwalk\r\n    fallsleeptime = 150\r\n    ?asleep\r\n      BooPnlChildren[4].visible = false\r\n      asleep = false\r\n  d = px - minDistance\r\n  ?totTime = 1 | time = 1 & notRocky\r\n    x = d\r\n    z = pz\r\n    speed = 0\r\n    t = 0\r\n    quipme = 0\r\n    fallsleeptime = 150\r\n  ?x >= d\r\n    speed = 0\r\n  :?speed ! 1\r\n    ?x < d - 20 // 5 + 5 + 10\r\n      speed = 1\r\n    :?x < d - 10 // 5 + 5\r\n      speed = 2\r\n    :?x < d - 5 // 5\r\n      speed = 3\r\n  ?speed <= 1 | !(totTime % (speed - 1))\r\n    ?speed ! 0 & (x < d | z ! pz)\r\n      ?x < d\r\n        x++\r\n        ?speed = 1\r\n          t = (t + 1) % 30\r\n          ?t = 0\r\n            x++\r\n      ?z > pz\r\n        z--\r\n      :?z < pz\r\n        z++\r\n    :\r\n      t = 0\r\n\r\n  ?totTime % 180 = 0 // every 180 frames, blink for the first 30 frames.\r\n                      // 5 frames duration per each of 6 blinkframes.\r\n    BooPnlChildren[1].Play()\r\n\r\n  ?quipme > 0\r\n    quipme--\r\n    ?quipme = 1\r\n      BooPnlChildren[2].Stop()\r\n      BooPnlChildren[2].frame = 0\r\n      BooPnlChildren[6].visible = false\r\n      BooPnlChildren[7].visible = false\r\n      quipme = 0\r\n    :?asleep\r\n      BooPnlChildren[4].visible = false\r\n      asleep = false\r\n\r\n  :?speed = 0 & markposX = px //sleep with a snoring mouth\r\n    BooPnlChildren[2].Stop()\r\n    BooPnlChildren[2].frame = 0\r\n    ?!asleep\r\n      BooPnlChildren[4].visible = true\r\n      asleep = true\r\n\r\n  sx = x - px + 30\r\n  ?sx > -100\r\n    bodyY = z - pz + pos.y - 2\r\n  BooPnl.x = screen.FromWorldX(x + 30)\r\n  BooPnl.y = screen.FromWorldZ(z - 5)\r\n\r\n  ?foe_ = phase\r\n    ?happy = false & foe.hp <= 0\r\n      BooPnlChildren[5].visible = true\r\n      happy = true\r\n      ?asleep\r\n        BooPnlChildren[4].visible = false\r\n        asleep = false\r\n    :?happy = true & foe.hp > 0\r\n      BooPnlChildren[5].visible = false\r\n      happy = false\r\n\r\n  ?pkup = treasure & quipme <= 0\r\n    timeToQuip = 0\r\n\r\n  ?quipme = 0 & timeToQuip > 0\r\n    timeToQuip--\r\n  //If we're not saying a quip, check if we should start a new one.\r\n  :?timeToQuip = 0 & !asleep\r\n    //reset quip timer (you say it for 105 frames)\r\n    quipme = 106\r\n    BooPnlChildren[2].Play()\r\n    timeToQuip = 300 + randGeometric(1.0/181) // At least 10 seconds between quips\r\n    \r\n    //Get a quip and put that quip into an array.\r\n    thequip = getaquip()\r\n    thequip = te.xt(thequip) // Translate it\r\n    quiparr.Clear()\r\n    quiparr = string.Break(thequip, 16)\r\n    \r\n    //Find the maximum width of the lines in the quip, and set the variables for drawing the text box later.\r\n    quipct = quiparr.Count()\r\n    quippos = 0\r\n    for i = 0..quipct-1\r\n      midquip = quiparr[i]\r\n      ?quippos < string.Size(midquip)\r\n        quippos = string.Size(midquip)\r\n    BooPnlChildren[6].visible = true\r\n    BooPnlChildren[7].visible = true\r\n    txtBox.text = string.Join(\"\\n\", quiparr)\r\n    txtBox.h = quipct\r\n    txtBox.w = quippos\r\n    BooPnlChildren[6].h = quipct + 2\r\n    BooPnlChildren[6].w = quippos + 4\r\n    quippos=-quippos+1\r\n    quiplside=quippos-2\r\n    play boo_voice\r\n\r\nfunc randGeometric(p)\r\n  return math.FloorToInt(math.Log(rngf, 1-p))\r\n\r\nfunc getaquip()\r\n  var ds = debuffs.string\r\n  var php = hp\r\n  var pmaxhp = maxhp\r\n  var fs = foe.state\r\n  //place all valid quips in an array, then pick one at random\r\n  var a = [] //big array of potential things to say\r\n  var c = 0  //the random thing that gets said\r\n\r\n  a.Clear()\r\n\t\r\n  // **************************\r\n  // **** QUIPS START HERE ****\r\n  // **************************\r\n  ?pkup = treasure\r\n    a.Add(\"LOOT!!!\")\r\n  :\r\n    //Quips based on world.\r\n\r\n    //Quips based on your status\r\n    ?ai.walking\r\n      a.Add(\"I'm hovering\")\r\n      a.Add(\"*hums a tune*\")\r\n      a.Add(\"My dark world feels brighter by your side.\")\r\n      a.Add(\"This is much better than throwing stones.\\nOr mining!\")\r\n      a.Add(\"This is fun to watch!\")\r\n      a.Add(\"Let's see if you can get even stronger?\")\r\n      a.Add(\"What other cool weapons do you have?\")\r\n      a.Add(\"Can we get some snow cones after this?\")\r\n      a.Add(\"If you need, I can give you a little PUSH.\\nGet it? Haha\")\r\n    ?ds = debuff_dot\r\n      a.Add(\"SOOO HOOOT\")\r\n    ?ds = debuff_chill\r\n      a.Add(\"Oh no.\\nCold, isn't it?\")\r\n    ?ds = debuff_damage\r\n      a.Add(\"You're looking weaker...\")\r\n    ?php = pmaxhp\r\n      a.Add(\"So far, so good\")\r\n      a.Add(\"This is gonna be great!\")\r\n      a.Add(\"We're on an adventure!\")\r\n      a.Add(\"weeee\\nooooo\\nweeee\\nooooo\")\r\n      a.Add(\"You're in great form!\")\r\n    ?php < pmaxhp / 2\r\n      a.Add(\"Be careful to not be UNMADE!\")\r\n    ?armor > pmaxhp / 2\r\n      a.Add(\"Your defense is looking great!\")\r\n\t\t\r\n    //Quips based on location\r\n    ?loc = \"mine\"\r\n      a.Add(\"Being in the mines again is a strange feeling.\")\r\n      a.Add(\"Hello everyone! I'm back!\")\r\n\t\t\r\n    //Quips based on enemy status\r\n    ?fs = 33\r\n      a.Add(\"Oh I'm sorry, was that aimed at me?\")\r\n    ?fs = 115\r\n      a.Add(\"Uh oh what's that?\")\r\n    ?foe_ = nagaraja\r\n      a.Add(\"Oh no!\\nThe Tongue!!!\")\r\n    ?foe_ = boss & foe_ ! pallas\r\n      a.Add(\"I think you're gonna win.\")\r\n      a.Add(\"Boss? More like WUSS!\")\r\n      a.Add(\"They told me this fight would be HARD\")\r\n    ?foe_ = pallas\r\n      a.Add(\"THE GREAT FALLEN GOD!\")\r\n\t\t\r\n    //Random dependant quips\r\n    ?harvest.distance ! 9999\r\n      a.Add(\"What's this thing?\")\r\n    ?pkup\r\n      a.Add(\"LOOT!!!\")\r\n\t\r\n  //In case there are no other quips\r\n  //NOTE YOU NEED AT LEAST ONE OF THESE\r\n  //or the script will get errors if there are no quips.\r\n  ?a.Count() = 0\r\n    a.Add(\" ... \")\r\n  ?a.Count() = 1\r\n    a.Add(\" ... \")\r\n  //return 1 quip. Avoid returning the same as last time\r\n  c = a.IndexOf(lastquip)\r\n  ?c = -1\r\n    lastquip = a[rng % a.Count()]\r\n  :\r\n    var r = rng % (a.Count()-1)\r\n    ?r >= c\r\n      r++\r\n    lastquip = a[r]\r\n  return lastquip"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Wisp.txt" - Parse error: Failed to parse completely. Remaining: "= true      // Show daily chest with sparkles\r\nvar Chatter = true        // Enable chatter\r\nvar NaviMode = false      // Hey! Listen!\r\nvar NaviChance = 100      // 1 in n chance to enable on init\r\nvar AnimInterval = 3      // Animations update every n frames\r\nvar ChatInterval = 300    // Minimum frames before next chatter\r\nvar ChatDuration = 45     // Base chatter duration\r\nvar ChanceAttack = 0.2    // foe.state chatter\r\nvar ChanceBoss = 0.5      // boss chatter\r\nvar ChanceLocation = 0.5  // location chatter\r\nvar ChanceOther = 0.5     // other chatter\r\n\r\n//\r\n// Variable declarations\r\n//\r\n\r\n// Chatter\r\nvar QuoteTime = 0\r\nvar Chatting = false\r\nvar ThisQuote = \"\"\r\nvar ForceQuote = false\r\n\r\n// Wisp\r\nvar ShowWisp = false\r\nvar WispColor\r\nvar WispX = 0\r\nvar WispY = 0\r\nvar LastPX = 0\r\nvar LastPY = 0\r\nvar LastXMove = 0\r\nvar LastYMove = 0\r\nvar WispXNear = -2\r\nvar WispXFar = -10\r\nvar WispYLower = -2\r\nvar WispYUpper = -8\r\nvar LastScreen = 0\r\n\r\n// System object offloads\r\nvar T = 0   // time\r\nvar TT = 0  // totaltime\r\nvar SI = 0  // screen.i\r\nvar SW = 0  // screen.w\r\nvar SH = 0  // screen.h\r\nvar F = \"\"  // foe\r\nvar FS = 0  // foe.state\r\nvar FT = 0  // foe.time\r\nvar FD = 0  // foe.distance\r\nvar FH = 0  // foe.hp\r\nvar FHX = 0 // foe.maxhp\r\nvar FA = 0  // foe.armor\r\nvar FAX = 0 // foe.maxarmor\r\nvar L = \"\"  // loc\r\nvar PX = 0  // pos.x\r\nvar PZ = 0  // pos.z\r\n\r\n// Wisp animation\r\nvar WispF1 = ascii\r\n###\r\n#ʘ#\r\n###\r\nasciiend\r\nvar WispF2 = ascii\r\n###\r\n#☺#\r\n###\r\nasciiend\r\nvar WispF3 = ascii\r\n###\r\n#•#\r\n###\r\nasciiend\r\nvar WispF4 = ascii\r\n###\r\n#·#\r\n###\r\nasciiend\r\n\r\n// Spinning animation\r\nvar SpinF1 = ascii\r\n#│#\r\n###\r\n#│#\r\nasciiend\r\nvar SpinF2 = ascii\r\n##/\r\n###\r\n/##\r\nasciiend\r\nvar SpinF3 = ascii\r\n###\r\n─#─\r\n###\r\nasciiend\r\nvar SpinF4 = ascii\r\n\\##\r\n###\r\n##\\\r\nasciiend\r\n\r\n// Horizontal flapping animation\r\nvar FlapHF1 = ascii\r\n\\##\r\n###\r\n/##\r\nasciiend\r\nvar FlapHF2 = ascii\r\n#│#\r\n###\r\n#│#\r\nasciiend\r\nvar FlapHF3 = ascii\r\n##/\r\n###\r\n##\\\r\nasciiend\r\n\r\n// Vertical flapping animation\r\nvar FlapVF1 = ascii\r\n\\#/\r\n###\r\n###\r\nasciiend\r\nvar FlapVF2 = ascii\r\n###\r\n─#─\r\n###\r\nasciiend\r\nvar FlapVF3 = ascii\r\n###\r\n###\r\n/#\\\r\nasciiend\r\n\r\n// Animation variables\r\nvar WispAnim = [WispF1,WispF2,WispF3,WispF4,WispF3,WispF2]\r\nvar WispIndex = 3\r\nvar Cycle = 0\r\nvar SpinAnim = [SpinF1,SpinF2,SpinF3,SpinF4]\r\nvar SpinIndex = 0\r\nvar SpinDirection = true\r\nvar SpinDuration = 0\r\nvar FlapAnimH = [FlapHF1,FlapHF2,FlapHF3,FlapHF2]\r\nvar FlapAnimV = [FlapVF1,FlapVF2,FlapVF3,FlapVF2]\r\nvar FlapAnim = []\r\nvar FlapIndex = 0\r\nvar FlapDuration = 0\r\nvar Busy = false\r\nvar Spinning = false\r\nvar Flapping = false\r\nvar Sparkling = false\r\nvar SparkleDuration = 0\r\n\r\n// Spinning animation\r\nfunc SpinWisp()\r\n  >o@WispX@,@WispY@,@WispColor@,@SpinAnim[SpinIndex]@\r\n\r\n// Flapping animation\r\nfunc FlapWisp()\r\n  >o@WispX@,@WispY@,@WispColor@,@FlapAnim[FlapIndex]@\r\n\r\n// Sparkle at absolute X,Y\r\nvar SparklePoint1X\r\nvar SparklePoint1Y\r\nvar SparklePoint2X\r\nvar SparklePoint2Y\r\nfunc SparklePoint(x,y)\r\n  ?TT % AnimInterval = 0 | !SparklePoint1X\r\n    SparklePoint1X = x + ((rng % 8) - 3)\r\n    SparklePoint1Y = y + ((rng % 4) - 2)\r\n    SparklePoint2X = x + ((rng % 6) - 2)\r\n    SparklePoint2Y = y + ((rng % 3) - 1)\r\n  >`@SparklePoint1X@,@SparklePoint1Y@,#rainbow,·\r\n  >`@SparklePoint2X@,@SparklePoint2Y@,#rainbow,•\r\n\r\n// Sparkle at wisp\r\nvar SparkleWisp1X\r\nvar SparkleWisp1Y\r\nvar SparkleWisp2X\r\nvar SparkleWisp2Y\r\nfunc SparkleWisp()\r\n  ?TT % AnimInterval = 0 | !SparkleWisp1X\r\n    SparkleWisp1X = WispX + (rng % 5) - 1\r\n    SparkleWisp1Y = WispY + (rng % 5) - 1\r\n    SparkleWisp2X = WispX + (rng % 3)\r\n    SparkleWisp2Y = WispY + (rng % 3)\r\n  >o@SparkleWisp1X@,@SparkleWisp1Y@,#rainbow,·\r\n  >o@SparkleWisp2X@,@SparkleWisp2Y@,#rainbow,•\r\n\r\n//\r\n// Quotes for chattering\r\n//\r\n\r\n// Annoying chatter!\r\nvar Navi = [\r\n  \"Hello!\",\r\n  \"Hey!\",\r\n  \"Listen!\",\r\n  \"Look!\",\r\n  \"Watch out!\",\r\n  \"Hey! Listen!\"\r\n]\r\n// Boss attacks\r\nvar QBossAttack = [\r\n  \"Oh, no!\",\r\n  \"Watch out!\",\r\n  \"Beware!\",\r\n  \"Incoming!\"\r\n]\r\n// Bosses\r\nvar QDysangelos1 = [\r\n  \"He's a lot uglier now.\",\r\n  \"Time to chill out!\"\r\n]\r\nvar QDysangelos2 = [\r\n  \"Uh, this isn't even my final form?\",\r\n  \"Elemental, my dear Watson.\"\r\n]\r\nvar QDysangelos3 = [\r\n  \"Wow, he hulked out!\",\r\n  \"We're almost there!\"\r\n]\r\nvar QXyloalgia = [\r\n  \"This is tree-son!\",\r\n  \"Inappropriate tree-tment!\",\r\n  \"Treebeard he's not!\",\r\n  \"Make like a tree and leaf!\"\r\n]\r\nvar QPoena = [\r\n  \"Creepy!\",\r\n  \"Gee, that's not creepy at all.\"\r\n]\r\nvar QBolesh = [\r\n  \"Ewwwwww!\",\r\n  \"That's a big spider!\",\r\n  \"Don't let it bite you!\"\r\n]\r\nvar QAngryShroom = [\r\n  \"We're in so much truffle!\",\r\n  \"Knock the spores out of him!\"\r\n]\r\nvar QMorel = [\r\n  \"There's morel of them?\",\r\n  \"Another one?\"\r\n]\r\nvar QEnoki = [\r\n  \"He doesn't look like a fun guy!\",\r\n  \"Spoooooring...\"\r\n]\r\nvar QPallas1 = [\r\n  \"We've got a bone to pick with you!\",\r\n  \"What a numbskull!\"\r\n]\r\nvar QPallas2 = [\r\n  \"Not even a leg to stand on!\",\r\n  \"That's not very humerous.\",\r\n  \"We're down to a skeleton crew!\"\r\n]\r\nvar QGuardian1 = [\r\n  \"The bigger they are...\",\r\n  \"Hammer time!\",\r\n  \"Smash him into spare parts!\"\r\n]\r\nvar QGuardian2 = [\r\n  \"The harder they fall!\",\r\n  \"You've got him now!\"\r\n]\r\nvar QHrimnir = [\r\n  \"Wow, ugliest foe yeti.\",\r\n  \"Time to bring the heat!\",\r\n  \"Ice him!\",\r\n  \"Water the odds?\"\r\n]\r\nvar QNagaraja = [\r\n  \"♫ Na ga ra ja na ga ra! ♫\",\r\n  \"That's why you're careful of strange holes!\"\r\n]\r\n// Passed a foe\r\nvar Missed = [\r\n  \"Hey, you missed one!\",\r\n  \"Leaving foes behind?\"\r\n]\r\n// Locations\r\nvar Plateau = [\r\n  \"The stars at night...\",\r\n  \"...are big and bright!\",\r\n  \"Ready to rock?\"\r\n]\r\nvar Deadwood = [\r\n  \"Got wood?\",\r\n  \"This place bugs me...\",\r\n  \"Down by the river...\"\r\n]\r\nvar Fear = [\r\n  \"I hope you're not claustrophobic...\",\r\n  \"I hope you're not arachnophobic...\",\r\n  \"A lunk spelunks for gunk!\",\r\n  \"What a poisonous atmosphere...\"\r\n]\r\nvar Forest = [\r\n  \"Such vigorous growth!\",\r\n  \"There's not mush room in here...\"\r\n]\r\nvar Haunted = [\r\n  \"OooOOOooooOOoOOooOOoOO...\",\r\n  \"Welcome to the bone zone!\",\r\n  \"This is a grave situation!\"\r\n]\r\nvar Boiling1 = [\r\n  \"It's getting hot in here.\",\r\n  \"Crack that whip!\",\r\n  \"Whip it!\",\r\n  \"Back to work, pusher!\"\r\n]\r\nvar Boiling2 = [\r\n  \"A boiling lake?\",\r\n  \"I'm sure nothing bad will happen here!\"\r\n]\r\nvar IcyR = [\r\n  \"Brrrrrrrr...\",\r\n  \"What an ice place...\"\r\n]\r\nvar Temple0 = [\r\n  \"Looking to join a cult?\",\r\n  \"Are they expecting visitors?\"\r\n]\r\nvar Temple1 = [\r\n  \"So many cultists!\",\r\n  \"Have you heard of our lord and worm?\",\r\n  \"These cultists have a poisonous attitude!\"\r\n]\r\nvar Temple2 = [\r\n  \"Don't let yourself be sacrificed!\",\r\n  \"What did you say this room was called?\",\r\n  \"Sacrificial Chamber? Uh oh.\"\r\n]\r\nvar Scotty = [\r\n  \"Don't get a head of yourself.\",\r\n  \"Time for a skull session?\"\r\n]\r\nvar Bridge = [\r\n  \"We'll burn that bridge when we get to it!\",\r\n  \"It's a long way down!\"\r\n]\r\nvar StreamSilent = [\r\n  \"What a magical view.\",\r\n  \"The stream of the silent...\",\r\n  \"...\"\r\n]\r\nvar HotSpring = [\r\n  \"Nice, are we having a spa day?\",\r\n  \"Hi, Uulaa!\",\r\n  \"Time to relax!\"\r\n]\r\nvar Falls = [\r\n  \"Are we going fishing?\",\r\n  \"Don't fall off the edge!\"\r\n]\r\n// Other foes\r\nvar Acro = [\r\n  \"An Acronian? Down here?\",\r\n  \"You'd better be careful!\"\r\n]\r\nvar Explosive = [\r\n  \"Don't get too close!\",\r\n  \"That looks dangerous!\"\r\n]\r\n\r\n//\r\n// Functions\r\n//\r\n\r\n// Update system variables once per frame\r\nfunc UpdateVars()\r\n  T = time\r\n  TT = totaltime\r\n  SI = screen.i\r\n  SW = screen.w\r\n  SH = screen.h\r\n  F = foe\r\n  ?F\r\n    FD = foe.distance\r\n    FS = foe.state\r\n    FT = foe.time\r\n    FH = foe.hp\r\n    FHX = foe.maxhp\r\n    FA = foe.armor\r\n    FAX = foe.maxarmor\r\n  L = loc\r\n  PX = pos.x\r\n  PZ = pos.z\r\n\r\n// Reset location and movement bounds\r\nfunc Init()\r\n  ShowWisp = true\r\n  LastPX = PX\r\n  LastPY = PZ\r\n  WispX = -3\r\n  WispY = -3\r\n  LastXMove = TT\r\n  LastYMove = TT\r\n  QuoteTime = 0\r\n  LastScreen = 0\r\n  ?TT = 1\r\n    ?!NaviMode & rng % NaviChance = 0\r\n      NaviMode = true\r\n    ?NaviMode\r\n      Chatter = true\r\n      ChatInterval = 150\r\n      ChatDuration = 15\r\n\r\n// Wisp movement\r\nfunc WispMovement()\r\n  WispX = WispX - (PX - LastPX)\r\n  WispY = WispY - (PZ - LastPY)\r\n  LastPX = PX\r\n  LastPY = PZ\r\n  ?!Chatting\r\n    ?WispX < WispXFar\r\n      WispX++\r\n      LastXMove = TT\r\n    :?WispX > WispXNear\r\n      WispX--\r\n      LastXMove = TT\r\n    :?TT > LastXMove + 4\r\n      WispX = WispX + ((rng%3)-1)\r\n      LastXMove = TT\r\n    ?WispY > WispYLower\r\n      WispY--\r\n      LastYMove = TT\r\n    :?WispY < WispYUpper\r\n      WispY++\r\n      LastYMove = TT\r\n    :?TT > LastYMove + 4\r\n      WispY = WispY + ((rng%3)-1)\r\n      LastYMove = TT\r\n\r\n// Color selection is rainbow because I'm lazy.\r\nfunc GetWispColor()\r\n  return #rainbow\r\n\r\n// As above, so below.\r\nfunc GetChatColor()\r\n  return #rainbow\r\n\r\n// False rotates to widdershins.\r\nfunc CoinFlip()\r\n  ?rng % 2 = 1\r\n    return true\r\n  :\r\n    return false\r\n\r\n// Check for location changes.\r\nfunc CheckScreenChange()\r\n  ?LastScreen <= SI\r\n    LastScreen = SI\r\n  :\r\n    LastScreen = SI\r\n    Init()\r\n\r\n// Process animations.\r\nfunc Animate()\r\n  ?!Busy\r\n    Cycle = (rng % 3) - 1\r\n    ?Cycle > 0\r\n      WispIndex++\r\n    :?Cycle < 0\r\n      WispIndex--\r\n    ?WispIndex < 0\r\n      WispIndex = WispAnim.Count() - 1\r\n    :?WispIndex >= WispAnim.Count()\r\n      WispIndex = 0\r\n    ?WispIndex = 3 & SparkleDuration = 0\r\n      ?rng % 20 = 0\r\n        Busy = true\r\n        Sparkling = true\r\n        SparkleDuration = (rng % 10) + 4\r\n    :?WispIndex = 0 & SpinDuration = 0 & FlapDuration = 0\r\n      ?rng % 10 = 0\r\n        ?CoinFlip()\r\n          SpinDuration = (rng % 20) + 4\r\n          SpinDirection = CoinFlip()\r\n          SpinIndex = rng % SpinAnim.Count()\r\n          Busy = true\r\n          Spinning = true\r\n        :\r\n          FlapDuration = (rng % 20) + 4\r\n          ?CoinFlip()\r\n            FlapAnim = FlapAnimH\r\n          :\r\n            FlapAnim = FlapAnimV\r\n          FlapIndex = rng % FlapAnim.Count()\r\n          Busy = true\r\n          Flapping = true\r\n  :?Spinning\r\n    ?SpinDuration > 0\r\n      SpinDuration--\r\n      ?SpinDirection\r\n        SpinIndex++\r\n        ?SpinIndex >= SpinAnim.Count()\r\n          SpinIndex = 0\r\n      :\r\n        SpinIndex--\r\n        ?SpinIndex < 0\r\n          SpinIndex = SpinAnim.Count() - 1\r\n    ?SpinDuration = 0\r\n      Busy = false\r\n      Spinning = false\r\n  :?Flapping\r\n    ?FlapDuration > 0\r\n      FlapDuration--\r\n      FlapIndex++\r\n      ?FlapIndex >= FlapAnim.Count()\r\n        FlapIndex = 0\r\n    ?FlapDuration = 0\r\n      Busy = false\r\n      Flapping = false\r\n  :?Sparkling\r\n    ?SparkleDuration > 0\r\n      SparkleDuration--\r\n    ?SparkleDuration = 0\r\n      Busy = false\r\n      Sparkling = false\r\n\r\n// Check quote chance and select quote.\r\nfunc Quote(quotes)\r\n  ?ForceQuote\r\n    Chatting = true\r\n    QuoteTime = TT\r\n    ThisQuote = quotes[rng % quotes.Count()]\r\n  :?NaviMode\r\n    Chatting = true\r\n    QuoteTime = TT\r\n    ThisQuote = quotes[rng % quotes.Count()]\r\n  :?F = boss\r\n    ?Unhurt()\r\n      ?rngf > ChanceBoss\r\n        QuoteTime = TT\r\n      :\r\n        Chatting = true\r\n        QuoteTime = TT\r\n        ThisQuote = quotes[rng % quotes.Count()]\r\n    :?AttackState()\r\n      ?rngf > ChanceAttack\r\n        QuoteTime = TT\r\n      :\r\n        Chatting = true\r\n        QuoteTime = TT\r\n        ThisQuote = quotes[rng % quotes.Count()]\r\n  :?SI = 0\r\n    ?rngf > ChanceLocation\r\n      QuoteTime = TT\r\n    :\r\n      Chatting = true\r\n      QuoteTime = TT\r\n      ThisQuote = quotes[rng % quotes.Count()]\r\n  :\r\n    ?rngf > ChanceOther\r\n      QuoteTime = TT\r\n    :\r\n      Chatting = true\r\n      QuoteTime = TT\r\n      ThisQuote = quotes[rng % quotes.Count()]\r\n\r\n// Is it time for another quote?\r\nfunc CanQuote()\r\n  ?!Chatting &\r\n  ^(TT > QuoteTime + ChatInterval | QuoteTime = 0)\r\n    return true\r\n  :\r\n    return false\r\n\r\n// Is foe undamaged?\r\nfunc Unhurt()\r\n  return FH = FHX & FA = FAX\r\n\r\n// Is foe attacking?\r\nfunc AttackState()\r\n  return FS = 33 | FS = 112 | FS = 115 | FS = 133 | FS = 142\r\n\r\n// Chatter\r\nfunc WispChatter()\r\n  ?NaviMode\r\n    Quote(Navi)\r\n  :?F & FD <= -5\r\n    Quote(Missed)\r\n  :?AttackState() & F = boss\r\n    Quote(QBossAttack)\r\n  :?F = acronian_scout | F = acronian_cultist & FD <= 23\r\n    Quote(Acro)\r\n  :?F = explode & FD <= 23\r\n    Quote(Explosive)\r\n  :?L = Rocky\r\n    ?T = 15\r\n      Quote(Plateau)\r\n    :?Unhurt() & FD <= 28\r\n      ?F = dysangelos\r\n        ?F = dysangelos_bearer\r\n          Quote(QDysangelos1)\r\n        :?F = dysangelos_elementalist\r\n          Quote(QDysangelos3)\r\n        :?F = dysangelos_perfected\r\n          Quote(QDysangelos3)\r\n  :?L = Canyon\r\n    ?T = 15\r\n      Quote(Deadwood)\r\n    :?Unhurt() & FD <= 28\r\n      ?F = tree_boss\r\n        Quote(QXyloalgia)\r\n      :?F = poena\r\n        Quote(QPoena)\r\n  :?L = Caves\r\n    ?T = 15\r\n      Quote(Fear)\r\n    :?Unhurt() & FD <= 28\r\n      ?F = spider_boss\r\n        Quote(QBolesh)\r\n  :?L = Mushroom\r\n    ?T = 5\r\n      Quote(Forest)\r\n    :?Unhurt() & FD <= 28\r\n      ?F = mushroom_boss_skinny\r\n        Quote(QEnoki)\r\n      :?F = mushroom_boss_fat\r\n        Quote(QMorel)\r\n      :?F = mushroom_boss\r\n        Quote(QAngryShroom)\r\n  :?L = Halls\r\n    ?T = 90\r\n      Quote(Haunted)\r\n    :?Unhurt() & FD <= 28\r\n      ?F = skeleton_boss\r\n        ?F = phase1\r\n          Quote(QPallas1)\r\n        :?F = phase2\r\n          Quote(QPallas2)\r\n  :?L = Guardian\r\n    ?T = 30\r\n      Quote(Boiling2)\r\n    :?F = bronze_guardian\r\n      ?FA <= 0\r\n        Quote(QGuardian2)\r\n      :\r\n        Quote(QGuardian1)\r\n  :?L = Mine\r\n    ?T = 30\r\n      Quote(Boiling1)\r\n  :?L = icy_ridge\r\n    ?T = 30\r\n      Quote(IcyR)\r\n    :?F = hrimnir | F = yeti\r\n      Quote(QHrimnir)\r\n  :?L = Sacrificial\r\n    ?T = 90\r\n      Quote(Temple2)\r\n    :?F = nagaraja\r\n      Quote(QNagaraja)\r\n  :?L = Temple\r\n    ?T = 30\r\n      Quote(Temple1)\r\n  :?L = \"undead_crypt_intro\"\r\n    ?T = 30\r\n      Quote(Scotty)\r\n  :?L = \"uulaa_shop\"\r\n    ?T = 30\r\n      Quote(HotSpring)\r\n  :?L = \"waterfall\"\r\n    ?T = 90\r\n      Quote(Falls)\r\n  :?L = \"cross_bridge\"\r\n    ?T = 90\r\n      Quote(Bridge)\r\n    :?PX = 134\r\n      Quote(StreamSilent)\r\n    :?PX = 318\r\n      Quote(Temple0)\r\n\r\n// Render wisp on screen.\r\nfunc DisplayWisp()\r\n  ?SpinDuration > 0\r\n    SpinWisp()\r\n  :?FlapDuration > 0\r\n    FlapWisp()\r\n  :?SparkleDuration > 0\r\n    SparkleWisp()\r\n  WispColor = GetWispColor()\r\n  >o@WispX@,@WispY@,@WispColor@,@WispAnim[WispIndex]@\r\n\r\n// Render quote on screen.\r\nfunc DisplayChatter()\r\n  >o@WispX + 3@,@WispY - 1@,@GetChatColor()@,/\r\n  >o@WispX + 4@,@WispY - 2@,@GetChatColor()@,@ThisQuote@\r\n\r\n//\r\n// Track daily chest in Haunted Gate\r\n//\r\nvar LCheckX\r\nvar LCheckY\r\nvar RCheckX\r\nvar RCheckY\r\nvar ChestLX\r\nvar ChestLY\r\nvar ChestMX\r\nvar ChestMY\r\nvar ChestRX\r\nvar ChestRY\r\nvar CheckL\r\nvar CheckR\r\nvar SwapTime = 0\r\nvar ChestL = false\r\nvar ChestM = true\r\nvar ChestR = false\r\nvar ChestChatter = [\r\n  \"Shining treasure!\",\r\n  \"Fairy dust!\",\r\n  \"Sparkle time!\"\r\n]\r\n// Chest Tracking\r\nfunc TrackChest()\r\n  ForceQuote = true\r\n  ?PX = 50 & !Chatting\r\n    Quote(ChestChatter)\r\n  :?PX = 52\r\n    LCheckX = (SW/2)-4\r\n    LCheckY = (SH/2)-7\r\n    RCheckX = (SW/2)+1\r\n    RCheckY = (SH/2)-5\r\n    ChestLX = (SW/2)-4\r\n    ChestLY = (SH/2)-10\r\n    ChestMX = (SW/2)+2\r\n    ChestMY = (SH/2)-7\r\n    ChestRX = (SW/2)+8\r\n    ChestRY = (SH/2)-4\r\n    // Check for left swap\r\n    CheckL = draw.GetSymbol(LCheckX, LCheckY)\r\n      ?TT > SwapTime + 3\r\n        ?CheckL = \"(\" | CheckL = \")\"\r\n          ?ChestL | ChestM\r\n            SwapTime = TT\r\n            ChestL = !ChestL\r\n            ChestM = !ChestM\r\n    // Check for right swap\r\n    CheckR = draw.GetSymbol(RCheckX, RCheckY)\r\n      ?TT > SwapTime + 3\r\n        ?CheckR = \"(\" | CheckR = \")\"\r\n          ?ChestR | ChestM\r\n            SwapTime = TT\r\n            ChestR = !ChestR\r\n            ChestM = !ChestM\r\n    ?ChestL\r\n      SparklePoint(ChestLX,ChestLY)\r\n    :?ChestM\r\n      SparklePoint(ChestMX,ChestMY)\r\n    :?ChestR\r\n      SparklePoint(ChestRX,ChestRY)\r\n\r\n//\r\n// Wisp process flow\r\n//\r\nUpdateVars()\r\n?TT = 1\r\n  Init()\r\n?TT % AnimInterval = 0\r\n  Animate()\r\n?ShowWisp\r\n  CheckScreenChange()\r\n  WispMovement()\r\n  DisplayWisp()\r\n  ?L = \"undead_crypt_intro\" & ShowChest\r\n    TrackChest()\r\n  ?Chatter & CanQuote()\r\n    WispChatter()\r\n  ?Chatting & TT < QuoteTime + ChatDuration\r\n    DisplayChatter()\r\n  :\r\n    Chatting = false\r\n    ThisQuote = \"\"\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Snail.txt" - Parse error: Failed to parse completely. Remaining: "sound=1 // Change this to 0 if you do not want the snail sound to play when he moves\r\n\r\nSnailEyeColor = #ECFFBE    // Eye Color    default is #ECFFBE Australian Mint apparantly lol https://abouts.co/color/ECFFBE\r\n//####Oo\r\n\r\nsnailShellColor = #F5B7B1  // Shell Color  default is #F5B7B1 pink\r\n//#_#\r\n//(#)\r\n\r\nsnailSpiralColor = #FF0000 // Spiral Color default is #FF0000 red\r\n//#\r\n//#@\r\n\r\nsnailBodyColor = #80FFFA   // Body Color   default is #80FFFA cyan\r\n//#\r\n//####/\r\n//¯¯¯¯\"\r\n\r\n/*\r\nWIP\r\n##_#Oo\r\n#(@)/#\r\n#\\╤/\"#\r\n(╳┊)##\r\n#|┊|##\r\n\r\n  var moldX\r\n  moldX=myX-1\r\n  >o@moldX@,@myZ@,#663399,ascii\r\n#\r\n#\r\n#\\╤/\r\n(≡┊)\r\n#|┊|\r\nasciiend\r\n  >o@moldX@,@myZ@,#CFB53B,ascii\r\n#\r\n#\r\n##╤\r\nasciiend\r\n  >o@moldX@,@myZ@,#0088FF,ascii\r\n#\r\n#\r\n#\r\n#≡\r\nasciiend\r\n*/\r\n\r\nvar keepDistance = -11 // distance at which the movement animation will play (stateSlime)\r\nvar maxX = -10         // closest offset pet will get to character.  Closer to 0, closer to character\r\nvar maxDistance = -100 // if the pet exceeds this distance, it will teleport to this distance (cannot be further away than this)\r\nvar targetZ = 2       // We want to start the drawing 1 unit below the player agent\r\n\r\n?loc.loop\r\n  keepDistance = -11\r\n  maxX = -10\r\n  maxDistance = -100\r\n  targetZ = 2\r\n\r\nvar x = 0\r\nvar y = 0\r\nvar myX = 0\r\nvar myZ = 0\r\nvar lastPlayerX = 0\r\nvar lastPlayerZ = 0\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1\r\nvar stateSlime = 2\r\nvar currentState = stateNone\r\nvar stateTime = 0\r\n\r\nfunc SetState(newState)\r\n  ?newState = stateSlime & sound=1\r\n    play snail_walk // sound played when pet moves\r\n  currentState = newState\r\n  stateTime = 0\r\n\r\n?currentState = stateNone | time = 1\r\n  lastPlayerX = pos.x\r\n  lastPlayerZ = pos.z\r\n  myX = keepDistance\r\n  myZ = targetZ\r\n\r\n  // Start further away if the snail is summoned while the location is already running\r\n  ?time > 1\r\n    myX = maxDistance\r\n\r\n  SetState(stateIdle)\r\n\r\nmyX = myX - (pos.x - lastPlayerX) // If player has moved, increment myX (distance from player)\r\n\r\nstateTime++\r\n\r\n?currentState = stateIdle\r\n  ?myX < maxDistance | myX > -maxDistance\r\n    myX = maxDistance\r\n  myZ = myZ - (pos.z - lastPlayerZ)\r\n\r\n  ?myX < keepDistance\r\n    SetState(stateSlime)\r\n\r\n:?currentState = stateSlime\r\n  ?myX < maxX\r\n    myX++\r\n\r\n  ?stateTime >= 6\r\n    ?myZ > targetZ\r\n      myZ--\r\n    :?myZ < targetZ\r\n      myZ++\r\n\r\n  ?stateTime >= 15\r\n    SetState(stateIdle)\r\n\r\nlastPlayerX = pos.x\r\nlastPlayerZ = pos.z\r\n\r\n// Draw\r\n?currentState = stateIdle\r\n  >o@myX@,@myZ@,@SnailEyeColor@,ascii\r\n###Oo\r\nasciiend\r\n  >o@myX@,@myZ@,@snailShellColor@,ascii\r\n#_#\r\n(#)\r\nasciiend\r\n  >o@myX@,@myZ@,@snailSpiralColor@,ascii\r\n#\r\n#@\r\nasciiend\r\n  >o@myX@,@myZ@,@snailBodyColor@,ascii\r\n#\r\n###/\r\n¯¯¯\"\r\nasciiend\r\n  x = myX\r\n  y = myZ\r\n  ?face = \"( ^^\"\r\n    >o@x@,@y@,@SnailEyeColor@,ascii\r\n###^^\r\nasciiend\r\n    >o@x@,@y@,@snailBodyColor@,ascii\r\n#\r\n###/\r\n¯¯¯°<meow!\r\nasciiend\r\n  :?face = \"( TT\"\r\n    >o@x@,@y@,@SnailEyeColor@,ascii\r\n###><\r\nasciiend\r\n  :?face = \"°°\"\r\n    ?time % 10 = 0 & myX > keepDistance\r\n      myX--\r\n    ?time % 4 <= 1\r\n      >o@x@,@y@,@SnailEyeColor@,ascii\r\n###oO\r\nasciiend\r\n    ?time % 4 > 1\r\n      >o@x@,@y@,@SnailEyeColor@,ascii\r\n###Oo\r\nasciiend\r\n  :?stateTime % 50 >= 48\r\n    >o@x@,@y@,@SnailEyeColor@,ascii\r\n###O-\r\nasciiend\r\n  :?stateTime % 50 >= 46\r\n    >o@x@,@y@,@SnailEyeColor@,ascii\r\n###=-\r\nasciiend\r\n  :?stateTime % 50 >= 44\r\n    >o@x@,@y@,@SnailEyeColor@,ascii\r\n###--\r\nasciiend\r\n?currentState = stateSlime\r\n  ?stateTime/3 = 0\r\n    >o@myX@,@myZ@,@SnailEyeColor@,ascii\r\n####Oo\r\nasciiend\r\n    >o@myX@,@myZ@,@snailShellColor@,ascii\r\n#_#\r\n(#)\r\nasciiend\r\n    >o@myX@,@myZ@,@snailSpiralColor@,ascii\r\n#\r\n#@\r\nasciiend\r\n    >o@myX@,@myZ@,@snailBodyColor@,ascii\r\n#\r\n###/\r\n¯¯`^\r\nasciiend\r\n  :?stateTime/3 = 1\r\n    >o@myX@,@myZ@,@SnailEyeColor@,ascii\r\n###Oo\r\nasciiend\r\n    >o@myX@,@myZ@,@snailShellColor@,ascii\r\n#_#\r\n(#)\r\nasciiend\r\n    >o@myX@,@myZ@,@snailSpiralColor@,ascii\r\n#\r\n#@\r\nasciiend\r\n    >o@myX@,@myZ@,@snailBodyColor@,ascii\r\n#\r\n###/\r\n¯`´\"\r\nasciiend\r\n  :?stateTime/3 = 2\r\n    >o@myX@,@myZ@,@SnailEyeColor@,ascii\r\n###Oo\r\nasciiend\r\n    >o@myX@,@myZ@,@snailShellColor@,ascii\r\n#_#\r\n(#)\r\nasciiend\r\n    >o@myX@,@myZ@,@snailSpiralColor@,ascii\r\n#\r\n#@\r\nasciiend\r\n    >o@myX@,@myZ@,@snailBodyColor@,ascii\r\n#\r\n###/\r\n`´¯'\r\nasciiend\r\n  :?stateTime/3 = 3\r\n    >o@myX@,@myZ@,@SnailEyeColor@,ascii\r\n###Oo\r\nasciiend\r\n    >o@myX@,@myZ@,@snailShellColor@,ascii\r\n#_#\r\n(#)\r\nasciiend\r\n    >o@myX@,@myZ@,@snailSpiralColor@,ascii\r\n#\r\n#@\r\nasciiend\r\n    >o@myX@,@myZ@,@snailBodyColor@,ascii\r\n#\r\n###/\r\n´¯¯\"\r\nasciiend\r\n  :?stateTime/3 = 4\r\n    >o@myX@,@myZ@,@SnailEyeColor@,ascii\r\n###Oo\r\nasciiend\r\n    >o@myX@,@myZ@,@snailShellColor@,ascii\r\n#_#\r\n(#)\r\nasciiend\r\n    >o@myX@,@myZ@,@snailSpiralColor@,ascii\r\n#\r\n#@\r\nasciiend\r\n    >o@myX@,@myZ@,@snailBodyColor@,ascii\r\n#\r\n###/\r\n¯¯¯\"\r\nasciiend\r\n  x = myX\r\n  y = myZ\r\n  ?face = \"( ^^\"\r\n    >o@x@,@y@,@SnailEyeColor@,ascii\r\n###^^\r\nasciiend\r\n    >o@x@,@y@,@snailBodyColor@,ascii\r\n#\r\n###/\r\n¯¯¯°<meow!\r\nasciiend\r\n  :?face = \"( TT\"\r\n    >o@x@,@y@,@SnailEyeColor@,ascii\r\n###><\r\nasciiend\r\n  :?face = \"°°\"\r\n    ?time % 10 = 0 & myX > keepDistance\r\n      myX--\r\n    ?time % 4 <= 1\r\n      >o@x@,@y@,@SnailEyeColor@,ascii\r\n###oO\r\nasciiend\r\n    >o@myX@,@myZ@,@snailBodyColor@,ascii\r\n#\r\n###/\r\n¯¯¯°\r\nasciiend\r\n    ?time % 4 > 1\r\n      >o@x@,@y@,@SnailEyeColor@,ascii\r\n###Oo\r\nasciiend\r\n    >o@myX@,@myZ@,@snailBodyColor@,ascii\r\n#\r\n###/\r\n¯¯¯\"\r\nasciiend\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Snake.txt" - Parse error: Failed to parse completely. Remaining: "= #white\r\n\r\nvar keepDistance = -30\r\nvar maxX = -14\r\n\r\nvar maxDistance\r\nmaxDistance = -70\r\n\r\nvar targetZ = -1\r\n\r\nvar x = 0\r\nvar y = 0\r\nvar myX = 0\r\nvar myZ = 0\r\nvar lastPlayerX = 0\r\nvar lastPlayerZ = 0\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1\r\nvar stateWalk = 2\r\nvar currentState = stateNone\r\nvar stateTime = 0\r\n\r\n\r\nfunc SetState(newState)\r\n  ?newState = stateWalk\r\n    play serpent_slither\r\n\r\n  currentState = newState\r\n  stateTime = 0\r\n\r\n\r\n?currentState = stateNone | time = 1\r\n  lastPlayerX = pos.x\r\n  lastPlayerZ = pos.z\r\n  myX = keepDistance\r\n  myZ = targetZ\r\n\r\n  // Start further away if the pet is summoned while the location is already running\r\n  ?time > 1\r\n    myX = maxDistance\r\n\r\n  SetState(stateIdle)\r\n\r\n\r\nmyX = myX - (pos.x - lastPlayerX)\r\n\r\nstateTime++\r\n\r\n?currentState = stateIdle\r\n  ?myX < maxDistance | myX > -maxDistance\r\n    myX = maxDistance\r\n  myZ = myZ - (pos.z - lastPlayerZ)\r\n\r\n  ?myX < keepDistance\r\n    SetState(stateWalk)\r\n\r\n:?currentState = stateWalk\r\n  ?myX < maxX\r\n    ?myX < keepDistance | time % 2 = 0\r\n      myX++\r\n\r\n  ?myZ > targetZ\r\n    myZ--\r\n  :?myZ < targetZ\r\n    myZ++\r\n\r\n  :?myX = maxX\r\n    SetState(stateIdle)\r\n\r\n\r\nlastPlayerX = pos.x\r\nlastPlayerZ = pos.z\r\n\r\n// Draw\r\n\r\n?currentState = stateIdle\r\n  >o@myX@,@myZ@,@petColor@,ascii\r\n#########.-.\r\n########((`-'\r\n#########\\\\\r\n#.'¯¯ -.__))\r\n(´###`'---´\r\n#`\r\nasciiend\r\n  ?face = \"°°\"\r\n    ?time % 10 = 0 & myX > keepDistance\r\n      myX--\r\n\r\n    ?time % 4 <= 1\r\n      >o@myX@,@myZ@,@petColor@,ascii\r\n##########o°\r\nasciiend\r\n    ?time % 4 > 1\r\n      >o@myX@,@myZ@,@petColor@,ascii\r\n##########°o\r\nasciiend\r\n\r\n  :?stateTime % 30 <= 2\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n#\r\n#############-\r\nasciiend\r\n  :?stateTime % 30 <= 4\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n#\r\n#############-<\r\nasciiend\r\n  :?stateTime % 30 <= 6\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n#\r\n#############-\r\nasciiend\r\n\r\n?currentState = stateWalk\r\n  ?stateTime % 9 = 0\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n##########.-.\r\n#########((`-'\r\n##########\\\\\r\n#.--._####_))\r\n(´ `'.`¯¯.-´\r\n###### ¯¯\r\nasciiend\r\n\r\n  :?stateTime % 9 = 1\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n##########.-.\r\n#########((`-'\r\n##########\\\\\r\n.-.######__))\r\n´ `:'--'¯.-´\r\n#### `-'¯\r\nasciiend\r\n\r\n  :?stateTime % 9 = 2\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n##########.-.\r\n#########((`-'\r\n##########\\\\\r\n`.#######__))\r\n##·`---'¯.-´\r\n### `'-'¯\r\nasciiend\r\n\r\n  :?stateTime % 9 = 3\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n##########.-.\r\n#########((`-'\r\n##########\\\\\r\n#:######___))\r\n#\\'---'¯_.-´\r\n###`'-'¯\r\nasciiend\r\n\r\n  :?stateTime % 9 = 4\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n##########.-.\r\n#########((`-'\r\n##########\\\\\r\n##.###_,.__))\r\n#('. ´.--.-´\r\n##` ¯´\r\nasciiend\r\n\r\n  :?stateTime % 9 = 5\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n##########.-.\r\n#########((`-'\r\n##########\\\\\r\n#####.--.__))\r\n(·_.´.''-.-´\r\n#`'-´\r\nasciiend\r\n\r\n  :?stateTime % 9 = 6\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n##########.-.\r\n#########((`-'\r\n##########\\\\\r\n####.---.__))\r\n__.´.' '-.-´\r\n`'´\r\nasciiend\r\n\r\n  :?stateTime % 9 = 7\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n##########.-.\r\n#########((`-'\r\n##########\\\\\r\n###.'¯'-.__))\r\n#/.'´ `'-.-´\r\n·´\r\nasciiend\r\n\r\n  :?stateTime % 9 = 8\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n##########.-.\r\n#########((`-'\r\n##########\\\\\r\n##.'¯¯ -.__))\r\n#(´###`'---´\r\n##`\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Bear.txt" - Parse error: Failed to parse completely. Remaining: "= [ascii\r\n##_###_\r\n#(_)_(_)\r\n#/     \\\r\n(   '-' )\r\n#\\_____/\r\nasciiend,\r\n^ascii\r\n##_###_\r\n#(_)_(_)\r\n#/     \\\r\n(   `-` )\r\n#\\_____/\r\nasciiend,\r\n^ascii\r\n##_###_\r\n#(_)_(_)\r\n#/     \\\r\n(  '-'  )\r\n#\\_____/\r\nasciiend,\r\n^ascii\r\n##_###_\r\n#(_)_(_)\r\n#/     \\\r\n(  `-`  )\r\n#\\_____/\r\nasciiend,\r\n^ascii\r\n##_###_\r\n#(_)_(_)\r\n#/     \\\r\n(   >_< )\r\n#\\_____/\r\nasciiend]\r\n\r\n//0~3(loop:01210 / 01230) move / stop(1 / 3)\r\n//4 stop\r\nvar body = [\r\n//move / stop\r\n^ascii\r\n#/ /  |\\\r\n(_/   |_)\r\n##|_|\\_)\r\nasciiend,\r\n^ascii\r\n#| |  ||\r\n#(_)  |)\r\n##|_|_|\r\nasciiend,\r\n^ascii\r\n##\\ \\ |\r\n##|\\_)|\r\n## \\_)|\r\nasciiend,\r\n^ascii\r\n#| |  ||\r\n#(_)  |)\r\n##|_|_|\r\nasciiend,\r\n\r\n//sit\r\n^ascii\r\n#|\\ \\|_\\\r\n#._\\_)_))\r\nasciiend]\r\n\r\nvar icecream = ascii\r\n###___\r\n##(  .)\r\n#( '  ,)\r\n(_______)\r\n#\\_____/\r\n##\\   /\r\n###\\_/\r\nasciiend\r\n\r\n////////// ascii data // end //////////\r\n\r\n\r\n////////// variables // start //////////\r\n\r\nvar headindex = 0\r\nvar bodyindex = 1\r\nvar img\r\n\r\nvar x = pos.x - 20\r\nvar y = pos.y\r\nvar z = pos.z\r\n\r\nvar stopX = 9999\r\nvar stopY = 0\r\nvar stopZ = 0\r\n\r\nvar sx\r\nvar sy\r\n\r\nvar bossFight = false\r\n\r\nvar mode = \"stop\"\r\nvar timer = 0\r\nvar speed\r\n\r\n////////// variables // end //////////\r\n\r\n\r\n///////////////////////////////////\r\n////////// main // start //////////\r\n///////////////////////////////////\r\n\r\nfunc main()\r\n\t?loc.loop | (time = 1 & loc ! rocky)\r\n\t\tresetting()\r\n\t?mode ! \"fixed\"\r\n\t\tcheckStopPosition()\r\n\t\tupdateMoveMode()\r\n\tmoveProcessing()\r\n\t?pos.x - x < 70\r\n\t\tupdateDraw()\r\n\t//test()\r\n\r\n/////////////////////////////////\r\n////////// main // end //////////\r\n/////////////////////////////////\r\n\r\n\r\n////////// loop initialize // start //////////\r\n\r\nfunc resetting()\r\n\theadindex = 0\r\n\tbodyindex = 1\r\n\r\n\t?loc = harder\r\n\t\tx = -500\r\n\t\tz = 20\r\n\t:\r\n\t\tx = pos.x - 20\r\n\t\tz = pos.z\r\n\ty = pos.y\r\n\r\n\tstopX = 9999\r\n\tstopY = 0\r\n\r\n\tbossFight = false\r\n\t\r\n\tmode = \"stop\"\r\n\ttimer = 0\r\n\r\n////////// loop initialize // end //////////\r\n\r\n\r\n////////// check boss fight // start //////////\r\n\r\nfunc checkStopPosition()\r\n\t?foe.count & (foe = boss | (loc.stars > 10 & ((loc = hall & screen.i = 7) | (loc = deadwood & screen.i = 6))))\r\n\t\t?(foe.distance <= 35 & pos.x < screen.x)\r\n\t\t\tstopX = screen.x - screen.w / 2 + 4\r\n\r\n\t\t?loc = icy\r\n\t\t\tstopY = -1\r\n\t\t:?loc = temple | loc = deadwood\r\n\t\t\tstopY = -2\r\n\t\t:?loc = caves | loc = mine | (loc = hall & loc ! harder)\r\n\t\t\tstopY = -3\r\n\t\t:\r\n\t\t\tstopY = -4\r\n\r\n\t\t?foe = phase1\r\n\t\t\tbossFight = true\r\n\t:?!bossFight\r\n\t\t?loc = temple & ai.paused & !foe.count & loc ! harder\r\n\t\t//((loc.stars > 5 & pos.x >= 1154) | (loc.stars > 10 & pos.x >= 1085))\r\n\t\t\tstopX = pos.x - 15\t\r\n\t\t\tmode = \"fixed\"\r\n\t\t:\r\n\t\t\tstopX = 9999\r\n\t\t\tstopY = 0\r\n\r\n////////// check boss fight // end //////////\r\n\r\n////////// check move // start //////////\r\n\r\nfunc updateMoveMode()\r\n\t?x >= stopX & y = stopY\r\n\t\tmode = \"sit\"\r\n\t:?mode ! \"fixed\"\r\n\t\t?x >= pos.x - 15 & stopX = 9999\r\n\t\t\tmode = \"stop\"\r\n\t\t:?mode ! \"find location\"\r\n\t\t\tstopZ = pos.z\r\n\r\n\t\t\t?x >= stopX - y + stopY\r\n\t\t\t\tmode = \"find location\"\r\n\t\t\t:?mode ! \"run\"\r\n\t\t\t\t?x < pos.x - 70\r\n\t\t\t\t\tmode = \"run\"\r\n\t\t\t\t:?x < pos.x - 30\r\n\t\t\t\t\tmode = 3\r\n\t\t\t\t:?x < pos.x - 25\r\n\t\t\t\t\tmode = 2\r\n\t\t\t\t:?x < pos.x - 18\r\n\t\t\t\t\tmode = 1\r\n\r\n////////// check move // end //////////\r\n\r\n\r\n////////// move // start //////////\r\n\r\nfunc moveProcessing()\r\n\theadindex = 0\r\n\r\n\t?mode = \"sit\"\r\n\t\tbodyindex = 4\r\n\t\t?totaltime % 330 >= 0 & totaltime % 330 < 12\r\n\t\t\theadindex = 2\r\n\r\n\t:?mode ! \"stop\" & (x ! stopX | y ! stopY | z ! stopZ)\r\n\t\tupdateMoveSpeed()\r\n\t\ttimer = (timer + 1) % speed\r\n\r\n\t\t?timer = 0\r\n\t\t\tbodyindex = (bodyindex + 1) % 4\r\n\r\n\t\t\t?x < stopX\r\n\t\t\t\tx++\r\n\t\t\t\t?mode = \"run\"\r\n\t\t\t\t\tx++\r\n\r\n\t\t\t?mode = \"find location\"\r\n\t\t\t\t?y > stopY\r\n\t\t\t\t\ty--\r\n\t\t\t\t:\r\n\t\t\t\t\ty = stopY\r\n\t\t\t:\r\n\t\t\t\t?y < 0\r\n\t\t\t\t\ty++\r\n\r\n\t\t\t?z > stopZ\r\n\t\t\t\tz--\r\n\t\t\t:?z < stopZ\r\n\t\t\t\tz++\r\n\t:\r\n\t\ttimer = 0\r\n\t\tbodyindex = 1\r\n\r\n\t?mode = \"run\"\r\n\t\theadindex = 4\r\n\t//blink\r\n\t:?totaltime % 90 >= 0 & totaltime % 90 < 3\r\n\t\theadindex = headindex + 1\r\n\r\nfunc updateMoveSpeed()\r\n\t?type(mode) = int\r\n\t\tspeed = 4 - mode\r\n\t:?mode = \"run\"\r\n\t\tspeed = 1\r\n\t:?mode = \"find location\"\r\n\t\tspeed = 3\r\n\r\n////////// move // end //////////\r\n\r\n\r\n////////// draw // start //////////\r\n\r\nfunc updateDraw()\r\n\tsy = y + pos.y - 4 + z - pos.z\r\n\r\n\t?mode = \"sit\"\r\n\t\tsy++\r\n\t\t\r\n\t\t// icecream\r\n\t\t//sx = x - pos.x + 9\r\n\t\t//>o@sx@,@sy@,@icecream@\r\n\r\n\tsx = x - pos.x\r\n\r\n\t// head\r\n\timg = head[headindex]\r\n\t>o@sx@,@sy@,@img@\r\n\r\n\tsy = sy + 5\r\n\r\n\t// body\r\n\timg = body[bodyindex]\r\n\t>o@sx@,@sy@,@img@\r\n\r\n////////// draw // end //////////\r\n\r\n\r\n////////// test //////////\r\nfunc test()\r\n\timg = head[headindex]\r\n\t>`0,0,@img@\r\n\timg = body[bodyindex]\r\n\t>`0,5,@img@\r\n\ta = foe = phase1\r\n\t>`0,10,@headindex@ @bodyindex@ @mode@ @bossFight@\\n@x@ @y@ @z@\\n@stopX@ @stopY@ @stopZ@\\n@sx@ @sy@\r\n\r\n\r\nmain()"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Chick.txt" - Parse error: Failed to parse completely. Remaining: "= [pickup_stone,250]\r\nvar chirpsound = [buy,300]\r\nvar peepsound  = [confirm,300]\r\nvar wingsound  = [bat_wing_small,300]\r\n\r\nvar eggColor   = #FFFCEC\r\nvar chickColor = #FFDD00\r\nvar chirpColor = #FF0000\r\nvar peepColor  = #00FFFF\r\n\r\nvar waitDist    = -20\r\nvar waitDistMin = -25\r\nvar waitDistMax = -15\r\nvar minDistance = -8\r\nvar targetZ = 1\r\n\r\n//*******************************\r\n// Global Variables\r\n//*******************************\r\n\r\nvar lvl\r\nvar hatchdur = 50\r\nvar noiseflag = 0\r\nvar x = 0\r\nvar y = 0\r\nvar myX = 0\r\nvar myZ = 0\r\nvar lastPlayerX = 0\r\nvar lastPlayerZ = 0\r\nvar maxDistance = -70\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1\r\nvar stateJump = 2\r\nvar stateFly  = 3\r\nvar stateLand = 4\r\nvar currentState = stateNone\r\nvar stateTime = 0\r\nvar clicked = false\r\nvar peeping = 0\r\n\r\nvar epanel\r\nvar eanim1\r\nvar eanim2\r\nvar canim\r\nvar epeep\r\n\r\nvar cpanel\r\nvar cidle\r\nvar chirp\r\nvar calert\r\nvar peep\r\nvar cjump\r\nvar cfly\r\nvar cland\r\nvar auth\r\nvar butt\r\n\r\n//*******************************\r\n// ASCII Art\r\n//*******************************\r\n\r\nvar hatch1 = ascii\r\n#\r\n######,-.\r\n#####:   :\r\n#####'._.'\r\n%%\r\n#\r\n######,-.\r\n#####: ; : \r\n#####'._.'\r\n%%\r\n#\r\n######,-.\r\n#####:·; :\r\n#####'._.'\r\n%%\r\n#\r\n######,-.\r\n#####:·;,:\r\n#####'._.'\r\n%%\r\n######,-.\r\n#####:·;,:\r\n####`({_,O-\r\n#####'._.'\r\n%%\r\n#####,-,\r\n####:,`_O-\r\n####`{/_;,\r\n#####'._.'\r\n%%\r\n#\r\n######__O<\r\n####'{/_;,\r\n:';´:'._.'\r\n#`-´\r\n%%\r\n#\r\n######__O-\r\n####`{/_;,\r\n:';´:'._.'\r\n#`-´\r\n%%\r\n#\r\n######__O-\r\n####`{/_;,\r\n:';´:'._.'\r\n#`-´\r\n%%\r\n#\r\n######__O-\r\n####`{/ ;\r\n######^^\r\n#\r\n%%\r\n#\r\n######__O-\r\n####`{/_;,\r\n:';´:'._.'\r\n#`-´\r\n%%\r\n#\r\n######__O-\r\n####`{/ ;\r\n######^^\r\n#\r\nasciiend\r\n\r\nvar hatch2 = ascii\r\n#\r\n#\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n####`({#,O-\r\n#\r\n%%\r\n#\r\n#######_O-\r\n####`{/#;\r\n#\r\n%%\r\n#\r\n######__O<\r\n####,{/#;\r\n#\r\n#\r\n%%\r\n#\r\n######__O-\r\n####`{/#;\r\n#\r\n#\r\n%%\r\n#\r\n######__O-\r\n####`{/#;\r\n#\r\n#\r\n%%\r\n#\r\n######__O-\r\n####`{/ ;\r\n######^^\r\n#\r\n%%\r\n#\r\n######__O-\r\n####`{/_;\r\n#\r\n#\r\n%%\r\n#\r\n######__O-\r\n####`{/ ;\r\n######^^\r\n#\r\nasciiend\r\n\r\n\r\nvar chickidle = ascii\r\n##__O-\r\n`{/ ;\r\n##^^\r\n%%\r\n#{\\\\O<\r\n,( ¯;\r\n##^^\r\n%%\r\n##__O<\r\n`{/ ;\r\n##^^\r\n%%\r\n##__O-\r\n`{/ ;\r\n##^^\r\nasciiend\r\n\r\nvar chickalert = ascii\r\n##__O-\r\n`{/ ;\r\n##^^\r\n%%\r\n#{\\\\O<\r\n,( ¯;\r\n##^^\r\nasciiend\r\n\r\nvar chickjump = ascii\r\n#\r\n#\r\n##__O-\r\n`{/ ;\r\n##^^\r\n%%\r\n#\r\n#\r\n#{\\\\O-\r\n,( ¯;\r\n##^^\r\n%%\r\n#\r\n##__O-\r\n`{/ /\r\n#´´\r\n#\r\n%%\r\n#{\\\\O-\r\n`( ¯/\r\n#´´\r\n#\r\n#\r\nasciiend\r\n\r\nvar chickfly = ascii\r\n#{\\\\O-\r\n,( ¯/\r\n#´´\r\n%%\r\n##__O-\r\n`{/ /\r\n#´´\r\nasciiend\r\n\r\nvar chickland = ascii\r\n#{\\\\O-\r\n`( ¯/\r\n#´´\r\n#\r\n#\r\n%%\r\n#\r\n##__O-\r\n`{/ /\r\n##^^\r\n#\r\n%%\r\n#\r\n#\r\n#{\\\\O-\r\n,( ¯;\r\n##^^\r\n%%\r\n#\r\n#\r\n##__O-\r\n`{/ ;\r\n##^^\r\nasciiend\r\n\r\nvar textchirp = ascii\r\n#Chirp!\r\n´\r\nasciiend\r\n\r\nvar textpeep = ascii\r\n#Peep!\r\n´\r\nasciiend\r\n\r\nvar textauth = ascii\r\n#♣Sven\r\n´\r\nasciiend\r\n\r\nvar custstyle = ui.AddStyle(\"\r\n^###\r\n^###\r\n^###\")\r\n\r\n\r\n//*******************************\r\n// Functions\r\n//*******************************\r\n\r\n//*******************************\r\n// DrawEgg()\r\n//\r\n// Creates the panel and \r\n// animations for the egg \r\n// hatching art\r\n//\r\n//*******************************\r\nfunc DrawEgg()\r\n  epanel = ui.AddPanel()\r\n  epanel.anchor = top_left\r\n  epanel.dock = top_left\r\n  epanel.w = 11\r\n  epanel.h = 5\r\n  epanel.style = custstyle \r\n\r\n  eanim1 = ui.AddAnim(hatch1)\r\n  eanim1.duration = hatchdur\r\n  eanim1.color = #87867E\r\n\r\n  eanim2 = ui.AddAnim(hatch1)\r\n  eanim2.duration = hatchdur\r\n  eanim2.color = eggColor\r\n\r\n  canim = ui.AddAnim(hatch2)\r\n  canim.duration = hatchdur\r\n  canim.color = chickColor\r\n\r\n  epeep = ui.AddAnim(textpeep)\r\n  epeep.color = peepColor\r\n  epeep.x = 9\r\n  epeep.y = -1\r\n  epeep.visible = false\r\n\r\n  epanel.Add(eanim1)\r\n  epanel.Add(eanim2)\r\n  epanel.Add(canim)\r\n  epanel.Add(epeep)\r\n//\r\n\r\n//*******************************\r\n// DrawChick()\r\n//\r\n// Creates the panel and \r\n// animations for the pet\r\n// chick art\r\n//\r\n//*******************************\r\nfunc DrawChick()\r\n  cpanel = ui.AddPanel()\r\n  cpanel.anchor = top_left\r\n  cpanel.dock = top_left\r\n  cpanel.w = 6\r\n  cpanel.h = 5\r\n  cpanel.style = custstyle \r\n  cpanel.visible = false\r\n\r\n  cidle = ui.AddAnim(chickidle)\r\n  cidle.loop = false\r\n  cidle.duration = 25\r\n  cidle.color = chickColor\r\n  cidle.y = 1\r\n\r\n  calert = ui.AddAnim(chickalert)\r\n  calert.loop = false\r\n  calert.duration = 7\r\n  calert.color = chickColor\r\n  calert.y = 1\r\n\r\n  cjump = ui.AddAnim(chickjump)\r\n  cjump.loop = false\r\n  cjump.duration = 10\r\n  cjump.color = chickColor\r\n\r\n  cfly = ui.AddAnim(chickfly)\r\n  cfly.loop = true\r\n  cfly.duration = 7\r\n  cfly.color = chickColor\r\n  cfly.y = -2\r\n\r\n  cland = ui.AddAnim(chickland)\r\n  cland.loop = false\r\n  cland.duration = 10\r\n  cland.color = chickColor\r\n\r\n  chirp = ui.AddAnim(textchirp)\r\n  chirp.color = chirpColor\r\n  chirp.x = 7\r\n  chirp.visible = false\r\n\r\n  peep = ui.AddAnim(textpeep)\r\n  peep.color = peepColor\r\n  peep.x = 7\r\n  peep.visible = false\r\n\r\n  auth = ui.AddAnim(textauth)\r\n  auth.color = peepColor\r\n  auth.x = 7\r\n  auth.visible = false\r\n\r\n  butt = ui.AddButton()\r\n  butt.w = 1\r\n  butt.h = 1\r\n  butt.y = 1\r\n  butt.SetUp(ChickClick)\r\n  butt.text = \"\"\r\n  butt.style = custstyle\r\n  butt.hcolor = #000000\r\n  butt.visible = false\r\n  butt.sound = wand_air_hit\r\n  \r\n  cpanel.Add(cidle)\r\n  cpanel.Add(calert)\r\n  cpanel.Add(cjump)\r\n  cpanel.Add(cfly)\r\n  cpanel.Add(cland)\r\n  cpanel.Add(chirp)\r\n  cpanel.Add(peep)\r\n  cpanel.Add(butt)\r\n  cpanel.Add(auth)\r\n//\r\n\r\nfunc ChickClick()\r\n  ?clicked = false\r\n    clicked = true\r\n//\r\n\r\n//*******************************\r\n// SetState()\r\n//\r\n// Sets the next state and \r\n// resets the stateTime timer\r\n//\r\n//*******************************\r\nfunc SetState(newState)\r\n  currentState = newState\r\n  stateTime = 0\r\n//\r\n\r\n//*******************************\r\n// ShowChick()\r\n//\r\n// Controls which animation is\r\n// visible depending on what \r\n// state the chick is in\r\n//\r\n//*******************************\r\nfunc ShowChick(state)\r\n  cidle.visible = false\r\n  calert.visible = false\r\n  cjump.visible = false\r\n  cfly.visible  = false\r\n  cland.visible = false\r\n  butt.visible = false\r\n\r\n  ?state = 0 //Idle\r\n    butt.visible = true\r\n    cidle.visible = true\r\n  ?state = 1 //Jump\r\n    clicked = false\r\n    cjump.visible = true\r\n    cjump.Play()\r\n    chirp.visible = false\r\n    peep.visible  = false\r\n    auth.visible  = false\r\n  :?state = 2 //Fly\r\n    clicked = false\r\n    cfly.visible  = true\r\n    cfly.Play()\r\n  :?state = 3 //Land\r\n    clicked = false\r\n    cland.visible = true\r\n    cland.Play()\r\n  :?state = 5 //Alert\r\n    clicked = false\r\n    calert.visible = true\r\n//\r\n\r\n//*******************************\r\n// MoveChick()\r\n//\r\n// Updates the pet chick panel\r\n// with new x/y coordinates \r\n// converting them from the \r\n// world to screen positions for\r\n// use with the chick panel\r\n//\r\n//*******************************\r\nfunc MoveChick(x,y)\r\n  cpanel.x = x+screen.FromWorldX(pos.x) - 6\r\n  cpanel.y = y+screen.FromWorldZ(lastPlayerZ) \r\n             ^- 4 + targetZ\r\n//\r\n\r\n//*******************************\r\n// MakeNoise()\r\n//\r\n// Controls which and when sounds\r\n// are played depending on the \r\n// noise desired, the state of\r\n// the chick, and if a noise is\r\n// already playing\r\n//\r\n//*******************************\r\nfunc MakeNoise(noise)\r\n  ?noise = 0 //hatch\r\n    ?canim.frame < 5\r\n      play @hatchsound[0]@ @hatchsound[1]@\r\n    ?canim.frame = 6\r\n      chirp.visible = false\r\n      epeep.visible = true\r\n      ?noiseflag < 1\r\n        play @peepsound[0]@ @peepsound[1]@\r\n        noiseflag = 1\r\n    :?canim.frame = 7\r\n      epeep.visible = true\r\n    :\r\n      noiseflag = 0 \r\n      epeep.visible = false \r\n\r\n  :?noise = 1 //peep\r\n    ?peeping = 0 & clicked = true\r\n      peeping = 2\r\n      clicked = false\r\n    :?peeping = 0 & (1 + rng % 30) = 1\r\n      peeping = 1\r\n    :?peeping > 0\r\n      ?!cidle.playing\r\n        cidle.Play()\r\n        noiseflag = 0\r\n      ?cidle.frame = 0\r\n        auth.visible = false\r\n        peep.visible = false\r\n      :?cidle.frame = 1\r\n        ?noiseflag < 1\r\n          chirp.visible = false\r\n          ?peeping = 1\r\n            peep.visible = true\r\n            auth.visible = false\r\n          :?peeping = 2\r\n            peep.visible = false\r\n            auth.visible = true\r\n          play @peepsound[0]@ @peepsound[1]@\r\n          noiseflag = 1\r\n      :?cidle.frame = 2\r\n        noiseflag = 0\r\n        ?peeping = 1\r\n          peep.visible = true\r\n          auth.visible = false\r\n        :?peeping = 2\r\n          peep.visible = false\r\n          auth.visible = true\r\n      :?cidle.frame = 3\r\n        auth.visible = false\r\n        peep.visible = false\r\n        peeping = 0\r\n      :\r\n        auth.visible = false\r\n        peep.visible = false\r\n\r\n  :?noise = 2 //Alert\r\n    ?!calert.playing\r\n      calert.Play()\r\n      noiseflag = 0\r\n    :?calert.frame = 1\r\n      ?noiseflag < 1\r\n        auth.visible = false\r\n        peep.visible = false\r\n        chirp.visible = true\r\n        play @chirpsound[0]@ @chirpsound[1]@\r\n        noiseflag = 1\r\n    :\r\n      noiseflag = 0\r\n      chirp.visible = false\r\n\r\n  :?noise = 3 //Success\r\n    ?!calert.playing\r\n      calert.Play()\r\n    :?calert.frame = 1\r\n      ?noiseflag < 1\r\n        auth.visible = false\r\n        chirp.visible = false\r\n        peep.visible = true\r\n        play @peepsound[0]@ @peepsound[1]@\r\n        noiseflag = 1\r\n    :\r\n      noiseflag = 0  \r\n      peep.visible = false\r\n\r\n  :?noise = 4 //fly\r\n    ?noiseflag < 1\r\n      play @wingsound[0]@ @wingsound[1]@\r\n      noiseflag = 1\r\n    :\r\n      noiseflag = 0\r\n//\r\n\r\n//*******************************\r\n// AnimateChick()\r\n//\r\n// The main function controlling\r\n// the pet chick, determing what\r\n// state it's in, what animation\r\n// to show, what noises to make,\r\n// and when to update movement\r\n//\r\n//*******************************\r\nfunc AnimateChick()\r\n  ?currentState = stateNone | time = 1\r\n    ?totaltime <= 1\r\n      DrawEgg()\r\n      DrawChick() \r\n\r\n      lvl = loc.id\r\n      ?lvl = \"waterfall\"\r\n        targetZ = 0\r\n\r\n    lastPlayerX = pos.x\r\n    lastPlayerZ = pos.z\r\n    myX = waitDistMin\r\n    myZ = targetZ\r\n    epanel.x = myX+screen.FromWorldX(pos.x) - 10\r\n    epanel.y = myZ+screen.FromWorldZ(lastPlayerZ) \r\n               ^- 3 + targetZ\r\n\r\n    ?pos.x > 0\r\n      epanel.visible = false\r\n      SetState(stateIdle)\r\n    :\r\n      SetState(stateHatch)\r\n    \r\n  :?currentState = stateHatch\r\n    ?!eanim1.playing\r\n      eanim1.Play()\r\n    :?eanim1.playing\r\n      eanim2.Play()\r\n      canim.Play()\r\n    \r\n    MakeNoise(0)\r\n \r\n    ?canim.frame = 11 \r\n      ShowChick(0)\r\n      epanel.visible = false\r\n      SetState(stateIdle)\r\n\r\n  :?currentState = stateIdle\r\n    ShowChick(0)\r\n \r\n    ?face = \"°°\"\r\n      ShowChick(5)\r\n      MakeNoise(2)\r\n    :?face = \"^^\"\r\n      ShowChick(5)\r\n      MakeNoise(3)\r\n    : \r\n     ShowChick(0)\r\n     MakeNoise(1)\r\n\r\n    ?myX < maxDistance | myX > -maxDistance\r\n      myX = maxDistance\r\n\r\n    ?myX < waitDist\r\n      SetState(stateJump)\r\n  \r\n  :?currentState = stateJump\r\n    ShowChick(1)\r\n    ?!cjump.playing\r\n      cjump.Play()\r\n    :\r\n      ?cjump.frame > 2\r\n        MakeNoise(4)\r\n        ?myX < minDistance\r\n          myX++\r\n      ?cjump.frame = 3\r\n        currentState = stateFly\r\n\r\n  :?currentState = stateFly\r\n    ShowChick(2)\r\n    MakeNoise(4)\r\n    ?!cfly.playing\r\n      cfly.Play()\r\n    :\r\n      ?stateTime/4 >= 5\r\n        currentState = stateLand\r\n\r\n    ?myX < minDistance\r\n      myX++\r\n\r\n    ?lastPlayerZ < pos.z\r\n      lastPlayerZ++\r\n    :?lastPlayerZ > pos.z\r\n      lastPlayerZ--\r\n\r\n  :?currentState = stateLand\r\n    ShowChick(3)\r\n    ?!cland.playing\r\n      cland.Play()\r\n    :\r\n      ?cland.frame < 3\r\n        MakeNoise(4)\r\n        ?myX < minDistance\r\n          myX++\r\n      ?cland.frame = 3\r\n        currentState = stateIdle\r\n\r\n    waitDist = waitDistMin + rng %\r\n     ^(waitDistMax - waitDistMin + 1)   \r\n\r\n  myX = myX - (pos.x - lastPlayerX)\r\n  stateTime++\r\n  lastPlayerX = pos.x\r\n  MoveChick(myX,myZ)\r\n//\r\n\r\n\r\n//*******************************\r\n// Drawing Code \r\n//*******************************\r\n\r\n//?loc.begin | loc.loop\r\n//  DrawEgg()\r\n//  DrawChick()\r\n\r\nAnimateChick()\r\n\r\n//*******************************\r\n// End of File\r\n//*******************************"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Pomeranian.txt" - Parse error: Failed to parse completely. Remaining: "= #FFFFFF\r\nvar backpackColour = #AD7A40\r\nvar candleColour = #fff0af\r\nvar fireColour = #ff7300\r\nvar lightColour = #0e0a07\r\nvar lightColour2 = #26201a\r\n// var lightColour = #ff7300\r\n\r\nvar keepDistance = -10                     // Distance from Stonehead\r\nvar maxX = -9                              // Closest to Stonehead\r\n\r\nvar maxDistance = -20                      // Max distance before teleporting back     \r\n\r\nvar targetZ = 0                           // Z position relative\r\n\r\nvar x = 0\r\nvar y = 0\r\nvar myX = 0\r\nvar myZ = 0\r\nvar lastPlayerX = 0\r\nvar lastPlayerZ = 0\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1                          // Standing around\r\nvar stateSit = 2                           // Standing too long\r\nvar stateWalk = 3                          // Walking\r\nvar currentState = stateNone\r\nvar stateTime = 0                          // Time in current state\r\nvar sitting = 0                            // Time to determine sit\r\n\r\nfunc SetState(newState)\r\n  currentState = newState                  // Set new state\r\n  stateTime = 0                            // Reset time\r\n\r\n?currentState = stateNone | time = 1       // If start\r\n  lastPlayerX = pos.x                      // Set last player position\r\n  lastPlayerZ = pos.z                      // Set last player position\r\n  myX = keepDistance                       // Set distance from Stonehead\r\n  myZ = targetZ                            // Set Z position\r\n\r\n  ?time > 1                                // If you're already in\r\n    myX = maxDistance                      // Set to farthest\r\n\r\n  SetState(stateWalk)                      // Start walking\r\n\r\nmyX = myX - (pos.x - lastPlayerX)          // Move with player\r\n\r\nstateTime++                                // Increment time\r\n\r\n?currentState = stateIdle                  // If he's idle\r\n  ?myX < maxDistance | myX > -maxDistance  // If not in range\r\n    myX = maxDistance                      // Set to farthest\r\n  myZ = myZ - (pos.z - lastPlayerZ)        // Set height\r\n\r\n  ?myX < keepDistance                      // If too far\r\n    SetState(stateWalk)                    // Start walking\r\n\r\n:?currentState = stateWalk                 // If he's walking\r\n  ?myX < maxX                              // and too far\r\n    myX++                                  // Move closer\r\n  \r\n  ?loc = \"waterfall\"\r\n    ?rng % 10 = 0 & myZ < 0\r\n      myZ++\r\n    :?rng % 10 = 1 & myZ > -4\r\n      myZ--\r\n  :\r\n    ?rng % 10 = 0 & myZ < 7\r\n      myZ++\r\n    :?rng % 10 = 1 & myZ > 0\r\n      myZ--\r\n\r\n// ?stateTime >= 6                            // If more than 6 frames\r\n//   ?myZ > targetZ                           // Reset Z position\r\n//     myZ--\r\n//   :?myZ < targetZ\r\n//     myZ++\r\n\r\n?currentState = stateWalk                  // If he's walking\r\n  >c0,2,Why\r\n  sitting = 0                              // Reset sitting timer\r\n  ?!ai.walking                             // But if you're not walking\r\n    SetState(stateIdle)                    // Set him to idle\r\n\r\n?currentState = stateIdle                  // If he's idle\r\n  sitting++                                // Start counting\r\n  ?sitting >= 50 & foe.distance = 9999     // If the count is high enough and no enemies\r\n    SetState(stateSit)                     // Sit\r\n\r\nlastPlayerX = pos.x                        // Set last player position\r\nlastPlayerZ = pos.z\r\n\r\n?currentState = stateSit & stateTime % 6 < 3\r\n    >o@myX@,@myZ@,@dogColour@,ascii\r\n##;\"|\r\nι/, ;\r\nasciiend\r\n:?currentState = stateSit & stateTime % 6 >= 3\r\n    >o@myX@,@myZ@,@dogColour@,ascii\r\n##;\"|\r\n_/, ;\r\nasciiend\r\n:?currentState = stateIdle\r\n    >o@myX@,@myZ@,@dogColour@,ascii\r\n:_;\"|\r\n;.,,'\r\nasciiend\r\n:?currentState = stateWalk & stateTime % 3 = 0\r\n^| stateTime % 3 = 1\r\n    >o@myX@,@myZ@,@dogColour@,ascii\r\n:_;\"|\r\n:.,.'\r\nasciiend\r\n:?currentState = stateWalk & stateTime % 3 = 2\r\n    >o@myX@,@myZ@,@dogColour@,ascii\r\n:_;\"|\r\n;.メ'\r\nasciiend\r\n\r\n// Backpack\r\n?currentState = stateWalk\r\n^& stateTime % 20 < 5\r\n  >o@myX@,@myZ@,@backpackColour@,ascii\r\n#⌐\r\n#´\r\nasciiend\r\n:?currentState = stateWalk\r\n^& stateTime % 20 < 10\r\n  >o@myX@,@myZ@,@backpackColour@,ascii\r\n#⌐\r\n#'\r\nasciiend\r\n:?currentState = stateWalk\r\n^& stateTime % 20 < 15\r\n  >o@myX@,@myZ@,@backpackColour@,ascii\r\n#⌐\r\n#`\r\nasciiend\r\n:?currentState = stateWalk\r\n^& stateTime % 20 < 20\r\n  >o@myX@,@myZ@,@backpackColour@,ascii\r\n#⌐\r\n#'\r\nasciiend\r\n:?currentState = stateIdle\r\n  >o@myX@,@myZ@,@backpackColour@,ascii\r\n#⌐\r\n#'\r\nasciiend\r\n:?currentState = stateSit\r\n  >o@myX@,@myZ@,@backpackColour@,ascii\r\n#┌\r\n#y\r\nasciiend\r\n\r\n// candle\r\n>o@myX@,@myZ@,@candleColour@,ascii\r\n###╨\r\nasciiend\r\n\r\nvar fireStill = []\r\nfireStill = [\r\nascii\r\n#\r\n·\r\nasciiend,\r\nascii\r\n#\r\n'\r\nasciiend,\r\nascii\r\n#\r\n·\r\nasciiend,\r\nascii\r\n#\r\n'\r\nasciiend,\r\nascii\r\n#\r\n·\r\nasciiend,\r\nascii\r\n#\r\n'\r\nasciiend,\r\nascii\r\n#\r\n•\r\nasciiend,\r\nascii\r\n#\r\n:\r\nasciiend,\r\nascii\r\n.\r\n·\r\nasciiend,\r\nascii\r\n·\r\n'\r\nasciiend,\r\nascii\r\n'\r\n'\r\nasciiend\r\n]\r\n\r\nvar fireWalk = []\r\nfireWalk = [\r\nascii\r\n#\r\n###·\r\nasciiend,\r\nascii\r\n#\r\n###`\r\nasciiend,\r\nascii\r\n#\r\n###·\r\nasciiend,\r\nascii\r\n#\r\n###`\r\nasciiend,\r\nascii\r\n#\r\n###·\r\nasciiend,\r\nascii\r\n#\r\n###`\r\nasciiend,\r\nascii\r\n#\r\n###•\r\nasciiend,\r\nascii\r\n#\r\n###:\r\nasciiend,\r\nascii\r\n##.\r\n###·\r\nasciiend,\r\nascii\r\n#·\r\n###`\r\nasciiend,\r\nascii\r\n'\r\n###`\r\nasciiend\r\n]\r\n\r\n// fire\r\nvar fireTimer = 0\r\n?currentState = stateIdle\r\n^| currentState = stateSit\r\n  >o@myX+3@,@myZ-2@,@fireColour@,@fireStill[fireTimer]@\r\n:?currentState = stateWalk\r\n  >o@myX@,@myZ-2@,@fireColour@,@fireWalk[fireTimer]@\r\n?fireTimer >= 6 & totaltime % 5 = 0\r\n    fireTimer++\r\n:?fireTimer % 2 = 0 & totaltime % 10 = 0\r\n  fireTimer++\r\n:?totaltime % 30 = 0\r\n  fireTimer++\r\n?fireTimer = fireStill.Count()\r\n  fireTimer = 0\r\n\r\nvar fireLightA\r\nvar fireLightB\r\nvar fireLightC\r\nvar fireLightD\r\nvar fireLightE\r\nvar fireLightF\r\nvar basePanel\r\nvar customStyle = ui.AddStyle(\"\r\n^###\r\n^###\r\n^###\")\r\n\r\nfunc SetFire()\r\n  basePanel = ui.AddPanel()\r\n  basePanel.style = customStyle\r\n\r\n  fireLightA = ui.AddCanvas()\r\n  fireLightB = ui.AddCanvas()\r\n  fireLightC = ui.AddCanvas()\r\n  fireLightD = ui.AddCanvas()\r\n  fireLightE = ui.AddCanvas()\r\n  fireLightF = ui.AddCanvas()\r\n\r\n  basePanel.x = 20\r\n  basePanel.y = 10\r\n  basePanel.anchor = top_left\r\n  basePanel.dock = top_left\r\n\r\n  fireLightA.w = 12\r\n  fireLightA.h = 16\r\n  fireLightB.w = 20\r\n  fireLightB.h = 14\r\n  fireLightC.w = 24\r\n  fireLightC.h = 12\r\n  fireLightD.w = 28\r\n  fireLightD.h = 10\r\n  fireLightE.w = 32\r\n  fireLightE.h = 6\r\n\r\n  fireLightA.blend = Add\r\n  fireLightB.blend = Add\r\n  fireLightC.blend = Add\r\n  fireLightD.blend = Add\r\n  fireLightE.blend = Add\r\n\r\n  fireLightA.SetBG(lightColour)\r\n  fireLightB.SetBG(lightColour)\r\n  fireLightC.SetBG(lightColour)\r\n  fireLightD.SetBG(lightColour)\r\n  fireLightE.SetBG(lightColour)\r\n\r\n  fireLightA.SetFG(lightColour2)\r\n  fireLightB.SetFG(lightColour2)\r\n  fireLightC.SetFG(lightColour2)\r\n  fireLightD.SetFG(lightColour2)\r\n  fireLightE.SetFG(lightColour2)\r\n\r\n  basePanel.Add(fireLightA)\r\n  basePanel.Add(fireLightB)\r\n  basePanel.Add(fireLightC)\r\n  basePanel.Add(fireLightD)\r\n  basePanel.Add(fireLightE)\r\n\r\n?totaltime = 1\r\n  SetFire()\r\n:\r\n  basePanel.x = screen.FromWorldX(pos.x + myX - 1)\r\n  basePanel.y = screen.FromWorldZ(pos.z + myZ - 6)\r\n\r\nvar barkColour = #FFFFFF\r\nvar barkCount = 4\r\nvar num\r\n\r\nvar rng_x = 0\r\nvar rng_xmax = 2\r\nvar rng_xmin = -2\r\n\r\nvar rng_z = 0\r\nvar rng_zmax = -1\r\nvar rng_zmin = -2\r\n\r\nvar barks_xpos = []\r\nvar barks_zpos = []\r\n\r\nvar draw_x\r\nvar draw_z\r\n\r\n//extract integer color channels from hex value\r\nvar c_ints = colorToInt(barkColour)\r\nvar c_ints_r = c_ints[0]\r\nvar c_ints_g = c_ints[1]\r\nvar c_ints_b = c_ints[2]\r\n\r\n//modify integer values to get note colors\r\nvar c_ints_age1 = [c_ints_r, c_ints_g, c_ints_b]\r\nvar c_ints_age2 = [math.Clamp(c_ints_r-68,0,512), math.Clamp(c_ints_g-68,0,512), math.Clamp(c_ints_b-68,0,512)]\r\nvar c_ints_age3 = [math.Clamp(c_ints_r-136,0,256), math.Clamp(c_ints_g-136,0,256), math.Clamp(c_ints_b-136,0,256)]\r\n\r\n//generate hex color values from modified color channels\r\nvar color_age1 = intToColor(c_ints_age1)\r\nvar color_age2 = intToColor(c_ints_age2)\r\nvar color_age3 = intToColor(c_ints_age3)\r\n\r\nrng_x = rng_xmin + rng % (rng_xmax - rng_xmin + 1)\r\nrng_z = rng_zmin + rng % (rng_zmax - rng_zmin + 1)\r\n\r\nbarks_xpos.Add((myX + rng_x))\r\nbarks_zpos.Add((myZ + rng_z))\r\n\r\n?barks_xpos.Count() > barkCount\r\n  barks_xpos.RemoveAt(0)\r\n  barks_zpos.RemoveAt(0)\r\n\r\n?rng % foe.distance = 0\r\n  num = barks_xpos.Count()\r\n  ?num > 0\r\n    ?num > barkCount\r\n      num = barkCount\r\n    for i = 0 .. num-1\r\n      draw_x = barks_xpos[i]\r\n      draw_z = barks_zpos[i]\r\n\r\n      ?i = 0\r\n        >o@draw_x@,@draw_z@,@color_age1@,-bark-\r\n      :?i < 3\r\n        >o@draw_x@,@draw_z@,@color_age2@,-bark-\r\n      :?i < barkCount\r\n        >o@draw_x@,@draw_z@,@color_age3@,-bark-\r\n\r\n//color conversion helper functions\r\n\r\n//converts 6-digit color code to integers\r\n//returns a 3-element array containing r,g,b as integers\r\nfunc colorToInt(color)\r\n  ?string.Size(color) < 7\r\n    return [0,0,0]\r\n\r\n  ?color = \"#rainbow\"\r\n    return [1024,1024,1024]\r\n\r\n  var r = hexInt(string.Sub(color, 1, 2))\r\n  var g = hexInt(string.Sub(color, 3, 2))\r\n  var b = hexInt(string.Sub(color, 5, 2))\r\n\r\n  return [r,g,b]\r\n\r\n\r\n//converts 3-element integer array to 6-digit color code\r\n//returns a hex color code in the form #rrggbb\r\nfunc intToColor(ints)\r\n  var t = ints[0]\r\n  ?t > 512\r\n    return \"#rainFF\"\r\n  :?t > 256\r\n    return \"#rain88\"\r\n  :?t > 255\r\n    return \"#rain44\"\r\n\r\n  var r = minLength(intHex(ints[0]), 2, 0)\r\n  var g = minLength(intHex(ints[1]), 2, 0)\r\n  var b = minLength(intHex(ints[2]), 2, 0)\r\n\r\n  return \"#\"+r+g+b\r\n\r\n\r\n//converts 2-digit hex to integer\r\nfunc hexInt(hex)\r\n  var int = 0\r\n  var size = string.Size(hex)\r\n  var digit = string.Sub(hex, 0, 1)\r\n\r\n  var msb = 1\r\n  var lsb = 0\r\n\r\n  ?string.Size(hex) > 1\r\n    int = hexInt(string.Sub(hex, 1, size-1)) + int\r\n\r\n  :?string.Size(hex) = 1\r\n    msb = 0\r\n    lsb = 1\r\n\r\n  ?digit = \"0\"\r\n    int = int + 0 * (16*msb)\r\n  :?digit = \"1\"\r\n    int = int + 1 * (16*msb + lsb)\r\n  :?digit = \"2\"\r\n    int = int + 2 * (16*msb + lsb)\r\n  :?digit = \"3\"\r\n    int = int + 3 * (16*msb + lsb)\r\n  :?digit = \"4\"\r\n    int = int + 4 * (16*msb + lsb)\r\n  :?digit = \"5\"\r\n    int = int + 5 * (16*msb + lsb)\r\n  :?digit = \"6\"\r\n    int = int + 6 * (16*msb + lsb)\r\n  :?digit = \"7\"\r\n    int = int + 7 * (16*msb + lsb)\r\n  :?digit = \"8\"\r\n    int = int + 8 * (16*msb + lsb)\r\n  :?digit = \"9\"\r\n    int = int + 9 * (16*msb + lsb)\r\n  :?digit = \"A\"\r\n    int = int + 10 * (16*msb + lsb)\r\n  :?digit = \"B\"\r\n    int = int + 11 * (16*msb + lsb)\r\n  :?digit = \"C\"\r\n    int = int + 12 * (16*msb + lsb)\r\n  :?digit = \"D\"\r\n    int = int + 13 * (16*msb + lsb)\r\n  :?digit = \"E\"\r\n    int = int + 14 * (16*msb + lsb)\r\n  :?digit = \"F\"\r\n    int = int + 15 * (16*msb + lsb)\r\n  :\r\n    int = int + 0\r\n  return int\r\n\r\n\r\n//function by DarkLucifer69\r\n//backfills a string to a particular length with a specified value\r\nfunc minLength(string, length, append)\r\n ?string.Size(string) < length\r\n  string = append + minLength(string, length-1, append)\r\n\r\n return string\r\n\r\n\r\n//function by DarkLucifer69\r\n//converts integer to hex value\r\nfunc intHex(int)\r\n var hex = \"\"\r\n \r\n ?int >= 16\r\n  hex = intHex(int/16) + hex \r\n  \r\n ?int % 16 <= 9\r\n  hex = hex + (int % 16)\r\n :?int % 16 = 10\r\n  hex = hex + \"A\"\r\n :?int % 16 = 11\r\n  hex = hex + \"B\"\r\n :?int % 16 = 12\r\n  hex = hex + \"C\"\r\n :?int % 16 = 13\r\n  hex = hex + \"D\"\r\n :?int % 16 = 14\r\n  hex = hex + \"E\"\r\n :?int % 16 = 15\r\n  hex = hex + \"F\"\r\n \r\n return hex"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/SnowBunny.txt" - Parse error: Failed to parse completely. Remaining: "= #white\r\n\r\nvar keepDistance = -18\r\nvar maxX = -11\r\n\r\nvar maxDistance\r\nmaxDistance = -70\r\n\r\nvar targetZ = -1\r\n\r\nvar x = 0\r\nvar y = 0\r\nvar myX = 0\r\nvar myZ = 0\r\nvar lastPlayerX = 0\r\nvar lastPlayerZ = 0\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1\r\nvar stateJump = 2\r\nvar currentState = stateNone\r\nvar stateTime = 0\r\n\r\n\r\nfunc SetState(newState)\r\n  ?newState = stateJump\r\n    play scout_wing\r\n\r\n  currentState = newState\r\n  stateTime = 0\r\n\r\n\r\n?currentState = stateNone | time = 1\r\n  lastPlayerX = pos.x\r\n  lastPlayerZ = pos.z\r\n  myX = keepDistance\r\n  myZ = targetZ\r\n\r\n  // Start further away if the bunny is summoned while the location is already running\r\n  ?time > 1\r\n    myX = maxDistance\r\n\r\n  SetState(stateIdle)\r\n\r\n\r\nmyX = myX - (pos.x - lastPlayerX)\r\n\r\nstateTime++\r\n\r\n?currentState = stateIdle\r\n  ?myX < maxDistance | myX > -maxDistance\r\n    myX = maxDistance\r\n  myZ = myZ - (pos.z - lastPlayerZ)\r\n\r\n  ?myX < keepDistance\r\n    SetState(stateJump)\r\n\r\n:?currentState = stateJump\r\n  ?myX < maxX\r\n    myX++\r\n\r\n  ?stateTime >= 6\r\n    ?myZ > targetZ\r\n      myZ--\r\n    :?myZ < targetZ\r\n      myZ++\r\n\r\n  ?stateTime >= 12\r\n    SetState(stateIdle)\r\n\r\n\r\nlastPlayerX = pos.x\r\nlastPlayerZ = pos.z\r\n\r\n// Draw\r\n\r\n?currentState = stateIdle\r\n  >o@myX@,@myZ@,@bunnyColor@,ascii\r\n#\r\n#####(\\(\\\r\n####( n.n)\r\n##o(,`_\"_)\r\nasciiend\r\n  x = myX + 6\r\n  y = myZ + 2\r\n  ?face = \"( ^^\"\r\n    >o@x@,@y@,@bunnyColor@,ascii\r\n^.^\r\nasciiend\r\n\r\n  :?stateTime % 50 >= 44\r\n    >o@x@,@y@,@bunnyColor@,ascii\r\n-.-\r\nasciiend\r\n\r\n?currentState = stateJump\r\n  ?stateTime/2 = 0\r\n    >o@myX@,@myZ@,@bunnyColor@,ascii\r\n#\r\n####(\\(\\\r\n#o__( n.n)\r\n,/ _'| \"|\r\nasciiend\r\n\r\n  :?stateTime/2 = 1\r\n    >o@myX@,@myZ@,@bunnyColor@,ascii\r\n#\r\n####(\\(\\\r\n#o__( n.n)\r\n##\\_'/_\"/\r\nasciiend\r\n\r\n  :?stateTime/2 = 2\r\n    >o@myX@,@myZ@,@bunnyColor@,ascii\r\n#\r\n###/( n.n)\r\n#o,- \\ \" \\\r\n#|_.-  \" \"\r\nasciiend\r\n\r\n  :?stateTime/2 = 3\r\n    >o@myX@,@myZ@,@bunnyColor@,ascii\r\n###/( n.n)\r\n#o,-' \\\" \\\r\n,/_.-'  \" \"\r\n#\r\nasciiend\r\n\r\n  :?stateTime/2 = 4\r\n    >o@myX@,@myZ@,@bunnyColor@,ascii\r\n####\\ \\\\\r\n#o--( n.n)\r\n= __' \\\" \\\r\n########\" \"\r\nasciiend\r\n\r\n  :?stateTime/2 = 5\r\n    >o@myX@,@myZ@,@bunnyColor@,ascii\r\n#\r\n##o_ \\ \\\\\r\n=_,  ( n.n)\r\n###`-' \\\" \\\r\nasciiend\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Stonehead.txt" - Parse error: Failed to parse completely. Remaining: "?(StoneheadPetFrame = 1 | !ai.walking)\r\n ^& !StoneheadRunAway = true & DisableStonehead\r\n ^=false \r\n   StoneheadPet = ascii\r\n#####,\r\n####/-\r\n#o_/##\r\n#|‾###\r\n/#\\###\r\nasciiend\r\n:?StoneheadPetFrame = 2 & !StoneheadRunAway\r\n^ = true & DisableStonehead =false\r\n StoneheadPet = ascii\r\n#####,\r\n####/-\r\n#o_/##\r\n#|‾###\r\n#>\\###\r\nasciiend\r\n:?StoneheadPetFrame = 3 & !StoneheadRunAway \r\n^=true & DisableStonehead =false\r\n StoneheadPet = ascii\r\n#####,\r\n####/-\r\n#o_/##\r\n#|‾###\r\n#|>###\r\nasciiend \r\n:?StoneheadPetFrame = 4 & !StoneheadRunAway\r\n^=true \r\n StoneheadPet = ascii\r\n#####,\r\n####/-\r\n#o_/##\r\n#|‾###\r\n#|\\###\r\nasciiend \r\n?foe = phase & foe.distance < 25 & ai.enabled\r\n ?time % 2 = 0 & StoneheadPetX < 101\r\n \r\n  StoneheadPetX++\r\n  StoneheadRunAway = true\r\n  ?StoneheadPetFrame = 1 & StoneheadRunAway \r\n  ^=true & DisableStonehead =false\r\n   StoneheadPet = ascii\r\n############\r\n#AAAAAHHHHHH\r\n####\\o/#####\r\n#####|######\r\n####/#\\#####\r\nasciiend\r\n :?StoneheadPetFrame = 2 & StoneheadRunAway \r\n  ^=true & DisableStonehead =false\r\n\r\n   StoneheadPet = ascii\r\n############\r\n#AAAAAHHHHHH\r\n####\\o/#####\r\n#####|######\r\n####/<######\r\nasciiend\r\n :?StoneheadPetFrame = 3 & StoneheadRunAway \r\n  ^=true & DisableStonehead =false\r\n\r\n  StoneheadPet = ascii\r\n############\r\n#AAAAAHHHHHH\r\n####\\o/#####\r\n#####|######\r\n####<|######\r\nasciiend\r\n :?StoneheadPetFrame = 4 & StoneheadRunAway \r\n  ^=true & DisableStonehead =false \r\n\r\n   StoneheadPet = ascii\r\n############\r\n#AAAAAHHHHHH\r\n####\\o/#####\r\n#####|######\r\n####/|######\r\nasciiend\r\n?StoneheadPetX > 100\r\n  DisableStonehead = true\r\n\r\n>o-@StoneheadPetX@,@StoneheadPetY@,@StoneheadPet@\r\n//—————END—————//"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/JackOLantern.txt" - Parse error: Failed to parse completely. Remaining: "= #yellow //eyes, mouth\r\nstemColor = #706020 //little stem on top - brown by default\r\n\r\nvar keepDistance = -21 // distance at which the movement animation will play (stateMoving)\r\nvar maxX = -20         // closest offset pet will get to character.  Closer to 0, closer to character\r\nvar maxDistance = -35  // if the pet exceeds this distance, it will teleport to this distance (cannot be further away than this)\r\nvar targetZ = 2       //start the drawing 1 unit above the player\r\n\r\n?loc.loop\r\n  keepDistance = -21\r\n  maxX = -12\r\n  maxDistance = -35\r\n  targetZ = 2\r\n\r\nvar x = 0\r\nvar y = 0\r\nvar myX = 0\r\nvar myZ = 0\r\nvar lastPlayerX = 0\r\nvar lastPlayerZ = 0\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1\r\nvar stateMoving = 2\r\nvar currentState = stateNone\r\nvar stateTime = 0\r\n\r\nfunc SetState(newState)\r\n  ?newState = stateMoving\r\n    play haunted_gate_shuffle //play sound when moving\r\n  \r\n  currentState = newState\r\n  stateTime = 0\r\n\r\n?currentState = stateNone | time = 1\r\n  lastPlayerX = pos.x\r\n  lastPlayerZ = pos.z\r\n  myX = keepDistance\r\n  myZ = targetZ\r\n\r\n// Start further away if pumpkin is summoned while the location is already running\r\n  ?time > 1\r\n    myX = maxDistance\r\n\r\n  SetState(stateIdle)\r\n\r\nmyX = myX - (pos.x - lastPlayerX) // If player has moved, increment myX (distance from player)\r\n\r\nstateTime++\r\n\r\n//set flickering for eyes and mouth based on stateTime\r\n?stateTime % 2 = 0\r\n\tlightColor = #yellow\r\n:\r\n\tlightColor = #white\r\n\r\n?currentState = stateIdle \r\n  ?myX < maxDistance | myX > -maxDistance\r\n    myX = maxDistance\r\n  myZ = myZ - (pos.z - lastPlayerZ)\r\n\r\n  ?myX < keepDistance\r\n    SetState(stateMoving)\r\n\t\r\n:?currentState = stateMoving\r\n  ?myX < maxX\r\n    myX++\r\n\t\r\n  ?stateTime >= 6\r\n    ?myZ > targetZ\r\n      myZ--\r\n    :?myZ < targetZ\r\n      myZ++\r\n\r\n  ?stateTime >= 12\r\n    SetState(stateIdle)\r\n\t\r\nlastPlayerX = pos.x\r\nlastPlayerZ = pos.z\r\n\r\n//draw pumpkin-----------------------------\r\n?currentState = stateIdle \r\n  >o@myX@,@myZ-3@,@#CC9020@,ascii\r\n#,`^ .\r\n({(Δ_Δ}\r\n#``  ´ \r\nasciiend\r\n  >o@myX@,@myZ-3@,@lightColor@,ascii\r\n#\r\n###Δ_Δ\r\n# \r\nasciiend\r\n  >o@myX@,@myZ-3@,@stemColor@,ascii\r\n##`^\r\n#\r\n#\r\nasciiend\r\n\r\n//eye expressions\r\n  ?face = \"°°\"\r\n    >o@myX-1@,@myZ-4@,@lightColor@,ascii\r\n#\r\n#\r\n####ʘ#ʘ\r\nasciiend\r\n\r\n  ?face = \"^^\"\r\n    >o@myX-1@,@myZ-4@,@lightColor@,ascii\r\n#\r\n#\r\n####^O^\r\nasciiend\r\n\r\n//Blink\r\n?currentState = stateIdle\r\n  ?face ! \"^^\"\r\n    ?face ! \"°°\"\r\n      ?stateTime % 50 >= 48\r\n        >o@myX-1@,@myZ-4@,@lightColor@,ascii\r\n#\r\n#\r\n####-#-\r\nasciiend\r\n      :?stateTime % 50 >= 46\r\n        >o@myX-1@,@myZ-4@,@lightColor@,ascii\r\n#\r\n#\r\n####-#-\r\nasciiend\r\n      :?stateTime % 50 >= 44\r\n        >o@myX-1@,@myZ-4@,@lightColor@,ascii\r\n#\r\n#\r\n####-#-\r\nasciiend\r\n\r\n//draw moving----------------------------\r\n?currentState = stateMoving\r\n  ?stateTime/3 = 0\r\n   >o@myX@,@myZ-3@,@#CC9020@,ascii\r\n#,`^ .\r\n({(Δ_Δ}\r\n#``  ´ \r\nasciiend\r\n   >o@myX@,@myZ-3@,@lightColor@,ascii\r\n#\r\n###Δ_Δ\r\n# \r\nasciiend\r\n   >o@myX@,@myZ-3@,@stemColor@,ascii\r\n##`^\r\n#\r\n#\r\nasciiend\r\n\r\n  ?stateTime/3 = 1\r\n   >o@myX@,@myZ-3@,@#CC9020@,ascii\r\n#.,^ .\r\n{({|Δ_'\r\n#``  ´ \r\nasciiend\r\n   >o@myX@,@myZ-3@,@lightColor@,ascii\r\n#\r\n####Δ_\r\n# \r\nasciiend\r\n   >o@myX@,@myZ-3@,@stemColor@,ascii\r\n###^\r\n#\r\n#\r\nasciiend\r\n\r\n  ?stateTime/3 = 2\r\n   >o@myX@,@myZ-3@,@#CC9020@,ascii\r\n#.,^'.\r\n({(|)Δ'\r\n#``  ´ \r\nasciiend\r\n   >o@myX@,@myZ-3@,@lightColor@,ascii\r\n#\r\n#####^\r\n# \r\nasciiend\r\n   >o@myX@,@myZ-3@,@stemColor@,ascii\r\n###^'\r\n#\r\n#\r\nasciiend\r\n\r\n  ?stateTime/3 = 3\r\n   >o@myX@,@myZ-3@,@#CC9020@,ascii\r\n#.,^ .\r\n{({|Δ_'\r\n#``  ´ \r\nasciiend\r\n   >o@myX@,@myZ-3@,@lightColor@,ascii\r\n#\r\n####Δ_\r\n# \r\nasciiend\r\n   >o@myX@,@myZ-3@,@stemColor@,ascii\r\n###^\r\n#\r\n#\r\nasciiend\r\n\r\n  ?stateTime/3 = 4\r\n   >o@myX@,@myZ-3@,@#CC9020@,ascii\r\n#,`^ .\r\n({(Δ_Δ}\r\n#``  ´ \r\nasciiend\r\n   >o@myX@,@myZ-3@,@lightColor@,ascii\r\n#\r\n###Δ_Δ\r\n# \r\nasciiend\r\n   >o@myX@,@myZ-3@,@stemColor@,ascii\r\n##`^\r\n#\r\n#\r\nasciiend\r\n\r\n  ?stateTime/3 = 5\r\n    >o@myX@,@myZ-3@,@#CC9020@,ascii\r\n#.#^ .\r\n{{Δ_Δ}}\r\n#`` ´´ \r\nasciiend\r\n   >o@myX@,@myZ-3@,@lightColor@,ascii\r\n#\r\n##Δ_Δ\r\n# \r\nasciiend\r\n   >o@myX@,@myZ-3@,@stemColor@,ascii\r\n###^\r\n#\r\n#\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Frog.txt" - Parse error: Failed to parse completely. Remaining: "= #white\r\n\r\nvar keepDistance = -17\r\nvar maxX = -11\r\n\r\nvar maxDistance\r\nmaxDistance = -70\r\n\r\nvar targetZ = -1\r\n\r\nvar x = 0\r\nvar y = 0\r\nvar myX = 0\r\nvar myZ = 0\r\nvar lastPlayerX = 0\r\nvar lastPlayerZ = 0\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1\r\nvar stateJump = 2\r\nvar currentState = stateNone\r\nvar stateTime = 0\r\n\r\n\r\nfunc SetState(newState)\r\n  ?newState = stateJump\r\n    play frog\r\n\r\n  currentState = newState\r\n  stateTime = 0\r\n\r\n\r\n?currentState = stateNone | time = 1\r\n  lastPlayerX = pos.x\r\n  lastPlayerZ = pos.z\r\n  myX = keepDistance\r\n  myZ = targetZ\r\n\r\n  // Start further away if the frog is summoned while the location is already running\r\n  ?time > 1\r\n    myX = maxDistance\r\n\r\n  SetState(stateIdle)\r\n\r\n\r\nmyX = myX - (pos.x - lastPlayerX)\r\n\r\nstateTime++\r\n\r\n?currentState = stateIdle\r\n  ?myX < maxDistance | myX > -maxDistance\r\n    myX = maxDistance\r\n  myZ = myZ - (pos.z - lastPlayerZ)\r\n\r\n  ?myX < keepDistance\r\n    SetState(stateJump)\r\n\r\n:?currentState = stateJump\r\n  ?myX < maxX\r\n    myX++\r\n\r\n  ?stateTime >= 6\r\n    ?myZ > targetZ\r\n      myZ--\r\n    :?myZ < targetZ\r\n      myZ++\r\n\r\n  ?stateTime >= 12\r\n    SetState(stateIdle)\r\n\r\n\r\nlastPlayerX = pos.x\r\nlastPlayerZ = pos.z\r\n\r\n// Draw\r\n\r\n?currentState = stateIdle\r\n  >o@myX@,@myZ@,@frogColor@,ascii\r\n#\r\n#\r\n#####,Oo\r\n##(\\/ .-)\r\n##´ ·-\\´\\\r\nasciiend\r\n  x = myX + 5\r\n  y = myZ + 2\r\n  ?face = \"( ^^\"\r\n    >o@x@,@y@,@frogColor@,ascii\r\n,^^\r\n '=\r\nasciiend\r\n\r\n  :?face = \"°°\"\r\n    ?time % 10 = 0 & myX > keepDistance\r\n      myX--\r\n\r\n    ?time % 4 <= 1\r\n      >o@x@,@y@,@frogColor@,ascii\r\n#oO\r\n  *\r\nasciiend\r\n    ?time % 4 > 1\r\n      >o@x@,@y@,@frogColor@,ascii\r\n#Oo\r\n  *\r\nasciiend\r\n\r\n  :?stateTime % 50 >= 48\r\n    >o@x@,@y@,@frogColor@,ascii\r\n,O-\r\nasciiend\r\n  :?stateTime % 50 >= 46\r\n    >o@x@,@y@,@frogColor@,ascii\r\n,=-\r\nasciiend\r\n  :?stateTime % 50 >= 44\r\n    >o@x@,@y@,@frogColor@,ascii\r\n,--\r\nasciiend\r\n\r\n?currentState = stateJump\r\n  ?stateTime/2 = 0\r\n    >o@myX@,@myZ@,@frogColor@,ascii\r\n#\r\n#\r\n#####,--\r\n###(! .-)\r\n###'·-((\r\nasciiend\r\n\r\n  :?stateTime/2 = 1\r\n    >o@myX@,@myZ@,@frogColor@,ascii\r\n#\r\n#####,--\r\n####/ .-)\r\n##_(;-//\r\n###`\r\nasciiend\r\n\r\n  :?stateTime/2 = 2\r\n    >o@myX@,@myZ@,@frogColor@,ascii\r\n#####.=-\r\n####/ .-)\r\n##_(/-)´`\r\n#-´‾\r\nasciiend\r\n\r\n  :?stateTime/2 = 3\r\n    >o@myX@,@myZ@,@frogColor@,ascii\r\n#####.O-\r\n###,´ .-)\r\n#_(/--‾´‾\r\n-´‾\r\nasciiend\r\n\r\n  :?stateTime/2 = 4\r\n    >o@myX@,@myZ@,@frogColor@,ascii\r\n#\r\n#####.Oo\r\n-´-`´ .-)\r\n####`-‾´‾\r\nasciiend\r\n\r\n  :?stateTime/2 = 5\r\n    >o@myX@,@myZ@,@frogColor@,ascii\r\n#\r\n#\r\n##_##.Oo\r\n#/-`´ .-)\r\n###`--\\´\\\r\nasciiend\r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Crab.txt" - Parse error: Failed to parse completely. Remaining: "= #FF4444\r\nshellColor = #FFFF99\r\n\r\nvar keepDistance = -20 // distance at which the movement animation will play (stateScuttle)\r\nvar maxX = -15         // closest offset pet will get to character.  Closer to 0, closer to character\r\nvar maxDistance = -100 // if the pet exceeds this distance, it will teleport to this distance (cannot be further away than this)\r\nvar targetZ = -1       // We want to start the drawing 1 unit above the player agent\r\nvar headcrab = 0       //if the crab gets in front of the player, he will jump on his head\r\nvar mandibles = 0      //if in headcrab mode, allows idle animation without spam during continuous scuttle\r\n\r\n?loc.loop\r\n  keepDistance = -20\r\n  maxX = -15\r\n  maxDistance = -100\r\n  targetZ = -1\r\n  headcrab = 0\r\n  mandibles = 0\r\n\r\nvar x = 0\r\nvar y = 0\r\nvar myX = 0\r\nvar myZ = 0\r\nvar lastPlayerX = 0\r\nvar lastPlayerZ = 0\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1\r\nvar stateScuttle = 2\r\nvar currentState = stateNone\r\nvar stateTime = 0\r\n\r\nfunc SetState(newState)\r\n  ?newState = stateScuttle & headcrab = 0\r\n    play ant_walk // sound played when pet moves\r\n  currentState = newState\r\n  stateTime = 0\r\n  ?mandibles >= 5\r\n    mandibles = 0\r\n\r\n?currentState = stateNone | time = 1\r\n  lastPlayerX = pos.x\r\n  lastPlayerZ = pos.z\r\n  myX = keepDistance\r\n  myZ = targetZ\r\n\r\n  // Start further away if the crab is summoned while the location is already running\r\n  ?time > 1\r\n    myX = maxDistance\r\n\r\n  SetState(stateIdle)\r\n\r\nmyX = myX - (pos.x - lastPlayerX) // If player has moved, increment myX (distance from player)\r\n\r\nstateTime++\r\n\r\n?myX >= -8 & headcrab = 0\r\n  headcrab = 1\r\n  targetZ = -4\r\n  maxX = -5\r\n  keepDistance = -4\r\n?headcrab = 1\r\n  ?myX ! -5\r\n    myX = -5\r\n  \r\n\r\n?currentState = stateIdle\r\n  ?myX < maxDistance | myX > -maxDistance\r\n    myX = maxDistance\r\n  ?headcrab = 0\r\n    myZ = myZ - (pos.z - lastPlayerZ)\r\n\r\n  ?myX < keepDistance\r\n    SetState(stateScuttle)\r\n\r\n:?currentState = stateScuttle\r\n  ?headcrab\r\n    myX = maxX\r\n  :?myX < maxX\r\n    myX++\r\n\r\n  ?stateTime >= 6\r\n    ?myZ > targetZ\r\n      myZ--\r\n    :?myZ < targetZ\r\n      myZ++\r\n\r\n  ?stateTime >= 12\r\n    ?headcrab = 1\r\n      mandibles++\r\n    SetState(stateIdle)\r\n\r\nlastPlayerX = pos.x\r\nlastPlayerZ = pos.z\r\n\r\n// Draw\r\n?currentState = stateIdle\r\n  >o@myX@,@myZ@,@crabColor@,ascii\r\n#\r\n#\r\n#\r\n####{Oo}\r\n##//(;;)\\\r\nasciiend\r\n  >o@myX@,@myZ@,@shellColor@,ascii\r\n###__\r\n##(__)_\r\n#(_____)_\r\n#(__####_)\r\nasciiend\r\n  x = myX + 2\r\n  y = myZ + 3\r\n  ?face = \"( ^^\"\r\n    >o@x@,@y@,@crabColor@,ascii\r\n###^^\r\nasciiend\r\n  :?face = \"( TT\"\r\n    >o@x@,@y@,@crabColor@,ascii\r\n###><\r\nasciiend\r\n  :?face = \"°°\"\r\n    ?time % 10 = 0 & myX > keepDistance\r\n      myX--\r\n    ?time % 4 <= 1\r\n      >o@x@,@y@,@crabColor@,ascii\r\n##[oO]\r\n<<{::}>\r\nasciiend\r\n    ?time % 4 > 1\r\n      >o@x@,@y@,@crabColor@,ascii\r\n##{Oo}\r\n//(;;)\\\r\nasciiend\r\n  :?stateTime % 50 >= 48\r\n    >o@x@,@y@,@crabColor@,ascii\r\n###O-\r\n##{::}\r\nasciiend\r\n  :?stateTime % 50 >= 46\r\n    >o@x@,@y@,@crabColor@,ascii\r\n###=-\r\n##(\"\")\r\nasciiend\r\n  :?stateTime % 50 >= 44\r\n    >o@x@,@y@,@crabColor@,ascii\r\n###--\r\n##{::}\r\nasciiend\r\n\r\n?currentState = stateScuttle\r\n  ?stateTime/3 = 0\r\n    >o@myX@,@myZ@,@crabColor@,ascii\r\n#\r\n#\r\n#\r\n####{Oo}\r\n##>/(;;)|\r\nasciiend\r\n    >o@myX@,@myZ@,@shellColor@,ascii\r\n###__\r\n##(__)__\r\n##(_____)\r\n#(__####_)\r\nasciiend\r\n\r\n  :?stateTime/3 = 1\r\n    >o@myX@,@myZ@,@crabColor@,ascii\r\n#\r\n#\r\n#\r\n####{Oo}\r\n##\\>(;;)/\r\nasciiend\r\n    >o@myX@,@myZ@,@shellColor@,ascii\r\n####__\r\n###(__)_\r\n##(_____)\r\n#(__####_)\r\nasciiend\r\n\r\n  :?stateTime/3 = 2\r\n    >o@myX@,@myZ@,@crabColor@,ascii\r\n#\r\n#\r\n#\r\n####{Oo}\r\n##|\\(;;)>\r\nasciiend\r\n    >o@myX@,@myZ@,@shellColor@,ascii\r\n####__\r\n##_(__)\r\n#(_____)_\r\n#(__####_)\r\nasciiend\r\n\r\n  :?stateTime/3 = 3\r\n    >o@myX@,@myZ@,@crabColor@,ascii\r\n#\r\n#\r\n#\r\n####{Oo}\r\n##/|(;;)\\\r\nasciiend\r\n    >o@myX@,@myZ@,@shellColor@,ascii\r\n###__\r\n##(__)_\r\n#(_____)_\r\n#(__####_)\r\nasciiend\r\n  x = myX + 2\r\n  y = myZ + 3\r\n  ?face = \"( ^^\"\r\n    >o@x@,@y@,@crabColor@,ascii\r\n###^^\r\nasciiend\r\n  :?face = \"°°\"\r\n    ?time % 10 = 0 & myX > keepDistance\r\n      myX--\r\n    ?time % 4 <= 1\r\n      >o@x@,@y@,@crabColor@,ascii\r\n##[oO]\r\n<<{::}>\r\nasciiend\r\n    ?time % 4 > 1\r\n      >o@x@,@y@,@crabColor@,ascii\r\n##{Oo}\r\n//(;;)\\\r\nasciiend\r\n  :?mandibles >= 4 & stateTime % 50 >= 10\r\n    >o@x@,@y@,@crabColor@,ascii\r\n###O-\r\n##{::}\r\nasciiend\r\n  :?mandibles >= 4 & stateTime % 50 >= 8\r\n    >o@x@,@y@,@crabColor@,ascii\r\n###=-\r\n##(\"\")\r\nasciiend\r\n  :?mandibles >= 4 & stateTime % 50 >= 6\r\n    >o@x@,@y@,@crabColor@,ascii\r\n###--\r\n##{::}\r\nasciiend\r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Chisel.txt" - Parse error: Failed to parse completely. Remaining: "= \"Chisel\"\r\nvar VERSION = \"v1.2\"\r\nvar AUTHOR = \"fruloo +\\nSven & Toast\"\r\n\r\n\r\n// Instructions\r\n// import UI/Chisel\r\n\r\n// Usage\r\n// 1) Enter Deadwood Waterfall.\r\n// 2) Select the desired glyph from the right panel.\r\n// 3) Use mouse or touchscreen to draw on the center panel.\r\n\r\nvar LOGO = ascii\r\n,╦◘\r\n♦║▼\r\n║║║\r\nasciiend\r\n\r\n// UI Factory\r\n\r\nfunc MakePanel(parent, x, y, w, h, color, style)\r\n  var panel = ui.AddPanel()\r\n  panel.x = x\r\n  panel.y = y\r\n  panel.w = w\r\n  panel.h = h \r\n  panel.anchor = top_left\r\n  panel.dock = top_left\r\n  ?color ! null\r\n    panel.color = color\r\n  ?style ! null\r\n    panel.style = style\r\n  ?parent ! null\r\n    parent.Add(panel)\r\n  return panel\r\n\r\nfunc MakeButton(x, y, w, h, text, style, onPressedFn)\r\n  var btn = ui.AddButton()\r\n  btn.x = x\r\n  btn.y = y\r\n  btn.w = w\r\n  btn.h = h\r\n  btn.anchor = top_left\r\n  btn.dock = top_left\r\n  ?text ! null\r\n    btn.text = text\r\n  :\r\n    btn.text = \"\"\r\n  ?style ! null\r\n    btn.style = style\r\n  ?onPressedFn ! null\r\n    btn.SetPressed(onPressedFn)\r\n  btn.visible = inherit\r\n  return btn\r\n\r\nfunc MakeSprite(x, y, w, h, color, spriteStr)\r\n  var sprite = ui.AddAnim(spriteStr)\r\n  sprite.x = x\r\n  sprite.y = y\r\n  sprite.w = w\r\n  sprite.h = h\r\n  sprite.anchor = top_left\r\n  sprite.dock = top_left\r\n  sprite.color = color\r\n  sprite.visible = inherit\r\n  return sprite\r\n\r\nfunc MakeText(x, y, w, h, align, content)\r\n  var text = ui.AddText()\r\n  text.x = x\r\n  text.y = y\r\n  text.w = w\r\n  text.h = h\r\n  text.anchor = top_left\r\n  text.dock = top_left\r\n  ?align ! null\r\n    text.align = align\r\n  ?content ! null\r\n    text.text = content\r\n  return text\r\n\r\n// Assets\r\n\r\nvar StyleInvisible = ui.AddStyle(\"\r\n^###\r\n^###\r\n^###\")\r\n\r\nvar StyleBrackets = ui.AddStyle(\"\r\n^###\r\n^[#]\r\n^###\")\r\n\r\nvar AsciiPalette = ascii\r\n⚿§†☤❄☼☆♂♀°☺ʘ◙◘⏹\r\n❤♦♣♠♪♫ ↑→↓←▲▶▼◀\r\n@$%&€£￥₩!¡?¿:;*\r\n,….·•'＂´`¯-_┊|\r\n≡=≠≈~÷+±≤≥<>«»^\r\n/\\[]{}()░▒▓█▄▀\r\nABCDEFGHIJKLM\r\nNOPQRSTUVWXYZ\r\nabcdefghijklm\r\nnopqrstuvwxyz \r\n0123456789\r\nãäâáàåÄÅÁÀëêéèÉ\r\nïîíìõöôóòÖñüûúù\r\nÜýçÇÑ Ææœ∞\r\nαβγ∆δεέζηΘιλ\r\nμξπρΣστΦφψΩω\r\n┌┬┐╔╦╗╒╤╕╓╥╖⌐ ¬ \r\n├┼┤╠╬╣╞╪╡╟╫╢║ │ \r\n└┴┘╚╩╝╘╧╛╙╨╜═ ─\r\nasciiend\r\n\r\n// Main\r\n\r\nvar initialized = false\r\n\r\nvar basePanel = null\r\n\r\nvar canvasPanel = null\r\nvar canvasPanelTitle = null\r\nvar canvasButton = null\r\nvar canvas = null\r\n\r\nvar palettePanel = null\r\nvar palettePanelTitle = null\r\nvar palleteTable = null\r\nvar palleteButton = null\r\n\r\nvar toolsPanel = null\r\nvar toolsPanelTitle = null\r\nvar toolsGlyphPanelL = null\r\nvar toolsGlyphGlyphL = null\r\nvar toolsGlyphPanelR = null\r\nvar toolsGlyphGlyphR = null\r\nvar toolsSwapGlyphLR = null\r\nvar toolSwap = null\r\n\r\nvar toolBrushSizeLabel = null\r\nvar toolBrushSizeInc = null\r\nvar toolBrushSizeDec = null\r\nvar toolBrushSizeValue = null\r\n\r\nvar toolBrushStyleLabel = null\r\nvar toolBrushStyleRect = null\r\nvar toolBrushStyleCircle = null\r\nvar toolBrushStyleDiamond = null\r\n\r\nvar toolSelectLeft\r\nvar toolSelectRight\r\nvar toolLoad\r\nvar toolSave\r\nvar toolUndo\r\nvar toolRedo\r\nvar toolClear = null\r\nvar toolClose = null\r\n\r\nvar dividerText = null\r\nvar titleText = null\r\nvar authorText = null\r\nvar logoSprite = null\r\n\r\nvar BrushType_Rect = \"BrushType:Rect\"\r\nvar BrushType_Circle = \"BrushType:Circle\"\r\nvar BrushType_Diamond = \"BrushType:Diamond\"\r\n\r\nvar brushSizeMax = 20\r\nvar brushSize = 1\r\nvar brushStyle = BrushType_Rect\r\n\r\nvar isDrawingL = false\r\nvar lastDrawTimeL = null\r\nvar currentGlyphL = \"o\"\r\nvar isDrawingR = false\r\nvar lastDrawTimeR = null\r\nvar currentGlyphR = \" \"\r\n\r\nvar CanvasBlankTextLine = \"                                                                           \"\r\nvar String\r\nvar Width =  screen.w - 38\r\nvar Load\r\nvar TextLayers = []\r\nvar CornerToolPanel\r\nvar SelectedTool = 0\r\nvar toolSelectText\r\n\r\nvar toolCopyButton\r\nvar toolCutButton\r\nvar toolPasteButton\r\nvar toolSelectButton\r\nvar toolSelectCanvas\r\nvar toolSelectMotherPanel\r\nvar tool_AddLayer_Button\r\nvar tool_Layer_Buttons = []\r\nvar Selected_Layer = 0\r\nvar toolsTransparent\r\nvar isPC = sys.isPC\r\n\r\n\r\nfunc Init()\r\n  disable hud\r\n  disable banner\r\n  disable pause  \r\n  disable abilities\r\n  disable loadout input\r\n  ambient.Stop()\r\n\r\n  basePanel = MakePanel(null, 0, 0, screen.w, screen.h, null, StyleInvisible)\r\n\r\n  // Canvas\r\n  canvasPanel = MakePanel(basePanel, 18, 0, basePanel.w - 36, basePanel.h, null, null)\r\n  canvasPanel.color = \"#565656\"\r\n  canvasPanelTitle = MakeText(2, 0, 12, 1, \"left\", \"Canvas \" + canvasPanel.w + \"x\" + canvasPanel.h)\r\n  canvasPanelTitle.color = \"#565656\"\r\n  canvasPanel.Add(canvasPanelTitle)\r\n\r\n  canvasButton = MakeButton(1, 1, canvasPanel.w - 2, canvasPanel.h - 2, null, StyleInvisible, null)\r\n  canvasButton.SetDown(StartDrawingL)\r\n  canvasButton.SetUp(EndDrawingL)\r\n  canvasButton.hcolor = \"#000000\"\r\n  canvasButton.sound = null\r\n  canvasPanel.Add(canvasButton)\r\n  canvas = ui.AddCanvas()\r\n  canvas.x = 1\r\n  canvas.y = 1\r\n  canvas.w = canvasPanel.w - 2\r\n  canvas.h = canvasPanel.h - 2\r\n  canvas.dock = top_left\r\n  canvas.anchor = top_left\r\n  canvas.SetFG(\"#ffffff\")\r\n  canvas.SetBG(\"#000000\")\r\n  canvasPanel.Add(canvas)\r\n\r\n  ?initialized\r\n    RecreateLayers()\r\n  :\r\n    NewLayer()\r\n\r\n\r\n  // Palette\r\n  palettePanel = MakePanel(basePanel, 0, 0, 18, basePanel.h, null, null)\r\n  palettePanel.color = \"#565656\"\r\n  palettePanelTitle = MakeText(5, 1, 12, 1, \"left\", \"Palette\")\r\n  palettePanelTitle.color = \"#565656\"\r\n  palettePanel.Add(palettePanelTitle)\r\n\r\n  palleteButton = MakeButton(1, 3, 16, 19, null, StyleInvisible, CheckPaletteSelectL)\r\n  palleteButton.hcolor = \"#000000\"\r\n  palettePanel.Add(palleteButton)\r\n  palleteTable = MakeSprite(1, 3, 16, 19, \"#ffffff\", AsciiPalette)\r\n  toolsTransparent = MakeButton(4, 22, 8, 3, \"Eraser\", null, SetEraser)\r\n  palettePanel.Add(toolsTransparent)\r\n  palettePanel.Add(palleteTable)\r\n\r\n\r\n  //CornerToolPanel = MakePanel(basePanel, 0, 20, 18, basePanel.h-20, \"#565656\", null)\r\n  toolSelectLeft = MakeButton(1, 0, 3, 3, \"◀\", StyleBrackets, ToolSelectLeft)\r\n  toolSelectRight = MakeButton(14,0, 3, 3, \"▶\", StyleBrackets, ToolSelectRight)\r\n  //toolSelectText = MakeText(2, 21, 16, 1, \"center\", \"Drawing\")\r\n  //CornerToolPanel.Add(toolSelectLeft)\r\n  //CornerToolPanel.Add(toolSelectRight)\r\n  CreateToolMasterPanel()\r\n\r\n  //func MakePanel(parent, x, y, w, h, color, style)\r\n\r\n  // Tools\r\n  toolsPanel = MakePanel(basePanel, basePanel.w - 18, 0, 18, basePanel.h, null, null)\r\n  toolsPanel.color = \"#565656\"\r\n  toolsPanelTitle = MakeText(2, 0, 12, 1, \"left\", \"Tools\")\r\n  toolsPanelTitle.color = \"#565656\"\r\n  toolsPanel.Add(toolsPanelTitle)\r\n  dividerText = MakeText(1, basePanel.h - 5, 16, 1, \"center\", \"────────────────\")\r\n  dividerText.color = \"#565656\"\r\n  toolsPanel.Add(dividerText)\r\n\r\n  toolsGlyphPanelL = MakePanel(toolsPanel, 1, 1, 5, 3, #888888, null)\r\n  toolsGlyphGlyphL = MakeText(0, 1, 5, 1, \"center\", currentGlyphL)\r\n  toolsGlyphPanelL.Add(toolsGlyphGlyphL)\r\n\r\n  toolsGlyphPanelR = MakePanel(toolsPanel, 6, 1, 5, 3, #888888, null)\r\n  toolsGlyphGlyphR = MakeText(0, 1, 5, 1, \"center\", currentGlyphR)\r\n  toolsGlyphPanelR.Add(toolsGlyphGlyphR)\r\n\r\n  toolSwap = MakeButton(11, 1, 6, 3, \"Swap\", null, SwapLR)\r\n  toolsPanel.Add(toolSwap)\r\n  toolUndo = MakeButton(1, 9, 8, 3, \"Undo\", null, Undo)\r\n  toolUndo.bcolor = #202020\r\n  toolsPanel.Add(toolUndo)\r\n  toolRedo = MakeButton(9, 9, 8, 3, \"Redo\", null, Redo)\r\n  toolRedo.bcolor = #202020\r\n  toolsPanel.Add(toolRedo)\r\n  toolSave = MakeButton(1, 12, 8, 3, \"Save\", null, OpenSaveScreen)\r\n  toolsPanel.Add(toolSave)\r\n  toolLoad = MakeButton(9, 12, 8, 3, \"Load\", null, OpenLoadScreen)\r\n  toolsPanel.Add(toolLoad)\r\n  toolClear = MakeButton(1, 15, 16, 3, \"Clear Canvas\", null, ClearCanvas)\r\n  toolsPanel.Add(toolClear)\r\n  toolClose = MakeButton(1, 18, 16, 3, \"Close Chisel\", null, CloseChisel)\r\n  toolsPanel.Add(toolClose)\r\n\r\n  toolBrushSizeLabel = MakeText(1, 5, 6, 1, \"left\", \"Size\")\r\n  toolsPanel.Add(toolBrushSizeLabel)\r\n  toolBrushSizeDec = MakeButton(7, 4, 3, 3, \"-\", StyleBrackets, DecBrushSize)\r\n  toolsPanel.Add(toolBrushSizeDec)\r\n  toolBrushSizeInc = MakeButton(14, 4, 3, 3, \"+\", StyleBrackets, IncBrushSize)\r\n  toolsPanel.Add(toolBrushSizeInc)\r\n  toolBrushSizeValue = MakeText(10, 5, 3, 1, \"right\", \"\" + brushSize)\r\n  toolsPanel.Add(toolBrushSizeValue)\r\n\r\n  toolBrushStyleLabel = MakeText(1, 7, 6, 1, \"left\", \"Style\")\r\n  toolsPanel.Add(toolBrushStyleLabel)\r\n  toolBrushStyleRect = MakeButton(7, 6, 3, 3, \"▒\", StyleBrackets, PickBrushTypeRect)\r\n  toolsPanel.Add(toolBrushStyleRect)\r\n  toolBrushStyleCircle = MakeButton(10, 6, 3, 3, \"0\", StyleInvisible, PickBrushTypeCircle)\r\n  toolsPanel.Add(toolBrushStyleCircle)\r\n  toolBrushStyleDiamond = MakeButton(13, 6, 3, 3, \"♦\", StyleInvisible, PickBrushTypeDiamond)\r\n  toolsPanel.Add(toolBrushStyleDiamond)\r\n\r\n  // About\r\n  titleText = MakeText(1, basePanel.h - 4, 16, 1, \"left\", TITLE + \" \" + VERSION)\r\n  toolsPanel.Add(titleText)\r\n  authorText = MakeText(1, basePanel.h - 3, 16, 1, \"left\", \"By \" + AUTHOR)\r\n  toolsPanel.Add(authorText)\r\n  logoSprite = MakeSprite(14, basePanel.h - 4, 4, 3, \"#ffffff\", LOGO)\r\n  toolsPanel.Add(logoSprite)\r\n\r\n  // Enable right mouse drawing on PC\r\n  ?isPC \r\n    key.Bind(\"Left\", \"A\", \"Mouse1\")\r\n\r\n  initialized = true\r\n  SelectedTool = 0\r\n\r\n// Util\r\n\r\nfunc PointInRect(px, py, rx, ry, rw, rh)\r\n  return px >= rx    &     px < (rx + rw)    &    py >= ry    &    py < (ry + rh)\r\n\r\nvar UndoList = []\r\nvar MaxUndos = 100\r\nfunc AddUndoList()\r\n  var SaveList = []\r\n  for a : TextLayers\r\n    SaveList.Add(string.Join(\"\",a.TextList))\r\n  UndoList.Add([SaveList,SaveRecover,AddRedoList])\r\n  ?MaxUndos+1 < UndoList.Count()\r\n    UndoList.RemoveAt(0)\r\n  UpdateRedoButtonColour()\r\n  UpdateUndoButtonColour()\r\n\r\nvar RedoList = []\r\nfunc AddRedoList()\r\n  var SaveList = []\r\n  for a : TextLayers\r\n    SaveList.Add(string.Join(\"\",a.TextList))\r\n  RedoList.Add([SaveList,SaveRecover,AddUndoList])\r\n  UpdateRedoButtonColour()\r\n  UpdateUndoButtonColour()\r\n\r\n// Palette\r\n\r\nfunc CheckPaletteSelectL()\r\n  var dx = input.x - palleteTable.absoluteX\r\n  var dy = input.y - palleteTable.absoluteY\r\n\r\n  ?PointInRect(dx, dy, 0, 0, palleteTable.w, palleteTable.h)\r\n    currentGlyphL = draw.GetSymbol(input.x, input.y)\r\n    toolsGlyphGlyphL.text = currentGlyphL\r\n\r\nfunc CheckPaletteSelectR()\r\n  var dx = input.x - palleteTable.absoluteX\r\n  var dy = input.y - palleteTable.absoluteY\r\n\r\n  ?PointInRect(dx, dy, 0, 0, palleteTable.w, palleteTable.h)\r\n    currentGlyphR = draw.GetSymbol(input.x, input.y)\r\n    toolsGlyphGlyphR.text = currentGlyphR\r\n\r\n// Canvas\r\n\r\nfunc CanvasSaveText(Layer)\r\n  String = \"\"\r\n  for a : TextLayers[Layer].TextList\r\n    String += a\r\n  return String\r\n\r\nfunc CanvasLineAdder(Layer)\r\n  String = \"\"\r\n  for a : TextLayers[Layer].TextList\r\n    String += a+\"\\n\"\r\n  return String\r\n\r\nfunc CanvasSingleEmplace(BaseString, x, glyph)\r\n  var StartofLine = string.Sub(BaseString,0,x)\r\n  var EndofLine = string.Sub(BaseString,x+1)\r\n  return StartofLine + glyph + EndofLine\r\n\r\nfunc CanvasLineEmplace(BaseString, x, w, glyphs)\r\n  var StartW = math.Max(x-w/2,0)\r\n  var EndW = math.Min(x+1+w/2,Width)\r\n  var CropW = math.Min(w/2+1+x-StartW,w/2-x+EndW)\r\n\r\n  var StartofLine = string.Sub(BaseString,0,StartW)\r\n  var EndofLine = string.Sub(BaseString,EndW)\r\n  var Middle = string.Sub(glyphs,0,CropW)\r\n  return StartofLine + Middle + EndofLine\r\n\r\nfunc PasteLineEmplace(BaseString, x, w, glyphs)\r\n  ?w%2\r\n    var CropStart = x-w/2\r\n    var StartW = math.Max(CropStart,0)\r\n    var EndW = math.Min(x+1+w/2,Width)\r\n  :\r\n    var CropStart = x-w/2+1\r\n    var StartW = math.Max(CropStart,0)\r\n    var EndW = math.Min(x+1+w/2,Width)\r\n  var CropW = math.Min(w/2+1+x-StartW,w/2-x+EndW)\r\n\r\n  var StartofLine = string.Sub(BaseString,0,StartW)\r\n  var EndofLine = string.Sub(BaseString,EndW)\r\n  ?CropStart < StartW\r\n    var Middle = string.Sub(glyphs,-(x-w/2+1),CropW)\r\n  :?EndW < x+1+w/2 & w%2=0\r\n    var Middle = string.Sub(glyphs,0,CropW-1)\r\n  :\r\n    var Middle = string.Sub(glyphs,0,CropW)\r\n  return StartofLine + Middle + EndofLine\r\n\r\nfunc CanvasDrawGlyph(x, y, glyph)\r\n  ?PointInRect(x, y, 0, 0, canvas.w, canvas.h)\r\n    TextLayers[Selected_Layer].TextList[y] = CanvasSingleEmplace(TextLayers[Selected_Layer].TextList[y], x, glyph)\r\n\r\nfunc CanvasDrawRect(dx, dy, r, glyph)\r\n  var MinRange = math.Max(dy+1-r,0)\r\n  var MaxRange = math.Min(dy+r-1,ScreenH-3)\r\n  var MaxGlyphs = \"\"\r\n  for a = 1..2*r-1\r\n    MaxGlyphs += glyph\r\n  for i = MinRange..MaxRange\r\n    TextLayers[Selected_Layer].TextList[i] = CanvasLineEmplace(TextLayers[Selected_Layer].TextList[i], dx, 2*r-1, MaxGlyphs)\r\n\r\nfunc CanvasDrawCircle(dx, dy, r, glyph)\r\n  var temp\r\n  var MinRange = math.Max(dy+1-r,0)\r\n  var MaxRange = math.Min(dy+r-1,ScreenH-3)\r\n  var MaxGlyphs = \"\"\r\n  for a = 1..2*r-1 + 20\r\n    MaxGlyphs += glyph\r\n  for i = MinRange..MaxRange\r\n    temp = math.RoundToInt(math.Sqrt(  r*r - math.Pow(((i-dy)*(1.1+r/20.0)),2) )*2)\r\n    ?temp > 0\r\n      TextLayers[Selected_Layer].TextList[i] = CanvasLineEmplace(TextLayers[Selected_Layer].TextList[i], dx, temp, MaxGlyphs)\r\n\r\nfunc CanvasDrawDiamond(dx, dy, r, glyph)\r\n  var MinRange = math.Max(dy+1-r,0)\r\n  var MaxRange = math.Min(dy+r-1,ScreenH-3)\r\n  var MaxGlyphs = \"\"\r\n  for a = 1..2*r-1\r\n    MaxGlyphs += glyph\r\n  for i = MinRange..MaxRange\r\n    TextLayers[Selected_Layer].TextList[i] = CanvasLineEmplace(TextLayers[Selected_Layer].TextList[i], dx, 2*r-1-math.Abs(2*(i-dy)), MaxGlyphs)\r\n\r\nvar toolSelectOrigin = []\r\nvar toolSelectIsSelecting = false\r\nfunc StartDrawingL()\r\n  var dx = input.x - canvas.absoluteX\r\n  var dy = input.y - canvas.absoluteY\r\n  ?PointInRect(dx, dy, 0, 0, canvas.w, canvas.h)\r\n    ?SelectedTool = 0\r\n      isDrawingL = true\r\n      AddUndoList()\r\n      RedoList.Clear()\r\n    :?PasteToggle\r\n      PasteSelection(dx,dy)\r\n    :?SelectionToggle\r\n      OpenCutCopyButtons()\r\n      ?toolSelectOrigin.Count()>0\r\n        toolSelectCanvas.Recycle()\r\n      toolSelectIsSelecting = true\r\n      toolSelectCanvas = ui.AddCanvas()\r\n      toolSelectCanvas.anchor = top_left\r\n      toolSelectCanvas.dock = top_left\r\n      toolSelectOrigin = [dx+1,dy+1]\r\n      toolSelectCanvas.blend = \"Add\"\r\n      toolSelectCanvas.w = 1\r\n      toolSelectCanvas.h = 1\r\n      toolSelectCanvas.x = dx\r\n      toolSelectCanvas.y = dy\r\n      toolSelectCanvas.visible = false\r\n      toolSelectCanvas.SetBG(\"#101010\")\r\n      canvasPanel.Add(toolSelectCanvas)\r\n\r\nfunc EndDrawingL()\r\n  toolSelectIsSelecting = false\r\n  isDrawingL = false\r\n\r\nfunc CanvasDrawL()\r\n  var dx = input.x - canvas.absoluteX\r\n  var dy = input.y - canvas.absoluteY\r\n\r\n  ?PointInRect(dx, dy, 0, 0, canvas.w, canvas.h)\r\n    ?brushSize = 1\r\n      CanvasDrawGlyph(dx, dy, currentGlyphL)\r\n    :?brushStyle = BrushType_Rect\r\n      CanvasDrawRect(dx, dy, brushSize, currentGlyphL)\r\n    :?brushStyle = BrushType_Circle\r\n      CanvasDrawCircle(dx, dy, brushSize, currentGlyphL)\r\n    :?brushStyle = BrushType_Diamond\r\n      CanvasDrawDiamond(dx, dy, brushSize, currentGlyphL)\r\n    TextLayers[Selected_Layer].TextUI.text= CanvasLineAdder(Selected_Layer)\r\n  lastDrawTimeL = time.msbn\r\n\r\nfunc StartDrawingR()\r\n  var dx = input.x - canvas.absoluteX\r\n  var dy = input.y - canvas.absoluteY\r\n  ?PointInRect(dx, dy, 0, 0, canvas.w, canvas.h)\r\n    isDrawingR = true\r\n    AddUndoList()\r\n    RedoList.Clear()\r\n\r\nfunc EndDrawingR()\r\n  isDrawingR = false\r\n\r\nfunc CanvasDrawR()\r\n  var dx = input.x - canvas.absoluteX\r\n  var dy = input.y - canvas.absoluteY\r\n\r\n  ?PointInRect(dx, dy, 0, 0, canvas.w, canvas.h)\r\n    ?brushSize = 1\r\n      CanvasDrawGlyph(dx, dy, currentGlyphR)\r\n    :?brushStyle = BrushType_Rect\r\n      CanvasDrawRect(dx, dy, brushSize, currentGlyphR)\r\n    :?brushStyle = BrushType_Circle\r\n      CanvasDrawCircle(dx, dy, brushSize, currentGlyphR)\r\n    :?brushStyle = BrushType_Diamond\r\n      CanvasDrawDiamond(dx, dy, brushSize, currentGlyphR)\r\n    TextLayers[Selected_Layer].TextUI.text= CanvasLineAdder(Selected_Layer)\r\n  lastDrawTimeR = time.msbn\r\n\r\n// Tools\r\n\r\nfunc SwapLR()\r\n  var temp = currentGlyphL\r\n  currentGlyphL = currentGlyphR\r\n  currentGlyphR = temp\r\n  toolsGlyphGlyphL.text = currentGlyphL\r\n  toolsGlyphGlyphR.text = currentGlyphR\r\n\r\nfunc PickBrushTypeRect()\r\n  brushStyle = BrushType_Rect\r\n  toolBrushStyleRect.style = StyleBrackets\r\n  toolBrushStyleCircle.style = StyleInvisible\r\n  toolBrushStyleDiamond.style = StyleInvisible\r\n\r\nfunc PickBrushTypeCircle()\r\n  brushStyle = BrushType_Circle\r\n  toolBrushStyleRect.style = StyleInvisible\r\n  toolBrushStyleCircle.style = StyleBrackets\r\n  toolBrushStyleDiamond.style = StyleInvisible\r\n\r\nfunc PickBrushTypeDiamond()\r\n  brushStyle = BrushType_Diamond\r\n  toolBrushStyleRect.style = StyleInvisible\r\n  toolBrushStyleCircle.style = StyleInvisible\r\n  toolBrushStyleDiamond.style = StyleBrackets\r\n\r\nfunc IncBrushSize()\r\n  brushSize++\r\n  ?brushSize > brushSizeMax\r\n    brushSize = brushSizeMax\r\n  toolBrushSizeValue.text = \"\" + brushSize\r\n\r\nfunc DecBrushSize()\r\n  brushSize--\r\n  ?brushSize < 1\r\n    brushSize = 1\r\n  toolBrushSizeValue.text = \"\" + brushSize\r\n\r\nfunc ClearCanvas()\r\n  AddUndoList()\r\n  for Layer : TextLayers\r\n    Layer.TextUI.Recycle()\r\n  TextLayers.Clear()\r\n  NewLayer()\r\n  Selected_Layer = 0\r\n\r\nfunc CloseChisel()\r\n  loc.Leave()\r\n\r\nfunc Run()\r\n  ?!initialized | loc.loop\r\n    Init()\r\n\r\n  ?lastDrawTimeL ! null & (time.msbn).Sub(lastDrawTimeL).Ge(90)\r\n    isDrawingL = false\r\n\r\n  ?isDrawingL\r\n    CanvasDrawL()\r\n  :\r\n    lastDrawTimeL = null\r\n\r\n  ?toolSelectIsSelecting\r\n    DrawSelectionBox() \r\n\r\n  ?key = \"PrimaryEnd\"\r\n    EndDrawingL()\r\n\r\n  ?isPC\r\n    ?key = \"LeftBegin\"\r\n      CheckPaletteSelectR()\r\n      StartDrawingR()\r\n    ?key = \"LeftEnd\"\r\n      EndDrawingR()\r\n\r\n    ?lastDrawTimeR ! null & (time.msbn).Sub(lastDrawTimeR).Ge(90)\r\n      isDrawingR = false\r\n\r\n    ?isDrawingR\r\n      CanvasDrawR()\r\n    :\r\n      lastDrawTimeR = null\r\n\r\n    ?key = \"Ability2\"\r\n      ?key = \"DownBegin\"\r\n        ?canvasPanel.visible\r\n          OpenSaveScreen()\r\n      :?key = \"RightBegin\"\r\n        OpenLoadScreen()\r\n      :?key = \"bumpLBegin\"\r\n        Undo()\r\n\r\nvar Waterfall = string.Equals(loc.id, waterfall)\r\n?Waterfall\r\n  Run()\r\n\r\n?item.left = grappling hook\r\n  equip shovel\r\n\r\nfunc CanvasStartUp()\r\n  ?loc.loop\r\n    return CanvasLineAdder(Selected_Layer)\r\n  String = \"\"\r\n  TextLayers[Selected_Layer].TextList = []\r\n  for a = 1..screen.h - 2\r\n    TextLayers[Selected_Layer].TextList.Add(string.Sub(CanvasBlankTextLine,0,Width))\r\n  return CanvasLineAdder(Selected_Layer)\r\n\r\n\r\n//  ==============  Save Functions  ==============\r\n\r\nfunc Undo()\r\n  ?UndoList.Count() > 0\r\n    Load = UndoList[UndoList.Count()-1]\r\n    Load[2]()  //This is the saved Add Redo List function\r\n    Load[1]()  //This opens the saved undo load function\r\n    UndoList.RemoveAt(UndoList.Count()-1)\r\n  UpdateUndoButtonColour()\r\n\r\nfunc Redo()\r\n  ?RedoList.Count() > 0\r\n    Load = RedoList[RedoList.Count()-1]\r\n    Load[2]() //This is the saved Add Undo List function\r\n    Load[1]() //This opens the saved redo load function\r\n    RedoList.RemoveAt(RedoList.Count()-1)\r\n  UpdateRedoButtonColour()\r\n\r\nfunc UpdateRedoButtonColour()\r\n  ?RedoList.Count() = 0\r\n    toolRedo.bcolor = #202020\r\n  :\r\n    toolRedo.bcolor = #808080\r\n\r\nfunc UpdateUndoButtonColour()\r\n  ?UndoList.Count() = 0\r\n    toolUndo.bcolor = #202020\r\n  :\r\n    toolUndo.bcolor = #808080\r\n\r\nfunc SaveRecover()\r\n  var LoadLayerList = Load[0]\r\n  var LCount = LoadLayerList.Count() \r\n  var TCount = TextLayers.Count()\r\n\r\n  ?LCount > TCount\r\n    for a=TCount..LCount-1\r\n      NewLayer()\r\n  :?LCount < TCount\r\n    for a=LCount..TCount-1\r\n      TextLayers[0].TextUI.Recycle()\r\n      TextLayers.RemoveAt(0)\r\n\r\n  var Ta = 0\r\n  for T : TextLayers\r\n    for L = 0..T.TextList.Count()-1\r\n      T.TextList[L] = string.Sub( LoadLayerList[Ta] , L*Width , Width)\r\n    T.TextUI.text = string.Join(\"\\n\",T.TextList)\r\n    Ta++\r\n\r\n  ?SelectedTool = 2\r\n    LayerToolScreen()\r\n\r\nfunc CloseSaveScreen()\r\n  BackgroundPanel.Recycle()\r\n  BackgroundFade.Recycle()\r\n  SaveText.Recycle()\r\n  CloseButton.Recycle()\r\n  canvasPanel.visible = true\r\n  for a : ButtonList\r\n    a.Recycle()\r\n\r\nvar BackgroundPanel\r\nvar BackgroundFade\r\nvar SaveText\r\nvar CloseButton\r\nvar ScreenH = screen.h\r\nvar ButtonList = []\r\n\r\nfunc OpenSaveScreen()\r\n  ?!canvasPanel.visible\r\n    return\r\n  canvasPanel.visible = false\r\n  BackgroundFade = ui.AddCanvas()\r\n  BackgroundFade.w = Screen.w\r\n  BackgroundFade.h = ScreenH\r\n  BackgroundFade.blend = Subtract\r\n  BackgroundFade.SetFG(#404040)\r\n\r\n  BackgroundPanel = ui.AddPanel()\r\n  BackgroundPanel.w = 61\r\n  BackgroundPanel.h = ScreenH\r\n\r\n  SaveText = ui.AddText(\"Select Save Slot\")\r\n  SaveText.w = 50\r\n  SaveText.y = -ScreenH/2 + 3\r\n  SaveText.align = center\r\n\r\n  CloseButton = ui.AddButton()\r\n  CloseButton.style = StyleBrackets\r\n  CloseButton.x = 10\r\n  CloseButton.y = -ScreenH/2 + 1\r\n  CloseButton.w = 3\r\n  CloseButton.h = 3\r\n  CloseButton.SetDown(CloseSaveScreen)\r\n  CloseButton.text = \"X\"\r\n\r\n  var StorageList = storage.Keys()\r\n  var StorageCount = StorageList.Count() + 1\r\n  var ButtonsPerRow\r\n  ?StorageCount > 35\r\n    ButtonsPerRow = 10\r\n  :\r\n    ButtonsPerRow = 5\r\n  var RowCount = math.CeilToInt((1.0*StorageCount)/ButtonsPerRow)\r\n  var remainder = StorageCount % ButtonsPerRow\r\n  var ListReference\r\n\r\n  ButtonList.Clear()\r\n\r\n  for a=1..RowCount\r\n    ListReference = (a-1)*ButtonsPerRow\r\n    ?a = RowCount & remainder>0\r\n      for b=1..remainder\r\n        GenerateSaveLoadButtons(true,StorageList,a,b,remainder,ListReference+b)\r\n    :\r\n      for b=1..ButtonsPerRow\r\n        GenerateSaveLoadButtons(true,StorageList,a,b,ButtonsPerRow,ListReference+b)\r\n\r\nfunc OpenLoadScreen()\r\n  ?!canvasPanel.visible\r\n    return\r\n  canvasPanel.visible = false\r\n  BackgroundFade = ui.AddCanvas()\r\n  BackgroundFade.w = Screen.w\r\n  BackgroundFade.h = ScreenH\r\n  BackgroundFade.blend = Subtract\r\n  BackgroundFade.SetFG(#404040)\r\n\r\n  BackgroundPanel = ui.AddPanel()\r\n  BackgroundPanel.w = 61\r\n  BackgroundPanel.h = ScreenH\r\n\r\n  SaveText = ui.AddText(\"Select Load Slot\")\r\n  SaveText.w = 50\r\n  SaveText.y = -ScreenH/2 + 3\r\n  SaveText.align = center\r\n\r\n  CloseButton = ui.AddButton()\r\n  CloseButton.style = StyleBrackets\r\n  CloseButton.x = 10\r\n  CloseButton.y = -ScreenH/2 + 1\r\n  CloseButton.w = 3\r\n  CloseButton.h = 3\r\n  CloseButton.SetDown(CloseSaveScreen)\r\n  CloseButton.text = \"X\"\r\n\r\n  var StorageList = storage.Keys()\r\n  var StorageCount = StorageList.Count()\r\n  var ButtonsPerRow\r\n  ?StorageCount = 0\r\n    SaveText.text = \"No Loads Slots Found ☹\"\r\n    CloseButton.x = 15\r\n    return\r\n  :?StorageCount > 35\r\n    ButtonsPerRow = 10\r\n  :\r\n    ButtonsPerRow = 5\r\n  var RowCount = math.CeilToInt((1.0*StorageCount)/ButtonsPerRow)\r\n  var remainder = StorageCount % ButtonsPerRow\r\n  var ListReference\r\n\r\n  ButtonList.Clear()\r\n\r\n  for a=1..RowCount\r\n    ListReference = (a-1)*ButtonsPerRow\r\n    ?a = RowCount & remainder>0\r\n      for b=1..remainder\r\n        GenerateSaveLoadButtons(false,StorageList,a,b,remainder,ListReference+b)\r\n    :\r\n      for b=1..ButtonsPerRow\r\n        GenerateSaveLoadButtons(false,StorageList,a,b,ButtonsPerRow,ListReference+b)\r\n\r\nfunc ButtonSave(btn)\r\n  var ButtonSelected\r\n  for a = 0..ButtonList.Count()-1\r\n    ?btn = ButtonList[a]\r\n      ButtonSelected = a+1\r\n  >Saved to Slot @ButtonSelected@!\r\n  var SaveFile = \"\"\r\n  for Layer = 0..TextLayers.Count()-1\r\n    SaveFile += CanvasSaveText(Layer) + \"☹\"\r\n  storage.Set(\"SaveSlot\"+ButtonSelected,SaveFile)\r\n  CloseSaveScreen()\r\n\r\nfunc ButtonLoad(btn)\r\n  AddUndoList()\r\n\r\n  var ButtonSelected\r\n  for a = 0..ButtonList.Count()-1\r\n    ?btn = ButtonList[a]\r\n      ButtonSelected = a+1\r\n  >Loaded Slot @ButtonSelected@!\r\n  var LoadAllLayers = string.Split(storage.Get(\"SaveSlot\"+ButtonSelected),\"☹\",true)\r\n  Load = [LoadAllLayers,SaveRecover,AddRedoList]\r\n  SaveRecover()\r\n  CloseSaveScreen()\r\n\r\nfunc GenerateSaveLoadButtons(Saving,StorageList,Row,Column,ColumnCount,ListReference)\r\n  var SLButton = ui.AddButton()\r\n  var MiddleNumber = math.CeilToInt((1.0*ColumnCount)/2)\r\n  var PositionOffset = Column - MiddleNumber\r\n  var BWidth = 5\r\n  var BHeight = 3\r\n\r\n  SLButton.h = BHeight\r\n  SLButton.w = BWidth\r\n  SLButton.y = -ScreenH/2 + BHeight * (Row-1) + 4\r\n  ?ListReference = StorageList.Count()+1\r\n    SLButton.text = \"New\"\r\n  :\r\n    SLButton.text = \"\" + ListReference\r\n  SLButton.x =  (BWidth+1) * PositionOffset - ((1+ColumnCount)%2)*(BWidth+1)/2\r\n  ?Saving\r\n    SLButton.SetDown(ButtonSave)\r\n  :\r\n    SLButton.SetDown(ButtonLoad)\r\n  ButtonList.Add(SLButton)\r\n\r\n// ============   Tool Select \r\n\r\nfunc ToolSelectLeft()\r\n  SelectedTool--\r\n  ?SelectedTool < 0\r\n    SelectedTool = 2\r\n  UpdateToolSelectPanel()\r\n\r\nfunc ToolSelectRight()\r\n  SelectedTool = (SelectedTool+1)%3\r\n  UpdateToolSelectPanel()\r\n\r\nfunc CreateToolMasterPanel()\r\n  toolSelectMotherPanel = ui.AddPanel()\r\n  toolSelectMotherPanel.style = StyleInvisible\r\n  toolSelectMotherPanel.anchor = top_left\r\n  toolSelectMotherPanel.dock = top_left\r\n\r\nvar tool_UpDownLayer_buttons = []\r\nvar tool_SelectLayer_Buttons = []\r\nvar TempA\r\nvar tempB\r\n\r\nfunc UpdateToolSelectPanel()\r\n  SelectionToggle = false\r\n  PasteToggle = false\r\n  ?toolSelectOrigin.Count()>0\r\n    toolSelectCanvas.Recycle()\r\n    toolSelectOrigin.Clear()\r\n  ?SelectedTool = 0\r\n    palettePanelTitle.text = \"Palette\"\r\n    toolsTransparent.visible = true\r\n    palleteTable.visible = true\r\n    palleteButton.visible = true\r\n    toolSelectMotherPanel.Recycle()\r\n    CreateToolMasterPanel()\r\n\r\n  :?SelectedTool = 1\r\n    palettePanelTitle.text = \"Selection\"\r\n    toolsTransparent.visible = false\r\n    palleteTable.visible = false\r\n    palleteButton.visible = false\r\n    toolSelectMotherPanel.Recycle()\r\n    CreateToolMasterPanel()\r\n\r\n    toolSelectButton = MakeButton(1, 3, 16, 3, \"Select\", null, SelectionModeToggle)\r\n    toolSelectMotherPanel.Add(toolSelectButton)\r\n    ?CopyList.Count() > 0\r\n      OpenCutCopyButtons()\r\n      OpenPasteButton()\r\n\r\n  :?SelectedTool = 2\r\n    palettePanelTitle.text = \"Layers\"\r\n    toolsTransparent.visible = false\r\n    palleteTable.visible = false\r\n    palleteButton.visible = false\r\n    LayerToolScreen()\r\n\r\n    //func MakeText(x, y, w, h, align, content)\r\n\r\nvar SelectionToggle = false\r\nvar CutCopyEnabled = false\r\nvar PasteEnabled = false\r\nvar PasteToggle = false\r\n\r\nfunc OpenCutCopyButtons()\r\n  toolCutButton = MakeButton(1, 6, 8, 3, \"Cut\", null, CutSelection)\r\n  toolCopyButton = MakeButton(9, 6, 8, 3, \"Copy\", null, CopySelection)\r\n  toolSelectMotherPanel.Add(toolCutButton)\r\n  toolSelectMotherPanel.Add(toolCopyButton)\r\n\r\nfunc OpenPasteButton()\r\n  toolPasteButton = MakeButton(1, 9, 16, 3, \"Paste Mode\", null, PasteModeToggle)\r\n  toolSelectMotherPanel.Add(toolPasteButton)\r\n  toolSelectButton.bcolor = \"#181818\"\r\n  toolPasteButton.bcolor = \"#FFFFFF\"\r\n  SelectionToggle = false\r\n  PasteEnabled = true\r\n  PasteToggle = true\r\n\r\nfunc SelectionModeToggle()\r\n  ?SelectionToggle\r\n    SelectionToggle = false\r\n    toolSelectButton.bcolor = \"#181818\"\r\n  :\r\n    SelectionToggle = true\r\n    ?PasteEnabled\r\n      PasteToggle = false\r\n      toolPasteButton.bcolor = \"#181818\"\r\n    toolSelectButton.bcolor = \"#FFFFFF\"\r\n\r\nfunc CutSelection()\r\n  CopySelection()\r\n  AddUndoList()\r\n  var PasteHeight = CopyList.Count()\r\n  var PasteWidth = string.Size(CopyList[0])\r\n  var Cx = (toolSelectCanvas.x-1-(PasteWidth+1)%2) + PasteWidth/2\r\n  var Cy = (toolSelectCanvas.y-1) + PasteHeight/2\r\n  var MaxRange = math.Min(Cy+(PasteHeight-1)/2,ScreenH-3)\r\n  ?PasteHeight%2\r\n    var MinRange = math.Max(Cy-(PasteHeight-1)/2,0)\r\n  :\r\n    var MinRange = math.Max(Cy-(PasteHeight-1)/2-1,0)\r\n  for i = MinRange..MaxRange\r\n    TextLayers[Selected_Layer].TextList[i] = PasteLineEmplace(TextLayers[Selected_Layer].TextList[i], Cx, PasteWidth+1, CanvasBlankTextLine)\r\n  TextLayers[Selected_Layer].TextUI.text= CanvasLineAdder(Selected_Layer)\r\n\r\nvar CopyList = []\r\nfunc CopySelection()\r\n  CopyList.Clear()\r\n  var CopyWidth = toolSelectCanvas.w\r\n  var CopyX = toolSelectCanvas.x-1\r\n  var CopyY = toolSelectCanvas.y-1\r\n  var CopyHeight = toolSelectCanvas.h-1\r\n  for a = CopyY..CopyY+CopyHeight\r\n    CopyList.Add( string.Sub(TextLayers[Selected_Layer].TextList[a],CopyX,CopyWidth))\r\n  OpenPasteButton()\r\n  >Selection copied!\r\n\r\nfunc PasteModeToggle()\r\n  ?PasteToggle\r\n    PasteToggle = false\r\n    toolPasteButton.bcolor = \"#181818\"\r\n  :\r\n    PasteToggle = true\r\n    SelectionToggle = false\r\n    toolSelectButton.bcolor = \"#181818\"\r\n    toolPasteButton.bcolor = \"#FFFFFF\"\r\n\r\nfunc PasteSelection(dx,dy)\r\n  AddUndoList()\r\n  var CopyListRef\r\n  var PasteHeight = CopyList.Count()\r\n  var PasteWidth = string.Size(CopyList[0])\r\n  var MaxRange = math.Min(dy+(PasteHeight-1)/2,ScreenH-3)\r\n  ?PasteHeight%2\r\n    var MinRange = math.Max(dy-(PasteHeight-1)/2,0)\r\n  :\r\n    var MinRange = math.Max(dy-(PasteHeight-1)/2-1,0)\r\n  for i = MinRange..MaxRange\r\n    CopyListRef = i-dy+PasteHeight/2\r\n    TextLayers[Selected_Layer].TextList[i] = PasteLineEmplace(TextLayers[Selected_Layer].TextList[i], dx, PasteWidth, CopyList[CopyListRef])\r\n  TextLayers[Selected_Layer].TextUI.text= CanvasLineAdder(Selected_Layer)\r\n\r\nfunc DrawSelectionBox()\r\n  var dx = input.x - canvas.absoluteX +1\r\n  var dy = input.y - canvas.absoluteY +1\r\n  toolSelectCanvas.w = math.Abs(dx - toolSelectOrigin[0])\r\n  toolSelectCanvas.h = math.Abs(dy - toolSelectOrigin[1])\r\n  ?dx < toolSelectOrigin[0]\r\n    toolSelectCanvas.x = dx\r\n  :\r\n    toolSelectCanvas.x = toolSelectOrigin[0]\r\n  ?dy < toolSelectOrigin[1]\r\n    toolSelectCanvas.y = dy\r\n  :\r\n    toolSelectCanvas.y = toolSelectOrigin[1]\r\n\r\n/////////////////////////Layers Section\r\n\r\nvar Math\r\nfunc LayerToolScreen()\r\n\r\n  toolSelectMotherPanel.Recycle()\r\n  CreateToolMasterPanel()\r\n\r\n  tool_AddLayer_Button = MakeButton(1, 3, 16, 3, \"Add Layer\", null, AddLayerButton)\r\n  toolSelectMotherPanel.Add(tool_AddLayer_Button)\r\n\r\n  tool_Layer_Buttons.Clear()\r\n  tool_SelectLayer_Buttons.Clear()\r\n  for a=0..TextLayers.Count()-1\r\n    Math = TextLayers.Count()-1-a\r\n    tool_Layer_Buttons.Add(MakeButton(2, 6+Math*2, 12, 3, \"Layer: \"+a, null, LayerDetails))\r\n    ?a = Selected_Layer\r\n      tool_SelectLayer_Buttons.Add(MakeButton(14, 6+Math*2, 3, 3, \"ʘ\", null, SelectLayer))\r\n    :\r\n      tool_SelectLayer_Buttons.Add(MakeButton(14, 6+Math*2, 3, 3, \"☺\", null, SelectLayer))\r\n    toolSelectMotherPanel.Add(tool_Layer_Buttons[a])\r\n    toolSelectMotherPanel.Add(tool_SelectLayer_Buttons[a])\r\n\r\nfunc AddLayerButton()\r\n  AddUndoList()\r\n  NewLayer()\r\n  LayerToolScreen()\r\n\r\nfunc NewLayer()\r\n  var TempNew = new UI/ChiselFiles/SetLayer\r\n  TextLayers.Add(TempNew)\r\n  canvasPanel.Add(TextLayers[TextLayers.Count()-1].TextUI)\r\n\r\nfunc SelectLayer(btn)\r\n  for a = 0..tool_SelectLayer_Buttons.Count()-1\r\n    ?btn = tool_SelectLayer_Buttons[a]\r\n      tool_SelectLayer_Buttons[Selected_Layer].text = \"☺\"\r\n      tool_SelectLayer_Buttons[a].text = \"ʘ\"\r\n      Selected_Layer = a\r\n\r\nvar Layer_Detail_Panel\r\nvar ChosenButton = 9999\r\nvar Layer_ShiftUp_Button\r\nvar Layer_ShiftDown_Button\r\nvar Layer_Delete_Button\r\nvar Layer_Visible_Button\r\n\r\nfunc LayerDetails(btn)\r\n  ?ChosenButton < tool_Layer_Buttons.Count()\r\n    ?btn = tool_Layer_Buttons[ChosenButton] & Layer_Detail_Panel\r\n      Layer_Detail_Panel.Recycle()\r\n      ChosenButton = 9999\r\n      for a = 0..tool_Layer_Buttons.Count()-1\r\n        Math = tool_Layer_Buttons.Count()-1-a\r\n        tool_Layer_Buttons[a].y = 6+Math*2\r\n        tool_SelectLayer_Buttons[a].y = 6+Math*2\r\n      return\r\n  ChosenButton = 9999\r\n  for a = 0..tool_Layer_Buttons.Count()-1\r\n    Math = tool_Layer_Buttons.Count()-1-a\r\n    ?tool_Layer_Buttons[a] = btn\r\n      ChosenButton = a\r\n    ?a <= ChosenButton\r\n      tool_Layer_Buttons[a].y = 14+Math*2\r\n      tool_SelectLayer_Buttons[a].y = 14+Math*2\r\n    :\r\n      tool_Layer_Buttons[a].y = 6+Math*2\r\n      tool_SelectLayer_Buttons[a].y = 6+Math*2\r\n\r\n  Math = tool_Layer_Buttons.Count()-1-ChosenButton\r\n  ?Layer_Detail_Panel\r\n    Layer_Detail_Panel.Recycle()\r\n  Layer_Detail_Panel = MakePanel(toolSelectMotherPanel, 1, 6+Math*2, 17, 11, null, -5)\r\n  Layer_ShiftUp_Button = MakeButton(13, 1, 3, 3, \"▲\", null, LayerShiftUp)\r\n  Layer_ShiftDown_Button = MakeButton(13, 7, 3, 3, \"▼\", null, LayerShiftDown)\r\n  Layer_Delete_Button = MakeButton(1, 7, 12, 3, \"Delete\", null, LayerDelete)\r\n  ?TextLayers[ChosenButton].TextUI.visible\r\n    Layer_Visible_Button = MakeButton(1, 4, 12, 3, \"Visible\", null, LayerVisible)\r\n  :\r\n    Layer_Visible_Button = MakeButton(1, 4, 12, 3, \"Invisible\", null, LayerVisible)\r\n  tool_Layer_Buttons[ChosenButton].y = 7+Math*2\r\n  tool_SelectLayer_Buttons[ChosenButton].y = 10+Math*2\r\n\r\n  Layer_Detail_Panel.Add(Layer_ShiftUp_Button)\r\n  Layer_Detail_Panel.Add(Layer_ShiftDown_Button)\r\n  Layer_Detail_Panel.Add(Layer_Delete_Button)\r\n  Layer_Detail_Panel.Add(Layer_Visible_Button)\r\n\r\nvar Intermediary_Variable\r\n\r\nfunc LayerShiftUp()\r\n  ?ChosenButton < TextLayers.Count()-1\r\n    Intermediary_Variable = TextLayers[ChosenButton+1].TextList\r\n    TextLayers[ChosenButton+1].TextList = TextLayers[ChosenButton].TextList\r\n    TextLayers[ChosenButton].TextList = Intermediary_Variable\r\n\r\n    Intermediary_Variable = TextLayers[ChosenButton+1].TextUI.text\r\n    TextLayers[ChosenButton+1].TextUI.text = TextLayers[ChosenButton].TextUI.text\r\n    TextLayers[ChosenButton].TextUI.text = Intermediary_Variable\r\n\r\n    LayerDetails(tool_Layer_Buttons[ChosenButton+1])\r\n\r\nfunc LayerShiftDown()\r\n  ?ChosenButton > 0\r\n    Intermediary_Variable = TextLayers[ChosenButton-1].TextList\r\n    TextLayers[ChosenButton-1].TextList = TextLayers[ChosenButton].TextList\r\n    TextLayers[ChosenButton].TextList = Intermediary_Variable\r\n\r\n    Intermediary_Variable = TextLayers[ChosenButton-1].TextUI.text\r\n    TextLayers[ChosenButton-1].TextUI.text = TextLayers[ChosenButton].TextUI.text\r\n    TextLayers[ChosenButton].TextUI.text = Intermediary_Variable\r\n\r\n    LayerDetails(tool_Layer_Buttons[ChosenButton-1])\r\n\r\nfunc LayerDelete()\r\n  AddUndoList()\r\n  ?TextLayers.Count()>1\r\n    ?ChosenButton < TextLayers.Count()\r\n      TextLayers[ChosenButton].TextUI.Recycle()\r\n      TextLayers.RemoveAt(ChosenButton)\r\n      ?Selected_Layer > 0\r\n        Selected_Layer--\r\n    ChosenButton = 9999\r\n    LayerToolScreen()\r\n\r\nfunc LayerVisible()\r\n  ?TextLayers[ChosenButton].TextUI.visible\r\n    Layer_Visible_Button.text = \"Invisible\"\r\n    TextLayers[ChosenButton].TextUI.visible = false\r\n  :\r\n    Layer_Visible_Button.text = \"Visible\"\r\n    TextLayers[ChosenButton].TextUI.visible = true\r\n\r\nfunc SetEraser()\r\n  currentGlyphL = \"#\"\r\n  toolsGlyphGlyphL.text = \"Invis\"\r\n\r\nfunc RecreateLayers()\r\n  for T : TextLayers\r\n    T.TextUI = ui.AddText(T.CanvasLineAdder())\r\n    T.TextUI.w = screen.w - 38\r\n    T.TextUI.y = -10\r\n    T.TextUI.align = center\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/WitchHat.txt" - Parse error: Failed to parse completely. Remaining: "= #301934 //Dark\r\nvar bigtopcolor2 = #A865B5 //Light\r\nvar bigbotcolor1 = #4B0082 //Dark\r\nvar bigbotcolor2 = #A865B5 //Light\r\nvar smlcolor1 = #008800 //Dark\r\nvar smlcolor2 = #green  //Light\r\n\r\n//*******************************\r\n// Drawing Code \r\n//*******************************\r\n\r\nvar bighat1 = ascii\r\n##,'`·_\r\n##/_.──-.\r\n#,´ ,--. ;\r\n:  #####'\r\n#`·─\r\nasciiend\r\n\r\nvar bighat2 = ascii\r\n###_.──-.\r\n#,´ ,--. ;\r\n:  #####'\r\n#`·─\r\nasciiend\r\n\r\nvar smlhat1 = ascii\r\n#λ\r\n¯Ö¯\r\nasciiend\r\n\r\nvar smlhat2 = ascii\r\n#Ö\r\nasciiend\r\n\r\nvar tempcolor1\r\nvar tempcolor2\r\nvar t = 0\r\n\r\n?bighead\r\n  t = math.sin(time*0.05) / 2 + 0.5\r\n  tempcolor1 = color.Lerp(\r\n           ^bigtopcolor1,bigtopcolor2,t)\r\n  t = math.sin((time+20)*0.05) / 2 + 0.5\r\n  tempcolor2 = color.Lerp(\r\n           ^bigbotcolor1,bigbotcolor2,t)\r\n\r\n  >h-5,-3,@tempcolor1@,@bighat1@\r\n  >h-5,-2,@tempcolor2@,@bighat2@\r\n:\r\n  t = math.sin(time*0.05) / 2 + 0.5\r\n  tempcolor1 = color.Lerp(\r\n           ^smlcolor1,smlcolor2,t)\r\n  >h-1,0,@tempcolor1@,@smlhat1@\r\n  >h-1,1,@tempcolor1@,@smlhat2@\r\n//\r\n\r\n//*******************************\r\n// End of File\r\n//*******************************"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/Skully.txt" - Parse error: Failed to parse completely. Remaining: "= 0 //set to 1 if you want the alt body// 0 = OFF // 1 = ON\r\nvar boneColor = #808080 //grey\r\n\r\nx = myX + 0\r\ny = myZ + 0\r\n\r\n//DRAW---------------------------------------------<\r\n\r\n>h-2,-1,@boneColor@,ascii\r\n#,--.\r\n(_o,o)\r\n# `\"´\r\n#\r\nasciiend\r\n\r\n?ribcage = 1\r\n  >h-2,-1,@boneColor@,ascii\r\n#\r\n#\r\n#\r\n##╪\r\nasciiend\r\n\r\n//BOSS ENTRY---------------------------------------<\r\n\r\n?face = \"°°\"\r\n  >h0,0,@boneColor@,ascii\r\nò,ó\r\nasciiend\r\n\r\n//BOSS KILL----------------------------------------<\r\n\r\n?face = \"^^\"\r\n  ?time % 4 <= 1\r\n    >h0,0,@boneColor@,ascii\r\nO,o\r\nasciiend\r\n  ?time % 4 > 1\r\n    >h0,0,@boneColor@,ascii\r\no,O\r\nasciiend\r\n\r\n//BLINKING-----------------------------------------<\r\n\r\n?stateTime % 50 >= 48\r\n  >h0,0,@boneColor@,ascii\r\n=,=\r\nasciiend\r\n:?stateTime % 50 >= 46\r\n  >h0,0,@boneColor@,ascii\r\n-,-\r\nasciiend\r\n:?stateTime % 50 >= 44\r\n  >h0,0,@boneColor@,ascii\r\n=,=\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/SantaHat.txt" - Parse error: Failed to parse completely. Remaining: "= true     // hat quick enable/disable\r\nvar inputbighead              // checks for head size\r\n// this can be hardcoded with true/false\r\n// to force use only big/small head respectively \r\ninputbighead = bighead        // system var \"bighead\" determines it\r\nvar inputposx                 // used to detect movement\r\ninputposx = pos.x             // use custom var for performance\r\nvar inputanimframelength = 20 // length of hat animation\r\n\r\n// === === === === === === === === === === ===\r\nvar oldposx = inputposx\r\nvar hatframecounter = 0       // counts when hat should move\r\nvar hatframe1 = inputanimframelength/2 // frame switch condition\r\n//  ˏ.-.\r\n// *  ,^,\r\n//    `o´\r\n? inputhatenable\r\n  ? inputbighead = false // small head required\r\n    ? oldposx ! inputposx //update frame counter\r\n      hatframecounter++\r\n      ? hatframecounter = inputanimframelength\r\n        hatframecounter = 0 // reset frame counter\r\n    ? hatframecounter < hatframe1 // animate small hat\r\n      >h-4,-1,#008000,ascii\r\n#,--. \r\n###,^,\r\nasciiend\r\n    :// 008000 - dark green\r\n      >h-4,-1,#008000,ascii\r\n##,-. \r\n#'#,^,\r\nasciiend\r\n    >h-4,-1,#white,ascii\r\n#\r\n#\r\n###`#'\r\nasciiend\r\n    >h-4,-1,#red,ascii\r\n#\r\n°\r\nasciiend\r\n  : // in case of big head we use the original\r\n    >h-4,-2,#red,ascii\r\n###_##\r\n#,;###\r\n######\r\nasciiend\r\n\r\n    >h-4,-2,#white,ascii\r\n######\r\n###,´#\r\n°#´###\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/MushroomHat.txt" - Parse error: Failed to parse completely. Remaining: "= #red\r\nvar botcolor = #white\r\n\r\n//*******************************\r\n// Drawing Code \r\n//*******************************\r\n\r\n>h-5,-4,@topcolor@,ascii\r\n##.-._\r\n#;°_.-().\r\n.O'_.——-.:\r\n;.' ,—-. :\r\n:: #####'\r\n#`•-\r\nasciiend\r\n\r\n>h-5,-4,@botcolor@,ascii\r\n#\r\n##°###()\r\n#O#_.——-.\r\n#.' ,—-. :\r\n#: #####'\r\n#`•-\r\nasciiend\r\n\r\n//*******************************\r\n// End of File\r\n//*******************************"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/DefectFaceplate.txt" - Parse error: Failed to parse completely. Remaining: "-.'`.-\r\n`. 8.'\r\nasciiend \r\n\r\n>h-4,-1,#BBDDFF,ascii\r\n#\r\n####8\r\nasciiend "
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/JesterHat.txt" - Parse error: Failed to parse completely. Remaining: ",-.\r\n_(#\r\nasciiend\r\n >h-3,-2,#green,ascii\r\n,-.\r\n#)_\\\r\nasciiend\r\n >h-4,-1,#yellow,ascii\r\n°#######°\r\nasciiend\r\n:\r\n >h-2,0,#yellow,ascii\r\n###•\r\n•###•\r\nasciiend\r\n >h0,0,#cyan,,\r\n >h1,1,#red,¯\r\n >h-1,1,#blue,`"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/Headphones.txt" - Parse error: Failed to parse completely. Remaining: "= #66CC00     //headphones base color\r\n                        //color can be changed, but must be in the form #rrggbb or #rainbow (no #red, #cyan, #rainFF, etc.)\r\n                        //the new color will take effect upon exiting and re-entering a location\r\n                        //note \"fade out\" colors will be automatically calculated based on this color\r\n\r\n//66CC00  basic green\r\n//4169E1  royal blue\r\n//FC6400  pumpkin orange\r\n\r\n\r\n\r\n//extract integer color channels from hex value\r\nvar c_ints = colorToInt(color)\r\nvar c_ints_r = c_ints[0]\r\nvar c_ints_g = c_ints[1]\r\nvar c_ints_b = c_ints[2]\r\n\r\n//modify integer values to get note colors\r\nvar c_ints_age1 = [c_ints_r, c_ints_g, c_ints_b]\r\nvar c_ints_age2 = [math.Clamp(c_ints_r-68,0,512), math.Clamp(c_ints_g-68,0,512), math.Clamp(c_ints_b-68,0,512)]\r\nvar c_ints_age3 = [math.Clamp(c_ints_r-136,0,256), math.Clamp(c_ints_g-136,0,256), math.Clamp(c_ints_b-136,0,256)]\r\n\r\n//generate hex color values from modified color channels\r\nvar color_age1 = intToColor(c_ints_age1)\r\nvar color_age2 = intToColor(c_ints_age2)\r\nvar color_age3 = intToColor(c_ints_age3)\r\n\r\n\r\nvar max_notes = 5               //max notes alive at a time\r\nvar new_note_interval = 15      //number of ticks before a new note is created\r\nvar note_mov_interval = 9       //number of ticks between note random movements\r\n\r\nvar windy = false\r\nvar windy_note_interval = 5     //ticks before new note is created, when windy\r\nvar windy_mov_interval = 3      //ticks between note movements, when windy\r\nvar wind_mov_x = 0\r\n\r\nvar rng_x = 0\r\nvar rng_xmax = -3\r\nvar rng_xmin = -5\r\nvar rng_xmax_sm = -2\r\nvar rng_xmin_sm = -3\r\n\r\nvar rng_z = 0\r\nvar rng_zmax = 1\r\nvar rng_zmin = -3\r\nvar rng_zmax_sm = 1\r\nvar rng_zmin_sm = -1\r\n\r\nvar notes = []\r\nvar notes_xpos = []\r\nvar notes_zpos = []\r\n\r\nvar draw_x\r\nvar draw_z\r\nvar draw_note\r\nvar count\r\n\r\nvar dys_final\r\n\r\n\r\n//detect \"windy\" environments\r\n//occurs at Icy Ridge, during bridge crossing, and during Dysangelos fight\r\n?loc = rocky_plateau\r\n  ?windy\r\n    ?dys_final & (foe ! dysangelos)\r\n      windy = false\r\n      dys_final = false\r\n    :?foe.hp < 1 & foe = dysangelos_perfected\r\n      dys_final = true\r\n  :\r\n    ?foe = dysangelos & foe.state = 117\r\n        windy = true\r\n\r\n:?loc = icy_ridge\r\n  windy = true\r\n\r\n:?loc = cross_bridge\r\n  ?pos.x > 300\r\n    windy = false\r\n\r\n  :?loc.begin\r\n    windy = true\r\n\r\n\r\n//create a new note every *new_note_interval* ticks\r\n//increase rate to *windy_note_interval* ticks if the wind is blowing\r\n?(!windy & time % new_note_interval = 0) | (windy & time % windy_note_interval = 0)\r\n  //give notes a randomized position relative to player head\r\n  ?bighead\r\n    rng_x = rng_xmin + rng % (rng_xmax - rng_xmin + 1)\r\n    rng_z = rng_zmin + rng % (rng_zmax - rng_zmin + 1)\r\n  :\r\n    rng_x = rng_xmin_sm + rng % (rng_xmax_sm - rng_xmin_sm + 1)\r\n    rng_z = rng_zmin_sm + rng % (rng_zmax_sm - rng_zmin_sm + 1)\r\n\r\n  //give notes a random symbol (♫ is less likely than ♪ because it's visually heavier)\r\n  ?(rng % 3) = 0\r\n    notes.Add(\"♫\")\r\n  :\r\n    notes.Add(\"♪\")\r\n\r\n  //store note x,y pos\r\n  notes_xpos.Add((pos.x + rng_x))\r\n  notes_zpos.Add((pos.z - pos.y + rng_z))\r\n\r\n  //pop oldest note if too many are onscreen\r\n  ?notes.Count() > max_notes\r\n    notes.RemoveAt(0)\r\n    notes_xpos.RemoveAt(0)\r\n    notes_zpos.RemoveAt(0)\r\n\r\n\r\n//allow notes to drift every *note_mov_interval* ticks\r\n//increase rate to *windy_mov_interval* ticks if the wind is blowing\r\n?(!windy & time % note_mov_interval = 0) | (windy & time % windy_mov_interval = 0)\r\n  count = notes.Count()\r\n  ?count > 0\r\n    ?count > max_notes\r\n      count = max_notes\r\n\r\n    for i = 0 .. count-1\r\n      //notes drift farther while windy\r\n      ?windy\r\n        wind_mov_x = 2 + (rng%3)\r\n      :\r\n        wind_mov_x = 0\r\n\r\n      notes_xpos.Emplace(i, notes_xpos[i] - (rng%2) - wind_mov_x)\r\n      notes_zpos.Emplace(i, notes_zpos[i] - (rng%2))\r\n\r\n\r\n//draw notes, if there are notes to be drawn\r\ncount = notes.Count()\r\n?count > 0\r\n  ?count > max_notes\r\n    count = max_notes\r\n\r\n  for i = 0 .. count-1\r\n    //correct for player's changing position\r\n    draw_x = notes_xpos[i] - pos.x\r\n    draw_z = notes_zpos[i] - pos.z + pos.y\r\n    draw_note = notes[i]\r\n    \r\n    //note color fades away as its age increases\r\n    ?i = 0\r\n      >o@draw_x@,@draw_z@,@color_age3@,@draw_note@\r\n    :?i < 3\r\n      >o@draw_x@,@draw_z@,@color_age2@,@draw_note@\r\n    :? i < max_notes\r\n      >o@draw_x@,@draw_z@,@color_age1@,@draw_note@\r\n\r\n\r\n//draw headphones\r\n?bighead\r\n  >h-3,-2,@color@,ascii\r\n##___\r\n#/###\\\r\n(│###│)\r\nasciiend\r\n:\r\n  >h-2,0,@color@,ascii\r\n#,-.\r\n(]#[)\r\nasciiend\r\n\r\n\r\n//color conversion helper functions\r\n\r\n//converts 6-digit color code to integers\r\n//returns a 3-element array containing r,g,b as integers\r\nfunc colorToInt(color)\r\n  ?string.Size(color) < 7\r\n    return [0,0,0]\r\n\r\n  ?color = \"#rainbow\"\r\n    return [1024,1024,1024]\r\n\r\n  var r = hexInt(string.Sub(color, 1, 2))\r\n  var g = hexInt(string.Sub(color, 3, 2))\r\n  var b = hexInt(string.Sub(color, 5, 2))\r\n\r\n  return [r,g,b]\r\n\r\n\r\n//converts 3-element integer array to 6-digit color code\r\n//returns a hex color code in the form #rrggbb\r\nfunc intToColor(ints)\r\n  var t = ints[0]\r\n  ?t > 512\r\n    return \"#rainFF\"\r\n  :?t > 256\r\n    return \"#rain88\"\r\n  :?t > 255\r\n    return \"#rain44\"\r\n\r\n  var r = minLength(intHex(ints[0]), 2, 0)\r\n  var g = minLength(intHex(ints[1]), 2, 0)\r\n  var b = minLength(intHex(ints[2]), 2, 0)\r\n\r\n  return \"#\"+r+g+b\r\n\r\n\r\n//converts 2-digit hex to integer\r\nfunc hexInt(hex)\r\n  var int = 0\r\n  var size = string.Size(hex)\r\n  var digit = string.Sub(hex, 0, 1)\r\n\r\n  var msb = 1\r\n  var lsb = 0\r\n\r\n  ?string.Size(hex) > 1\r\n    int = hexInt(string.Sub(hex, 1, size-1)) + int\r\n\r\n  :?string.Size(hex) = 1\r\n    msb = 0\r\n    lsb = 1\r\n\r\n  ?digit = \"0\"\r\n    int = int + 0 * (16*msb)\r\n  :?digit = \"1\"\r\n    int = int + 1 * (16*msb + lsb)\r\n  :?digit = \"2\"\r\n    int = int + 2 * (16*msb + lsb)\r\n  :?digit = \"3\"\r\n    int = int + 3 * (16*msb + lsb)\r\n  :?digit = \"4\"\r\n    int = int + 4 * (16*msb + lsb)\r\n  :?digit = \"5\"\r\n    int = int + 5 * (16*msb + lsb)\r\n  :?digit = \"6\"\r\n    int = int + 6 * (16*msb + lsb)\r\n  :?digit = \"7\"\r\n    int = int + 7 * (16*msb + lsb)\r\n  :?digit = \"8\"\r\n    int = int + 8 * (16*msb + lsb)\r\n  :?digit = \"9\"\r\n    int = int + 9 * (16*msb + lsb)\r\n  :?digit = \"A\"\r\n    int = int + 10 * (16*msb + lsb)\r\n  :?digit = \"B\"\r\n    int = int + 11 * (16*msb + lsb)\r\n  :?digit = \"C\"\r\n    int = int + 12 * (16*msb + lsb)\r\n  :?digit = \"D\"\r\n    int = int + 13 * (16*msb + lsb)\r\n  :?digit = \"E\"\r\n    int = int + 14 * (16*msb + lsb)\r\n  :?digit = \"F\"\r\n    int = int + 15 * (16*msb + lsb)\r\n  :\r\n    int = int + 0\r\n  return int\r\n\r\n\r\n//function by DarkLucifer69\r\n//backfills a string to a particular length with a specified value\r\nfunc minLength(string, length, append)\r\n ?string.Size(string) < length\r\n  string = append + minLength(string, length-1, append)\r\n\r\n return string\r\n\r\n\r\n//function by DarkLucifer69\r\n//converts integer to hex value\r\nfunc intHex(int)\r\n var hex = \"\"\r\n \r\n ?int >= 16\r\n  hex = intHex(int/16) + hex \r\n  \r\n ?int % 16 <= 9\r\n  hex = hex + (int % 16)\r\n :?int % 16 = 10\r\n  hex = hex + \"A\"\r\n :?int % 16 = 11\r\n  hex = hex + \"B\"\r\n :?int % 16 = 12\r\n  hex = hex + \"C\"\r\n :?int % 16 = 13\r\n  hex = hex + \"D\"\r\n :?int % 16 = 14\r\n  hex = hex + \"E\"\r\n :?int % 16 = 15\r\n  hex = hex + \"F\"\r\n \r\n return hex\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/IroncladMask.txt" - Parse error: Failed to parse completely. Remaining: "###_ ._ \r\n##,\\'-.'\r\n##||'.'-\r\n##',###'\r\nasciiend\r\n\r\n  >h-5,-2,#C09F46,ascii\r\n###_ ._ \r\n###\\'-.\\\r\n####\\.'/\r\n#####`' \r\nasciiend\r\n\r\n  >h-5,-2,#DF7C31,ascii\r\n####### \r\n#########\r\n#####`~\r\n#########\r\nasciiend\r\n\r\n  >h-5,-2,#008800,ascii\r\n####### \r\n#########\r\n#########\r\n####`####\r\nasciiend \r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/ReindeerHead.txt" - Parse error: Failed to parse completely. Remaining: "`\\('#`|#)'\r\n##\\|`#\\/-\r\n###)##/._\r\n.-,＂  '-.\r\n``| o o  `--()\r\n##'.   ---.-`\r\n####) /＂'`\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/ShuffleHat.txt" - Parse error: Failed to parse completely. Remaining: "= 0..2\r\n    a = rng % FuncList.Count()\r\n    ?a ! Rand\r\n      break\r\n  Rand = a\r\n  enable player\r\n  CurrentImport = FuncList[Rand]\r\n\r\nvar FuncList = [DiscoVisor,CatHat,ChefHat,Headphones,Helmet,MushroomHat,PirateHat,SantaHat,Skully,ConfettiHead,StarCloak,WavyScarf,SleepyStonehead,SillyGoose]\r\n\r\nvar frames = 5\r\nvar Rand\r\nvar CurrentImport = null\r\nvar LastScreeni\r\nvar HeadPhoneImport = import Hats/Headphones\r\n\r\nfunc FrameReroll()\r\n  ?time % frames = 0\r\n    return true\r\n  return false\r\n\r\nfunc LoopReroll()\r\n  ?totaltime = 1\r\n    return true\r\n  return false\r\n\r\nfunc ScreenReroll()\r\n  ?LastScreeni ! screen.i\r\n    LastScreeni = screen.i\r\n    return true\r\n  LastScreeni = screen.i\r\n  return false\r\n\r\nvar RerollConditions = FrameReroll\r\n\r\nfunc Run()\r\n  ?totaltime = 1\r\n    CatHat()\r\n  ?RerollConditions()\r\n    Reroll()\r\n  ?CurrentImport\r\n    CurrentImport()\r\n\r\nRun()\r\n\r\n\r\n\r\n\r\n\r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/StarCloak.txt" - Parse error: Failed to parse completely. Remaining: "= \"#bf9f7f\"\r\n\r\nfunc CheckStars()\r\n  ?loc.stars>30\r\n    return \"rain\"\r\n  :?loc.stars>25\r\n    return \"red\"\r\n  :?loc.stars>20\r\n    return \"blue\"\r\n  :?loc.stars>15\r\n    return \"green\"\r\n  :?loc.stars>10\r\n    return \"yellow\"\r\n  :?loc.stars>5\r\n    return \"cyan\"\r\n  :?loc.stars>1\r\n    return \"white\"\r\n  :\r\n    return \"magenta\"\r\n\r\n\r\nfunc Draw()\r\n  ?bighead\r\n    >h-3,-2,@CloakColour@,ascii\r\n##__##\r\n##, `#\r\n#( ##)\r\n##^.^##\r\n#//####\r\n´´###``\r\nasciiend\r\n  :\r\n    >h-3,-2,@CloakColour@,ascii\r\n##__##\r\n##, `#\r\n#( '')\r\n##^.^##\r\n#//####\r\n´´###``\r\nasciiend\r\n  >h-2,-1,#@bgc@,☆\r\n\r\nDraw()"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/Treeman.txt" - Parse error: Failed to parse completely. Remaining: "####@\r\n###.＂.\r\n#.´  o`.\r\n#.´° _`.\r\n#‾.´_`.‾\r\n##‾└─┘‾\r\nasciiend\r\n>h-4,-4,#green,ascii\r\n\r\n###.#.\r\n#.´###`.\r\n#.´##_`.\r\n#‾.´_`.‾\r\n##‾###‾\r\nasciiend\r\n>h-4,-4,#rainFF,ascii\r\n####@\r\n####＂\r\n#####o\r\n###°\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/SilentSkull.txt" - Parse error: Failed to parse completely. Remaining: ".-=.`\\-`\\\r\n#####`-.  '\r\n#########\\|\r\nasciiend\r\n\r\n  >h-8,-2,#808080,ascii\r\n#\r\n########`o\r\n#\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/DiscoVisor.txt" - Parse error: Failed to parse completely. Remaining: "?foe = dysangelos\r\n  fpbForLevel = 8\r\n?loc = deadwood\r\n fpbForLevel = 13\r\n ?foe = xyloalgia & foe.distance < 10\r\n  fpbForLevel = 5\r\n?loc = caves\r\n fpbForLevel = 32\r\n  ?foe = bolesh\r\n   fpbForLevel = 10\r\n?loc = waterfall\r\n fpbForLevel = 30\r\n?loc = forest\r\n fpbForLevel = 27\r\n ?loc = shroom\r\n  fpbForLevel = 9\r\n?loc = haunted\r\n fpbForLevel = 13\r\n ?foe = pallas\r\n  fpbForLevel = 10\r\n?loc = mine\r\n fpbForLevel = 11\r\n ?foe = guardian & foe.distance < 22\r\n  fpbForLevel = 4\r\n?loc = icy ridge\r\n fpbForLevel = 15\r\n ?foe = yeti\r\n  fpbForLevel = 8\r\n?loc = bridge\r\n fpbForLevel = 60\r\n?loc = temple\r\n fpbForLevel = 20\r\n ?foe = nagaraja\r\n  fpbForLevel = 6\r\n   \r\n// are we on a beat?  \r\n?time % fpbForLevel ! 0\r\n isBeat = 0\r\n:\r\n isBeat = 1\r\n\r\n// helmet aside from the visor\r\n>h-3,-1,#8a8a8a,ascii\r\n┊####┊\r\nΘ####Θ\r\nasciiend\r\n\r\n// flash the visor if we're on a beat\r\n?isBeat = 1\r\n >h-2,0,#rainbow,ascii\r\n███▓▒\r\nasciiend\r\n\r\n// or don't if we're not\r\n?isBeat = 0\r\n >h-2,0,#3a3a3a,ascii\r\n███▓▒\r\nasciiend\r\n\r\n// debug display (uncomment to enable)\r\n//?isBeat = 1\r\n// >`0,0,#00ff00,♪\r\n//?isBeat = 0\r\n//  >`0,0,#ff0000,♫"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/PirateHat.txt" - Parse error: Failed to parse completely. Remaining: "= #999999\r\ntricornColor = #b29670\r\njollyRogerColor = #white\r\neyePatchColor = #777777\r\n//---------------------------------------------\r\n\r\n?bighead\r\n  >h-5,-2,@tricornColor@,ascii\r\n###,.=.._\r\n##/.-x-.\\\\\r\nasciiend\r\n  >h-6,0,@eyePatchColor@,ascii\r\n#####.Ü#####\r\nasciiend\r\n:\r\n  >h-4,-1,@bicornColor@,ascii\r\n###___\r\n#,/___'.\r\nasciiend\r\n  >h-4,1,#white,ascii\r\n####U\r\nasciiend\r\n  >h-1,0,@jollyRogerColor@,ascii\r\n:o:\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/LanternTalisman.txt" - Parse error: Failed to parse completely. Remaining: "?item.left = ＂golden＂\r\n    >o-3,1,#FFCC66,@lanterntalisman@\r\n  :?item.left = ＂+0＂\r\n    >o-3,1,#white,@lanterntalisman@\r\n  :?item.left = ＂+1＂\r\n    >o-3,1,#cyan,@lanterntalisman@\r\n  :?item.left = ＂+2＂ | item.left = ＂+3＂\r\n    >o-3,1,#yellow,@lanterntalisman@\r\n  :?item.left = ＂+4＂ | item.left = ＂+5＂ |\r\n  ^item.left = ＂+6＂\r\n    >o-3,1,#green,@lanterntalisman@\r\n  :?item.left = ＂+7＂ | item.left = ＂+8＂ |\r\n  ^item.left = ＂+9＂ | item.left = ＂+10＂\r\n    >o-3,1,#blue,@lanterntalisman@\r\n  :?item.left = ＂+11＂ | item.left = ＂+12＂ |\r\n  ^item.left = ＂+13＂ | item.left = ＂+14＂ |\r\n  ^item.left = ＂+15＂\r\n    >o-3,1,#red,@lanterntalisman@\r\n  :\r\n    >o-3,1,#rainFF,@lanterntalisman@\r\n  ?item.left.state ! 1\r\n    >o-2,2,#FFCC99,φ\r\n:?item.right = fire_talisman\r\n  ?item.right = ＂golden＂\r\n    >o1,1,#FFCC66,@lanterntalisman@\r\n  :?item.right = ＂+0＂\r\n    >o1,1,#white,@lanterntalisman@\r\n  :?item.right = ＂+1＂\r\n    >o1,1,#cyan,@lanterntalisman@\r\n  :?item.right = ＂+2＂ | item.right = ＂+3＂\r\n    >o1,1,#yellow,@lanterntalisman@\r\n  :?item.right = ＂+4＂ | item.right = ＂+5＂ |\r\n  ^item.right = ＂+6＂\r\n    >o1,1,#green,@lanterntalisman@\r\n  :?item.right = ＂+7＂ | item.right = ＂+8＂ |\r\n  ^item.right = ＂+9＂ | item.right = ＂+10＂\r\n    >o1,1,#blue,@lanterntalisman@\r\n  :?item.right = ＂+11＂ | item.right = ＂+12＂ |\r\n  ^item.right = ＂+13＂ | item.right = ＂+14＂ |\r\n  ^item.right = ＂+15＂\r\n    >o1,1,#red,@lanterntalisman@\r\n  :\r\n    >o1,1,#rainFF,@lanterntalisman@\r\n  ?item.right.state ! 1\r\n    >o2,2,#FFCC99,φ"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/CatHat.txt" - Parse error: Failed to parse completely. Remaining: "= #FFBFFF\r\nvar catTW = 0\r\n\r\n?loc = icy_ridge\r\n^|loc = cross_bridge & screen.i < 5\r\n^|foe = dysangelos & foe.state = 117\r\n  catTW = 1\r\n\r\n:?foe = dysangelos & foe = phase3 & foe.hp <= 0\r\n^|loc = cross_bridge & screen.i > 4\r\n  catTW = 0\r\n\r\n?catTW = 1\r\n  ?time % 9 < 3 * 1\r\n    >h-8,-2,@catColor@,ascii\r\n,_.-·.\r\n`.   \r\n###'´\r\nasciiend\r\n  :?time % 9 < 3 * 2\r\n    >h-8,-1,@catColor@,ascii\r\n_,•´¯\r\n`. _.'\r\nasciiend\r\n  :?time % 9 < 3 * 3\r\n    >h-8,-2,@catColor@,ascii\r\n#,'¯¯`\r\n;•´-,\r\nasciiend\r\n:?time % 81 < 3 * 21\r\n  >h-6,-4,@catColor@,ascii\r\n#,\r\n#)`,\r\n(  ;\r\n`-·\r\nasciiend\r\n:?time % 81 < 3 * 22\r\n  >h-7,-4,@catColor@,ascii\r\n#,\r\n(`.,\r\n'   ;\r\n#`-·\r\nasciiend\r\n:?time % 81 < 3 * 23\r\n  >h-8,-2,@catColor@,ascii\r\n,_.-·.\r\n`.   \r\n###'´\r\nasciiend\r\n:?time % 81 < 3 * 24\r\n  >h-8,-1,@catColor@,ascii\r\n_,•´¯\r\n`. _.'\r\nasciiend\r\n:?time % 81 < 3 * 25\r\n  >h-8,-2,@catColor@,ascii\r\n#,'¯¯`\r\n;•´-,\r\nasciiend\r\n:?time % 81 < 3 * 26\r\n  >h-8,-3,@catColor@,ascii\r\n,-~-,\r\n¯\\   `\r\n##`-·\r\nasciiend\r\n:?time % 81 < 3 * 27\r\n  >h-6,-4,@catColor@,ascii\r\n,\r\nì`.\r\n;  :\r\n`-·\r\nasciiend\r\n>h-3,-2,@catColor@,ascii\r\n#/` ,|\r\n(_`,|;\r\nasciiend\r\n?catTW = 1\r\n  ?time % 6 < 3 * 1\r\n    >h-2,-5,@catColor@,ascii\r\n####,\r\n-.-´'\\\r\n\\ ###)\r\nasciiend\r\n  :?time % 6 < 3 * 2\r\n    >h-3,-5,@catColor@,ascii\r\n####,\r\n__.-'`•\r\n`. ###)\r\nasciiend\r\n:?time % 114 < 3 * 36\r\n  >h-2,-5,@catColor@,ascii\r\n####,\r\n-.-´'\\\r\n\\ ###)\r\nasciiend\r\n:?time % 114 < 3 * 37\r\n  >h-3,-5,@catColor@,ascii\r\n######,\r\n__.-'´|\r\n`. ###)\r\nasciiend\r\n:?time % 114 < 3 * 38\r\n  >h-2,-5,@catColor@,ascii\r\n####,\r\n-.-´'\\\r\n\\ ###)\r\nasciiend\r\n?face = ＂°°＂\r\n  >h0,-3,@catColor@,ascii\r\n•w'\r\nasciiend\r\n  ?time % 6 < 3 * 1\r\n    >h-1,-5,ascii\r\n#####/.\r\n#####´-\r\n'\r\nasciiend\r\n  :?time % 6 < 3 * 2\r\n    >h-1,-5,ascii\r\n#####,´\r\n######——\r\n＂\r\nasciiend\r\n:?face = ＂^^＂\r\n  ?time % 8 < 4 * 1\r\n    >h0,-3,@catColor@,ascii\r\n^ω´\r\nasciiend\r\n  :?time % 8 < 4 * 2\r\n    >h0,-3,@catColor@,ascii\r\n^W´\r\nasciiend\r\n  ?time % 8 < 4 * 1\r\n    >h5,-5,ascii\r\n/.\r\n´-\r\nasciiend\r\n  :?time % 8 < 4 * 2\r\n    >h4,-5,ascii\r\n,´\r\n ——\r\nasciiend\r\n:?time % 114 < 3 * 36\r\n  >h0,-3,@catColor@,ascii\r\noω°\r\nasciiend\r\n:?time % 114 < 3 * 38\r\n  >h0,-3,@catColor@,ascii\r\n-ω´\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/Enchanthead.txt" - Parse error: Failed to parse completely. Remaining: "?AnimCycle = (FrameDuration*46)+1\r\n AnimCycle = 0\r\nvar EnchantColor = #rainbow\r\n\r\n>h-2,-1,#353535,ascii\r\n#.-.\r\n(###)\r\n#`.´\r\nasciiend\r\n?AnimCycle <= FrameDuration*1\r\n >h-1,0,@EnchantColor@,(_ #\r\n:?AnimCycle <= FrameDuration*2\r\n  >h-1,0,@EnchantColor@,(¯ #\r\n:?AnimCycle <= FrameDuration*3\r\n  >h-1,0,@EnchantColor@,´¯`\r\n:?AnimCycle <= FrameDuration*4\r\n  >h-1,0,@EnchantColor@, ¯)\r\n:?AnimCycle <= FrameDuration*5\r\n  >h-1,0,@EnchantColor@, _)\r\n:?AnimCycle <= FrameDuration*6\r\n  >h-1,0,@EnchantColor@,._.\r\n:?AnimCycle <= FrameDuration*7\r\n  >h-1,0,@EnchantColor@,(_ #\r\n:?AnimCycle <= FrameDuration*8\r\n  >h-1,0,@EnchantColor@,(¯ #\r\n:?AnimCycle <= FrameDuration*9\r\n  >h-1,0,@EnchantColor@,´¯`\r\n:?AnimCycle <= FrameDuration*10\r\n  >h-1,0,@EnchantColor@, ¯:\r\n:?AnimCycle <= FrameDuration*11\r\n  >h-1,0,@EnchantColor@, '¡\r\n:?AnimCycle <= FrameDuration*12\r\n  >h-1,0,@EnchantColor@, .:\r\n:?AnimCycle <= FrameDuration*13\r\n  >h-1,0,@EnchantColor@,._.\r\n:?AnimCycle <= FrameDuration*14\r\n  >h-1,0,@EnchantColor@,:_ #\r\n:?AnimCycle <= FrameDuration*15\r\n  >h-1,0,@EnchantColor@,!. #\r\n:?AnimCycle <= FrameDuration*16\r\n  >h-1,0,@EnchantColor@,:' #\r\n:?AnimCycle <= FrameDuration*17\r\n  >h-1,0,@EnchantColor@,´¯`\r\n:?AnimCycle <= FrameDuration*18\r\n  >h-1,0,@EnchantColor@, ¯:\r\n:?AnimCycle <= FrameDuration*19\r\n  >h-1,0,@EnchantColor@, '¡\r\n:?AnimCycle <= FrameDuration*20\r\n  >h-1,0,@EnchantColor@, .:\r\n:?AnimCycle <= FrameDuration*21\r\n  >h-1,0,@EnchantColor@,._.\r\n:?AnimCycle <= FrameDuration*22\r\n  >h-1,0,@EnchantColor@,(_ #\r\n:?AnimCycle <= FrameDuration*23\r\n  >h-1,0,@EnchantColor@,(¯ #\r\n:?AnimCycle <= FrameDuration*24\r\n  >h-1,0,@EnchantColor@,´¯`\r\n:?AnimCycle <= FrameDuration*25\r\n  >h-1,0,@EnchantColor@, ¯)\r\n:?AnimCycle <= FrameDuration*26\r\n  >h-1,0,@EnchantColor@, .)\r\n:?AnimCycle <= FrameDuration*27\r\n  >h-1,0,@EnchantColor@, ¡,\r\n:?AnimCycle <= FrameDuration*28\r\n  >h-1,0,@EnchantColor@,´! #\r\n:?AnimCycle <= FrameDuration*29\r\n  >h-1,0,@EnchantColor@,(` #\r\n:?AnimCycle <= FrameDuration*30\r\n  >h-1,0,@EnchantColor@,(_ #\r\n:?AnimCycle <= FrameDuration*31\r\n  >h-1,0,@EnchantColor@,._.\r\n:?AnimCycle <= FrameDuration*32\r\n  >h-1,0,@EnchantColor@, _)\r\n:?AnimCycle <= FrameDuration*33\r\n  >h-1,0,@EnchantColor@, ¯)\r\n:?AnimCycle <= FrameDuration*34\r\n  >h-1,0,@EnchantColor@,(¯ #\r\n:?AnimCycle <= FrameDuration*35\r\n  >h-1,0,@EnchantColor@,(_ #\r\n:?AnimCycle <= FrameDuration*36\r\n  >h-1,0,@EnchantColor@,._.\r\n:?AnimCycle <= FrameDuration*37\r\n  >h-1,0,@EnchantColor@, _)\r\n:?AnimCycle <= FrameDuration*38\r\n  >h-1,0,@EnchantColor@, ¯)\r\n:?AnimCycle <= FrameDuration*39\r\n  >h-1,0,@EnchantColor@,´¯`\r\n:?AnimCycle <= FrameDuration*40\r\n  >h-1,0,@EnchantColor@,(¯ #\r\n:?AnimCycle <= FrameDuration*41\r\n  >h-1,0,@EnchantColor@,(, #\r\n:?AnimCycle <= FrameDuration*42\r\n  >h-1,0,@EnchantColor@,.¡ #\r\n:?AnimCycle <= FrameDuration*43\r\n  >h-1,0,@EnchantColor@, !`\r\n:?AnimCycle <= FrameDuration*44\r\n  >h-1,0,@EnchantColor@, ´)\r\n:?AnimCycle <= FrameDuration*45\r\n  >h-1,0,@EnchantColor@, _)\r\n:?AnimCycle <= FrameDuration*46\r\n  >h-1,0,@EnchantColor@,._."
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/HrimnirHair.txt" - Parse error: Failed to parse completely. Remaining: "?HP < (maxHP / 2)\r\n    HairFrame = -1\r\n    >h-4,-3,#FFFFFF,ascii\r\n########\r\n###)`''(\r\n##(. _-`\r\nasciiend\r\n\r\n  ?HairFrame >= 0 & HairFrame < 2\r\n    >h-4,-3,#FFFFFF,ascii\r\n#####.-\r\n###_/(\r\n##(. _)\r\nasciiend\r\n\r\n  ?(HairFrame > 1 & HairFrame <= 3) | (HairFrame > 9 & HairFrame <= 11)\r\n    >h-4,-3,#FFFFFF,ascii\r\n####.-\r\n###_)\\\r\n##(. _)\r\nasciiend\r\n\r\n  ?(HairFrame > 3 & HairFrame <= 5) | (HairFrame > 7 & HairFrame <= 9)\r\n    >h-4,-3,#FFFFFF,ascii\r\n####(\r\n###_)\\\r\n##(. _)\r\nasciiend\r\n\r\n  ?(HairFrame > 5 & HairFrame <= 7)\r\n    >h-4,-3,#FFFFFF,ascii\r\n#####\\\r\n###__/)\r\n##(. _/\r\nasciiend\r\nHairFrame++\r\n\r\n?HairFrame = 12\r\n  HairFrame = 0"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/Helmet.txt" - Parse error: Failed to parse completely. Remaining: "= #EE8113 //Color of the Helmet\r\nvar ShowHelmet = True //Shows/Hides the Helmet\r\nvar ShowBanner = True //Show/Hide Custom Banner\r\n\r\n// ₪ Main Code ₪\r\n/*\r\n?loc_ = ＂Caves of Fear＂\r\n  ?locbegin & ShowBanner = True\r\n    ui.ShowBanner(·•♦◀▶♦•·,Caving the Fear)\r\n  ?!bighead & ShowHelmet = True\r\n    >h-1,0,@HelmetColor@,ascii\r\n#_\r\n'#°\r\nasciiend\r\n  :?bighead & ShowHelmet = True\r\n    >h-2,-2,@HelmetColor@,ascii\r\n .¬. \r\n╧══◙╧\r\nasciiend\r\n*/\r\n\r\n?bighead\r\n    >h-2,-2,@HelmetColor@,ascii\r\n .¬. \r\n╧══◙╧\r\nasciiend\r\n:\r\n  >h-1,0,@HelmetColor@,ascii\r\n#_\r\n'#°\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Weapons/PsyCrusher.txt" - Parse error: Failed to parse completely. Remaining: "?base.T%12<=6&\r\n^base.T%12>3|\r\n^base.T%12>9\r\n HevHamSway=0\r\n?base.T%12<=9&\r\n^base.T%12>6\r\n HevHamSway=-1\r\n\r\n?base.T%20<=5\r\n HevHamSc1=＂［  | ］＂\r\n HevHamSc2=＂│`   │＂\r\n?base.T%20<=10&\r\n^base.T%20>5\r\n HevHamSc1=＂［ |  ］＂\r\n HevHamSc2=＂│   `│＂\r\n?base.T%20<=15&\r\n^base.T%20>10\r\n HevHamSc1=＂［|   ］＂\r\n HevHamSc2=＂│  ` │＂\r\n?base.T%20>15\r\n HevHamSc1=＂［   |］＂\r\n HevHamSc2=＂│ `  │＂\r\n\r\n?base.FD<10\r\n HevHamX=base.FD\r\n:?!ai.walking\r\n HevHamX=10\r\n:\r\n HevHamX=10+HevHamSway\r\n?base.IR=Heavy_Hammer&\r\n^base.IRS=1\r\n HevHamY=-8\r\n >o-1,1,#white,ascii\r\n(#/\r\nasciiend\r\n?base.IR=Heavy_Hammer&\r\n^base.IRS=2&\r\n^base.IRT<=3\r\n HevHamY=-9\r\n?base.IR=Heavy_Hammer&\r\n^base.IRS=2&\r\n^base.IRT>3\r\n HevHamY=-10\r\n?base.IR=Heavy_Hammer&\r\n^base.IRS=3&\r\n^base.IRT<=3\r\n HevHamY=-2\r\n?base.IR=Heavy_Hammer&\r\n^base.IRS=3&\r\n^base.IRT>3&\r\n^base.IRT<=5\r\n HevHamY=-4\r\n?base.IR=Heavy_Hammer&\r\n^base.IRS=3&\r\n^base.IRT>5\r\n HevHamY=-6\r\n\r\n?base.IR=Heavy_Hammer&\r\n^base.IRS=2\r\n >o-1,1,#white,ascii\r\n\\#)\r\nasciiend\r\n\r\n?base.IR=Heavy_Hammer&\r\n^base.IRS=3\r\n >o0,2,#white,ascii\r\n\\\\\r\nasciiend\r\n\r\n?base.IR=Heavy_Hammer&\r\n^base.IRS=4&\r\n^base.IRT<=3\r\n >o-1,2,#white,ascii\r\n/#)\r\nasciiend\r\n\r\n?base.IR=Heavy_Hammer&\r\n^base.IRS=4&\r\n^base.IRT>3\r\n >o-1,2,#white,ascii\r\n¯#¯\r\nasciiend\r\n\r\n?base.IR=Heavy_Hammer&\r\n^base.IRS!3|\r\n^base.IR=Heavy_Hammer&\r\n^base.IRS=3&\r\n^base.IRT>3\r\n >o@HevHamX@,@HevHamY@,@base.ICR@,ascii\r\n______\r\n)    (\r\n│¯¯¯¯│\r\n@HevHamSc2@\r\n|____|\r\n@HevHamSc1@\r\n#¯¯¯¯\r\nasciiend\r\n\r\n?base.IR=Heavy_Hammer&\r\n^base.IRS=3&\r\n^base.IRT<=3\r\n >o@HevHamX-3@,@HevHamY@,@base.ICR@,ascii\r\n###______\r\n###)    (\r\n###│¯¯¯¯│\r\n###@HevHamSc2@\r\n.##|____|##.\r\n#`.@HevHamSc1@.´\r\n####¯¯¯¯\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Weapons/SpellBook.txt" - Parse error: Failed to parse completely. Remaining: "?base.IR=Staff&\r\n^Buffs.string=berserk\r\n base.ICR=#magenta\r\n\r\nvar SIU\r\nvar SID\r\nvar SIL\r\nvar SIR\r\nvar SI2\r\n\r\n?base.IRE=Stone\r\n SIU=¯\r\n SID=_\r\n SIL=＂=＂\r\n SIR=═\r\n SI2=＂*＂\r\n?base.IRE=Poison\r\n SIU=O\r\n SID=o\r\n SIL=O\r\n SIR=o\r\n SI2=•\r\n?base.IRE=Fire\r\n SIU=＂^＂\r\n SID=v\r\n SIL=＂<＂\r\n SIR=＂>＂\r\n SI2=＂-＂\r\n?base.IRE=Ice\r\n SIU=＂+＂\r\n SID=x\r\n SIL=＂+＂\r\n SIR=x\r\n SI2=•\r\n?base.IRE=Aether\r\n SIU='\r\n SID=＂,＂\r\n SIL=＂-＂\r\n SIR=＂-＂\r\n SI2=＂.＂\r\n?base.IRE=Vigor\r\n SIU=＂/＂\r\n SID=＂\\＂\r\n SIL=＂(＂\r\n SIR=＂)＂\r\n SI2=»\r\n\r\n?base.IR=Staff\r\n >o-1,2,#white,ascii\r\nv\r\nasciiend    \r\n?base.IR=Staff&\r\n^base.IRS=1&\r\n^FD>15|\r\n^base.IR=Staff&\r\n^base.IRS!2\r\n >o1,2,#white,ascii\r\n\\\r\nasciiend\r\n\r\n?base.IR=Staff&\r\n^base.IRS!2&\r\n^base.IRT=1\r\n >o1,1,@base.ICR@,ascii\r\n`,\r\nasciiend\r\n\r\n?base.IR=Staff&\r\n^base.IRS!2&\r\n^base.IRT=2\r\n >o2,1,@base.ICR@,ascii\r\n.\r\nasciiend\r\n\r\n?base.IR=Staff&\r\n^base.IRS=1&\r\n^FD<=15\r\n >o1,2,#white,ascii\r\n>\r\nasciiend\r\n\r\n?base.IR=Staff&\r\n^base.IRS=2&\r\n^base.IRT<3\r\n >o1,2,#white,ascii\r\n¯\r\nasciiend\r\n\r\n?base.IR=Staff&\r\n^base.IRS=2&\r\n^base.IRT>=3\r\n >o1,1,#white,ascii\r\n/\r\nasciiend\r\n\r\n?base.IR=Staff\r\n >o-4,1,@base.ICR@,ascii\r\n#_\r\n|@base.IRI@|\r\n#¯\r\nasciiend\r\n\r\n?base.IR=Staff&\r\n^base.IRS=1&\r\n^FD<=15\r\n >o-5,1,@base.ICR@,ascii\r\n@SID@\r\n\r\n@SIU@\r\nasciiend\r\n\r\n?base.IR=Staff&\r\n^base.IRS=2&\r\n^base.IRT<3\r\n >o-6,1,@base.ICR@,ascii\r\n@SID@\r\n\r\n@SIU@\r\nasciiend\r\n\r\n?base.IR=Staff&\r\n^base.IRS=2&\r\n^base.IRT=3\r\n >o-6,1,@base.ICR@,ascii\r\n|\r\n@SIR@\r\n|\r\nasciiend\r\n\r\n?base.IR=Staff&\r\n^base.IRS=2&\r\n^base.IRT>=4&\r\n^base.IRT<6\r\n >o-6,2,@base.ICR@,ascii\r\n@SIR@\r\nasciiend\r\n\r\n?base.IR=Staff&\r\n^base.IRS=2&\r\n^base.IRT>=6&\r\n^base.IRT<8\r\n >o-7,2,@base.ICR@,ascii\r\n@SIL@\r\nasciiend\r\n\r\n?base.IR=Staff&\r\n^base.IRS=2&\r\n^base.IRT>=8&\r\n^base.IRT<9\r\n >o-7,2,@base.ICR@,ascii\r\n@SIR@\r\nasciiend\r\n\r\n?base.IR=Staff&\r\n^base.IRS=2&\r\n^base.IRT=9\r\n >o-6,2,@base.ICR@,ascii\r\n@SIR@\r\nasciiend\r\n\r\n?base.IR=Staff&\r\n^base.IRS=2&\r\n^base.IRT>=10\r\n >o-5,2,@base.ICR@,ascii\r\n@SIR@\r\nasciiend\r\n\r\n?base.IR=Staff&\r\n^base.IRS=3&\r\n^base.IRT=1\r\n >o-5,2,@base.ICR@,ascii\r\n@SI2@\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Weapons/Scythe.txt" - Parse error: Failed to parse completely. Remaining: "?item.right = ＂+1 ＂\r\n SC = #cyan\r\n?item.right = ＂+2 ＂\r\n SC = #yellow\r\n?item.right = ＂+3 ＂\r\n SC = #yellow\r\n?item.right = ＂+4 ＂\r\n SC = #green\r\n?item.right = ＂+5 ＂\r\n SC = #green\r\n?item.right = ＂+6 ＂\r\n SC = #green\r\n?item.right = ＂+7 ＂\r\n SC = #blue\r\n?item.right = ＂+8 ＂\r\n SC = #blue\r\n?item.right = ＂+9 ＂\r\n SC = #blue\r\n?item.right = ＂+10＂\r\n SC = #blue\r\n?item.right = ＂+11＂\r\n SC = #red\r\n?item.right = ＂+12＂\r\n SC = #red\r\n?item.right = ＂+13＂\r\n SC = #red\r\n?item.right = ＂+14＂\r\n SC = #red\r\n?item.right = ＂+15＂\r\n SC = #red\r\n?item.right = ＂+16＂\r\n SC = #rainbow\r\n?item.right = ＂+17＂\r\n SC = #rainbow\r\n?item.right = ＂+18＂\r\n SC = #rainbow\r\n?item.right = ＂+19＂\r\n SC = #rainbow\r\n?item.right = ＂+20＂\r\n SC = #rainbow\r\n?item.right = ＂+21＂\r\n SC = #rainbow\r\n\r\n?item.right= ＂bardiche＂\r\n disable player\r\n?item.right! ＂bardiche＂\r\n enable player\r\n\r\n?item.right= ＂bardiche＂ &\r\n^!ai.walking &\r\n^item.right.state = 1\r\n >o-1,1,#white,ascii\r\n##O\r\n#/´\r\n/#\\\r\nasciiend\r\n\r\n?item.right= ＂bardiche＂ &\r\n^ai.walking &\r\n^time % 15 <= 5 &\r\n^item.right.state=1\r\n >o-1,1,#white,ascii\r\n##O\r\n#/´\r\n/#>\r\nasciiend\r\n\r\n?item.right= ＂bardiche＂ &\r\n^ai.walking &\r\n^time % 15 > 5 &\r\n^time % 15 <= 10 &\r\n^item.right.state=1\r\n >o-1,1,#white,ascii\r\n##O\r\n#/´\r\n#>\\\r\nasciiend\r\n\r\n?item.right= ＂bardiche＂ &\r\n^ai.walking &\r\n^time % 15 > 10 &\r\n^item.right.state=1\r\n >o-1,1,#white,ascii\r\n##O\r\n#/´\r\n#X#\r\nasciiend\r\n\r\n?item.right= ＂bardiche＂ &\r\n^item.right.state=1\r\n >o0,-2,@SC@,ascii\r\n#_╤__\r\n¯-╬-¯¯¯`\r\n##║\r\n##║\r\n##║\r\n##'\r\nasciiend\r\n\r\n?item.right= ＂bardiche＂ &\r\n^item.right.state= 2 |\r\n^item.right= ＂bardiche＂ &\r\n^item.right.state= 4\r\n >o-1,1,#white,ascii\r\nO/\r\n`\\\r\n/#\\\r\nasciiend\r\n\r\n?item.right= ＂bardiche＂ &\r\n^item.right.state=2 |\r\n^item.right= ＂bardiche＂ &\r\n^item.right.state= 4\r\n play blade_pallas_attack\r\n >o-4,-4,@SC@,ascii\r\n###__\r\n#\\//¯¯`\r\n#/X#\r\n'/#\\\r\n####\\\r\n#####\\\r\n######`\r\nasciiend\r\n\r\n?item.right= ＂bardiche＂ &\r\n^item.right.state= 3\r\n >o-1,1,#white,ascii\r\n##O\r\n#/\\\r\n/#\\\r\nasciiend\r\n\r\n?item.right= ＂bardiche＂ &\r\n^item.right.state=3\r\n >o2,2,@SC@,ascii\r\n_____,|_\r\n¯¯¯¯¯T/\r\nasciiend\r\n\r\n?item.right= ＂bardiche＂ &\r\n^item.right.state=3 &\r\n^item.right.time = 1\r\n play bronze_guardian_attack2\r\n\r\n?item.right= ＂bardiche＂ &\r\n^item.right.state= 3\r\n >o5,3,#424242,ascii\r\n###_\r\n¯¯¯¯\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Weapons/MajPack.txt" - Parse error: Failed to parse completely. Remaining: "?base.IRS>1&\r\n^base.IR=Repeating&\r\n^Buffs.string=berserk|\r\n^base.IRS=1&\r\n^Buffs.string=berserk&\r\n^base.IRT=1&\r\n^base.IR=Repeating\r\n play bearer_attack_hit 130\r\n >o2,0,@base.ICR@,ascii\r\n#######################################__,-'¯\\\r\n.,——-——-——-——-——-——-——-——-——-——-——-——-/—-——-`¡\\\r\n'`——-——-——-——-——-——-——-——-——-——-——-——-\\—-——-,!/\r\n#######################################¯¯`-._/\r\nasciiend\r\n\r\n?base.IR=Repeating&\r\n^base.IRS=1&\r\n^base.IRT<3|\r\n^base.IR=Repeating&\r\n^Buffs.string=berseek\r\n >o1,2,#white,ascii\r\n¯\r\nasciiend\r\n\r\n?base.IR=Repeating&\r\n^base.IRS=1&\r\n^base.IRT>=3&\r\n^Buffs.string!berseek\r\n >o1,2,#white,ascii\r\n\\\r\nasciiend\r\n?base.IR=Repeating\r\n >o-1,2,#white,ascii\r\n/\r\nasciiend\r\n?base.IR=Repeating&\r\n^base.IRS=3\r\n >o-1,2,#white,ascii\r\n<\r\nasciiend\r\n\r\n?base.IR=Repeating&\r\n^base.IRS=2|\r\n^base.IR=Repeating&\r\n^base.IRS=4\r\n >o-1,2,#white,ascii\r\n(\r\nasciiend\r\n\r\n?base.IR=Repeating\r\n >o-2,1,@base.ICR@,ascii\r\n#_\r\n［\r\nasciiend\r\n?base.IR=Repeating&\r\n^time%2=1\r\n >o-2,3,@base.ICR@,ascii\r\n'\r\nasciiend\r\n\r\n?base.IR=Repeating&\r\n^time%3>1\r\n >o-2,3,@base.ICR@,ascii\r\n＂\r\nasciiend\r\n\r\n?base.IR=Repeating&\r\n^base.IRS=4&\r\n^Buffs.string!berseek\r\n >o1,2,#white,ascii\r\n)\r\nasciiend\r\n?base.IR=Repeating&\r\n^base.IRS=2&\r\n^base.IRT<2&\r\n^Buffs.string!berseek\r\n >o1,1,#white,ascii\r\n/\r\nasciiend\r\n\r\n?base.IR=Repeating&\r\n^base.IRS=2&\r\n^base.IRT>=2&\r\n^Buffs.string!berseek\r\n >o1,1,#white,ascii\r\n)\r\nasciiend\r\n\r\n?base.IR=Repeating&\r\n^base.IRS=2&\r\n^base.IRT=1\r\n >o0,0,@base.ICR@,ascii\r\n·\r\nasciiend\r\n\r\n?base.IR=Repeating&\r\n^base.IRS=2&\r\n^base.IRT>1\r\n >o0,0,@base.ICR@,ascii\r\n•\r\nasciiend\r\n\r\n?base.IR=Repeating&\r\n^base.IRS=3&\r\n^Buffs.string!berseek\r\n >o1,2,#white,ascii\r\n\\\r\nasciiend\r\n\r\n?base.IR=Repeating&\r\n^base.IRS=3&\r\n^base.IRT=1\r\n >o2,2,@base.ICR@,ascii\r\n*\r\nasciiend\r\n\r\n?base.IR=Repeating&\r\n^base.IRS=3&\r\n^base.IRT=2\r\n >o2,2,@base.ICR@,ascii\r\nO\r\nasciiend\r\n\r\n?base.IR=Repeating&\r\n^base.IRS=3&\r\n^base.IRT=3\r\n >o2,2,@base.ICR@,ascii\r\no\r\nasciiend\r\n\r\n?base.IR=Repeating&\r\n^base.IRS=3&\r\n^base.IRT=4\r\n >o2,2,@base.ICR@,ascii\r\n+\r\nasciiend\r\n\r\n?base.IR=Repeating&\r\n^base.IRS=3&\r\n^base.IRT=5\r\n >o2,2,@base.ICR@,ascii\r\nx\r\nasciiend\r\n\r\n?base.IR=Repeating&\r\n^base.IRS=3&\r\n^base.IRT=6\r\n >o2,2,@base.ICR@,ascii\r\n•\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Weapons/MajVines.txt" - Parse error: Failed to parse completely. Remaining: "?base.IR=Wand&\r\n^Buffs.string=berserk\r\n base.ICR=#00ffa2\r\n?base.IL=Wand&\r\n^Buffs.string=berserk\r\n base.ICL=#00ffa2\r\n\r\n?base.IR=Wand&\r\n^base.IRS=1|\r\n^base.IR=Wand&\r\n^base.IRS>2\r\n >o1,2,#white,ascii\r\n\\\r\nasciiend\r\n\r\n?base.IR=Wand&\r\n^base.IRS=1&\r\n^time%20<=10\r\n >o2,0,@base.ICR@,ascii\r\n@base.IRI@\r\n#)\r\n(\r\n#`\r\nasciiend\r\n?base.IR=Wand&\r\n^base.IRS=1&\r\n^time%20>10\r\n >o2,0,@base.ICR@,ascii\r\n@base.IRI@\r\n#)\r\n(\r\n´\r\nasciiend\r\n?base.IR=Wand&\r\n^base.IRS=2\r\n >o1,1,#white,ascii\r\n/\r\nasciiend\r\n?base.IR=Wand&\r\n^base.IRS=2&\r\n^base.IRT<3\r\n >o1,-1,@base.ICR@,ascii\r\n#@base.IRI@\r\n(\r\n#\\\r\n##'\r\nasciiend\r\n\r\n?base.IR=Wand&\r\n^base.IRS=2&\r\n^base.IRT>3\r\n >o0,-1,@base.ICR@,ascii\r\n@base.IRI@\r\n#\\\r\n##\\\r\n###`\r\nasciiend\r\n\r\n?base.IR=Wand&\r\n^base.IRS=3&\r\n^base.IRT<=1\r\n >o1,0,@base.ICR@,ascii\r\n#@base.IRI@\r\n##)\r\n#/\r\nasciiend\r\n\r\n?base.IR=Wand&\r\n^base.IRS>2&\r\n^base.IRT>1\r\n >o2,2,@base.ICR@,ascii\r\n.___,@base.IRI@\r\nasciiend\r\n\r\n?base.IL=Wand&\r\n^base.ILS=1|\r\n^base.IL=Wand&\r\n^base.ILS>2\r\n >o-1,2,#white,ascii\r\n/\r\nasciiend\r\n?base.IL=Wand&\r\n^base.ILS=1\r\n >o-3,0,@base.ICL@,ascii\r\n#@base.ILI@\r\n(\r\n#)\r\n´\r\nasciiend\r\n?base.IL=Wand&\r\n^base.ILS=2\r\n >o-1,1,#white,ascii\r\n\\\r\nasciiend\r\n?base.IL=Wand&\r\n^base.ILS=2&\r\n^base.ILT<3\r\n >o-4,-1,@base.ICL@,ascii\r\n#@base.ILI@\r\n(\r\n#\\\r\n##'\r\nasciiend\r\n\r\n?base.IL=Wand&\r\n^base.ILS=2&\r\n^base.ILT>3\r\n >o-4,-1,@base.ICL@,ascii\r\n@base.ILI@\r\n#\\\r\n##\\\r\nasciiend\r\n\r\n?base.IL=Wand&\r\n^base.ILS=3&\r\n^base.ILT<=1\r\n >o-1,0,@base.ICL@,ascii\r\n#@base.ILI@\r\n##)\r\n#/\r\nasciiend\r\n?base.IL=Wand&\r\n^base.ILS>2&\r\n^base.ILT>1\r\n >o-2,1,@base.ICL@,ascii\r\n#####@base.ILI@\r\n.__.´\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Weapons/EmbueDaggers.txt" - Parse error: Failed to parse completely. Remaining: "?base.IR=Sword&\r\n^Buffs.string=berserk\r\n base.ICR=#ff3c00\r\n?base.IL=Sword&\r\n^Buffs.string=berserk\r\n base.ICL=#ff3c00\r\n\r\n?base.IR=Sword&\r\n^base.IRS=1\r\n >o1,2,#white,ascii\r\n‾\r\nasciiend\r\n\r\n?base.IR=Sword&\r\n^base.IRS=1\r\n >o2,0,@base.ICR@,ascii\r\n|\\\r\n@base.IRI@´\r\n'\r\nasciiend\r\n\r\n?base.IR=Sword&\r\n^base.IRS=2&\r\n^base.IRT<=7\r\n >o1,2,#white,ascii\r\nv\r\nasciiend\r\n\r\n?base.IR=Sword&\r\n^base.IRS=2&\r\n^base.IRT<=7\r\n >o2,0,@base.ICR@,ascii\r\n|\\\r\n@base.IRI@´\r\n'\r\nasciiend\r\n\r\n?base.IR=Sword&\r\n^base.IRS=2&\r\n^base.IRT<=12&\r\n^base.IRT>7\r\n >o1,1,#white,ascii\r\n/\r\nasciiend\r\n\r\n?base.IR=Sword&\r\n^base.IRS=2&\r\n^base.IRT<=12&\r\n^base.IRT>7\r\n >o2,-1,@base.ICR@,ascii\r\n|\\\r\n@base.IRI@´\r\n'\r\nasciiend\r\n\r\n?base.IR=Sword&\r\n^base.IRS=3&\r\n^base.IRT<=3\r\n >o1,2,#white,ascii\r\n\\\r\nasciiend\r\n\r\n?base.IR=Sword&\r\n^base.IRS=3&\r\n^base.IRT<=3\r\n >o2,1,@base.ICR@,ascii\r\n,\r\n@base.IRI@.\r\n|/\r\n'\r\nasciiend\r\n?base.IR=Sword&\r\n^base.IRS=3&\r\n^base.IRT<=6&\r\n^base.IRT>3\r\n >o1,2,#white,ascii\r\n)\r\nasciiend\r\n?base.IR=Sword&\r\n^base.IRS=3&\r\n^base.IRT<=6&\r\n^base.IRT>3\r\n >o2,2,@base.ICR@,ascii\r\n,\r\n@base.IRI@.\r\n|/\r\n'\r\nasciiend\r\n\r\n?base.IR=Sword&\r\n^base.IRS=3&\r\n^base.IRT<=9&\r\n^base.IRT>6\r\n >o1,2,#white,ascii\r\n\\\r\nasciiend\r\n\r\n?base.IR=Sword&\r\n^base.IRS=3&\r\n^base.IRT<=9&\r\n^base.IRT>6\r\n >o2,1,@base.ICR@,ascii\r\n,\r\n@base.IRI@.\r\n|/\r\n'\r\nasciiend\r\n?base.IR=Sword&\r\n^base.IRS=4\r\n >o1,2,#white,ascii\r\nv\r\nasciiend\r\n\r\n?base.IR=Sword&\r\n^base.IRS=4\r\n >o2,2,@base.ICR@,ascii\r\n@base.IRI@—\r\nasciiend\r\n\r\n?base.IL=Sword&\r\n^base.ILS=1\r\n >o-1,2,#white,ascii\r\n‾\r\nasciiend\r\n?base.IL=Sword&\r\n^base.ILS=1\r\n >o-2,0,@base.ICL@,ascii\r\n|\\\r\n@base.ILI@´\r\n'\r\nasciiend\r\n\r\n?base.IL=Sword&\r\n^base.ILS=2&\r\n^base.ILT<=7\r\n >o-1,2,#white,ascii\r\nv\r\nasciiend\r\n\r\n?base.IL=Sword&\r\n^base.ILS=2&\r\n^base.ILT<=7\r\n >o-2,0,@base.ICL@,ascii\r\n|\\\r\n@base.ILI@´\r\n'\r\nasciiend\r\n\r\n?base.IL=Sword&\r\n^base.ILS=2&\r\n^base.ILT<=12&\r\n^base.ILT>7\r\n >o-1,1,#white,ascii\r\n\\\r\nasciiend\r\n\r\n?base.IL=Sword&\r\n^base.ILS=2&\r\n^base.ILT<=12&\r\n^base.ILT>7\r\n >o-2:-1,@base.ICL@,ascii\r\n|\\\r\n@base.ILI@´\r\n'\r\nasciiend\r\n\r\n?base.IL=Sword&\r\n^base.ILS=3&\r\n^base.ILT<=3\r\n >o-1,2,#white,ascii\r\n/\r\nasciiend\r\n\r\n?base.IL=Sword&\r\n^base.ILS=3&\r\n^base.ILT<=3\r\n >o-2,1,@base.ICL@,ascii\r\n,\r\n@base.ILI@.\r\n|/\r\n'\r\nasciiend\r\n\r\n?base.IL=Sword&\r\n^base.ILS=3&\r\n^base.ILT<=6&\r\n^base.ILT>3\r\n >o-1,2,#white,ascii\r\n(\r\nasciiend\r\n\r\n?base.IL=Sword&\r\n^base.ILS=3&\r\n^base.ILT<=6&\r\n^base.ILT>3\r\n >o-2:2,@base.ICL@,ascii\r\n,\r\n@base.ILI@.\r\n|/\r\n'\r\nasciiend\r\n\r\n?base.IL=Sword&\r\n^base.ILS=3&\r\n^base.ILT<=9&\r\n^base.ILT>6\r\n >o-1,-1,#white,ascii\r\n/\r\nasciiend\r\n\r\n?base.IL=Sword&\r\n^base.ILS=3&\r\n^base.ILT<=9&\r\n^base.ILT>6\r\n >o-2,1,@base.ICL@,ascii\r\n,\r\n@base.ILI@.\r\n|/\r\n'\r\nasciiend\r\n\r\n?base.IL=Sword&\r\n^base.ILS=4\r\n >o-1,2,#white,ascii\r\nv\r\nasciiend\r\n\r\n?base.IL=Sword&\r\n^base.ILS=4\r\n >o-2,2,@base.ICL@,ascii\r\n@base.ILI@—\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Weapons/RootBats.txt" - Parse error: Failed to parse completely. Remaining: "HE=＂=＂\r\n?base.ILS=1\r\n HEL=V\r\n?base.IRS=1\r\n HE=base.IRI\r\n?base.ILS=1\r\n HEL=base.ILI\r\n?base.IRS=2|\r\n^base.ITS=3\r\n HE=V\r\n?base.IRS=2|\r\n^base.ITS=3\r\n HEL=V\r\n\r\n?base.IR=＂Hammer＂&base.IR!Heavy\r\n >o1,2,#white,ascii\r\n\\\r\nasciiend\r\n\r\n?base.IR=＂Hammer＂&base.IR!Heavy&\r\n^foe.state>=32|\r\n^base.IR=＂Hammer＂&base.IR!Heavy&\r\n^foe.state=4\r\n >o1,2,#white,ascii\r\n(\r\nasciiend\r\n?base.IR=＂Hammer＂&base.IR!Heavy&\r\n^foe.state=33\r\n >o1,2,#white,ascii\r\nV\r\nasciiend\r\n\r\n?base.IR=＂Hammer＂&base.IR!Heavy&\r\n^base.T%20<=4\r\n >o1,-1,@ICR@,ascii\r\n(¯\\_/¯)\r\n##(@HE@)\r\n###¯\r\nasciiend\r\n?base.IR=＂Hammer＂&base.IR!Heavy&\r\n^base.T%20>4&\r\n^base.T%20<=8\r\n >o1,-2,@ICR@,ascii\r\n.—.###.—.\r\n###\\_/\r\n###(@HE@)\r\n####¯\r\nasciiend\r\n\r\n?base.IR=＂Hammer＂&base.IR!Heavy&\r\n^base.T%20>8&\r\n^base.T%20<=12\r\n >o1,-2,@ICR@,ascii\r\n.#####.\r\n#\\###/\r\n##\\_/\r\n##(@HE@)\r\n###¯\r\nasciiend\r\n\r\n?base.IR=＂Hammer＂&base.IR!Heavy&\r\n^base.T%20=13\r\n play bat_wing\r\n\r\n?base.IR=＂Hammer＂&base.IR!Heavy&\r\n^base.T%20>12&\r\n^base.T%20<=16\r\n >o1,-2,@ICR@,ascii\r\n###_\r\n##/@HE@\\\r\n#(#¯#)\r\n##`#´\r\nasciiend\r\n\r\n?base.IR=＂Hammer＂&base.IR!Heavy&\r\n^base.T%20>16\r\n >o1,-2,@ICR@,ascii\r\n###_\r\n.—´@HE@`—.\r\n`##¯##´\r\nasciiend\r\n?base.IR=＂Hammer＂&base.IR!Heavy&\r\n^base.IRS=3&\r\n^base.IRT=3\r\n >o@1+base.FD@,3,@ICR@,ascii\r\n##.^.\r\n.—´¯`—.\r\nasciiend\r\n\r\n?base.IR=＂Hammer＂&base.IR!Heavy&\r\n^foe.state!33\r\n >o-1,2,#white,ascii\r\n/\r\nasciiend\r\n\r\n?base.IR=＂Hammer＂&base.IR!Heavy&\r\n^foe.state>=32&\r\n^foe.state!33|\r\n^base.IR=＂Hammer＂&base.IR!Heavy&\r\n^foe.state=4\r\n >o-1,2,#white,ascii\r\n(\r\nasciiend\r\n\r\n?base.IR=＂Hammer＂&base.IR!Heavy&\r\n^foe.state=33\r\n >o0,2,#white,ascii\r\nV\r\nasciiend\r\n?base.IL=＂Hammer＂&base.IL!Heavy&\r\n^base.T%20<=4\r\n >o-8,-1,@ICL@,ascii\r\n(¯\\_/¯)\r\n##(@HEL@)\r\n###¯\r\nasciiend\r\n?base.IL=＂Hammer＂&base.IL!Heavy&\r\n^base.T%20>4&\r\n^base.T%20<=8\r\n >o-8,-2,@ICL@,ascii\r\n.—.###.—.\r\n###\\_/\r\n###(@HEL@)\r\n####¯\r\nasciiend\r\n?base.IL=＂Hammer＂&base.IL!Heavy&\r\n^base.T%20>8&\r\n^base.T%20<=12\r\n >o-8,-2,@ICL@,ascii\r\n.#####.\r\n#\\###/\r\n##\\_/\r\n##(@HEL@)\r\n###¯\r\nasciiend\r\n?base.IL=＂Hammer＂&base.IL!Heavy&\r\n^base.T%20=13\r\n play bat_wing\r\n\r\n?base.IL=＂Hammer＂&base.IL!Heavy&\r\n^base.T%20>12&\r\n^base.T%20<=16\r\n >o-8,-2,@ICL@,ascii\r\n###_\r\n##/@HEL@\\\r\n#(#¯#)\r\n##`#´\r\nasciiend\r\n?base.IL=＂Hammer＂&base.IL!Heavy&\r\n^base.T%20>16\r\n >o-8,-2,@ICL@,ascii\r\n###_\r\n.—´@HEL@`—.\r\n`##¯##´\r\nasciiend\r\n?base.IL=＂Hammer＂&base.IL!Heavy&\r\n^base.ILS=2&\r\n^base.ILT=1|\r\n^base.IL=＂Hammer＂&base.IL!Heavy&\r\n^base.ILS=3&\r\n^base.ILT=6\r\n >o@4+base.FD@,3,@ICL@,ascii\r\n_\r\nasciiend\r\n\r\n?base.IL=＂Hammer＂&base.IL!Heavy&\r\n^base.ILS=2&\r\n^base.ILT=2|\r\n^base.IL=＂Hammer＂&base.IL!Heavy&\r\n^base.ILS=3&\r\n^base.ILT=5\r\n >o@3+base.FD@,3,@ICL@,ascii\r\n.—.\r\nasciiend\r\n\r\n?base.IL=＂Hammer＂&base.IL!Heavy&\r\n^base.ILS=2&\r\n^base.ILT>3|\r\n^base.IL=＂Hammer＂&base.IL!Heavy&\r\n^base.ILS=3&\r\n^base.ILT=4\r\n >o@1+base.FD@,3,@ICL@,ascii\r\n.—´¯`—.\r\nasciiend\r\n\r\n?base.IL=＂Hammer＂&base.IL!Heavy&\r\n^base.ILS=3&\r\n^base.ILT=1\r\n >o@1+base.FD@,-1,@ICL@,ascii\r\n##.^.\r\n##| |\r\n##| |\r\n##|||\r\n.—´¯`—.\r\nasciiend\r\n\r\n?base.IL=＂Hammer＂&base.IL!Heavy&\r\n^base.ILS=3&\r\n^base.ILT=2\r\n >o@1+base.FD@,0,@ICL@,ascii\r\n##.^.\r\n##| |\r\n##|||\r\n.—´¯`—.\r\nasciiend\r\n?base.IL=＂Hammer＂&base.IL!Heavy&\r\n^base.ILS=3&\r\n^base.ILT=3\r\n >o@1+base.FD@,2,@ICL@,ascii\r\n##.^.\r\n.—´¯`—.\r\nasciiend\r\n\r\n?base.IR=＂Hammer＂&base.IR!Heavy&\r\n^base.IRS=2&\r\n^base.IRT=1|\r\n^base.IR=＂Hammer＂&base.IR!Heavy&\r\n^base.IRS=3&\r\n^base.IRT=6\r\n >o@4+base.FD@,4,@ICR@,ascii\r\n_\r\nasciiend\r\n\r\n?base.IR=＂Hammer＂&base.IR!Heavy&\r\n^base.IRS=2&\r\n^base.IRT=2|\r\n^base.IR=＂Hammer＂&base.IR!Heavy&\r\n^base.IRS=3&\r\n^base.IRT=5\r\n >o@3+base.FD@,4,@ICR@,ascii\r\n.—.\r\nasciiend\r\n\r\n?base.IR=＂Hammer＂&base.IR!Heavy&\r\n^base.IRS=2&\r\n^base.IRT>3|\r\n^base.IR=＂Hammer＂&base.IR!Heavy&\r\n^base.IRS=3&\r\n^base.IRT=4\r\n >o@1+base.FD@,4,@ICR@,ascii\r\n.—´¯`—.\r\nasciiend\r\n\r\n?base.IR=＂Hammer＂&base.IR!Heavy&\r\n^base.IRS=3&\r\n^base.IRT=1\r\n >o@1+base.FD@,0,@ICR@,ascii\r\n##.^.\r\n##| |\r\n##| |\r\n##|||\r\n.—´¯`—.\r\nasciiend\r\n?base.IR=＂Hammer＂&base.IR!Heavy&\r\n^base.IRS=3&\r\n^base.IRT=2\r\n >o@1+base.FD@,1,@ICR@,ascii\r\n##.^.\r\n##| |\r\n##|||\r\n.—´¯`—.\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Weapons/LanternTalisman.txt" - Parse error: Failed to parse completely. Remaining: "?item.left = ＂golden＂\r\n    >o-3,1,#FFCC66,@lanterntalisman@\r\n  :?item.left = ＂+0＂\r\n    >o-3,1,#white,@lanterntalisman@\r\n  :?item.left = ＂+1＂\r\n    >o-3,1,#cyan,@lanterntalisman@\r\n  :?item.left = ＂+2＂ | item.left = ＂+3＂\r\n    >o-3,1,#yellow,@lanterntalisman@\r\n  :?item.left = ＂+4＂ | item.left = ＂+5＂ |\r\n  ^item.left = ＂+6＂\r\n    >o-3,1,#green,@lanterntalisman@\r\n  :?item.left = ＂+7＂ | item.left = ＂+8＂ |\r\n  ^item.left = ＂+9＂ | item.left = ＂+10＂\r\n    >o-3,1,#blue,@lanterntalisman@\r\n  :?item.left = ＂+11＂ | item.left = ＂+12＂ |\r\n  ^item.left = ＂+13＂ | item.left = ＂+14＂ |\r\n  ^item.left = ＂+15＂\r\n    >o-3,1,#red,@lanterntalisman@\r\n  :\r\n    >o-3,1,#rainFF,@lanterntalisman@\r\n  ?item.left.state ! 1\r\n    >o-2,2,#FFCC99,φ\r\n:?item.right = fire_talisman\r\n  ?item.right = ＂golden＂\r\n    >o1,1,#FFCC66,@lanterntalisman@\r\n  :?item.right = ＂+0＂\r\n    >o1,1,#white,@lanterntalisman@\r\n  :?item.right = ＂+1＂\r\n    >o1,1,#cyan,@lanterntalisman@\r\n  :?item.right = ＂+2＂ | item.right = ＂+3＂\r\n    >o1,1,#yellow,@lanterntalisman@\r\n  :?item.right = ＂+4＂ | item.right = ＂+5＂ |\r\n  ^item.right = ＂+6＂\r\n    >o1,1,#green,@lanterntalisman@\r\n  :?item.right = ＂+7＂ | item.right = ＂+8＂ |\r\n  ^item.right = ＂+9＂ | item.right = ＂+10＂\r\n    >o1,1,#blue,@lanterntalisman@\r\n  :?item.right = ＂+11＂ | item.right = ＂+12＂ |\r\n  ^item.right = ＂+13＂ | item.right = ＂+14＂ |\r\n  ^item.right = ＂+15＂\r\n    >o1,1,#red,@lanterntalisman@\r\n  :\r\n    >o1,1,#rainFF,@lanterntalisman@\r\n  ?item.right.state ! 1\r\n    >o2,2,#FFCC99,φ"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Weapons/ShockwaveWhip.txt" - Parse error: Failed to parse completely. Remaining: "?base.IR=\"crossbow_\"&\r\n^Buffs.string=berserk\r\n base.ICR=#47312b\r\n?base.IL=\"crossbow_\"&\r\n^Buffs.string=berserk\r\n base.ICL=#47312b\r\n\r\n?base.IR=\"crossbow_\"&\r\n^base.IRS=1\r\n >o1,2,#white,ascii\r\n\\\r\nasciiend\r\n\r\n?base.IR=\"crossbow_\"&\r\n^base.IRS=1\r\n >o-3,3,@base.ICR@,ascii\r\n___.´\r\nasciiend\r\n\r\n?base.IR=\"crossbow_\"&\r\n^base.IRS=2&\r\n^base.IRT<3\r\n >o1,2,#white,ascii\r\n)\r\nasciiend\r\n\r\n?base.IR=\"crossbow_\"&\r\n^base.IRS=2&\r\n^base.IRT<3\r\n >o0,3,@base.ICR@,ascii\r\n_|\r\nasciiend\r\n\r\n?base.IR=\"crossbow_\"&\r\n^base.IRS=2&\r\n^base.IRT>=3\r\n >o1,2,#white,ascii\r\n\\\r\nasciiend\r\n\r\n?base.IR=\"crossbow_\"&\r\n^base.IRS=2&\r\n^base.IRT>=3\r\n >o2,3,@base.ICR@,ascii\r\n`.___\r\nasciiend\r\n\r\n?base.IR=\"crossbow_\"&\r\n^base.IRS=3\r\n >o1,1,#white,ascii\r\n/\r\nasciiend\r\n\r\n?base.IR=\"crossbow_\"&\r\n^base.IRS=3&\r\n^base.IRT=1&\r\n^foe.distance>=5\r\n play controller_whip_attack\r\n\r\n?base.IR=\"crossbow_\"&\r\n^base.IRS=3&\r\n^base.IRT=1&\r\n^foe.distance<5&\r\n^Buffs.string!berserk\r\n play controller_whip_hit\r\n?base.IR=\"crossbow_\"&\r\n^base.IRS=3&\r\n^base.IRT=1&\r\n^foe.distance<5&\r\n^Buffs.string=berserk\r\n play bomb_cart_explosion\r\n\r\n?base.IR=\"crossbow_\"&\r\n^base.IRS=3&\r\n^base.IRT=1\r\n >o2,0,@base.ICR@,ascii\r\n,.\r\n##|\r\n##´\r\nasciiend\r\n\r\n?base.IR=\"crossbow_\"&\r\n^base.IRS=3&\r\n^base.IRT=2\r\n >o2,0,@base.ICR@,ascii\r\n,´¯\\\r\nasciiend\r\n\r\n?base.IR=\"crossbow_\"&\r\n^base.IRS=3&\r\n^base.IRT>3\r\n >o2,-2,@base.ICR@,ascii\r\n###)\r\n##/\r\n.´\r\nasciiend\r\n?base.IR=\"crossbow_\"&\r\n^base.IRS=4&\r\n^base.IRT<3\r\n >o1,1,#white,ascii\r\n)\r\nasciiend\r\n\r\n?base.IR=\"crossbow_\"&\r\n^base.IRS=4&\r\n^base.IRT<3\r\n >o-2,0,@base.ICR@,ascii\r\n.´`.\r\n|\r\nasciiend\r\n?base.IR=\"crossbow_\"&\r\n^base.IRS=4&\r\n^base.IRT>=3\r\n >o1,2,#white,ascii\r\n`\r\nasciiend\r\n\r\n?base.IR=\"crossbow_\"&\r\n^base.IRS=4&\r\n^base.IRT>=3\r\n >o-4,2,@base.ICR@,ascii\r\n.´¯¯\r\n|\r\nasciiend\r\n?base.IL=\"crossbow_\"&\r\n^base.ILS=1\r\n >o-1,2,#white,ascii\r\n/\r\nasciiend\r\n\r\n?base.IL=\"crossbow_\"&\r\n^base.ILS=1\r\n >o-6,3,@base.ICL@,ascii\r\n___.´\r\nasciiend\r\n\r\n?base.IL=\"crossbow_\"&\r\n^base.ILS=2&\r\n^base.ILT<3\r\n >o-1,2,#white,ascii\r\n)\r\nasciiend\r\n\r\n?base.IL=\"crossbow_\"&\r\n^base.ILS=2&\r\n^base.ILT<3\r\n >o-3,3,@base.ICL@,ascii\r\n_|\r\nasciiend\r\n\r\n?base.IL=\"crossbow_\"&\r\n^base.ILS=2&\r\n^base.ILT>=3\r\n >o-1,2,#white,ascii\r\n/\r\nasciiend\r\n\r\n?base.IL=\"crossbow_\"&\r\n^base.ILS=2&\r\n^base.ILT>=3\r\n >o-1,3,@base.ICL@,ascii\r\n`.___\r\nasciiend\r\n\r\n?base.IL=\"crossbow_\"&\r\n^base.ILS=3\r\n >o-1,1,#white,ascii\r\n/\r\nasciiend\r\n\r\n?base.IL=\"crossbow_\"&\r\n^base.ILS=3&\r\n^base.ILT=1&\r\n^foe.distance>=5\r\n play controller_whip_attack\r\n\r\n?base.IL=\"crossbow_\"&\r\n^base.ILS=3&\r\n^base.ILT=1&\r\n^foe.distance<5\r\n play controller_whip_hit\r\n\r\n?base.IL=\"crossbow_\"&\r\n^base.ILS=3&\r\n^base.ILT=1\r\n >o-1,0,@base.ICL@,ascii\r\n,.\r\n##|\r\n##´\r\nasciiend\r\n\r\n?base.IL=\"crossbow_\"&\r\n^base.ILS=3&\r\n^base.ILT=2\r\n >o-1,0,@base.ICL@,ascii\r\n,´¯\\\r\nasciiend\r\n\r\n?base.IL=\"crossbow_\"&\r\n^base.ILS=3&\r\n^base.ILT>3\r\n >o-1,-2,@base.ICL@,ascii\r\n###)\r\n##/\r\n.´\r\nasciiend\r\n\r\n?base.IL=\"crossbow_\"&\r\n^base.ILS=4&\r\n^base.ILT<3\r\n >o-1,1,#white,ascii\r\n)\r\nasciiend\r\n\r\n?base.IL=\"crossbow_\"&\r\n^base.ILS=4&\r\n^base.ILT<3\r\n >o-5,0,@base.ICL@,ascii\r\n.´`.\r\n|\r\nasciiend\r\n\r\n?base.IL=\"crossbow_\"&\r\n^base.ILS=4&\r\n^base.ILT>=3\r\n >o-1,2,#white,ascii\r\n`\r\nasciiend\r\n\r\n?base.IL=\"crossbow_\"&\r\n^base.ILS=4&\r\n^base.ILT>=3\r\n >o-5,2,@base.ICL@,ascii\r\n.´¯¯\r\n|\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Weapons/RecoilKick.txt" - Parse error: Failed to parse completely. Remaining: "?ai.walking&\r\n^base.T%5=1&\r\n^base.IR=Bardiche\r\n play blade_drag 75\r\n >o-4,3,#bdbdbd,ascii\r\n.\r\nasciiend\r\n\r\n?ai.walking&\r\n^base.T%5=2&\r\n^base.IR=Bardiche\r\n >o-4,3,#999999,ascii\r\n`\r\nasciiend\r\n\r\n?ai.walking&\r\n^base.T%5=3&\r\n^base.IR=Bardiche\r\n >o-4,3,#808080,ascii\r\n´\r\nasciiend\r\n\r\n?ai.walking&\r\n^base.T%5=4&\r\n^base.IR=Bardiche\r\n >o-4,3,#6b6b6b,ascii\r\n,\r\nasciiend\r\n\r\n?base.IR=Bardiche&\r\n^base.T%2=1\r\n >o-3,3,@base.ICR@,ascii\r\nʘ__\r\nasciiend\r\n?base.IR=Bardiche&\r\n^base.T%2=0\r\n >o-3,3,@base.ICR@,ascii\r\nʘ__\r\nasciiend\r\n?ai.walking &\r\n^base.IR=Bardiche&\r\n^time % 15 > 5 &\r\n^time % 15 <= 10&\r\n^base.T%2=1\r\n >o-3,3,@base.ICR@,ascii\r\nʘ_,\r\nasciiend\r\n?ai.walking &\r\n^base.IR=Bardiche&\r\n^time % 15 > 5 &\r\n^time % 15 <= 10&\r\n^base.T%2=0\r\n >o-3,3,@base.ICR@,ascii\r\nʘ_,\r\nasciiend\r\n\r\n?base.IR=Bardiche\r\n Idl=N\r\n\r\nvar BStompX\r\nvar BStompY\r\n?base.T=1\r\n BStompX=0\r\n BStompY=0\r\n\r\n?base.IR=Bardiche&\r\n^base.IRS=1\r\n >o0,1,#white,ascii\r\n#O\r\n/|\r\nasciiend\r\n\r\n?base.IR=Bardiche&\r\n^base.IRS=2&\r\n^base.IRT<=2\r\n >o0,1,#white,ascii\r\n#O\r\n/)\r\nasciiend\r\n\r\n?base.IR=Bardiche&\r\n^base.IRS=2&\r\n^base.IRT=3\r\n >o-1,1,#white,ascii\r\n#O\r\n'|`\r\n/#¯\r\nasciiend\r\n?base.IR=Bardiche&\r\n^base.IRS=2&\r\n^base.IRT>3\r\n >o-2,1,#white,ascii\r\nO\r\n|\\/\r\n#|\r\nasciiend\r\n\r\n?base.IR=Bardiche&\r\n^!ai.walking&\r\n^base.IRS=2&\r\n^base.IRT<=2\r\n >o-1,3,#white,ascii\r\n/#\\\r\nasciiend\r\n\r\n?base.IR=Bardiche&\r\n^base.IRS=3&\r\n^base.IRT<=1\r\n BStompX=0\r\n BStompY=0\r\n >o-2,1,#white,ascii\r\n_O\r\n/\r\n)\\\r\nasciiend\r\n\r\n?base.IR=Bardiche&\r\n^base.IRS=3&\r\n^base.IRT>1\r\n >o-2,1,#white,ascii\r\n#\\O\r\n#/\r\n/ \\\r\nasciiend\r\n?base.IR=Bardiche&\r\n^base.IRS=3&\r\n^base.IRT>1&\r\n^base.IRT<=2\r\n play fire_geyser\r\n >o-3,0,@base.ICR@,ascii\r\n#/\\^/\\\r\n#)###(\r\n/#####\\\r\n`.#_#.´\r\nasciiend\r\n\r\n?base.IR=Bardiche&\r\n^base.IRS=3&\r\n^base.IRT=3\r\n play fire_elemental_attack_hit\r\n >o-3,2,@base.ICR@,ascii\r\n.-_._-.\r\n'.#_#.'\r\nasciiend\r\n\r\n?base.IR=Bardiche&\r\n^base.IRS=3&\r\n^base.IRT>1&\r\n^base.ICR!#blue&\r\n^base.ICR!#red&\r\n^base.ICR!#rainbow\r\n play player_kick\r\n BStompX=2+BStompX\r\n >o@BStompX@,@2+BStompY@,@base.ICR@,ascii\r\n.—.\r\n#¯\r\nasciiend\r\n\r\n?base.IR=Bardiche&\r\n^base.IRS=3&\r\n^base.IRT>1&\r\n^base.ICR=#blue\r\n play player_punch\r\n BStompX=2+BStompX\r\n >o@BStompX@,@2+BStompY@,@base.ICR@,ascii\r\n.^.\r\n#¯\r\nasciiend\r\n\r\n?base.IR=Bardiche&\r\n^base.IRS=3&\r\n^base.IRT>1&\r\n^base.ICR=#red\r\n play tree_boss_spike\r\n BStompX=2+BStompX\r\n >o@BStompX@,@1+BStompY@,@base.ICR@,ascii\r\n#∆\r\n/＂\\\r\n#¯\r\nasciiend\r\n?base.IR=Bardiche&\r\n^base.IRS=3&\r\n^base.IRT>1&\r\n^base.ICR=#rainbow\r\n play bearer_attack_hit\r\n BStompX=2+BStompX\r\n >o@BStompX@,@1+BStompY@,@base.ICR@,ascii\r\n#*\r\n｛^｝\r\n#¯\r\nasciiend\r\n\r\n?base.IR=Bardiche&\r\n^base.IRS=3&\r\n^base.IRT>1&\r\n^BStompY=0\r\n BStompY=1\r\n:?BStompY=1\r\n BStompY=0\r\n\r\n?ai.walking &\r\n^base.IR=Bardiche&\r\n^time % 15 <= 5&\r\n^base.IRS=1\r\n >o-1,3,#white,ascii\r\n/#┘\r\nasciiend\r\n\r\n?ai.walking &\r\n^base.IR=Bardiche&\r\n^time % 15 > 5 &\r\n^time % 15 <= 10&\r\n^base.IRS=1\r\n >o0,3,#white,ascii\r\n┘\\\r\nasciiend\r\n\r\n?ai.walking &\r\n^base.IR=Bardiche&\r\n^time % 15 > 10&\r\n^base.IRS=1\r\n >o0,3,#white,ascii\r\nX\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Weapons/ArmorGenerator.txt" - Parse error: Failed to parse completely. Remaining: "?base.IR=Shield&\r\n^armor=maxarmor\r\n base.ICR=#7d7d7d\r\n\r\n?base.IR=Shield&\r\n^base.IRT%8<2\r\n >o1,1,@base.ICR@,ascii\r\n#ζ\r\n«@base.IRI@╞\r\n#¯\r\nasciiend\r\n\r\n?base.IR=Shield&\r\n^base.IRT%8<=4&\r\n^base.IRT%8>2\r\n >o1,1,@base.ICR@,ascii\r\n#_\r\n«—╞\r\n#¯\r\nasciiend\r\n\r\n?base.IR=Shield&\r\n^base.IRT%8<=6&\r\n^base.IRT%8>4\r\n >o1,1,@base.ICR@,ascii\r\n#_\r\n«@base.IRI@╞\r\n#ζ\r\nasciiend\r\n\r\n?base.IR=Shield&\r\n^base.IRT%8<=8&\r\n^base.IRT%8>6\r\n >o1,1,@base.ICR@,ascii\r\n#_\r\n«@base.IRI@╞\r\n#¯\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Pumpkins.txt" - Parse error: Failed to parse completely. Remaining: "= []\r\nvar PumpkinArt = ascii\r\n.'` ´'.\r\n\\     /\r\n#`´'`´\r\n%%\r\n#.- -.\r\n{     }\r\n#`-'-´\r\n%%\r\n.'` ´'.\r\ni     ;\r\n#`´'`´\r\nasciiend\r\n\r\nvar EyeArt = ascii\r\n`~´\r\n%%\r\n`^´\r\n%%\r\n`▼´\r\n%%\r\n°~°\r\n%%\r\n°^°\r\n%%\r\n°o°\r\n%%\r\n°_°\r\n%%\r\n°▼°\r\n%%\r\n°3°\r\n%%\r\n@~@\r\n%%\r\n@.@\r\n%%\r\nO_O\r\n%%\r\nO~O\r\n%%\r\n'u'\r\n%%\r\n❤▄❤\r\n%%\r\n❤3❤\r\n%%\r\n❤ε❤\r\n%%\r\ní~ì\r\n%%\r\ní^ì\r\n%%\r\nò^ó\r\n%%\r\nò.ó\r\n%%\r\nò_ó\r\n%%\r\nó^ò\r\n%%\r\nó.ò\r\n%%\r\nó_ò\r\n%%\r\nóΘò\r\n%%\r\nq~q\r\n%%\r\n$o$\r\nasciiend\r\n\r\nvar StemArt = ascii\r\n##;\r\n#´\r\n%%\r\n(@\r\n#`\r\n%%\r\n`,\r\n#`\r\n%%\r\n´)\r\n#`\r\n%%\r\n#`,\r\n#´\r\n%%\r\n,-.\r\n#`\r\n%%\r\n.-,\r\n#´\r\n%%\r\n#;\r\n#`\r\n%%\r\n,`\r\n#`\r\nasciiend\r\n\r\nfunc CheckYOffset()\r\n  var Location = loc\r\n  ?Location = \"deadwood_valley\"\r\n    return 3\r\n  :?Location = \"temple\"\r\n    return 11\r\n  :?Location = \"undead_crypt\"\r\n    return 10\r\n  :?Location = \"fungus_forest\"\r\n    return 8\r\n  :?Location = \"caustic_caves\"\r\n    return 9\r\n  :?Location = \"icy_ridge\"\r\n    return 9\r\n  :?Location = \"bronze_mine\"\r\n    return 4\r\n  :?Location = \"rocky_plateau\"\r\n    return 7\r\n  :\r\n    return 0\r\n\r\n\r\nvar YOffset = CheckYOffset()\r\n\r\nfunc Rand(Min, Max)\r\n  var range = Max - Min + 1\r\n  return rng % range + Min\r\n\r\nfunc AddLayer(Layer,X,Y,Colour)\r\n  Layer.pivotX = X\r\n  Layer.pivotY = Y\r\n  Layer.color = Colour\r\n  Layer.frame = Rand(0,50)\r\n  return Layer\r\n\r\nfunc GeneratePumpkin()\r\n  var P = ui.AddAnim(PumpkinArt)\r\n  P.Stop()\r\n  P.color = #AA8000\r\n  P.frame = Rand(0,2)\r\n\r\n  Stem = AddLayer( P.AddLayer(StemArt), -2,1, \"#105510\")\r\n  Eyes = AddLayer( P.AddLayer(EyeArt) , -2,-1,\"#553500\")\r\n  return P\r\n\r\nfunc SetX(Min)\r\n  return Rand( Min, Min + NumberOfPumpkins * 15)\r\n\r\nfunc Run()\r\n  ?Init\r\n    Pumpkin = GeneratePumpkin()\r\n    PumpkinX = SetX(pos.x - 40)\r\n    Pumpkin.y = Rand(-1,2) + YOffset\r\n    Init = false\r\n  ?PumpkinX + 120 < pos.x | PumpkinX > pos.x + 250\r\n    PumpkinX = SetX(pos.x + 50)\r\n    Pumpkin.y = Rand(-1,2) + YOffset\r\n    Pumpkin.frame = Rand(0,2)\r\n    Stem.frame = Rand(0,50)\r\n    Eyes.frame = Rand(0,50)\r\n  Pumpkin.x = screen.FromWorldX(PumpkinX)\r\n\r\nfunc RunAll()\r\n  ?totaltime = 1\r\n    InitTime = 1\r\n    PumpkinList.Clear()\r\n  ?totaltime > InitTime\r\n    >h-1,0,#004400,ascii\r\n#¸\r\n“#”\r\nasciiend\r\n    >h0,1,#AA4400,ω\r\n    ?PumpkinList.Count() < NumberOfPumpkins\r\n      for a = PumpkinList.Count()..NumberOfPumpkins - 1\r\n        var TempNew = new Cosmetics/Pumpkins\r\n        PumpkinList.Add(TempNew)\r\n    :?PumpkinList.Count() > NumberOfPumpkins\r\n      for a = PumpkinList.Count()..NumberOfPumpkins + 1\r\n        PumpkinList[0].Pumpkin.Recycle()\r\n        PumpkinList.RemoveAt(0)\r\n  for a : PumpkinList\r\n    a.Run()\r\nRunAll()\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/StoneheadFall.txt" - Parse error: Failed to parse completely. Remaining: "= #bbbbbb\r\n//determines the color of the stoneheads\r\n\r\nvar randomizeStoneColor = \"false\"\r\n//determines if stoneheads spawn as a random color\r\n\r\nvar spawnOnClick = \"true\"\r\n//whether or not stonehead spawns when you click\r\n\r\nvar isClickSpawnRandom = \"false\"\r\n//whether or not the click spawn happens at click position\r\n\r\nvar occasionalSpawn = \"true\"\r\n//if stoneheads spawn randomly every now and then\r\n\r\nvar occasionalSpawnChance = 15\r\n//the chance out of 100 that a stonehead is spawned each frame\r\n\r\nvar isChaosUnleashed = \"false\"\r\n//Warning: may lag inferior devices\r\n\r\nvar chaosClearRateIncrease = \"true\"\r\n/*determines whether or not to clear more stoneheads per frame\r\nwhen chaos is active, to prevent the screen from being covered\r\ndisable to make your screen fill with stones!*/\r\n//----------------Art----------------//\r\nvar fallArt = ascii\r\no<─<\r\n%%\r\n#\r\no<─<\r\n%%\r\n#\r\n#\r\no<─<\r\n%%\r\n#\r\n#\r\n#\r\no<─<\r\n%%\r\n#\r\n#\r\n#\r\n#\r\no<─<\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\no<─<\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no<─<\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no<─<\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no<─<\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no<─<\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no<─<\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no<─<\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no<─<\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no<─<\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no<─<\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no<─<\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no<─<\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no<─<\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n@#@@\r\no@#@\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n@#@@\r\no@#@\r\n%% {repeat:2} done!\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no\r\n%% {repeat:2} Done!\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no\r\n%% {repeat:4} Done!\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no\r\n%% {repeat:8} Done!\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no\r\n%% {repeat:4} Done!\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no\r\n%% {repeat:2} Done!\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no\r\n%% {repeat:2} Done!\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no\r\n%% {repeat:2} Done!\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\no\r\n%% {repeat:2} Done!\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#o\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#o\r\n%% {repeat:2} Done!\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n##o\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n##o\r\n%% {repeat:4} Done!\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n###o\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n###o\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n###o\r\n%% \r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n###o\r\n%% {repeat:8} Done!\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n##o\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n##o\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n##o\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n##o\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n##o\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n##o\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n##o\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n##o\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#o\r\nasciiend\r\n//----------------Functions----------------//\r\nfunc MakeStonehead(stoneX, stoneY)\r\n  var fallingStone = ui.AddAnim(fallArt)\r\n  fallingStone.dock = top_left\r\n  ?stoneX = random\r\n   fallingStone.x = RandomRange(1,screen.w-1)\r\n  :\r\n   fallingStone.x = stoneX\r\n  ?stoneY = random\r\n   fallingStone.y = RandomRange(-18,screen.h+18)\r\n  :\r\n   fallingStone.y = stoneY -9\r\n  fallingStone.Play()\r\n  fallingStone.loop = false\r\n  ?randomizeStoneColor = \"true\"\r\n   stoneColor = color.Random()\r\n  fallingStone.color = stoneColor\r\n  return fallingStone\r\nfunc RandomRange(min, max)\r\n  ?min >= max\r\n    return min\r\n  return min + rng % (max - min + 1)\r\n//----------------Everything Else----------------//\r\nvar stoneList = []\r\n?stoneList.Count()\r\n  ?!stoneList[0].playing\r\n    stoneList[0].Recycle()\r\n    stoneList.RemoveAt(0)\r\n?loc.loop\r\n stoneList.Clear()\r\n?RandomRange(0, 100)<=occasionalSpawnChance & occasionalSpawn = \"true\"\r\n stoneList.Add(MakeStonehead(random, random))\r\n?key = \"primaryBegin\"\r\n ?isClickSpawnRandom = \"false\"\r\n  stoneList.Add(MakeStonehead(input.x, input.y))\r\n :\r\n  stoneList.Add(MakeStonehead(random, random))\r\n?isChaosUnleashed = \"true\" & totaltime % 1 = 0\r\n stoneList.Add(MakeStonehead(random, random))\r\n stoneList.Add(MakeStonehead(random, random))\r\n stoneList.Add(MakeStonehead(random, random))\r\n stoneList.Add(MakeStonehead(random, random))\r\n?isChaosUnleashed = \"true\" & chaosClearRateIncrease = \"true\" & stoneList.Count()\r\n  ?!stoneList[0].playing\r\n    stoneList[0].Recycle()\r\n    stoneList.RemoveAt(0)\r\n  ?!stoneList[0].playing\r\n    stoneList[0].Recycle()\r\n    stoneList.RemoveAt(0)\r\n  ?!stoneList[0].playing\r\n    stoneList[0].Recycle()\r\n    stoneList.RemoveAt(0)"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetFrog.txt" - Parse error: Failed to parse completely. Remaining: "= #white\r\n\r\nvar keepDistance = -17\r\nvar maxX = -11\r\n\r\nvar maxDistance\r\nmaxDistance = -70\r\n\r\nvar targetZ = -1\r\n\r\nvar x = 0\r\nvar y = 0\r\nvar myX = 0\r\nvar myZ = 0\r\nvar lastPlayerX = 0\r\nvar lastPlayerZ = 0\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1\r\nvar stateJump = 2\r\nvar currentState = stateNone\r\nvar stateTime = 0\r\n\r\n\r\nfunc SetState(newState)\r\n  ?newState = stateJump\r\n    play frog\r\n\r\n  currentState = newState\r\n  stateTime = 0\r\n\r\n\r\n?currentState = stateNone | time = 1\r\n  lastPlayerX = pos.x\r\n  lastPlayerZ = pos.z\r\n  myX = keepDistance\r\n  myZ = targetZ\r\n\r\n  // Start further away if the frog is summoned while the location is already running\r\n  ?time > 1\r\n    myX = maxDistance\r\n\r\n  SetState(stateIdle)\r\n\r\n\r\nmyX = myX - (pos.x - lastPlayerX)\r\n\r\nstateTime++\r\n\r\n?currentState = stateIdle\r\n  ?myX < maxDistance | myX > -maxDistance\r\n    myX = maxDistance\r\n  myZ = myZ - (pos.z - lastPlayerZ)\r\n\r\n  ?myX < keepDistance\r\n    SetState(stateJump)\r\n\r\n:?currentState = stateJump\r\n  ?myX < maxX\r\n    myX++\r\n\r\n  ?stateTime >= 6\r\n    ?myZ > targetZ\r\n      myZ--\r\n    :?myZ < targetZ\r\n      myZ++\r\n\r\n  ?stateTime >= 12\r\n    SetState(stateIdle)\r\n\r\n\r\nlastPlayerX = pos.x\r\nlastPlayerZ = pos.z\r\n\r\n// Draw\r\n\r\n?currentState = stateIdle\r\n  >o@myX@,@myZ@,@frogColor@,ascii\r\n#\r\n#\r\n#####,Oo\r\n##(\\/ .-)\r\n##´ ·-\\´\\\r\nasciiend\r\n  x = myX + 5\r\n  y = myZ + 2\r\n  ?face = \"( ^^\"\r\n    >o@x@,@y@,@frogColor@,ascii\r\n,^^\r\n '=\r\nasciiend\r\n\r\n  :?face = \"°°\"\r\n    ?time % 10 = 0 & myX > keepDistance\r\n      myX--\r\n\r\n    ?time % 4 <= 1\r\n      >o@x@,@y@,@frogColor@,ascii\r\n#oO\r\n  *\r\nasciiend\r\n    ?time % 4 > 1\r\n      >o@x@,@y@,@frogColor@,ascii\r\n#Oo\r\n  *\r\nasciiend\r\n\r\n  :?stateTime % 50 >= 48\r\n    >o@x@,@y@,@frogColor@,ascii\r\n,O-\r\nasciiend\r\n  :?stateTime % 50 >= 46\r\n    >o@x@,@y@,@frogColor@,ascii\r\n,=-\r\nasciiend\r\n  :?stateTime % 50 >= 44\r\n    >o@x@,@y@,@frogColor@,ascii\r\n,--\r\nasciiend\r\n\r\n?currentState = stateJump\r\n  ?stateTime/2 = 0\r\n    >o@myX@,@myZ@,@frogColor@,ascii\r\n#\r\n#\r\n#####,--\r\n###(! .-)\r\n###'·-((\r\nasciiend\r\n\r\n  :?stateTime/2 = 1\r\n    >o@myX@,@myZ@,@frogColor@,ascii\r\n#\r\n#####,--\r\n####/ .-)\r\n##_(;-//\r\n###`\r\nasciiend\r\n\r\n  :?stateTime/2 = 2\r\n    >o@myX@,@myZ@,@frogColor@,ascii\r\n#####.=-\r\n####/ .-)\r\n##_(/-)´`\r\n#-´‾\r\nasciiend\r\n\r\n  :?stateTime/2 = 3\r\n    >o@myX@,@myZ@,@frogColor@,ascii\r\n#####.O-\r\n###,´ .-)\r\n#_(/--‾´‾\r\n-´‾\r\nasciiend\r\n\r\n  :?stateTime/2 = 4\r\n    >o@myX@,@myZ@,@frogColor@,ascii\r\n#\r\n#####.Oo\r\n-´-`´ .-)\r\n####`-‾´‾\r\nasciiend\r\n\r\n  :?stateTime/2 = 5\r\n    >o@myX@,@myZ@,@frogColor@,ascii\r\n#\r\n#\r\n##_##.Oo\r\n#/-`´ .-)\r\n###`--\\´\\\r\nasciiend\r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/CavePets.txt" - Parse error: Failed to parse completely. Remaining: ":\r\n biterWaitAnim.visible = true \r\n biterWalkAnim.visible = false\r\n biterWaitAnim.x = screen.FromWorldX(pos.x)-3\r\n biterWaitAnim.y = screen.FromWorldZ(pos.z)+2\r\n\r\n\r\n?loc.begin\r\n  peelerWalkAnim = ui.AddAnim(ascii\r\n#####_###\r\n####( )_#\r\n,´`∞<'|#)\r\n######'##\r\n%%\r\n#####_##\r\n###_( )#\r\n#/'∞`´\\)\r\n´######`\r\n%%\r\n#####_##\r\n####( )#\r\n#|`(`^´|\r\n#'#####'\r\n%%\r\n#####_###\r\n####( )##\r\n#(`∞/<´\\#\r\n##`´####`\r\n%%\r\n#####_####\r\n####( )###\r\n#<;∞|/#`.#\r\n####'####`\r\n%%\r\n#####_####\r\n#_##( )#_#\r\n'#`∞(|#`#'\r\n#####`####\r\nasciiend)\r\n  peelerWaitAnim = ui.AddAnim(ascii\r\n#####_###\r\n####( )##\r\n#/`∞|´\\\\#\r\n´###'##``\r\n%%\r\n#####_###\r\n####( )##\r\n#/`∞|´\\\\#\r\n´###'##``\r\n%%\r\n#####_###\r\n####( )##\r\n#/`∞|´\\\\#\r\n´###'##``\r\n%%\r\n#####_###\r\n####( )##\r\n#/`-|´\\\\#\r\n´###'##``\r\nasciiend)\r\n  peelerWalkAnim.visible = false\r\n  peelerWalkAnim.duration = 21\r\n  peelerWalkAnim.loop = true\r\n  peelerWalkAnim.Play()\r\n  peelerWalkAnim.flipX = true\r\n  peelerWalkAnim.dock = top_left\r\n\r\n  peelerWaitAnim.visible = false\r\n  peelerWaitAnim.duration = 60\r\n  peelerWaitAnim.loop = true\r\n  peelerWaitAnim.Play()\r\n  peelerWaitAnim.flipX = true\r\n  peelerWaitAnim.dock = top_left\r\n?ai.walking = true\r\n peelerWaitAnim.visible = false\r\n peelerWalkAnim.visible = true\r\n peelerWalkAnim.x = screen.FromWorldX(pos.x)+1\r\n peelerWalkAnim.y = screen.FromWorldZ(pos.z)-2\r\n:\r\n peelerWaitAnim.visible = true \r\n peelerWalkAnim.visible = false\r\n peelerWaitAnim.x = screen.FromWorldX(pos.x)+1\r\n peelerWaitAnim.y = screen.FromWorldZ(pos.z)-2\r\n\r\n\r\n?loc.begin\r\n  chopperWalkAnim = ui.AddAnim(ascii\r\n########___#\r\n######()`-.\\\r\n#,--.#_`__(/\r\n'´¯¯'-.<`(´|\r\n#_,-- /####'\r\n#¯¯¯´¯######\r\n%%\r\n########___##\r\n######()`-.\\#\r\n#,--.#_`__(/#\r\n'´¯¯'-./<#´\\#\r\n#_,-- /`####`\r\n#¯¯¯´¯#######\r\n%%\r\n########___#\r\n######()`-.\\\r\n#,--.#_`__(/\r\n'´¯¯'∞.|/-´)\r\n#_,-- /'####\r\n#¯¯¯´¯######\r\n%%\r\n########___#\r\n######()`-.\\\r\n#,--.#_`__(/\r\n'´¯¯'∞.,\\|^#\r\n#_,-- /##＂##\r\n#¯¯¯´¯######\r\n%%\r\n########___#\r\n######()`-.\\\r\n#,--.#_`__(/\r\n'´¯¯'∞.,^\\(#\r\n#_,-- /###``\r\n#¯¯¯´¯######\r\n%%\r\n########___#\r\n######()`-.\\\r\n#,--.#_`__(/\r\n'´¯¯'∞.<`(´|\r\n#_,-- /####'\r\n#¯¯¯´¯######\r\n%%\r\n########___##\r\n######()`-.\\#\r\n#,--.#_`__(/#\r\n'´¯¯'∞./<#´\\#\r\n#_,-- /`####`\r\n#¯¯¯´¯#######\r\n%%\r\n####### ___#\r\n######()`-.\\\r\n#,--.#_`__(/\r\n'´¯¯'∞.|/-´)\r\n#_,-- /'####\r\n#¯¯¯´¯######\r\n%%\r\n########___#\r\n######()`-.\\\r\n#,--.#_`__(/\r\n'´¯¯'∞.,\\|^#\r\n#_,-- /##＂##\r\n#¯¯¯´¯######\r\n%%\r\n########___#\r\n######()`-.\\\r\n#,--.#_`__(/\r\n'´¯¯'∞.,^\\(#\r\n#_,-- /###``\r\n#¯¯¯´¯######\r\nasciiend)\r\n  chopperWaitAnim = ui.AddAnim(ascii\r\n########___##\r\n######()`-.\\#\r\n#,--.#_`__(/#\r\n'´¯¯'∞.,)´)\\#\r\n#_,-- /#`#`#`\r\n#¯¯¯´¯#######\r\n%%\r\n########___##\r\n######()`-.\\#\r\n#,--.#_`__(/#\r\n'´¯¯'∞.,)´)\\#\r\n#_,-- /#`#`#`\r\n#¯¯¯´¯#######\r\n%%\r\n########___##\r\n######()`-.\\#\r\n#,--.#_`__(/#\r\n'´¯¯'∞.,)´)\\#\r\n#_,-- /#`#`#`\r\n#¯¯¯´¯#######\r\n%%\r\n########___##\r\n######()`-.\\#\r\n#,--.#_`__(/#\r\n'´¯¯'-.,)´)\\#\r\n#_,-- /#`#`#`\r\n#¯¯¯´¯#######\r\nasciiend)\r\n  chopperWalkAnim.visible = false\r\n  chopperWalkAnim.duration = 30\r\n  chopperWalkAnim.loop = true\r\n  chopperWalkAnim.Play()\r\n  chopperWalkAnim.flipX = true\r\n  chopperWalkAnim.dock = top_left\r\n\r\n  chopperWaitAnim.visible = false\r\n  chopperWaitAnim.duration = 50\r\n  chopperWaitAnim.loop = true\r\n  chopperWaitAnim.Play()\r\n  chopperWaitAnim.flipX = true\r\n  chopperWaitAnim.dock = top_left\r\n?ai.walking = true\r\n chopperWaitAnim.visible = false\r\n chopperWalkAnim.visible = true\r\n chopperWalkAnim.x = screen.FromWorldX(pos.x)-7\r\n chopperWalkAnim.y = screen.FromWorldZ(pos.z)\r\n:\r\n chopperWaitAnim.visible = true \r\n chopperWalkAnim.visible = false\r\n chopperWaitAnim.x = screen.FromWorldX(pos.x)-7\r\n chopperWaitAnim.y = screen.FromWorldZ(pos.z)"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Party.txt" - Parse error: Failed to parse completely. Remaining: "*\r\n| `.\r\n'\r\nasciiend\r\n  :\r\n    >h-1,-1,#rainff,ascii\r\n*\r\n|.\r\nasciiend\r\n\r\n//Presents\r\nvar presents=true\r\n?presents\r\n  ?foe!boss&foe\r\n    >f-3,0,ascii\r\n####________\r\n##/         /│\r\n#/         / │\r\n│¯¯¯¯¯¯¯¯¯│  │\r\n│         │  │\r\n│         │  !\r\n│         │ /\r\n│_________│/\r\nasciiend\r\n    >f-2,-1,#rainff,ascii\r\n##.-.###.-.\r\n#.###...###.\r\n#'._.'-'._.'\r\n####/ /   /│\r\n###│¯│####││\r\n###│ │####││\r\n###│ │####││\r\n###│ │####│\r\n###│_│#\r\nasciiend\r\n//?foe!boss&foe\r\n//  >f0,-1,ascii\r\n//###____\r\n//#/     /│\r\n//│¯¯¯¯¯│ │\r\n//│     │ !\r\n//│_____│/\r\n//asciiend\r\n//  >f1,-1,#rainff,ascii\r\n//.'.#.'.\r\n//'.'-'.'\r\n//#│¯│##│\r\n//#│ │##│\r\n//#│_│#\r\n//asciiend\r\n\r\n//Balloons\r\nvar balloons=true\r\nvar TapToPlant = true\r\nvar ShowButton = true\r\nvar MaxBalloons = 1000\r\nvar apanel = []\r\nvar aballoons = []\r\nvar aballoonsx = []\r\nvar cleanup = []\r\nvar buttonanchor = top_right\r\nvar buttondock = top_right\r\nvar sbuttonx = -1\r\n?TapToPlant\r\n  var sbuttony = 11\r\n:\r\n  var sbuttony = 6\r\nvar sbutton\r\nvar fbuttonx = -1\r\nvar fbuttony = 6\r\nvar fbutton\r\nvar planting = false\r\nvar init = screen.FromWorldX(0)\r\nvar diff = 0\r\ndiff = init - screen.FromWorldX(0)\r\nvar custstyle = ui.AddStyle(\"\r\n^###\r\n^###\r\n^###\")\r\n\r\nvar pinart=ascii\r\n_\r\n┬\r\nasciiend\r\n\r\nvar balloon1=ascii\r\n#\r\n.-.\r\n\\ /\r\n#^\r\n%%\r\n#\r\n#.-.\r\n#\\ /\r\n##^\r\n%%\r\n#.-.\r\n#\\ /\r\n##^\r\n#\r\n%%\r\n#\r\n#.-.\r\n#\\ /\r\n##^\r\nasciiend\r\n\r\nvar balloon2=ascii\r\n#\r\n#\r\n#|\r\n#!\r\n/\r\n%%\r\n#\r\n#\r\n##!\r\n#/\r\n/\r\n%%\r\n#\r\n##|\r\n##'\r\n#/\r\n/\r\n%%\r\n#\r\n#\r\n##!\r\n#/\r\n/\r\nasciiend\r\n\r\nfunc FBtnPressed()\r\n  ?!planting \r\n    planting = true\r\n    fbutton.color = #FFFFFF\r\n  :\r\n    planting = false\r\n    fbutton.color = #888888\r\n\r\nfunc SBtnPressed()\r\n  Prune()\r\n\r\nfunc DrawButton(type)\r\n  var vis\r\n  var buttonx\r\n  var buttony\r\n  var art\r\n  var text\r\n  var function\r\n\r\n  ?type = 1 //flower\r\n    vis = TapToPlant\r\n    buttonx = fbuttonx\r\n    buttony = fbuttony\r\n    art = balloon1\r\n    text = \"[F]\"\r\n    function = FBtnPressed\r\n    key.Bind(\"Up\", \"F\")\r\n  :?type = 2 //shovel\r\n    vis = false\r\n    buttonx = sbuttonx\r\n    buttony = sbuttony\r\n    art = pinart\r\n    text = \"[S]\"\r\n    function = SBtnPressed\r\n  :\r\n    return 0\r\n\r\n  var p = ui.AddPanel()\r\n  p.anchor = buttonanchor\r\n  p.dock = buttondock\r\n  p.visible = vis\r\n  p.color = #888888\r\n  p.style = 1\r\n  p.w = 7\r\n  p.h = 5\r\n  p.x = buttonx\r\n  p.y = buttony\r\n\r\n  var b = ui.AddButton()\r\n  b.anchor = center_center\r\n  b.dock = center_center\r\n  b.visible = inherit\r\n  b.style = 0\r\n  b.text = \"\"\r\n  b.w = 5\r\n  b.h = 3\r\n  b.SetPressed(function)\r\n  p.Add(b)\r\n\r\n  var a = ui.AddAnim(art)\r\n  a.anchor = center_center\r\n  a.dock = center_center\r\n  a.visible = inherit\r\n  a.color = #white\r\n  p.Add(a)\r\n\r\n  // Only displays text on PC\r\n  // to match other buttons\r\n  ?sys.isPC\r\n    var t = ui.AddText()\r\n    t.anchor = bottom_right\r\n    t.dock = bottom_right\r\n    t.visible = inherit\r\n    t.color = #888888\r\n    t.text = text\r\n    t.w = 3\r\n    t.h = 1\r\n    t.x = -1\r\n    p.Add(t)\r\n  //\r\n\r\n  return p\r\n\r\nfunc BuildRows()\r\n  apanel.Clear()\r\n  var p\r\n  var t\r\n  for i = 0 .. screen.h\r\n    p = ui.AddPanel()\r\n    p.anchor = top_center\r\n    p.dock = top_center\r\n    p.visible = true\r\n    p.color = #888888\r\n    p.style = custstyle \r\n    p.w = screen.w\r\n    p.h = 1\r\n    p.x = 0\r\n    p.y = i\r\n    apanel.Add(p)\r\n\r\nfunc Tend()\r\n  cleanup.Clear()\r\n  ?aballoons.Count() >= 1\r\n    sbutton.visible = true\r\n    for i = 0 .. aballoons.Count() - 1\r\n      aballoons[i].x = screen.FromWorldX(\r\n                      ^aballoonsx[i]-diff)\r\n      ?aballoons[i].x < -20\r\n        cleanup.Add(i)\r\n    ?cleanup.Count() >= 1\r\n      for i = cleanup.Count() - 1 .. 0\r\n        aballoons[(cleanup[i])].Recycle()\r\n        aballoons.RemoveAt(cleanup[i])\r\n        aballoonsx.RemoveAt(cleanup[i])\r\n  :\r\n    sbutton.visible = false\r\n\r\nfunc Prune()\r\n  ?aballoons.Count() >= 1\r\n    for i = 0 .. aballoons.Count() - 1\r\n      aballoons[i].Recycle()\r\n    aballoons.Clear()\r\n    aballoonsx.Clear()\r\n\r\nfunc Balloon(posx,posy)\r\n  ?(aballoons.Count()+1) > MaxBalloons\r\n    return 0\r\n\r\n  ?posx < (screen.w + fbutton.x) & \r\n   ^posx > (screen.w + fbutton.x - 8) &\r\n   ^posy > fbutton.y & posy < fbutton.y + 5\r\n    return 0 \r\n\r\n  var art1 = balloon1\r\n  var art2 = balloon2\r\n  var col1 = #AAAAAA\r\n  var col2 = #FFFFFF\r\n  var r = rng % (10)\r\n\r\n  ?Colors\r\n    ?r = 0\r\n      col1 = #rainff\r\n    :\r\n      col1 = color.Random()\r\n    col2 = #white\r\n\r\n  var p = ui.AddPanel()\r\n  p.style = custstyle\r\n  p.anchor = top_left\r\n  p.dock = top_left\r\n  p.x = posx-2\r\n  p.y = -3\r\n  p.w = 5\r\n  p.h = 4\r\n\r\n  var a1 = ui.AddAnim(art1)\r\n  a1.duration = 60\r\n  a1.color = col1\r\n  a1.loop=true\r\n  a1.Play()\r\n  a1.x=1\r\n  a1.y=-1\r\n\r\n  var a2 = ui.AddAnim(art2)\r\n  a2.duration = 60\r\n  a2.color = col2\r\n  a2.loop=true\r\n  a2.Play()\r\n\r\n  p.Add(a1)\r\n  p.Add(a2)\r\n\r\n  apanel[posy].Add(p)\r\n  aballoons.Add(p)\r\n  aballoonsx.Add(screen.ToWorldX(\r\n                 ^posx-2) + diff)\r\n\r\n  a1.Play()\r\n  a2.Play()\r\n\r\n  return 1\r\n\r\n?time <= 1 & totaltime <= 1\r\n  BuildRows()\r\n  fbutton = DrawButton(1)\r\n  sbutton = DrawButton(2)\r\n:?time <= 1 \r\n  Prune()\r\n:?time > 5\r\n  Tend()\r\n?planting & key = PrimaryBegin\r\n  Balloon(input.x,input.y)\r\n?balloons\r\n  fbutton.visible=true\r\n:\r\n  fbutton.visible=false\r\n  planting=false\r\n  fbutton.color = #888888\r\n\r\n//Confetti\r\nvar confetti=true\r\nvar prtcls=[]\r\nvar delete=[]\r\nvar remove\r\nvar count=0\r\nvar particle=ascii\r\n.\r\n%%\r\n-\r\n%%\r\n,\r\n%%\r\n*\r\n%%\r\n`\r\n%%\r\n+\r\nasciiend\r\n\r\nfunc CreateConfetti()\r\n  var prtcl=uiAA(particle)\r\n  prtcl.dock=top_left\r\n  prtcl.y=0\r\n  prtcl.x=rng%screen.w\r\n  prtcl.color=color.Random()\r\n  prtcl.frame=rng%6\r\n  return prtcl\r\n\r\nfunc ParticleMove(p)\r\n    ?rng%25=0\r\n      p.y=p.y+1\r\n    ?p.y=screen.h\r\n      return true\r\n    return false\r\n\r\nfunc ParticleRun()\r\n  ?prtcls.Count()>0\r\n    for p : prtcls\r\n      ?ParticleMove(p)\r\n        delete.Add(count)\r\n        p.Recycle()\r\n      count++\r\n    count=0\r\n    ?delete.Count()>0\r\n      for d : delete\r\n        prtcls.Emplace(d,0)\r\n      for d : delete\r\n        remove=prtcls.IndexOf(0)\r\n        prtcls.RemoveAt(remove)\r\n      delete.Clear()\r\n\r\n?confetti\r\n  ?totaltime=1\r\n    prtcls.Clear()\r\n  ?rng%50=0\r\n    prtcls.Add(CreateConfetti())\r\n  ParticleRun()\r\n\r\n//Cake\r\nvar cake=true\r\n\r\nvar frogColor\r\nfrogColor = #white\r\n\r\nvar keepDistance = -17\r\nvar maxX = -11\r\n\r\nvar maxDistance\r\nmaxDistance = -70\r\n\r\nvar targetZ = -1\r\n\r\nvar x = 0\r\nvar y = 0\r\nvar myX = 0\r\nvar myZ = 0\r\nvar lastPlayerX = 0\r\nvar lastPlayerZ = 0\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1\r\nvar stateJump = 2\r\nvar currentState = stateNone\r\nvar stateTime = 0\r\n\r\n\r\nfunc SetState(newState)\r\n  ?newState = stateJump\r\n    >`0,25, \r\n    //play splat\r\n\r\n  currentState = newState\r\n  stateTime = 0\r\n\r\n?cake\r\n  ?currentState = stateNone | time = 1\r\n    lastPlayerX = pos.x\r\n    lastPlayerZ = pos.z\r\n    myX = keepDistance\r\n    myZ = targetZ\r\n  \r\n    // Start further away if the frog is summoned while the location is already running\r\n    ?time > 1\r\n      myX = maxDistance\r\n  \r\n    SetState(stateIdle)\r\n  \r\n  \r\n  myX = myX - (pos.x - lastPlayerX)\r\n  \r\n  stateTime++\r\n  \r\n  ?currentState = stateIdle\r\n    ?myX < maxDistance | myX > -maxDistance\r\n      myX = maxDistance\r\n    myZ = myZ - (pos.z - lastPlayerZ)\r\n  \r\n    ?myX < keepDistance\r\n      SetState(stateJump)\r\n  \r\n  :?currentState = stateJump\r\n    ?myX < maxX\r\n      myX++\r\n  \r\n    ?stateTime >= 6\r\n      ?myZ > targetZ\r\n        myZ--\r\n      :?myZ < targetZ\r\n        myZ++\r\n  \r\n    ?stateTime >= 12\r\n      SetState(stateIdle)\r\n  \r\n  \r\n  lastPlayerX = pos.x\r\n  lastPlayerZ = pos.z\r\n  \r\n  // Draw\r\n  \r\n  ?currentState = stateIdle\r\n    >o@myX@,@myZ@,@frogColor@,ascii\r\n#\r\n####¡\r\n#¡_¯¯¯_¡\r\n│ o¯¯¯o │\r\n!__'-'__!\r\n###¯¯¯\r\nasciiend\r\n    x = myX + 5\r\n    y = myZ + 2\r\n  \r\n  ?currentState = stateJump\r\n    ?stateTime/2 = 0\r\n      >o@myX@,@myZ@,@frogColor@,ascii\r\n#\r\n#\r\n####¡\r\n#¡_¯¯¯_¡\r\n│ o¯¯¯o │\r\n'──___──'\r\nasciiend\r\n  \r\n    :?stateTime/2 = 1\r\n      >o@myX@,@myZ@,@frogColor@,ascii\r\n#\r\n####¡\r\n#¡_¯¯¯_¡\r\n│ o¯¯¯o │\r\n!__'-'__!\r\n###¯¯¯\r\nasciiend\r\n  \r\n    :?stateTime/2 = 2\r\n      >o@myX@,@myZ@,@frogColor@,ascii\r\n####¡\r\n#¡_¯¯¯_¡\r\n│ o¯¯¯o │\r\n│  '-'  │\r\n#¯¯───¯¯\r\n#\r\nasciiend\r\n  \r\n    :?stateTime/2 = 3\r\n      >o@myX@,@myZ@,@frogColor@,ascii\r\n####¡\r\n#¡_¯¯¯_¡\r\n│ o¯¯¯o │\r\n│  '-'  │\r\n#¯¯───¯¯\r\n#\r\nasciiend\r\n  \r\n    :?stateTime/2 = 4\r\n      >o@myX@,@myZ@,@frogColor@,ascii\r\n####¡\r\n#¡_¯¯¯_¡\r\n│ o¯¯¯o │\r\n│  '-'  │\r\n#¯¯───¯¯\r\n#\r\nasciiend\r\n  \r\n    :?stateTime/2 = 5\r\n      >o@myX@,@myZ@,@frogColor@,ascii\r\n#\r\n####¡\r\n#¡_¯¯¯_¡\r\n│ o¯¯¯o │\r\n!__'-'__!\r\n###¯¯¯\r\nasciiend\r\n\r\n//UI\r\n\r\nvar button=ascii\r\n[]\r\n%%\r\n##[]\r\nasciiend\r\nvar buttonback=ascii\r\n||||\r\nasciiend\r\nvar back=[1,2,3,4,5]\r\nvar buttons=[hat,present,balloon,confetti,cake]\r\nvar uipnl\r\nvar uiopen=false\r\nvar uibtn\r\n\r\nfunc UIOpen()\r\n  uiopen=!uiopen\r\n  ?uiopen\r\n    uipnl.visible=true\r\n  :\r\n    uipnl.visible=false\r\n\r\nfunc Buttons()\r\n  uibtn=uiAB()\r\n  uibtn.h=3\r\n  uibtn.w=3\r\n  uibtn.dock=top_right\r\n  uibtn.y=4\r\n  uibtn.x=-3\r\n  uibtn.text=\"☼\"\r\n  uibtn.tcolor=color.Random()\r\n  uibtn.SetPressed(UIOpen)\r\n  uipnl=uiAP()\r\n  uipnl.w=21\r\n  uipnl.h=17\r\n  uipnl.visible=false\r\n  for q = 0..4\r\n    back[q]=uiAA(\"||||\")\r\n    back[q].anchor=top_left\r\n    back[q].dock=top_left\r\n    back[q].x=16\r\n    back[q].y=(q*3)+2\r\n    back[q].h=3\r\n    back[q].color=#808080\r\n    buttons[q]=uiAB()\r\n    buttons[q].anchor=top_left\r\n    buttons[q].dock=top_left\r\n    buttons[q].x=16\r\n    buttons[q].y=(q*3)+1\r\n    buttons[q].h=3\r\n    buttons[q].w=4\r\n    buttons[q].text=\"##[]\"\r\n    buttons[q].style=custstyle\r\n    buttons[q].SetPressed(Toggle)\r\n    uipnl.Add(back[q])\r\n    uipnl.Add(buttons[q])\r\n\r\nfunc Toggle(btn)\r\n  ?btn=buttons[0]\r\n    partyhat=!partyhat\r\n    ?partyhat\r\n      buttons[0].text=\"##[]\"\r\n    :\r\n      buttons[0].text=\"[]##\"\r\n  :?btn=buttons[1]\r\n    presents=!presents\r\n    ?presents\r\n      buttons[1].text=\"##[]\"\r\n    :\r\n      buttons[1].text=\"[]##\"\r\n  :?btn=buttons[2]\r\n    balloons=!balloons\r\n    ?balloons\r\n      buttons[2].text=\"##[]\"\r\n    :\r\n      buttons[2].text=\"[]##\"\r\n  :?btn=buttons[3]\r\n    confetti=!confetti\r\n    ?confetti\r\n      buttons[3].text=\"##[]\"\r\n    :\r\n      buttons[3].text=\"[]##\"\r\n      for p : prtcls\r\n        p.Recycle()\r\n      prtcls.Clear()\r\n  :?btn=buttons[4]\r\n    cake=!cake\r\n    ?cake\r\n      buttons[4].text=\"##[]\"\r\n    :\r\n      buttons[4].text=\"[]##\"\r\n\r\n?totaltime=1\r\n  Buttons()\r\n?uiopen\r\n  >c-9,-8,#rainff,10th Anniversery!!!\r\n  >c-9,-6,Party Hat\r\n  >c-9,-3,Presents\r\n  >c-9,0,Balloons\r\n  >c-9,3,Confetti\r\n  >c-9,6,Cake"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetCranius.txt" - Parse error: Failed to parse completely. Remaining: "= #808080   //grey\r\n\r\n//CHOOSE YOUR CHEST---------------------------------------<\r\n//Replace with one below: bone | delta\r\nchestType = delta\r\n\r\n?chestType = bone\r\n  chestColor = #white\r\n:?chestType = delta\r\n  chestColor = #rainbow\r\n\r\nvar keepDistance = -50 // distance at which the movement animation will play (stateMoving)\r\nvar maxX = -24         // closest offset pet will get to character.  Closer to 0, closer to character\r\nvar maxDistance = -70  // if the pet exceeds this distance, it will teleport to this distance (cannot be further away than this)\r\nvar targetZ = 2       // We want to start the drawing 1 unit above the player agent\r\n\r\n?loc.loop\r\n  keepDistance = -50\r\n  maxX = -24\r\n  maxDistance = -70\r\n  targetZ = 2\r\n\r\nvar x = 0\r\nvar y = 0\r\nvar myX = 0\r\nvar myZ = 0\r\nvar lastPlayerX = 0\r\nvar lastPlayerZ = 0\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1\r\nvar stateMoving = 2\r\nvar currentState = stateNone\r\nvar stateTime = 0\r\nvar chestTime = 0\r\n\r\n\r\nfunc SetState(newState)\r\n  ?newState = stateMoving\r\n    play haunted_gate_shuffle //play sound when moving\r\n  currentState = newState\r\n  stateTime = 0\r\n\r\n?currentState = stateNone | time = 1\r\n  lastPlayerX = pos.x\r\n  lastPlayerZ = pos.z\r\n  myX = keepDistance\r\n  myZ = targetZ\r\n\r\n// Start further away if skully is summoned while the location is already running\r\n  ?time > 1\r\n    myX = maxDistance\r\n\r\n  SetState(stateIdle)\r\n\r\nmyX = myX - (pos.x - lastPlayerX) // If player has moved, increment myX (distance from player)\r\n\r\nstateTime++\r\n\r\n?face = \"( ^^\" & stateTime > 30\r\n  chestTime++\r\n?face ! \"( ^^\"\r\n  chestTime = 0\r\n\r\n?currentState = stateIdle \r\n  ?myX < maxDistance | myX > -maxDistance\r\n    myX = maxDistance\r\n  myZ = myZ - (pos.z - lastPlayerZ)\r\n\r\n  ?myX < keepDistance\r\n    SetState(stateMoving)\r\n\t\r\n:?currentState = stateMoving & chestTime = 0\r\n  ?myX < maxX\r\n    myX++\r\n\t\r\n  ?stateTime >= 6\r\n    ?myZ > targetZ\r\n      myZ--\r\n    :?myZ < targetZ\r\n      myZ++\r\n\r\n  ?stateTime >= 12\r\n    SetState(stateIdle)\r\n\t\r\nlastPlayerX = pos.x\r\nlastPlayerZ = pos.z\r\n\r\n//DRAW state timers--------------------------------<\r\n//for debugging or whatever, uncomment if you want to see\r\n\r\n//>`0,7,StateTime = @stateTime@\r\n//>`0,8,ChestTime = @chestTime@\r\n\r\n//IDLE---------------------------------------------<\r\n\r\n?currentState = stateIdle & face ! \"( ^^\" \r\n  >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n###########_.-----._ ___///‾`\r\n#########.'         '.     '.|\r\n########/    ___,  __,\\     |;\r\n#######|  \\ (_*) ,(_*);-----|.\r\n#######|   ) _  /!)   )     | |\r\n########`.__,.)     ('      |  .\r\n#######/  '.  `'\"\"'´/.______|. '.\r\n######| \\  \\‾._____/ ;.._   `.  |\r\n######|. '-.__,''._.'####‾‾-____)\r\n######\\ '.___,''._.'\r\n#####.' \\__\\##/__/\r\n####[_.'####\r\nasciiend\r\n  >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#\r\n#####################___\r\n###########################'.\r\n############################|\r\n#######################-----|\r\n############################|\r\n############################|\r\n######################______|\r\nasciiend\r\n    >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n######(  )\r\n#######\\ \\\r\n########\\ \\\r\n#########\\ \\\r\n##########\\ \"..______.-‾‾‾`.\r\n###########(________;__,-\\\\\\>\r\nasciiend\r\n\r\n//EYES----------------------------------------<\r\n?currentState = stateIdle\r\n  ?face = \"°°\"\r\n      ?time % 10 = 0 & myX > keepDistance\r\n        myX--\r\n\r\n      ?time % 4 <= 1\r\n        >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#############___,  __,\r\n############(_^) ,(_^)\r\nasciiend\r\n      ?time % 4 > 1\r\n       >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#############___,  __,\r\n############(_^) ,(_^)\r\nasciiend\r\n\r\n//BLINKING----------------------------\r\n\r\n  ?face ! \"( ^^\"\r\n    ?stateTime % 50 >= 48\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#############___,  __,\r\n############(==) ,(==)\r\nasciiend\r\n    :?stateTime % 50 >= 46\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#############___,  __,\r\n############(--) ,(--)\r\nasciiend\r\n    :?stateTime % 50 >= 44\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#############___,  __,\r\n############(==) ,(==)\r\nasciiend\r\n\r\n//CHEST ANIMATION-----------------------------------------------<\r\n\r\n  x = myX + 6\r\n  y = myZ + 4\r\n?face = \"( ^^\" \r\n ?chestTime <= 5\r\n\t  >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n###########_.-----._ ___///‾`\r\n#########.'         '.     '.|\r\n########/    ___,  __,\\     |;\r\n#######|  \\ (_*) ,(_*);-----|.\r\n#######|   ) _  /!)   )     | |\r\n########`.__,.)     ('      |  .\r\n#######/  '.  `'\"\"'´/.______|. '.\r\n######| \\  \\‾._____/ ;.._   `.  |\r\n######|. '-.__,''._.'####‾‾-____)\r\n######\\ '.___,''._.'\r\n#####.' \\__\\##/__/\r\n####[_.'####\r\nasciiend\r\n      >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#\r\n#####################___\r\n###########################'.\r\n############################|\r\n#######################-----|\r\n############################|\r\n############################|\r\n######################______|\r\nasciiend\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n######(  )\r\n#######\\ \\\r\n########\\ \\\r\n#########\\ \\##########_.'‾‾.\r\n##########\\ \"..______.     ‾,\r\n###########(________(_____,/\r\nasciiend\r\n//-------------------------------\r\n :?chestTime <= 10\r\n\t  >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n###########_.-----._ ___///‾`\r\n#########.'         '.     '.|\r\n########/    ___,  __,\\     |;\r\n#######|  \\ (_*) ,(_*);-----|.\r\n#######|   ) _  /!)   )     | |\r\n########`.__,.)     ('      |  .\r\n#######/  '.  `'\"\"'´/.______|. '.\r\n######| \\  \\‾._____/ ;.._   `.  |\r\n######|. '-.__,''._.'####‾‾-____)\r\n######\\ '.___,''._.'\r\n#####.' \\__\\##/__/\r\n####[_.'####\r\nasciiend\r\n  >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#\r\n#####################___\r\n###########################'.\r\n############################|\r\n#######################-----|\r\n############################|\r\n############################|\r\n######################______|\r\nasciiend\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n######(  )\r\n#######\\ \\\r\n########\\ \\\r\n#########\\ \\\r\n##########\\ \"..______.->####.\r\n###########(________;____;//\r\nasciiend\r\n      ?chestType = bone\r\n        >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n########################\r\n########################---\r\n#\r\nasciiend\r\n      :?chestType = delta\r\n       >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n########################\r\n########################---\r\n#\r\nasciiend\r\n :?chestTime <= 45\r\n\t  >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n###########_.-----._ ___///‾`\r\n#########.'         '.     '.|\r\n########/    ___,  __,\\     |;\r\n#######|  \\ (_*) ,(_*);-----|.\r\n#######|   ) _  /!)   )     | |\r\n########`.__,.)     ('      |  .\r\n#######/  '.  `'\"\"'´/.______|. '.\r\n######| \\  \\‾._____/ ;.._   `.  |\r\n######|. '-.__,''._.'####‾‾-____)\r\n######\\ '.___,''._.'\r\n#####.' \\__\\##/__/\r\n####[_.'####\r\nasciiend\r\n      >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#\r\n#####################___\r\n###########################'.\r\n############################|\r\n#######################-----|\r\n############################|\r\n############################|\r\n######################______|\r\nasciiend\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n######(  )\r\n#######\\ \\\r\n########\\ \\\r\n#########\\ \\\r\n##########\\ \"..______.->####,\r\n###########(________;____;//\r\nasciiend\r\n      ?chestType = bone\r\n        >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n########################___\r\n########################=o=╪3\r\n#\r\nasciiend\r\n      ?chestType = delta\r\n        >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n########################___\r\n########################-∆-╡\r\n#\r\nasciiend\r\n//-------------------------------\r\n :?chestTime <= 50\r\n\t  >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n###########_.-----._ ___///‾`\r\n#########.'         '.     '.|\r\n########/    ___,  __,\\     |;\r\n#######|  \\ (_*) ,(_*);-----|.\r\n#######|   ) _  /!)   )     | |\r\n########`.__,.)     ('      |  .\r\n#######/  '.  `'\"\"'´/.______|. '.\r\n######| \\  \\‾._____/ ;.._   `.  |\r\n######|. '-.__,''._.'####‾‾-____)\r\n######\\ '.___,''._.'\r\n#####.' \\__\\##/__/\r\n####[_.'####\r\nasciiend\r\n      >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#\r\n#####################___\r\n###########################'.\r\n############################|\r\n#######################-----|\r\n############################|\r\n############################|\r\n######################______|\r\nasciiend\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n######(  )\r\n#######\\ \\\r\n########\\ \\\r\n#########\\ \\##########_.'‾‾.\r\n##########\\ \"..______.     ‾,\r\n###########(________(_____,/\r\nasciiend\r\n//-------------------------------\r\n :?chestTime <= 60 | chestTime > 60\r\n\t  >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n###########_.-----._ ___///‾`\r\n#########.'         '.     '.|\r\n########/    ___,  __,\\     |;\r\n#######|  \\ (_*) ,(_*);-----|.\r\n#######|   ) _  /!)   )     | |\r\n########`.__,.)     ('      |  .\r\n#######/  '.  `'\"\"'´/.______|. '.\r\n######| \\  \\‾._____/ ;.._   `.  |\r\n######|. '-.__,''._.'####‾‾-____)\r\n######\\ '.___,''._.'\r\n#####.' \\__\\##/__/\r\n####[_.'####\r\nasciiend\r\n      >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#\r\n#####################___\r\n###########################'.\r\n############################|\r\n#######################-----|\r\n############################|\r\n############################|\r\n######################______|\r\nasciiend\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n######(  )\r\n#######\\ \\\r\n########\\ \\\r\n#########\\ \\\r\n##########\\ \"..______.-‾‾‾`.\r\n###########(________;__,-\\\\\\>\r\nasciiend\r\n\r\n\r\n//MOVING-------------------------------------------<\r\n?currentState = stateMoving\r\n  ?stateTime/2 = 0\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n###########_.-----._ ___///‾`\r\n#########.'         '.     '.|\r\n########/    ___,  __,\\     |;\r\n#######|  \\ (_*) ,(_*);-----|.\r\n#######|   ) _  /!)   )     | |\r\n########`.__,.)     ('      |  .\r\n#######/  '.  `'\"\"'´/.______|. '.\r\n######| \\  \\‾._____/ ;.._   `.  |\r\n######|. '-.__,''._.'####‾‾-____)\r\n######\\ '.___,''._.'\r\n#####.' \\__\\##/__/\r\n####[_.'####\r\nasciiend\r\n      >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#\r\n#####################___\r\n###########################'.\r\n############################|\r\n#######################-----|\r\n############################|\r\n############################|\r\n######################______|\r\nasciiend\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n######(  )\r\n#######\\ \\\r\n########\\ \\\r\n#########\\ \\\r\n##########\\ \"..______.-‾‾‾`.\r\n###########(________;__,-\\\\\\>\r\nasciiend\r\n\r\n  ?stateTime/2 = 1\r\n       >o@myX@,@myZ-12@,@skullColor@,ascii\r\n###########_.-----._ __///‾`\r\n#########.'         '.    '.|\r\n########/    ___,  __,\\    |;\r\n#######|  \\ (_*) ,(_*);----|.\r\n#######|   ) _  /!)   )    | |\r\n########`.__,.)     ('     |  .\r\n#######/  '.  `'\"\"'´/._____|. '.\r\n######| \\  \\‾._____/ ;._   `.  |\r\n######|. '-.__,''._.'###‾‾-____)\r\n######\\ '.___,''._.'\r\n#####.' \\__\\##/__/\r\n####[_.'####\r\n#\r\nasciiend\r\n      >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#####################__\r\n##########################'.\r\n###########################|\r\n#######################----|\r\n###########################|\r\n###########################|\r\n######################_____|\r\nasciiend\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n######(  )\r\n#######\\ \\\r\n########\\ \\\r\n#########\\ \\\r\n##########\\ \"..______.-‾‾‾`.\r\n###########(________;__,-///>\r\nasciiend\r\n\r\n  ?stateTime/2 = 2\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n###########_.-----._ _///‾`\r\n#########.'         '.   '.|\r\n########/    ___,  __,\\   |;\r\n#######|  \\ (_*) ,(_*);---|.\r\n#######|   ) _  /!)   )   | |\r\n########`.__,.)     ('    |  .\r\n#######/  '.  `'\"\"'´/.____|. '.\r\n######| \\  \\‾._____/ ;_   `.  |\r\n######|. '-.__,''._.'##‾‾-____)\r\n######\\ '.___,''._.'\r\n#####.' \\__\\##/__/\r\n####[_.'####\r\n#\r\nasciiend\r\n      >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#####################_\r\n#########################'.\r\n##########################|\r\n#######################---|\r\n##########################|\r\n##########################|\r\n######################____|\r\nasciiend\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n######(  )\r\n######| ;\r\n######| |\r\n######| |\r\n######\" '\r\n######. \\._______.-‾‾‾`.\r\n######(________;__,-///>\r\nasciiend\r\n  ?stateTime/2 = 3\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n###########_.-----._ _///‾`\r\n#########.'         '.   '.|\r\n########/    ___,  __,\\   |;\r\n#######|  \\ (_*) ,(_*);---|.\r\n#######|   ) _  /!)   )   | |\r\n########`.__,.)     ('    |  .\r\n#######/  '.  `'\"\"'´/.____|. '.\r\n######| \\  \\‾._____/ ;_   `.  |\r\n######|. '-.__,''._.'##‾‾-____)\r\n######\\ '.___,''._.'\r\n#####.' \\__\\##/__/\r\n####[_.'####\r\n#\r\nasciiend\r\n      >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#####################_\r\n#########################'.\r\n##########################|\r\n#######################---|\r\n##########################|\r\n##########################|\r\n######################____|\r\nasciiend\r\n    >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n######(  )\r\n######| ;\r\n######| |\r\n######| |\r\n######' '\r\n#####; '_______.-‾‾‾`.\r\n####(________;__,-///>\r\nasciiend\r\n\r\n  ?stateTime/2 = 4\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n###########_.-----._ _///‾`\r\n#########.'         '.   '.|\r\n########/    ___,  __,\\   |;\r\n#######|  \\ (_*) ,(_*);---|.\r\n#######|   ) _  /!)   )   | |\r\n########`.__,.)     ('    |  .\r\n#######/  '.  `'\"\"'´/.____|. '.\r\n######| \\  \\‾._____/ ;_   `.  |\r\n######|. '-.__,''._.'##‾‾-____)\r\n######\\ '.___,''._.'\r\n#####.' \\__\\##/__/\r\n####[_.'####\r\n#\r\nasciiend\r\n      >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#####################_\r\n#########################'.\r\n##########################|\r\n#######################---|\r\n##########################|\r\n##########################|\r\n######################____|\r\nasciiend\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n######(  )\r\n######; /\r\n#####/ /\r\n####/ /\r\n###; '.______.-‾‾‾`.\r\n##(________;__,-///>\r\nasciiend\r\n\r\n  ?stateTime/2 = 5\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n###########_.-----._ __///‾`\r\n#########.'         '.    '.|\r\n########/    ___,  __,\\    |;\r\n#######|  \\ (_*) ,(_*);----|.\r\n#######|   ) _  /!)   )    | |\r\n########`.__,.)     ('     |  .\r\n#######/  '.  `'\"\"'´/._____|. '.\r\n######| \\  \\‾._____/ ;._   `.  |\r\n######|. '-.__,''._.'###‾‾-____)\r\n######\\ '.___,''._.'\r\n#####.' \\__\\##/__/\r\n####[_.'####\r\n#\r\nasciiend\r\n      >o@myX@,@myZ-12@,@chestColor@,ascii\r\n#####################__\r\n##########################'.\r\n###########################|\r\n#######################----|\r\n###########################|\r\n###########################|\r\n######################_____|\r\nasciiend\r\n      >o@myX@,@myZ-12@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n######(  )\r\n######;   '.\r\n#####‾ /    ‾. \r\n####_  / ‾‾-- ‾.___  \r\n###-               ‾‾.\r\n###((___---‾‾‾----,,///>\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetCrab.txt" - Parse error: Failed to parse completely. Remaining: "= #FF4444\r\nshellColor = #FFFF99\r\n\r\nvar keepDistance = -20 // distance at which the movement animation will play (stateScuttle)\r\nvar maxX = -15         // closest offset pet will get to character.  Closer to 0, closer to character\r\nvar maxDistance = -100 // if the pet exceeds this distance, it will teleport to this distance (cannot be further away than this)\r\nvar targetZ = -1       // We want to start the drawing 1 unit above the player agent\r\nvar headcrab = 0       //if the crab gets in front of the player, he will jump on his head\r\nvar mandibles = 0      //if in headcrab mode, allows idle animation without spam during continuous scuttle\r\n\r\n?loc.loop\r\n  keepDistance = -20\r\n  maxX = -15\r\n  maxDistance = -100\r\n  targetZ = -1\r\n  headcrab = 0\r\n  mandibles = 0\r\n\r\nvar x = 0\r\nvar y = 0\r\nvar myX = 0\r\nvar myZ = 0\r\nvar lastPlayerX = 0\r\nvar lastPlayerZ = 0\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1\r\nvar stateScuttle = 2\r\nvar currentState = stateNone\r\nvar stateTime = 0\r\n\r\nfunc SetState(newState)\r\n  ?newState = stateScuttle & headcrab = 0\r\n    play ant_walk // sound played when pet moves\r\n  currentState = newState\r\n  stateTime = 0\r\n  ?mandibles >= 5\r\n    mandibles = 0\r\n\r\n?currentState = stateNone | time = 1\r\n  lastPlayerX = pos.x\r\n  lastPlayerZ = pos.z\r\n  myX = keepDistance\r\n  myZ = targetZ\r\n\r\n  // Start further away if the crab is summoned while the location is already running\r\n  ?time > 1\r\n    myX = maxDistance\r\n\r\n  SetState(stateIdle)\r\n\r\nmyX = myX - (pos.x - lastPlayerX) // If player has moved, increment myX (distance from player)\r\n\r\nstateTime++\r\n\r\n?myX >= -8 & headcrab = 0\r\n  headcrab = 1\r\n  targetZ = -4\r\n  maxX = -5\r\n  keepDistance = -4\r\n?headcrab = 1\r\n  ?myX ! -5\r\n    myX = -5\r\n  \r\n\r\n?currentState = stateIdle\r\n  ?myX < maxDistance | myX > -maxDistance\r\n    myX = maxDistance\r\n  ?headcrab = 0\r\n    myZ = myZ - (pos.z - lastPlayerZ)\r\n\r\n  ?myX < keepDistance\r\n    SetState(stateScuttle)\r\n\r\n:?currentState = stateScuttle\r\n  ?headcrab\r\n    myX = maxX\r\n  :?myX < maxX\r\n    myX++\r\n\r\n  ?stateTime >= 6\r\n    ?myZ > targetZ\r\n      myZ--\r\n    :?myZ < targetZ\r\n      myZ++\r\n\r\n  ?stateTime >= 12\r\n    ?headcrab = 1\r\n      mandibles++\r\n    SetState(stateIdle)\r\n\r\nlastPlayerX = pos.x\r\nlastPlayerZ = pos.z\r\n\r\n// Draw\r\n?currentState = stateIdle\r\n  >o@myX@,@myZ@,@crabColor@,ascii\r\n#\r\n#\r\n#\r\n####{Oo}\r\n##//(;;)\\\r\nasciiend\r\n  >o@myX@,@myZ@,@shellColor@,ascii\r\n###__\r\n##(__)_\r\n#(_____)_\r\n#(__####_)\r\nasciiend\r\n  x = myX + 2\r\n  y = myZ + 3\r\n  ?face = \"( ^^\"\r\n    >o@x@,@y@,@crabColor@,ascii\r\n###^^\r\nasciiend\r\n  :?face = \"( TT\"\r\n    >o@x@,@y@,@crabColor@,ascii\r\n###><\r\nasciiend\r\n  :?face = \"°°\"\r\n    ?time % 10 = 0 & myX > keepDistance\r\n      myX--\r\n    ?time % 4 <= 1\r\n      >o@x@,@y@,@crabColor@,ascii\r\n##[oO]\r\n<<{::}>\r\nasciiend\r\n    ?time % 4 > 1\r\n      >o@x@,@y@,@crabColor@,ascii\r\n##{Oo}\r\n//(;;)\\\r\nasciiend\r\n  :?stateTime % 50 >= 48\r\n    >o@x@,@y@,@crabColor@,ascii\r\n###O-\r\n##{::}\r\nasciiend\r\n  :?stateTime % 50 >= 46\r\n    >o@x@,@y@,@crabColor@,ascii\r\n###=-\r\n##(\"\")\r\nasciiend\r\n  :?stateTime % 50 >= 44\r\n    >o@x@,@y@,@crabColor@,ascii\r\n###--\r\n##{::}\r\nasciiend\r\n\r\n?currentState = stateScuttle\r\n  ?stateTime/3 = 0\r\n    >o@myX@,@myZ@,@crabColor@,ascii\r\n#\r\n#\r\n#\r\n####{Oo}\r\n##>/(;;)|\r\nasciiend\r\n    >o@myX@,@myZ@,@shellColor@,ascii\r\n###__\r\n##(__)__\r\n##(_____)\r\n#(__####_)\r\nasciiend\r\n\r\n  :?stateTime/3 = 1\r\n    >o@myX@,@myZ@,@crabColor@,ascii\r\n#\r\n#\r\n#\r\n####{Oo}\r\n##\\>(;;)/\r\nasciiend\r\n    >o@myX@,@myZ@,@shellColor@,ascii\r\n####__\r\n###(__)_\r\n##(_____)\r\n#(__####_)\r\nasciiend\r\n\r\n  :?stateTime/3 = 2\r\n    >o@myX@,@myZ@,@crabColor@,ascii\r\n#\r\n#\r\n#\r\n####{Oo}\r\n##|\\(;;)>\r\nasciiend\r\n    >o@myX@,@myZ@,@shellColor@,ascii\r\n####__\r\n##_(__)\r\n#(_____)_\r\n#(__####_)\r\nasciiend\r\n\r\n  :?stateTime/3 = 3\r\n    >o@myX@,@myZ@,@crabColor@,ascii\r\n#\r\n#\r\n#\r\n####{Oo}\r\n##/|(;;)\\\r\nasciiend\r\n    >o@myX@,@myZ@,@shellColor@,ascii\r\n###__\r\n##(__)_\r\n#(_____)_\r\n#(__####_)\r\nasciiend\r\n  x = myX + 2\r\n  y = myZ + 3\r\n  ?face = \"( ^^\"\r\n    >o@x@,@y@,@crabColor@,ascii\r\n###^^\r\nasciiend\r\n  :?face = \"°°\"\r\n    ?time % 10 = 0 & myX > keepDistance\r\n      myX--\r\n    ?time % 4 <= 1\r\n      >o@x@,@y@,@crabColor@,ascii\r\n##[oO]\r\n<<{::}>\r\nasciiend\r\n    ?time % 4 > 1\r\n      >o@x@,@y@,@crabColor@,ascii\r\n##{Oo}\r\n//(;;)\\\r\nasciiend\r\n  :?mandibles >= 4 & stateTime % 50 >= 10\r\n    >o@x@,@y@,@crabColor@,ascii\r\n###O-\r\n##{::}\r\nasciiend\r\n  :?mandibles >= 4 & stateTime % 50 >= 8\r\n    >o@x@,@y@,@crabColor@,ascii\r\n###=-\r\n##(\"\")\r\nasciiend\r\n  :?mandibles >= 4 & stateTime % 50 >= 6\r\n    >o@x@,@y@,@crabColor@,ascii\r\n###--\r\n##{::}\r\nasciiend\r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/CatBalloon.txt" - Parse error: Failed to parse completely. Remaining: "= #ffffff\r\nvar PET_COLOR2 = #FFBFFF\r\nvar ANIM_LOOP_TIME = 80\r\n\r\n//ART========================\r\nvar petArt = ui.AddAnim(ascii\r\n######__\r\n##•´‾(  )‾`•\r\n#´   /‾‾\\   `\r\n|   •    •   |\r\n.   |    |   .\r\n#\\  .    .  /\r\n##\\  \\  /  /\r\n###'. •• .'\r\n#####│##│\r\n#####│##│\r\n####.│──┴──.\r\n###¡‾‾‾‾‾‾¡│\r\n###│______│,\r\nasciiend)\r\n\r\nvar petArt2 = ui.AddAnim(ascii\r\n#####,\r\n#-.-´'\\\r\n#\\ oω°)\r\n%%\r\n#####,\r\n#-.-´'\\\r\n#\\ oω°)\r\n%%\r\n#####,\r\n#-.-´'\\\r\n#\\ oω°)\r\n%%\r\n#####,\r\n#-.-´'\\\r\n#\\ oω°)\r\n%%\r\n#####,\r\n#-.-´'\\\r\n#\\ oω°)\r\n%%\r\n#####,\r\n#-.-´'\\\r\n#\\ oω°)\r\n%%\r\n#####,\r\n#-.-´'\\\r\n#\\ oω°)\r\n%%\r\n#####,\r\n#-.-´'\\\r\n#\\ oω°)\r\n%%\r\n######,\r\n__.-~´|\r\n`. -ω´)\r\n%%\r\n#####,\r\n#-.-´'\\\r\n#\\ -ω´)\r\nasciiend)\r\n\r\n//========================\r\nvar halfLoopTime\r\nvar petX\r\nvar petHeight\r\nvar movingUp = true\r\nvar pos_x\r\nvar screen_w = screen.w\r\nvar offScreen_behind = false\r\nvar offScreen_ahead = false\r\nvar petScreenX\r\n\r\nvar petPnl\r\n\r\npetMain()\r\n\r\nfunc initPet()\r\n  var addAndInitAnim = func(anim, x, y, dur, loop, color)\r\n    petPnl.Add(anim)\r\n    anim.anchor = top_left\r\n    anim.dock = top_left\r\n    anim.x = x\r\n    anim.y = y\r\n    anim.duration = dur\r\n    anim.loop = loop\r\n    anim.color = color\r\n    anim.Play()\r\n  \r\n  var style = ui.AddStyle(\"\r\n^###\r\n^###\r\n^###\")\r\n  petPnl = ui.AddPanel()\r\n  petPnl.h = 1\r\n  petPnl.w = 1\r\n  petPnl.style = style\r\n  petPnl.anchor = top_left\r\n  petPnl.dock = top_left\r\n  addAndInitAnim(petArt, X_OFFSET, Y_OFFSET, ANIM_LOOP_TIME, true, PET_COLOR1)\r\n  addAndInitAnim(petArt2, X_OFFSET+ART2_X_OFFSET, Y_OFFSET+ART2_Y_OFFSET, ANIM_LOOP_TIME, true, PET_COLOR2)\r\n  resetPet()\r\n\r\nfunc resetPet()\r\n  petX = pos_x - screen_w\r\n  petHeight = MIN_HEIGHT\r\n  movingUp = true\r\n  \r\nfunc petMain()\r\n  pos_x = pos.x\r\n  ?!petPnl\r\n    initPet()\r\n  petScreenX = screen.FromWorldX(petX + X_OFFSET)\r\n  offScreen_behind = petScreenX < MIN_X\r\n  offScreen_ahead = petScreenX > MAX_X\r\n  ?(time%X_MOVE_RATE = 0 | offScreen_behind) & !offScreen_ahead\r\n    ?offScreen_behind\r\n      petX += X_MOVE_SPEED*2\r\n    :\r\n      petX += X_MOVE_SPEED\r\n  :?petScreenX > MAX_X\r\n    resetPet()\r\n  ?movingUp\r\n    petHeight = getHeightArch() - MIN_HEIGHT\r\n  :\r\n    petHeight = -1*getHeightArch() - MIN_HEIGHT\r\n  ?getPercentHalfLoop() = 1\r\n    movingUp = !movingUp\r\n  var printX = screen.FromWorldX(petX + X_OFFSET)\r\n  var printY = screen.FromWorldZ(petHeight + Y_OFFSET)\r\n  petPnl.x = printX\r\n  petPnl.y = printY\r\n  \r\nfunc getHeightArch()\r\n  //creates a parabola between start and end points, with max height\r\n  //a = -jumpheight / (( mid - start )( mid - end ))\r\n  //(y(x) = ( x - start )( x - end )a\r\n  var multi = getHeightDiff()/0.125\r\n  var XMinusStart = getPercentHalfLoop()\r\n  var XMinusEnd = getPercentHalfLoop()-1\r\n  var result = XMinusStart*XMinusEnd*multi\r\n  return math.RoundToInt(result)\r\n\r\nfunc getHeightDiff()\r\n  return MAX_HEIGHT - MIN_HEIGHT\r\n  \r\nfunc getPercentHalfLoop()\r\n  var halfLoopTime = LOOP_TIME/2.0\r\n  return (time%halfLoopTime)/halfLoopTime"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Mech.txt" - Parse error: Failed to parse completely. Remaining: "= ［ascii\r\n#######.=≡=.\r\n######/__ __\\\r\n######\\‾‾ ‾‾/\r\n#######`• •´\r\n#_##</^_/ \\_^\\>##_\r\n( )#|o/［《¤》］\\o|#( )\r\n\\ \\/ ］ \\   / ［ \\/ /\r\n#'. /  /］U［\\  \\_.'\r\n###‾##/ / \\ \\\r\n#####í Í###Ì ì\r\n#####| |###| |\r\n####(_/｝###｛\\_)\r\nasciiend,ascii\r\n#######.=≡=.\r\n######/__ __\\\r\n######\\‾‾ ‾‾/\r\n#######`• •´\r\n#_##</^_/ \\_^\\>##_\r\n( )#|o/［《¤》］\\o|#( )\r\n\\ \\/ ］ \\   / ［ \\/ /\r\n#'. /  /］U［‾) \\_.'\r\n###‾##/ /  \\ \\\r\n#####í Í###| /\r\n#####| |###｛\\_)\r\n####(_/｝###\r\nasciiend,ascii\r\n#######.=≡=.\r\n######/__ __\\\r\n######\\‾‾ ‾‾/\r\n#######`• •´\r\n#_##</^_/ \\_^\\>##_\r\n( )#|o/［《¤》］\\o|#( )\r\n\\ \\/ ］ \\   / ［ \\/ /\r\n#'. /  /］U［‾`•\\_.'\r\n###‾##/ /  `• |\r\n#####í Í###| \\\r\n#####| |####｛\\_)\r\n####(_/｝##\r\nasciiend,ascii\r\n#######.=≡=.\r\n######/__ __\\\r\n######\\‾‾ ‾‾/\r\n#######`• •´\r\n#_##</^_/ \\_^\\>##_\r\n( )#|o/［《¤》］\\o|#( )\r\n\\ \\/ ］ \\   / ［ \\/ /\r\n#'. /  /］U［‾• \\_.'\r\n###‾##/ /  \\ \\\r\n#####í Í####\\ Ì\r\n#####| |####| \\\r\n####(_/｝####｛\\_)\r\nasciiend,ascii\r\n#######.=≡=.\r\n######/__ __\\\r\n######\\‾‾ ‾‾/\r\n#######`• •´\r\n#_##</^_/ \\_^\\>##_\r\n( )#|o/［《¤》］\\o|#( )\r\n\\ \\/ ］ \\   / ［ \\/ /\r\n#'. /  /］U［\\  \\_.'\r\n###‾##/ / \\ \\\r\n#####í Í###Ì ì\r\n#####| |###| |\r\n####(_/｝###｛\\_)\r\nasciiend,ascii\r\n#######.=≡=.\r\n######/__ __\\\r\n######\\‾‾ ‾‾/\r\n#######`• •´\r\n#_##</^_/ \\_^\\>##_\r\n( )#|o/［《¤》］\\o|#( )\r\n\\ \\/ ］ \\   / ［ \\/ /\r\n#'. / •‾］U［\\  \\_.'\r\n###‾#/ /  \\ \\\r\n#####\\ |###Ì ì\r\n####(_/｝###| |\r\n###########｛\\_)\r\nasciiend,ascii\r\n#######.=≡=.\r\n######/__ __\\\r\n######\\‾‾ ‾‾/\r\n#######`• •´\r\n#_##</^_/ \\_^\\>##_\r\n( )#|o/［《¤》］\\o|#( )\r\n\\ \\/ ］ \\   / ［ \\/ /\r\n#'. /  /］U［\\  \\_.'\r\n###‾##/ / \\ \\\r\n######\\ \\##Ì ì\r\n#####(_/｝##| |\r\n###########｛\\_)\r\nasciiend,ascii\r\n#######.=≡=.\r\n######/__ __\\\r\n######\\‾‾ ‾‾/\r\n#######`• •´\r\n#_##</^_/ \\_^\\>##_\r\n( )#|o/［《¤》］\\o|#( )\r\n\\ \\/ ］ \\   / ［ \\/ /\r\n#'. /  /］U［\\  \\_.'\r\n###‾##• / \\ \\\r\n######| |##Ì ì\r\n######| |##| |\r\n#####(_/｝##｛\\_)\r\nasciiend］\r\n\r\nvar MechGunner1 = ascii\r\n#######.=≡=.\r\n######/__ __\\\r\n######\\‾‾ ‾‾/\r\n#######`• •´\r\n#   </^_/ \\_^\\>   #\r\n  .•´o/［《¤》］\\o \\.  #\r\n################|\r\n######_#####_####\r\n####•(_)###(_)‾,/\r\n##############‾\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechGunner2 = ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n   #############   #\r\n •------°-----^\\#   #\r\n#［ /\\ #_____#  ｝>===≡\r\n#`-'#•_´/‾‾###‾\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechGunnerAmmo = ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#########［(\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\n//right hand crossbow\\\\\r\nvar MechCrossbowsR1 = ascii\r\n#\r\n#\r\n#\r\n#\r\n############^\\>##_\r\n############\\o|#( )\r\n############ ［ \\/ /\r\n############  \\_.'\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechCrossbowsR2 = ascii\r\n#\r\n#\r\n#\r\n###############║│\r\n###############║│\r\n###############║###|\r\n###############`\r\n#\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechCrossbowsR3 = ascii\r\n#\r\n#\r\n#\r\n#\r\n#######_/ \\_^\\>## #\r\n#######［《¤》］\\o|#   #\r\n#######\\   /［ \\_\r\n########］U［# \\__(_)\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechCrossbowsR4 = ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n################,═════\r\n###################‾‾‾\r\n#################‾\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechCrossbowsR5 = ascii\r\n#\r\n#\r\n#\r\n#\r\n#######_/ \\_^\\>## #\r\n#######［《¤》］|o/#   #\r\n#######\\   //<_\r\n########］U［#\\__(_)\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechCrossbowsR6 = ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n##\r\n###############,═════\r\n##################‾‾‾\r\n################‾\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\n//left hand crossbow\\\\\r\nvar MechCrossbowsL1 = ascii\r\n#\r\n#\r\n#\r\n#\r\n##_##</^_/ \\_\r\n#( )#|o/［《¤》］\r\n#\\ \\/ ］ \\   /\r\n##'. /  #］U［\r\n####‾#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechCrossbowsL2 = ascii\r\n#\r\n#\r\n#\r\n###│║\r\n###│║\r\n|###║\r\n####´\r\n#\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechCrossbowsL3 = ascii\r\n#\r\n#\r\n#\r\n#\r\n## ##</^_/ \\_\r\n#   #|o/［《¤》］\r\n#    ［ \\\r\n##    \\_(_)\r\n#### #\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechCrossbowsL4 = ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n########,═════\r\n###########‾‾‾\r\n#########‾\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechCrossbowsL5 = ascii\r\n#\r\n#\r\n#\r\n#\r\n## ##</^_/ \\_\r\n#   #/o/［《¤》］\r\n#   ［ <\r\n##   \\_(_)\r\n#### #\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechCrossbowsL6 = ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#######,═════\r\n##########‾‾‾\r\n########‾\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechBlade1 = ascii\r\n###########.=≡=.\r\n##########/__ __\\\r\n##########\\‾‾ ‾‾/\r\n###########`• •´\r\n##### ##</^_/ \\_^\r\n####   #|o/［《¤》\r\n####    \\  \\  #####)\r\n         `• `•.( )\r\n          #`•.( )### #\r\n##    #\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechBlade2 = ascii\r\n#################/|\r\n################/,|\r\n###############/  |\r\n##############/  /\r\n#############/  / #\r\n###########_┘• /   #\r\n###########`. <#   #\r\n##############`‾  #\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\n//right hand sword\\\\\r\nvar MechSwordsR1 = ascii\r\n#\r\n#\r\n#\r\n#\r\n#######_/ \\_^\\>###  #\r\n#######［《¤》］\\o|###  #\r\n#######\\   /［ \\###  #\r\n########］U［# \\_(‾)  #\r\n################‾   #\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechSwordsR2 = ascii\r\n#\r\n#\r\n#\r\n################|\r\n############### ║  #\r\n############### ║  #\r\n###############═╬═ #\r\n#\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechSwordsR3 = ascii\r\n#############(‾)\r\n#############\\‾\\\r\n##############\\ \\\r\n##############/ /\r\n#######_/ \\_^/ /   #\r\n#######［《¤》］|o/    #\r\n#######\\   /´      #\r\n########］U［#      #\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechSwordsR4 = ascii\r\n#######─════╬\r\n#\r\n#\r\n#\r\n#\r\n###############  #\r\n#############    #\r\n############    #\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechSwordsR5 = ascii\r\n#\r\n#\r\n#\r\n#\r\n#######_/ \\_^\\>     #\r\n#######［《¤》］\\o‾‾‾‾(‾)\r\n#######\\   / ‾‾‾‾‾‾‾#\r\n########］U［#        #\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechSwordsR6 = ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#####################╬════─\r\n#\r\n############      #\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\n//left hand sword\\\\\r\nvar MechSwordsL1 = ascii\r\n#\r\n#\r\n#\r\n#\r\n### ###</^_/ \\_\r\n### ###|o/［《¤》］\r\n### ###/ ］\\   /\r\n### (‾)_/ #］U［\r\n###  ‾ #\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechSwordsL2 = ascii\r\n#\r\n#\r\n#\r\n#####|\r\n#### ║ #\r\n#### ║ #\r\n####═╬═\r\n#\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechSwordsL3 = ascii\r\n######(‾)\r\n######/‾/\r\n#####/ /\r\n#####\\ \\\r\n###   \\ \\^_/ \\_\r\n###    \\o|［《¤》］\r\n###      `\\   /\r\n####      #］U［\r\n###### #\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechSwordsL4 = ascii\r\n─════╬#\r\n#\r\n#\r\n#\r\n#\r\n#####  #\r\n#####    #\r\n######    #\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechSwordsL5 = ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n##    </^_/ \\_\r\n##     \\o‾‾‾‾(‾)\r\n##      ‾‾‾‾‾‾‾\r\n##       #］U［\r\n#####   #\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechSwordsL6 = ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n################╬════─\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechShield1 = ascii\r\n#\r\n#\r\n#\r\n#\r\n#######_/ \\_^\\>\r\n#######［《¤》］\\o|\r\n#######\\   / `•\r\n########］U［\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechShield2 = ascii\r\n#\r\n#\r\n#\r\n##############\\‾‾‾‾‾‾\\\r\n###############|      |\r\n###############|      |\r\n###############|      |\r\n############## |      |\r\n##############/______/\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\n//right hand wand\\\\\r\nvar MechWandsR1 = ascii\r\n#\r\n#\r\n#\r\n#\r\n#######_/ \\_^\\>###  #\r\n#######［《¤》］\\o|###  #\r\n#######\\   /［ \\###  #\r\n########］U［# \\_(‾)  #\r\n################‾   #\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechWandsR2 = ascii\r\n#\r\n#\r\n################_\r\n###############(_)\r\n################║  #\r\n################║# #\r\n################║# #\r\n#\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechWandsR3 = ascii\r\n#############(‾)\r\n#############\\‾\\\r\n##############\\ \\\r\n##############/ /\r\n#######_/ \\_^/ /   #\r\n#######［《¤》］|o/    #\r\n#######\\   /´      #\r\n########］U［#      #\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechWandsR4 = ascii\r\n#####(‾)═════\r\n######‾\r\n#\r\n#\r\n#\r\n###############  #\r\n#############    #\r\n############    #\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechWandsR5 = ascii\r\n#\r\n#\r\n#\r\n#\r\n#######_/ \\_^\\>     #\r\n#######［《¤》］\\o\\     #\r\n#######\\   / \\‾‾‾‾(‾)\r\n########］U［#  ‾‾‾‾‾‾#\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechWandsR6 = ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n###########################_\r\n#####################═════(_)\r\n############      #\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\n//left hand wand\\\\\r\nvar MechWandsL1 = ascii\r\n#\r\n#\r\n#\r\n#\r\n##### ###</^_/ \\_\r\n##### ###|o/［《¤》］\r\n##### ###/ ］\\   /\r\n##### (‾)_/ #］U［\r\n#####  ‾ #\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechWandsL2 = ascii\r\n#\r\n#\r\n#######_\r\n######(_)\r\n###### ║\r\n#######║\r\n#######║\r\n#\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechWandsL3 = ascii\r\n########(‾)\r\n########/‾/\r\n#######/ /\r\n#######\\ \\\r\n#####   \\ \\^_/ \\_\r\n#####    \\o|［《¤》］\r\n#####      `\\   /\r\n######      #］U［\r\n######## #\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechWandsL4 = ascii\r\n(‾)═════\r\n#‾\r\n#\r\n#\r\n#\r\n#######  #\r\n#######    #\r\n########    #\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechWandsL5 = ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n####    </^_/ \\_\r\n####     \\oL《¤》］_\r\n####      \\____(_)\r\n####       #］U［\r\n######   #\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar MechWandsL6 = ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n########################_\r\n##################═════(_)\r\n#\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\n//keep the ＂#＂\\\\\r\n\r\n//color of mech can be changed\\\\\r\nvar MechColor = #red\r\n\r\n/* default is rainbow for all weapons but you\r\ncan switch it for individual weapons by \r\nreplacing ＂@MechWeaponColor@＂ with the desired\r\ncolor */\r\nvar MechWeaponColor = #rainbow\r\n\r\n/* default is rainbow for all shields but you\r\ncan switch it for individual weapons by \r\nreplacing ＂@MechShieldColor@＂ with the desired\r\ncolor */\r\nvar MechShieldColor = #rainbow\r\n\r\n/* default is rainbow for all items but you\r\ncan switch it for individual weapons by \r\nreplacing ＂@MechItemColor@＂ with the desired\r\ncolor */\r\nvar MechItemColor = #rainbow\r\n\r\nvar MechProgram\r\n\r\n?MechProgram\r\n  ?ai.walking\r\n   ?item.right = triskelion\r\n    >o-9,-5,@MechColor@,\r\n    ^@MechWlkR［time/2%MechWlkR.Count()］@\r\n   :\r\n    >o-9,-5,@MechColor@,\r\n    ^@MechWlkR［time/4%MechWlkR.Count()］@\r\n\r\n  :?item.right.state >= 1 |\r\n  ^item.left.state >= 1\r\n   >o-9,-5,@MechColor@,@MechIdle@\r\n  :?Debuffs.string = stun\r\n   >o-9,-5,@MechColor@,@MechIdle@\r\n  :?ai.idle & \r\n  ^item.right.state <= 1 | \r\n  ^item.left.state <= 1\r\n   >o-9,-5,@MechColor@,@MechIdle@\r\n\r\n  ?item.right = repeating crossbow\r\n   >o-9,-5,@MechWeaponColor@,@MechGunner2@\r\n   >o-9,-5,@MechColor@,@MechGunner1@\r\n   >o-9,-5,@MechWeaponColor@,@MechGunnerAmmo@\r\n\r\n  ?item.right = shield\r\n   >o-9,-5,@MechColor@,@MechShield1@\r\n   >o-9,-5,@MechShieldColor@,@MechShield2@\r\n\r\n  ?item.right = sword\r\n   ?item.right.state = 1\r\n    >o-9,-5,@MechColor@,\r\n    ^@MechSwordsR1@\r\n    >o-9,-5,@MechWeaponColor@,\r\n    ^@MechSwordsR2@\r\n   :?item.right.state = 2\r\n    >o-9,-5,@MechColor@,\r\n    ^@MechSwordsR3@\r\n    >o-9,-5,@MechWeaponColor@,\r\n    ^@MechSwordsR4@\r\n   :?item.right.state = 3\r\n    >o-9,-5,@MechColor@,\r\n    ^@MechSwordsR5@\r\n    >o-9,-5,@MechWeaponColor@,\r\n    ^@MechSwordsR6@\r\n\r\n  ?item.left = sword\r\n   ?item.left.state = 1\r\n    >o-12,-5,@MechColor@,\r\n    ^@MechSwordsL1@\r\n    >o-12,-5,@MechWeaponColor@,\r\n    ^@MechSwordsL2@\r\n   :?item.left.state = 2\r\n    >o-12,-5,@MechColor@,\r\n    ^@MechSwordsL3@\r\n    >o-12,-5,@MechWeaponColor@,\r\n    ^@MechSwordsL4@\r\n   :?item.left.state = 3\r\n    >o-11,-6,@MechColor@,\r\n    ^@MechSwordsL5@\r\n    >o-11,-6,@MechWeaponColor@,\r\n    ^@MechSwordsL6@\r\n\r\n  ?item.right = wand\r\n   ?item.right.state = 1\r\n    >o-9,-5,@MechColor@,@MechWandsR1@\r\n    >o-9,-5,@MechWeaponColor@,@MechWandsR2@\r\n   :?item.right.state = 2\r\n    >o-9,-5,@MechColor@,@MechWandsR3@\r\n    >o-9,-5,@MechWeaponColor@,@MechWandsR4@\r\n   :?item.right.state = 3\r\n    >o-9,-5,@MechColor@,@MechWandsR5@\r\n    >o-9,-5,@MechWeaponColor@,@MechWandsR6@\r\n\r\n  ?item.left = wand\r\n   ?item.left.state = 1\r\n    >o-14,-5,@MechColor@,@MechWandsL1@\r\n    >o-14,-5,@MechWeaponColor@,@MechWandsL2@\r\n   :?item.left.state = 2\r\n    >o-14,-5,@MechColor@,@MechWandsL3@\r\n    >o-14,-5,@MechWeaponColor@,@MechWandsL4@\r\n   :?item.left.state = 3\r\n    >o-14,-6,@MechColor@,@MechWandsL5@\r\n    >o-14,-6,@MechWeaponColor@,@MechWandsL6@\r\n\r\n  ?item.right = crossbow \r\n  ^& item.right ! repeating crossbow\r\n   ?item.right.state = 1\r\n    >o-9,-5,@MechColor@,@MechCrossbowsR1@\r\n    >o-9,-5,@MechWeaponColor@,@MechCrossbowsR2@\r\n   :?item.right.state = 2\r\n    >o-9,-5,@MechColor@,@MechCrossbowsR3@\r\n    >o-9,-5,@MechWeaponColor@,@MechCrossbowsR4@\r\n   :?item.right.state = 3\r\n    >o-9,-5,@MechColor@,@MechCrossbowsR5@\r\n    >o-9,-5,@MechWeaponColor@,@MechCrossbowsR6@\r\n\r\n  ?item.left = crossbow \r\n  ^& item.left ! repeating crossbow\r\n   ?item.left.state = 1\r\n    >o-10,-5,@MechColor@,@MechCrossbowsL1@\r\n    >o-10,-5,@MechWeaponColor@,@MechCrossbowsL2@\r\n   :?item.left.state = 2\r\n    >o-10,-5,@MechColor@,@MechCrossbowsL3@\r\n    >o-10,-5,@MechWeaponColor@,@MechCrossbowsL4@\r\n   :?item.left.state = 3\r\n    >o-10,-5,@MechColor@,@MechCrossbowsL5@\r\n    >o-10,-5,@MechWeaponColor@,@MechCrossbowsL6@\r\n\r\n  ?item.right = Blade\r\n   >o-13,-5,@MechColor@,@MechBlade1@\r\n   >o-9,-5,@MechWeaponColor@,@MechBlade2@\r\n\r\n//power switch, true = on, false = off\\\\\r\nMechProgram = true"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PartyNoisemaker.txt" - Parse error: Failed to parse completely. Remaining: "= #cyan\r\nvar stripeColor2 = #CC00CC\r\n\r\n?loc.begin \r\n  actionFrame = 0\r\n\r\n?actionFrame = 0\r\n >h-2,0,@stripeColor1@,ascii\r\n######_\r\n####-`-'\r\nasciiend\r\n >h-2,0,@stripeColor2@,ascii\r\n#\r\n#####`#'\r\nasciiend\r\n\r\n?actionFrame > 0 & actionFrame < 5\r\n >h-2,0,@stripeColor1@,ascii\r\n#######_\r\n####----'\r\nasciiend\r\n >h-2,0,@stripeColor2@,ascii\r\n#######_\r\n#####-#-\r\nasciiend\r\n  actionFrame++\r\n\r\n?actionFrame >= 5  & actionFrame < 10\r\n >h-2,0,@stripeColor1@,ascii\r\n########\r\n####-----'\r\nasciiend\r\n >h-2,0,@stripeColor2@,ascii\r\n########\r\n#####-#-#'\r\nasciiend\r\n  actionFrame++\r\n\r\n?actionFrame >= 10  & actionFrame < 15\r\n >h-2,0,@stripeColor1@,ascii\r\n########\r\n####------\r\nasciiend\r\n >h-2,0,@stripeColor2@,ascii\r\n########\r\n#####-#-#-\r\nasciiend\r\n  actionFrame++\r\n\r\n?actionFrame >= 14\r\n    actionFrame = 0\r\n\r\n\r\n?bighead\r\n >h-2,0,#white,ascii\r\n####\r\n###=\r\nasciiend\r\n\r\n?key = primaryBegin | face = \"^^\"\r\n  play uulaa_voice\r\n  actionFrame++"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetJackOLantern.txt" - Parse error: Failed to parse completely. Remaining: "= #yellow //eyes, mouth\r\nstemColor = #706020 //little stem on top - brown by default\r\n\r\nvar keepDistance = -21 // distance at which the movement animation will play (stateMoving)\r\nvar maxX = -20         // closest offset pet will get to character.  Closer to 0, closer to character\r\nvar maxDistance = -35  // if the pet exceeds this distance, it will teleport to this distance (cannot be further away than this)\r\nvar targetZ = 2       //start the drawing 1 unit above the player\r\n\r\n?loc.loop\r\n  keepDistance = -21\r\n  maxX = -12\r\n  maxDistance = -35\r\n  targetZ = 2\r\n\r\nvar x = 0\r\nvar y = 0\r\nvar myX = 0\r\nvar myZ = 0\r\nvar lastPlayerX = 0\r\nvar lastPlayerZ = 0\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1\r\nvar stateMoving = 2\r\nvar currentState = stateNone\r\nvar stateTime = 0\r\n\r\nfunc SetState(newState)\r\n  ?newState = stateMoving\r\n    play haunted_gate_shuffle //play sound when moving\r\n  \r\n  currentState = newState\r\n  stateTime = 0\r\n\r\n?currentState = stateNone | time = 1\r\n  lastPlayerX = pos.x\r\n  lastPlayerZ = pos.z\r\n  myX = keepDistance\r\n  myZ = targetZ\r\n\r\n// Start further away if pumpkin is summoned while the location is already running\r\n  ?time > 1\r\n    myX = maxDistance\r\n\r\n  SetState(stateIdle)\r\n\r\nmyX = myX - (pos.x - lastPlayerX) // If player has moved, increment myX (distance from player)\r\n\r\nstateTime++\r\n\r\n//set flickering for eyes and mouth based on stateTime\r\n?stateTime % 2 = 0\r\n\tlightColor = #yellow\r\n:\r\n\tlightColor = #white\r\n\r\n?currentState = stateIdle \r\n  ?myX < maxDistance | myX > -maxDistance\r\n    myX = maxDistance\r\n  myZ = myZ - (pos.z - lastPlayerZ)\r\n\r\n  ?myX < keepDistance\r\n    SetState(stateMoving)\r\n\t\r\n:?currentState = stateMoving\r\n  ?myX < maxX\r\n    myX++\r\n\t\r\n  ?stateTime >= 6\r\n    ?myZ > targetZ\r\n      myZ--\r\n    :?myZ < targetZ\r\n      myZ++\r\n\r\n  ?stateTime >= 12\r\n    SetState(stateIdle)\r\n\t\r\nlastPlayerX = pos.x\r\nlastPlayerZ = pos.z\r\n\r\n//draw pumpkin-----------------------------\r\n?currentState = stateIdle \r\n  >o@myX@,@myZ-3@,@#CC9020@,ascii\r\n#,`^ .\r\n({(Δ_Δ}\r\n#``  ´ \r\nasciiend\r\n  >o@myX@,@myZ-3@,@lightColor@,ascii\r\n#\r\n###Δ_Δ\r\n# \r\nasciiend\r\n  >o@myX@,@myZ-3@,@stemColor@,ascii\r\n##`^\r\n#\r\n#\r\nasciiend\r\n\r\n//eye expressions\r\n  ?face = \"°°\"\r\n    >o@myX-1@,@myZ-4@,@lightColor@,ascii\r\n#\r\n#\r\n####ʘ#ʘ\r\nasciiend\r\n\r\n  ?face = \"^^\"\r\n    >o@myX-1@,@myZ-4@,@lightColor@,ascii\r\n#\r\n#\r\n####^O^\r\nasciiend\r\n\r\n//Blink\r\n?currentState = stateIdle\r\n  ?face ! \"^^\"\r\n    ?face ! \"°°\"\r\n      ?stateTime % 50 >= 48\r\n        >o@myX-1@,@myZ-4@,@lightColor@,ascii\r\n#\r\n#\r\n####-#-\r\nasciiend\r\n      :?stateTime % 50 >= 46\r\n        >o@myX-1@,@myZ-4@,@lightColor@,ascii\r\n#\r\n#\r\n####-#-\r\nasciiend\r\n      :?stateTime % 50 >= 44\r\n        >o@myX-1@,@myZ-4@,@lightColor@,ascii\r\n#\r\n#\r\n####-#-\r\nasciiend\r\n\r\n//draw moving----------------------------\r\n?currentState = stateMoving\r\n  ?stateTime/3 = 0\r\n   >o@myX@,@myZ-3@,@#CC9020@,ascii\r\n#,`^ .\r\n({(Δ_Δ}\r\n#``  ´ \r\nasciiend\r\n   >o@myX@,@myZ-3@,@lightColor@,ascii\r\n#\r\n###Δ_Δ\r\n# \r\nasciiend\r\n   >o@myX@,@myZ-3@,@stemColor@,ascii\r\n##`^\r\n#\r\n#\r\nasciiend\r\n\r\n  ?stateTime/3 = 1\r\n   >o@myX@,@myZ-3@,@#CC9020@,ascii\r\n#.,^ .\r\n{({|Δ_'\r\n#``  ´ \r\nasciiend\r\n   >o@myX@,@myZ-3@,@lightColor@,ascii\r\n#\r\n####Δ_\r\n# \r\nasciiend\r\n   >o@myX@,@myZ-3@,@stemColor@,ascii\r\n###^\r\n#\r\n#\r\nasciiend\r\n\r\n  ?stateTime/3 = 2\r\n   >o@myX@,@myZ-3@,@#CC9020@,ascii\r\n#.,^'.\r\n({(|)Δ'\r\n#``  ´ \r\nasciiend\r\n   >o@myX@,@myZ-3@,@lightColor@,ascii\r\n#\r\n#####^\r\n# \r\nasciiend\r\n   >o@myX@,@myZ-3@,@stemColor@,ascii\r\n###^'\r\n#\r\n#\r\nasciiend\r\n\r\n  ?stateTime/3 = 3\r\n   >o@myX@,@myZ-3@,@#CC9020@,ascii\r\n#.,^ .\r\n{({|Δ_'\r\n#``  ´ \r\nasciiend\r\n   >o@myX@,@myZ-3@,@lightColor@,ascii\r\n#\r\n####Δ_\r\n# \r\nasciiend\r\n   >o@myX@,@myZ-3@,@stemColor@,ascii\r\n###^\r\n#\r\n#\r\nasciiend\r\n\r\n  ?stateTime/3 = 4\r\n   >o@myX@,@myZ-3@,@#CC9020@,ascii\r\n#,`^ .\r\n({(Δ_Δ}\r\n#``  ´ \r\nasciiend\r\n   >o@myX@,@myZ-3@,@lightColor@,ascii\r\n#\r\n###Δ_Δ\r\n# \r\nasciiend\r\n   >o@myX@,@myZ-3@,@stemColor@,ascii\r\n##`^\r\n#\r\n#\r\nasciiend\r\n\r\n  ?stateTime/3 = 5\r\n    >o@myX@,@myZ-3@,@#CC9020@,ascii\r\n#.#^ .\r\n{{Δ_Δ}}\r\n#`` ´´ \r\nasciiend\r\n   >o@myX@,@myZ-3@,@lightColor@,ascii\r\n#\r\n##Δ_Δ\r\n# \r\nasciiend\r\n   >o@myX@,@myZ-3@,@stemColor@,ascii\r\n###^\r\n#\r\n#\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetMushroom.txt" - Parse error: Failed to parse completely. Remaining: "?hp < lasthp\r\n   MC = #red\r\n    lasthp = hp\r\n\r\n?MushReactiveColor = 1\r\n ?hp > lasthp\r\n  MC = #green\r\n   lasthp = hp\r\n?MushReactiveColor = 1\r\n ?buffs.string = lucky_crit | buffs.string =\r\n^ berserk | buffs.string = strength\r\n  MC = #rainbow\r\n?MushReactiveColor = 1\r\n ?buffs.string = invisibility\r\n  MC = #777777\r\n?MushReactiveColor = 1\r\n ?debuffs.string = debuff_attack_speed\r\n  MC = #aaaaff\r\n\r\nvar FindWer\r\nvar FindEnc\r\nvar FindWerL\r\nvar FindEncL\r\nvar Enc1\r\nvar Enc2\r\n\r\n?string.Equals(item.left,＂＂) = false\r\n FindWerL = string.IndexOf(item.left,＂+＂)\r\n FindEncL = string.Sub(item.left,FindWerL+1,2)\r\n Enc2 = int.Parse(FindEncL)\r\n:\r\n Enc2 = Enc1\r\n\r\n?string.Equals(item.right,＂＂) = false\r\n FindWer = string.IndexOf(item.right,＂+＂)\r\n FindEnc = string.Sub(item.right,FindWer+1,2)\r\n Enc1 = int.Parse(FindEnc)\r\n\r\nvar EnchCol\r\nvar EnchCol2\r\nvar Element = ＂O＂\r\n\r\n?Enc1>=16\r\n EnchCol = #rainff\r\n:?Enc1>=11\r\n EnchCol = #red\r\n:?Enc1 >= 7\r\n EnchCol = #blue\r\n:?Enc1 >= 4\r\n EnchCol = #green\r\n:?Enc1 >= 2\r\n EnchCol = #yellow\r\n:?Enc1 = 1\r\n EnchCol = #cyan\r\n:\r\n EnchCol = #white\r\n\r\n Mushroom = ascii\r\n#\r\n#\r\n#\r\n##.--.\r\n.'  '_'.\r\n#|¯¯¯¯|\r\n#| •w•|\r\n#'____'\r\nasciiend\r\n\r\n?MushroomFrame = 2\r\n Mushroom = ascii\r\n#\r\n#\r\n#\r\n##.--.\r\n.'  '_'.\r\n#|¯¯¯¯|\r\n#| •w•|\r\n'------'\r\nasciiend\r\n\r\n?MushroomFrame = 3\r\n Mushroom = ascii\r\n#\r\n#\r\n#\r\n##.--.\r\n.'  '_'.\r\n#|¯¯¯¯|\r\n#| >w<|\r\n´------`\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\u{a0}\r\nasciiend\r\n\r\n?MushroomFrame = 4\r\n Mushroom = ascii\r\n#\r\n#\r\n###.--.\r\n#.'  '_'.\r\n##|¯>w<|\r\n##|    |\r\n##,____,\r\n#\r\nasciiend\r\n\r\n?MushroomFrame = 5\r\n Mushroom = ascii\r\n#\r\n####.--.\r\n##.'  '_'.\r\n###|¯>w<|\r\n###|    |\r\n###.    .\r\n####'--'\r\n#\r\nasciiend\r\n\r\n?MushroomFrame = 6\r\n Mushroom = ascii\r\n#####.--.\r\n###.'  '_'.\r\n####|¯>w<|\r\n####|    |\r\n####.    .\r\n#####'--'\r\n#\r\n#\r\nasciiend\r\n\r\n?MushroomFrame = 7\r\n Mushroom = ascii\r\n#####.--.\r\n###.'  '_'.\r\n####|¯¯¯¯|\r\n####| >w<|\r\n####.    .\r\n#####¯¯¯¯\r\n#\r\n#\r\nasciiend\r\n\r\n?MushroomFrame = 8\r\n Mushroom = ascii\r\n#\r\n####.--.\r\n##.'  '_'.\r\n###|¯¯¯¯|\r\n###|    |\r\n###. •w•.\r\n####¯¯¯¯\r\n#\r\nasciiend\r\n\r\n?MushroomFrame = 9\r\n Mushroom = ascii\r\n#\r\n#\r\n####.--.\r\n##.'  '_'.\r\n###|¯¯¯¯|\r\n###|    |\r\n###. •w•.\r\n####¯¯¯¯\r\nasciiend\r\n\r\n?MushroomFrame = 10\r\n Mushroom = ascii\r\n#\r\n#\r\n#\r\n###.--.\r\n#.'  '_'.\r\n##|¯¯¯¯|\r\n##| •w•|\r\n##'____'\r\nasciiend\r\n\r\n?MushroomFrame = 11\r\n Mushroom = ascii\r\n#\r\n#\r\n#\r\n#\r\n##.--.\r\n.'  '_'.\r\n#|¯¯¯¯|\r\n#| •w•|\r\n##¯¯¯¯\r\nasciiend\r\n\r\n?MushroomFrame = 12\r\n Mushroom = ascii\r\n#\r\n#\r\n#\r\n#\r\n##.--.\r\n.'  '_'.\r\n#|¯¯¯¯|\r\n#| •w•|\r\n#'----'\r\nasciiend\r\n\r\n?MushscaredFrame = 1\r\n Mushscared = ascii\r\n#\r\n#\r\n#\r\n##.--.\r\n.'  '_'.\r\n#|¯¯¯¯|\r\n#| -w-|\r\n#'----'\r\nasciiend\r\n\r\n?MushscaredFrame = 2\r\n Mushscared = ascii\r\n#\r\n#\r\n#\r\n##.--.\r\n.'  '_'.\r\n#|¯¯¯¯|\r\n#|'OwO|\r\n#'----'\r\nasciiend\r\n\r\n?MushscaredFrame = 3\r\n Mushscared = ascii\r\n#\r\n#\r\n#\r\n##.--.\r\n.'  '_'.\r\n#|¯¯¯¯|\r\n#|＂-w-|\r\n#'----'\r\nasciiend\r\n\r\n?MushscaredFrame = 3\r\n Mushscared = ascii\r\n#\r\n#\r\n#\r\n##.--.\r\n.'  '_'.\r\n#|¯¯¯¯|\r\n#|＂OwO|\r\n#'----'\r\nasciiend\r\n\r\n?MushscaredFrame = 7\r\n Mushscared = ascii\r\n#\r\n#\r\n#\r\n##.--.\r\n.'  '_'.\r\n#|¯¯¯¯|\r\n#|'•w•|\r\n#'----'\r\nasciiend\r\n\r\n?MushroomFrame > 12\r\n  MushroomFrame = 1\r\n\r\n?MushscaredFrame > 0\r\n Mushroom = ascii\r\n#\r\nasciiend\r\n\r\n?MushscaredFrame > 7\r\n ?foe.distance > 20\r\n  MushscaredFrame = -1\r\n\r\n?MushscaredFrame = -1\r\n Mushscared = ascii\r\n#\r\nasciiend\r\n\r\n?MushwinFrame > 0\r\n Mushroom = ascii\r\n#\r\n#\r\n#\r\n##.--.\r\n.'  '_'.\r\n#|¯¯¯¯|\r\n#| ^w^|\r\n#'----'\r\nasciiend\r\n\r\n?MushwinFrame > 9\r\n MushwinFrame = -1\r\n?MushItemCol = 1\r\n MC = EnchCol\r\n>o-@MushroomX@,@MushroomY@,@MC@,@Mushroom@\r\n>o-@MushroomX@,@MushroomY@,@MC@,@Mushscared@\r\n?time % 14 = 0\r\n MC = #white"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Foes/FlowerFoes.txt" - Parse error: Failed to parse completely. Remaining: "?foe=＂huge snail＂\r\n    >f3,0,@Snail@\r\n  :?foe=＂big a** snail＂\r\n    >f2,0,@BigSnail@\r\n  :?foe=＂ant hill＂\r\n    >f-4,1,#a9a9a9,@AntHill@\r\n  :?foe=＂ant＂\r\n    >f0,1,@Ant@\r\n//Colored\\\\\r\nvar snail1=ascii\r\n#\r\n#),(,\r\n#(_#)/\r\n###\\(\r\nasciiend\r\nvar snail2=ascii\r\n*###*\r\n######*\r\n###*\r\nasciiend\r\n\r\nvar bigsnail1=ascii\r\n#\r\n#####(\r\n##)###)\r\n#(`#_/`#.\r\n##\\/#\\_/\r\n##/##´\r\nasciiend\r\nvar bigsnail2=ascii\r\n######*\r\n#*\r\n#\r\n###*#####*\r\nasciiend\r\n\r\nvar Ant=ascii\r\n####*\r\n*\r\nasciiend\r\n\r\nvar anthill1=ascii\r\n#\r\n###(,\r\n####)#_)\r\n#(#/#(#`\r\n##V###\\\r\nasciiend\r\nvar anthill2=ascii\r\n####*\r\n######*\r\n##*\r\nasciiend\r\n?colored\r\n  ?foe=＂huge snail＂\r\n    >f3,0,#green,@snail1@\r\n    >f3,0,#magenta,@snail2@\r\n  :?foe=＂big a** snail＂\r\n    >f2,0,#green,@bigsnail1@\r\n    >f2,0,#magenta,@bigsnail2@\r\n  :?foe=＂ant hill＂\r\n    >f-4,1,#green,@anthill1@\r\n    >f-4,1,#magenta,@anthill2@\r\n  :?foe=＂ant＂\r\n    >f0,1,#magenta,@Ant@"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Foes/PallasCrown.txt" - Parse error: Failed to parse completely. Remaining: "?leftSways = rightSways\r\n  leftSways = 0\r\n  rightSways = 0\r\n\r\nfunc ResetCrown()\r\n crownBaseY = -24\r\n crownJewelsY = -22\r\n crownLiningY = -21\r\n crownFalling = 0\r\n crownNoisePlayed = 0\r\n\r\nvar leftBooo1 = ascii\r\n####.-.\r\n###(- -) \r\n###\\ ‾ `-´\r\n####) /\r\n####|/\r\n####'\r\nasciiend\r\n\r\nvar leftBooo2 = ascii\r\n####.-.\r\n###(> <) \r\n###\\ ‾ `-´\r\n####\\ /\r\n####'/\r\n####!\r\nasciiend\r\n\r\nvar rightBooo1 = ascii\r\n###.-.\r\n##(- -) \r\n`-´ ‾ /\r\n###\\ (\r\n####\\|\r\n#####'\r\nasciiend\r\n\r\nvar rightBooo2 = ascii\r\n###.-.\r\n##(> <) \r\n`-´ ‾ /\r\n###\\ /\r\n####\\'\r\n#####!\r\nasciiend\r\n\r\nvar leftBoooSweat1 = \"°·\"\r\nvar leftBoooSweat2 = \"`#\"\r\nvar leftBoooSweat3 = \"#.\"\r\nvar leftBoooSweat4 = \"·´\"\r\n\r\nvar rightBoooSweat1 = \"·°\"\r\nvar rightBoooSweat2 = \"#´\"\r\nvar rightBoooSweat3 = \".#\"\r\nvar rightBoooSweat4 = \".`\"\r\n\r\nvar crownBase = ascii\r\n,####†####,\r\n\\\\_,/ \\,_//\r\n#\\_∞_☼_∞_/\r\n(…÷…÷…÷…÷…)\r\n#‾‾‾‾‾‾‾‾‾\r\nasciiend\r\n\r\nvar crownJewels = ascii\r\n###∞#☼#∞\r\nasciiend\r\n\r\nvar crownLining = ascii\r\n(…÷…÷…÷…÷…)\r\nasciiend\r\n\r\nfunc Descend()\r\n ?crownFalling = 0\r\n  ?currentModulo = 0\r\n   ?leftBoooY < -5\r\n    leftBoooY++\r\n   ?rightBoooY < -5\r\n    rightBoooY++\r\n   ?leftBoooSweatY < -5\r\n    leftBoooSweatY++\r\n   ?rightBoooSweatY < -5\r\n    rightBoooSweatY++\r\n   ?crownBaseY < -7\r\n    crownBaseY++\r\n   ?crownJewelsY < -5\r\n    crownJewelsY++\r\n   ?crownLiningY < -4\r\n    crownLiningY++\r\n ?crownFalling = 1\r\n  ?time % 2 = 0\r\n   ?crownBaseY < 5\r\n    crownBaseY++\r\n   ?crownJewelsY < 7\r\n    crownJewelsY++\r\n   ?crownLiningY < 8\r\n    crownLiningY++\r\n\r\nfunc PlayCrownNoise()\r\n play perfected_defense\r\n crownNoisePlayed = 1\r\n\r\nfunc SwayLeft()\r\n leftBoooX--\r\n rightBoooX--\r\n leftBoooSweatX--\r\n rightBoooSweatX--\r\n crownBaseX--\r\n crownJewelsX--\r\n crownLiningX--\r\n leftSways++\r\n\r\nfunc SwayRight()\r\n leftBoooX++\r\n rightBoooX++\r\n leftBoooSweatX++\r\n rightBoooSweatX++\r\n crownBaseX++\r\n crownJewelsX++\r\n crownLiningX++\r\n rightSways++\r\n \r\nfunc Sway()\r\n ?currentModulo = 0\r\n  ?crownFalling = 0\r\n   ?leftSways < rightSways\r\n    SwayLeft()\r\n   :\r\n    SwayRight()\r\n  \r\nfunc DrawBooos()\r\n ?time % 8 = 0\r\n  leftBooo = leftBooo1\r\n  rightBooo = rightBooo1\r\n ?time % 5 = 0\r\n  leftBooo = leftBooo2\r\n  rightBooo = rightBooo2\r\n >c@leftBoooX@,@leftBoooY@,#5a5a5a,@leftBooo@\r\n >c@rightBoooX@,@rightBoooY@,#5a5a5a,@rightBooo@\r\n\r\nfunc DrawSweat()\r\n ?currentModulo < 2\r\n  leftBoooSweat = leftBoooSweat1\r\n  rightBoooSweat = rightBoooSweat1\r\n ?currentModulo > 1 & currentModulo < 5\r\n  leftBoooSweat = leftBoooSweat2\r\n  rightBoooSweat = rightBoooSweat2\r\n ?currentModulo > 4 & currentModulo < 8\r\n  leftBoooSweat = leftBoooSweat3\r\n  rightBoooSweat = rightBoooSweat3\r\n ?currentModulo > 7\r\n  leftBoooSweat = leftBoooSweat4\r\n  rightBoooSweat = rightBoooSweat4\r\n >c@leftBoooSweatX@,@leftBoooSweatY@,#ffffff,@leftBoooSweat@\r\n >c@rightBoooSweatX@,@rightBoooSweatY@,#ffffff,@rightBoooSweat@\r\n \r\nfunc DrawCrown()\r\n >c@crownBaseX@,@crownBaseY@,#ffca00,@crownBase@\r\n >c@crownJewelsX@,@crownJewelsY@,#ff0a00,@crownJewels@\r\n >c@crownLiningX@,@crownLiningY@,#ffffff,@crownLining@\r\n\r\n// start the objects at the top edge of the screen\r\n// and track whether we've reached Pallas stage 2\r\n?loc = undead_crypt\r\n ?loc.begin\r\n  ResetBooos()\r\n  ResetCrown()\r\n ?loc.loop\r\n  ResetBooos()\r\n  ResetCrown()\r\n  inStageTwo = 0\r\n ?foe = pallas & foe = stage_2\r\n  inStageTwo = 1\r\n\r\n// once we've reached stage 2, activate\r\n?inStageTwo = 1\r\n currentModulo = time % 5\r\n ?crownFalling = 0\r\n  Sway()\r\n  Descend()\r\n  DrawBooos()\r\n  DrawSweat()\r\n  DrawCrown()\r\n ?crownFalling = 1\r\n  Descend()\r\n  DrawCrown()\r\n  ?crownNoisePlayed = 0\r\n   PlayCrownNoise()\r\n ?foe.count = 0\r\n  ResetBooos()\r\n  crownFalling = 1"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Foes/PumpkinWraith.txt" - Parse error: Failed to parse completely. Remaining: "= #yellow //eyes, mouth\r\nstemColor = #706020 //little stem on top - brown by default\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1\r\nvar currentState = stateNone\r\nvar stateTime = 0\r\n\r\nfunc SetState(newState)\r\n  currentState = newState\r\n  stateTime = 0\r\n  SetState(stateIdle)\r\n\r\nstateTime++\r\n\r\n//set flickering for eyes and mouth based on stateTime\r\n?stateTime % 2 = 0\r\n\tlightColor = #yellow\r\n:\r\n\tlightColor = #white\r\n\r\n//draw pumpkin-----------------------------\r\n?foe = acronian_cultist\r\n  >o@foe.distance - 1@,@-5@,@#CC9020@,ascii\r\n   ,^..   \r\n ,´^,,^`. \r\n(( `vvv'))\r\n ` `^^^'´\r\nasciiend\r\n  >o@foe.distance - 1@,@-5@,@lightColor@,ascii\r\n#\r\n###^..^\r\n###`vvv´\r\n###'^^^'\r\nasciiend\r\n  >o@foe.distance - 1@,@-5@,@stemColor@,ascii\r\n###,^.  \r\n#\r\n#\r\n#\r\nasciiend\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Foes/SurferGuardian.txt" - Parse error: Failed to parse completely. Remaining: "?foe = \"guardian\"\r\n  ?Init\r\n    Init = false\r\n    GuardianWalk = ui.AddAnim(GuardianASCII)\r\n    GuardianWalk.duration = 60\r\n    GuardianWalk.loop = true\r\n    GuardianWalk.gamePause = true\r\n    GuardianWalk.y = -1\r\n    GuardianWalk.Play()\r\n\r\n  ?foe.state = 1\r\n    GuardianPos = 67 - (foe.time)/6\r\n  :\r\n    GuardianWalk.Pause()\r\n  GuardianWalk.x = GuardianPos\r\n\r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/FireFly.txt" - Parse error: Failed to parse completely. Remaining: "= \"#060603\"\r\nvar FireColourA = \"#252515\"\r\n\r\nvar DiscoModeColourSet =     [\"#0A0000\",\"#040A04\",\"#000008\",\"#030006\",\"#000306\",\"#070300\",\"#060600\",\"#000607\",\"#0A000A\",]\r\nvar DiscoModeColourSetText = [\"#A00000\",\"#04A004\",\"#000070\",\"#300060\",\"#003060\",\"#603000\",\"#606000\",\"#006060\",\"#A000A0\",]\r\n\r\nvar XBaseMove\r\nvar XWobbleFactor\r\nvar YWobbleFactor\r\nvar YCurveFactor\r\nvar YCurveAmplitude\r\nvar YFixed = 2\r\nvar BasePanel\r\nvar customStyle = ui.AddStyle(\"#########\")\r\nvar Sin = math.Sin\r\nvar Round = math.RoundToInt\r\nvar Floor = math.FloorToInt\r\nvar ScFWX = screen.FromWorldX\r\nvar ScreenW = screen.w\r\nvar ScreenDepth\r\n\r\nfunc RandRange(Min, Max)\r\n  var Range = Max - Min\r\n  return Floor(Range * rngf) + Min\r\n\r\nfunc GenerateRandoms()\r\n  XWobbleFactor = RandRange(0,5) \r\n  YWobbleFactor = RandRange(0,5) \r\n  YCurveFactor = RandRange(0,9) \r\n  ScreenDepth = RandRange(20,65)\r\n  ?DiscoMode\r\n    var DiscoColour = RandRange(0,8)\r\n    for a : BasePanel.children\r\n      ?a.w < 9\r\n        a.SetBG(DiscoModeColourSet[DiscoColour])\r\n      :\r\n        a.color = DiscoModeColourSetText[DiscoColour]\r\n    YFixed = screen.h / 3\r\n    YCurveAmplitude = rngf * screen.h / 3.0 + 2.5\r\n  :\r\n    YCurveAmplitude = rngf * 1.5 + 2.5\r\n    YFixed = 2\r\n\r\nfunc SetCanvas(UI,W,H, Parent)\r\n  UI.w = W\r\n  UI.h = H\r\n  UI.blend = Add\r\n  UI.SetBG(FireColour)\r\n  UI.SetFG(FireColourA)\r\n  Parent.Add(UI)\r\n\r\nfunc MakeFireFly()\r\n  BasePanel = ui.AddPanel()\r\n  BasePanel.style = customStyle  \r\n\r\n  SetCanvas(ui.AddCanvas(), 7,1, BasePanel)\r\n  SetCanvas(ui.AddCanvas(), 5,3, BasePanel)\r\n  SetCanvas(ui.AddCanvas(), 3,3, BasePanel)\r\n  SetCanvas(ui.AddCanvas(), 1,5, BasePanel)\r\n\r\n  var FireText = ui.AddText(\"•\")\r\n  FireText.w = 9\r\n\r\n  BasePanel.x = 20\r\n  BasePanel.y = 10\r\n  BasePanel.anchor = top_left\r\n  BasePanel.dock = top_left\r\n\r\n  FireText.align = center\r\n  FireText.y = 2\r\n  FireText.color = \"#yellow\"\r\n  BasePanel.Add(FireText)\r\n\r\n  XBaseMove = RandRange(screen.ToWorldX(0),screen.ToWorldX(ScreenW+30))\r\n  GenerateRandoms()\r\n\r\nfunc MoveFly(t,Px,Sx)\r\n  Sx =  (Sx * ScreenDepth)/ScreenW\r\n  var YBaseMove = Round(YCurveAmplitude*Sin(t/8.0 + YCurveFactor) + YFixed)\r\n  ?t%2\r\n    XBaseMove--\r\n  ?XBaseMove + Sx < Px - 70 \r\n    GenerateRandoms()\r\n    XBaseMove = Px +  ScreenW + RandRange(5, ScreenW/2) - (Sx * ScreenDepth)/ScreenW\r\n  :?XBaseMove + Sx > Px + 200\r\n    GenerateRandoms()\r\n    XBaseMove = RandRange(screen.ToWorldX(0),screen.ToWorldX(ScreenW+30))\r\n  BasePanel.y = YBaseMove + Round(1.5*Sin((t/5.0+ YWobbleFactor )%6.0))\r\n  BasePanel.x = ScFWX(XBaseMove + Round(2.5*Sin((t/3.5+ XWobbleFactor )%6.0))+ Sx)\r\n\r\nvar InitTime = totaltime\r\nvar FlyList = []\r\nvar FlyListCount = 0\r\n\r\nfunc Run()\r\n  var t = totaltime\r\n  var Px = pos.x\r\n  var Sx = screen.x\r\n  ?t = 1\r\n    InitTime = 1\r\n    FlyList.Clear()\r\n    FlyListCount = 0\r\n  ?t >= InitTime+1\r\n    ?FlyListCount < MaxFireFlies\r\n      for a = FlyList.Count()..MaxFireFlies - 1\r\n        var b = new Cosmetics/FireFly\r\n        b.MakeFireFly()\r\n        FlyList.Add(b)\r\n      FlyListCount = FlyList.Count()\r\n    :?FlyListCount > MaxFireFlies\r\n      for a = FlyList.Count()..MaxFireFlies + 1\r\n        FlyList[0].BasePanel.Recycle()\r\n        FlyList.RemoveAt(0)\r\n      FlyListCount = FlyList.Count()\r\n  for a : FlyList\r\n    a.MoveFly(t,Px,Sx)\r\n\r\nRun()"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/SpringBuddy.txt" - Parse error: Failed to parse completely. Remaining: "= [\r\n^[\"I served in the Yugoslav People's Army. That's where I met Clippy. He saved my coiled ass back during the Croatian War of Independence\",5],\r\n^[\"Just like my coil, Yugoslavia had its ups and downs. Unfortunately, it couldn't spring back the last time\",4],\r\n^[\"Ah, the good ol' days of SFRY (Socialist Federal Rebulic of Yugoslavia).. When we were all tightly wound together. Now, it feels like I'm just unraveling\",5],\r\n^[\"I thought I knew tension, but the breakup of Yugoslavia? That was a real stretch\",3],\r\n^[\"I was a proud Yugoslav, always ready to jump into action for my country.. or what's left of it\",4],\r\n^[\"Life as a sentient spring in Yugoslavia was complex. I was involved in mechanical engineering, politics, and even gymnastics!\",4],\r\n^[\"We spoke Serbo-Croatian.. or was it Croato-Serbian?\",3],\r\n^[\"Ah, Tito! He managed to keep the Soviets at bay, the West interested, and the Non-Aligned Movement aligned\",4],\r\n^[\"Yugoslavia's national sport? Political gymnastics! No one could perform a split like we could!\",4],\r\n^[\"We had a unique economic model: socialist self-managment. It meant you could be your own boss and still complain about the managment!\",4],\r\n^[\"Being Yugoslav was great! You could be anyone from 6 republics and 2 autonomous provinces, and still argue about who made the best burek!\",5],\r\n^[\"Slobodan Praljak was a Croatian General who died in 2017 when he drank poison in court after being convicted of war crimes\",4],\r\n^[\"I heard that Clippy fled Europe once the ICTY tribunal (International Criminal Tribunal for the former Yugoslavia) began its investigations\",5],\r\n^[\"After Yugoslavia broke up, Croatia got a large coastline due to the way the historical and administrative borders were drawn and left Bosnia and Herzegovina almost entirely landlocked. Ha! No beaches for you!\",7],\r\n^[\"Josip Broz Tito's death in 1980 led to a period of instability and eventual dissolution of Yugoslavia. Tito's strong leadership had held the country together, and his passing created a power vacuum that contributed to internal tensions\",7],\r\n^[\"The 'Titovka' was a distinctive cap worn by members of the Yugoslav People's Army. Its design was inspired by the Soviet ushanka hat but featured a star with a red five-pointed star badge\",6],\r\n^[\"The Yugo was a compact car manufactured in Yugoslavia during the 1980s it gained notoriety for its low cost and reputation for low quality. It became the butt of many jokes and was often cited as an example of automotive incompetence\",7],\r\n^[\"In Socialist Yugoslavia, car doesn't break down on road — road breaks down under car!                       ...Also car breaks down on road\",5],\r\n^]\r\n\r\nvar SpringXPosition\r\nvar SpringYPosition\r\nvar SpringYVector\r\nvar ResetPosition\r\nvar PlayerX\r\nvar Spring\r\nPlayerX = pos.x\r\n\r\nvar Said_A_Quip_Already\r\nvar Quip_Activation_Time = -1\r\nvar Quip_Text\r\nvar Quip_Text_Box\r\nvar Quip_Text_Draw = \"\"\r\nvar Quip_Text_Max_Length = 0\r\nvar Quip_Text_Max_Time\r\nvar Quip_X\r\nvar Quip_Y\r\nvar RandomSelection\r\n\r\n?totaltime = 1\r\n  Said_A_Quip_Already = false\r\n  Spring = ui.AddAnim(SpringJump)\r\n  Spring.duration = 20\r\n  Spring.loop = false\r\n  Spring.gamePause = true\r\n  Spring.anchor = top_left\r\n  Spring.dock = top_left\r\n  SpringXPosition = pos.x - 10\r\n  SpringYPosition = pos.z - 10\r\n  Spring.y = SpringYPosition\r\n  ResetPosition = true\r\n\r\n?PlayerX - SpringXPosition > 20\r\n  ?!Spring.playing\r\n    Spring.Play()\r\n    SpringYVector = SpringYPosition - (pos.z - 10)\r\n    play haunted_gate_point_lost 50\r\n\r\n?Spring.playing\r\n  SpringXPosition++\r\n  ?SpringYVector ! 0\r\n    ?time % (20/SpringYVector) = 0\r\n      ?SpringYVector > 0 \r\n        SpringYPosition--\r\n      :\r\n        SpringYPosition++\r\n      Spring.y = SpringYPosition\r\n\r\n?time ! totaltime & ResetPosition\r\n  ?loc=harder\r\n    SpringXPosition = PlayerX - 20\r\n    ResetPosition = false\r\n\r\n?ai.paused& !ai.walking & !Said_A_Quip_Already\r\n  var RngFactor = 10000 / Quips.Count() + 1\r\n  RandomSelection = math.FloorToInt(rng/RngFactor)\r\n  Quip_Text_Max_Length = string.Size(Quips[RandomSelection][0])\r\n  Quip_Text_Box = ui.AddPanel()\r\n  Quip_Text = ui.AddText(\"\")\r\n  Quip_X = math.Max(screen.FromWorldX(SpringXPosition - 15),0)\r\n  Quip_Y = math.Max(SpringYPosition - Quips[RandomSelection][1]/2 - 1, 0)\r\n\r\n  Quip_Text.anchor = top_left\r\n  Quip_Text.dock = top_left\r\n  Quip_Text_Box.anchor = top_left\r\n  Quip_Text_Box.dock = top_left\r\n\r\n  Quip_Text.x = Quip_X+1\r\n  Quip_Text.y = Quip_Y+1\r\n  Quip_Text.w = 35\r\n  Quip_Text.h = Quips[RandomSelection][1]\r\n  Quip_Text_Box.x = Quip_X\r\n  Quip_Text_Box.y = Quip_Y\r\n  Quip_Text_Box.w = 37\r\n  Quip_Text_Box.h = Quips[RandomSelection][1]+2\r\n  Said_A_Quip_Already = true\r\n  Quip_Text_Max_Time = 45*Quips[RandomSelection][1]\r\n  Quip_Activation_Time = Quip_Text_Max_Time\r\n\r\n  play scotty_out_of_treasure 100\r\n\r\n?Quip_Activation_Time > 0\r\n  Quip_Activation_Time--\r\n  Quip_Text_Draw = string.Sub( Quips[RandomSelection][0] ,0 ,(math.Min(Quip_Text_Max_Time-Quip_Activation_Time,Quip_Text_Max_Length)))\r\n  Quip_Text.text = Quip_Text_Draw\r\n:?Quip_Activation_Time = 0\r\n  Quip_Text_Box.Recycle()\r\n  Quip_Text.Recycle()\r\n  Quip_Activation_Time = -1\r\n\r\nSpring.x = screen.FromWorldX(SpringXPosition)"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Knight.txt" - Parse error: Failed to parse completely. Remaining: "= #999999\r\nvar colorwalk = #ffffff\r\nvar colorwalkfar = #666666\r\nvar AtkCount = 0\r\nvar KnightAtkFrame = 0\r\nvar KnightWalkFrame = 0\r\nvar KnightAtk = [ascii\r\n#####################.^.\r\n####################¡   ¡\r\n####################|   |\r\n####################|   |\r\n###################[‾‾‾‾‾]\r\n####################‾(‾)‾\r\n####################/ /#######\r\n##############################\r\n##############################\r\n##############################\r\n##############################\r\n##############################\r\n##############################\r\n##############################\r\n##############################\r\n##############################\r\n##############################\r\n##############################\r\nasciiend\r\n,ascii\r\n######################.^.\r\n#####################¡   ¡\r\n#####################|   |\r\n#####################|   |\r\n####################[‾‾‾‾‾]\r\n#####################(‾)‾\r\n####################/ /#######\r\n##############################\r\n##############################\r\n##############################\r\n##############################\r\n##############################\r\n##############################\r\n##############################\r\n##############################\r\n##############################\r\n##############################\r\n##############################\r\nasciiend\r\n,ascii\r\n#######################`.\r\n######################¡  `.\r\n#####################.     \\\r\n#####################|      \\\r\n#####################|       \\\r\n#####################/        .\r\n##############################'\r\n###############################'\r\n###############################'\r\n###############################.\r\n###############################|\r\n###############################|\r\n###############################! \r\n##############################/\r\n#############################` \r\n#############################\r\n#############################\r\n#############################\r\nasciiend\r\n,ascii\r\n#######################`.\r\n######################¡  `.\r\n#####################.     \\\r\n#####################|      \\\r\n#####################|       \\\r\n#####################/        .\r\n##############################'\r\n###############################'\r\n###############################'\r\n###############################.\r\n###############################|\r\n###############################|\r\n###############################! \r\n##############################/\r\n#############################` \r\n#############################\r\n#############################\r\n#############################\r\nasciiend\r\n,ascii\r\n###\r\n###\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n######################### `.\r\n#######################`    `.\r\n#########################.    \\\r\n###########################`‾‾‾\r\n#########################\r\n#########################\r\n#########################\r\nasciiend\r\n,ascii\r\n###\r\n###\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n######################### `.\r\n#######################`    `.\r\n#########################.    \\\r\n###########################`‾‾‾\r\n#########################\r\n#########################\r\n#########################\r\nasciiend\r\n,ascii\r\n###\r\n###\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n######################### `.\r\n#######################.    `.\r\n#########################.    \\\r\n#########################  `‾‾‾\r\n#########################\r\n#########################\r\n#########################\r\nasciiend\r\n,ascii\r\n###\r\n###\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n######################### `.\r\n#######################.    `.\r\n#########################.    \\\r\n#########################  `‾‾‾\r\n#########################\r\n#########################\r\n#########################\r\nasciiend\r\n,ascii\r\n###\r\n###\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################`.\r\n######################·    `.\r\n########################.    \\\r\n######################### `‾‾‾\r\n#########################\r\n#########################\r\n#########################\r\nasciiend\r\n,ascii\r\n###\r\n###\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################`.\r\n######################·    `.\r\n########################.    \\\r\n######################### `‾‾‾\r\n#########################\r\n#########################\r\n#########################\r\nasciiend\r\n,ascii\r\n###\r\n###\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n###################    `.\r\n####################.    `.\r\n######################.    \\\r\n########################`‾‾‾\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\nasciiend\r\n,ascii\r\n###\r\n###\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n###################    `.\r\n####################.    `.\r\n######################.    \\\r\n########################`‾‾‾\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\nasciiend\r\n,ascii\r\n###\r\n###\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n######################-------- \r\n######################         >\r\n######################-------- \r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\nasciiend\r\n,ascii\r\n###\r\n###\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n######################-------- \r\n######################         >\r\n######################-------- \r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\nasciiend\r\n,ascii\r\n####\r\n####\r\n##########\r\n##########\r\n##############\r\n######################. ^.\r\n#####################/   /\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\nasciiend\r\n,ascii\r\n####\r\n####\r\n##########\r\n##########\r\n##############\r\n######################. ^.\r\n#####################/   /\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\nasciiend\r\n,ascii\r\n####\r\n####\r\n###########\r\n######################.^.\r\n#####################¡   ¡\r\n#####################|   |\r\n#####################|   |\r\n####################[‾‾‾‾‾]\r\n######################(‾)\r\n######################/ /###\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\n###########################\r\nasciiend\r\n,ascii\r\n####\r\n#####################.^.\r\n####################¡   ¡\r\n####################|   |\r\n####################|   |\r\n###################[‾‾‾‾‾]\r\n####################‾(‾)\r\n#####################/ /#\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\n#########################\r\nasciiend\r\n]\r\nvar KnightWalk = [ascii\r\n###################\r\n###################\r\n###########____####\r\n##########(_,__\\###\r\n##############__\\_#\r\n#############( ,‒‒\\\r\n#############/  ‾‾/#####,,,,,,\r\n###########/‾!‾‾T‾‾) ,,\"'  | '7\r\n#########┌─┬─┐ _|_/,!!     |0 |7\r\n#########├═╬═┤:___］//    /\\|‒‒|\r\n#####/// \\ ║ / |   \\______/\\ ·|\r\n####|||  |\\┴/| |   |   /####‾‾\r\n###///|  !!! ¡__¡ !!__/\r\n##|||#)  /- ‒‒‒‒\\  |‾\\\r\n##'''/ )#\\ ┊#####|  )/\r\n####||####\\\\#####/‾\\\\\r\n####|‾\\### \\‾\\###‾‾|‾\\\r\n#####‾‾#####‾‾######‾‾\r\nasciiend\r\n^,ascii\r\n###################\r\n###################\r\n###########____####\r\n##########(_,__\\###\r\n##############__\\_#\r\n#############( ,‒‒\\\r\n#############/  ‾‾/#####,,,,,,\r\n###########/‾!‾‾T‾‾) ,,\"'  | '7\r\n#########┌─┬─┐ _|_/,!!     |0 |7\r\n#########├═╬═┤:___］//    /\\|‒‒|\r\n#####/// \\ ║ / |   \\______/\\ ·|\r\n####|||  |\\┴/| |   |   /####‾‾\r\n###///|  !!! ¡__¡ !!__/ \\\r\n#///###\\  /- ‒‒‒‒\\  |‾\\_ '\r\n#'''#,-. ) )######| )###|┊\r\n#####|_'##┊|######||###/‾'\r\n##########\\‾\\#####l‾\\##‾‾\r\n###########‾‾######‾\r\nasciiend\r\n^,ascii\r\n###################\r\n###################\r\n###########____####\r\n##########(_,__\\###\r\n##############__\\_#\r\n#############( ,‒‒\\\r\n#############/  ‾‾/#####,,,,,,\r\n###########/‾!‾‾T‾‾) ,,\"'  | '7\r\n#########┌─┬─┐ _|_/,!!     |0 |7\r\n#########├═╬═┤:___］//    /\\|‒‒|\r\n#####/// \\ ║ / |   \\______/\\ ·|\r\n####|||  |\\┴/| |   |   /####‾‾\r\n###///|  !!! ¡__¡ !! _/ \\\r\n##|||##\\_ \\- ‒‒‒‒\\  / \\ |\r\n##'''### ||#######| )#┊ |\r\n########┊\\_|######//###\\|\r\n########\\‾\\######|‾\\####\\‾\\\r\n#########‾‾#######‾‾#####‾‾\r\nasciiend\r\n^,ascii\r\n###################\r\n###################\r\n###########____####\r\n##########(_,__\\###\r\n##############__\\_#\r\n#############( ,‒‒\\\r\n#############/  ‾‾/#####,,,,,,\r\n###########/‾!‾‾T‾‾) ,,\"'  | '7\r\n#########┌─┬─┐ _|_/,!!     |0 |7\r\n#########├═╬═┤:___]//    /\\|‒‒|\r\n#####/// \\ ║ / |   \\______/\\ ·|\r\n####|||  |\\┴/| |   |   /####‾‾\r\n###///|  !!! ¡__¡ !! _/\r\n###\\\\\\##\\_ )-‒‒‒‒|  /  |\r\n###'''#/ #\\\\######\\ )┊ )\r\n######|/##/ |###,-./#┊|\r\n######`‾\\##`####|_'##|‾\\\r\n#######‾##############‾‾\r\nasciiend\r\n^,ascii\r\n###################\r\n###################\r\n###########____####\r\n##########(_,__\\###\r\n##############__\\_#\r\n#############( ,‒‒\\\r\n#############/  ‾‾/#####,,,,,,\r\n###########/‾!‾‾T‾‾) ,,\"'  | '7\r\n#########┌─┬─┐ _|_/,!!     |0 |7\r\n#########├═╬═┤:___]//    /\\|‒‒|\r\n######// \\ ║ / |   \\______/\\ ·|\r\n####,¡|  |\\┴/| |   |   /####‾‾\r\n###///|  !!! ¡__¡ !!  /\r\n##|||# \\_  ----‒---┊\\ )\r\n##'''┊ )#` )#######\\//\r\n#####//###\\\\#######/´'\r\n####|‾\\####\\‾\\#####‾|‾\\\r\n######‾#####‾‾#######‾‾\r\nasciiend\r\n^,ascii\r\n###################\r\n###################\r\n###########____####\r\n##########(_,__\\###\r\n##############__\\_#\r\n#############( ,‒‒\\\r\n#############/  ‾‾/#####,,,,,,\r\n###########/‾!‾‾T‾‾) ,,\"'  | '7\r\n#########┌─┬─┐ _|_/,!!     |0 |7\r\n#########├═╬═┤:___]//    /\\|‒‒|\r\n######// \\ ║ / |   \\______/\\ ·|\r\n####,¡|  |\\┴/| |   |   /####‾‾\r\n###///|  !!! ¡__¡ !!  \\\r\n#///##\\  )- ---‒---‾|\\ )\r\n#'''###\\ /########┊ )#\\|\r\n#####,-.#\\\\#######┊|##,-.\r\n#####|_/#|‾\\######)‾\\#\\/\r\n##########‾‾#######‾\r\nasciiend\r\n^,ascii\r\n###################\r\n###################\r\n###########____####\r\n##########(_,__\\###\r\n##############__\\_#\r\n#############( ,‒‒\\\r\n#############/  ‾‾/#####,,,,,,\r\n###########/‾!‾‾T‾‾) ,,\"'  | '7\r\n#########┌─┬─┐ _|_/,!!     |0 |7\r\n#########├═╬═┤:___]//    /\\|‒‒|\r\n######// \\ ║ / |   \\______/\\ ·|\r\n####,¡|  |\\┴/| |   |   /####‾‾\r\n###///|  !!! ¡__¡ !!    \\\r\n##|||#/  /-- ---‒\\‾‾┊‾\\ |\r\n##'''|| ) /#######┊ )#| |\r\n#####'||‾#########┊|###\\|\r\n######\\‾\\#########\\‾\\###\\‾\\\r\n#######‾‾##########‾‾  ##‾‾\r\nasciiend\r\n^,ascii\r\n###################\r\n###################\r\n###########____####\r\n##########(_,__\\###\r\n##############__\\_#\r\n#############( ,‒‒\\\r\n#############/  ‾‾/#####,,,,,,\r\n###########/‾!‾‾T‾‾) ,,\"'  | '7\r\n#########┌─┬─┐ _|_/,!!     |0 |7\r\n#########├═╬═┤:___]//    /\\|‒‒|\r\n######// \\ ║ / |   \\______/\\ ·|\r\n####,¡|  |\\┴/| |   |   /####‾‾\r\n###///|  !!! ¡__¡ !! _/\r\n###\\\\\\)  / - ‒‒‒--\\  )\r\n###'''| )┊ (#######\\ |\r\n######//##\\_\\#####\" \\\\\r\n#####|‾\\###'- ###|_/'‾\\\r\n######‾‾#############‾‾\r\nasciiend\r\n]\r\nvar KnightWalkfar = [ascii\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n####################‾\\######\r\n#########\\ ┊#########/######\r\n##########\\\\#####/##########\r\n########## \\‾\\###‾‾#########\r\n############‾‾##############\r\nasciiend\r\n^,ascii\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n####################### \\###\r\n#####################‾\\_ '##\r\n########## )############|┊##\r\n##########┊|###########/‾'##\r\n##########\\‾\\##########‾‾###\r\n###########‾‾###############\r\nasciiend\r\n^,ascii\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n####################### \\###\r\n######################\\ |###\r\n######################┊ |###\r\n########┊##############\\|###\r\n########\\‾\\#############\\‾\\#\r\n#########‾‾##############‾‾#\r\nasciiend\r\n^,ascii\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n#####################  |####\r\n#######/ ############┊ )####\r\n######|/#############┊|#####\r\n######`‾\\############|‾\\####\r\n#######‾##############‾‾####\r\nasciiend\r\n^,ascii\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n###### ############┊########\r\n#####┊ )###########\\########\r\n#####//#####################\r\n####|‾\\#############|‾\\#####\r\n#####‾‾##############‾‾#####\r\nasciiend\r\n^,ascii\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n###################‾|#######\r\n##################┊ )#######\r\n#####,-.##########┊|########\r\n#####|_/##########)‾\\#######\r\n###################‾########\r\nasciiend\r\n^,ascii\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n#################\\  ┊#######\r\n######### /#######┊ )#######\r\n########‾#########┊|########\r\n##################\\‾\\#######\r\n###################‾‾#######\r\nasciiend\r\n^,ascii\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n############################\r\n########## #################\r\n#########┊ (################\r\n##########\\_\\#####\" ########\r\n###########'- ###|_/########\r\n############################\r\nasciiend\r\n]\r\nvar KnightWalkCount = KnightWalk.Count()\r\nvar difpos\r\n\r\n//walk\r\ndifpos = pos.x + pos.y + pos.z\r\nKnightWalkFrame = (7*difpos/12) % KnightWalkCount\r\n?KnightWalkFrame < 0\r\n\tKnightWalkFrame = KnightWalkFrame + KnightWalkCount\r\n\r\n//atk\r\n?!ai.walking & !ai.paused & ai.enabled & foe.distance < 24\r\n\tAtkCount++\r\n:\r\n\tAtkCount = 0\r\nKnightAtkFrame = (AtkCount/2) % KnightAtk.Count()\r\n\r\n>o-25,-13,@coloratk@,@KnightAtk[KnightAtkFrame]@\r\n>o-25,-13,@colorwalk@,@KnightWalk[KnightWalkFrame]@\r\n>o-25,-13,@colorwalkfar@,@KnightWalkfar[KnightWalkFrame]@"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/BlackHole.txt" - Parse error: Failed to parse completely. Remaining: "= #white\r\nvar ringColor = #rainFF\r\nvar eyeColor = #ff00ff\r\nvar particleColor1 = #yellow\r\nvar particleColor2 = #yellow\r\n\r\nvar uiAA = ui.AddAnim\r\nvar uiAB = ui.AddButton\r\nvar refX = 0\r\nvar refZ = 0\r\nrefX = pos.x + (screen.w/2)-(screen.x) - 45\r\nrefZ = pos.z - 16\r\nvar bX\r\nvar bY\r\nvar blackHole\r\nvar blackHole2\r\nvar holeEyes\r\nvar holeSize\r\nvar prtcl\r\nvar prtclBig\r\nvar prtclSize\r\nvar prtcls=[]\r\nvar pCount=-1\r\nvar spawnChance\r\nvar prtclX\r\nvar prtclZ\r\nvar spawnXrng\r\nvar spawnYrng\r\nvar spawnSizerng\r\nvar delete=[]\r\nvar holeTime\r\nvar kills\r\nvar fC\r\nvar oldfC=0\r\nvar fCdifference\r\n//from darkness script\\\\\r\nvar radius\r\nvar ShadePercentage\r\nvar BasePanel\r\nvar FilterList = []\r\nvar FilterList2 = []\r\nvar Shade\r\nvar ShadeHex\r\nvar lvl1btn\r\nvar lvl2btn\r\nvar lvl3btn\r\nvar lvl4btn\r\nvar lvl5btn\r\nvar lvlpnl\r\nvar menubtn\r\nvar menu=false\r\nvar unlock\r\nvar timer\r\nvar timebar\r\nvar killbar\r\n\r\nvar holeAsci1=ascii\r\n#\r\n#\r\n#\r\n#\r\n#######Φ######\r\n#\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n#\r\n#######_\r\n######( )\r\n#######¯\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n#\r\n######.-.\r\n#####(   )####\r\n######`-´\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n####.-¯¯-.\r\n###.      .\r\n###'      '###\r\n####`-__-´\r\n#\r\n#\r\n%%\r\n######__\r\n##.-¯¯  ¯¯-.\r\n#¡          ¡\r\n.            .\r\n'            '\r\n#!          !\r\n##'-__  __-'\r\n######¯¯\r\nasciiend\r\n\r\nvar holeAsci2=ascii\r\n#\r\n%%\r\n#\r\n#\r\n#\r\n######.\r\n#######\\\r\n########'\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n#\r\n#####.\r\n######¯-_\r\n#########'\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n###.\r\n####¯-_\r\n#######¯-_\r\n##########'\r\n#\r\n#\r\n%%\r\n#\r\n-_\r\n##-_\r\n####¯-_\r\n#######¯-_\r\n##########¯-\r\n############¯-\r\n#\r\nasciiend\r\n\r\nvar holeAsci3=ascii\r\n|\r\n###|\r\nasciiend\r\n\r\nprtcl=ascii\r\n•\r\nasciiend\r\n\r\nprtclBig=ascii\r\n@\r\nasciiend\r\n\r\nfunc BlackHole()\r\n  bX=refX\r\n  bY=refZ\r\n  blackHole=uiAA(holeAsci1)\r\n  blackHole.x=bX\r\n  blackHole.y=bY\r\n  blackHole.color=holeColor\r\n  blackHole2=blackHole.AddLayer(holeAsci2)\r\n  blackHole2.color=ringColor\r\n  ?holeSize=1\r\n    blackHole.frame=0\r\n  :?holeSize=2\r\n    blackHole.frame=1\r\n  :?holeSize=3\r\n    blackHole.frame=2\r\n  :?holeSize=4\r\n    blackHole.frame=3\r\n  :?holeSize=5\r\n    blackHole.frame=4\r\n    holeEyes=uiAA(holeAsci3)\r\n    holeEyes.x=bX+2\r\n    holeEyes.y=bY-1\r\n    holeEyes.color=eyeColor\r\n\r\nfunc Darkness()\r\n  ?holeSize=4\r\n    radius=8\r\n    ShadePercentage=30\r\n    Shade = ShadePercentage * 256 / 100\r\n    ShadeHex = color.FromRGB(Shade,Shade,Shade)\r\n  ?holeSize=5\r\n    radius=12\r\n    ShadePercentage=40\r\n    Shade = ShadePercentage * 256 / 100\r\n    ShadeHex = color.FromRGB(Shade,Shade,Shade)\r\n  BasePanel = ui.AddPanel()\r\n  BasePanel.visible = false\r\n  FilterList.Clear()\r\n  FilterList2.Clear()\r\n  for a=0..radius\r\n    FilterList.Add(ui.AddCanvas())\r\n    FilterList[a].w = math.RoundToInt(radius*3 - math.Abs(0.4*math.Pow((radius/2)-a,2)))\r\n    FilterList[a].h = 1\r\n    FilterList[a].y = (radius/2)-a\r\n    FilterList[a].blend = subtract\r\n    FilterList[a].SetFG(ShadeHex)\r\n    BasePanel.Add(FilterList[a])\r\n\r\n  for a=0..radius/2\r\n    FilterList2.Add(ui.AddCanvas())\r\n    FilterList2[a].w = math.RoundToInt(radius*1.5 - math.Abs(0.4*math.Pow((radius/4)-a,2)))\r\n    FilterList2[a].h = 1\r\n    FilterList2[a].y = (radius/4)-a\r\n    FilterList2[a].blend = subtract\r\n    FilterList2[a].SetFG(ShadeHex)\r\n    BasePanel.Add(FilterList2[a])\r\n\r\nfunc MoveHole()\r\n  ?time%30\r\n    ?blackHole.x<bX\r\n      blackHole.x=blackHole.x+1\r\n    :?blackHole.x>bX\r\n      blackHole.x=blackHole.x-1\r\n    ?blackHole.y<bY\r\n      blackHole.y=blackHole.y+1\r\n    :?blackHole.y>bY\r\n      blackHole.y=blackHole.y-1\r\n    ?holeSize=5\r\n      holeEyes.x=blackHole.x+2\r\n      holeEyes.y=blackHole.y-1\r\n    ?holeSize=4|holeSize=5\r\n      BasePanel.x=blackHole.x\r\n      BasePanel.y=blackHole.y\r\n\r\nfunc SpawnParticle()\r\n  ?prtclSize=1\r\n    var prtcl=uiAA(prtcl)\r\n    prtcl.x=prtclX\r\n    prtcl.y=prtclZ\r\n    prtcl.color=particleColor1\r\n  :?prtclSize=2\r\n    var prtcl=uiAA(prtclBig)\r\n    prtcl.x=prtclX\r\n    prtcl.y=prtclZ\r\n    prtcl.color=particleColor2\r\n  return prtcl\r\n\r\nfunc Particles()\r\n  spawnChance=rng\r\n  ?holeSize=3&time%75=0\r\n    ?spawnChance>=0&spawnChance<=9999\r\n      spawnXrng=rng%11\r\n      spawnYrng=rng%7\r\n      prtclSize=1\r\n      //x\r\n      ?spawnXrng=0\r\n        prtclX=bX-5\r\n      :?spawnXrng=1\r\n        prtclX=bX-4\r\n      :?spawnXrng=2\r\n        prtclX=bX-3\r\n      :?spawnXrng=3\r\n        prtclX=bX-2\r\n      :?spawnXrng=4\r\n        prtclX=bX-1\r\n      :?spawnXrng=5\r\n        prtclX=bX\r\n      :?spawnXrng=6\r\n        prtclX=bX+1\r\n      :?spawnXrng=7\r\n        prtclX=bX+2\r\n      :?spawnXrng=8\r\n        prtclX=bX+3\r\n      :?spawnXrng=9\r\n        prtclX=bX+4\r\n      :\r\n        prtclX=bX+5\r\n      //y\r\n      ?spawnYrng=0\r\n        prtclZ=bY-3\r\n      :?spawnYrng=1\r\n        prtclZ=bY-2\r\n      :?spawnYrng=2\r\n        prtclZ=bY-1\r\n      :?spawnYrng=3\r\n        prtclZ=bY\r\n      :?spawnYrng=4\r\n        prtclZ=bY+1\r\n      :?spawnYrng=5\r\n        prtclZ=bY+2\r\n      :\r\n        prtclZ=bY+3\r\n    prtcls.Add(SpawnParticle())\r\n  :?holeSize=4&time%45=0|holeSize=5&time%15=0\r\n      spawnXrng=rng%17\r\n      spawnYrng=rng%9\r\n      spawnSizerng=rng%2\r\n      //x\r\n      ?spawnXrng=0\r\n        prtclX=bX-9\r\n      :?spawnXrng=1\r\n        prtclX=bX-8\r\n      :?spawnXrng=2\r\n        prtclX=bX-7\r\n      :?spawnXrng=3\r\n        prtclX=bX-6\r\n      :?spawnXrng=4\r\n        prtclX=bX-5\r\n      :?spawnXrng=5\r\n        prtclX=bX-4\r\n      :?spawnXrng=6\r\n        prtclX=bX-3\r\n      :?spawnXrng=7\r\n        prtclX=bX-2\r\n      :?spawnXrng=8\r\n        prtclX=bX-1\r\n      :?spawnXrng=9\r\n        prtclX=bX\r\n      :?spawnXrng=10\r\n        prtclX=bX+1\r\n      :?spawnXrng=11\r\n        prtclX=bX+2\r\n      :?spawnXrng=12\r\n        prtclX=bX+3\r\n      :?spawnXrng=13\r\n        prtclX=bX+4\r\n      :?spawnXrng=14\r\n        prtclX=bX+5\r\n      :?spawnXrng=15\r\n        prtclX=bX+6\r\n      :?spawnXrng=16\r\n        prtclX=bX+7\r\n      :\r\n        prtclX=bX+8\r\n      //y\r\n      ?spawnYrng=0\r\n        prtclZ=bY-5\r\n      :?spawnYrng=1\r\n        prtclZ=bY-4\r\n      :?spawnYrng=2\r\n        prtclZ=bY-3\r\n      :?spawnYrng=3\r\n        prtclZ=bY-2\r\n      :?spawnYrng=4\r\n        prtclZ=bY-1\r\n      :?spawnYrng=5\r\n        prtclZ=bY\r\n      :?spawnYrng=6\r\n        prtclZ=bY+1\r\n      :?spawnYrng=7\r\n        prtclZ=bY+2\r\n      :?spawnYrng=8\r\n        prtclZ=bY+3\r\n      :\r\n        prtclZ=bY+4\r\n      ?spawnSizerng=0\r\n        prtclSize=1\r\n      :\r\n        prtclSize=2\r\n    prtcls.Add(SpawnParticle())\r\n\r\nfunc ParticleMove(p)\r\n    ?p.x<bX\r\n      p.x=p.x+1\r\n    :?p.x>bX\r\n      p.x=p.x-1\r\n    ?time%20=0\r\n      ?p.y<bY\r\n        p.y=p.y+1\r\n      :?p.y>bY\r\n        p.y=p.y-1\r\n    ?p.x=bX&p.y=bY\r\n      return true\r\n    return false\r\n\r\nvar remove\r\nvar count=0\r\n\r\nfunc ParticleRun()\r\n  ?time%10=0 & prtcls.Count()>0\r\n    for p : prtcls\r\n      ?ParticleMove(p)\r\n        delete.Add(count)\r\n        p.Recycle()\r\n      count++\r\n    count=0\r\n    ?delete.Count()>0\r\n      for d : delete\r\n        prtcls.Emplace(d,0)\r\n      for d : delete\r\n        remove=prtcls.IndexOf(0)\r\n        prtcls.RemoveAt(remove)\r\n      delete.Clear()\r\n\r\nfunc HoleXP()\r\n  >`0,9,#565656,ascii\r\n╔═╗\r\n║#║\r\n║#║\r\n║#║\r\n║#║\r\n╟_╢\r\n╟¯╢\r\n║#║\r\n║#║\r\n║#║\r\n║#║\r\n╚═╝\r\nasciiend\r\n  >`0,21,Lvl@holeSize@\r\n  fC=foe.GetCount(150)\r\n  ?totaltime%300=0\r\n    holeTime++\r\n  ?fC<oldfC\r\n    fCdifference=oldfC-fC\r\n    ?foe=\"boss\"\r\n      kills=kills+fCdifference-1+loc.stars\r\n    :\r\n      kills=kills+fCdifference\r\n  oldfC=fC\r\n  ?holeSize=1\r\n    timebar=((holeTime*100)/60)/20\r\n    killbar=((kills*100)/250)/20\r\n    ?holeTime>=60&kills>=250\r\n      LvlUp()\r\n  :?holeSize=2\r\n    timebar=((holeTime*100)/180)/20\r\n    killbar=((kills*100)/500)/20\r\n    ?holeTime>=180&kills>=500\r\n      LvlUp()\r\n  :?holeSize=3\r\n    timebar=((holeTime*100)/320)/20\r\n    killbar=((kills*100)/1500)/20\r\n    ?holeTime>=320&kills>=1500\r\n      LvlUp()\r\n  :?holeSize=4\r\n    timebar=((holeTime*100)/320)/20\r\n    killbar=((kills*100)/3000)/20\r\n    ?holeTime>=320&kills>=3000\r\n      BasePanel.Recycle()\r\n      LvlUp()\r\n      unlock=true\r\n  ?timebar>5\r\n    timebar=5\r\n  ?killbar>5\r\n    killbar=5\r\n  ?timebar>0\r\n    for i = 1..timebar\r\n      >`1,@20-i@,#ff00ff,█\r\n  ?killbar>0\r\n    for i = 1..killbar\r\n      >`1,@9+i@,#red,█\r\n\r\nfunc LvlUp()\r\n  holeTime=0\r\n  kills=0\r\n  holeSize++\r\n  blackHole.Recycle()\r\n  HoleStart()\r\n\r\nfunc Buttons()\r\n  menubtn=uiAB()\r\n  menubtn.dock=center_left\r\n  menubtn.anchor=center_left\r\n  menubtn.text=\"»\"\r\n  menubtn.tcolor=#ff00ff\r\n  menubtn.h=3\r\n  menubtn.w=3\r\n  menubtn.y=-6\r\n  menubtn.SetPressed(Menu)\r\n  lvl1btn=uiAB()\r\n  lvl1btn.text=\"Mini\"\r\n  lvl1btn.h=3\r\n  lvl1btn.w=9\r\n  lvl1btn.y=-6\r\n  lvl1btn.SetPressed(SetLvl)\r\n  lvl2btn=uiAB()\r\n  lvl2btn.text=\"Small\"\r\n  lvl2btn.h=3\r\n  lvl2btn.w=9\r\n  lvl2btn.y=-3\r\n  lvl2btn.SetPressed(SetLvl)\r\n  lvl3btn=uiAB()\r\n  lvl3btn.text=\"Medium\"\r\n  lvl3btn.h=3\r\n  lvl3btn.w=9\r\n  lvl3btn.y=0\r\n  lvl3btn.SetPressed(SetLvl)\r\n  lvl4btn=uiAB()\r\n  lvl4btn.text=\"Large\"\r\n  lvl4btn.h=3\r\n  lvl4btn.w=9\r\n  lvl4btn.y=3\r\n  lvl4btn.SetPressed(SetLvl)\r\n  lvl5btn=uiAB()\r\n  lvl5btn.text=\"Giant\"\r\n  lvl5btn.h=3\r\n  lvl5btn.w=9\r\n  lvl5btn.y=6\r\n  lvl5btn.SetPressed(SetLvl)\r\n  lvlpnl=ui.AddPanel()\r\n  lvlpnl.dock=center_left\r\n  lvlpnl.anchor=center_left\r\n  lvlpnl.y=3\r\n  lvlpnl.Add(lvl1btn)\r\n  lvlpnl.Add(lvl2btn)\r\n  lvlpnl.Add(lvl3btn)\r\n  lvlpnl.Add(lvl4btn)\r\n  lvlpnl.Add(lvl5btn)\r\n  lvlpnl.visible=false\r\n\r\nfunc Menu()\r\n  ?unlock\r\n    menu=!menu\r\n    ?menu\r\n      menubtn.text=\"«\"\r\n      lvlpnl.visible=true\r\n    :\r\n      menubtn.text=\"»\"\r\n      lvlpnl.visible=false\r\n  :\r\n      timer=0\r\n\r\nfunc Text()\r\n  ?timer!30\r\n    >`3,7,#red,Black Hole Level 5 Required\r\n    timer++\r\n\r\nfunc SetLvl(btn)\r\n  blackHole.Recycle()\r\n  ?holeSize=4|holeSize=5\r\n    BasePanel.Recycle()\r\n    ?holeSize=5\r\n      holeEyes.Recycle()\r\n  ?btn=lvl1btn\r\n    holeSize=1\r\n  :?btn=lvl2btn\r\n    holeSize=2\r\n  :?btn=lvl3btn\r\n    holeSize=3\r\n  :?btn=lvl4btn\r\n    holeSize=4\r\n  :?btn=lvl5btn\r\n    holeSize=5\r\n  HoleStart()\r\n\r\nfunc HoleStart()\r\n  ?holeSize=4|holeSize=5\r\n    Darkness()\r\n  BlackHole()\r\n\r\n?totaltime=1\r\n  holeSize=storage.Get(\"size\",1)\r\n  holeTime=storage.Get(\"time\",0)\r\n  kills=storage.Get(\"kills\",0)\r\n  unlock=storage.Get(\"unlock\",false)\r\n  timer=30\r\n  prtcls.Clear()\r\n  HoleStart()\r\n  Buttons()\r\n?pickup=\"treasure\"\r\n  storage.Set(\"time\",holeTime)\r\n  storage.Set(\"kills\",kills)\r\n  storage.Set(\"size\",holeSize)\r\n  storage.Set(\"unlock\",unlock)\r\n?key=bumpRBegin\r\n  holeTime=0\r\n  kills=0\r\n?holeSize=1\r\n  bX=refX-5\r\n  bY=refZ\r\n:?holeSize=2\r\n  bX=refX-7\r\n  bY=refZ-1\r\n:?holeSize=3\r\n  bX=refX-10\r\n  bY=refZ-2\r\n:?holeSize=4\r\n  bX=refX-11\r\n  bY=refZ-3\r\n:?holeSize=5\r\n  bX=refX-16\r\n  bY=refZ-4\r\n?unlock=false\r\n  HoleXP()\r\nMoveHole()\r\nParticles()\r\nParticleRun()\r\nText()\r\n\r\nvar holeGun=ascii\r\n──┬──\r\n#( )\r\n#╧Φ╧{\r\n%%\r\n──┬──\r\n╒(_)╕\r\n╧(│)╧{\r\n##¯\r\n%%\r\n───┬───\r\n╒/  |\\╕\r\n╞\\.┬./╡/\r\n╧( │ )╧│\r\n##`┴´##\\\r\nasciiend\r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/TarPusher.txt" - Parse error: Failed to parse completely. Remaining: "= #FFFFFF\r\n\r\n// FRAMES START HERE\r\n\r\n?(pusherFrame = 1 | !ai.walking)\r\n  pusher = ascii\r\n###O#####\r\n##/‾│‾‾‾‾│\r\n#/#\\└()()┘\r\nasciiend\r\n:?pusherFrame = 2\r\n  pusher = ascii\r\n###O#####\r\n##/‾│‾‾‾‾│\r\n#/|#└()()┘\r\nasciiend\r\n:?pusherFrame = 3\r\n  pusher = ascii\r\n###O#####\r\n##/‾│‾‾‾‾│\r\n#V|#└()()┘\r\nasciiend\r\n:?pusherFrame = 4\r\n  pusher = ascii\r\n###O#####\r\n##/‾│‾‾‾‾│\r\n##|>└()()┘\r\nasciiend\r\n\r\n?foe = boss & ai.walking = false & pusherFrame\r\n^ = 1\r\n  pusher = ascii\r\n#########\r\n#<O>│‾‾‾‾│\r\n#<'>└()()┘\r\nasciiend\r\n?foe = boss & ai.walking = false & pusherFrame\r\n^ = 2\r\n  pusher = ascii\r\n#.#,#####\r\n#<O>│‾‾‾‾│\r\n#<'>└()()┘\r\nasciiend\r\n?foe = boss & ai.walking = false & pusherFrame\r\n^ = 3\r\n  pusher = ascii\r\n`###´####\r\n#<O>│‾‾‾‾│\r\n#<'>└()()┘\r\nasciiend\r\n?foe = boss & ai.walking = false & pusherFrame\r\n^ = 4\r\n  pusher = ascii\r\n#########\r\n#<O>│‾‾‾‾│\r\n#<'>└()()┘\r\nasciiend\r\n\r\n?foe = boss & ai.walking = true & pusherFrame\r\n^ = 1\r\n  pusher = ascii\r\n###O#####\r\n##/‾│‾‾‾‾│\r\n#/#\\└()()┘\r\nasciiend\r\n?foe = boss & ai.walking = true & pusherFrame\r\n^ = 2\r\n  pusher = ascii\r\n##.O#####\r\n##/‾│‾‾‾‾│\r\n#/|#└()()┘\r\nasciiend\r\n?foe = boss & ai.walking = true & pusherFrame\r\n^ = 3\r\n  pusher = ascii\r\n#`#O´####\r\n##/‾│‾‾‾‾│\r\n#V|#└()()┘\r\nasciiend\r\n?foe = boss & ai.walking = true & pusherFrame\r\n^ = 4\r\n  pusher = ascii\r\n###O#####\r\n##/‾│‾‾‾‾│\r\n##|>└()()┘\r\nasciiend\r\n\r\n?pickup.distance < 5 & ai.walking = false\r\n  pusher = ascii\r\n#\\O/#####\r\n##|#│‾‾‾‾│\r\n#/#\\└()()┘\r\nasciiend\r\n\r\n// THE TAR\r\n\r\ntar = ascii\r\n#####.≈≈,\r\n##########\r\n##########\r\nasciiend\r\n\r\n>o-@tarX@,@tarY@,@tarcolour@,@tar@\r\n\r\n>o-@pusherX@,@pusherY@,@pusher@\r\n\r\n// END"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Bolesh.txt" - Parse error: Failed to parse completely. Remaining: "#__\r\n)_#\\#\r\nasciiend\r\n\r\n?mount = 6\r\n >`2,26,#red,ascii\r\nO#:@hp@/@maxhp@\r\nasciiend\r\n\r\n?mount = 6\r\n >`0,21,#red,ascii\r\n┌————┐\r\n│    │\r\n│    │\r\n└————┘\r\nasciiend\r\n\r\n?mount = 6 &\r\n^item.right.state < 2\r\n >`1,22,#white,ascii\r\n#o\r\n#|‾T\r\nasciiend\r\n:?mount = 6\r\n >`1,22,#white,ascii\r\n#o\r\n#|\\_\r\nasciiend\r\n\r\n?mount = 6 &\r\n^item.left.state < 2\r\n >`1,23,#white,ascii\r\n‾\r\nasciiend\r\n:?mount = 6\r\n >`1,23,#white,ascii\r\n/\r\nasciiend\r\n\r\n?mount = 6 &\r\n^item.left.state = 1 |\r\n^mount = 6 &\r\n^item.left.state = -1\r\n >o1,-1,#C8C7C5,ascii\r\n##//\r\n#//\r\n#\\\\\r\n#/|\\\r\n#\\v/\r\nasciiend\r\n\r\n?mount = 6 &\r\n^item.left.state = 1 &\r\n^item.left.time < 3\r\n >o1,-1,#cyan,ascii\r\n##//\r\n#//\r\n#\\\\\r\n#/|\\\r\n#\\v/\r\nasciiend\r\n\r\n?mount = 6 &\r\n^item.left.state = 2\r\n >o1,-2,#C8C7C5,ascii\r\n######/‾\\\r\n##//#/—-•\r\n##\\\\//\\_/\r\n###‾‾\r\nasciiend\r\n\r\n?mount = 6 &\r\n^item.left.state = 3\r\n play mine_walker_attack_a 100\r\n >o1,-2,#C8C7C5,ascii\r\n######___\r\n##//#/———:\r\n##\\\\//‾‾‾\r\n###‾‾\r\nasciiend\r\n\r\n?mount = 6 &\r\n^item.left.state = 4\r\n play mine_walker_attack_b 100\r\n >o1,-2,#cyan,ascii\r\n######___\r\n##//#/———:\r\n##\\\\//‾‾‾\r\n###‾‾\r\nasciiend\r\n\r\n?mount = 6\r\n >o-6,-4,#white,ascii\r\n###_,—-.___\r\n##_\\       \\\r\n#| |)       \\\r\n#|_/_________|\r\nasciiend\r\n\r\n?mount = 6\r\n play wand_fire_cast 100\r\n >o-4,0,#FF9C00,ascii\r\nVV\r\nasciiend\r\n\r\n?mount = 6 &\r\n^time % 10 < 5\r\n >o-4,0,#FF9C00,ascii\r\nVV\r\nvv\r\nasciiend\r\n\r\n?mount = 6 &\r\n^time % 300 > 7\r\n >var mount\r\n\r\nmount = 2\r\n\r\n?mount = 0\r\n enable player\r\n:\r\n disable player\r\n\r\n?mount = 2\r\n >`0,25,#white,ascii\r\n#__\r\n(.'<:\r\nasciiend\r\n\r\n?mount = 2 &\r\n^loc.begin\r\n play spider_boss_awake 100\r\n\r\n?item.right.state = 1 &\r\n^mount = 2 |\r\n^item.left = item.right &\r\n^mount = 2\r\n >o-3,-2,#white,ascii\r\n##___\r\n#/###\\_\r\n/\r\nasciiend\r\n\r\n?item.right.state = 2 &\r\n^item.left ! item.right &\r\n^mount = 2 |\r\n^item.right.state = 3 &\r\n^mount = 2 &\r\n^item.left ! item.right\r\n >o-4,-2,#white,ascii\r\n#/‾‾\\\r\n/####`\r\n\\\r\nasciiend\r\n\r\n?item.right.state = 4 &\r\n^item.left ! item.right &\r\n^mount = 2\r\n >o-3,-3,#white,ascii\r\n#____\r\n/####\\_\r\nasciiend\r\n\r\n?mount = 2\r\n >o-20,-3,#white,ascii\r\n###########\r\n###############o\r\n#####_/‾‾‾‾‾\\#(|\r\n#####\\______/‾‾>\\#__\r\n############\\___/(_.'_\r\n###################\\_#`\r\n##################\r\n#################\r\nasciiend\r\n\r\n?mount = 2 &\r\n^ai.idle |\r\n^mount = 2 &\r\n^ai.walking |\r\n^mount = 2 &\r\n^!ai.walking\r\n >o-20,-3,#white,ascii\r\n########|\\###__\r\n########|#\\#/#|\r\n#####_########(\r\n#####\\/#/######\r\n#####/#/##|#\r\n####/##\\##|#\r\n##-´###´##\\_#\r\n#################\r\nasciiend\r\n\r\n?buffs.string = smite &\r\n^mount = 2\r\n >o-2,0,#E400FF,ascii\r\n##,\r\n└o0\r\nasciiend\r\n\r\n?buffs.string = berserk &\r\n^mount = 2\r\n >o-3,0,#FF9400,ascii\r\n#__\r\n(＂\r\n#‾\r\nasciiend\r\n\r\n?buffs.string = @ &\r\n^mount = 2\r\n >o-3,-1,#green,ascii\r\n#|‾|\r\n_|_|_\r\n##§§\r\nasciiend\r\n\r\n?buffs.string = smite &\r\n^buffs.string = @ &\r\n^mount = 2\r\n >o-3,-1,#E400FF,ascii\r\n#|‾#\r\n_|###\r\n#└o§'\r\nasciiend\r\n\r\n?buffs.string = luck &\r\n^mount = 2\r\n >o-1,1,#cyan,ascii\r\n.'\r\nasciiend\r\n\r\n?buffs.string = vampiric &\r\n^mount = 2\r\n >o-1,2,#red,ascii\r\n#_,\\\r\n###´\r\nasciiend\r\n\r\n?item.left.state = 1 &\r\n^mount = 2 |\r\n^＂ ＂ = item.left &\r\n^item.right.state > 1 &\r\n^mount = 2 |\r\n^ai.idle &\r\n^mount = 2 |\r\n^ai.walking &\r\n^mount = 2 |\r\n^＂ ＂ = item.left &\r\n^mount = 2\r\n >o-4,1,#white,ascii\r\n\\\r\n#\\\r\n#/\r\n´\r\nasciiend\r\n\r\n?item.left.state = 2 &\r\n^mount = 2\r\n >o-4,-1,#white,ascii\r\n##_\r\n#/#|\r\n/##:\r\nasciiend\r\n\r\n?item.left.state = 3 &\r\n^mount = 2\r\n >o-4,-1,#white,ascii\r\n##_\r\n#/#|\r\n/##:\r\nasciiend\r\n\r\n?item.left.state = 4 &\r\n^mount = 2\r\n >o-4,1,#white,ascii\r\n\\\r\n#\\\r\n##\\\r\n###`\r\nasciiend\r\n\r\n?loc = tid_crypt &\r\n^mount = 2\r\n >o-2,1,#white,ascii\r\n###.__\r\n(ε╪═o═╪3\r\n#`└———┘\r\nasciiend\r\n\r\n?mount = 2 &\r\n^item.right.state = 2 &\r\n^＂ ＂ = item.left\r\n play spider_boss_attack 140\r\n >o-2,1,#white,ascii\r\n###.\r\n(  #)\r\n#`\r\nasciiend\r\n\r\n?mount = 2 &\r\n^item.right.state = 3 &\r\n^＂ ＂ = item.left\r\n play tree_boss_spike 110\r\n >o-2,1,#white,ascii\r\n###. \r\n#\\X/ \r\nasciiendo2,-3,#red,ascii\r\n#_\r\n(_)\r\nasciiend\r\n\r\n?mount = 6 &\r\n^time % 300 <= 7\r\n >o2,-2,#red,ascii\r\n———\r\nasciiend\r\n\r\n?mount = 6 &\r\n^item.right.state = 1 |\r\n^mount = 6 &\r\n^item.right.state = -1\r\n >o-3,-1,#white,ascii\r\n##//\r\n#//\r\n#\\\\\r\n#/|\\\r\n#\\v/\r\nasciiend\r\n\r\n?mount = 6 &\r\n^item.right.state = 1 &\r\n^item.right.time < 3\r\n >o-3,-1,#cyan,ascii\r\n##//\r\n#//\r\n#\\\\\r\n#/|\\\r\n#\\v/\r\nasciiend\r\n\r\n?mount = 6 &\r\n^item.right.state = 2\r\n >o-3,-2,#white,ascii\r\n######/‾\\\r\n##//#/—-•\r\n##\\\\//\\_/\r\n###‾‾\r\nasciiend\r\n\r\n?mount = 6 &\r\n^item.right.state = 3\r\n play mine_walker_attack_a 100\r\n >o-3,-2,#white,ascii\r\n######___\r\n##//#/———:\r\n##\\\\//‾‾‾\r\n###‾‾\r\nasciiend\r\n\r\n?mount = 6 &\r\n^item.right.state = 4\r\n play mine_walker_attack_b 100\r\n >o-3,-2,#cyan,ascii\r\n######___\r\n##//#/———:\r\n##\\\\//‾‾‾\r\n###‾‾\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/SpringBloom.txt" - Parse error: Failed to parse completely. Remaining: "= [\r\n#FF0000,#0000FF,\r\n#FFFF00,#FF00FF,#00FFFF,\r\n#FF7700,#7700FF,#0077FF]\r\n\r\n//*******************************\r\n// Global Variables\r\n//*******************************\r\n\r\n// Button Parameters\r\nvar buttonanchor = top_right\r\nvar buttondock = top_right\r\n\r\n// Flower Button Parameters\r\nvar fbuttonx = -1\r\nvar fbuttony = 6\r\nvar fbutton\r\nvar planting = false\r\n\r\n// Shovel Button Parameters\r\nvar sbuttonx = -1\r\n?TapToPlant\r\n  var sbuttony = 11\r\n:\r\n  var sbuttony = 6\r\nvar sbutton\r\n\r\n// Flower Control Arrays\r\nvar apanel = []\r\nvar aflowers = []\r\nvar aflowersx = []\r\nvar cleanup = []\r\n\r\n// Flower Trail Parameters\r\nvar dist = 0\r\nvar steps = 0\r\nvar stepmin = 3\r\nvar stepmax = 6\r\nvar steprng = 0\r\nvar init = screen.FromWorldX(0)\r\nvar diff = 0\r\ndiff = init - screen.FromWorldX(0)\r\n\r\n// Random Flower Parameters\r\nvar delay = 1\r\nvar dmin = 1\r\nvar dmax = 30\r\nvar rngx = 0\r\nvar rngy = 0\r\nvar xmin = 0\r\nvar xmax = screen.w\r\nvar ymin = screen.h - 4\r\nvar ymax = screen.h - 2\r\n\r\n// Temp Parameters\r\nvar FlowerTrailInit = FlowerTrail\r\nvar RandomFlowersInit = RandomFlowers\r\n\r\nvar flowerart = ascii\r\n#Ü\r\n´(`\r\n#░\r\nasciiend\r\n\r\nvar shovelart = ascii\r\n┬\r\n│\r\nÜ\r\nasciiend\r\n\r\nvar sun1 = ascii\r\n#\r\n#\r\n#\r\n##γ\r\n%%\r\n#\r\n#\r\n##γ\r\n##(\r\n%%\r\n#\r\n##γ\r\n#`(\r\n##)´\r\n%%\r\n##_\r\n#(_)\r\n#`(\r\n#`)´\r\n%%\r\n#.γ,\r\n:>@<;\r\n#´(`\r\n#`)´\r\nasciiend\r\n\r\nvar sun2 = ascii\r\n#\r\n#\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n%%\r\n##_\r\n#(@)\r\n#\r\n#\r\n%%\r\n#.γ,\r\n:>@<;\r\n#´#`\r\n#\r\nasciiend\r\n\r\nvar dandy1 = ascii\r\n#\r\n#\r\n#\r\n##γ\r\n%%\r\n#\r\n#\r\n##γ\r\n##{\r\n%%\r\n#\r\n##γ\r\n##{\r\n##}\r\n%%\r\n#\r\n#(@)\r\n##{\r\n##}\r\n%%\r\n#.~.\r\n:~*~;\r\n#`{´\r\n##}\r\nasciiend\r\n\r\nvar dandy2 = ascii\r\n#\r\n#\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n%%\r\n#\r\n#(@)\r\n#\r\n#\r\n%%\r\n#.~.\r\n:~*~;\r\n#`#´\r\n#\r\nasciiend\r\n\r\nvar tulip1 = ascii\r\n#\r\n#\r\n#\r\n##γ\r\n%%\r\n#\r\n#\r\n##γ\r\n##(\r\n%%\r\n#\r\n##u\r\n##(,\r\n##)\r\n%%\r\n##,\r\n##Ü\r\n##(,\r\n##)\r\n%%\r\n##,\r\n#(_)\r\n##(,\r\n#`)\r\nasciiend\r\n\r\nvar tulip2 = ascii\r\n#\r\n#\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n%%\r\n#\r\n##u\r\n#\r\n#\r\n%%\r\n##,\r\n##Ü\r\n#\r\n#\r\n%%\r\n##,\r\n#(_)\r\n#\r\n#\r\nasciiend\r\n\r\nvar sage1 = ascii\r\n#\r\n#\r\n#\r\n##γ\r\n%%\r\n#\r\n#\r\n##γ\r\n##ι\r\n%%\r\n#\r\n###,\r\n#`γ\r\n##ι´\r\n%%\r\n#\r\n###,\r\n#`γ,\r\n#`ι´\r\n%%\r\n#\r\n.,#,\r\n,`γ,´\r\n#`ι´\r\nasciiend\r\n\r\nvar sage2 = ascii\r\n#\r\n#\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n%%\r\n#\r\n###,\r\n#`\r\n###´\r\n%%\r\n#\r\n###,\r\n#`#,\r\n#`#´\r\n%%\r\n#\r\n.,#,\r\n,`#,´\r\n#`#´\r\nasciiend\r\n\r\nvar shroom1 = ascii\r\n#\r\n#\r\n#\r\n##.\r\n%%\r\n#\r\n#\r\n#\r\n##õ\r\n%%\r\n#\r\n#\r\n##,\r\n#(_)\r\n%%\r\n#\r\n##,\r\n#(_)\r\n##0\r\n%%\r\n#\r\n#,~.\r\n(___)\r\n#(_)\r\nasciiend\r\n\r\nvar shroom2 = ascii\r\n#\r\n#\r\n#\r\n##.\r\n%%\r\n#\r\n#\r\n#\r\n##õ\r\n%%\r\n#\r\n#\r\n##,\r\n#(_)\r\n%%\r\n#\r\n##,\r\n#(_)\r\n#\r\n%%\r\n#\r\n#,~.\r\n(___)\r\n#\r\nasciiend\r\n\r\nvar treewood = ascii\r\n##,:;*;,\r\n,:;*|'/*:,\r\n*─\\'|*|;─;\r\n`,*\\`;;─*\r\n##`'##´´\r\n######´\r\nasciiend\r\n\r\nvar treeleaves = ascii\r\n##,:;#;,\r\n,:;##'##:,\r\n###'###;#;\r\n`,##`;;\r\n##`'##´´\r\n######´\r\nasciiend\r\n\r\nvar treeflowers = ascii\r\n#####*\r\n###*###*\r\n*####*\r\n##*#####*\r\nasciiend\r\n\r\nvar custstyle = ui.AddStyle(\"\r\n^###\r\n^###\r\n^###\")\r\n\r\n\r\n//*******************************\r\n// Functions\r\n//*******************************\r\n\r\n//*******************************\r\n// BuildRows()\r\n//\r\n// Creates panel rows to plants \r\n// flowers in. There's a panel\r\n// for each y-value, spanning \r\n// the entire screen, and the\r\n// panels are created top to \r\n// bottom, meaning flowers \r\n// planted in lower rows will \r\n// overlap flowers planted in\r\n// higher rows, ensuring they \r\n// maintain the illusion of the \r\n// z-direction. \r\n//\r\n//*******************************\r\nfunc BuildRows()\r\n  apanel.Clear()\r\n  var p\r\n  var t\r\n  for i = 0 .. screen.h\r\n    p = ui.AddPanel()\r\n    p.anchor = top_center\r\n    p.dock = top_center\r\n    p.visible = true\r\n    p.color = #888888\r\n    p.style = custstyle \r\n    p.w = screen.w\r\n    p.h = 1\r\n    p.x = 0\r\n    p.y = i\r\n    apanel.Add(p)\r\n//\r\n\r\n\r\n//*******************************\r\n// Bloom()\r\n//\r\n// Creates a single flower at\r\n// location posx, posy. Randomly\r\n// chooses the type of flower\r\n// and the color of that flower.\r\n// Adds the flower to the panel \r\n// correlated to it's y-position\r\n// so flowers grow in the correct\r\n// z-direction, and adds the\r\n// flower to the aflowers array\r\n// for future position control\r\n// and deletion. Returns the \r\n// world position of the flower \r\n// for reference as the player \r\n// travels through the world\r\n//\r\n//*******************************\r\nfunc Bloom(posx,posy)\r\n  ?(aflowers.Count()+1) > MaxFlowers\r\n    return 0\r\n\r\n  ?posx < (screen.w + fbutton.x) & \r\n   ^posx > (screen.w + fbutton.x - 8) &\r\n   ^posy > fbutton.y & posy < fbutton.y + 5\r\n    return 0 \r\n\r\n  var art1\r\n  var art2\r\n  var col1 = #AAAAAA\r\n  var col2 = #FFFFFF\r\n  var r = rng % (5)\r\n  \r\n  ?r = 0\r\n    art1 = sun1\r\n    art2 = sun2\r\n  :?r = 1\r\n    art1 = dandy1\r\n    art2 = dandy2   \r\n  :?r = 2\r\n    art1 = tulip1\r\n    art2 = tulip2    \r\n  :?r = 3\r\n    art1 = sage1\r\n    art2 = sage2    \r\n  :?r = 4\r\n    art1 = shroom1\r\n    art2 = shroom2    \r\n  :\r\n    art1 = sun1\r\n    art2 = sun2\r\n\r\n  ?Colors\r\n    ?r = 4\r\n      col1 = #white\r\n    :\r\n      col1 = #green\r\n\r\n    ?r = 1\r\n      col2 = #white\r\n    :\r\n      col2 = acolors[\r\n      ^(rng % acolors.Count())]  \r\n\r\n  var p = ui.AddPanel()\r\n  p.style = custstyle\r\n  p.anchor = top_left\r\n  p.dock = top_left\r\n  p.x = posx-2\r\n  p.y = -3\r\n  p.w = 5\r\n  p.h = 4\r\n\r\n  var a1 = ui.AddAnim(art1)\r\n  a1.duration = 20\r\n  a1.color = col1\r\n\r\n  var a2 = ui.AddAnim(art2)\r\n  a2.duration = 20\r\n  a2.color = col2\r\n\r\n  p.Add(a1)\r\n  p.Add(a2)\r\n\r\n  apanel[posy].Add(p)\r\n  aflowers.Add(p)\r\n  aflowersx.Add(screen.ToWorldX(\r\n                 ^posx-2) + diff)\r\n\r\n  a1.Play()\r\n  a2.Play()\r\n\r\n  return 1\r\n//\r\n\r\n//*******************************\r\n// Tend()\r\n//\r\n// Updates the position of \r\n// flowers as the player travels\r\n// through the world. If the \r\n// flowers are moved far off \r\n// screen, they are deleted to \r\n// save array size. If no flowers\r\n// exist, the shovel button is \r\n// hidden, else it is visible\r\n//\r\n//*******************************\r\nfunc Tend()\r\n  cleanup.Clear()\r\n  ?aflowers.Count() >= 1\r\n    ?ShowButton = true\r\n      sbutton.visible = true\r\n    for i = 0 .. aflowers.Count() - 1\r\n      aflowers[i].x = screen.FromWorldX(\r\n                      ^aflowersx[i]-diff)\r\n      ?aflowers[i].x < -20\r\n        cleanup.Add(i)\r\n    ?cleanup.Count() >= 1\r\n      for i = cleanup.Count() - 1 .. 0\r\n        aflowers[(cleanup[i])].Clear()\r\n        aflowers.RemoveAt(cleanup[i])\r\n        aflowersx.RemoveAt(cleanup[i])\r\n  :\r\n    sbutton.visible = false\r\n//\r\n\r\n//*******************************\r\n// Prune()\r\n//\r\n// Clears all flowers and resets\r\n// the flower arrays when called\r\n//\r\n//*******************************\r\nfunc Prune()\r\n  ?aflowers.Count() >= 1\r\n    for i = 0 .. aflowers.Count() - 1\r\n      aflowers[i].Clear()\r\n    aflowers.Clear()\r\n    aflowersx.Clear()\r\n//\r\n\r\n//*******************************\r\n// DrawButton()\r\n//\r\n// Draws a Flower or Shovel button \r\n// as a parent panel holding the \r\n// ascii art and interactive \r\n// button\r\n//\r\n//*******************************\r\nfunc DrawButton(type)\r\n  var vis\r\n  var buttonx\r\n  var buttony\r\n  var art\r\n  var text\r\n  var function\r\n\r\n  ?type = 1 //flower\r\n    vis = TapToPlant\r\n    buttonx = fbuttonx\r\n    buttony = fbuttony\r\n    art = flowerart\r\n    text = \"[F]\"\r\n    function = FBtnPressed\r\n    key.Bind(\"Up\", \"F\")\r\n  :?type = 2 //shovel\r\n    vis = false\r\n    buttonx = sbuttonx\r\n    buttony = sbuttony\r\n    art = shovelart\r\n    text = \"[S]\"\r\n    function = SBtnPressed\r\n  :\r\n    return 0\r\n\r\n  var p = ui.AddPanel()\r\n  p.anchor = buttonanchor\r\n  p.dock = buttondock\r\n  p.visible = vis\r\n  p.color = #888888\r\n  p.style = 1\r\n  p.w = 7\r\n  p.h = 5\r\n  p.x = buttonx\r\n  p.y = buttony\r\n\r\n  var b = ui.AddButton()\r\n  b.anchor = center_center\r\n  b.dock = center_center\r\n  b.visible = inherit\r\n  b.style = 0\r\n  b.text = \"\"\r\n  b.w = 5\r\n  b.h = 3\r\n  b.SetPressed(function)\r\n  p.Add(b)\r\n\r\n  var a = ui.AddAnim(art)\r\n  a.anchor = center_center\r\n  a.dock = center_center\r\n  a.visible = inherit\r\n  a.color = #white\r\n  p.Add(a)\r\n\r\n  // Only displays text on PC\r\n  // to match other buttons\r\n  ?sys.isPC\r\n    var t = ui.AddText()\r\n    t.anchor = bottom_right\r\n    t.dock = bottom_right\r\n    t.visible = inherit\r\n    t.color = #888888\r\n    t.text = text\r\n    t.w = 3\r\n    t.h = 1\r\n    t.x = -1\r\n    p.Add(t)\r\n  //\r\n\r\n  return p\r\n//\r\n\r\n//*******************************\r\n// FBtnPressed()\r\n//\r\n// Intermediary function to\r\n// trigger planting flowers on\r\n// or off\r\n//*******************************\r\nfunc FBtnPressed()\r\n  ?!planting \r\n    planting = true\r\n    fbutton.color = #FFFFFF\r\n  :\r\n    planting = false\r\n    fbutton.color = #888888\r\n//\r\n\r\n//*******************************\r\n// SBtnPressed()\r\n//\r\n// Intermediary function to\r\n// properly call Prune\r\n// function\r\n//*******************************\r\nfunc SBtnPressed()\r\n  Prune()\r\n//\r\n\r\n//*******************************\r\n// Sow()\r\n//\r\n// Randomly draws flowers behind\r\n// the player as he travels \r\n// through the world. The amount \r\n// of steps the player takes\r\n// before the next flower is \r\n// planted is randomly generated\r\n// after each flower. Flowers \r\n// aren't planted when traveling\r\n// to the boss because the player\r\n// technically stays still while\r\n// the world travels around them\r\n//\r\n//*******************************\r\nfunc Sow()\r\n  ?ai.walking & FlowerTrail\r\n    ?dist = 0\r\n      dist = screen.FromWorldX(pos.x) \r\n      // Using FromWorld instead of just\r\n      // pos.x keeps flowers from spawning \r\n      // during traveling to the boss\r\n      steps = 0\r\n      steprng = stepmin + rng % \r\n                ^(stepmax - stepmin + 1)\r\n    :\r\n      steps = screen.FromWorldX(pos.x)-dist\r\n      // Using FromWorld instead of just\r\n      // pos.x keeps flowers from spawning \r\n      // during traveling to the boss \r\n      ?steps > steprng\r\n        Bloom(screen.FromWorldX(pos.x-5),\r\n             ^screen.FromWorldZ(pos.z))\r\n        dist = 0\r\n      :?steps < 0\r\n        dist = 0\r\n      //\r\n    //\r\n  //\r\n//\r\n\r\n//*******************************\r\n// PlantSeedbed()\r\n//\r\n// Sets the min and max row \r\n// parameters the random flowers \r\n// can sprout in. These rows are\r\n// kept near the bottom of the \r\n// screen to add decoration\r\n// without interrupting gameplay.\r\n// For levels where random \r\n// flowers sprouting or trailing\r\n// behind the player don't work\r\n// aesthetically, these features\r\n// are disabled. \r\n//\r\n//*******************************\r\nfunc PlantSeedbed()\r\n  FlowerTrail = FlowerTrailInit \r\n  RandomFlowers = RandomFlowersInit \r\n  xmin = 0\r\n  xmax = screen.w\r\n  ymin = screen.h - 4\r\n  ymax = screen.h - 2\r\n  var lvl = loc.id\r\n\r\n  ?lvl = \"rocky_plateau\"\r\n    ymin = screen.h - 3\r\n\r\n  :?lvl = \"deadwood_valley\"\r\n    ymin = screen.h - 8\r\n    ymax = screen.h - 8\r\n\r\n  :?lvl = \"caustic_caves\"\r\n    ymin = screen.h - 2\r\n\r\n  :?lvl = \"waterfall\"\r\n    RandomFlowers = false\r\n\r\n  :?lvl = \"fungus_forest\"\r\n    ymin = screen.h - 4\r\n\r\n  :?lvl = \"uulaa_shop\"\r\n    ymin = screen.h - 1\r\n    ymax = screen.h - 1\r\n\r\n  :?lvl = \"undead_crypt_intro\"\r\n    RandomFlowers = false\r\n\r\n  :?lvl = \"undead_crypt\"\r\n    ymin = screen.h - 4\r\n\r\n  :?lvl = \"cross_deadwood_river\"\r\n    RandomFlowers = false\r\n    FlowerTrail = false\r\n\r\n  :?lvl = \"bronze_mine\"\r\n    ymin = screen.h - 5\r\n\r\n  :?lvl = \"icy_ridge\"\r\n    ymin = screen.h - 2\r\n\r\n  :?lvl = \"cross_bridge\"\r\n    RandomFlowers = false\r\n    FlowerTrail = false\r\n\r\n  :?lvl = \"temple\"\r\n    ymin = screen.h - 2\r\n//\r\n\r\n//*******************************\r\n// Sprout()\r\n//\r\n// Sprouts flowers within the\r\n// seedbed at a random location,\r\n// with random length delays\r\n// between each flower sprout.\r\n//\r\n//*******************************\r\nfunc Sprout()\r\n  ?RandomFlowers & time % delay=0\r\n    rngy = ymin+rng%(ymax-ymin+1)\r\n    rngx = xmin+rng%(xmax-xmin+1)\r\n    Bloom(rngx,rngy)\r\n    delay = dmin+rng%(dmax-dmin+1)\r\n//\r\n\r\n//*******************************\r\n// SpringBanner()\r\n//\r\n// Replaces the standard level\r\n// banners with spring banners \r\n// decorated with flowers\r\n//\r\n//*******************************\r\nfunc SpringBanner()\r\n  ?Banner = false\r\n    return 0\r\n\r\n  var sp1 = \".v,   .·'·.    \"\r\n  var sp2 = \"´^`~*´ ´·` `~*~\"\r\n  var sp3 = \"    .·'·.   .v,\"\r\n  var sp4 = \"~*~´ ´·` `*~´^`\"\r\n  var loc1 = \"\"\r\n  var loc2 = \"\"\r\n  var str1 = \"\"\r\n  var str2 = \"\"\r\n  var lvl = loc.id\r\n\r\n  ?lvl = \"rocky_plateau\"\r\n    loc1 = \"Rocky Plateau\"\r\n    loc2 = \".*~´`~*~´`~*.\"\r\n  :?lvl = \"deadwood_valley\"\r\n    loc1 = \"Deadwood Valley\"\r\n    loc2 = \".*~´`~*~*~´`~*.\"\r\n  :?lvl = \"caustic_caves\"\r\n    loc1 = \"Caves of Fear\"\r\n    loc2 = \".*~´`~*~´`~*.\"\r\n  :?lvl = \"waterfall\"\r\n    loc1 = \"Deadwood Waterfall\"\r\n    loc2 = \".*~´`~*~´`~*~´`~*.\"\r\n  :?lvl = \"fungus_forest\"\r\n    loc1 = \"Mushroom Forest\"\r\n    loc2 = \".*~´`~*~*~´`~*.\"\r\n  :?lvl = \"undead_crypt_intro\"\r\n    loc1 = \"Haunted Gate\"\r\n    loc2 = \".*~*~´`~*~*.\"\r\n  :?lvl = \"undead_crypt\"\r\n    loc1 = \"Haunted Halls\"\r\n    loc2 = \".*~´`~*~´`~*.\"\r\n  :?lvl = \"cross_deadwood_river\"\r\n    loc1 = \"Cross Deadwood River\"\r\n    loc2 = \".*~´`~.*~´`~*.~´`~*.\"\r\n  :?lvl = \"bronze_mine\"\r\n    loc1 = \"Boiling Mine\"\r\n    loc2 = \".*~*~´`~*~*.\"\r\n  :?lvl = \"icy_ridge\"\r\n    loc1 = \"Icy Ridge\"\r\n    loc2 = \".~´`*´`~.\"\r\n  :?lvl = \"cross_bridge\"\r\n    loc1 = \"Cross the Bridge\"\r\n    loc2 = \".~´`~*~´`~*~´`~.\"\r\n  :?lvl = \"temple\"\r\n    loc1 = \"Temple\"\r\n    loc2 = \".~´`~.\"\r\n\r\n  str1 = sp1 + loc1 + sp3\r\n  str2 = sp2 + loc2 + sp4\r\n  ui.ShowBanner(str1,str2)\r\n//\r\n\r\n//*******************************\r\n// BloomTree()\r\n//\r\n// Replaces the dead tree at the \r\n// Deadwood Waterfall with a \r\n// colorful tree full of leaves\r\n// and blooming with flowers. The\r\n// color of the flowers changes\r\n// randomly upon each visit\r\n//\r\n//*******************************\r\nfunc BloomTree()\r\n  ?loc.id ! \"waterfall\"\r\n    return 0\r\n  \r\n  var p = ui.AddPanel()\r\n  p.style = custstyle\r\n  p.anchor = bottom_center\r\n  p.dock = top_center\r\n  p.x = -14\r\n  p.y = -2\r\n  p.w = 10\r\n  p.h = 6\r\n\r\n  var a1 = ui.AddAnim(treewood)\r\n  a1.w = 10\r\n  a1.h = 6\r\n\r\n  var a2 = ui.AddAnim(treeleaves)\r\n  a2.w = 10\r\n  a2.h = 6\r\n\r\n  var a3 = ui.AddAnim(treeflowers)\r\n  a3.w = 10\r\n  a3.h = 6\r\n\r\n  ?Colors\r\n    a1.color = #888888\r\n    a2.color = #00FF00\r\n    a3.color = acolors[(rng % \r\n                 ^acolors.Count())]\r\n  :\r\n    a1.color = #888888\r\n    a2.color = #CCCCCC\r\n    a3.color = #FFFFFF    \r\n\r\n  p.Add(a1)\r\n  p.Add(a2)\r\n  p.Add(a3)\r\n\r\n  ?screen.h > 25\r\n    apanel［9］.Add(p)//p.y=9\r\n  :\r\n    apanel［8］.Add(p)//p.y=8\r\n//\r\n\r\n\r\n//*******************************\r\n// Drawing Code \r\n//*******************************\r\n\r\n?time <= 1 & totaltime <= 1\r\n  SpringBanner()\r\n  BuildRows()\r\n  BloomTree()\r\n  fbutton = DrawButton(1)\r\n  sbutton = DrawButton(2)\r\n  PlantSeedbed()\r\n:?time <= 1 \r\n  Prune()\r\n:?time > 5\r\n  Sow()\r\n  Sprout()\r\n  Tend()\r\n\r\n?planting & key = PrimaryBegin\r\n  Bloom(input.x,input.y)\r\n\r\n?key = DownBegin\r\n  SBtnPressed()\r\n\r\n?key = UpBegin\r\n  FBtnPressed()\r\n  \r\n//*******************************\r\n// End of File\r\n//*******************************"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetDog.txt" - Parse error: Failed to parse completely. Remaining: "= #white\r\n\r\nvar keepDistance = -36\r\nvar maxX = -19\r\n\r\nvar maxDistance\r\nmaxDistance = -70\r\n\r\nvar targetZ = -4\r\n\r\nvar x = 0\r\nvar y = 0\r\nvar myX = 0\r\nvar myZ = 0\r\nvar lastPlayerX = 0\r\nvar lastPlayerZ = 0\r\n\r\nvar headX = 8\r\nvar headY = -2\r\nvar bodyX = 5\r\nvar bodyY = 1\r\nvar petX\r\nvar petY\r\nvar lastInputX = 0\r\nvar isPettingHead = false\r\nvar isPettingBody = false\r\nvar pettingDirection = 0\r\n\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1\r\nvar stateBark = 2\r\nvar stateJump = 3\r\nvar stateStopping = 4\r\nvar currentState = stateNone\r\nvar stateTime = 0\r\n\r\nvar barkDuration = 6\r\n\r\n\r\nfunc SetState(newState)\r\n  ?newState = stateJump\r\n    play haunted_gate_shuffle\r\n\r\n  currentState = newState\r\n  stateTime = 0\r\n\r\n\r\n?currentState = stateNone | time = 1\r\n  lastPlayerX = pos.x\r\n  lastPlayerZ = pos.z\r\n  myX = keepDistance\r\n  myZ = targetZ\r\n\r\n  // Start further away if the frog is summoned while the location is already running\r\n  ?time > 1\r\n    myX = maxDistance\r\n\r\n  SetState(stateIdle)\r\n\r\n\r\n// Bark input\r\n?key = primaryBegin\r\n  play dog_bark\r\n  ?currentState = stateIdle\r\n    SetState(stateBark)\r\n  :?currentState = stateBark\r\n    stateTime = 1\r\n\r\n\r\nmyX = myX - (pos.x - lastPlayerX)\r\n\r\nstateTime++\r\n\r\n?currentState = stateIdle\r\n  ?myX < maxDistance | myX > -maxDistance\r\n    myX = maxDistance\r\n  myZ = myZ - (pos.z - lastPlayerZ)\r\n\r\n  ?myX < keepDistance\r\n    SetState(stateJump)\r\n  :\r\n    petX = screen.FromWorldX(pos.x) + myX\r\n    petY = screen.FromWorldZ(pos.z - pos.y) + myZ\r\n    ?input.x >= petX + headX & input.x <= petX + headX + 5 & \r\n^    input.y >= petY + headY & input.y <= petY + headY + 2\r\n      isPettingHead = true\r\n      isPettingBody = false\r\n      ?input.x < lastInputX\r\n        pettingDirection -= 3\r\n      :?input.x > lastInputX\r\n        pettingDirection += 3\r\n    :?input.x >= petX + bodyX & input.x <= petX + bodyX + 6 & \r\n^    input.y >= petY + bodyY & input.y <= petY + bodyY + 2\r\n      isPettingHead = false\r\n      isPettingBody = true\r\n      ?input.x < lastInputX\r\n        pettingDirection -= 3\r\n      :?input.x > lastInputX\r\n        pettingDirection += 3\r\n    :\r\n      isPettingHead = false\r\n      isPettingBody = false\r\n    lastInputX = input.x\r\n    ?pettingDirection > 0\r\n      pettingDirection--\r\n    :?pettingDirection < 0\r\n      pettingDirection++\r\n\r\n\r\n:?currentState = stateBark\r\n  ?stateTime >= barkDuration\r\n    SetState(stateIdle)\r\n  myZ = myZ - (pos.z - lastPlayerZ)\r\n\r\n:?currentState = stateJump\r\n  ?myX < maxX\r\n    myX++\r\n\r\n  ?stateTime >= 6 & time % 2 = 0\r\n    ?myZ > targetZ\r\n      myZ--\r\n    :?myZ < targetZ\r\n      myZ++\r\n\r\n  ?stateTime >= 12\r\n    ?myX < maxX - 1\r\n      SetState(stateJump)\r\n    :\r\n      SetState(stateStopping)\r\n\r\n:?currentState = stateStopping\r\n  ?stateTime >= 1\r\n    SetState(stateIdle)\r\n\r\n\r\nlastPlayerX = pos.x\r\nlastPlayerZ = pos.z\r\n\r\n\r\n// Draw\r\n\r\n?currentState = stateIdle\r\n  >o@myX@,@myZ@,@petColor@,ascii\r\n#\r\n#\r\n#########|\\´/\r\n#########/   -,\r\n######,-´ `--´\r\n#####/ _   ;\r\n#### , _)\\(\r\n#### `-'  `\"\r\nasciiend\r\n\r\n  x = myX + 8\r\n  y = myZ + 3\r\n  \r\n  ?face = \"^^\" | isPettingHead | isPettingBody\r\n    >o@x@,@y@,@petColor@,ascii\r\n#/ ^^\r\nasciiend\r\n\r\n  :?(bighead = false & time % 90 > 8) | face = \"''\" | face = \",,\" | face = \"°°\"\r\n    >o@x@,@y@,@petColor@,ascii\r\n#/ ''\r\nasciiend\r\n\r\n\r\n  // Petting\r\n\r\n  ?isPettingHead & pettingDirection < -1\r\n    >o@x@,@y - 1@,@petColor@,ascii\r\n#|\\\\ #\r\nasciiend\r\n  :?isPettingHead & pettingDirection > 1\r\n    >o@x@,@y - 1@,@petColor@,ascii\r\n# /|/\r\nasciiend\r\n\r\n  ?isPettingBody\r\n    ?time % 6 = 0 | time % 6 = 1\r\n      >o@x - 4@,@y + 2@,@petColor@,ascii\r\n#/´¯)/\r\n#_ -´\r\n#   #\r\nasciiend\r\n    ?time % 6 = 2\r\n      >o@x - 4@,@y + 2@,@petColor@,ascii\r\n#/´¯),:\r\n#_ -´ ;\r\n# `--´\r\nasciiend\r\n    ?time % 6 = 3\r\n      >o@x - 4@,@y + 2@,@petColor@,ascii\r\n#/ _\r\n#_  )\r\n# `--'\r\nasciiend\r\n    ?time % 6 = 4\r\n      >o@x - 4@,@y + 2@,@petColor@,ascii\r\n#/.-.\r\n#_ -',\r\n# `¯´\r\nasciiend\r\n    ?time % 6 = 5\r\n      >o@x - 4@,@y + 2@,@petColor@,ascii\r\n#/,´),\r\n#_ .-´\r\n#   #\r\nasciiend\r\n\r\n\r\n  // Tongue\r\n  \r\n  y++\r\n  \r\n  ?time % 100 < 50\r\n    ?time % 100 <= 3 | time % 100 >= 46\r\n      >o@x@,@y@,@petColor@,ascii\r\n# `--'\r\nasciiend\r\n\r\n    :?time % 100 <= 7 | time % 100 >= 42\r\n      >o@x@,@y@,@petColor@,ascii\r\n# `-';\r\nasciiend\r\n\r\n    :?time % 8 <= 3\r\n      >o@x@,@y@,@petColor@,ascii\r\n# `-\\)\r\nasciiend\r\n    :\r\n      >o@x@,@y@,@petColor@,ascii\r\n# `-`'\r\nasciiend\r\n\r\n\r\n?currentState = stateBark\r\n  ?stateTime = 0 | stateTime = (barkDuration - 1)\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n#\r\n#\r\n#########|\\|\r\n#########/  `-,\r\n######,-´ `--`\r\n#####/ _   ;\r\n#### , _)\\(\r\n#### `-'  `\"\r\nasciiend\r\n  :\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n#\r\n#\r\n#########\\``--,\r\n#########/ _.-'\r\n######,-´  '\r\n#####/ _   ;\r\n#### , _)\\(\r\n#### `-'  `\"\r\nasciiend\r\n\r\n\r\n?currentState = stateIdle | currentState = stateBark\r\n  // Tail\r\n  \r\n  x = myX\r\n  y = myZ + 5\r\n  \r\n  ?time % 10 <= 1\r\n    >o@x@,@y@,@petColor@,ascii\r\n#\r\n#,--'\r\n#`- ‾\r\nasciiend\r\n\r\n  :?time % 10 = 2\r\n    >o@x@,@y@,@petColor@,ascii\r\n#\r\n#,--'\r\n#\\' ‾\r\nasciiend\r\n\r\n  :?time % 10 = 3\r\n    >o@x@,@y@,@petColor@,ascii\r\n#\r\n,--'´\r\n'´ ‾ \r\nasciiend\r\n\r\n  :?time % 10 = 4\r\n    >o@x@,@y@,@petColor@,ascii\r\n#_\r\n#\\`'´\r\n##`‾ \r\nasciiend\r\n\r\n  :?time % 10 = 5 | time % 10 = 6\r\n    >o@x@,@y@,@petColor@,ascii\r\n##,\r\n#(`'´\r\n##‾  \r\nasciiend\r\n\r\n  :?time % 10 = 7\r\n    >o@x@,@y@,@petColor@,ascii\r\n#,\r\n#\\`-´\r\n##‾‾ \r\nasciiend\r\n\r\n  :?time % 10 = 8\r\n    >o@x@,@y@,@petColor@,ascii\r\n#\r\n\\---'\r\n#` ‾ \r\nasciiend\r\n\r\n  :?time % 10 = 9\r\n    >o@x@,@y@,@petColor@,ascii\r\n#\r\n#,--'\r\n´‾ ‾‾\r\nasciiend\r\n\r\n\r\n\r\n?currentState = stateJump\r\n  ?stateTime/2 = 0\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n#\r\n###########-.-,\r\n##########.´ ''-,\r\n#;###.--'´  `--´\r\n#\\`-´   _  /\r\n##`´#\\ )| /`.\r\n#####(( ;/ `'\r\n######`\"´\r\nasciiend\r\n\r\n  :?stateTime/2 = 1\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n###########-.-,\r\n###########/ ''-,\r\n#######_.-´ `--´\r\n#,##,-´     /\r\n('-´    _. /`-.\r\n#`'´| ;‾#`,|##`'\r\n####// \\#.-'\r\n###`'##`'\r\nasciiend\r\n\r\n  :?stateTime/2 = 2\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n###########|\\´/\r\n#########_.´ ''-,\r\n####,-'´    `--´\r\n,.-´     _  )_\r\n`-'/ _.´##'--,)\r\n#,´.´.######, \r\n#|| (####### `'\r\n#`'#`'\r\nasciiend\r\n\r\n  :?stateTime/2 = 3\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n#\r\n###########;(,|\r\n,.---._ __.' ''-,\r\n`-'´.       `--´\r\n###/ ,-.__  |\r\n#,´-´#####`-.`.\r\n'´#`'######, `,)\r\n###########`-'\r\nasciiend\r\n\r\n  :?stateTime/2 = 4\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n#\r\n#,\r\n('-._######;(,|\r\n `'´ `-.__.' ''-,\r\n####/       `--´\r\n#,-´_.´`.__ !\r\n#'´'#####, `.`.\r\n#########`-' `-'\r\nasciiend\r\n\r\n  :?stateTime/2 = 5\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n#\r\n#\r\n#;#########|\\´/\r\n#\\`-----._.´ ''-,\r\n##`´/       `--´\r\n###,'_,-._/ !\r\n####\\\\.##,|(\r\n#####`\"#'´`-'\r\nasciiend\r\n\r\n\r\n\r\n?currentState = stateStopping\r\n  ?stateTime = 0\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n#\r\n#\r\n##########|\\´/\r\n#;########/ ''-,\r\n#\\`--.---´ `--´\r\n##`´|  ;  , !\r\n####`,(`--|(\r\n##### `\"  `-'\r\nasciiend\r\n  :\r\n    >o@myX@,@myZ@,@petColor@,ascii\r\n#\r\n#\r\n#########|\\´/\r\n#########/ ''-,\r\n#;###,--´ `--´\r\n#\\`-´  -.  ;\r\n##`- ;,-'\\(\r\n#####`-'  `\"\r\nasciiend\r\n\r\n\r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/ConfettiHead.txt" - Parse error: Failed to parse completely. Remaining: "= ［ascii\r\n#######\r\n###|###\r\n##\\#/##\r\n#—###—#\r\n#######\r\n#######\r\n#######\r\nasciiend,\r\n^ascii\r\n###´###\r\n#'###,#\r\n#######\r\n•#####`\r\n#######\r\n#######\r\n#######\r\nasciiend,\r\n^ascii\r\n###•###\r\n#´#####\r\n#####'#\r\n,#####•\r\n#######\r\n#######\r\n#######\r\nasciiend,\r\n^ascii\r\n#######\r\n#,#`###\r\n#####`#\r\n######.\r\n'######\r\n#######\r\n#######\r\nasciiend,\r\n^ascii\r\n#######\r\n###•###\r\n#´###.#\r\n#######\r\n•#####´\r\n#######\r\n#######\r\nasciiend,\r\n^ascii\r\n#######\r\n###,###\r\n#.#####\r\n#####,#\r\n######•\r\n`######\r\n#######\r\nasciiend,\r\n^ascii\r\n#######\r\n#######\r\n###´###\r\n#•#####\r\n#####`#\r\n.#####`\r\n#######\r\nasciiend,\r\n^ascii\r\n#######\r\n#######\r\n###,###\r\n#######\r\n#`###•#\r\n######.\r\n`######\r\nasciiend］\r\n\r\nconfettitimer = totaltime % 10\r\n\r\n?confettitimer < 8\r\n  >o-3,-2,#rainFF,@headconfetti［confettitimer］@\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Hats/WitchHat.txt" - Parse error: Failed to parse completely. Remaining: "= #301934 //Dark\r\nvar bigtopcolor2 = #A865B5 //Light\r\nvar bigbotcolor1 = #4B0082 //Dark\r\nvar bigbotcolor2 = #A865B5 //Light\r\nvar smlcolor1 = #008800 //Dark\r\nvar smlcolor2 = #green  //Light\r\n\r\n//*******************************\r\n// Drawing Code \r\n//*******************************\r\n\r\nvar bighat1 = ascii\r\n##,'`·_\r\n##/_.──-.\r\n#,´ ,--. ;\r\n:  #####'\r\n#`·─\r\nasciiend\r\n\r\nvar bighat2 = ascii\r\n###_.──-.\r\n#,´ ,--. ;\r\n:  #####'\r\n#`·─\r\nasciiend\r\n\r\nvar smlhat1 = ascii\r\n#λ\r\n¯Ö¯\r\nasciiend\r\n\r\nvar smlhat2 = ascii\r\n#Ö\r\nasciiend\r\n\r\nvar tempcolor1\r\nvar tempcolor2\r\nvar t = 0\r\n\r\n?bighead\r\n  t = math.sin(time*0.05) / 2 + 0.5\r\n  tempcolor1 = color.Lerp(\r\n           ^bigtopcolor1,bigtopcolor2,t)\r\n  t = math.sin((time+20)*0.05) / 2 + 0.5\r\n  tempcolor2 = color.Lerp(\r\n           ^bigbotcolor1,bigbotcolor2,t)\r\n\r\n  >h-5,-3,@tempcolor1@,@bighat1@\r\n  >h-5,-2,@tempcolor2@,@bighat2@\r\n:\r\n  t = math.sin(time*0.05) / 2 + 0.5\r\n  tempcolor1 = color.Lerp(\r\n           ^smlcolor1,smlcolor2,t)\r\n  >h-1,0,@tempcolor1@,@smlhat1@\r\n  >h-1,1,@tempcolor1@,@smlhat2@\r\n//\r\n\r\n//*******************************\r\n// End of File\r\n//*******************************"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Hats/Skully.txt" - Parse error: Failed to parse completely. Remaining: "= 0 //set to 1 if you want the alt body// 0 = OFF // 1 = ON\r\nvar boneColor = #808080 //grey\r\n\r\nx = myX + 0\r\ny = myZ + 0\r\n\r\n//DRAW---------------------------------------------<\r\n\r\n>h-2,-1,@boneColor@,ascii\r\n#,--.\r\n(_o,o)\r\n# `\"´\r\n#\r\nasciiend\r\n\r\n?ribcage = 1\r\n  >h-2,-1,@boneColor@,ascii\r\n#\r\n#\r\n#\r\n##╪\r\nasciiend\r\n\r\n//BOSS ENTRY---------------------------------------<\r\n\r\n?face = \"°°\"\r\n  >h0,0,@boneColor@,ascii\r\nò,ó\r\nasciiend\r\n\r\n//BOSS KILL----------------------------------------<\r\n\r\n?face = \"^^\"\r\n  ?time % 4 <= 1\r\n    >h0,0,@boneColor@,ascii\r\nO,o\r\nasciiend\r\n  ?time % 4 > 1\r\n    >h0,0,@boneColor@,ascii\r\no,O\r\nasciiend\r\n\r\n//BLINKING-----------------------------------------<\r\n\r\n?stateTime % 50 >= 48\r\n  >h0,0,@boneColor@,ascii\r\n=,=\r\nasciiend\r\n:?stateTime % 50 >= 46\r\n  >h0,0,@boneColor@,ascii\r\n-,-\r\nasciiend\r\n:?stateTime % 50 >= 44\r\n  >h0,0,@boneColor@,ascii\r\n=,=\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Hats/SantaHat.txt" - Parse error: Failed to parse completely. Remaining: "= true     // hat quick enable/disable\r\nvar inputbighead              // checks for head size\r\n// this can be hardcoded with true/false\r\n// to force use only big/small head respectively \r\ninputbighead = bighead        // system var \"bighead\" determines it\r\nvar inputposx                 // used to detect movement\r\ninputposx = pos.x             // use custom var for performance\r\nvar inputanimframelength = 20 // length of hat animation\r\n\r\n// === === === === === === === === === === ===\r\nvar oldposx = inputposx\r\nvar hatframecounter = 0       // counts when hat should move\r\nvar hatframe1 = inputanimframelength/2 // frame switch condition\r\n//  ˏ.-.\r\n// *  ,^,\r\n//    `o´\r\n? inputhatenable\r\n  ? inputbighead = false // small head required\r\n    ? oldposx ! inputposx //update frame counter\r\n      hatframecounter++\r\n      ? hatframecounter = inputanimframelength\r\n        hatframecounter = 0 // reset frame counter\r\n    ? hatframecounter < hatframe1 // animate small hat\r\n      >h-4,-1,#008000,ascii\r\n#,--. \r\n###,^,\r\nasciiend\r\n    :// 008000 - dark green\r\n      >h-4,-1,#008000,ascii\r\n##,-. \r\n#'#,^,\r\nasciiend\r\n    >h-4,-1,#white,ascii\r\n#\r\n#\r\n###`#'\r\nasciiend\r\n    >h-4,-1,#red,ascii\r\n#\r\n°\r\nasciiend\r\n  : // in case of big head we use the original\r\n    >h-4,-2,#red,ascii\r\n###_##\r\n#,;###\r\n######\r\nasciiend\r\n\r\n    >h-4,-2,#white,ascii\r\n######\r\n###,´#\r\n°#´###\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Hats/MushroomHat.txt" - Parse error: Failed to parse completely. Remaining: "= #red\r\nvar botcolor = #white\r\n\r\n//*******************************\r\n// Drawing Code \r\n//*******************************\r\n\r\n>h-5,-4,@topcolor@,ascii\r\n##.-._\r\n#;°_.-().\r\n.O'_.——-.:\r\n;.' ,—-. :\r\n:: #####'\r\n#`•-\r\nasciiend\r\n\r\n>h-5,-4,@botcolor@,ascii\r\n#\r\n##°###()\r\n#O#_.——-.\r\n#.' ,—-. :\r\n#: #####'\r\n#`•-\r\nasciiend\r\n\r\n//*******************************\r\n// End of File\r\n//*******************************"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Hats/Headphones.txt" - Parse error: Failed to parse completely. Remaining: "= #66CC00     //headphones base color\r\n                        //color can be changed, but must be in the form #rrggbb or #rainbow (no #red, #cyan, #rainFF, etc.)\r\n                        //the new color will take effect upon exiting and re-entering a location\r\n                        //note \"fade out\" colors will be automatically calculated based on this color\r\n\r\n//66CC00  basic green\r\n//4169E1  royal blue\r\n//FC6400  pumpkin orange\r\n\r\n\r\n\r\n//extract integer color channels from hex value\r\nvar c_ints = colorToInt(color)\r\nvar c_ints_r = c_ints[0]\r\nvar c_ints_g = c_ints[1]\r\nvar c_ints_b = c_ints[2]\r\n\r\n//modify integer values to get note colors\r\nvar c_ints_age1 = [c_ints_r, c_ints_g, c_ints_b]\r\nvar c_ints_age2 = [math.Clamp(c_ints_r-68,0,512), math.Clamp(c_ints_g-68,0,512), math.Clamp(c_ints_b-68,0,512)]\r\nvar c_ints_age3 = [math.Clamp(c_ints_r-136,0,256), math.Clamp(c_ints_g-136,0,256), math.Clamp(c_ints_b-136,0,256)]\r\n\r\n//generate hex color values from modified color channels\r\nvar color_age1 = intToColor(c_ints_age1)\r\nvar color_age2 = intToColor(c_ints_age2)\r\nvar color_age3 = intToColor(c_ints_age3)\r\n\r\n\r\nvar max_notes = 5               //max notes alive at a time\r\nvar new_note_interval = 15      //number of ticks before a new note is created\r\nvar note_mov_interval = 9       //number of ticks between note random movements\r\n\r\nvar windy = false\r\nvar windy_note_interval = 5     //ticks before new note is created, when windy\r\nvar windy_mov_interval = 3      //ticks between note movements, when windy\r\nvar wind_mov_x = 0\r\n\r\nvar rng_x = 0\r\nvar rng_xmax = -3\r\nvar rng_xmin = -5\r\nvar rng_xmax_sm = -2\r\nvar rng_xmin_sm = -3\r\n\r\nvar rng_z = 0\r\nvar rng_zmax = 1\r\nvar rng_zmin = -3\r\nvar rng_zmax_sm = 1\r\nvar rng_zmin_sm = -1\r\n\r\nvar notes = []\r\nvar notes_xpos = []\r\nvar notes_zpos = []\r\n\r\nvar draw_x\r\nvar draw_z\r\nvar draw_note\r\nvar count\r\n\r\nvar dys_final\r\n\r\n\r\n//detect \"windy\" environments\r\n//occurs at Icy Ridge, during bridge crossing, and during Dysangelos fight\r\n?loc = rocky_plateau\r\n  ?windy\r\n    ?dys_final & (foe ! dysangelos)\r\n      windy = false\r\n      dys_final = false\r\n    :?foe.hp < 1 & foe = dysangelos_perfected\r\n      dys_final = true\r\n  :\r\n    ?foe = dysangelos & foe.state = 117\r\n        windy = true\r\n\r\n:?loc = icy_ridge\r\n  windy = true\r\n\r\n:?loc = cross_bridge\r\n  ?pos.x > 300\r\n    windy = false\r\n\r\n  :?loc.begin\r\n    windy = true\r\n\r\n\r\n//create a new note every *new_note_interval* ticks\r\n//increase rate to *windy_note_interval* ticks if the wind is blowing\r\n?(!windy & time % new_note_interval = 0) | (windy & time % windy_note_interval = 0)\r\n  //give notes a randomized position relative to player head\r\n  ?bighead\r\n    rng_x = rng_xmin + rng % (rng_xmax - rng_xmin + 1)\r\n    rng_z = rng_zmin + rng % (rng_zmax - rng_zmin + 1)\r\n  :\r\n    rng_x = rng_xmin_sm + rng % (rng_xmax_sm - rng_xmin_sm + 1)\r\n    rng_z = rng_zmin_sm + rng % (rng_zmax_sm - rng_zmin_sm + 1)\r\n\r\n  //give notes a random symbol (♫ is less likely than ♪ because it's visually heavier)\r\n  ?(rng % 3) = 0\r\n    notes.Add(\"♫\")\r\n  :\r\n    notes.Add(\"♪\")\r\n\r\n  //store note x,y pos\r\n  notes_xpos.Add((pos.x + rng_x))\r\n  notes_zpos.Add((pos.z - pos.y + rng_z))\r\n\r\n  //pop oldest note if too many are onscreen\r\n  ?notes.Count() > max_notes\r\n    notes.RemoveAt(0)\r\n    notes_xpos.RemoveAt(0)\r\n    notes_zpos.RemoveAt(0)\r\n\r\n\r\n//allow notes to drift every *note_mov_interval* ticks\r\n//increase rate to *windy_mov_interval* ticks if the wind is blowing\r\n?(!windy & time % note_mov_interval = 0) | (windy & time % windy_mov_interval = 0)\r\n  count = notes.Count()\r\n  ?count > 0\r\n    ?count > max_notes\r\n      count = max_notes\r\n\r\n    for i = 0 .. count-1\r\n      //notes drift farther while windy\r\n      ?windy\r\n        wind_mov_x = 2 + (rng%3)\r\n      :\r\n        wind_mov_x = 0\r\n\r\n      notes_xpos.Emplace(i, notes_xpos[i] - (rng%2) - wind_mov_x)\r\n      notes_zpos.Emplace(i, notes_zpos[i] - (rng%2))\r\n\r\n\r\n//draw notes, if there are notes to be drawn\r\ncount = notes.Count()\r\n?count > 0\r\n  ?count > max_notes\r\n    count = max_notes\r\n\r\n  for i = 0 .. count-1\r\n    //correct for player's changing position\r\n    draw_x = notes_xpos[i] - pos.x\r\n    draw_z = notes_zpos[i] - pos.z + pos.y\r\n    draw_note = notes[i]\r\n    \r\n    //note color fades away as its age increases\r\n    ?i = 0\r\n      >o@draw_x@,@draw_z@,@color_age3@,@draw_note@\r\n    :?i < 3\r\n      >o@draw_x@,@draw_z@,@color_age2@,@draw_note@\r\n    :? i < max_notes\r\n      >o@draw_x@,@draw_z@,@color_age1@,@draw_note@\r\n\r\n\r\n//draw headphones\r\n?bighead\r\n  >h-3,-2,@color@,ascii\r\n##___\r\n#/###\\\r\n(│###│)\r\nasciiend\r\n:\r\n  >h-2,0,@color@,ascii\r\n#,-.\r\n(]#[)\r\nasciiend\r\n\r\n\r\n//color conversion helper functions\r\n\r\n//converts 6-digit color code to integers\r\n//returns a 3-element array containing r,g,b as integers\r\nfunc colorToInt(color)\r\n  ?string.Size(color) < 7\r\n    return [0,0,0]\r\n\r\n  ?color = \"#rainbow\"\r\n    return [1024,1024,1024]\r\n\r\n  var r = hexInt(string.Sub(color, 1, 2))\r\n  var g = hexInt(string.Sub(color, 3, 2))\r\n  var b = hexInt(string.Sub(color, 5, 2))\r\n\r\n  return [r,g,b]\r\n\r\n\r\n//converts 3-element integer array to 6-digit color code\r\n//returns a hex color code in the form #rrggbb\r\nfunc intToColor(ints)\r\n  var t = ints[0]\r\n  ?t > 512\r\n    return \"#rainFF\"\r\n  :?t > 256\r\n    return \"#rain88\"\r\n  :?t > 255\r\n    return \"#rain44\"\r\n\r\n  var r = minLength(intHex(ints[0]), 2, 0)\r\n  var g = minLength(intHex(ints[1]), 2, 0)\r\n  var b = minLength(intHex(ints[2]), 2, 0)\r\n\r\n  return \"#\"+r+g+b\r\n\r\n\r\n//converts 2-digit hex to integer\r\nfunc hexInt(hex)\r\n  var int = 0\r\n  var size = string.Size(hex)\r\n  var digit = string.Sub(hex, 0, 1)\r\n\r\n  var msb = 1\r\n  var lsb = 0\r\n\r\n  ?string.Size(hex) > 1\r\n    int = hexInt(string.Sub(hex, 1, size-1)) + int\r\n\r\n  :?string.Size(hex) = 1\r\n    msb = 0\r\n    lsb = 1\r\n\r\n  ?digit = \"0\"\r\n    int = int + 0 * (16*msb)\r\n  :?digit = \"1\"\r\n    int = int + 1 * (16*msb + lsb)\r\n  :?digit = \"2\"\r\n    int = int + 2 * (16*msb + lsb)\r\n  :?digit = \"3\"\r\n    int = int + 3 * (16*msb + lsb)\r\n  :?digit = \"4\"\r\n    int = int + 4 * (16*msb + lsb)\r\n  :?digit = \"5\"\r\n    int = int + 5 * (16*msb + lsb)\r\n  :?digit = \"6\"\r\n    int = int + 6 * (16*msb + lsb)\r\n  :?digit = \"7\"\r\n    int = int + 7 * (16*msb + lsb)\r\n  :?digit = \"8\"\r\n    int = int + 8 * (16*msb + lsb)\r\n  :?digit = \"9\"\r\n    int = int + 9 * (16*msb + lsb)\r\n  :?digit = \"A\"\r\n    int = int + 10 * (16*msb + lsb)\r\n  :?digit = \"B\"\r\n    int = int + 11 * (16*msb + lsb)\r\n  :?digit = \"C\"\r\n    int = int + 12 * (16*msb + lsb)\r\n  :?digit = \"D\"\r\n    int = int + 13 * (16*msb + lsb)\r\n  :?digit = \"E\"\r\n    int = int + 14 * (16*msb + lsb)\r\n  :?digit = \"F\"\r\n    int = int + 15 * (16*msb + lsb)\r\n  :\r\n    int = int + 0\r\n  return int\r\n\r\n\r\n//function by DarkLucifer69\r\n//backfills a string to a particular length with a specified value\r\nfunc minLength(string, length, append)\r\n ?string.Size(string) < length\r\n  string = append + minLength(string, length-1, append)\r\n\r\n return string\r\n\r\n\r\n//function by DarkLucifer69\r\n//converts integer to hex value\r\nfunc intHex(int)\r\n var hex = \"\"\r\n \r\n ?int >= 16\r\n  hex = intHex(int/16) + hex \r\n  \r\n ?int % 16 <= 9\r\n  hex = hex + (int % 16)\r\n :?int % 16 = 10\r\n  hex = hex + \"A\"\r\n :?int % 16 = 11\r\n  hex = hex + \"B\"\r\n :?int % 16 = 12\r\n  hex = hex + \"C\"\r\n :?int % 16 = 13\r\n  hex = hex + \"D\"\r\n :?int % 16 = 14\r\n  hex = hex + \"E\"\r\n :?int % 16 = 15\r\n  hex = hex + \"F\"\r\n \r\n return hex\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Hats/StarCloak.txt" - Parse error: Failed to parse completely. Remaining: "= \"#bf9f7f\"\r\n\r\nfunc CheckStars()\r\n  ?loc.stars>30\r\n    return \"rain\"\r\n  :?loc.stars>25\r\n    return \"red\"\r\n  :?loc.stars>20\r\n    return \"blue\"\r\n  :?loc.stars>15\r\n    return \"green\"\r\n  :?loc.stars>10\r\n    return \"yellow\"\r\n  :?loc.stars>5\r\n    return \"cyan\"\r\n  :?loc.stars>1\r\n    return \"white\"\r\n  :\r\n    return \"magenta\"\r\n\r\n\r\nfunc Draw()\r\n  ?bighead\r\n    >h-3,-2,@CloakColour@,ascii\r\n##__##\r\n##, `#\r\n#( ##)\r\n##^.^##\r\n#//####\r\n´´###``\r\nasciiend\r\n  :\r\n    >h-3,-2,@CloakColour@,ascii\r\n##__##\r\n##, `#\r\n#( '')\r\n##^.^##\r\n#//####\r\n´´###``\r\nasciiend\r\n  >h-2,-1,#@bgc@,☆\r\n\r\nDraw()"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Hats/DiscoVisor.txt" - Parse error: Failed to parse completely. Remaining: "?foe = dysangelos\r\n  fpbForLevel = 8\r\n?loc = deadwood\r\n fpbForLevel = 13\r\n ?foe = xyloalgia & foe.distance < 10\r\n  fpbForLevel = 5\r\n?loc = caves\r\n fpbForLevel = 32\r\n  ?foe = bolesh\r\n   fpbForLevel = 10\r\n?loc = waterfall\r\n fpbForLevel = 30\r\n?loc = forest\r\n fpbForLevel = 27\r\n ?loc = shroom\r\n  fpbForLevel = 9\r\n?loc = haunted\r\n fpbForLevel = 13\r\n ?foe = pallas\r\n  fpbForLevel = 10\r\n?loc = mine\r\n fpbForLevel = 11\r\n ?foe = guardian & foe.distance < 22\r\n  fpbForLevel = 4\r\n?loc = icy ridge\r\n fpbForLevel = 15\r\n ?foe = yeti\r\n  fpbForLevel = 8\r\n?loc = bridge\r\n fpbForLevel = 60\r\n?loc = temple\r\n fpbForLevel = 20\r\n ?foe = nagaraja\r\n  fpbForLevel = 6\r\n   \r\n// are we on a beat?  \r\n?time % fpbForLevel ! 0\r\n isBeat = 0\r\n:\r\n isBeat = 1\r\n\r\n// helmet aside from the visor\r\n>h-3,-1,#8a8a8a,ascii\r\n┊####┊\r\nΘ####Θ\r\nasciiend\r\n\r\n// flash the visor if we're on a beat\r\n?isBeat = 1\r\n >h-2,0,#rainbow,ascii\r\n███▓▒\r\nasciiend\r\n\r\n// or don't if we're not\r\n?isBeat = 0\r\n >h-2,0,#3a3a3a,ascii\r\n███▓▒\r\nasciiend\r\n\r\n// debug display (uncomment to enable)\r\n//?isBeat = 1\r\n// >`0,0,#00ff00,♪\r\n//?isBeat = 0\r\n//  >`0,0,#ff0000,♫"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Hats/PirateHat.txt" - Parse error: Failed to parse completely. Remaining: "= #999999\r\ntricornColor = #b29670\r\njollyRogerColor = #white\r\neyePatchColor = #777777\r\n//---------------------------------------------\r\n\r\n?bighead\r\n  >h-5,-2,@tricornColor@,ascii\r\n###,.=.._\r\n##/.-x-.\\\\\r\nasciiend\r\n  >h-6,0,@eyePatchColor@,ascii\r\n#####.Ü#####\r\nasciiend\r\n:\r\n  >h-4,-1,@bicornColor@,ascii\r\n###___\r\n#,/___'.\r\nasciiend\r\n  >h-4,1,#white,ascii\r\n####U\r\nasciiend\r\n  >h-1,0,@jollyRogerColor@,ascii\r\n:o:\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Hats/LanternTalisman.txt" - Parse error: Failed to parse completely. Remaining: "?item.left = ＂golden＂\r\n    >o-3,1,#FFCC66,@lanterntalisman@\r\n  :?item.left = ＂+0＂\r\n    >o-3,1,#white,@lanterntalisman@\r\n  :?item.left = ＂+1＂\r\n    >o-3,1,#cyan,@lanterntalisman@\r\n  :?item.left = ＂+2＂ | item.left = ＂+3＂\r\n    >o-3,1,#yellow,@lanterntalisman@\r\n  :?item.left = ＂+4＂ | item.left = ＂+5＂ |\r\n  ^item.left = ＂+6＂\r\n    >o-3,1,#green,@lanterntalisman@\r\n  :?item.left = ＂+7＂ | item.left = ＂+8＂ |\r\n  ^item.left = ＂+9＂ | item.left = ＂+10＂\r\n    >o-3,1,#blue,@lanterntalisman@\r\n  :?item.left = ＂+11＂ | item.left = ＂+12＂ |\r\n  ^item.left = ＂+13＂ | item.left = ＂+14＂ |\r\n  ^item.left = ＂+15＂\r\n    >o-3,1,#red,@lanterntalisman@\r\n  :\r\n    >o-3,1,#rainFF,@lanterntalisman@\r\n  ?item.left.state ! 1\r\n    >o-2,2,#FFCC99,φ\r\n:?item.right = fire_talisman\r\n  ?item.right = ＂golden＂\r\n    >o1,1,#FFCC66,@lanterntalisman@\r\n  :?item.right = ＂+0＂\r\n    >o1,1,#white,@lanterntalisman@\r\n  :?item.right = ＂+1＂\r\n    >o1,1,#cyan,@lanterntalisman@\r\n  :?item.right = ＂+2＂ | item.right = ＂+3＂\r\n    >o1,1,#yellow,@lanterntalisman@\r\n  :?item.right = ＂+4＂ | item.right = ＂+5＂ |\r\n  ^item.right = ＂+6＂\r\n    >o1,1,#green,@lanterntalisman@\r\n  :?item.right = ＂+7＂ | item.right = ＂+8＂ |\r\n  ^item.right = ＂+9＂ | item.right = ＂+10＂\r\n    >o1,1,#blue,@lanterntalisman@\r\n  :?item.right = ＂+11＂ | item.right = ＂+12＂ |\r\n  ^item.right = ＂+13＂ | item.right = ＂+14＂ |\r\n  ^item.right = ＂+15＂\r\n    >o1,1,#red,@lanterntalisman@\r\n  :\r\n    >o1,1,#rainFF,@lanterntalisman@\r\n  ?item.right.state ! 1\r\n    >o2,2,#FFCC99,φ"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Hats/CatHat.txt" - Parse error: Failed to parse completely. Remaining: "= #FFBFFF\r\nvar catTW = 0\r\n\r\n?loc = icy_ridge\r\n^|loc = cross_bridge & screen.i < 5\r\n^|foe = dysangelos & foe.state = 117\r\n  catTW = 1\r\n\r\n:?foe = dysangelos & foe = phase3 & foe.hp <= 0\r\n^|loc = cross_bridge & screen.i > 4\r\n  catTW = 0\r\n\r\n?catTW = 1\r\n  ?time % 9 < 3 * 1\r\n    >h-8,-2,@catColor@,ascii\r\n,_.-·.\r\n`.   \r\n###'´\r\nasciiend\r\n  :?time % 9 < 3 * 2\r\n    >h-8,-1,@catColor@,ascii\r\n_,•´¯\r\n`. _.'\r\nasciiend\r\n  :?time % 9 < 3 * 3\r\n    >h-8,-2,@catColor@,ascii\r\n#,'¯¯`\r\n;•´-,\r\nasciiend\r\n:?time % 81 < 3 * 21\r\n  >h-6,-4,@catColor@,ascii\r\n#,\r\n#)`,\r\n(  ;\r\n`-·\r\nasciiend\r\n:?time % 81 < 3 * 22\r\n  >h-7,-4,@catColor@,ascii\r\n#,\r\n(`.,\r\n'   ;\r\n#`-·\r\nasciiend\r\n:?time % 81 < 3 * 23\r\n  >h-8,-2,@catColor@,ascii\r\n,_.-·.\r\n`.   \r\n###'´\r\nasciiend\r\n:?time % 81 < 3 * 24\r\n  >h-8,-1,@catColor@,ascii\r\n_,•´¯\r\n`. _.'\r\nasciiend\r\n:?time % 81 < 3 * 25\r\n  >h-8,-2,@catColor@,ascii\r\n#,'¯¯`\r\n;•´-,\r\nasciiend\r\n:?time % 81 < 3 * 26\r\n  >h-8,-3,@catColor@,ascii\r\n,-~-,\r\n¯\\   `\r\n##`-·\r\nasciiend\r\n:?time % 81 < 3 * 27\r\n  >h-6,-4,@catColor@,ascii\r\n,\r\nì`.\r\n;  :\r\n`-·\r\nasciiend\r\n>h-3,-2,@catColor@,ascii\r\n#/` ,|\r\n(_`,|;\r\nasciiend\r\n?catTW = 1\r\n  ?time % 6 < 3 * 1\r\n    >h-2,-5,@catColor@,ascii\r\n####,\r\n-.-´'\\\r\n\\ ###)\r\nasciiend\r\n  :?time % 6 < 3 * 2\r\n    >h-3,-5,@catColor@,ascii\r\n####,\r\n__.-'`•\r\n`. ###)\r\nasciiend\r\n:?time % 114 < 3 * 36\r\n  >h-2,-5,@catColor@,ascii\r\n####,\r\n-.-´'\\\r\n\\ ###)\r\nasciiend\r\n:?time % 114 < 3 * 37\r\n  >h-3,-5,@catColor@,ascii\r\n######,\r\n__.-'´|\r\n`. ###)\r\nasciiend\r\n:?time % 114 < 3 * 38\r\n  >h-2,-5,@catColor@,ascii\r\n####,\r\n-.-´'\\\r\n\\ ###)\r\nasciiend\r\n?face = ＂°°＂\r\n  >h0,-3,@catColor@,ascii\r\n•w'\r\nasciiend\r\n  ?time % 6 < 3 * 1\r\n    >h-1,-5,ascii\r\n#####/.\r\n#####´-\r\n'\r\nasciiend\r\n  :?time % 6 < 3 * 2\r\n    >h-1,-5,ascii\r\n#####,´\r\n######——\r\n＂\r\nasciiend\r\n:?face = ＂^^＂\r\n  ?time % 8 < 4 * 1\r\n    >h0,-3,@catColor@,ascii\r\n^ω´\r\nasciiend\r\n  :?time % 8 < 4 * 2\r\n    >h0,-3,@catColor@,ascii\r\n^W´\r\nasciiend\r\n  ?time % 8 < 4 * 1\r\n    >h5,-5,ascii\r\n/.\r\n´-\r\nasciiend\r\n  :?time % 8 < 4 * 2\r\n    >h4,-5,ascii\r\n,´\r\n ——\r\nasciiend\r\n:?time % 114 < 3 * 36\r\n  >h0,-3,@catColor@,ascii\r\noω°\r\nasciiend\r\n:?time % 114 < 3 * 38\r\n  >h0,-3,@catColor@,ascii\r\n-ω´\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Hats/Helmet.txt" - Parse error: Failed to parse completely. Remaining: "= #EE8113 //Color of the Helmet\nvar ShowHelmet = True //Shows/Hides the Helmet\nvar ShowBanner = True //Show/Hide Custom Banner\n\n// ₪ Main Code ₪\n/*\n?loc_ = ＂Caves of Fear＂\n  ?locbegin & ShowBanner = True\n    ui.ShowBanner(·•♦◀▶♦•·,Caving the Fear)\n  ?!bighead & ShowHelmet = True\n    >h-1,0,@HelmetColor@,ascii\n#_\n'#°\nasciiend\n  :?bighead & ShowHelmet = True\n    >h-2,-2,@HelmetColor@,ascii\n .¬. \n╧══◙╧\nasciiend\n*/\n\n?bighead\n    >h-2,-2,@HelmetColor@,ascii\n .¬. \n╧══◙╧\nasciiend\n:\n  >h-1,0,@HelmetColor@,ascii\n#_\n'#°\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/MushroomAnt.txt" - Parse error: Failed to parse completely. Remaining: "?loc = forest & (pos.x > 175 & pos.x < 227) & totaltime < 800\r\n//  >`1,7,ant = @antFrame@\r\n  play ant_walk\r\n\r\n  ?antFrame >= 0 & antFrame < 3\r\n    ?loc.stars > 10 \r\n      >`@antX@,16,@#888888@,ascii\r\n####_##\r\n#_#(_)#\r\n(_)(###\r\n-,\\),-.\r\n>@/#/|-`\r\nasciiend\r\n    ?loc.stars <= 10\r\n      >`@antX@,16,@#888888@,ascii\r\n##__### \r\n#(__)##\r\n###)###\r\n-,( ,-.\r\n>@/#/|-`\r\nasciiend\r\n    antFrame++\r\n    antX = 69\r\n\r\n  ?antFrame >= 3 & antFrame < 6\r\n    ?loc.stars > 10 \r\n      >`@antX@,16,@#888888@,ascii\r\n####_##\r\n#_#(_)#\r\n(_)(###\r\n-,\\),-.\r\n-@(#|-)`\r\nasciiend\r\n    ?loc.stars <= 10\r\n      >`@antX@,16,@#888888@,ascii\r\n##__### \r\n#(__)##\r\n###)###\r\n-,( ,-.\r\n-@(#|-)`\r\nasciiend\r\n    antFrame++\r\n    antX = 70\r\n\r\n  ?antFrame >= 6 & antFrame < 9\r\n    ?loc.stars > 10 \r\n      >`@antX@,16,@#888888@,ascii\r\n####_##\r\n#_#(_)#\r\n(_)(###\r\n-,\\),-.\r\n>@'|\\-\\`\r\nasciiend\r\n    ?loc.stars <= 10\r\n      >`@antX@,16,@#888888@,ascii\r\n##__### \r\n#(__)##\r\n###)###\r\n-,( ,-.\r\n>@'|\\-\\`\r\nasciiend\r\n    antFrame++\r\n    antX = 71\r\n\r\n?antFrame >= 9\r\n  antFrame = 0\r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Fireworks.txt" - Parse error: Failed to parse completely. Remaining: "= ［\r\n#FF0000,#00FF00,#0000FF,\r\n#FFFF00,#FF00FF,#00FFFF,\r\n#FF7700,#7700FF,#0077FF］\r\n\r\nvar xmin = 0\r\nvar xmax = screen.w - 11\r\nvar ymin = 1\r\nvar ymax = 3\r\n\r\n//*******************************\r\n// Art\r\n//*******************************\r\n\r\n//**** RINGS ****\r\nvar rings = ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n#####*\r\n#\r\n#\r\n%%\r\n#\r\n#####.\r\n####•*• \r\n#####'\r\n#\r\n%%\r\n#\r\n####·:· \r\n###:•*•:\r\n####·:· \r\n#\r\n%%\r\n#####•\r\n###.·:·. \r\n##•:•*•:• \r\n###'·:·'\r\n#####• \r\n%%\r\n###.#•#.\r\n##'.·:·.'\r\n##•:•*•:• \r\n##.'·:·'.\r\n###'#•#'\r\n%%\r\n###.·•·.\r\n##'.·:·.'\r\n#:•:•*•:•:\r\n##.'·:·'.\r\n###'·•·'\r\nasciiend\r\n\r\nvar rfade = ascii\r\n###.·•·.\r\n##'.·:·.'\r\n#:•:•*•:•:\r\n##.'·:·'.\r\n###'·•·'\r\n%%\r\n###.·•·.\r\n##'.·:·.'\r\n#:•:•*•:•:\r\n##.'·:·'.\r\n###'·•·'\r\n%%\r\n###.·•·.\r\n##'.·:·.'\r\n#:•:•*•:•:\r\n##.'·:·'.\r\n###'·•·'\r\n%% //Start fade\r\n###.·•·.\r\n##'.·:·.'\r\n#:•:•#•:•:\r\n##.'·:·'.\r\n###'·•·'\r\n%%\r\n###.·•·.\r\n##'.·'·.'\r\n#:•:###:•:\r\n##.'·.·'.\r\n###'·•·'\r\n%%\r\n###.·•·.\r\n##'.###.'\r\n#:•#####•:\r\n##.'###'.\r\n###'·•·'\r\n%%\r\n###.·•·.\r\n##'#####'\r\n#:•#####•:\r\n##.#####.\r\n###'·•·'\r\n%%\r\n###.·•·.\r\n##'#####'\r\n#:#######:\r\n##.#####.\r\n###'·•·'\r\n%%\r\n####·#· \r\n#\r\n#:#######:\r\n#\r\n####·#· \r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\n//**** WILLOW ****\r\nvar willow = ascii\r\n#\r\n#####*\r\n#\r\n#\r\n#\r\n%%\r\n####.'.\r\n####·*·\r\n####'.'\r\n#\r\n#\r\n%%\r\n###'.'.'\r\n###··*··\r\n###.'.'.\r\n#\r\n#\r\n%%\r\n##''.'.''\r\n##.··*··.\r\n###.'.'. \r\n##·##.##·\r\n#\r\n%%\r\n#.''.'.''.\r\n##.··*··.\r\n#'#.'.'.#'\r\n##·##.##·\r\n##'##.##'\r\n%%\r\n#.''.'.''.\r\n·#.··*··.#·\r\n#'#.'.'.#'\r\n'#·##.##·#'\r\n##'##.##'\r\n%%\r\n#.''.'.''.\r\n·#.··*··.#·\r\n''#.'.'.#''\r\n'#·##.##·#'\r\n##'##.##'\r\nasciiend\r\n\r\nvar wfade = ascii\r\n#.''.'.''.\r\n·#.··*··.#·\r\n''#.'.'.#''\r\n'#·##.##·#'\r\n##'##.##'\r\n%%\r\n#.''.'.''.\r\n·#.··*··.#·\r\n''#.'.'.#''\r\n'#·##.##·#'\r\n##'##.##'\r\n%%\r\n#.''.'.''.\r\n·#.·· ··.#·\r\n''#.'.'.#''\r\n'#·##.##·#'\r\n##'##.##'\r\n%% //Start Fade\r\n#.''###''.\r\n·#.·###·.#·\r\n''#.###.#''\r\n'#·##.##·#'\r\n##'##.##'\r\n%%\r\n#.'#####'.\r\n·#.#####.#·\r\n''#.###.#''\r\n'#·##.##·#'\r\n##'##.##'\r\n%%\r\n#.#######.\r\n·#########·\r\n''#######''\r\n'#·##.##·#'\r\n##'##.##'\r\n%%\r\n#\r\n·#########·\r\n'#########'\r\n'#·##.##·#'\r\n##'##.##'\r\n%%\r\n#\r\n#\r\n'#########'\r\n'#########'\r\n##'##.##'\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n##'##.##'\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#####.\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar wcrackle = ascii\r\n#.''.'.''.\r\n·#.··*··.#·\r\n''#.'.'.#''\r\n'#·##.##·#'\r\n##'##.##'\r\n%%\r\n#.''.'.''.\r\n·#.··*··.#·\r\n''#.'.'.#''\r\n'#·##.##·#'\r\n##'##.##'\r\n%% //2\r\n#.#'.'#''.\r\n##.··##·.#·\r\n#'#.'#'.#'\r\n'#·##.####'\r\n##'##.\r\n%% //4\r\n#.''#'.'#.\r\n·#.#·#··##·\r\n''##'.'##''\r\n'####.##·#'\r\n#####.##'\r\n%% //3\r\n#.'#.'.#'.\r\n·##··#·#.#·\r\n'##.'.#.#''\r\n##·##.##·\r\n##'##.##'\r\n%% //1\r\n##''.#.''\r\n·#.·##··.\r\n''#.#.'.##'\r\n'#·#####·#'\r\n##'#####'\r\n%% //4\r\n#.''#'.'#.\r\n·#.#·#··##·\r\n''##'.'##''\r\n'####.##·#'\r\n#####.##'\r\n%% //2\r\n#.#'.'#''.\r\n##.··##·.#·\r\n#'#.'#'.#'\r\n'#·##.####'\r\n##'##.\r\n%% //1\r\n##''.#.''\r\n·#.·##··.\r\n''#.#.'.##'\r\n'#·#####·#'\r\n##'#####'\r\n%% //3\r\n#.'#.'.#'.\r\n·##··#·#.#·\r\n'##.'.#.#''\r\n##·##.##·\r\n##'##.##'\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\n//**** DHALIA ****\r\nvar dahlia = ascii\r\n#\r\n#\r\n#\r\n#####*\r\n#\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n#####¡\r\n####-*-\r\n#####!\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n####\\¡/\r\n###-—*—-\r\n####/!\\\r\n#\r\n#\r\n%%\r\n#\r\n#####.\r\n###.\\¡/.\r\n##•-—*—-•\r\n###'/!\\' \r\n#####'\r\n#\r\n%%\r\n#\r\n###.#:#.\r\n###.\\¡/. \r\n##•-—*—-•\r\n###'/!\\' \r\n###'#:#'\r\n#\r\n%%\r\n#\r\n###.·:·.\r\n##·.\\¡/.·\r\n#·•-—*—-•·\r\n##·'/!\\'·\r\n###'·:·'\r\n#\r\n%%\r\n#.###'###.\r\n##'.·:·.'\r\n#'·.\\¡/.·'\r\n··•-—*—-•··\r\n#.·'/!\\'·.\r\n##.'·:·'.\r\n#'###.###'\r\nasciiend\r\n\r\nvar dfade = ascii\r\n#.###'###.\r\n##'.·:·.'\r\n#'·.\\¡/.·'\r\n··•-—*—-•··\r\n#.·'/!\\'·.\r\n##.'·:·'.\r\n#'###.###'\r\n%%\r\n#.###'###.\r\n##'.·:·.'\r\n#'·.\\¡/.·'\r\n··•-—*—-•··\r\n#.·'/!\\'·.\r\n##.'·:·'.\r\n#'###.###'\r\n%%\r\n#.###'###.\r\n##'.·:·.'\r\n#'·.\\¡/.·'\r\n··•-—*—-•··\r\n#.·'/!\\'·.\r\n##.'·:·'.\r\n#'###.###'\r\n%% //Start Fade\r\n#####.\r\n##'.·:·.'\r\n#'·.\\¡/.·'\r\n··•-—#—-•··\r\n#.·'/!\\'·.\r\n##.'·:·'.\r\n#####'\r\n%%\r\n#####.\r\n##'.·:·.'\r\n#'·.\\'/.·'\r\n··•-###-•··\r\n#.·'/.\\'·.\r\n##.'·:·'.\r\n#####'\r\n%%\r\n#####.\r\n##'.·:·.'\r\n#'·.###.·'\r\n··•#####•··\r\n#.·'###'·.\r\n##.'·:·'.\r\n#####'\r\n%%\r\n#####.\r\n##'.·'·.'\r\n#'·#####·'\r\n··#######··\r\n#.·#####·.\r\n##.'·.·'.\r\n#####'\r\n%%\r\n#####.\r\n##'#·#·#'\r\n#'·#####·'\r\n·#########·\r\n#.·#####·.\r\n##.#·#·#.\r\n#####'\r\n%%\r\n#####.\r\n##'#####'\r\n#'#######'\r\n·#########·\r\n#.#######.\r\n##.#####.\r\n#####'\r\n%%\r\n#####.\r\n#\r\n#\r\n·#########·\r\n#\r\n#\r\n#####'\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\n//*******************************\r\n// Global Variables\r\n//*******************************\r\n\r\nvar farr = ［］\r\n\r\nvar win = 0\r\nvar bossbattle = 0\r\n\r\nvar fx = 0\r\nvar fy = 1\r\nvar fc = fcol［0］\r\n\r\nvar rings_params = ［\r\nrings,\r\ntop_left,\r\ntop_left,\r\nfx,fy,11,5,\r\ntrue,fc,\r\n10,0,true,true,\r\ntrue,1］\r\n\r\nvar rfade_params = ［\r\nrfade,\r\ntop_left,\r\ntop_left,\r\nfx,fy,11,5,\r\nfalse,fc,\r\n15,0,true,false,\r\nfalse,0］\r\n\r\nvar willow_params = ［\r\nwillow,\r\ntop_left,\r\ntop_left,\r\nfx,fy,11,5,\r\ntrue,fc,\r\n10,0,true,true,\r\ntrue,1］\r\n\r\nvar wfade_params = ［\r\nwfade,\r\ntop_left,\r\ntop_left,\r\nfx,fy,11,5,\r\nfalse,fc,\r\n30,0,true,false,\r\nfalse,0］\r\n\r\nvar wcrckl_params = ［\r\nwcrackle,\r\ntop_left,\r\ntop_left,\r\nfx,fy,11,5,\r\nfalse,fc,\r\n40,0,true,false,\r\nfalse,0］\r\n\r\nvar dahlia_params = ［\r\ndahlia,\r\ntop_left,\r\ntop_left,\r\nfx,fy,11,7,\r\ntrue,fc,\r\n10,0,true,true,\r\ntrue,1］\r\n\r\nvar dfade_params = ［\r\ndfade,\r\ntop_left,\r\ntop_left,\r\nfx,fy,11,7,\r\nfalse,fc,\r\n40,0,true,false,\r\nfalse,0］\r\n\r\n\r\n//*******************************\r\n// Functions\r\n//*******************************\r\n\r\nfunc DrawAnim(parent,params,id)\r\n  ?id = 0\r\n    var a = ui.AddAnim(params［0］)\r\n    a.anchor = params［1］\r\n    a.dock = params［2］\r\n    a.x = params［3］\r\n    a.y = params［4］\r\n    a.w = params［5］\r\n    a.h = params［6］\r\n    a.visible = params［7］\r\n    a.color = params［8］\r\n    a.duration = params［9］\r\n    a.frame = params［10］\r\n    a.gamePause = params［11］\r\n    a.loop = params［12］\r\n    a.playOnStart = params［13］\r\n    ?params［14］ = 0\r\n      a.Stop()\r\n    :\r\n      a.Play()\r\n    parent.Add(a)\r\n    return a\r\n  return id\r\n//\r\n\r\nfunc UpdateFireworks()\r\n  ?farr.Count() > 0\r\n    for i=0..farr.Count()-1\r\n      UpdateFirework(farr［i］)\r\n//\r\n\r\nfunc CleanupFireworks()\r\n  ?farr.Count() > 0\r\n    for i=0..farr.Count()-1\r\n      ?farr［i］［0］ = 2\r\n        farr［i］［4］.Recycle()\r\n        farr［i］［5］.Recycle()\r\n        farr.RemoveAt(i)\r\n        return\r\n//\r\n\r\nfunc CreateFirework()\r\n  var style = 1\r\n  var btype = 1\r\n  var ftype = 1\r\n  var fstep = 1\r\n  var fcolor = #white\r\n  var banim = 0\r\n  var fanim = 0\r\n  \r\n  //randomly select style\r\n  style = (1 + rng % 3)\r\n\r\n  ?style = 1 //willow\r\n    btype = 1\r\n    ftype = (1 + rng % 2)\r\n\r\n  :?style = 2 //ring\r\n    btype = 2\r\n    ftype = 3\r\n\r\n  :?style = 3 //dahlia\r\n    btype = 3\r\n    ftype = 4\r\n\r\n  ?btype = 1\r\n    banim = DrawAnim(\r\n    ^ui.root,willow_params,banim)\r\n  :?btype = 2\r\n    banim = DrawAnim(\r\n    ^ui.root,rings_params,banim)\r\n  :?btype = 3\r\n    banim = DrawAnim(\r\n    ^ui.root,dahlia_params,banim)\r\n\r\n  ?ftype = 1\r\n    fanim = DrawAnim(\r\n    ^ui.root,wfade_params,fanim)\r\n  :?ftype = 2\r\n    fanim = DrawAnim(\r\n    ^ui.root,wcrckl_params,fanim)\r\n  :?ftype = 3\r\n    fanim = DrawAnim(\r\n    ^ui.root,rfade_params,fanim)\r\n    fstep = 0\r\n  :?ftype = 4\r\n    fanim = DrawAnim(\r\n    ^ui.root,dfade_params,fanim)\r\n\r\n  fcolor = rng % fcol.Count()\r\n  fcolor = fcol［fcolor］\r\n\r\n  banim.color = fcolor\r\n  fanim.color = fcolor\r\n\r\n  fx = xmin + rng % xmax\r\n  fy = ymin + rng % ymax\r\n \r\n  banim.x = fx\r\n  fanim.x = fx\r\n  banim.y = fy\r\n  fanim.y = fy\r\n\r\n  var arr = ［-1,fstep,\r\n      ^btype,ftype,\r\n      ^banim,fanim］\r\n\r\n  return arr\r\n//\r\n\r\nfunc UpdateFirework(params)\r\n  var stepflag = params［0］\r\n  var fallstep = params［1］\r\n  var btype = params［2］\r\n  var ftype = params［3］\r\n  var bframe = params［4］.frame\r\n  var fframe = params［5］.frame\r\n  var posy = params［5］.y\r\n\r\n  ?stepflag < 0\r\n    ?bframe >= 6\r\n      params［5］.visible=true\r\n      params［5］.Play()\r\n      params［4］.visible=false\r\n      params［4］.Stop()\r\n      stepflag = 0\r\n  :\r\n    ?fframe >= 10\r\n      params［5］.visible = false\r\n      params［5］.Stop()\r\n      stepflag = 2\r\n    :?fframe = 9\r\n      ?stepflag = 0\r\n        posy = posy + fallstep\r\n        stepflag = 1\r\n    :?fframe = 8\r\n      stepflag = 0\r\n    :?fframe = 7\r\n      ?stepflag = 0\r\n        posy = posy + fallstep\r\n        stepflag = 1\r\n    :?fframe = 6\r\n      stepflag = 0\r\n    :?fframe = 5\r\n      ?stepflag = 0\r\n        posy = posy + fallstep\r\n        stepflag = 1\r\n    :?fframe = 4\r\n      stepflag = 0\r\n    :?fframe = 3\r\n      ?stepflag = 0\r\n        posy = posy + fallstep\r\n        stepflag = 1\r\n    :?fframe = 2\r\n      stepflag = 0\r\n    :?fframe = 1\r\n      ?stepflag = 0\r\n        posy = posy + 0\r\n        stepflag = 1\r\n    :?fframe = 0\r\n      stepflag = 0\r\n\r\n    params［5］.y = posy\r\n\r\n  params［0］ = stepflag\r\n//\r\n\r\n\r\n//*******************************\r\n// Main Code\r\n//*******************************\r\n\r\n?totaltime <= 1\r\n  win = AlwaysOn\r\n  bossbattle = 0\r\n:?face = ＂^^＂\r\n  win = 1\r\n:?foe = phase1 & foe.hp > 0\r\n  bossbattle = 1\r\n:?bossbattle = 1 & foe.count <= 0\r\n  win = 1\r\n\r\n?win &\r\n^(time % 10 = 0) & \r\n^(1 + rng % 2 = 2) &\r\n^(farr.Count() <= maxfw)\r\n  farr.Add(CreateFirework())\r\n\r\nUpdateFireworks()\r\nCleanupFireworks()\r\n\r\n//*******************************\r\n// End of File\r\n//*******************************\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/quips.txt" - Parse error: Failed to parse completely. Remaining: "=\"\"\r\nvar old_foe=\"\"\r\nvar old_foecount=0\r\nvar old_foedistance=0\r\nvar old_foedebuffs=\"\"\r\nvar old_foestate=0\r\nvar old_foehp=0\r\nvar old_foemaxhp=0\r\nvar old_foearmor=0\r\n\r\nvar quipexclstr= \"a\"//A string that holds identifiers for quips so they don't repeat too often.\r\nvar quiptimer = -1//Are we supposed to start a quip? (negative, we said a quip. 0, we should say a quip. positive, timer before we can say a quip)\r\nvar quipme = 0     //Are we currently saying a quip?\r\nvar quippos        //Where the quip starts, horizontally. A factor of the length of the quip's longest line.\r\nvar quipht         //Where the quip starts, vertically. A factor of the quip's line count.\r\nvar quipct         //The quip's line count.\r\nvar quiplen        //The length of the raw quip.\r\nvar thequip        //The quip. A string, possibly cut into multiple lines by \\n's\r\nvar midquip        //A line of the quip that is to be put into an array\r\nvar quiplside      //The left side of the quip outline. Literally 2 to the left of the quip's left side.\r\nvar quiparr = []   //The quip, stored in an array of strings instead of 1 string with \\n's\r\nvar i              //for a for loop, to iterate the quip line by line.\r\nvar j              //for a for loop, to draw black squares in the quip text box before writing the quip.\r\n\r\n/*******************************************************************************************\r\nFirst, determine if a long enough time has passed so we can say a quip.\r\nThis is a matter of taste. Either you want to be a chatterbox so you'd set it low, or you want quips to be rare so you set it high.\r\nThe variable \"quiptimer\" here is the number of ticks between the last quip ending and a new quip starting, and is determined by the function.\r\nAny function can be used, but the default \"500 + rng % 500\" will force a 500 tick wait, and allow a quip to be said after 0-500 more ticks.\r\nIf quiptimer is less than zero, reset it. If it's greater than 0 decrement it by 1. If it's 0, we'll handle that below.\r\n*******************************************************************************************/\r\n\r\n?quiptimer < 0\r\n  ?demo=1\r\n    quiptimer = 50\r\n  :\r\n    quiptimer = 500 + rng%500\r\n:?quiptimer > 0\r\n  quiptimer = quiptimer - 1\r\n\r\n// If we're saying a quip...\r\n?quipme > 0\r\n  //draw the top 2 corners of the quip word bubble.\r\n  quipht = -4-quipct\r\n  >o@quiplside@,@quipht@,#808080,.\r\n  >o2,@quipht@,#808080,.\r\n  \r\n  //draw the top and bottom lines of the quip word bubble, and the \\│ part.\r\n  for i = quippos-1..1\r\n    >o@i@,@quipht@,#808080,─\r\n    >o@i@,-3,#808080,─\r\n  >o@quiplside@,-3,#808080,'\r\n  >o-3,-3,#808080,. .──'\r\n  >o-2,-2,#808080,\\│\r\n  \r\n  //write the quip, first clearing the line with solid black ascii.\r\n  for i = 0..quipct-1\r\n    quipht = -3-quipct+i\r\n    for j = quippos-1..1\r\n      >o@j@,@quipht@,#000000,.\r\n    midquip = quiparr[i]\r\n    >o@quippos@,@quipht@,@midquip@\r\n    >o@quiplside@,@quipht@,#808080,│\r\n    >o2,@quipht@,#808080,│\r\n\r\n  //reduce the quipme timer, so you'll stop talking.\r\n  quipme = quipme - 1\r\n\r\n//If we're supposed to be saying a quip, AND we win a coin flip (or are demonstrating)\r\n:?quiptimer = 0 & (demo = 1 | rng < 5000)\r\n  //find a quip to say. NOTE: Returns a quip or 0_NO_QUIP, which means nothing quip-worthy is currently happening.\r\n  thequip = getaquip()\r\n  ?thequip ! \"0_NO_QUIP\"\r\n    //reset quip timer (you say it for 50 frames)\r\n    quipme = 50\r\n    //clear the quip array and put the quip into it, for saying.\r\n    quiparr.Clear()\r\n    quiparr = string.Break(thequip,1000)\r\n    //Find the maximum width of the lines in the quip, and set the variables for drawing the text box later.\r\n    quipct = quiparr.Count()\r\n    quippos = 0\r\n    for i = 0..quipct-1\r\n      midquip = quiparr[i]\r\n      ?quippos < string.Size(midquip)\r\n        quippos = string.Size(midquip)\r\n    quippos=-quippos+1\r\n    quiplside=quippos-2\r\n    //set quiptimer to -1, so we know next loop to reset it.\r\n    quiptimer = -1\r\n\r\n//Set all variables for the next tick.\r\nold_hp       = hp\r\nold_maxhp    = maxhp\r\nold_armor    = armor\r\nold_maxarmor = maxarmor\r\nold_debuffs  = debuffs.string\r\nold_foe      = foe\r\nold_foecount = foe.count\r\nold_foedistance = foe.distance\r\nold_foedebuffs = foe.debuffs.string\r\nold_foestate = foe.state\r\nold_foehp = foe.hp\r\nold_foemaxhp = foe.maxhp\r\nold_foearmor = foe.armor\r\n\r\n/***************\r\n   FUNCTIONS\r\n***************/\r\nfunc getaquip()\r\n  //variables of what all important stats were last tick, to check changes in game state.\r\n  var a = [] //array of potential things to say\r\n  var c = 0  //the random thing that gets said\r\n  a.Clear()\r\n\r\n  // **************************\r\n  // **** QUIPS START HERE ****\r\n  // **************************\r\n  \r\n  //Quips based on world.\r\n  ?loc = rocky\r\n    ?foe.state=126 & foe.time=80\r\n      a.Add(\"Why yes, I'd love\\na challenge!\")\r\n \r\n  //Quips based on your status\r\n  ?hp < old_hp\r\n    a.Add(\"Ouch!\")\r\n    a.Add(\"Oof!\")\r\n    a.Add(\"Stop it!\")\r\n  ?hp > old_hp & hp=maxhp\r\n    a.Add(\"There, all better.\")\r\n  ?hp < old_hp & hp*10 < maxhp\r\n    a.Add(\"I'm getting too\\nold for this!\")\r\n  ?armor > old_armor & armor = maxarmor\r\n    a.Add(\"Armor up!\")\r\n  ?debuffs.string=\"debuff_chill\" & old_debuffs ! \"debuff_chill\"\r\n    a.Add(\"Brr!\")\r\n  ?debuffs.string=\"debuff_dot\" & old_debuffs ! \"debuff_dot\"\r\n    a.Add(\"I'm on fire!\\nNo not like that\\nI mean I'm\\nliterally ON FIRE!\")\r\n  ?debuffs.string=\"debuff_damage\" & old_debuffs ! \"debuff_damage\"\r\n    a.Add(\"I don't feel\\nso good...\")\r\n  \r\n  //Quips based on enemy status\r\n  ?foe.hp < old_foehp & foe.hp*10 < foe.maxhp & foe.hp < 500 & foe.maxhp > 100\r\n    a.Add(\"DM Says you're\\ngonna die!\\nRoll a D6!\")\r\n    a.Add(\"Almost there!\")\r\n    a.Add(\"JUST DIE\\nALREADY!\")\r\n  ?foe.count > 5 & old_foecount-1 = foe.count\r\n    a.Add(\"One down,\\n\" + foe.count + \" to go.\")\r\n  ?foe.debuffs.string=\"debuff_chill\" & old_foedebuffs ! \"debuff_chill\"\r\n    a.Add(\"Ice to meet you!\")\r\n    a.Add(\"Get iced!\")\r\n    a.Add(\"Chill out!\")\r\n  ?foe.debuffs.string=\"debuff_dot\" & old_foedebuffs ! \"debuff_dot\"\r\n    a.Add(\"Flame On!\")\r\n  ?foe.debuffs.string=\"debuff_damage\" & old_foedebuffs ! \"debuff_damage\"\r\n    a.Add(\"Oh sorry did\\nI poison you?\")\r\n    a.Add(\"Does this taste\\nlike poison\\nto you?\")\r\n  ?foe.armor > old_foearmor & old_foearmor > -1\r\n    ?foe.armor-old_foearmor > 1000\r\n      a.Add(foe.armor + \" armor, really?\")\r\n    :\r\n      a.Add(\"Great, more armor\\nto go through.\")\r\n  ?foe.distance < 5 & foe.distance < old_foedistance\r\n    a.Add(\"IN YO FACE!\")\r\n    a.Add(\"Thrust!\")\r\n  ?foe ! bat & oldfoe = bat\r\n    a.Add(\"No bats in\\nthis belfry!\")\r\n      \r\n  //Qiups based on enemy and your status\r\n  ?foe=\"boss\"\r\n    ?foe.hp < old_foehp & foe.hp*10<foe.maxhp & foe.hp < 500 & hp*10>maxhp*9\r\n      a.Add(\"Aren't boss fights\\nsupposed to be\\ndifficult or something?\")\r\n      a.Add(\"Boss? More\\nlike WUSS!\")\r\n    ?old_foestate=33 & foe.state ! 33 & hp>=old_hp & armor>=old_armor\r\n      a.Add(\"Missed me!\")\r\n      a.Add(\"Dodge! Parry! Fight!\")\r\n  \r\n  //Random quips\r\n  \r\n\r\n  //In case there are no quips, needs to return the error.\r\n  ?a.Count() = 0\r\n    return \"0_NO_QUIP\"\r\n\r\n  //return 1 quip\r\n  c = rng % a.Count()\r\n  quiplen=string.Size(a[c])\r\n  ?quiplen > 10\r\n    quiplen = 10\r\n  ?quipexclstr = string.Sub(a[c],0,quiplen)\r\n    return \"0_NO_QUIP\"\r\n  :\r\n    quipexclstr = string.Sub(a[c],0,quiplen) + quipexclstr\r\n    ?string.Size(quipexclstr) > 100\r\n      quipexclstr=string.Sub(quipexclstr, 0, 100)\r\n    return a[c]"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetFly.txt" - Parse error: Failed to parse completely. Remaining: "= #rainbow\r\n\r\nvar keepDistance = -17\r\nvar maxX = -11\r\n\r\nvar maxDistance\r\nmaxDistance = -70\r\n\r\nvar targetZ = -1\r\n\r\nvar x = 0\r\nvar y = 0\r\nvar myX = 0\r\nvar myZ = 0\r\nvar lastPlayerX = 0\r\nvar lastPlayerZ = 0\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1\r\nvar stateJump = 2\r\nvar currentState = stateNone\r\nvar stateTime = 0\r\n\r\n\r\nfunc SetState(newState)\r\n  ?newState = stateJump\r\n    play bat_wing\r\n\r\n  currentState = newState\r\n  stateTime = 0\r\n\r\n\r\n?currentState = stateNone | time = 1\r\n  lastPlayerX = pos.x\r\n  lastPlayerZ = pos.z\r\n  myX = keepDistance\r\n  myZ = targetZ\r\n\r\n  // Start further away if the frog is summoned while the location is already running\r\n  ?time > 1\r\n    myX = maxDistance\r\n\r\n  SetState(stateIdle)\r\n\r\n\r\nmyX = myX - (pos.x - lastPlayerX)\r\n\r\nstateTime++\r\n\r\n?currentState = stateIdle\r\n  ?myX < maxDistance | myX > -maxDistance\r\n    myX = maxDistance\r\n  myZ = myZ - (pos.z - lastPlayerZ)\r\n\r\n  ?myX < keepDistance\r\n    SetState(stateJump)\r\n\r\n:?currentState = stateJump\r\n  ?myX < maxX\r\n    myX++\r\n\r\n  ?stateTime >= 6\r\n    ?myZ > targetZ\r\n      myZ--\r\n    :?myZ < targetZ\r\n      myZ++\r\n\r\n  ?stateTime >= 12\r\n    SetState(stateIdle)\r\n\r\n\r\nlastPlayerX = pos.x\r\nlastPlayerZ = pos.z\r\n\r\n// Draw\r\n\r\n?currentState = stateIdle\r\n  >o@myX@,@myZ@,@frogColor@,ascii\r\n##`*´\r\nasciiend\r\n  x = myX + 5\r\n  y = myZ + 2\r\n  ?face = \"( ^^\"\r\n    >o@x@,@y@,@frogColor@,ascii\r\n\r\nasciiend\r\n\r\n  :?face = \"°°\"\r\n    ?time % 4 <= 1\r\n      >o@x@,@y@,@frogColor@,ascii\r\n\r\nasciiend\r\n    ?time % 4 > 1\r\n      >o@x@,@y@,@frogColor@,ascii\r\n\r\nasciiend\r\n\r\n  :?stateTime % 50 >= 48\r\n    >o@x@,@y@,@frogColor@,ascii\r\n\r\nasciiend\r\n  :?stateTime % 50 >= 46\r\n    >o@x@,@y@,@frogColor@,ascii\r\n\r\nasciiend\r\n  :?stateTime % 50 >= 44\r\n    >o@x@,@y@,@frogColor@,ascii\r\n\r\nasciiend\r\n\r\n?currentState = stateJump\r\n  ?stateTime/2 = 0\r\n    >o@myX@,@myZ@,@frogColor@,ascii\r\n##`*´\r\nasciiend\r\n\r\n  :?stateTime/2 = 1\r\n    >o@myX@,@myZ@,@frogColor@,ascii\r\n##`*-\r\nasciiend\r\n\r\n  :?stateTime/2 = 2\r\n    >o@myX@,@myZ@,@frogColor@,ascii\r\n##-*.\r\nasciiend\r\n\r\n  :?stateTime/2 = 3\r\n    >o@myX@,@myZ@,@frogColor@,ascii\r\n##,*-\r\nasciiend\r\n\r\n  :?stateTime/2 = 4\r\n    >o@myX@,@myZ@,@frogColor@,ascii\r\n##·*´\r\nasciiend\r\n\r\n  :?stateTime/2 = 5\r\n    >o@myX@,@myZ@,@frogColor@,ascii\r\n##`*´\r\nasciiend\r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/SantaFlyingSleigh.txt" - Parse error: Failed to parse completely. Remaining: "?pos.x < 10\r\n    var deerFrame = 0\r\n    var deerX = 70\r\n\r\n//draw the sleigh for each frame of animation\r\n  ?deerFrame >= 0 & deerFrame < 5 & deerX > -50\r\n      >`@deerX@,6,@#888888@,ascii\r\n##.######.######.######.#####`._o´*_.\r\n`',=.'#`',=.'#`',=.'#`',=.'~~~~_-_-_#\r\nasciiend\r\n      >`@deerX@,6,@#AA0000@,ascii\r\n#\r\n`\r\nasciiend\r\n    deerFrame++\r\n\r\n  ?deerFrame >= 5 & deerFrame < 10 & deerX > -50\r\n      >`@deerX@,6,@#888888@,ascii\r\n##.######.######.######.#####`._o´*_.\r\n`'.=,'#`'.=,'#`'.=,'#`'.=,'~~~~_-_-_#\r\nasciiend\r\n      >`@deerX@,6,@#AA0000@,ascii\r\n#\r\n`\r\nasciiend\r\n    deerFrame++\r\n\r\n//decrease the sleigh's x position for each script iteration to have it move right to left\r\n  deerX--\r\n\r\n//reset the animation frames if frame counter is over 9\r\n  ?deerFrame >= 10\r\n    deerFrame = 0"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Giftbag.txt" - Parse error: Failed to parse completely. Remaining: "###_//\\\r\n#,'\\/-/_/-._\r\n| `'＂＂＂`  ._\\\r\n( `-.. - /##))\r\n`._____.'\r\nasciiend\r\n>o-12,-1,#blue,ascii\r\n###_\r\n###\\/&\r\nasciiend\r\n>o-12,-1,#yellow,ascii\r\n####//\\8\r\nasciiend\r\n>o-12,-1,#red,ascii\r\n#######\r\n######/+\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/TheSun.txt" - Parse error: Failed to parse completely. Remaining: "= #bbbb00\r\n:?stars > 5 & stars <= 10\r\n col = #00bbbb\r\n:?stars > 10 & stars <= 15\r\n col = #bb8800\r\n\r\n?totaltime%3=0&done=false\r\n ropedown += 1\r\n ?ropedown = 2\r\n  done=true\r\n\r\n?(totaltime-1)%6=0&done=false\r\n altropedown += 2\r\n\r\n\r\n?done=true&bounce=false\r\n ropedown -= 1\r\n altropedown += 1\r\n ?ropedown = 1\r\n  bounce = true\r\n\r\n?loc = icy | loc = rocky | loc = cross\r\n >`@mid+5@,@ropedown-4@,#777777,ascii\r\n  ┊ \r\n  ┊ \r\n  ┊ \r\n  ┊ \r\n  ┊ \r\nasciiend\r\n >`@mid+5@,@altropedown-5@,#777777,ascii\r\n##########┊\r\n##########┊\r\n##########┊\r\n##########┊\r\n##########┊\r\nasciiend\r\n >`@mid+5@,@altropedown-1@,@col@,ascii\r\n#########(¯)\r\n##########¯\r\nasciiend\r\n >`@mid+2@,@ropedown@,@col@,ascii\r\n################\r\n## .─¯─.\r\n#,´     `.\r\n#| ▼-▼   |\r\n#'       '\r\n##`._ _.´\r\n#### ¯\r\nasciiend\r\n >`@mid+1@,@ropedown@,@col@,ascii\r\n######|\r\n##\\#######/\r\n###########\r\n─###########─\r\n###########\r\n##/#######\\\r\n######|    \r\nasciiend\r\n\r\n?bighead\r\n >( ▼-▼\r\n\r\n?foe = boss & foe.distance < 20\r\n ropedown -= 1\r\n altropedown -= 1\r\n?totaltime=1\r\n ropedown = -20\r\n altropedown = -17\r\n bounce = false\r\n done = false"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetSnail.txt" - Parse error: Failed to parse completely. Remaining: "sound=1 // Change this to 0 if you do not want the snail sound to play when he moves\r\n\r\nSnailEyeColor = #ECFFBE    // Eye Color    default is #ECFFBE Australian Mint apparantly lol https://abouts.co/color/ECFFBE\r\n//####Oo\r\n\r\nsnailShellColor = #F5B7B1  // Shell Color  default is #F5B7B1 pink\r\n//#_#\r\n//(#)\r\n\r\nsnailSpiralColor = #FF0000 // Spiral Color default is #FF0000 red\r\n//#\r\n//#@\r\n\r\nsnailBodyColor = #80FFFA   // Body Color   default is #80FFFA cyan\r\n//#\r\n//####/\r\n//¯¯¯¯\"\r\n\r\n/*\r\nWIP\r\n##_#Oo\r\n#(@)/#\r\n#\\╤/\"#\r\n(╳┊)##\r\n#|┊|##\r\n\r\n  var moldX\r\n  moldX=myX-1\r\n  >o@moldX@,@myZ@,#663399,ascii\r\n#\r\n#\r\n#\\╤/\r\n(≡┊)\r\n#|┊|\r\nasciiend\r\n  >o@moldX@,@myZ@,#CFB53B,ascii\r\n#\r\n#\r\n##╤\r\nasciiend\r\n  >o@moldX@,@myZ@,#0088FF,ascii\r\n#\r\n#\r\n#\r\n#≡\r\nasciiend\r\n*/\r\n\r\nvar keepDistance = -11 // distance at which the movement animation will play (stateSlime)\r\nvar maxX = -10         // closest offset pet will get to character.  Closer to 0, closer to character\r\nvar maxDistance = -100 // if the pet exceeds this distance, it will teleport to this distance (cannot be further away than this)\r\nvar targetZ = 2       // We want to start the drawing 1 unit below the player agent\r\n\r\n?loc.loop\r\n  keepDistance = -11\r\n  maxX = -10\r\n  maxDistance = -100\r\n  targetZ = 2\r\n\r\nvar x = 0\r\nvar y = 0\r\nvar myX = 0\r\nvar myZ = 0\r\nvar lastPlayerX = 0\r\nvar lastPlayerZ = 0\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1\r\nvar stateSlime = 2\r\nvar currentState = stateNone\r\nvar stateTime = 0\r\n\r\nfunc SetState(newState)\r\n  ?newState = stateSlime & sound=1\r\n    play snail_walk // sound played when pet moves\r\n  currentState = newState\r\n  stateTime = 0\r\n\r\n?currentState = stateNone | time = 1\r\n  lastPlayerX = pos.x\r\n  lastPlayerZ = pos.z\r\n  myX = keepDistance\r\n  myZ = targetZ\r\n\r\n  // Start further away if the snail is summoned while the location is already running\r\n  ?time > 1\r\n    myX = maxDistance\r\n\r\n  SetState(stateIdle)\r\n\r\nmyX = myX - (pos.x - lastPlayerX) // If player has moved, increment myX (distance from player)\r\n\r\nstateTime++\r\n\r\n?currentState = stateIdle\r\n  ?myX < maxDistance | myX > -maxDistance\r\n    myX = maxDistance\r\n  myZ = myZ - (pos.z - lastPlayerZ)\r\n\r\n  ?myX < keepDistance\r\n    SetState(stateSlime)\r\n\r\n:?currentState = stateSlime\r\n  ?myX < maxX\r\n    myX++\r\n\r\n  ?stateTime >= 6\r\n    ?myZ > targetZ\r\n      myZ--\r\n    :?myZ < targetZ\r\n      myZ++\r\n\r\n  ?stateTime >= 15\r\n    SetState(stateIdle)\r\n\r\nlastPlayerX = pos.x\r\nlastPlayerZ = pos.z\r\n\r\n// Draw\r\n?currentState = stateIdle\r\n  >o@myX@,@myZ@,@SnailEyeColor@,ascii\r\n###Oo\r\nasciiend\r\n  >o@myX@,@myZ@,@snailShellColor@,ascii\r\n#_#\r\n(#)\r\nasciiend\r\n  >o@myX@,@myZ@,@snailSpiralColor@,ascii\r\n#\r\n#@\r\nasciiend\r\n  >o@myX@,@myZ@,@snailBodyColor@,ascii\r\n#\r\n###/\r\n¯¯¯\"\r\nasciiend\r\n  x = myX\r\n  y = myZ\r\n  ?face = \"( ^^\"\r\n    >o@x@,@y@,@SnailEyeColor@,ascii\r\n###^^\r\nasciiend\r\n    >o@x@,@y@,@snailBodyColor@,ascii\r\n#\r\n###/\r\n¯¯¯°<meow!\r\nasciiend\r\n  :?face = \"( TT\"\r\n    >o@x@,@y@,@SnailEyeColor@,ascii\r\n###><\r\nasciiend\r\n  :?face = \"°°\"\r\n    ?time % 10 = 0 & myX > keepDistance\r\n      myX--\r\n    ?time % 4 <= 1\r\n      >o@x@,@y@,@SnailEyeColor@,ascii\r\n###oO\r\nasciiend\r\n    ?time % 4 > 1\r\n      >o@x@,@y@,@SnailEyeColor@,ascii\r\n###Oo\r\nasciiend\r\n  :?stateTime % 50 >= 48\r\n    >o@x@,@y@,@SnailEyeColor@,ascii\r\n###O-\r\nasciiend\r\n  :?stateTime % 50 >= 46\r\n    >o@x@,@y@,@SnailEyeColor@,ascii\r\n###=-\r\nasciiend\r\n  :?stateTime % 50 >= 44\r\n    >o@x@,@y@,@SnailEyeColor@,ascii\r\n###--\r\nasciiend\r\n?currentState = stateSlime\r\n  ?stateTime/3 = 0\r\n    >o@myX@,@myZ@,@SnailEyeColor@,ascii\r\n####Oo\r\nasciiend\r\n    >o@myX@,@myZ@,@snailShellColor@,ascii\r\n#_#\r\n(#)\r\nasciiend\r\n    >o@myX@,@myZ@,@snailSpiralColor@,ascii\r\n#\r\n#@\r\nasciiend\r\n    >o@myX@,@myZ@,@snailBodyColor@,ascii\r\n#\r\n###/\r\n¯¯`^\r\nasciiend\r\n  :?stateTime/3 = 1\r\n    >o@myX@,@myZ@,@SnailEyeColor@,ascii\r\n###Oo\r\nasciiend\r\n    >o@myX@,@myZ@,@snailShellColor@,ascii\r\n#_#\r\n(#)\r\nasciiend\r\n    >o@myX@,@myZ@,@snailSpiralColor@,ascii\r\n#\r\n#@\r\nasciiend\r\n    >o@myX@,@myZ@,@snailBodyColor@,ascii\r\n#\r\n###/\r\n¯`´\"\r\nasciiend\r\n  :?stateTime/3 = 2\r\n    >o@myX@,@myZ@,@SnailEyeColor@,ascii\r\n###Oo\r\nasciiend\r\n    >o@myX@,@myZ@,@snailShellColor@,ascii\r\n#_#\r\n(#)\r\nasciiend\r\n    >o@myX@,@myZ@,@snailSpiralColor@,ascii\r\n#\r\n#@\r\nasciiend\r\n    >o@myX@,@myZ@,@snailBodyColor@,ascii\r\n#\r\n###/\r\n`´¯'\r\nasciiend\r\n  :?stateTime/3 = 3\r\n    >o@myX@,@myZ@,@SnailEyeColor@,ascii\r\n###Oo\r\nasciiend\r\n    >o@myX@,@myZ@,@snailShellColor@,ascii\r\n#_#\r\n(#)\r\nasciiend\r\n    >o@myX@,@myZ@,@snailSpiralColor@,ascii\r\n#\r\n#@\r\nasciiend\r\n    >o@myX@,@myZ@,@snailBodyColor@,ascii\r\n#\r\n###/\r\n´¯¯\"\r\nasciiend\r\n  :?stateTime/3 = 4\r\n    >o@myX@,@myZ@,@SnailEyeColor@,ascii\r\n###Oo\r\nasciiend\r\n    >o@myX@,@myZ@,@snailShellColor@,ascii\r\n#_#\r\n(#)\r\nasciiend\r\n    >o@myX@,@myZ@,@snailSpiralColor@,ascii\r\n#\r\n#@\r\nasciiend\r\n    >o@myX@,@myZ@,@snailBodyColor@,ascii\r\n#\r\n###/\r\n¯¯¯\"\r\nasciiend\r\n  x = myX\r\n  y = myZ\r\n  ?face = \"( ^^\"\r\n    >o@x@,@y@,@SnailEyeColor@,ascii\r\n###^^\r\nasciiend\r\n    >o@x@,@y@,@snailBodyColor@,ascii\r\n#\r\n###/\r\n¯¯¯°<meow!\r\nasciiend\r\n  :?face = \"( TT\"\r\n    >o@x@,@y@,@SnailEyeColor@,ascii\r\n###><\r\nasciiend\r\n  :?face = \"°°\"\r\n    ?time % 10 = 0 & myX > keepDistance\r\n      myX--\r\n    ?time % 4 <= 1\r\n      >o@x@,@y@,@SnailEyeColor@,ascii\r\n###oO\r\nasciiend\r\n    >o@myX@,@myZ@,@snailBodyColor@,ascii\r\n#\r\n###/\r\n¯¯¯°\r\nasciiend\r\n    ?time % 4 > 1\r\n      >o@x@,@y@,@SnailEyeColor@,ascii\r\n###Oo\r\nasciiend\r\n    >o@myX@,@myZ@,@snailBodyColor@,ascii\r\n#\r\n###/\r\n¯¯¯\"\r\nasciiend\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/SpookyScarySkeletons.txt" - Parse error: Failed to parse completely. Remaining: "= []\r\nvar skelly1\r\nvar skelly2\r\nvar skelly3\r\nvar skelly4\r\n/* state list:\r\nGoing down: state 1\r\nGoing up: state 2\r\nGoing left: state 3\r\nGoing right: state 4\r\nGoing right and down diagonally: state 5\r\nGoing left and down diagonally: state 6\r\nGoing right and up diagonally: state 7\r\nGoing left and up diagonlly: state 8\r\n*/\r\nvar skellyState1 = 1\r\nvar skellyState2 = 1\r\nvar skellyState3 = 3\r\nvar skellyState4 = 2\r\n?totaltime = 1\r\n danceList.Clear()\r\n skellyState1 = 1\r\n skellyState2 = 1\r\n skellyState3 = 3\r\n skellyState4 = 2\r\n skelly1 = ui.AddAnim(skeletonArt)\r\n skelly1.duration = 32\r\n skelly1.loop = true\r\n skelly1.Play()\r\n skelly1.dock = top_left\r\n skelly1.x = 7\r\n skelly1.y = 5\r\n danceList.Add(skelly1)\r\n skelly2 = ui.AddAnim(skeletonArt)\r\n skelly2.duration = 32\r\n skelly2.loop = true\r\n skelly2.Play()\r\n skelly2.dock = top_left\r\n skelly2.x = 7\r\n skelly2.y = 21\r\n danceList.Add(skelly2)\r\n skelly3 = ui.AddAnim(skeletonArt)\r\n skelly3.duration = 32\r\n skelly3.loop = true\r\n skelly3.Play()\r\n skelly3.dock = top_left\r\n skelly3.x = screen.w - 7\r\n skelly3.y = 5\r\n danceList.Add(skelly3)\r\n skelly4 = ui.AddAnim(skeletonArt)\r\n skelly4.duration = 32\r\n skelly4.loop = true\r\n skelly4.Play()\r\n skelly4.dock = top_left\r\n skelly4.x = screen.w - 7\r\n skelly4.y = screen.h - 4\r\n skelly4.visible = false\r\n danceList.Add(skelly4)\r\nfunc updateSkellies(number,state)\r\n ?state = 1 // down\r\n  danceList[number].y += 1\r\n  danceList[number].color = #green\r\n :?state = 2 //up\r\n  danceList[number].y -= 1\r\n  danceList[number].color = #blue\r\n :?state = 3 //left\r\n  danceList[number].x -= 1\r\n  danceList[number].color = #cyan\r\n :?state = 4 //right\r\n  danceList[number].x += 1\r\n  danceList[number].color = #yellow\r\n :?state = 5 //right and down\r\n  danceList[number].x += 1\r\n  danceList[number].y += 1\r\n  danceList[number].color = #FF7312\r\n :?state = 6 //left and down\r\n  danceList[number].x -= 1\r\n  danceList[number].y += 1\r\n  danceList[number].color = #red\r\n :?state = 7 //right and up\r\n  danceList[number].x += 1\r\n  danceList[number].y -= 1\r\n  danceList[number].color = #C59CC5\r\n :?state = 8 //left and up\r\n  danceList[number].x -= 1\r\n  danceList[number].y -= 1\r\n  danceList[number].color = #magenta\r\n ?danceList[number].y >= screen.h - 5\r\n   ?number = 0\r\n    ?state = 1\r\n     skellyState1 = 4\r\n   :?number = 1\r\n    ?state = 1\r\n     skellyState2 = 4\r\n ?danceList[number].x >= screen.h - 1\r\n  ?number = 0\r\n   skellyState1 = 8\r\n  ?number = 1\r\n   skellyState2 = 8\r\n ?danceList[number].x <= 7 & danceList[number].y <= 6\r\n  ?number = 0\r\n   skellyState1 = 1\r\n  ?number = 1\r\n   skellyState2 = 1\r\n  //for right side skellies:\r\n  ?skelly3.y <= screen.h + 9 & skelly3.x <= screen.w + 7 & skellyState3 = 5\r\n    skellyState3 = 2 \r\n  ?skelly3.y <= 5 & skellyState3 = 2 //& number = 2\r\n    skellyState3 = 3\r\n  ?skelly4.y <= 5 & skellyState4 = 2 & number = 3\r\n    skellyState4 = 3\r\n  :?skelly4.y <= screen.h + 9 & skelly4.x <= screen.w + 7 & skellyState4 = 5\r\n    skellyState4 = 2\r\n?totaltime % 6 = 1\r\n updateSkellies(0,skellyState1)\r\n updateSkellies(1,skellyState2)\r\n updateSkellies(2,skellyState3)\r\n //updateSkellies(3,skellyState4)\r\n/*\r\n>`0,0,#cyan,@skellyState1@\r\n\r\n>`1,1,oneY:@skelly1.y@  oneX:@skelly1.x@  twoY:@skelly2.y@  twoX:@skelly2.x@\r\n>`2,2,@screen.w - skelly3.x@   @screen.h@   threey:@skelly3.y@   threeX:@skelly3.x@  foury:@skelly4.y@   fourX:@skelly4.x@\r\n>`2,3,                    width@screen.w@ height:@screen.h@\r\n*/\r\n?(screen.w - skelly3.x) >= screen.h - 1\r\n    skellyState3 = 5\r\n?(screen.w - skelly4.x) >= screen.h - 1 \r\n    skellyState4 = 5\r\n?skelly4.y <= 4 & skellyState4 = 2\r\n    skellyState4 = 3\r\n\r\n>`0,4,state1:@skellyState1@   state2:@skellyState2@  state3:@skellyState3@ state4:@skellyState4@"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetChick.txt" - Parse error: Failed to parse completely. Remaining: "= [pickup_stone,250]\r\nvar chirpsound = [buy,300]\r\nvar peepsound  = [confirm,300]\r\nvar wingsound  = [bat_wing_small,300]\r\n\r\nvar eggColor   = #FFFCEC\r\nvar chickColor = #FFDD00\r\nvar chirpColor = #FF0000\r\nvar peepColor  = #00FFFF\r\n\r\nvar waitDist    = -20\r\nvar waitDistMin = -25\r\nvar waitDistMax = -15\r\nvar minDistance = -8\r\nvar targetZ = 1\r\n\r\n//*******************************\r\n// Global Variables\r\n//*******************************\r\n\r\nvar lvl\r\nvar hatchdur = 50\r\nvar noiseflag = 0\r\nvar x = 0\r\nvar y = 0\r\nvar myX = 0\r\nvar myZ = 0\r\nvar lastPlayerX = 0\r\nvar lastPlayerZ = 0\r\nvar maxDistance = -70\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1\r\nvar stateJump = 2\r\nvar stateFly  = 3\r\nvar stateLand = 4\r\nvar currentState = stateNone\r\nvar stateTime = 0\r\nvar clicked = false\r\nvar peeping = 0\r\n\r\nvar epanel\r\nvar eanim1\r\nvar eanim2\r\nvar canim\r\nvar epeep\r\n\r\nvar cpanel\r\nvar cidle\r\nvar chirp\r\nvar calert\r\nvar peep\r\nvar cjump\r\nvar cfly\r\nvar cland\r\nvar auth\r\nvar butt\r\n\r\n//*******************************\r\n// ASCII Art\r\n//*******************************\r\n\r\nvar hatch1 = ascii\r\n#\r\n######,-.\r\n#####:   :\r\n#####'._.'\r\n%%\r\n#\r\n######,-.\r\n#####: ; : \r\n#####'._.'\r\n%%\r\n#\r\n######,-.\r\n#####:·; :\r\n#####'._.'\r\n%%\r\n#\r\n######,-.\r\n#####:·;,:\r\n#####'._.'\r\n%%\r\n######,-.\r\n#####:·;,:\r\n####`({_,O-\r\n#####'._.'\r\n%%\r\n#####,-,\r\n####:,`_O-\r\n####`{/_;,\r\n#####'._.'\r\n%%\r\n#\r\n######__O<\r\n####'{/_;,\r\n:';´:'._.'\r\n#`-´\r\n%%\r\n#\r\n######__O-\r\n####`{/_;,\r\n:';´:'._.'\r\n#`-´\r\n%%\r\n#\r\n######__O-\r\n####`{/_;,\r\n:';´:'._.'\r\n#`-´\r\n%%\r\n#\r\n######__O-\r\n####`{/ ;\r\n######^^\r\n#\r\n%%\r\n#\r\n######__O-\r\n####`{/_;,\r\n:';´:'._.'\r\n#`-´\r\n%%\r\n#\r\n######__O-\r\n####`{/ ;\r\n######^^\r\n#\r\nasciiend\r\n\r\nvar hatch2 = ascii\r\n#\r\n#\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n####`({#,O-\r\n#\r\n%%\r\n#\r\n#######_O-\r\n####`{/#;\r\n#\r\n%%\r\n#\r\n######__O<\r\n####,{/#;\r\n#\r\n#\r\n%%\r\n#\r\n######__O-\r\n####`{/#;\r\n#\r\n#\r\n%%\r\n#\r\n######__O-\r\n####`{/#;\r\n#\r\n#\r\n%%\r\n#\r\n######__O-\r\n####`{/ ;\r\n######^^\r\n#\r\n%%\r\n#\r\n######__O-\r\n####`{/_;\r\n#\r\n#\r\n%%\r\n#\r\n######__O-\r\n####`{/ ;\r\n######^^\r\n#\r\nasciiend\r\n\r\n\r\nvar chickidle = ascii\r\n##__O-\r\n`{/ ;\r\n##^^\r\n%%\r\n#{\\\\O<\r\n,( ¯;\r\n##^^\r\n%%\r\n##__O<\r\n`{/ ;\r\n##^^\r\n%%\r\n##__O-\r\n`{/ ;\r\n##^^\r\nasciiend\r\n\r\nvar chickalert = ascii\r\n##__O-\r\n`{/ ;\r\n##^^\r\n%%\r\n#{\\\\O<\r\n,( ¯;\r\n##^^\r\nasciiend\r\n\r\nvar chickjump = ascii\r\n#\r\n#\r\n##__O-\r\n`{/ ;\r\n##^^\r\n%%\r\n#\r\n#\r\n#{\\\\O-\r\n,( ¯;\r\n##^^\r\n%%\r\n#\r\n##__O-\r\n`{/ /\r\n#´´\r\n#\r\n%%\r\n#{\\\\O-\r\n`( ¯/\r\n#´´\r\n#\r\n#\r\nasciiend\r\n\r\nvar chickfly = ascii\r\n#{\\\\O-\r\n,( ¯/\r\n#´´\r\n%%\r\n##__O-\r\n`{/ /\r\n#´´\r\nasciiend\r\n\r\nvar chickland = ascii\r\n#{\\\\O-\r\n`( ¯/\r\n#´´\r\n#\r\n#\r\n%%\r\n#\r\n##__O-\r\n`{/ /\r\n##^^\r\n#\r\n%%\r\n#\r\n#\r\n#{\\\\O-\r\n,( ¯;\r\n##^^\r\n%%\r\n#\r\n#\r\n##__O-\r\n`{/ ;\r\n##^^\r\nasciiend\r\n\r\nvar textchirp = ascii\r\n#Chirp!\r\n´\r\nasciiend\r\n\r\nvar textpeep = ascii\r\n#Peep!\r\n´\r\nasciiend\r\n\r\nvar textauth = ascii\r\n#♣Sven\r\n´\r\nasciiend\r\n\r\nvar custstyle = ui.AddStyle(\"\r\n^###\r\n^###\r\n^###\")\r\n\r\n\r\n//*******************************\r\n// Functions\r\n//*******************************\r\n\r\n//*******************************\r\n// DrawEgg()\r\n//\r\n// Creates the panel and \r\n// animations for the egg \r\n// hatching art\r\n//\r\n//*******************************\r\nfunc DrawEgg()\r\n  epanel = ui.AddPanel()\r\n  epanel.anchor = top_left\r\n  epanel.dock = top_left\r\n  epanel.w = 11\r\n  epanel.h = 5\r\n  epanel.style = custstyle \r\n\r\n  eanim1 = ui.AddAnim(hatch1)\r\n  eanim1.duration = hatchdur\r\n  eanim1.color = #87867E\r\n\r\n  eanim2 = ui.AddAnim(hatch1)\r\n  eanim2.duration = hatchdur\r\n  eanim2.color = eggColor\r\n\r\n  canim = ui.AddAnim(hatch2)\r\n  canim.duration = hatchdur\r\n  canim.color = chickColor\r\n\r\n  epeep = ui.AddAnim(textpeep)\r\n  epeep.color = peepColor\r\n  epeep.x = 9\r\n  epeep.y = -1\r\n  epeep.visible = false\r\n\r\n  epanel.Add(eanim1)\r\n  epanel.Add(eanim2)\r\n  epanel.Add(canim)\r\n  epanel.Add(epeep)\r\n//\r\n\r\n//*******************************\r\n// DrawChick()\r\n//\r\n// Creates the panel and \r\n// animations for the pet\r\n// chick art\r\n//\r\n//*******************************\r\nfunc DrawChick()\r\n  cpanel = ui.AddPanel()\r\n  cpanel.anchor = top_left\r\n  cpanel.dock = top_left\r\n  cpanel.w = 6\r\n  cpanel.h = 5\r\n  cpanel.style = custstyle \r\n  cpanel.visible = false\r\n\r\n  cidle = ui.AddAnim(chickidle)\r\n  cidle.loop = false\r\n  cidle.duration = 25\r\n  cidle.color = chickColor\r\n  cidle.y = 1\r\n\r\n  calert = ui.AddAnim(chickalert)\r\n  calert.loop = false\r\n  calert.duration = 7\r\n  calert.color = chickColor\r\n  calert.y = 1\r\n\r\n  cjump = ui.AddAnim(chickjump)\r\n  cjump.loop = false\r\n  cjump.duration = 10\r\n  cjump.color = chickColor\r\n\r\n  cfly = ui.AddAnim(chickfly)\r\n  cfly.loop = true\r\n  cfly.duration = 7\r\n  cfly.color = chickColor\r\n  cfly.y = -2\r\n\r\n  cland = ui.AddAnim(chickland)\r\n  cland.loop = false\r\n  cland.duration = 10\r\n  cland.color = chickColor\r\n\r\n  chirp = ui.AddAnim(textchirp)\r\n  chirp.color = chirpColor\r\n  chirp.x = 7\r\n  chirp.visible = false\r\n\r\n  peep = ui.AddAnim(textpeep)\r\n  peep.color = peepColor\r\n  peep.x = 7\r\n  peep.visible = false\r\n\r\n  auth = ui.AddAnim(textauth)\r\n  auth.color = peepColor\r\n  auth.x = 7\r\n  auth.visible = false\r\n\r\n  butt = ui.AddButton()\r\n  butt.w = 1\r\n  butt.h = 1\r\n  butt.y = 1\r\n  butt.SetUp(ChickClick)\r\n  butt.text = \"\"\r\n  butt.style = custstyle\r\n  butt.hcolor = #000000\r\n  butt.visible = false\r\n  butt.sound = wand_air_hit\r\n  \r\n  cpanel.Add(cidle)\r\n  cpanel.Add(calert)\r\n  cpanel.Add(cjump)\r\n  cpanel.Add(cfly)\r\n  cpanel.Add(cland)\r\n  cpanel.Add(chirp)\r\n  cpanel.Add(peep)\r\n  cpanel.Add(butt)\r\n  cpanel.Add(auth)\r\n//\r\n\r\nfunc ChickClick()\r\n  ?clicked = false\r\n    clicked = true\r\n//\r\n\r\n//*******************************\r\n// SetState()\r\n//\r\n// Sets the next state and \r\n// resets the stateTime timer\r\n//\r\n//*******************************\r\nfunc SetState(newState)\r\n  currentState = newState\r\n  stateTime = 0\r\n//\r\n\r\n//*******************************\r\n// ShowChick()\r\n//\r\n// Controls which animation is\r\n// visible depending on what \r\n// state the chick is in\r\n//\r\n//*******************************\r\nfunc ShowChick(state)\r\n  cidle.visible = false\r\n  calert.visible = false\r\n  cjump.visible = false\r\n  cfly.visible  = false\r\n  cland.visible = false\r\n  butt.visible = false\r\n\r\n  ?state = 0 //Idle\r\n    butt.visible = true\r\n    cidle.visible = true\r\n  ?state = 1 //Jump\r\n    clicked = false\r\n    cjump.visible = true\r\n    cjump.Play()\r\n    chirp.visible = false\r\n    peep.visible  = false\r\n    auth.visible  = false\r\n  :?state = 2 //Fly\r\n    clicked = false\r\n    cfly.visible  = true\r\n    cfly.Play()\r\n  :?state = 3 //Land\r\n    clicked = false\r\n    cland.visible = true\r\n    cland.Play()\r\n  :?state = 5 //Alert\r\n    clicked = false\r\n    calert.visible = true\r\n//\r\n\r\n//*******************************\r\n// MoveChick()\r\n//\r\n// Updates the pet chick panel\r\n// with new x/y coordinates \r\n// converting them from the \r\n// world to screen positions for\r\n// use with the chick panel\r\n//\r\n//*******************************\r\nfunc MoveChick(x,y)\r\n  cpanel.x = x+screen.FromWorldX(pos.x) - 6\r\n  cpanel.y = y+screen.FromWorldZ(lastPlayerZ) \r\n             ^- 4 + targetZ\r\n//\r\n\r\n//*******************************\r\n// MakeNoise()\r\n//\r\n// Controls which and when sounds\r\n// are played depending on the \r\n// noise desired, the state of\r\n// the chick, and if a noise is\r\n// already playing\r\n//\r\n//*******************************\r\nfunc MakeNoise(noise)\r\n  ?noise = 0 //hatch\r\n    ?canim.frame < 5\r\n      play @hatchsound[0]@ @hatchsound[1]@\r\n    ?canim.frame = 6\r\n      chirp.visible = false\r\n      epeep.visible = true\r\n      ?noiseflag < 1\r\n        play @peepsound[0]@ @peepsound[1]@\r\n        noiseflag = 1\r\n    :?canim.frame = 7\r\n      epeep.visible = true\r\n    :\r\n      noiseflag = 0 \r\n      epeep.visible = false \r\n\r\n  :?noise = 1 //peep\r\n    ?peeping = 0 & clicked = true\r\n      peeping = 2\r\n      clicked = false\r\n    :?peeping = 0 & (1 + rng % 30) = 1\r\n      peeping = 1\r\n    :?peeping > 0\r\n      ?!cidle.playing\r\n        cidle.Play()\r\n        noiseflag = 0\r\n      ?cidle.frame = 0\r\n        auth.visible = false\r\n        peep.visible = false\r\n      :?cidle.frame = 1\r\n        ?noiseflag < 1\r\n          chirp.visible = false\r\n          ?peeping = 1\r\n            peep.visible = true\r\n            auth.visible = false\r\n          :?peeping = 2\r\n            peep.visible = false\r\n            auth.visible = true\r\n          play @peepsound[0]@ @peepsound[1]@\r\n          noiseflag = 1\r\n      :?cidle.frame = 2\r\n        noiseflag = 0\r\n        ?peeping = 1\r\n          peep.visible = true\r\n          auth.visible = false\r\n        :?peeping = 2\r\n          peep.visible = false\r\n          auth.visible = true\r\n      :?cidle.frame = 3\r\n        auth.visible = false\r\n        peep.visible = false\r\n        peeping = 0\r\n      :\r\n        auth.visible = false\r\n        peep.visible = false\r\n\r\n  :?noise = 2 //Alert\r\n    ?!calert.playing\r\n      calert.Play()\r\n      noiseflag = 0\r\n    :?calert.frame = 1\r\n      ?noiseflag < 1\r\n        auth.visible = false\r\n        peep.visible = false\r\n        chirp.visible = true\r\n        play @chirpsound[0]@ @chirpsound[1]@\r\n        noiseflag = 1\r\n    :\r\n      noiseflag = 0\r\n      chirp.visible = false\r\n\r\n  :?noise = 3 //Success\r\n    ?!calert.playing\r\n      calert.Play()\r\n    :?calert.frame = 1\r\n      ?noiseflag < 1\r\n        auth.visible = false\r\n        chirp.visible = false\r\n        peep.visible = true\r\n        play @peepsound[0]@ @peepsound[1]@\r\n        noiseflag = 1\r\n    :\r\n      noiseflag = 0  \r\n      peep.visible = false\r\n\r\n  :?noise = 4 //fly\r\n    ?noiseflag < 1\r\n      play @wingsound[0]@ @wingsound[1]@\r\n      noiseflag = 1\r\n    :\r\n      noiseflag = 0\r\n//\r\n\r\n//*******************************\r\n// AnimateChick()\r\n//\r\n// The main function controlling\r\n// the pet chick, determing what\r\n// state it's in, what animation\r\n// to show, what noises to make,\r\n// and when to update movement\r\n//\r\n//*******************************\r\nfunc AnimateChick()\r\n  ?currentState = stateNone | time = 1\r\n    ?totaltime <= 1\r\n      DrawEgg()\r\n      DrawChick() \r\n\r\n      lvl = loc.id\r\n      ?lvl = \"waterfall\"\r\n        targetZ = 0\r\n\r\n    lastPlayerX = pos.x\r\n    lastPlayerZ = pos.z\r\n    myX = waitDistMin\r\n    myZ = targetZ\r\n    epanel.x = myX+screen.FromWorldX(pos.x) - 10\r\n    epanel.y = myZ+screen.FromWorldZ(lastPlayerZ) \r\n               ^- 3 + targetZ\r\n\r\n    ?pos.x > 0\r\n      epanel.visible = false\r\n      SetState(stateIdle)\r\n    :\r\n      SetState(stateHatch)\r\n    \r\n  :?currentState = stateHatch\r\n    ?!eanim1.playing\r\n      eanim1.Play()\r\n    :?eanim1.playing\r\n      eanim2.Play()\r\n      canim.Play()\r\n    \r\n    MakeNoise(0)\r\n \r\n    ?canim.frame = 11 \r\n      ShowChick(0)\r\n      epanel.visible = false\r\n      SetState(stateIdle)\r\n\r\n  :?currentState = stateIdle\r\n    ShowChick(0)\r\n \r\n    ?face = \"°°\"\r\n      ShowChick(5)\r\n      MakeNoise(2)\r\n    :?face = \"^^\"\r\n      ShowChick(5)\r\n      MakeNoise(3)\r\n    : \r\n     ShowChick(0)\r\n     MakeNoise(1)\r\n\r\n    ?myX < maxDistance | myX > -maxDistance\r\n      myX = maxDistance\r\n\r\n    ?myX < waitDist\r\n      SetState(stateJump)\r\n  \r\n  :?currentState = stateJump\r\n    ShowChick(1)\r\n    ?!cjump.playing\r\n      cjump.Play()\r\n    :\r\n      ?cjump.frame > 2\r\n        MakeNoise(4)\r\n        ?myX < minDistance\r\n          myX++\r\n      ?cjump.frame = 3\r\n        currentState = stateFly\r\n\r\n  :?currentState = stateFly\r\n    ShowChick(2)\r\n    MakeNoise(4)\r\n    ?!cfly.playing\r\n      cfly.Play()\r\n    :\r\n      ?stateTime/4 >= 5\r\n        currentState = stateLand\r\n\r\n    ?myX < minDistance\r\n      myX++\r\n\r\n    ?lastPlayerZ < pos.z\r\n      lastPlayerZ++\r\n    :?lastPlayerZ > pos.z\r\n      lastPlayerZ--\r\n\r\n  :?currentState = stateLand\r\n    ShowChick(3)\r\n    ?!cland.playing\r\n      cland.Play()\r\n    :\r\n      ?cland.frame < 3\r\n        MakeNoise(4)\r\n        ?myX < minDistance\r\n          myX++\r\n      ?cland.frame = 3\r\n        currentState = stateIdle\r\n\r\n    waitDist = waitDistMin + rng %\r\n     ^(waitDistMax - waitDistMin + 1)   \r\n\r\n  myX = myX - (pos.x - lastPlayerX)\r\n  stateTime++\r\n  lastPlayerX = pos.x\r\n  MoveChick(myX,myZ)\r\n//\r\n\r\n\r\n//*******************************\r\n// Drawing Code \r\n//*******************************\r\n\r\n//?loc.begin | loc.loop\r\n//  DrawEgg()\r\n//  DrawChick()\r\n\r\nAnimateChick()\r\n\r\n//*******************************\r\n// End of File\r\n//*******************************"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Infected.txt" - Parse error: Failed to parse completely. Remaining: "?foe=＂ant＂\r\n  >f-1,0,#rainFF,@Zom@\r\n>o-10,2,#565656,ascii\r\n/\\\r\n`´\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Portobello.txt" - Parse error: Failed to parse completely. Remaining: "= ［ascii\r\n###################\r\n##•´¯¯¯¯¯¯¯¯¯¯¯`•##\r\n#(_______________)#\r\n######|     |######\r\n######|  o o|######\r\n######\\_###_/######\r\nasciiend,ascii\r\n#########___……_####\r\n# _…——´¯¯      `•##\r\n,´      ____……——'##\r\nL…——T¯¯¯   \\#######\r\n#####\\   ò ó|######\r\n######\\_###_|######\r\nasciiend,ascii\r\n##############-…_##\r\n##•´¯¯¯¯¯¯¯¯¯¯¯¯`•#\r\n#(´      _________)\r\n#L…———/¯¯    |##.´#\r\n######|  > < /#####\r\n######\\_###_/######\r\nasciiend,ascii\r\n###################\r\n##•´¯¯¯¯¯¯¯¯¯¯¯`•##\r\n#(_______________)#\r\n######|     |######\r\n######|  > <|######\r\n######\\_###_/######\r\nasciiend］\r\nvar portobellofeet = ［ascii\r\n __\r\nU#U\r\nasciiend,ascii\r\n_ _\r\n#ö#\r\nasciiend,ascii\r\n__ \r\nU#U\r\nasciiend,ascii\r\n_ _\r\n#U#\r\nasciiend］\r\n\r\nvar feetcycle = 0\r\nvar feetcycletime = 0\r\nvar feetdelay\r\nvar headstate = 0\r\nvar righthold = 0\r\nvar righttimer = 0\r\n\r\n?ai.walking\r\n  ?item.right = towering & item.left ! triskel\r\n    feetdelay = 12\r\n  :?item.right = triskel | item.left = triskel\r\n  ^& item.right ! towering\r\n    feetdelay = 6\r\n  :\r\n    feetdelay = 9\r\n  feetcycletime++\r\n  ?feetcycletime > feetdelay\r\n    ?player.direction = 1\r\n      feetcycle++\r\n      ?feetcycle = 4\r\n        feetcycle = 0\r\n    :\r\n      feetcycle--\r\n      ?feetcycle = -1\r\n        feetcycle = 3\r\n    feetcycletime = 0\r\n\r\n?righthold = item.right.state\r\n  righttimer++\r\n:\r\n  righttimer = 0\r\n\r\n?item.left.state > item.right.state |\r\n^righttimer > 5 & item.left.state >= 1\r\n  headstate = item.left.state\r\n:\r\n  headstate = item.right.state\r\n  righthold = item.right.state\r\n\r\ndisable player\r\n\r\n>o-10,-3,@portobellohead［headstate-1］@\r\n>o-2,2,@portobellofeet［feetcycle］@\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/ChristmasTree.txt" - Parse error: Failed to parse completely. Remaining: "= #FF0000\r\nvar tclr = #00AA00\r\nvar lclr = #rainFF\r\nvar bttm = pot\r\nvar bclr = #8B4513\r\n\r\n//*******************************\r\n// Functions\r\n//*******************************\r\n\r\nfunc DrawColCanvas(parent,params)\r\n  ?loc.begin | loc.loop\r\n    var c = ui.AddCanvas()\r\n    c.anchor = params[1]\r\n    c.dock = params[2]\r\n    c.x = params[3]\r\n    c.y = params[4]\r\n    c.w = params[5]\r\n    c.h = params[6]\r\n    c.visible = params[7]\r\n    c.blend = params[8]\r\n    c.SetFG(params[9])\r\n    c.SetBG(params[10])\r\n    parent.Add(c)\r\n    params[0] = c\r\n    return c\r\n  return params[0]\r\n//\r\n\r\n//*******************************\r\n// Main Code\r\n//*******************************\r\n\r\n?loc.begin | loc.loop\r\n  lvl = loc\r\n  tx = pos.x - 7\r\n\r\n  ?lvl = rocky_plateau\r\n    ty = 24\r\n    bttm = trunk\r\n    bclr = #8B4513\r\n  :?lvl = deadwood_valley\r\n    ty = 21\r\n    tclr = #999999\r\n    bttm = roots\r\n    bclr = #555555\r\n  :?lvl = caustic_caves\r\n    ty = 21\r\n    bttm = roots\r\n    bclr = #555555\r\n  :?lvl = waterfall\r\n    ty = 20\r\n  :?lvl = fungus_forest\r\n    ty = 20\r\n    bttm = trunk\r\n    bclr = #8B4513\r\n  :?lvl = undead_crypt_intro\r\n    ty = 20\r\n    syo = -14\r\n    bttm = trunk\r\n    bclr = #555555\r\n  :?lvl = undead_crypt\r\n    ty = 22\r\n    tclr = #FF00FF\r\n    lclr = #FFAA00\r\n    bttm = fog\r\n    bclr = #555555\r\n  :?lvl = cross_deadwood_river\r\n    ty = 20\r\n  :?lvl = bronze_mine\r\n    ty = 20\r\n    bttm = pot\r\n    bclr = #8B4513\r\n  :?lvl = icy_ridge\r\n    ty = 23\r\n    tclr = #white\r\n    bttm = trunk\r\n    bclr = #8B4513\r\n  :?lvl = cross_bridge\r\n    ty = 20\r\n  :?lvl = temple\r\n    ty = 24\r\n    bttm = pot\r\n    bclr = #555555//8B4513\r\n  \r\nvar scnv \r\nvar scnv_params = [\r\nscnv,\r\ntop_left,top_left,\r\n0,0,5,3,\r\ntrue,multiply,\r\n@sclr@,#010101]\r\n\r\nscnv = DrawColCanvas(\r\n       ^ui.root,scnv_params)\r\n\r\n?sx >= 0\r\n  rx = tx - pos.x\r\n  ry = ty - pos.z\r\n\r\n  sx = screen.FromWorldX(tx)+sxo\r\n  sy = screen.FromWorldZ(ty)+syo\r\n\r\n  scnv.x = sx\r\n  scnv.y = sy\r\n  scnv.SetFG(sclr)\r\n\r\n  >o@rx-4@,@ry-12@,@tclr@,@tree@\r\n  >o@rx-4@,@ry-12@,#rainFF,@star@\r\n  >o@rx-4@,@ry-8@,@lclr@,@lights@\r\n  >o@rx-4@,@ry-3@,@bclr@,@bttm@\r\n  /*\r\n  >`0,1,#green,tx: @tx@\r\n  >`0,2,#green,ty: @ty@\r\n\r\n  >`0,3,#green,rx: @rx@\r\n  >`0,4,#green,ry: @ry@\r\n\r\n  >`0,5,#green,sx: @sx@\r\n  >`0,6,#green,sy: @sy@\r\n  */\r\n:?sx > -5\r\n  scnv.Recycle()\r\n\r\n//*******************************\r\n// End of File\r\n//*******************************\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/MushroomHead.txt" - Parse error: Failed to parse completely. Remaining: "= \"###\"\r\nvar EyePosX = 0\r\nvar EyePosZ = 0\r\n//changable color values\r\n var EyeColor = #white\r\n var MushColor = #rainff\r\n?(item.right.state ! 1 & item.right.state ! 4)|(item.left.state ! 1 & item.left.state ! 4 & item.left.state ! -1)\r\n  EyeBrows = \"\\ /\"\r\n:\r\n  EyeBrows = \"   \"\r\n?item.left.state = -1\r\n ?item.right = vigor\r\n  LeftEye = ❤\r\n  RightEye = ❤\r\n :?item.right = poison\r\n  LeftEye = ∞\r\n  RightEye = ∞\r\n :?item.right = ice\r\n  LeftEye = ❄\r\n  RightEye = ❄\r\n :?item.right = fire\r\n  LeftEye = φ\r\n  RightEye = φ\r\n :?item.right = aether\r\n  LeftEye = \"*\"\r\n  RightEye = \"*\"\r\n :\r\n  LeftEye = o\r\n  RightEye = o\r\n:\r\n ?item.right = vigor\r\n  RightEye = ❤\r\n :?item.right = poison\r\n  RightEye = ∞\r\n :?item.right = ice\r\n  RightEye = ❄\r\n :?item.right = fire\r\n  RightEye = φ\r\n :?item.right = aether\r\n  RightEye = \"*\"\r\n :?item.right = quest\r\n  RightEye = \"!\"\r\n :?item.right = star\r\n  RightEye = \"☆\"\r\n :?item.right = ki\r\n  RightEye = \"@\"\r\n :\r\n  RightEye = o\r\n ?item.left = vigor\r\n  LeftEye = ❤\r\n :?item.left = poison\r\n  LeftEye = ∞\r\n :?item.left = ice\r\n  LeftEye = ❄\r\n :?item.left = fire\r\n  LeftEye = φ\r\n :?item.left = aether\r\n  LeftEye = \"*\"\r\n :?item.left = quest\r\n  LeftEye = \"!\"\r\n :?item.left = star\r\n  LeftEye = \"☆\"\r\n :?item.left = ki\r\n  LeftEye = \"@\"\r\n :\r\n  LeftEye = o\r\nfunc SetState(newState)\r\n\r\n  currentState = newState\r\n  stateTime = 0\r\n\r\n\r\n?currentState = stateNone | time = 1\r\n  lastPlayerX = pos.x\r\n  lastPlayerZ = pos.z\r\n  myX = keepDistance\r\n  myZ = targetZ\r\n\r\n  // Start further away if the frog is summoned while the location is already running\r\n  ?time > 1\r\n    myX = maxDistance\r\n\r\n  SetState(stateIdle)\r\n\r\n\r\nmyX = myX - (pos.x - lastPlayerX)\r\n\r\nstateTime++\r\n\r\n?currentState = stateIdle\r\n  ?myX < maxDistance | myX > -maxDistance\r\n    myX = maxDistance\r\n  myZ = myZ - (pos.z - lastPlayerZ)\r\n\r\n  ?myX < keepDistance\r\n    SetState(stateJump)\r\n\r\n:?currentState = stateJump\r\n  ?myX < maxX\r\n    myX++\r\n\r\n  ?stateTime >= 6\r\n    ?myZ > targetZ\r\n      myZ--\r\n    :?myZ < targetZ\r\n      myZ++\r\n\r\n  ?stateTime >= 12\r\n    SetState(stateIdle)\r\n\r\n\r\nlastPlayerX = pos.x\r\nlastPlayerZ = pos.z\r\n\r\n// Draw\r\n/*\r\n☆☺ʘ❤♦♣♠•◘⏹◙♂♀♪♫☼\r\n⚿œ§≠¿↑↓→←▲▼▶◀_-¯\r\n«»™!＂#$%&'()*+,\r\n［］^`´.\\/|0123456\r\n789:;<=>?@ABCDEF\r\nGHIJKLMNOPQRSTU\r\nVWZ abcdefghijkl\r\nmnopqrstuvwxyz\r\nÇüéâäàåçêëèïîìÄÅ\r\nÉæÆôöòûùýÖÜ€£￥₩ÀÁ\r\náíóúñÑãõζηξλψέρι\r\nαβγπΣσμτΦΘΩδ∞φεω\r\n≡±≥≤÷≈°…·†☤∆❄┊\r\n╓ ╖╒ ╕╔ ╗┌ ┐╥ ╤\r\n║ ╟┤ ├╢ ╠╡ ╞╬ ╪ \r\n╙ ╜╘ ╛╚ ╝└ ┘╨ ╧\r\n╦ ═ ┬ ║\r\n╫ ─ ┼ ╣ ⌐ ¬\r\n╩ ═ ┴ │ ░▒▓█▄▀\r\n*/\r\n?currentState = stateIdle\r\n  >o@myX+10@,@myZ-3@,@MushColor@,ascii\r\n#\r\n#\r\n#\r\n####.^.\r\n###/.'.\\\r\n##(' \" ')\r\n##`|# #|´\r\n###|_─_|\r\n#####¯\r\nasciiend\r\n  >o@myX+14@,@myZ+3@,@LeftEye@ @RightEye@\r\n  >o@myX+14@,@myZ+2@,#red,@EyeBrows@\r\n  x = myX + 5\r\n  y = myZ + 2\r\n\r\n  ?face = \"°°\"\r\n    ?time % 10 = 0 & myX > keepDistance\r\n      myX--\r\n\r\n    \r\n?currentState = stateJump\r\n  ?stateTime/2 = 0\r\n    >o@myX+10@,@myZ-3@,@MushColor@,ascii\r\n#\r\n#\r\n####.^.\r\n###/.'.\\\r\n##(' \" ')\r\n##`|# #|´\r\n###| ─ |\r\n###'───'\r\nasciiend\r\n    >o@myX+14@,@myZ+2@,@LeftEye@ @RightEye@\r\n    >o@myX+14@,@myZ+1@,#red,@EyeBrows@\r\n  :?stateTime/2 = 1\r\n    >o@myX+10@,@myZ-3@,@MushColor@,ascii\r\n#\r\n####.^.\r\n###/.'.\\\r\n##(' \" ')\r\n##`|# #|´\r\n###| ─ |\r\n###'───'\r\nasciiend\r\n   >o@myX+14@,@myZ+1@,@LeftEye@ @RightEye@\r\n   >o@myX+14@,@myZ@,#red,@EyeBrows@\r\n  :?stateTime/2 = 2\r\n    >o@myX+10@,@myZ-3@,@MushColor@,ascii\r\n####.^.\r\n###/.'.\\\r\n##(' \" ')\r\n##`|# #|´\r\n###| ─ |\r\n###'───'\r\nasciiend\r\n   >o@myX+14@,@myZ@,@LeftEye@ @RightEye@\r\n   >o@myX+14@,@myZ-1@,#red,@EyeBrows@\r\n  :?stateTime/2 = 3\r\n    >o@myX+10@,@myZ-3@,@MushColor@,ascii\r\n####.^.\r\n###/.'.\\\r\n##(' \" ')\r\n##`|# #|´\r\n###| ─ |\r\n###'¯¯¯'\r\nasciiend\r\n   >o@myX+14@,@myZ@,@LeftEye@ @RightEye@\r\n   >o@myX+14@,@myZ-1@,#red,@EyeBrows@\r\n  :?stateTime/2 = 4\r\n    >o@myX+10@,@myZ-3@,@MushColor@,ascii\r\n#\r\n####.^.\r\n###/.'.\\\r\n##(' \" ')\r\n##`|# #|´\r\n###|_─_|\r\n#####¯\r\nasciiend\r\n   >o@myX+14@,@myZ+1@,@LeftEye@ @RightEye@\r\n   >o@myX+14@,@myZ@,#red,@EyeBrows@\r\n  :?stateTime/2 = 5\r\n    >o@myX+10@,@myZ-3@,@MushColor@,ascii\r\n#\r\n#\r\n####.^.\r\n###/.'.\\\r\n##(' \" ')\r\n##`|# #|´\r\n###|_─_|\r\n#####¯\r\nasciiend\r\n   >o@myX+14@,@myZ+2@,@LeftEye@ @RightEye@\r\n   >o@myX+14@,@myZ+1@,#red,@EyeBrows@\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetSun.txt" - Parse error: Failed to parse completely. Remaining: "= #FFDD00\r\nvar sunstrobe = 40\r\nvar sunalert  = 10\r\nvar sundistx  = -16\r\nvar sundisty  = -10\r\nvar sunsizex  = 3\r\nvar sunsizey  = 2\r\n\r\n//*******************************\r\n// Global Variables\r\n//*******************************\r\n\r\nvar initialized = null\r\nvar sunpnl = null\r\nvar sunanim = null\r\nvar suntext = null\r\nvar x = 0\r\nvar y = 0\r\nvar currx = -50\r\nvar sinx = 0\r\nvar lastPlayerZ = -20\r\nvar modx = 4\r\nvar mody = 2\r\n\r\n\r\n//*******************************\r\n// ASCII Art\r\n//*******************************\r\n\r\nvar sunpet = ascii\r\n\r\n###.-.\r\n##{ ''}\r\n###`-´\r\n\r\n%%\r\n####.\r\n##·.-.·\r\n#<{ ''}>\r\n##·`-´·\r\n####'\r\n%%\r\n#__#.#__\r\n#\\·.-.·/\r\n#<{ ''}>\r\n#/·`-´·\\\r\n#¯¯#'#¯¯\r\n%%\r\n#__.▲.__\r\n#\\·.-.·/\r\n<:{ ''}:>\r\n#/·`-´·\\\r\n#¯¯'▼'¯¯\r\n%%\r\n#__.▲.__\r\n#\\·.-.·/\r\n◀:{ ''}:▶\r\n#/·`-´·\\\r\n#¯¯'▼'¯¯\r\n%%\r\n###.▲.\r\n#'#.-.#'\r\n◀:{ ''}:▶\r\n#.#`-´#.\r\n###'▼'\r\n%%\r\n###.#.\r\n###.-.\r\n·#{ ''}#·\r\n###`-´\r\n###'#'\r\nasciiend\r\n\r\nvar custstyle = ui.AddStyle(\"\r\n^###\r\n^###\r\n^###\")\r\n\r\n//*******************************\r\n// Functions\r\n//*******************************\r\n\r\n//*******************************\r\n// DrawSun()\r\n//\r\n// Creates the panel and \r\n// animation for the pet\r\n// sun art\r\n//\r\n//*******************************\r\nfunc DrawSun()\r\n  sunpnl = ui.AddPanel()\r\n  sunpnl.style = custstyle\r\n  sunpnl.anchor = top_left\r\n  sunpnl.dock = top_left\r\n  sunpnl.x = -20\r\n  sunpnl.y = -10\r\n  sunpnl.w = 9\r\n  sunpnl.h = 5\r\n  \r\n  sunanim = ui.AddAnim(sunpet)\r\n  sunanim.anchor = center_center\r\n  sunanim.dock = center_center\r\n  sunanim.loop = true\r\n  sunanim.duration = sunstrobe\r\n  sunanim.color = suncolor \r\n  sunanim.Play()\r\n\r\n  suntext = ui.AddText()\r\n  suntext.anchor = center_center\r\n  suntext.dock = center_center\r\n  suntext.w = 3\r\n  suntext.h = 1\r\n  suntext.text = \" ''\"\r\n\r\n  sunpnl.Add(sunanim)\r\n  sunpnl.Add(suntext)\r\n//\r\n\r\n//*******************************\r\n// MoveSun()\r\n//\r\n// Updates the pet sun panel\r\n// with new x/y coordinates \r\n// converting them from the \r\n// world to screen positions for\r\n// use with the sun panel. Also,\r\n// updates sun's expression in \r\n// response to player's facial\r\n// expression.\r\n//\r\n//*******************************\r\nfunc MoveSun()\r\n\r\n  y = math.RoundToInt(sunsizey*math.Cos(\r\n             ^math.ToRad(totaltime)*mody))\r\n  \r\n  ?lastPlayerZ+2 < pos.z\r\n    lastPlayerZ++\r\n  :?lastPlayerZ-2 > pos.z\r\n    lastPlayerZ--\r\n\r\n  sunpnl.y = y+screen.FromWorldZ(lastPlayerZ)\r\n             ^+ sundisty\r\n\r\n\r\n  ?currx + 1 < pos.x\r\n    currx++\r\n\r\n  ?!ai.walking\r\n    x = math.RoundToInt(sunsizex*math.Sin(\r\n             ^math.ToRad(totaltime)*modx))\r\n    ?sinx < x\r\n      sinx = sinx + 0.1\r\n    :?sinx > x\r\n      sinx = sinx - 0.1\r\n    \r\n  sunpnl.x = math.RoundToInt(sinx)+\r\n             ^screen.FromWorldX(currx)\r\n             ^+ sundistx\r\n    \r\n\r\n  ?face = \"°°\"\r\n    suntext.text = \" °°\"\r\n    sunanim.duration = sunalert\r\n  :?face = \"^^\"\r\n    suntext.text = \" ^^\"\r\n    sunanim.duration = sunalert\r\n  : \r\n    suntext.text = \" ''\"\r\n    sunanim.duration = sunstrobe\r\n//\r\n\r\n\r\n//*******************************\r\n// Drawing Code \r\n//*******************************\r\n\r\n?totaltime <= 1\r\n  DrawSun()\r\n  currx = -50\r\n:\r\n  MoveSun()\r\n\r\n//*******************************\r\n// End of File\r\n//*******************************"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/SuperStoneHead.txt" - Parse error: Failed to parse completely. Remaining: "*#*\r\nasciiend\r\n\r\n>(          \r\n\r\n>h-4,-3,#yellow,ascii\r\n,%\\\\_\r\n\\_/\\\\\\_\r\n\\:\\\\|｝/L-\r\n＂,,'#####\r\nasciiend\r\n\r\nvar frames_each = 5\r\n?time / frames_each % 5 = 0\r\n  >h-6,-5,#yellow,ascii\r\n####/~~\\\\###/un\r\n#|\\/####\\|  //\r\n｛|/_#####\\|\r\n|/#######_\\|\\\r\nT|/########\\| // \r\n||#########_|/\r\n/\\_########|/\r\n\\\\##########/|\r\n##\\\\#####_//\r\n####————-/\\\r\nasciiend\r\n\r\n\r\n?time / frames_each % 5 = 1\r\n  >h-6,-5,#cyan,ascii\r\n#::#/~~\\\\###/###｛\r\n#l\\/####\\|# /####｝\r\n\\;｛_#####\\|####｛\r\n//#######_\\l####［\r\n#|/#######\\|###|\r\n||_#########|/###%\r\n(|#########_|/###\\\r\n\\\\_#########/|\r\n/\\\\\\#####_//###•\r\n####—_——-/\r\nasciiend\r\n\r\n?time / frames_each % 5 = 2\r\n  >h-6,-5,#yellow,ascii\r\n####/~~\\\\###/###/\r\n##\\/####\\\\  /####｝\r\n|/(_####_\\\\####\\\r\n//########\\/\\###｛\r\n#|/########\\|>\r\n||#######\\#_|/\r\n｛|_#########|/\r\n\\\\#########_/|##•\r\n##\\\\_####_//###*\r\n####—|——-/\\/\\/\r\nasciiend\r\n\r\n?time / frames_each % 5 = 3\r\n  >h-6,-5,#blue,ascii\r\n#\\/\\/~~\\\\###/\r\n##\\/####\\\\  /\r\n///######\\\\\r\n//_#######\\\\\r\n#|/#######_\\|\r\n||###_######|/\\/\\\r\n||_#########|/##*\r\n\\\\##########/|##.\r\n##\\\\#####_//\r\n####————-/\r\nasciiend\r\n\r\n?time / frames_each % 5 = 4\r\n  >h-6,-4,#FF3509,ascii\r\n#\\/\\/~~\\\\###/\r\n｛｝\\/##_#\\\\  /\r\n///######\\\\\r\n//#######_\\\\\r\n#|/########\\|\r\n||##########|/\\/\\\r\n||~#_#######|/\r\n\\\\##########/|\r\n##\\\\##-##_//\r\n-/:#————-/\r\nasciiend\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/MineManager.txt" - Parse error: Failed to parse completely. Remaining: "#__\r\n)_#\\#\r\nasciiend\r\n\r\n?mount = 6\r\n >`2,26,#red,ascii\r\nO#:@hp@/@maxhp@\r\nasciiend\r\n\r\n?mount = 6\r\n >`0,21,#red,ascii\r\n┌————┐\r\n│    │\r\n│    │\r\n└————┘\r\nasciiend\r\n\r\n?mount = 6 &\r\n^item.right.state < 2\r\n >`1,22,#white,ascii\r\n#o\r\n#|‾T\r\nasciiend\r\n:?mount = 6\r\n >`1,22,#white,ascii\r\n#o\r\n#|\\_\r\nasciiend\r\n\r\n?mount = 6 &\r\n^item.left.state < 2\r\n >`1,23,#white,ascii\r\n‾\r\nasciiend\r\n:?mount = 6\r\n >`1,23,#white,ascii\r\n/\r\nasciiend\r\n\r\n?mount = 6 &\r\n^item.left.state = 1 |\r\n^mount = 6 &\r\n^item.left.state = -1\r\n >o1,-1,#C8C7C5,ascii\r\n##//\r\n#//\r\n#\\\\\r\n#/|\\\r\n#\\v/\r\nasciiend\r\n\r\n?mount = 6 &\r\n^item.left.state = 1 &\r\n^item.left.time < 3\r\n >o1,-1,#cyan,ascii\r\n##//\r\n#//\r\n#\\\\\r\n#/|\\\r\n#\\v/\r\nasciiend\r\n\r\n?mount = 6 &\r\n^item.left.state = 2\r\n >o1,-2,#C8C7C5,ascii\r\n######/‾\\\r\n##//#/—-•\r\n##\\\\//\\_/\r\n###‾‾\r\nasciiend\r\n\r\n?mount = 6 &\r\n^item.left.state = 3\r\n play mine_walker_attack_a 100\r\n >o1,-2,#C8C7C5,ascii\r\n######___\r\n##//#/———:\r\n##\\\\//‾‾‾\r\n###‾‾\r\nasciiend\r\n\r\n?mount = 6 &\r\n^item.left.state = 4\r\n play mine_walker_attack_b 100\r\n >o1,-2,#cyan,ascii\r\n######___\r\n##//#/———:\r\n##\\\\//‾‾‾\r\n###‾‾\r\nasciiend\r\n\r\n?mount = 6\r\n >o-6,-4,#white,ascii\r\n###_,—-.___\r\n##_\\       \\\r\n#| |)       \\\r\n#|_/_________|\r\nasciiend\r\n\r\n?mount = 6\r\n play wand_fire_cast 100\r\n >o-4,0,#FF9C00,ascii\r\nVV\r\nasciiend\r\n\r\n?mount = 6 &\r\n^time % 10 < 5\r\n >o-4,0,#FF9C00,ascii\r\nVV\r\nvv\r\nasciiend\r\n\r\n?mount = 6 &\r\n^time % 300 > 7\r\n >o2,-3,#red,ascii\r\n#_\r\n(_)\r\nasciiend\r\n\r\n?mount = 6 &\r\n^time % 300 <= 7\r\n >o2,-2,#red,ascii\r\n———\r\nasciiend\r\n\r\n?mount = 6 &\r\n^item.right.state = 1 |\r\n^mount = 6 &\r\n^item.right.state = -1\r\n >o-3,-1,#white,ascii\r\n##//\r\n#//\r\n#\\\\\r\n#/|\\\r\n#\\v/\r\nasciiend\r\n\r\n?mount = 6 &\r\n^item.right.state = 1 &\r\n^item.right.time < 3\r\n >o-3,-1,#cyan,ascii\r\n##//\r\n#//\r\n#\\\\\r\n#/|\\\r\n#\\v/\r\nasciiend\r\n\r\n?mount = 6 &\r\n^item.right.state = 2\r\n >o-3,-2,#white,ascii\r\n######/‾\\\r\n##//#/—-•\r\n##\\\\//\\_/\r\n###‾‾\r\nasciiend\r\n\r\n?mount = 6 &\r\n^item.right.state = 3\r\n play mine_walker_attack_a 100\r\n >o-3,-2,#white,ascii\r\n######___\r\n##//#/———:\r\n##\\\\//‾‾‾\r\n###‾‾\r\nasciiend\r\n\r\n?mount = 6 &\r\n^item.right.state = 4\r\n play mine_walker_attack_b 100\r\n >o-3,-2,#cyan,ascii\r\n######___\r\n##//#/———:\r\n##\\\\//‾‾‾\r\n###‾‾\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PumpkinCarving.txt" - Parse error: Failed to parse completely. Remaining: "= [\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,2,3,2,0,0,0,0,0,2,3,2,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,2,3,1,3,2,0,0,0,2,3,1,3,2,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,1,3,2,2,2,0,2,2,2,0,2,2,2,3,1,0,0,0,0,0,\r\n0,0,0,0,0,0,0,1,3,1,3,3,3,3,3,3,3,1,3,1,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]\r\n\r\nvar frowningpumpkin = [\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,2,3,2,0,1,2,0,2,1,0,2,3,2,0,0,0,0,0,0,\r\n0,0,0,0,0,0,2,3,1,3,2,0,0,0,0,0,2,3,1,3,2,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,0,0,2,3,2,0,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,2,2,0,2,2,0,2,2,0,2,2,0,2,2,0,2,2,0,0,0,0,\r\n0,0,0,0,3,3,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,3,3,0,0,0,\r\n0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\r\n0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]\r\n\r\nvar lightarray = [\r\n12,12,12,12,11,10,9,8,7,7,7,7,7,7,7,7,7,7,8,9,10,11,12,12,12,12,\r\n12,12,12,11,10, 9,8,7,6,6,6,6,6,6,6,6,6,6,7,8, 9,10,11,12,12,12,\r\n12,12,11,10, 9, 8,7,6,5,5,5,5,5,5,5,5,5,5,6,7, 8, 9,10,11,12,12,\r\n12,11,10, 9, 8, 7,6,5,4,4,4,4,4,4,4,4,4,4,5,6, 7, 8, 9,10,11,12,\r\n11,10, 9, 8, 7, 6,5,4,4,3,3,3,3,3,3,3,3,4,4,5, 6, 7, 8, 9,10,11,\r\n11,10, 9, 8, 7, 6,5,4,3,3,2,2,2,2,2,2,3,3,4,5, 6, 7, 8, 9,10,11,\r\n11,10, 9, 8, 7, 6,5,4,3,2,2,1,1,1,1,2,2,3,4,5, 6, 7, 8, 9,10,11,\r\n11,10, 9, 8, 7, 6,5,4,3,2,1,0,0,0,0,1,2,3,4,5, 6, 7, 8, 9,10,11,\r\n11,10, 9, 8, 7, 6,5,4,3,2,1,0,0,0,0,1,2,3,4,5, 6, 7, 8, 9,10,11,\r\n12,11,10, 9, 8, 7,6,5,4,3,2,1,1,1,1,2,3,4,5,6, 7, 8, 9,10,11,12,\r\n12,12,11,10, 9, 8,7,6,5,4,3,2,2,2,2,3,4,5,6,7, 8, 9,10,11,12,12]\r\n\r\nvar colorarray = [\r\n#FFFFFF,\r\n#EEEEEE,\r\n#DDDDDD,\r\n#CCCCCC,\r\n#BBBBBB,\r\n#AAAAAA,\r\n#999999,\r\n#888888,\r\n#777777,\r\n#666666,\r\n#555555,\r\n#444444,\r\n#333333]\r\n\r\nvar pumpkin = ascii\r\n############,ý\r\n######__,.…/ζι…._#__\r\n##.─-´/´  ;   \\  ¯`\\`-.\r\n#/   ,   :     ;   ¡   \\\r\n¡    |   ;     |   │    ¡\r\n|    ┊   ║     |   |    |\r\n║    :   |     ;   ┊    ║\r\n!    |   !     ┊   |    !\r\n#\\   '   ·     ,   ,   /\r\n##'._,\\._,\\___/__,/._,'\r\nasciiend\r\n\r\nvar pixelart = ascii\r\n\r\n%%\r\n▀\r\n%%\r\n▄\r\n%%\r\n█\r\nasciiend\r\n\r\nvar tileart = ascii\r\n\r\n\r\n%%\r\n██\r\n\r\n%%\r\n\r\n██\r\n%%\r\n██\r\n██\r\nasciiend\r\n\r\nvar squareart = ascii\r\n┌┐\r\n└┘\r\nasciiend\r\n\r\nvar tooltop = ui.AddStyle(＂\r\n^┌─┐\r\n^│#│\r\n^├─┤＂)\r\n\r\nvar toolmid = ui.AddStyle(＂\r\n^├─┤\r\n^│#│\r\n^├─┤＂)\r\n\r\nvar toolbot = ui.AddStyle(＂\r\n^├─┤\r\n^│#│\r\n^└─┘＂)\r\n\r\nvar transparent = ui.AddStyle(＂\r\n^###\r\n^###\r\n^###＂)\r\n\r\nvar toolstyle = [tooltop,toolmid,toolmid,toolbot]\r\nvar tileswidth  = 25\r\nvar tilesheight = 10\r\n\r\nvar tiles = ［］\r\nvar pixels = []\r\nvar tools = []\r\n\r\n//Main Window Variables\r\nvar carvepanel = null\r\nvar tilespanel = null\r\nvar imagepanel = null\r\nvar toolspanel = null\r\nvar imageinitx = 0\r\nvar toolstate = 3\r\nvar toggletilesbtn = null\r\nvar toggleimagebtn = null\r\nvar togglesavebtn = null\r\nvar creatorstate = 0\r\n\r\n//Save Panel Variables\r\nvar default = 0\r\nvar filetooltexts = [\"→⚿\",\"⚿→\",\"⚿X\",\"⚿*\"]\r\nvar savepanel = null\r\nvar savearray = []\r\nvar filebuttons = []\r\nvar activefiletool = null\r\nvar activefile    = null\r\nvar cancelbutton  = null\r\nvar confirmbutton = null\r\nvar toolselectedpanel = null\r\nvar fileselectedpanel = null\r\nvar toolselectedtext = null\r\nvar fileselectedtext = null\r\nvar arrowtext = null\r\nvar files = []\r\nvar saves = []\r\n\r\nvar carvingdisabled = [\r\n\"mushroom_shop\",\r\n\"uulaa_shop\",\r\n\"cross_deadwood_river\",\r\n\"bronze_gate\",\r\n\"cross_bridge\"]\r\n\r\nvar initialize = 0\r\n\r\n\r\n//*******************************\r\n// Functions\r\n//*******************************\r\n\r\nfunc SetDimensions(component,anchor,dock,x,y,w,h)\r\n  component.anchor = anchor\r\n  component.dock = dock\r\n  component.x = x\r\n  component.y = y\r\n  component.w = w\r\n  component.h = h\r\n//\r\n\r\nfunc CheckLocation()\r\n  var lvl = loc.id\r\n\r\n  for i=0..carvingdisabled.Count()-1\r\n    ?lvl = carvingdisabled[i]\r\n      initialize = -1\r\n      return\r\n//\r\n\r\nfunc SetPosition(x,y)\r\n  pumpkinoriginx = x\r\n  pumpkinoriginy = y\r\n//\r\n\r\nfunc DrawTile(parent,x,y)\r\n  var p = null\r\n  var a = null\r\n  var b = null\r\n  var t = null\r\n  var tile = ［\r\n    0,     //state\r\n    null,  //panel id\r\n    null,  //anim id\r\n    null,  //button id\r\n    null]  //text id\r\n\r\n  p = ui.AddPanel()\r\n  p.anchor = top_left\r\n  p.dock = top_left\r\n  p.x = x\r\n  p.y = y\r\n  p.w = 2\r\n  p.h = 2\r\n  p.style = transparent\r\n  p.color = #555555\r\n  parent.Add(p)\r\n\r\n  a = ui.AddAnim(squareart)\r\n  a.w = 2\r\n  a.h = 2\r\n  a.visible = inherit\r\n  a.color = #555555\r\n  p.Add(a)\r\n  \r\n  a = ui.AddAnim(tileart)\r\n  a.w = 2\r\n  a.h = 2\r\n  a.visible = inherit\r\n  a.frame = 0\r\n  p.Add(a)\r\n\r\n  b = ui.AddButton()\r\n  b.w = 2\r\n  b.h = 2\r\n  b.style = transparent \r\n  b.text = ＂#＂\r\n  b.hcolor = #FFFFFF\r\n  b.SetPressed(ClickTile)\r\n  p.Add(b)\r\n\r\n  t = ui.AddText()\r\n  t.w = 1\r\n  t.h = 1\r\n  t.text = \"0\"\r\n  t.visible = false\r\n  p.Add(t)\r\n \r\n  tile［0］ = 0\r\n  tile［1］ = p\r\n  tile［2］ = a\r\n  tile［3］ = b\r\n  tile[4] = t\r\n\r\n  return tile\r\n//\r\n  \r\nfunc DrawPixel(parent,x,y)\r\n  var a = null\r\n \r\n  a = ui.AddAnim(pixelart)\r\n  a.anchor = top_left\r\n  a.dock = top_left\r\n  a.x = x\r\n  a.y = y\r\n  a.visible = inherit\r\n  a.frame = 0\r\n  parent.Add(a)\r\n  \r\n  return a\r\n//\r\n\r\nfunc DrawPumpkinCarving()\r\n  var p = null\r\n  var b = null\r\n\r\n  p = ui.AddPanel()\r\n  SetDimensions(p,top_left,top_left,\r\n               ^-(((tileswidth+2)*2)+4),1,\r\n               ^((tileswidth+2)*2)+4,(tilesheight+2)*2)\r\n  p.style = 0\r\n  carvepanel = p\r\n\r\n  //Draw Tiles\r\n  tilespanel = ui.AddPanel()\r\n  SetDimensions(tilespanel,top_left,top_left,4,0,\r\n               ^(tileswidth+2)*2,(tilesheight+2)*2)\r\n  carvepanel.Add(tilespanel)  \r\n\r\n  var temp = null\r\n\r\n  for i=0..tilesheight\r\n    for j=0..tileswidth\r\n      temp = DrawTile(tilespanel,1+j*2,1+i*2)\r\n      tiles.Add(temp)\r\n\r\n  //Draw Tools\r\n  toolspanel = ui.AddPanel()\r\n  SetDimensions(toolspanel,top_left,top_left,\r\n               ^0,0,4,13)\r\n  carvepanel.Add(toolspanel)\r\n  toolspanel.color = #555555\r\n\r\n  var temp = null\r\n\r\n  for i=0..3\r\n    temp = DrawTile(toolspanel,0,i*3)\r\n    temp[0] = i\r\n    temp[1].w = 4\r\n    temp[1].h = 4\r\n    temp[4].text = \"\" + i\r\n    temp[2].frame = i\r\n    tools.Add(temp)\r\n\r\n  tools[toolstate][1].color = #FFFFFF\r\n  tools[toolstate][1].style = toolstyle[toolstate]\r\n\r\n  //Draw Menu\r\n  b = ui.AddButton()\r\n  SetDimensions(b,top_left,top_left,\r\n               ^0,22,4,3)\r\n  b.style = 1\r\n  b.text = ＂←─＂\r\n  b.hcolor = #FFFFFF\r\n  b.SetPressed(ToggleTiles)\r\n  toggletilesbtn = b\r\n\r\n  b = ui.AddButton()\r\n  SetDimensions(b,top_left,top_left,\r\n               ^0,13,4,3)\r\n  carvepanel.Add(b)\r\n  b.style = 1\r\n  b.text = ＂<>\"\r\n  b.hcolor = #FFFFFF\r\n  b.SetPressed(ToggleImage)\r\n  toggleimagebtn = b\r\n  \r\n  b = ui.AddButton()\r\n  SetDimensions(b,top_left,top_left,\r\n               ^0,16,4,3)\r\n  carvepanel.Add(b)\r\n  b.style = 1\r\n  b.text = ＂⚿☺\"\r\n  b.hcolor = #FFFFFF\r\n  b.SetPressed(ToggleSavepanel)\r\n  togglesavebtn = b\r\n//\r\n\r\nfunc DrawImage()\r\n  imagepanel = ui.AddPanel()\r\n  SetDimensions(imagepanel,top_left,top_left,\r\n               ^pumpkinoriginx,pumpkinoriginy,\r\n               ^(tileswidth+3),(tilesheight+3))\r\n  imagepanel.visible = inherit\r\n  imagepanel.style = transparent\r\n  imageinitx = screen.ToWorldX(imagepanel.x)  \r\n\r\n  var a = ui.AddAnim(pumpkin)\r\n  a.w = 25\r\n  a.h = 10\r\n  imagepanel.Add(a)\r\n  \r\n  var temp = null\r\n\r\n  for i=0..tilesheight\r\n    for j=0..tileswidth\r\n      temp = DrawPixel(imagepanel,1+j,1+i)\r\n      pixels.Add(temp)    \r\n//\r\n\r\nfunc DrawSavePanel()\r\n  var p = null\r\n  var a = null\r\n  var t = null\r\n  var b = null\r\n  var dash = \"\"\r\n\r\n  p = ui.AddPanel()\r\n  SetDimensions(p, center_center, center_center,\r\n               ^0,0,tilespanel.w,tilespanel.h)\r\n  p.style = 1\r\n  p.visible = false\r\n  savepanel = p\r\n  tilespanel.Add(p)\r\n\r\n  p = ui.AddPanel()\r\n  SetDimensions(p, center_center, center_center,\r\n               ^0,0,tilespanel.w-2,tilespanel.h-2)\r\n  p.style = 1\r\n  savepanel.Add(p)\r\n\r\n  t = ui.AddText()\r\n  SetDimensions(t,center_center,center_center,\r\n               ^1,-2,savepanel.w-2,1)\r\n  savepanel.Add(t)\r\n  t.text = \"\"\r\n  for i=0..(savepanel.w-4)-1\r\n    dash = dash + \"─\"\r\n  t.text = dash\r\n\r\n\r\n  //Dialog Panel\r\n\r\n  var dialogpanel = null\r\n\r\n  p = ui.AddPanel()\r\n  SetDimensions(p,center_center,center_center,\r\n               ^0,4,24,13)\r\n  p.style = transparent\r\n  savepanel.Add(p)\r\n  dialogpanel = p\r\n\r\n\r\n  b = ui.AddButton()\r\n  SetDimensions(b,center_center,center_center,\r\n               ^-9,-4,4,3)\r\n  dialogpanel.Add(b)\r\n  b.style = 1\r\n  b.text = filetooltexts[0] //Save\r\n  b.bcolor = #888888\r\n  b.tcolor = #888888\r\n  b.hcolor = #FFFFFF\r\n  b.SetPressed(SelectFileTool)\r\n  filebuttons.Add(b)\r\n  \r\n  b = ui.AddButton()\r\n  SetDimensions(b,center_center,center_center,\r\n               ^-3,-4,4,3)\r\n  dialogpanel.Add(b)\r\n  b.style = 1\r\n  b.text = filetooltexts[1] //Load\r\n  b.bcolor = #888888\r\n  b.tcolor = #888888\r\n  b.hcolor = #FFFFFF\r\n  b.SetPressed(SelectFileTool)\r\n  filebuttons.Add(b)\r\n\r\n  b = ui.AddButton()\r\n  SetDimensions(b,center_center,center_center,\r\n               ^3,-4,4,3)\r\n  dialogpanel.Add(b)\r\n  b.style = 1\r\n  b.text = filetooltexts[2] //Delete\r\n  b.bcolor = #888888\r\n  b.tcolor = #888888\r\n  b.hcolor = #FFFFFF\r\n  b.SetPressed(SelectFileTool)\r\n  filebuttons.Add(b)\r\n  \r\n  b = ui.AddButton()\r\n  SetDimensions(b,center_center,center_center,\r\n               ^9,-4,4,3)\r\n  dialogpanel.Add(b)\r\n  b.style = 1\r\n  b.text = filetooltexts[3] //Default\r\n  b.bcolor = #888888\r\n  b.tcolor = #888888\r\n  b.hcolor = #FFFFFF\r\n  b.SetPressed(SelectFileTool)\r\n  filebuttons.Add(b)\r\n\r\n\r\n  p = ui.AddPanel()\r\n  SetDimensions(p,center_center,center_center,\r\n               ^-4,0,4,3)\r\n  p.style = 1\r\n  p.visible = false\r\n  toolselectedpanel = p\r\n  dialogpanel.Add(p)\r\n  \r\n  t = ui.AddText()\r\n  SetDimensions(t,center_center,center_center,\r\n               ^0,0,2,1)\r\n  t.text = \"⚿→\"\r\n  toolselectedtext = t\r\n  p.Add(t)\r\n\r\n\r\n  p = ui.AddPanel()\r\n  SetDimensions(p,center_center,center_center,\r\n               ^4,0,4,3)\r\n  p.style = 1\r\n  p.visible = false\r\n  fileselectedpanel = p\r\n  dialogpanel.Add(p)\r\n  \r\n  t = ui.AddText()\r\n  SetDimensions(t,center_center,center_center,\r\n               ^0,0,2,1)\r\n  t.text = \"07\"\r\n  fileselectedtext = t\r\n  p.Add(t)\r\n\r\n  t = ui.AddText()\r\n  SetDimensions(t,center_center,center_center,\r\n               ^0,0,2,1)\r\n  t.text = \"─→\"\r\n  t.visible = false\r\n  arrowtext = t\r\n  dialogpanel.Add(t)\r\n  \r\n\r\n  b = ui.AddButton()\r\n  SetDimensions(b,center_center,center_center,\r\n               ^-5,4,7,3)\r\n  dialogpanel.Add(b)\r\n  b.style = 1\r\n  b.text = ＂N\"\r\n  b.bcolor = #FFFFFF\r\n  b.tcolor = #FFFFFF\r\n  b.hcolor = #FFFFFF\r\n  b.visible = false\r\n  b.SetPressed(FileAction)\r\n  cancelbutton = b\r\n\r\n  b = ui.AddButton()\r\n  SetDimensions(b,center_center,center_center,\r\n               ^4,4,7,3)\r\n  dialogpanel.Add(b)\r\n  b.style = 1\r\n  b.text = ＂Y\"\r\n  b.bcolor = #FFFFFF\r\n  b.tcolor = #FFFFFF\r\n  b.hcolor = #FFFFFF\r\n  b.visible = false\r\n  b.SetPressed(FileAction)\r\n  confirmbutton = b\r\n\r\n  var filespanel = null\r\n\r\n  p = ui.AddPanel()\r\n  SetDimensions(p,top_center,top_center,\r\n               ^0,1,savepanel.w-2,8)\r\n  p.style = transparent\r\n  filespanel = p\r\n  savepanel.Add(p)\r\n\r\n  var temp = null\r\n\r\n  for i=0..1\r\n    for j=0..9\r\n      temp = DrawFile(((4*j)+5),((3*i)+2),((i*10)+j+1))\r\n      filespanel.Add(temp[0])\r\n      files.Add(temp)\r\n\r\n  SaveArray(smilingpumpkin,0)\r\n  files[0][4] = 1 //Permanent\r\n\r\n  var savename\r\n  for i=0..files.Count()-1\r\n    savename = \"save\" + files[i][1].text\r\n    ?storage.Has(savename)\r\n      files[i][3] = 1\r\n\r\n  ?files[1][3] = 0\r\n    SaveArray(frowningpumpkin,1)\r\n    files[1][3] = 1\r\n\r\n  ?storage.Has(\"default\")\r\n    default = storage.Get(\"default\")\r\n  :\r\n    default = 0\r\n\r\n  files[default][3] = 2\r\n\r\n  UpdateFiles()\r\n//\r\n\r\nfunc DrawFile(x,y,num)\r\n  var p = null\r\n  var b = null\r\n  var t = null\r\n  var file = [null, //Panel ID\r\n              null, //Button ID\r\n              null, //Text ID\r\n              0,    //Save State \r\n              0]    //Permanent State\r\n\r\n  p = ui.AddPanel()\r\n  SetDimensions(p,top_left,top_left,x,y,4,3)\r\n  p.style = 1\r\n  file[0] = p\r\n  \r\n  b = ui.AddButton()\r\n  SetDimensions(b,center_center,center_center,0,0,4,3)\r\n  b.style = 1\r\n  b.tcolor = #888888\r\n  b.hcolor = #FFFFFF\r\n  ?num < 10\r\n    b.text = \"0\" + num\r\n  :\r\n    b.text = \"\" + num  \r\n  b.SetPressed(SelectFile)\r\n  file[1] = b\r\n  p.Add(b)\r\n\r\n  t = ui.AddText()\r\n  SetDimensions(t,top_right,top_right,0,0,1,1)\r\n  t.text = \"*\"\r\n  t.visible = false\r\n  file[2] = t\r\n  p.Add(t)\r\n  \r\n  return file\r\n//\r\n\r\nfunc ToggleTiles(btn)\r\n  ?btn = toggletilesbtn\r\n    ?creatorstate = 1\r\n      creatorstate = 0\r\n      toggletilesbtn.text = \"←─\"\r\n      \r\n      imagepanel.style = transparent\r\n      imagepanel.x = pumpkinoriginx\r\n      imagepanel.y = pumpkinoriginy\r\n      imagepanel.visible = inherit\r\n      toggleimagebtn.text = \"<>\"\r\n\r\n      ?savepanel.visible ! false\r\n        ToggleSavepanel()\r\n\r\n    :?creatorstate = 0\r\n      creatorstate = 1\r\n      toggletilesbtn.text = \"─→\"\r\n      imagepanel.visible = false\r\n      imagepanel.style = 1\r\n\r\n\r\n  ?creatorstate = 0\r\n    enable pause\r\n    ?(carvepanel.x > 0 - carvepanel.w)\r\n      carvepanel.x = carvepanel.x - 2\r\n  :?creatorstate = 1\r\n    ?carvepanel.x < 0\r\n      carvepanel.x = carvepanel.x + 2\r\n    :\r\n      ?screen.w < 64\r\n        disable pause\r\n      :\r\n        enable pause\r\n//\r\n\r\nfunc ToggleImage()\r\n  ?imagepanel.visible = false\r\n    ?screen.w < tilespanel.w + imagepanel.w + 5\r\n      imagepanel.x = carvepanel.x\r\n      imagepanel.y = carvepanel.y\r\n    :\r\n      imagepanel.x = carvepanel.x + carvepanel.w + 1\r\n      imagepanel.y = carvepanel.y\r\n    imagepanel.visible = inherit\r\n    toggleimagebtn.text = \"◀▶\"\r\n  :\r\n    imagepanel.visible = false\r\n    toggleimagebtn.text = \"<>\"\r\n//\r\n\r\nfunc ToggleSavepanel()\r\n  ?savepanel.visible = false\r\n    savepanel.visible = true\r\n    tilespanel.visible = false\r\n    togglesavebtn.text = ＂⚿◙\"\r\n  :\r\n    tilespanel.visible = inherit\r\n    savepanel.visible = false\r\n    SelectFileTool(null)\r\n    SelectFile(null)\r\n    togglesavebtn.text = ＂⚿☺\" \r\n//   \r\n\r\nfunc ClickTile(btn)\r\n  for i=0..tools.Count()-1\r\n    ?tools［i］［3］ = btn\r\n      tools[toolstate][1].style = transparent\r\n      toolstate = i\r\n      tools[toolstate][1].color = #FFFFFF\r\n      tools[toolstate][1].style = toolstyle[toolstate]\r\n      return\r\n\r\n  for i=0..tiles.Count()-1\r\n    ?tiles［i］［3］ = btn\r\n      ?tiles[i][0] = toolstate\r\n        tiles[i][0] = 0\r\n      :\r\n        tiles［i］［0］ = toolstate\r\n      tiles［i］［2］.frame = tiles［i］［0］\r\n      tiles［i］［4］.text = \"\" + tiles[i][0]\r\n      pixels[i].frame = tiles[i][0]\r\n      return\r\n//\r\n\r\nfunc FlickerRand()\r\n  var light = 0\r\n  var rand  = 0\r\n\r\n  ?time % 3 = 0\r\n    for i=0..pixels.Count()-1\r\n      light = lightarray[i]\r\n      rand = rng % 2\r\n      ?light <= 0\r\n        light = light + rand\r\n      :\r\n        light = light - rand\r\n      pixels[i].color = colorarray[light]\r\n//\r\n\r\nfunc SelectFileTool(btn)\r\n  var temp = null\r\n\r\n  for i=0..filebuttons.Count()-1\r\n    filebuttons[i].bcolor = #888888\r\n    filebuttons[i].tcolor = #888888\r\n    filebuttons[i].style = 1\r\n\r\n  temp = activefiletool\r\n  activefiletool = null\r\n\r\n  for i=0..filebuttons.Count()-1\r\n    ?btn = filebuttons[i]\r\n      ?i ! temp\r\n        activefiletool = i\r\n        filebuttons[i].bcolor = #FFFFFF\r\n        filebuttons[i].tcolor = #FFFFFF\r\n        filebuttons[i].style = 3\r\n\r\n  UpdateFileDialog()\r\n//\r\n\r\nfunc SelectFile(btn)\r\n  var temp = null\r\n\r\n  for i=0..files.Count()-1\r\n    ?files[i][3] > 0\r\n      files[i][1].style = 1\r\n      files[i][1].bcolor = #CCCCCC\r\n    :\r\n      files[i][1].style = 2\r\n      files[i][1].bcolor = #888888\r\n\r\n  temp = activefile\r\n  activefile = null\r\n\r\n  for i=0..files.Count()-1\r\n    ?btn = files[i][1]\r\n      ?i ! temp\r\n        activefile = i\r\n        files[i][1].bcolor = #FFFFFF\r\n        files[i][1].style = 3\r\n\r\n  ?activefile ! null \r\n    ?files[activefile][3] > 0\r\n      for i=0..filebuttons.Count()-1\r\n        filebuttons[i].visible = inherit\r\n      ?files[activefile][3] = 2\r\n        filebuttons[3].visible = false\r\n\r\n      ?files[activefile][4] ! 0\r\n        filebuttons[0].visible = false\r\n        filebuttons[2].visible = false\r\n    :\r\n      for i=0..filebuttons.Count()-1\r\n        filebuttons[i].visible = false\r\n      filebuttons[0].visible = inherit \r\n\r\n    ?activefiletool ! null & \r\n     ^filebuttons[activefiletool].visible = false\r\n      activefiletool = null\r\n      SelectFileTool(null)  \r\n  :\r\n    for i=0..filebuttons.Count()-1\r\n      filebuttons[i].visible = inherit\r\n\r\n  UpdateFileDialog()\r\n//\r\n\r\nfunc UpdateFileDialog()\r\n  var filesel = 0\r\n  var toolsel = 0\r\n\r\n  ?activefile ! null\r\n    filesel = 1\r\n    fileselectedpanel.visible = inherit\r\n    fileselectedtext.text = files[activefile][1].text\r\n  :\r\n    fileselectedpanel.visible = false\r\n\r\n  ?activefiletool ! null\r\n    toolsel = 1\r\n    toolselectedpanel.visible = inherit\r\n    toolselectedtext.text = filetooltexts[activefiletool]\r\n  :\r\n    toolselectedpanel.visible = false\r\n\r\n  ?filesel & toolsel\r\n    arrowtext.visible = inherit\r\n    cancelbutton.visible = inherit\r\n    confirmbutton.visible = inherit\r\n  :\r\n    arrowtext.visible = false\r\n    cancelbutton.visible = false\r\n    confirmbutton.visible = false\r\n//\r\n\r\nfunc FileAction(btn)\r\n  ?btn = confirmbutton\r\n    confirmbutton.visible = false\r\n    cancelbutton.visible = false\r\n    ?activefiletool = 0 //Save\r\n      SaveFile()   \r\n    :?activefiletool = 1 //Load\r\n      LoadFile()\r\n    :?activefiletool = 2 //Delete\r\n      DeleteFile()\r\n    :?activefiletool = 3 //Default\r\n      DefaultFile()\r\n\r\n    var temp = activefile\r\n    SelectFileTool(null)\r\n    SelectFile(files[temp][1])\r\n    SelectFile(files[temp][1]) \r\n    toolselectedpanel.visible = inherit  \r\n    arrowtext.visible = inherit  \r\n  :\r\n    SelectFileTool(null)\r\n    SelectFile(null)\r\n//\r\n\r\nfunc UpdateFiles()\r\n  for i=0..files.Count()-1\r\n\r\n    ?files[i][3] = 0 //Empty File\r\n      files[i][1].bcolor = #888888\r\n      files[i][1].tcolor = #888888\r\n      files[i][1].style = 2\r\n      files[i][2].visible = false\r\n\r\n    :?files[i][3] = 1 //Saved File\r\n      files[i][1].bcolor = #CCCCCC\r\n      files[i][1].tcolor = #FFFFFF\r\n      files[i][1].style = 1\r\n      files[i][2].visible = false\r\n      \r\n    :?files[i][3] = 2 //Default File\r\n      files[i][1].bcolor = #CCCCCC\r\n      files[i][1].tcolor = #FFFFFF\r\n      files[i][1].style = 1\r\n      files[i][2].visible = inherit    \r\n//\r\n\r\nfunc SaveFile()\r\n  ?files[activefile][3] = 0\r\n    files[activefile][3] = 1\r\n  savearray.Clear()\r\n  for i=0..tiles.Count()-1\r\n    savearray.Add(tiles[i][0])\r\n  SaveArray(savearray,activefile)\r\n  UpdateFiles()\r\n//\r\n\r\nfunc SaveArray(array, filenumber)\r\n  var save = PixelsToString(array)\r\n  var savename = \"save\" + files[filenumber][1].text\r\n  storage.Set(savename, save)\r\n//\r\n\r\nfunc LoadFile()\r\n  var savename = \"save\" + files[activefile][1].text\r\n  ?storage.Has(savename)\r\n    var save = storage.Get(savename)\r\n    savearray = StringToPixels(save)\r\n    LoadArray(savearray)\r\n//\r\n\r\nfunc LoadArray(array)\r\n  var len = 0\r\n\r\n  ?tiles.Count() ! array.Count()\r\n    >Warning: Loaded Array not Correct Length\r\n    ?array.Count() < tiles.Count()\r\n      len = array.Count()\r\n    :\r\n      len = tiles.Count()\r\n  :\r\n    len = tiles.Count()   \r\n\r\n  for i=0..len-1\r\n    tiles[i][0] = array[i]\r\n\r\n  for i = 0..tiles.Count()-1\r\n    tiles[i][2].frame = tiles[i][0]\r\n    pixels[i].frame = tiles[i][0]\r\n//\r\n\r\nfunc LoadDefault()\r\n  var savename = \"save\" + files[default][1].text\r\n  ?storage.Has(savename)\r\n    var save = storage.Get(savename)\r\n    savearray = StringToPixels(save)\r\n    LoadArray(savearray)\r\n  :\r\n    LoadArray(smilingpumpkin)\r\n//\r\n\r\nfunc DeleteFile()\r\n  files[activefile][3] = 0\r\n  var savename = \"save\" + files[activefile][1].text\r\n  ?storage.Has(savename)\r\n    storage.Delete(savename)\r\n  ?activefile = default\r\n    default = 0\r\n    files[default][3] = 2\r\n    ?storage.Has(\"default\")\r\n      storage.Delete(\"default\")\r\n  UpdateFiles()\r\n//\r\n\r\nfunc DefaultFile()\r\n  files[default][3] = 1\r\n  files[activefile][3] = 2\r\n  default = activefile\r\n  storage.Set(\"default\",default)\r\n  UpdateFiles() \r\n//\r\n\r\nfunc PixelsToString(array)\r\n  var string = \"\"\r\n  ?array.Count() > 0\r\n    for i=0..array.Count()-1\r\n      string = string + array[i]\r\n\r\n  return string\r\n//\r\n\r\nfunc StringToPixels(string)\r\n  var stringarray = string.Break(string, 1)\r\n\r\n  var numarray = []\r\n  for i=0..stringarray.Count()-1\r\n    for j = 0..9\r\n      ?stringarray[i] = \"\" + j\r\n        numarray.Add(j)\r\n\r\n  return numarray\r\n//\r\n  \r\nfunc ClearStorage()\r\n  var a = storage.Keys()\r\n  var numitems = a.Count()\r\n  ?numitems > 0\r\n    for i=0..numitems-1\r\n      storage.Delete(a[i])\r\n      >Storage Empty. Deleted @numitems@ Items\r\n//\r\n\r\nfunc Run()\r\n  ?initialize\r\n    FlickerRand()\r\n    ToggleTiles(1)\r\n//\r\n\r\n\r\n//*******************************\r\n// Drawing Code \r\n//*******************************\r\n\r\n?initialize = 0\r\n  CheckLocation()\r\n\r\n?initialize = 0\r\n  DrawPumpkinCarving()\r\n  DrawImage()\r\n  DrawSavePanel()\r\n  LoadDefault()\r\n  initialize = 1\r\n\r\n?initialize = 1\r\n  Run()\r\n//\r\n\r\n//*******************************\r\n// End of File\r\n//*******************************"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/CultGroup.txt" - Parse error: Failed to parse completely. Remaining: "=#rainFF\r\n\r\nvar player\r\nvar guardboi\r\nvar heavygal\r\nvar marksgal\r\nvar adeptboi\r\nvar sorceress\r\n\r\nvar refX = 0\r\nvar refZ = 0\r\nrefX = screen.FromWorldX(pos.x)\r\nrefZ = pos.z\r\nvar lastrefX=0\r\nvar playerX\r\nplayerX=pos.x\r\nvar lastplayerX=0\r\nvar cultX=[gaurdboiX,heavygalX,marksgalX,adeptboiX,sorceressX]\r\nvar pewpews=[]\r\nvar delete=[]\r\nvar remove\r\n\r\nvar leader=ascii\r\n###_\r\n##{))\r\n### \\\r\n##( !_\r\n###`¯\r\n%%\r\n###_\r\n##{))\r\n### \\\r\n##( '._\r\n###¯´¯\r\n%%\r\n###_\r\n##{))\r\n### \\\r\n##/ `-._\r\n##`¯¯¯¯\r\n%%\r\n###_\r\n##{))\r\n### \\\r\n##/ '.__\r\n##¯¯¯¯\r\nasciiend\r\n\r\nvar guard=ascii\r\n#\r\n###_\r\n#_{))\r\n(∞( \\┼───\r\n#¯( !_\r\n###`¯\r\n%%\r\n#\r\n###_\r\n#_{))\r\n(∞( \\┼───\r\n#¯( '._\r\n###¯´¯\r\n%%\r\n#\r\n###_\r\n#_{))\r\n(∞( \\┼───\r\n#¯/ `-._\r\n##`¯¯¯¯\r\n%%\r\n#\r\n###_\r\n#_{))\r\n(∞( \\┼───\r\n#¯/ '.__\r\n##¯¯¯¯\r\nasciiend\r\n\r\nvar guardattack=ascii\r\n#\r\n####_\r\n##_{))\r\n#(∞( \\┼───\r\n##¯/ '._\r\n####¯¯¯\r\n%%\r\n#\r\n####_\r\n#_ {))┼───\r\n#∞(` ¯\r\n#¯ ( '._\r\n####¯¯¯\r\n%%\r\n#\r\n####_#┼───\r\n#_ {)/\r\n#| ¯ ¡\r\n#¯ ( '._\r\n####¯¯¯\r\n%%\r\n#\r\n####_┼───\r\n#__{()\r\n#) ¯ ¡\r\n#¯ / '._\r\n###`¯`¯\r\n%%\r\n#\r\n####_┼───\r\n##_{()\r\n##)V ¡\r\n##¯/(`,\r\n###`#¯\r\n%%\r\n###_.---.\r\n#.´  .-- '\r\n/   ´)\r\n───┼/¡\r\n##¯/(`,\r\n###`#¯\r\n%%\r\n#\r\n####_\r\n##_{))\r\n───┼/¡\r\n##¯/ `,\r\n###¯`¯\r\n%%\r\n#\r\n####_\r\n##_{))\r\n#───┼)\r\n##¯/ `.\r\n####¯`¯\r\n%%\r\n#\r\n####_\r\n##_{))\r\n##)V ┼\r\n##¯/ `._\r\n####¯¯¯\r\n%%\r\n#\r\n####_\r\n#__{))\r\n#) ¯ |┼─\r\n#¯ / '._\r\n####¯¯¯\r\n%%\r\n#\r\n####_\r\n#_ {))\r\n#| ¯ \\┼───\r\n#¯ / '._\r\n####¯¯¯\r\n%%\r\n#\r\n####_\r\n#_ {))\r\n#∞(` \\┼───\r\n#¯ / '._\r\n####¯¯¯\r\n%% {repeat:18}\r\n#\r\n####_\r\n##_{))\r\n#(∞( \\┼───\r\n##¯/ '._\r\n####¯¯¯\r\nasciiend\r\n\r\nvar heavyhitter=ascii\r\n###########\r\n###########___\r\n##########[___]\r\n############║{))\r\n############║=´¡\r\n############║( (_\r\n############' `¯\r\n%%\r\n###########\r\n###########___\r\n##########[___]\r\n############║{))\r\n############║=´¡\r\n############║( '._\r\n############' ¯´¯\r\n%%\r\n###########\r\n###########___\r\n##########[___]\r\n############║{))\r\n############║=´¡\r\n############║/ `-._\r\n############'`¯¯¯¯\r\n%%\r\n###########\r\n###########___\r\n##########[___]\r\n############║{))\r\n############║=´¡\r\n############║/ '.__\r\n############'¯¯¯¯\r\nasciiend\r\n\r\nvar heavyattack=ascii\r\n% {repeat:3}\r\n#\r\n###########___\r\n##########[___]\r\n############║{))\r\n############║=´¡\r\n############║/ '._\r\n############'¯¯¯¯\r\n%%\r\n###########___\r\n##########[___]\r\n############║#_\r\n############║{))\r\n############║¯´¡\r\n############'( '._\r\n##############¯¯¯\r\n%%\r\n#\r\n#################┌¯┐\r\n##########-══════╡ │\r\n############`{\\)#└_┘\r\n#############(`¡\r\n##############)'._\r\n##############`¯¯\r\n%%\r\n#\r\n##################┌¯┐\r\n###########-══════╡ │\r\n#############{)/##└_┘\r\n#############(´¡\r\n##############\\'._\r\n###############`¯\r\n%% {repeat:3}\r\n#\r\n###################┌¯┐\r\n############-══════╡ │\r\n##############{)/##└_┘\r\n##############|´¡\r\n##############( (_\r\n###############`¯\r\n%%\r\n###########_____\r\n#########.´  __ `'-.\r\n#######/   .´###`.  \\\r\n######/   /#{))###`-´\r\n######|  /═══/═-\r\n######'--'##`\\_'._\r\n############## ¯¯\r\n%%\r\n#\r\n#\r\n#############_\r\n######┌¯┐###{))\r\n####.\\│!│/.══/═-\r\n#####\\___/###`-.`-\r\n%%\r\n#\r\n#\r\n#############_\r\n####,#┌:┐#.#{))\r\n##`###│ ╞════/═-. #\r\n####`#' '#####`-:\\\r\n######¯¯¯\r\n%%\r\n#\r\n#\r\n#######'#####_\r\n###-##┌¯┐##-{))\r\n#¯####│ ╞════/═-._\r\n###´##└_┘######`·`\r\n#######¯\r\n%%\r\n#\r\n#######.\r\n#############_\r\n##.###┌¯┐###{))\r\n.#####│ ╞════/═-_.\r\n##.###└_┘#####`.-´\r\n%%\r\n#\r\n#\r\n#############_\r\n######┌¯┐###{))\r\n######│ ╞════/═-_.\r\n######└_┘#####\\,:´\r\n%%\r\n#\r\n#\r\n#############_\r\n#######┌¯┐##{))\r\n#######│ ╞════)═-_\r\n#######└_┘###`\\  /\r\n###############¯´\r\n%%\r\n#\r\n#\r\n##############_\r\n########┌¯┐#_{))\r\n########│ ╞════)═-\r\n########└_┘#'. ¯)\r\n#############¯´\r\n%%\r\n#\r\n#\r\n###########.-._\r\n##########/ /{))\r\n#########'-´`\\/¡\r\n#############/\\`/\r\n#############`¯`\r\n%%\r\n#\r\n###########___\r\n##########[___]\r\n############║{))\r\n############║=´¡\r\n############║/ '·,\r\n############'¯¯¯¯\r\n%% {repeat:17}\r\n#\r\n###########___\r\n##########[___]\r\n############║{))\r\n############║=´¡\r\n############║/ '._\r\n############'¯¯¯¯\r\nasciiend\r\n\r\nvar marksman=ascii\r\n##########_\r\n#########{))\r\n#######{══╤)\r\n#########( !_\r\n##########`¯\r\n%%\r\n##########_\r\n#########{))\r\n#######{══╤)\r\n#########( '._\r\n##########¯´¯\r\n%%\r\n##########_\r\n#########{))\r\n#######{══╤)\r\n#########/ `-._\r\n#########`¯¯¯¯\r\n%%\r\n##########_\r\n#########{))\r\n#######{══╤)\r\n#########/ '.__\r\n#########¯¯¯¯\r\nasciiend\r\n\r\nvar markattack=ascii\r\n##########_\r\n#########{))\r\n#######{══╤)\r\n#########/ '._\r\n#########¯¯¯¯\r\n%%\r\n##########_\r\n#########{))\r\n######{══╤/¡\r\n#########/ '._\r\n#########¯¯¯¯\r\n%% {repeat:2}\r\n##########_\r\n#####{══╤{))\r\n#########¯´¡\r\n#########/ '._\r\n#########¯¯¯¯\r\n%%\r\n####.#####_\r\n####-{══╤{))\r\n####´####¯´¡\r\n#########/ '._\r\n#########¯¯¯¯\r\n%%\r\n###·######_\r\n###·##{══╤))\r\n###·#####`V¡\r\n#########/ '._\r\n#########¯¯¯¯\r\n%%\r\n##`#######_\r\n######{══╤))\r\n##.######`V¡\r\n#########/ '._\r\n#########¯¯¯¯\r\n%%\r\n#'########_\r\n#########{))\r\n#######{══╤)\r\n#´#######/ '._\r\n#########¯¯¯¯\r\n%%\r\n´#########_\r\n#########{))\r\n#######{══╤)\r\n.########/ '._\r\n#########¯¯¯¯\r\n%% {repeat:21}\r\n##########_\r\n#########{))\r\n#######{══╤)\r\n#########/ '._\r\n#########¯¯¯¯\r\nasciiend\r\n\r\nvar pewpew=ascii\r\n───-·\r\nasciiend\r\n\r\nvar adept=ascii\r\n#\r\n#\r\n######,\r\n###∞_/(_\r\n###|{\\\\\r\n###|-´ )\r\n###|/__\\\r\n####`##´\r\n%%\r\n#\r\n#\r\n######,\r\n###∞_/(_\r\n###|{\\\\\r\n###|-,/\r\n###|/__\\\r\n####`##´\r\n%%\r\n#\r\n#\r\n######,\r\n###∞_/(_\r\n###|{\\\\\r\n###|-, )\r\n###|( (\r\n#####`¯\r\n%%\r\n#\r\n#\r\n###∞##,\r\n###|_/(_\r\n###|{\\\\\r\n###|`, \\\r\n####(_(\r\n######'\r\n%%\r\n#\r\n#\r\n###∞##,\r\n###|_/(_\r\n###|{\\\\\r\n###|`,/\r\n####/__\\\r\n####`##´\r\n%%\r\n#\r\n#\r\n#####∞,\r\n####//(_\r\n###/{\\\\\r\n##/`¯, )\r\n####( (\r\n#####`¯\r\n%%\r\n#\r\n#\r\n######,\r\n####∞/(_\r\n###/{\\\\\r\n##/-´, \\\r\n#/##(_(\r\n######'\r\n%%\r\n#\r\n#\r\n######,\r\n####∞/(_\r\n###/{\\\\\r\n##/-´,/\r\n#/##/__\\\r\n####`##´\r\n%%\r\n#\r\n#\r\n######,\r\n##∞#_/(_\r\n##|#{\\\\\r\n##|-´, )\r\n##|#( (\r\n#####`¯\r\n%%\r\n#\r\n#\r\n######,\r\n##∞#_/(_\r\n##|#{\\\\\r\n##|-´, \\\r\n##|#(_(\r\n######'\r\nasciiend\r\n\r\nvar adeptattack=ascii\r\n#\r\n#\r\n###∞##,\r\n###|_/(_\r\n###|{\\\\\r\n###|`,/\r\n####/__\\\r\n####`##´\r\n%%\r\n#\r\n#\r\n###∞##,\r\n###|_/(_\r\n###|{\\\\\r\n###|`/(\r\n####/__\\\r\n####`##´\r\n%%\r\n#\r\n#\r\n###∞##,\r\n###|_/(_\r\n###|{\\\\\r\n###|-´(\r\n####/__\\\r\n####`##´\r\n%%\r\n#\r\n###∞\r\n###|##,\r\n###|_/(_\r\n###|{\\\\\r\n####`¯(\r\n####/__\\\r\n####`##´\r\n%%\r\n#\r\n######∞\r\n#####/,\r\n####//(_\r\n###/{\\\\\r\n####`¯(\r\n####/__\\\r\n####`##´\r\n%%\r\n######'\r\n####- ∞ -\r\n#####/.\r\n####//(_\r\n###/{\\\\\r\n####`¯(\r\n####/__\\\r\n####`##´\r\n%%\r\n######.\r\n#####-∞-\r\n#####/'\r\n####//(_\r\n###/{\\\\\r\n####`¯(\r\n####/__\\\r\n####`##´\r\n%% {repeat:2}\r\n#\r\n######∞\r\n#####/,\r\n####//(_\r\n###/{\\\\\r\n####`¯(\r\n####/__\\\r\n####`##´\r\n%%\r\n#\r\n#####:-\r\n∞#####,\r\n#\\##_/(_\r\n##\\#{\\\\\r\n###\\-´(\r\n####/__\\\r\n####`##´\r\n%%\r\n#\r\n###.#-\r\n∞###´#,\r\n#\\##_/(_\r\n##\\#{\\\\\r\n###\\-´(\r\n####/__\\\r\n####`##´\r\n%%\r\n#\r\n####·\r\n∞#´,##,\r\n#\\##_/(_\r\n##\\#{\\\\\r\n###\\-´(\r\n####/__\\\r\n####`##´\r\n%%\r\n#\r\n#\r\n######,\r\n#∞##_/(_\r\n##\\#{\\\\\r\n###\\_/(\r\n####\\__\\\r\n####`##´\r\n%%\r\n#\r\n#\r\n######,\r\n###∞_/(_\r\n###|{\\\\\r\n###|-,/\r\n###|/__\\\r\n####`##´\r\n%% {repeat:26}\r\n#\r\n#\r\n######,\r\n###∞_/(_\r\n###|{\\\\\r\n###|-, )\r\n###|/__\\\r\n####`  ´\r\nasciiend\r\n\r\nvar splat=ascii\r\n% {repeat:4}\r\n#\r\n(`.\r\n##'\r\n%% {repeat:2}\r\n#\r\n(`·.\r\n%%\r\n#\r\n(`'.\r\n%%\r\n#\r\n(:·'\r\n%%\r\n#\r\n(,.´\r\n%% {repeat:2}\r\n#\r\n(.·´\r\n%% {repeat:5}\r\n##.\r\n(,'\r\nasciiend\r\n\r\nvar sorcerer=ascii\r\n#\r\n###,_\r\n###{\\\\\r\n###( `\\\r\n###/`o'._\r\n###`¯¯'¯\r\n%%\r\n#\r\n###,_\r\n###{\\\\\r\n###( `\\\r\n###(`o'._\r\n####´¯¯¯\r\n%%\r\n#\r\n###,_\r\n###{\\\\\r\n###( `\\\r\n###(`o`-._\r\n####¯¯¯¯¯\r\n%%\r\n#\r\n###,_\r\n###{\\\\\r\n###( `\\\r\n###/`o`-._\r\n###`¯¯¯¯¯\r\n%%\r\n#\r\n###,_\r\n###{\\\\\r\n###( `\\\r\n###/`o'.__\r\n###¯¯´¯¯\r\nasciiend\r\n\r\nvar sorcererattack=ascii\r\n#\r\n###,_\r\n###{\\\\\r\n###/ `\\\r\n###`o '._\r\n###`¯¯'¯\r\n%%\r\n##.o\r\n.'/,_\r\n| `{\\\\\r\n'  `,')\r\n#`.__,`,\r\n###` ¯¯\r\n%% {repeat:3}\r\n###o\r\n##/,_\r\n##\\{\\\\\r\n###`,')\r\n###/( `,\r\n###` ¯¯\r\n%%\r\n#o\r\n#|#,_\r\n##\\{\\\\\r\n###`,')\r\n###/( `,\r\n###` ¯¯\r\n%%\r\n#\r\no##,_\r\n#\\_{\\\\\r\n###`,')\r\n###/. `.\r\n###`¯`¯¯\r\n%%\r\n#\r\n###,_\r\n###{\\\\\r\no──',`\\\r\n###/  '._\r\n###`¯'¯¯\r\n%%\r\n#\r\n###,_\r\n###{\\\\\r\n###/,`\\\r\n#o´/  '._\r\n###`¯¯'¯\r\n%%\r\n#\r\n###,_\r\n###{\\\\\r\n###/,`\\\r\n##'o  '._\r\n###`¯¯'¯\r\n%% {repeat:19}\r\n#\r\n###,_\r\n###{\\\\\r\n###( `\\\r\n###/`o'._\r\n###`¯¯'¯\r\nasciiend\r\n\r\nvar boom=ascii\r\n#\r\n#|/\r\n##¯\r\n#\r\n%%\r\n#|#/\r\n#\r\n###¯\r\n%%\r\n#'#´\r\n#\r\n####¯\r\n%% {repeat:7}\r\n#\r\nasciiend\r\n\r\nvar pewboom=ascii\r\n#\r\nc@\r\n%%\r\n#\r\nc.@\r\nasciiend\r\n\r\nvar pray = ascii\r\n% {repeat:5}\r\n##_\r\n\\((}/\r\n#) '\r\n,` )\r\n#¯¯\r\n%%\r\n###_\r\n#|´(}/\r\n#/ .´\r\n,` )\r\n#¯¯\r\n%%\r\n#\r\n####_\r\n#,-´/}_\r\n,' ,¯¯\r\n#¯¯\r\n%% {repeat:5}\r\n#\r\n#\r\n#####_\r\n,-'¯´_)\r\n#¯¯¯ ¯¯\r\n%%\r\n#\r\n####_\r\n#,-´/}_\r\n,' ,¯¯\r\n#¯¯\r\n%%\r\n###_\r\n#|´(}/\r\n#/ .´\r\n,` )\r\n#¯¯\r\nasciiend\r\n\r\nvar prayer=false\r\n\r\nfunc CreateProjectile(type)\r\n  var proj\r\n  var ptime=0\r\n  var startX=adeptboi.x\r\n  var endX=cultX[3]*-1+foe.distance\r\n  ?type=\"mark\"\r\n    proj=ui.AddAnim(pewpew)\r\n    proj.anchor=top_left\r\n    proj.dock=top_left\r\n    proj.x=marksgal.x-5\r\n    proj.y=marksgal.y+1\r\n  :?type=\"sorc\"\r\n    proj=ui.AddAnim(pewboom)\r\n    proj.anchor=top_left\r\n    proj.dock=top_left\r\n    proj.x=sorceress.x-3\r\n    proj.y=sorceress.y+2\r\n    proj.Play()\r\n  :?type=\"adep\"\r\n    proj=ui.AddAnim(splat)\r\n    proj.anchor=top_left\r\n    proj.dock=top_left\r\n    proj.x=adeptboi.x-6\r\n    proj.y=adeptboi.y+1\r\n    proj.Play()\r\n  return [type,proj,ptime,startX,endX]\r\n\r\n?totaltime=1\r\n  pewpews.Clear()\r\n  prayer=false\r\n  heavygal=ui.AddAnim(heavyhitter)\r\n  heavygal.anchor=top_left\r\n  heavygal.dock=top_left\r\n  heavygal.flipX=true\r\n  heavygal.loop=true\r\n  heavygal.Play()\r\n  heavygal.x=refX+6\r\n  heavygal.y=refZ-8\r\n  cultX[1]=6\r\n  adeptboi=ui.AddAnim(adept)\r\n  adeptboi.anchor=top_left\r\n  adeptboi.dock=top_left\r\n  adeptboi.flipX=true\r\n  adeptboi.loop=true\r\n  adeptboi.Play()\r\n  adeptboi.x=refX-11\r\n  adeptboi.y=refZ-7\r\n  cultX[3]=-11\r\n  player=ui.AddAnim(leader)\r\n  player.anchor=top_left\r\n  player.dock=top_left\r\n  player.flipX=true\r\n  player.color=playercolor\r\n  player.loop=true\r\n  player.frame=3\r\n  player.x=refX+3\r\n  player.y=refZ-3\r\n  player.visible=false\r\n  marksgal=ui.AddAnim(marksman)\r\n  marksgal.anchor=top_left\r\n  marksgal.dock=top_left\r\n  marksgal.flipX=true\r\n  marksgal.loop=true\r\n  marksgal.Play()\r\n  marksgal.x=refX-15\r\n  marksgal.y=refZ-3\r\n  cultX[2]=-15\r\n  sorceress=ui.AddAnim(sorcerer)\r\n  sorceress.anchor=top_left\r\n  sorceress.dock=top_left\r\n  sorceress.flipX=true\r\n  sorceress.loop=true\r\n  sorceress.Play()\r\n  sorceress.x=refX-11\r\n  sorceress.y=refZ-2\r\n  cultX[4]=-11\r\n  guardboi=ui.AddAnim(guard)\r\n  guardboi.anchor=top_left\r\n  guardboi.dock=top_left\r\n  guardboi.flipX=true\r\n  guardboi.loop=true\r\n  guardboi.Play()\r\n  guardboi.x=refX-4\r\n  guardboi.y=refZ\r\n  cultX[0]=-4\r\n  lastrefX=screen.FromWorldX(pos.x)\r\n  lastplayerX=pos.x\r\n\r\nfor X = 0..cultX.Count()-1\r\n  cultX[X]=cultX[X]-(playerX - lastplayerX)\r\n\r\nplayer.x=refX+3\r\nplayer.y=refZ-3\r\n?ai.walking&player.playing=false\r\n  player.Play()\r\n:?!ai.walking&player.playing\r\n  player.Stop()\r\n  player.frame=3\r\n\r\n?foe=\"Naga\"&foe.distance<=23\r\n  guardboi.Load(pray)\r\n  guardboi.flipX=false\r\n  guardboi.Play()\r\n  heavygal.Load(pray)\r\n  heavygal.flipX=false\r\n  heavygal.Play()\r\n  heavygal.y=refZ-5\r\n  ?!prayer\r\n    heavygal.x=refX-6\r\n    cultX[1]=-6\r\n    prayer=true\r\n  marksgal.Load(pray)\r\n  marksgal.flipX=false\r\n  marksgal.Play()\r\n  adeptboi.Load(pray)\r\n  adeptboi.flipX=false\r\n  adeptboi.Play()\r\n  adeptboi.y=refZ-4\r\n  sorceress.Load(pray)\r\n  sorceress.flipX=false\r\n  sorceress.Play()\r\n:\r\n  guardboi.flipX=true\r\n  heavygal.flipX=true\r\n  marksgal.flipX=true\r\n  adeptboi.flipX=true\r\n  sorceress.flipX=true\r\n  ?foe&loc!\"Temple\"\r\n    ?cultX[0]<foe.distance\r\n      ?time%3=0\r\n        guardboi.Load(guard)\r\n        cultX[0]=cultX[0]+1\r\n    :\r\n      guardboi.Load(guardattack)\r\n      guardboi.Play()\r\n    ?cultX[1]<foe.distance+5\r\n      ?time%3=0\r\n        heavygal.Load(heavyhitter)\r\n        cultX[1]=cultX[1]+1\r\n    :\r\n      heavygal.Load(heavyattack)\r\n      heavygal.Play()\r\n    ?cultX[2]<foe.distance-20\r\n      ?time%3=0\r\n        marksgal.Load(marksman)\r\n        cultX[2]=cultX[2]+1\r\n    :\r\n      marksgal.Load(markattack)\r\n      marksgal.Play()\r\n      ?marksgal.frame=3\r\n        pewpews.Add(CreateProjectile(\"mark\"))\r\n    ?cultX[3]<foe.distance-18\r\n      ?time%3=0\r\n        adeptboi.Load(adept)\r\n        cultX[3]=cultX[3]+1\r\n    :\r\n      adeptboi.Load(adeptattack)\r\n      ?adeptboi.frame=8\r\n        pewpews.Add(CreateProjectile(\"adep\"))\r\n      adeptboi.Play()\r\n    ?cultX[4]<foe.distance-18\r\n      ?time%3=0\r\n        sorceress.Load(sorcerer)\r\n        cultX[4]=cultX[4]+1\r\n    :\r\n      sorceress.Load(sorcererattack)\r\n      sorceress.Play()\r\n      ?sorceress.frame=1\r\n        pewpews.Add(CreateProjectile(\"sorc\"))\r\n  :?time%3=0\r\n    guardboi.Load(guard)\r\n    heavygal.Load(heavyhitter)\r\n    marksgal.Load(marksman)\r\n    adeptboi.Load(adept)\r\n    sorceress.Load(sorcerer)\r\n    ?cultX[0]<-4\r\n      guardboi.Play()\r\n      cultX[0]=cultX[0]+1\r\n    :?cultX[0]>-4\r\n      guardboi.Play()\r\n      cultX[0]=cultX[0]-1\r\n    :?guardboi.playing\r\n      guardboi.Stop()\r\n      guardboi.frame=3\r\n    ?cultX[1]<6\r\n      heavygal.Play()\r\n      cultX[1]=cultX[1]+1\r\n    :?cultX[1]>6\r\n      heavygal.Play()\r\n      cultX[1]=cultX[1]-1\r\n    :?heavygal.playing\r\n      heavygal.Stop()\r\n      heavygal.frame=3\r\n    ?cultX[2]<-15\r\n      marksgal.Play()\r\n      cultX[2]=cultX[2]+1\r\n    :?cultX[2]>-15\r\n      marksgal.Play()\r\n      cultX[2]=cultX[2]-1\r\n    :?marksgal.playing\r\n      marksgal.Stop()\r\n      marksgal.frame=3\r\n    ?cultX[3]<-11\r\n      adeptboi.Play()\r\n      cultX[3]=cultX[3]+1\r\n    :?cultX[3]>-11\r\n      adeptboi.Play()\r\n      cultX[3]=cultX[3]-1\r\n    :?adeptboi.playing\r\n      adeptboi.Stop()\r\n      adeptboi.frame=0\r\n    ?cultX[4]<-12\r\n      sorceress.Play()\r\n      cultX[4]=cultX[4]+1\r\n    :?cultX[4]>-12\r\n      sorceress.Play()\r\n      cultX[4]=cultX[4]-1\r\n    :?sorceress.playing\r\n      sorceress.Stop()\r\n      sorceress.frame=2\r\n?foe!\"Nage\"\r\n  ?foe\r\n    ?guardboi.y>refZ-1\r\n      guardboi.y=guardboi.y-1\r\n    :?guardboi.y<refZ-1\r\n      guardboi.y=guardboi.y+1\r\n    ?heavygal.y>refZ-7\r\n      heavygal.y=heavygal.y-1\r\n    :?heavygal.y<refZ-7\r\n      heavygal.y=heavygal.y+1\r\n  :\r\n    ?guardboi.y>refZ\r\n      guardboi.y=guardboi.y-1\r\n    :?guardboi.y<refZ\r\n      guardboi.y=guardboi.y+1\r\n    ?heavygal.y>refZ-8\r\n      heavygal.y=heavygal.y-1\r\n    :?heavygal.y<refZ-8\r\n      heavygal.y=heavygal.y+1\r\n  ?marksgal.y>refZ-3\r\n    marksgal.y=marksgal.y-1\r\n  :?marksgal.y<refZ-3\r\n    marksgal.y=marksgal.y+1\r\n  ?adeptboi.y>refZ-7\r\n    adeptboi.y=adeptboi.y-1\r\n  :?adeptboi.y<refZ-7\r\n    adeptboi.y=adeptboi.y+1\r\n  ?sorceress.y>refZ-2\r\n    sorceress.y=sorceress.y-1\r\n  :?sorceress.y<refZ-2\r\n    sorceress.y=sorceress.y+1\r\n\r\n?cultX[0] < -60 | cultX[0] > 60\r\n  cultX[0] = -20\r\n?cultX[1] < -60 | cultX[1] > 60\r\n  cultX[1] = -20\r\n?cultX[2] < -60 | cultX[2] > 60\r\n  cultX[2] = -20\r\n?cultX[3] < -60 | cultX[3] > 60\r\n  cultX[3] = -20\r\n?cultX[4] < -60 | cultX[4] > 60\r\n  cultX[4] = -20\r\n\r\n?pewpews.Count()>0\r\n  for P = 0..pewpews.Count()-1\r\n    ?pewpews[P][0]=\"mark\"\r\n      ?pewpews[P][1].x>=refX+foe.distance\r\n        delete.Add(P)\r\n        pewpews[P][1].Recycle()\r\n      :\r\n        pewpews[P][1].x=pewpews[P][1].x+1\r\n    :?pewpews[P][0]=\"sorc\"\r\n      ?pewpews[P][1].x>=refX+foe.distance\r\n        pewpews[P][1].Load(boom)\r\n        ?pewpews[P][1].frame=3\r\n          delete.Add(P)\r\n          pewpews[P][1].Recycle()\r\n      :\r\n        pewpews[P][1].x=pewpews[P][1].x+1\r\n    :?pewpews[P][0]=\"adep\"\r\n      ?pewpews[P][2]>=pewpews[P][4]+2\r\n        delete.Add(P)\r\n        pewpews[P][1].Recycle()\r\n      :\r\n        pewpews[P][2]=pewpews[P][2]+1\r\n        pewpews[P][1].x=pewpews[P][1].x+1\r\n        pewpews[P][1].y=math.FloorToInt(0.25*((pewpews[P][2]-pewpews[P][3])*(pewpews[P][2]+pewpews[P][4]))/10+adeptboi.y*2)\r\n        >`0,@pewpews[P][2]@,@pewpews[P][1].y@\r\n//      0.25*((x-4)*(x+4))\r\n  ?delete.Count()>0\r\n    for d : delete\r\n      pewpews.Emplace(d,0)\r\n    for d : delete\r\n      remove=pewpews.IndexOf(0)\r\n      pewpews.RemoveAt(remove)\r\n    delete.Clear()\r\n\r\nlastrefX=screen.FromWorldX(pos.x)\r\nlastplayerX=pos.x\r\nguardboi.x=refX+cultX[0]\r\nheavygal.x=refX+cultX[1]\r\nmarksgal.x=refX+cultX[2]\r\nadeptboi.x=refX+cultX[3]\r\nsorceress.x=refX+cultX[4]\r\n/*\r\nfor x = -7..7\r\n  >`60,@x+8@,@math.FloorToInt((0.25*((x-4)*(x+4))+10))@\r\n  >`@x+50@,@math.FloorToInt((0.25*((x-4)*(x+4))+10))@,#cyan,•*/"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetBoo.txt" - Parse error: Failed to parse completely. Remaining: "= 42 //minimum distance\r\nvar totTime\r\nvar euler = 2.718281828459\r\nvar aiwalk\r\nvar foe_ = foe\r\nvar notRocky = (loc ! rocky)\r\nvar px = pos.x\r\nvar x = px - minDistance + 1\r\nvar pz = pos.z\r\nvar z = pz - 1\r\nvar pkup = pickup\r\nvar speed = 0\r\nvar markposX\r\nvar fallsleeptime = 150\r\nvar d\r\nvar t = 0\r\nvar sx\r\nvar bodyY\r\n\r\nvar timeToQuip = randGeometric(1.0/181)    //Time left to next quip.\r\nvar quipme = 0     //Are we currently saying a quip?\r\nvar quippos        //Where the quip starts, horizontally. A factor of the length of the quip's longest line.\r\nvar quipht         //Where the quip starts, vertically. A factor of the quip's line count.\r\nvar quipct         //The quip's line count.\r\nvar thequip        //The quip. A string, possibly cut into multiple lines by \\n's\r\nvar midquip        //A line of the quip that is to be put into an array\r\nvar quiplside      //The left side of the quip outline. Literally 2 to the left of the quip's left side.\r\nvar quiparr = []   //The quip, stored in an array of strings instead of 1 string with \\n's\r\nvar i              //for a for loop, to iterate the quip line by line.\r\nvar j              //for a for loop, to draw black squares in the quip text box before writing the quip.\r\nvar qoffx = 10\r\nvar qoffy = -1\r\nvar lastquip = \"\"\r\n\r\n////////////////////////////////////////////////\r\n\r\nBooMain()\r\n\r\n////////////////////////////////////////////////\r\n\r\nfunc initPetBoo()\r\n\r\n  var resetBoo = func()\r\n    BooPnlChildren[2].Stop()\r\n    BooPnlChildren[4].visible = false\r\n    BooPnlChildren[5].visible = false\r\n    BooPnlChildren[6].visible = false\r\n    BooPnlChildren[7].visible = false\r\n    happy = false\r\n    asleep = false\r\n    \r\n  ?ui.root.children.Count() > 0  // Oh no PetBoo is lost!\r\n    for u : ui.root.children\r\n      ?u.w = 66111\r\n        BooPnl = u\r\n        BooPnlChildren = BooPnl.children\r\n        txtBox = BooPnlChildren[6].children[0]\r\n        resetBoo()\r\n        return\r\n\r\n  var addAndInitAnim = func(anim, y, dur, loop)\r\n    BooPnl.Add(anim)\r\n    anim.anchor = top_left\r\n    anim.dock = top_left\r\n    anim.x = 0\r\n    anim.y = y\r\n    anim.duration = dur\r\n    anim.loop = loop\r\n    anim.Play()\r\n    \r\n  BooPnl = ui.AddPanel()\r\n  BooPnlChildren = BooPnl.children\r\n  BooPnl.w = 66111\r\n  BooPnl.h = 1\r\n  BooPnl.style = ui.AddStyle(\"#########\")\r\n  BooPnl.anchor = top_left\r\n  BooPnl.dock = top_left\r\n\r\n  addAndInitAnim(ui.AddAnim(ascii\r\n##.-.\r\n#(# #)#\r\n-´   `-\r\n%%\r\n##.-.\r\n_(# #)_\r\n`.   .´\r\n%%\r\n##.-.\r\n#(# #)\r\n-´   `-\r\n%%\r\n##.-.\r\n#(# #)\r\n#/   \\\r\nasciiend), 0, 40, true)\r\n\r\n  addAndInitAnim(ui.AddAnim(ascii\r\n##o#o#\r\n%%\r\n##=#=#\r\n%%\r\n##-#-#\r\n%%\r\n##-#-#\r\n%%\r\n##=#=#\r\n%%\r\n##o#o#\r\nasciiend), 1, 30, false)\r\n\r\n  addAndInitAnim(ui.AddAnim(ascii\r\n###°##\r\n%%\r\n######\r\n%%\r\n###o##\r\n%%\r\n###-##\r\n%%\r\n###O##\r\n%%\r\n###o##\r\n%%\r\n###-##\r\n%%\r\n###O##\r\n%%\r\n###-##\r\n%%\r\n###o##\r\n%%\r\n###-##\r\n%%\r\n###O##\r\n%%\r\n###-##\r\nasciiend), 2, 156, true)\r\n\r\n  addAndInitAnim(ui.AddAnim(ascii\r\n,_) /\r\n#`-´\r\n%%\r\n,_\\ (\r\n#`--´\r\n%%\r\n#,\\ (\r\n##`--'\r\n%%\r\n##\\ (\r\n###'-'\r\n%%\r\n##) /\r\n##'-'\r\n%%\r\n#,) /\r\n#'-´\r\nasciiend), 3, 18, true)\r\n\r\n  addAndInitAnim(ui.AddAnim(ascii\r\n#####Z##z\r\n##- -#\r\n###°##\r\n%%\r\n#######Z##z\r\n##- -#\r\n###O##\r\n%%\r\n#####z##Z\r\n##- -#\r\n###°##\r\n%%\r\n#######z##Z\r\n##- -#\r\n###O##\r\nasciiend), 0, 60, true)\r\n\r\n  addAndInitAnim(ui.AddAnim(ascii\r\n##^_^#\r\n### ##\r\nasciiend), 1, 30, true)\r\n\r\n  BooPnl.Add(ui.AddPanel())\r\n  BooPnlChildren[6].y = -1\r\n  BooPnlChildren[6].anchor = bottom_center\r\n  BooPnlChildren[6].dock = top_left\r\n  BooPnlChildren[6].x = 6\r\n  BooPnlChildren[6].color = #808080\r\n  BooPnlChildren[6].style = ui.AddStyle(\"\r\n^.─.\r\n^│ │\r\n^'─'\")\r\n  txtBox = ui.AddText(\"\")\r\n  BooPnlChildren[6].Add(txtBox)\r\n  txtBox.anchor = center_center\r\n  txtBox.dock = center_center\r\n  txtBox.align = left\r\n  BooPnl.Add(ui.AddText(\".,\\n/\"))\r\n  BooPnlChildren[7].anchor = bottom_center\r\n  BooPnlChildren[7].dock = top_left\r\n  BooPnlChildren[7].w = 2\r\n  BooPnlChildren[7].h = 2\r\n  BooPnlChildren[7].x = 6\r\n  BooPnlChildren[7].y = 0\r\n  BooPnlChildren[7].color = #808080\r\n  resetBoo()\r\n  \r\n\r\nfunc BooMain()\r\n  \r\n  totTime = totaltime\r\n  foe_ = foe\r\n  aiwalk = ai.walking\r\n  px = pos.x\r\n  pz = pos.z\r\n  pkup = pickup\r\n\r\n  ?totTime = 1\r\n    initPetBoo()\r\n\r\n  //5s fall asleep\r\n  ?speed = 0 & !aiwalk\r\n    fallsleeptime--\r\n    ?fallsleeptime <= 0\r\n      markposX = px\r\n  ?aiwalk\r\n    fallsleeptime = 150\r\n    ?asleep\r\n      BooPnlChildren[4].visible = false\r\n      asleep = false\r\n  d = px - minDistance\r\n  ?totTime = 1 | time = 1 & notRocky\r\n    x = d\r\n    z = pz\r\n    speed = 0\r\n    t = 0\r\n    quipme = 0\r\n    fallsleeptime = 150\r\n  ?x >= d\r\n    speed = 0\r\n  :?speed ! 1\r\n    ?x < d - 20 // 5 + 5 + 10\r\n      speed = 1\r\n    :?x < d - 10 // 5 + 5\r\n      speed = 2\r\n    :?x < d - 5 // 5\r\n      speed = 3\r\n  ?speed <= 1 | !(totTime % (speed - 1))\r\n    ?speed ! 0 & (x < d | z ! pz)\r\n      ?x < d\r\n        x++\r\n        ?speed = 1\r\n          t = (t + 1) % 30\r\n          ?t = 0\r\n            x++\r\n      ?z > pz\r\n        z--\r\n      :?z < pz\r\n        z++\r\n    :\r\n      t = 0\r\n\r\n  ?totTime % 180 = 0 // every 180 frames, blink for the first 30 frames.\r\n                      // 5 frames duration per each of 6 blinkframes.\r\n    BooPnlChildren[1].Play()\r\n\r\n  ?quipme > 0\r\n    quipme--\r\n    ?quipme = 1\r\n      BooPnlChildren[2].Stop()\r\n      BooPnlChildren[2].frame = 0\r\n      BooPnlChildren[6].visible = false\r\n      BooPnlChildren[7].visible = false\r\n      quipme = 0\r\n    :?asleep\r\n      BooPnlChildren[4].visible = false\r\n      asleep = false\r\n\r\n  :?speed = 0 & markposX = px //sleep with a snoring mouth\r\n    BooPnlChildren[2].Stop()\r\n    BooPnlChildren[2].frame = 0\r\n    ?!asleep\r\n      BooPnlChildren[4].visible = true\r\n      asleep = true\r\n\r\n  sx = x - px + 30\r\n  ?sx > -100\r\n    bodyY = z - pz + pos.y - 2\r\n  BooPnl.x = screen.FromWorldX(x + 30)\r\n  BooPnl.y = screen.FromWorldZ(z - 5)\r\n\r\n  ?foe_ = phase\r\n    ?happy = false & foe.hp <= 0\r\n      BooPnlChildren[5].visible = true\r\n      happy = true\r\n      ?asleep\r\n        BooPnlChildren[4].visible = false\r\n        asleep = false\r\n    :?happy = true & foe.hp > 0\r\n      BooPnlChildren[5].visible = false\r\n      happy = false\r\n\r\n  ?pkup = treasure & quipme <= 0\r\n    timeToQuip = 0\r\n\r\n  ?quipme = 0 & timeToQuip > 0\r\n    timeToQuip--\r\n  //If we're not saying a quip, check if we should start a new one.\r\n  :?timeToQuip = 0 & !asleep\r\n    //reset quip timer (you say it for 105 frames)\r\n    quipme = 106\r\n    BooPnlChildren[2].Play()\r\n    timeToQuip = 300 + randGeometric(1.0/181) // At least 10 seconds between quips\r\n    \r\n    //Get a quip and put that quip into an array.\r\n    thequip = getaquip()\r\n    thequip = te.xt(thequip) // Translate it\r\n    quiparr.Clear()\r\n    quiparr = string.Break(thequip, 16)\r\n    \r\n    //Find the maximum width of the lines in the quip, and set the variables for drawing the text box later.\r\n    quipct = quiparr.Count()\r\n    quippos = 0\r\n    for i = 0..quipct-1\r\n      midquip = quiparr[i]\r\n      ?quippos < string.Size(midquip)\r\n        quippos = string.Size(midquip)\r\n    BooPnlChildren[6].visible = true\r\n    BooPnlChildren[7].visible = true\r\n    txtBox.text = string.Join(\"\\n\", quiparr)\r\n    txtBox.h = quipct\r\n    txtBox.w = quippos\r\n    BooPnlChildren[6].h = quipct + 2\r\n    BooPnlChildren[6].w = quippos + 4\r\n    quippos=-quippos+1\r\n    quiplside=quippos-2\r\n    play boo_voice\r\n\r\nfunc randGeometric(p)\r\n  return math.FloorToInt(math.Log(rngf, 1-p))\r\n\r\nfunc getaquip()\r\n  var ds = debuffs.string\r\n  var php = hp\r\n  var pmaxhp = maxhp\r\n  var fs = foe.state\r\n  //place all valid quips in an array, then pick one at random\r\n  var a = [] //big array of potential things to say\r\n  var c = 0  //the random thing that gets said\r\n\r\n  a.Clear()\r\n\t\r\n  // **************************\r\n  // **** QUIPS START HERE ****\r\n  // **************************\r\n  ?pkup = treasure\r\n    a.Add(\"LOOT!!!\")\r\n  :\r\n    //Quips based on world.\r\n\r\n    //Quips based on your status\r\n    ?ai.walking\r\n      a.Add(\"I'm hovering\")\r\n      a.Add(\"*hums a tune*\")\r\n      a.Add(\"My dark world feels brighter by your side.\")\r\n      a.Add(\"This is much better than throwing stones.\\nOr mining!\")\r\n      a.Add(\"This is fun to watch!\")\r\n      a.Add(\"Let's see if you can get even stronger?\")\r\n      a.Add(\"What other cool weapons do you have?\")\r\n      a.Add(\"Can we get some snow cones after this?\")\r\n      a.Add(\"If you need, I can give you a little PUSH.\\nGet it? Haha\")\r\n    ?ds = debuff_dot\r\n      a.Add(\"SOOO HOOOT\")\r\n    ?ds = debuff_chill\r\n      a.Add(\"Oh no.\\nCold, isn't it?\")\r\n    ?ds = debuff_damage\r\n      a.Add(\"You're looking weaker...\")\r\n    ?php = pmaxhp\r\n      a.Add(\"So far, so good\")\r\n      a.Add(\"This is gonna be great!\")\r\n      a.Add(\"We're on an adventure!\")\r\n      a.Add(\"weeee\\nooooo\\nweeee\\nooooo\")\r\n      a.Add(\"You're in great form!\")\r\n    ?php < pmaxhp / 2\r\n      a.Add(\"Be careful to not be UNMADE!\")\r\n    ?armor > pmaxhp / 2\r\n      a.Add(\"Your defense is looking great!\")\r\n\t\t\r\n    //Quips based on location\r\n    ?loc = \"mine\"\r\n      a.Add(\"Being in the mines again is a strange feeling.\")\r\n      a.Add(\"Hello everyone! I'm back!\")\r\n\t\t\r\n    //Quips based on enemy status\r\n    ?fs = 33\r\n      a.Add(\"Oh I'm sorry, was that aimed at me?\")\r\n    ?fs = 115\r\n      a.Add(\"Uh oh what's that?\")\r\n    ?foe_ = nagaraja\r\n      a.Add(\"Oh no!\\nThe Tongue!!!\")\r\n    ?foe_ = boss & foe_ ! pallas\r\n      a.Add(\"I think you're gonna win.\")\r\n      a.Add(\"Boss? More like WUSS!\")\r\n      a.Add(\"They told me this fight would be HARD\")\r\n    ?foe_ = pallas\r\n      a.Add(\"THE GREAT FALLEN GOD!\")\r\n\t\t\r\n    //Random dependant quips\r\n    ?harvest.distance ! 9999\r\n      a.Add(\"What's this thing?\")\r\n    ?pkup\r\n      a.Add(\"LOOT!!!\")\r\n\t\r\n  //In case there are no other quips\r\n  //NOTE YOU NEED AT LEAST ONE OF THESE\r\n  //or the script will get errors if there are no quips.\r\n  ?a.Count() = 0\r\n    a.Add(\" ... \")\r\n  ?a.Count() = 1\r\n    a.Add(\" ... \")\r\n  //return 1 quip. Avoid returning the same as last time\r\n  c = a.IndexOf(lastquip)\r\n  ?c = -1\r\n    lastquip = a[rng % a.Count()]\r\n  :\r\n    var r = rng % (a.Count()-1)\r\n    ?r >= c\r\n      r++\r\n    lastquip = a[r]\r\n  return lastquip"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/TrainAdventure/Peak.txt" - Parse error: Failed to parse completely. Remaining: "#########################################################,:\r\n########################################################/ |\r\n#######################################################,' \\\r\n######################################################/    `. _##############################/\r\n####################################################,´      :´ ;###########################,' \r\nasciiend\r\n\r\n  >`@cliff_x@,@cliff_y@,#AAAAAA,ascii\r\n#########################################################,:\r\n########################################################/\r\n#######################################################,'\r\n######################################################/###### _##############################/\r\n####################################################,´######:´ ;###########################,'#\r\nasciiend\r\n\r\nfunc DrawFG(x, y)\r\n  return\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/TrainAdventure/Bridge.txt" - Parse error: Failed to parse completely. Remaining: ".'‾##`.\r\n    /##     \\\r\n   / _ ___###\\\r\n   \\'/    #\\`/\r\n    ‾|     |‾\r\n     \\    #/‾`-.\r\n    , )`|'(  .  `.\r\n_.-´    `         \\\r\n  `  .     `       \\\r\n             .   `\r\n `        `\r\n       .\r\n\r\n\r\n\r\n─,´──,´──,´──\r\n´‾‾‾´‾‾‾´‾‾‾\r\n `      `      . ;\r\n  .     .    `  /|\r\n     `    `  ,-' `\r\n    . ____,-´; |,|\r\n .  ,´ |  | `  ; |\r\n`  /|  :  ; | / /\r\n  / |  | ´  |  |\r\n.´|`; /    ;  :\r\n  / |    -'  |´\r\n '  |   ;    /\r\nasciiend\r\n\r\n  >`@x@,@y@,#AAAAAA,ascii\r\n########()\r\n#####()####_\r\n##########(_)\r\n##########`\r\n#\r\n##########,#‾`-.\r\n####,###########`.\r\n_.-´##############\\\r\n###################\\\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#################;\r\n################/\r\n#############,-'\r\n######____,-´\r\n####,´\r\n###/\r\n##/\r\n.´\r\nasciiend\r\n  \r\n  DrawBridgePart2(bridge1_x,bridge1_y,#666666)\r\n  DrawBridgeDeck(bridge2_x, bridge2_y,#444444)\r\n\r\nfunc DrawFG(x, y)\r\n  DrawBridgePart(bridge2_x,bridge2_y,#888888)\r\n\r\nfunc DrawBridgePart(dx, dy, color)\r\n  >`@dx@,@dy@,@color@,ascii\r\n###_###_#######_###_#######_###_#######_###_#######_###_\r\n#__\\\\_//_______\\\\#//_______\\\\_//_______\\\\_//_______\\\\_//__\r\n(___\\\\/_________\\\\/_________\\\\/_________\\\\/_________\\\\/___\r\n####/\\\\#########/\\\\#########/\\\\#########/\\\\#########/\\\\###\r\n###//#\\\\#######//#\\\\#######//#\\\\#######//#\\\\#######//#\\`##\r\n##//###\\\\#####//###\\\\######´###\\\\#####//###\\\\#####//###\\.#\r\n#//#####\\\\###//#####\\\\###/,#####\\\\###//#####\\\\###//#####\\\\\r\n‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾\r\nasciiend\r\n\r\nfunc DrawBridgePart2(dx, dy, color)\r\n  >`@dx@,@dy@,@color@,ascii\r\n###_###_#######_###_#######_###_#######_###_#######_###_\r\n#__\\\\_//_______\\\\#//_______\\\\_//_______\\\\_//_______\\\\_//__\r\n(___\\\\/_________\\\\/_________\\\\/_________\\\\/_________\\\\/___\r\n####/\\\\#########/\\\\#########/\\\\#########/\\\\#########/\\\\###\r\n###//#\\\\#######//#\\\\#######//#\\\\#######//#\\\\#######//#\\`##\r\n##//###\\\\#####//###\\\\######´###\\\\#####//###\\\\#####//###\\.#\r\n#//#####\\\\###//#####\\\\###/,#####\\\\###//#####\\\\###//#####\\\\\r\n─´´─────``───´´─────``───´´─────``───´´─────``───´´─────``\r\nasciiend\r\n\r\nfunc DrawBridgeDeck(dx, dy, color)\r\n  >`@dx@,@dy@,@color@,ascii\r\n#\r\n#\r\n#\r\n#\r\n###──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,\r\n###‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾\r\n### -   ## - ##   - ##-  ##   ´ ## - ## ´   ## - ##   - ##\r\nasciiend\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/TrainAdventure/Snow.txt" - Parse error: Failed to parse completely. Remaining: "##########################/ /     ,'                  ,´             '            '           \r\n########################.´ /     /                   /              /            /            \r\n#####################,´' ,/     /                   '               '           |             \r\n####################/ _ ,´    ,´                   /               /          ,-´             \r\n##################,´,´ ;      ;                 _,'               |          /               /\r\n#############__ ,^ /     ,-. /               .´‾             ^.  ,'    |\\   ;               . \r\n######__,──-´  /´ /     /   '               /  _            /  `/     /| `,´              ,´  \r\n###,-´  _   ^  .-´    ,´     /|        ,  ,´  ; `.         /  .´      ||.´              ;‾\\   \r\n          _  _/      /      / |\\      / `/   /    \\      ,´         _,-´               /   `._\r\n     _      / `    ,´      | ´||   .-´      ;-.    '    ´        _.'    ____          /       \r\n  -             _          | / \\          .´   \\    `.                 /´   `::._   .´        \r\n          _          _    ,|/| |: _                    _          _   /  _    `::`.        _  \r\n                          '::. :'        _          _                / .´ \\    `'::`:._       \r\n                                     _                       _    .-´ ·^·  `, ·    `'::'`·    \r\n    ._                                                                                        \r\n   `._`──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,\r\n\\    _‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾\r\n|`.           _                 _                      _                           _          \r\n| |\\     -                   -           _  .--..               _         _                   \r\n' : '.__                                  .´    )::..              .-..               _       \r\n| \\ |  |`──-.___  -  _   .-..        -  .´     (  `'::..  _      .´   ):..    -     .-..    _ \r\n#\\  \\  |   |   |`─-.__ .´   ):..     ..´        ):.   `'::......´   ,´  `':..     .´   ):..   \r\n##|    :   ;   | | | .´   ,´  `':..::'         ´   `' .                    `'::..´   ,´  `':..\r\n###:   `  \\      '    ______       __,-───-─.        _____,─-─.___      __,───-─-.______      \r\n###`|  \\  |`-──.___,-´|    |`─-──-'| || `   |`-──-──'| `  |´  || |`──-─´| ||   , ||  ´ |`─-───\r\n#####\\    '| ` |   |  `    ||   ` || '|   , \\ |'    ||  . ' . \\| '| `  |´ /| '   |'    '|   ' \r\n######`.    \\  \\   |   \\   `| '   || |´       |   ` |´ ,  |    |  `  ´ |   |  ´  |  ,   ` .   \r\nasciiend\r\n\r\n  >`@cliff_x@,@cliff_y@,#AAAAAA,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#############__\r\n######__,──-´\r\n###,-´\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n\\\r\n#`.\r\n###\\\r\n####'.__\r\n########`──-.___\r\n################`─-.__\r\n#\r\n##########\\###########______#######__,-───-─.########_____,─-─.___######__,───-─-.______\r\n###########`-──.___,-´######`─-──-'##########`-──-──'#############`──-─´################`─-───\r\nasciiend\r\n  \r\n  DrawBridgePart2(bridge1_x,bridge1_y,#666666)\r\n  DrawBridgeDeck(bridge2_x,bridge2_y,#444444)\r\n\r\nfunc DrawFG(x, y)\r\n  DrawBridgePart(bridge2_x,bridge2_y,#888888)\r\n\r\nfunc DrawBridgePart(dx, dy, color)\r\n  >`@dx@,@dy@,@color@,ascii\r\n#####_###_#######_###_#######_###_#######_###_\r\n_____\\\\#//_______\\\\_//_______\\\\_//_______\\\\_//__\r\n______\\\\/_________\\\\/_________\\\\/_________\\\\/___)\r\n######/\\\\#########/\\\\#########/\\\\#########/\\\\\r\n#####//#\\\\#######//#\\\\#######//#\\\\#######//#`\r\n####//###\\\\######´###\\\\#####//###\\\\#####//####.\r\n###//#####\\\\###/,#####\\\\###//#####\\\\###//#####\\\\\r\n‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾\r\nasciiend\r\n\r\nfunc DrawBridgePart2(dx, dy, color)\r\n  >`@dx@,@dy@,@color@,ascii\r\n#####_###_#######_###_#######_###_#######_###_\r\n_____\\\\#//_______\\\\_//_______\\\\_//_______\\\\_//__\r\n______\\\\/_________\\\\/_________\\\\/_________\\\\/___)\r\n######/\\\\#########/\\\\#########/\\\\#########/\\\\\r\n#####//#\\\\#######//#\\\\#######//#\\\\#######//#`\r\n####//###\\\\######´###\\\\#####//###\\\\#####//####.\r\n###//#####\\\\###/,#####\\\\###//#####\\\\###//#####\\\\\r\n───´´─────``───´´─────``───´´─────``───´´─────``─\r\nasciiend\r\n\r\nfunc DrawBridgeDeck(dx, dy, color)\r\n  >`@dx@,@dy@,@color@,ascii\r\n#\r\n#\r\n#\r\n#\r\n───,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´────## ´\r\n‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾‾‾\r\n - ##  ´  ##   ##   ´ ##   ##   - ##   ## -   ## ,\r\nasciiend\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/TrainAdventure/Sleeper.txt" - Parse error: Failed to parse completely. Remaining: "= #666666\r\nvar colorRockLit = #888888\r\nvar illuminated = false\r\n\r\n//cloud scrolling variables\r\nvar cloud_sx = screen.w/2 - 10\r\nvar cloud_x = cloud_sx\r\nvar cloud_w = 8\r\n\r\nvar colorDream = #AAAAAA\r\n\r\n//animation state variables\r\nvar clouddone = false\r\nvar cloudstate = 0\r\n\r\nvar zdone = false\r\nvar zstate = 0\r\n\r\nvar cloud = true\r\nvar cloudFading = false\r\nvar zwait = false\r\nvar zzz = false\r\n\r\nvar cloudWaitCount = 0\r\nvar cloudWaitUntil = 120\r\n\r\nvar zWaitCount = 0\r\nvar zWaitUntil = 30\r\n\r\n//leave button variables\r\nvar btnLeaveX = 0\r\nvar btnLeaveY = screen.h-3\r\nvar btnLeaveH = 3\r\nvar btnLeaveW = 5\r\nvar txtLeaveX = btnLeaveX+2\r\nvar txtLeaveY = btnLeaveY+1\r\nvar colorBtn = #DDDDDD\r\n\r\n\r\n?loc.begin\r\n  // set music\r\n  ambient.Stop()\r\n  music.Play(shop)\r\n  \r\n  // register leave button\r\n  var pnlMain = ui.AddPanel()\r\n  pnlMain.visible = false\r\n  pnlMain.anchor = top_left\r\n  pnlMain.dock = top_left\r\n  pnlMain.x = -2\r\n  \r\n  var btnLeave = ui.AddButton()\r\n  btnLeave.h = 3\r\n  btnLeave.w = 5\r\n  btnLeave.x = 0\r\n  btnLeave.y = screen.h-4\r\n  btnLeave.text = \"X\"\r\n  btnLeave.visible = true\r\n  btnLeave.SetPressed(loc.Leave)\r\n  pnlMain.Add(btnLeave)\r\n\r\n\r\n?cloud\r\n  ?cloudWaitCount < cloudWaitUntil\r\n    cloudWaitCount++\r\n  :\r\n    cloud = false\r\n    cloudFading = true\r\n\r\n?cloud | cloudFading\r\n  ?(gt_1t % 15) = 0\r\n    cloud_x--\r\n    ?cloud_x < cloud_sx - cloud_w\r\n      cloud_x = cloud_x + cloud_w\r\n\r\n?cloudFading\r\n  ?cloudstate < 10\r\n    ?(gt_1t % 3) = 0\r\n      ?!clouddone\r\n        clouddone = true\r\n        cloudstate++\r\n    :\r\n      clouddone = false\r\n  :\r\n    ?cloudstate < 16\r\n        cloudstate++\r\n    :\r\n      cloudFading = false\r\n      zwait = true\r\n\r\n?zwait\r\n  ?zWaitCount < zWaitUntil\r\n    zWaitCount++\r\n  :\r\n    zwait = false\r\n    zzz = true\r\n    gt_1t = 1\r\n\r\n?zzz & (gt_1t % 10) = 0\r\n  ?!zdone\r\n    zdone = true\r\n    zstate++\r\n    ?zstate > 3\r\n      zstate = 0\r\n:\r\n  zdone = false\r\n\r\n\r\ndraw.Clear()\r\nDraw(screen.w/2 - 3,screen.h/2)\r\n\r\nfunc Draw(x, y)\r\n  DrawFire(x-15,y-1)\r\n  DrawSleeper(x, y, #white)\r\n  DrawDream(x-7,y-5,#white)\r\n  DrawZs(x+6, y-5, #white)\r\n  \r\n  // draw leave button\r\n  >`@btnLeaveX@,@btnLeaveY@,@colorBtn@,ascii\r\n┌───┐\r\n│ # │\r\n└───┘\r\nasciiend\r\n  >`@txtLeaveX@,@txtLeaveY@,X\r\n\r\n\r\n\r\nfunc DrawDream(x, y, color)\r\n  ?!cloud & !cloudFading\r\n    return\r\n  \r\n  ?cloudstate < 9\r\n    DrawClouds(cloud_x, y+2, cloud_w, #666666)\r\n    >`@x-8@,@y+2@,        \r\n  \r\n  ?cloudstate = 0\r\n    >`@x@,@y@,@color@,ascii\r\n##_____\r\n#(  c' )_\r\n(###^#,##)        \r\n#‾‾‾‾‾‾‾‾O\r\n##########°.\r\nasciiend\r\n    >`@x@,@y@,@colorDream@,ascii\r\n##_____\r\n#(#####)_\r\n(########)\r\n#‾‾‾‾‾‾‾‾O\r\n##########°.\r\nasciiend\r\n  :?cloudstate = 1\r\n    >`@x@,@y@,@color@,ascii\r\n##_____\r\n#(  c' )_\r\n(###^#,##)        \r\n#‾‾‾‾‾‾‾‾o\r\n##########' \r\nasciiend\r\n    >`@x@,@y@,@colorDream@,ascii\r\n##_____\r\n#(#####)_\r\n(########)\r\n#‾‾‾‾‾‾‾‾o\r\n##########'\r\nasciiend\r\n  :?cloudstate = 2\r\n    >`@x@,@y@,@color@,ascii\r\n##_____\r\n#(  c' )_\r\n(###^#,##)        \r\n#‾‾‾‾‾‾‾‾.\r\n# \r\nasciiend\r\n    >`@x@,@y@,@colorDream@,ascii\r\n##_____\r\n#(#####)_\r\n(########)\r\n#‾‾‾‾‾‾‾‾.\r\n#\r\nasciiend\r\n  :?cloudstate = 3\r\n    >`@x@,@y@,@color@,ascii\r\n##_____\r\n#(  c' )_\r\n(###^#,##)        \r\n#‾‾‾‾‾‾‾‾\r\n# \r\nasciiend\r\n    >`@x@,@y@,@colorDream@,ascii\r\n##_____\r\n#(#####)_\r\n(########)\r\n#‾‾‾‾‾‾‾‾\r\n#\r\nasciiend\r\n  :?cloudstate = 4\r\n    >`@x@,@y@,@color@,ascii\r\n###____\r\n##( c' )_\r\n (##^#,##)        \r\n##‾‾‾‾‾‾‾\r\n# \r\nasciiend\r\n    >`@x@,@y@,@colorDream@,ascii\r\n###____\r\n##(####)_\r\n#(#######)\r\n##‾‾‾‾‾‾‾\r\n#\r\nasciiend\r\n  :?cloudstate = 5\r\n    >`@x@,@y@,@color@,ascii\r\n####__\r\n###(c')_\r\n  (#^#,#)        \r\n###‾‾‾‾‾\r\n# \r\nasciiend\r\n    >`@x@,@y@,@colorDream@,ascii\r\n####__\r\n###(##)_\r\n##(#####)\r\n###‾‾‾‾‾\r\n#\r\nasciiend\r\n  :?cloudstate = 6\r\n    >`@x@,@y@,@color@,ascii\r\n####_\r\n###(c)_\r\n  (#^#,)        \r\n###‾‾‾‾\r\n# \r\nasciiend\r\n    >`@x@,@y@,@colorDream@,ascii\r\n####_\r\n###(#)_\r\n##(####)\r\n###‾‾‾‾\r\n#\r\nasciiend\r\n  :?cloudstate = 7\r\n    >`@x@,@y@,@color@,ascii\r\n#\r\n####()_\r\n   (#^#)        \r\n####‾‾‾\r\n# \r\nasciiend\r\n    >`@x@,@y@,@colorDream@,ascii\r\n#\r\n####()_\r\n###(###)\r\n####‾‾‾\r\n#\r\nasciiend\r\n  :?cloudstate = 8\r\n    >`@x@,@y@,@colorDream@,ascii\r\n#\r\n####o_\r\n   (##)        \r\n####‾‾\r\n#\r\nasciiend\r\n  :?cloudstate = 9\r\n    >`@x@,@y@,@colorDream@,ascii\r\n#\r\n#\r\n####8o\r\n#\r\n#\r\nasciiend\r\n  :?cloudstate = 10 | cloudstate = 21\r\n    >`@x@,@y@,@color@,ascii\r\n#\r\n#\r\n####.\r\n#\r\n# \r\nasciiend\r\n  :?cloudstate = 11 | cloudstate = 20\r\n    >`@x@,@y@,@color@,ascii\r\n#\r\n#\r\n####+\r\n#\r\n# \r\nasciiend\r\n  :?cloudstate = 12 | cloudstate = 19\r\n    >`@x@,@y@,@color@,ascii\r\n#\r\n####,\r\n###-+-\r\n####'\r\n# \r\nasciiend\r\n  :?cloudstate = 13 | cloudstate = 18\r\n    >`@x@,@y@,@color@,ascii\r\n#\r\n####|\r\n###─+─\r\n####|\r\n#\r\nasciiend\r\n  :?cloudstate = 14 | cloudstate = 17\r\n    >`@x@,@y@,@color@,ascii\r\n####,\r\n####│\r\n##-─ ─-\r\n####│\r\n####'\r\nasciiend\r\n  :?cloudstate = 15\r\n    >`@x@,@y@,@color@,ascii\r\n####|\r\n####'\r\n##─   ─\r\n####,\r\n####|\r\nasciiend\r\n\r\nfunc DrawClouds(x, y, w, color)\r\n  >`@x@,@y@,@color@,─  - ── \r\n  >`@x+w@,@y@,@color@,─  - ── \r\n\r\nfunc DrawSleeper(x, y, color)\r\n  >`@x@,@y@,@color@,ascii\r\n_.,-,O\r\n#‾##´\r\nasciiend\r\n\r\nfunc DrawZs(zx, zy, color)\r\n  ?!zzz\r\n    return\r\n  \r\n  ?zstate = 0\r\n    >`@zx@,@zy@,@color@,ascii\r\n#\r\n#\r\n#\r\n#\r\n.\r\nasciiend\r\n  :?zstate = 1\r\n    >`@zx@,@zy@,@color@,ascii\r\n#\r\n#\r\n#\r\n#z\r\nasciiend\r\n  :?zstate = 2\r\n    >`@zx@,@zy@,@color@,ascii\r\n#\r\n#\r\n##z\r\nasciiend\r\n  :\r\n    >`@zx@,@zy@,@color@,ascii\r\n###Z\r\nasciiend\r\n\r\nfunc DrawFire(x,y)\r\n  var xt = x+2\r\n  var xb = x+1\r\n  var yb = y+1\r\n  \r\n  // update timers\r\n  fTick++\r\n  fTick = fTick % 5\r\n  sTick++\r\n  sTick = sTick % (10 * (rng%2 + 1))\r\n  LTick++\r\n  LTick = LTick % (5 * (rng%2 + 1))\r\n  \r\n  // on fire tick, advance fire animations and smoke\r\n  ?fTick = 0\r\n    fFireT++\r\n    fFireT = fFireT % 4\r\n    fFireB++\r\n    fFireB = fFireB % 6\r\n  \r\n  // on light tick, flicker lit surfaces\r\n  //?LTick = 0\r\n  //  illuminated = !illuminated\r\n  \r\n  // draw rocks\r\n  ?illuminated\r\n    >`@x@,@y@,@colorRockLit@,ascii\r\n#.##•\r\nO####o\r\n#o##O\r\nasciiend\r\n  :\r\n    >`@x@,@y@,@colorRock@,ascii\r\n#####\r\n.####.\r\n#O##o\r\nasciiend\r\n  \r\n  // draw flame\r\n  ?fFireT = 0\r\n    >`@xt@,@y@,#white,ascii\r\n(`\r\nasciiend\r\n  :?fFireT = 1\r\n    >`@xt@,@y@,#white,ascii\r\n(,\r\nasciiend\r\n  :?fFireT = 2\r\n    >`@xt@,@y@,#white,ascii\r\n,)\r\nasciiend\r\n  :?fFireT = 3\r\n    >`@xt@,@y@,#white,ascii\r\n´)\r\nasciiend\r\n\r\n  ?fFireB = 0\r\n    >`@xb@,@yb@,#white,ascii\r\n#',)\r\nasciiend\r\n  :?fFireB = 1\r\n    >`@xb@,@yb@,#white,ascii\r\n#`.)\r\nasciiend\r\n  :?fFireB = 2\r\n    >`@xb@,@yb@,#white,ascii\r\n(` #\r\nasciiend\r\n  :?fFireB = 3\r\n    >`@xb@,@yb@,#white,ascii\r\n#,')\r\nasciiend\r\n  :?fFireB = 4\r\n    >`@xb@,@yb@,#white,ascii\r\n(.´#\r\nasciiend\r\n  :?fFireB = 5\r\n    >`@xb@,@yb@,#white,ascii\r\n( ´#\r\nasciiend\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/TrainAdventure/Mushrooms.txt" - Parse error: Failed to parse completely. Remaining: "?bg1_x = -1000 //TODO set to x= trigger point for mushrooms\r\n    bg1_x = x - bg1_dx\r\n    bg2_x = x - bg2_dx\r\n  \r\n  mt_1t++\r\n  ?(mt_1t % 4) = 0\r\n    bg1_x--\r\n  \r\n  ?(mt_1t % 5) = 0\r\n    bg2_x--\r\n  \r\n  bg1_y = y - bg1_dy\r\n  bg2_y = y - bg2_dy\r\n  \r\n  fg1_y = y - fg1_dy\r\n  fg1_x = x - fg1_dx\r\n\r\n\r\n\r\nfunc Draw(x, y)\r\n  >`@bg2_x@,@bg2_y@,#444444,ascii\r\n                                                        \r\n                    _      _,---.____                   \r\n              __.--' \\ ,--'          `--.               \r\n         _.-,'        V                  \\_             \r\n        ,                                  )            \r\n       (                                  /             \r\n        ‾\\              .'‾‾‾`.         /‾              \r\n          ‾`-.    ,--'‾‾       ‾‾‾‾‾`-'‾                \r\n              ‾‾‾‾                                      \r\n                                                        \r\n                                                        \r\nasciiend\r\n\r\n  >`@bg2_x@,@bg2_y@,#666666,ascii\r\n#\r\n#\r\n###########################:'\r\n#######################':::::###########:\r\n#########:.##############::::'#########.::.\r\n########:::.#############:::.##########:::\r\n##########:'###########.###############:\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\n  >`@bg1_x@,@bg1_y@,#444444,ascii\r\n###\\    _     _    /#,-.#################/.--'   `--.\\\r\n####`-.__\\ | /__.-'#/   \\################`.___| |___.'\r\n#########< . >#####( ,-. )##############.-.##<'-,>######/‾\\\r\n##########| |#######`| |'############.'‾___‾`-|#|######(.-.)\r\n##########| |########| |####.'‾‾,`.#/'‾ .-  `-| |#######| |\r\n##########| |########| |###/,-----.\\`-.__\\ \\_.| |##.-.##| |\r\n##########| |########| |####`-\\ \\-'#####/‾\\ \\#| |#/,-.\\#, ;\r\n##########| |########| |#######`.`._###(.-.) \\| |\\`| |'/ /\r\n##########| |########| |#########`-._`-._\\\\#\\ | |)‾| |/ |;\r\n##_#######| |####_##' ' `#######_####`-._ \\`(\\| /,`|,'  /\r\n######-##( ' )#############-############,)`#/'/' /'  `'\\ `\r\nasciiend\r\n\r\n  >`@x@,@y@,#666666,ascii\r\n###############################|   |#################################|    |  \r\n###############################|   |#################################|    |  \r\n###############################|#  |###########.' ##‾‾ `.############|  # |  \r\n###############################|   |#########,'      ### `.##########|    |  \r\n###############################|   |########/    ###   ### \\#########|    |  \r\n###############################| # |#######|###  ###    ### |########|#   |  \r\n######.'‾##`.##################|   |#######|    ________    |########|    |  \r\n#####/##     \\#################|   |########\\.-'/     #\\`-./#########|    |  \r\n####/ _ ___###\\################|#  |#########`-|       #|-'##########|  # |  \r\n####\\'/    #\\`/################|   |###########|      # |############|    |  \r\n#####‾|     |‾#################|   |###########|       #|###########/ ,  ` \\ \r\n######\\    #/######_##########/' | '\\######_####\\    ,//#_#########(  |  |  )\r\n#`##.##)`|'(##`#####.##.###`##\\  |  /##`####`###/`)  ('\\.####`###`##\\ \\  / / \r\n###`#####.#####.##`#####`#####.#######.###`####`####.#####`######.####`####. \r\n#\r\n──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´─\r\n‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾\r\n  .       `     `      . `         `    .       `      .          `     `    \r\n    .       .                                                 `             `\r\n `      `      .        `             .        `     `   .           .   .   \r\n     .               `       .     `        .               `   .          ` \r\n   `       `      .                    `         . .        `           .    \r\n.       .         `       .       `         `           `           `       `\r\n`     `               `         .        .            .       `          `   \r\n          .      `          `         .          `         `      `        . \r\n  `  .        `       .         .           `         .              `      /\r\n`        `      .          `          .         `              `       .   / \r\nasciiend\r\n\r\n  >`@x@,@y@,#AAAAAA,ascii\r\n#\r\n#################################\r\n################################|#################()####################|\r\n#####################################################(_)\r\n#################################################,-.###,-.\r\n#################################|##########(_)##`-'####‾\\)###########|\r\n#########()\r\n######()####_#########################################`\r\n###########(_)##################|######################:################|\r\n###########`##########################################:\r\n#######################################################;\r\n###########,#########################################,/\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n############################################################################/\r\n###########################################################################/\r\nasciiend\r\n\r\nfunc DrawFG(x, y)\r\n  >`@fg1_x@,@fg1_y@,#444444,ascii\r\n########################################### ,---.####################\r\n####,--'‾‾‾‾‾‾‾‾‾‾`--.########.--.#######,'‾     ‾`.#######.--.######\r\n#.'‾     -'`          ‾`.###,'    `.##.--. '     `  \\####,'    `.####\r\n/       '                \\#(        )(_  _).-.'   \\ /###(        )###\r\n|                        |##`-,--.-'###|'#(_ _)  |###.-.#`-.--.-'####\r\n#\\                      /###,' ,'######|.##//#######(_ _)###`. \\#####\r\nasciiend\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/TrainAdventure/Main.txt" - Parse error: Failed to parse completely. Remaining: "= 80 //-160 //-250\r\nvar y = 0\r\n\r\nvar train_x = 25 //-30 //25\r\nvar train_y = 10\r\nvar color = #DDDDDD\r\n\r\nvar star_state = 0\r\nvar train_bridge_state = 0\r\nvar train_cliff_state = 0\r\n\r\nvar moon_x = 40\r\nvar moon_y = 0\r\n\r\nvar star_x = 0\r\nvar star_y = 0\r\n\r\nvar water_x = 36\r\nvar wide_water_x = 0\r\nvar water_y = screen.h - 9\r\n\r\nvar cloud_x = 0\r\nvar cloud_y = 11 //end up at 17\r\nvar cloud_spread = 3\r\n\r\nvar x_c1 = 0\r\nvar x_c2 = 0\r\nvar x_c3 = 0\r\nvar x_c4 = 0\r\nvar x_c5 = 0\r\n\r\nvar w_c1 = 44\r\nvar w_c2 = 54\r\nvar w_c34 = 79\r\nvar w_c5  = 49\r\n\r\n// scenery objects and variables\r\nvar peak = new Cosmetics/TrainAdventure/Peak\r\nvar mtn = new Cosmetics/TrainAdventure/Mountain\r\nvar snow = new Cosmetics/TrainAdventure/Snow\r\nvar bridge = new Cosmetics/TrainAdventure/Bridge\r\nvar mushrooms = new Cosmetics/TrainAdventure/Mushrooms\r\nvar deadwood = new Cosmetics/TrainAdventure/Deadwood\r\nvar start = new Cosmetics/TrainAdventure/DeadwoodStart\r\n\r\nvar start_dx = -80\r\nvar deadwood_dx = 0\r\nvar mushrooms_dx = deadwood_dx + 77\r\nvar bridge_dx = mushrooms_dx + 77\r\nvar snow_dx = bridge_dx + 69\r\n\r\nvar mtn_dx = snow_dx\r\nvar mtn_dy = -27\r\n\r\nvar peak_dx = snow_dx\r\nvar peak_dy = mtn_dy - 5\r\n\r\n// snow particle variables\r\nvar p_snow = []\r\nvar p_snowBig = []\r\nvar p_x = 0\r\nvar p_y = 0\r\nvar snowBig = False\r\n\r\nvar btnLeaveX = 2\r\nvar btnLeaveY = screen.h-4\r\nvar btnLeaveH = 3\r\nvar btnLeaveW = 11\r\nvar txtLeave = te.xt(\"Leave\")\r\nvar txtLeaveX = btnLeaveX + btnLeaveW/2 - string.Size(txtLeave)/2\r\nvar txtLeaveY = btnLeaveY+1\r\nvar colorBtn = #808080\r\n\r\n\r\n\r\n//- SETUP -\r\n?loc.begin\r\n  // set music\r\n  ambient.Stop()\r\n  music.Play(fire_loop)   //force music to switch by playing another track first\r\n  music.Stop()\r\n  music.Play(credits)\r\n  \r\n  // register leave button\r\n  var pnlMain = ui.AddPanel()\r\n  pnlMain.visible = false\r\n  pnlMain.anchor = top_left\r\n  pnlMain.dock = top_left\r\n  \r\n  var btnLeave = ui.AddButton()\r\n  btnLeave.h = btnLeaveH\r\n  btnLeave.w = btnLeaveW\r\n  btnLeave.x = btnLeaveX+1\r\n  btnLeave.y = btnLeaveY-1\r\n  btnLeave.text = te.xt(\"Leave\")\r\n  btnLeave.visible = true\r\n  btnLeave.SetPressed(loc.Leave)\r\n  pnlMain.Add(btnLeave)\r\n\r\n\r\n\r\n//- TIMING CONTROLS -\r\n// counter variables\r\nvar gt_1t = 0\r\nvar gt_1s = 0\r\n\r\nvar f_wheels = 0\r\nvar f_r_wheels = 24\r\n\r\nvar f_smoke = 0\r\nvar f_r_smoke = 16\r\n\r\nvar tlogo_1t = 0\r\n\r\n// state variables\r\nvar t_trainIn = true\r\nvar t_wave = false\r\nvar f_wave = 0\r\nvar f_waveDone = false\r\nvar t_scrollUp = false\r\nvar f_scrollUp = 0\r\nvar t_trainWrap = false\r\nvar t_animDone = false\r\nvar pressed_x = false\r\n\r\n\r\n\r\n// advance counters\r\ngt_1t++\r\n\r\n?(gt_1t % 30) = 0\r\n  gt_1s++\r\n\r\nf_wheels--\r\n?f_wheels <= 0\r\n  f_wheels = f_r_wheels\r\n\r\nf_smoke--\r\n?f_smoke <= 0\r\n  f_smoke = f_r_smoke\r\n\r\n// timer for logo display\r\n?t_animDone & tlogo_1t < 1000\r\n  tlogo_1t++\r\n\r\n// engineer wave\r\n?t_wave\r\n  ?(gt_1t % 5) = 0\r\n    ?!f_waveDone\r\n      f_waveDone = true\r\n      f_wave++\r\n      \r\n      ?f_wave > 17\r\n        t_wave = false\r\n  :\r\n    f_waveDone = false\r\n\r\n\r\n// advance coords\r\n// stop and scroll upwards at x = -275\r\n?(gt_1t % 3) = 0\r\n\r\n  //train arrives\r\n  ?t_trainIn\r\n    ?train_x = 25\r\n      t_trainIn = false\r\n    \r\n    train_x++\r\n  \r\n  //horizontal scroll\r\n  :?x > -275\r\n    x--\r\n  \r\n  //pause and allow train to move\r\n  :?(!t_scrollUp) & (train_x > 55)\r\n    t_scrollUp = true\r\n    train_x++\r\n  \r\n  //wrap train to tunnel\r\n  :?(!t_trainWrap) & (train_x > 111)\r\n    t_trainWrap = true\r\n    train_x = 6\r\n    train_y -= 26\r\n  :? train_x < 128\r\n    train_x++\r\n  \r\n  //vertical scroll\r\n  ?t_scrollUp\r\n    ?y < 46\r\n      f_scrollUp++\r\n      ?f_scrollUp % 3 = 0\r\n        y++\r\n        train_y++\r\n    :?!t_animDone\r\n      t_animDone = true\r\n\r\n\r\n\r\n//trigger engineer wave\r\n?x = 60\r\n  t_wave = true\r\n\r\n\r\n\r\n// generate snow particles\r\n?x < -198\r\n  snowBig = false\r\n  \r\n  //select top/side\r\n  ?rng % 2 = 0\r\n    p_x = rng % screen.w\r\n    p_y = 0\r\n  :\r\n    snowBig = (rng%5 = 0)\r\n    p_x = screen.w-1\r\n    p_y = rng % screen.h\r\n  \r\n  // add particle\r\n  ?snowBig\r\n    p_snowBig.Add( [p_x,p_y] )\r\n  :\r\n    p_snow.Add( [p_x,p_y] )\r\n  \r\n  // remove excess snow\r\n  ?p_snow.Count() > 20\r\n    p_snow.RemoveAt(0)\r\n  \r\n  ?p_snowBig.Count() > 5\r\n    p_snowBig.RemoveAt(0)\r\n\r\n//scroll clouds\r\n?(gt_1t % 30) = 0\r\n  x_c5--\r\n  ?x_c5 < -w_c5\r\n    x_c5 = x_c5 + w_c5\r\n\r\n?(gt_1t % 10) = 0\r\n  x_c4--\r\n  ?x_c4 < -w_c34\r\n    x_c4 = x_c4 + w_c34\r\n\r\n?(gt_1t % 5) = 0\r\n  x_c3--\r\n  ?x_c3 < -w_c34\r\n    x_c3 = x_c3 + w_c34\r\n\r\n?(gt_1t % 4) = 0\r\n  x_c2--\r\n  ?x_c2 < -w_c2\r\n    x_c2 = x_c2 + w_c2\r\n\r\n?(gt_1t % 2) = 0\r\n  x_c1--\r\n  ?x_c1 < -w_c1\r\n    x_c1 = x_c1 + w_c1\r\n\r\n//perspective scroll up\r\nvar ss = false\r\n?t_scrollUp & (y > 15 & y < 46)\r\n  ?y%10 = 0\r\n    ?ss\r\n      ss = false\r\n      cloud_y = cloud_y + 2\r\n      cloud_spread--\r\n  :\r\n    ss = true\r\n\r\n\r\n\r\n//- MAIN LOOP -\r\ndraw.Clear()\r\nUpdate()\r\nDraw()\r\n\r\n\r\n\r\n//- HELPER FUNCTIONS -\r\nfunc Update()\r\n  ?DeadwoodOnScreen()\r\n    start.Update(x+start_dx, y)\r\n    deadwood.Update(x+deadwood_dx, y)\r\n  ?MushroomsOnScreen()\r\n    mushrooms.Update(x+mushrooms_dx, y)\r\n  ?BridgeOnScreen()\r\n    bridge.Update(x+bridge_dx, y)\r\n  ?SnowOnScreen()\r\n    snow.Update(x+snow_dx, y)\r\n  ?MtnOnScreen()\r\n    mtn.Update(x+mtn_dx, y+mtn_dy)\r\n  ?PeakOnScreen()\r\n    peak.Update(x+peak_dx, y+peak_dy)\r\n  \r\n  ?x < -150 & star_state < 15\r\n    ?x%3 = 0\r\n      star_state++\r\n  \r\n  ?x = -108\r\n    train_bridge_state = 1\r\n  :?x = -116\r\n    train_bridge_state = 2\r\n  :?x = -126\r\n    train_bridge_state = 3\r\n  :?x = -136\r\n    train_bridge_state = 4\r\n  :?x = -216\r\n    train_bridge_state = 5\r\n  :?x = -224\r\n    train_bridge_state = 6\r\n  :?x = -234\r\n    train_bridge_state = 7\r\n  :?x = -244\r\n    train_bridge_state = 8\r\n  \r\n  ?t_trainWrap\r\n    ?train_x = 14\r\n      train_cliff_state = 1\r\n    :?train_x = 22\r\n      train_cliff_state = 2\r\n    :?train_x = 33\r\n      train_cliff_state = 3\r\n    :?train_x = 42\r\n      train_cliff_state = 4\r\n    :?train_x = 51\r\n      train_cliff_state = 5\r\n    :?train_x = 62\r\n      train_cliff_state = 6\r\n\r\nfunc PeakOnScreen()\r\n  return ( (x+peak_dx < screen.w+5) )\r\n\r\nfunc MtnOnScreen()\r\n  return ( (x+mtn_dx < screen.w+5) )\r\n\r\nfunc SnowOnScreen()\r\n  return ( (x+snow_dx < screen.w+5) & (y+mtn_dy < screen.h+5) )\r\n\r\nfunc BridgeOnScreen()\r\n  return ( (x+bridge_dx < screen.w+5) & (x+snow_dx+5 > 0) )\r\n\r\nfunc MushroomsOnScreen()\r\n  return ( (x+mushrooms_dx < screen.w+5) & (x+bridge_dx > 0) )\r\n\r\nfunc DeadwoodOnScreen()\r\n  return ( (x+deadwood_dx < screen.w+5) & (x+mushrooms_dx > 0) )\r\n\r\nfunc BridgeStateHit(idx)\r\n  return (train_bridge_state = idx) | (train_bridge_state = idx+4)\r\n\r\nfunc CliffStateHit(idx)\r\n  return (train_cliff_state = idx)\r\n\r\nfunc AdjustCliffY(y, down, down2, up)\r\n  ?train_cliff_state <= up\r\n    ?train_cliff_state >= down2\r\n      return (y+2)\r\n    :?train_cliff_state >= down\r\n      return (y+1)\r\n    :\r\n      return y\r\n  \r\n  return (y+1)\r\n\r\nfunc AdjustBridgeY(y, up, down)\r\n  ?train_bridge_state >= up & train_bridge_state <= down\r\n    return (y-1)\r\n  return y\r\n\r\nfunc GetStarColor(state)\r\n  ?  state = 0\r\n    return #000000\r\n  :? state = 15\r\n    return #FFFFFF\r\n  :? state = 1\r\n    return #111111\r\n  :? state = 2\r\n    return #222222\r\n  :? state = 3\r\n    return #333333\r\n  :? state = 4\r\n    return #444444\r\n  :? state = 5\r\n    return #555555\r\n  :? state = 6\r\n    return #666666\r\n  :? state = 7\r\n    return #777777\r\n  :? state = 8\r\n    return #888888\r\n  :? state = 9\r\n    return #999999\r\n  :? state = 10\r\n    return #AAAAAA\r\n  :? state = 11\r\n    return #BBBBBB\r\n  :? state = 12\r\n    return #CCCCCC\r\n  :? state = 13\r\n    return #DDDDDD\r\n  :? state = 14\r\n    return #EEEEEE\r\n  :\r\n    return #FFFFFF\r\n\r\nfunc Draw()\r\n  //draw sky elements\r\n  DrawStars(star_x, star_y, GetStarColor(star_state))\r\n  DrawMoon(moon_x, moon_y)\r\n  DrawWater(water_x, wide_water_x, water_y)\r\n  DrawClouds(cloud_x, cloud_y, cloud_spread)\r\n\r\n  //draw BG and terrain\r\n  ?MushroomsOnScreen()\r\n    mushrooms.Draw(x+mushrooms_dx, y)\r\n  ?DeadwoodOnScreen()\r\n    start.Draw(x+start_dx, y)\r\n    deadwood.Draw(x+deadwood_dx, y)\r\n  ?BridgeOnScreen()\r\n    bridge.Draw(x+bridge_dx, y)\r\n  ?SnowOnScreen()\r\n    snow.Draw(x+snow_dx, y)\r\n  ?MtnOnScreen()\r\n    mtn.Draw(x+mtn_dx, y+mtn_dy)\r\n    peak.Draw(x+peak_dx, y+peak_dy)\r\n\r\n  //draw train\r\n  ?t_trainWrap\r\n    DrawTrainCliff(train_x, train_y)\r\n  :\r\n    DrawTrain(train_x, train_y)\r\n\r\n  //draw FG\r\n  ?MushroomsOnScreen()\r\n    mushrooms.DrawFG(x+mushrooms_dx, y)\r\n  ?DeadwoodOnScreen()\r\n    start.DrawFG(x+start_dx, y)\r\n    deadwood.DrawFG(x+deadwood_dx, y)\r\n  ?BridgeOnScreen()\r\n    bridge.DrawFG(x+bridge_dx, y)\r\n  ?SnowOnScreen()\r\n    snow.DrawFG(x+snow_dx, y)\r\n  ?MtnOnScreen()\r\n    mtn.DrawFG(x+mtn_dx, y+mtn_dy)\r\n    peak.DrawFG(x+peak_dx, y+peak_dy)\r\n  \r\n  //draw UI\r\n  DrawTitle(3,0)\r\n  DrawLeaveButton()\r\n  \r\n  //draw particles\r\n  DrawUpdateSnow()\r\n\r\n\r\n\r\nfunc DrawTrain(tx, ty)\r\n  DrawCaboose(tx,   AdjustBridgeY(ty+2, 4,7) )\r\n  DrawBoxcar(tx+11, AdjustBridgeY(ty+2, 3,6) )\r\n  DrawTinder(tx+21, AdjustBridgeY(ty+3, 2,5) )\r\n  DrawEngine(tx+29, AdjustBridgeY(ty+2, 1,4) )\r\n  \r\n  DrawChain(tx+9,  AdjustBridgeY(ty+4, 4,7), 3)\r\n  DrawChain(tx+19, AdjustBridgeY(ty+4, 3,6), 2)\r\n  DrawChain(tx+27, AdjustBridgeY(ty+4, 2,5), 1)\r\n  \r\n  DrawSmoke(tx, AdjustBridgeY(ty, 1,4) )\r\n  \r\n  DrawEngineer(tx+28, AdjustBridgeY(ty+2, 1,4) )\r\n\r\nfunc DrawTrainCliff(tx, ty)\r\n  ?tx > 32\r\n    DrawCaboose(tx,   AdjustCliffY(ty+2, 4,5,6) )\r\n  ?tx > 22\r\n    DrawBoxcar(tx+11, AdjustCliffY(ty+2, 3,4,5) )\r\n  ?tx > 12\r\n    DrawTinder(tx+21, AdjustCliffY(ty+3, 2,3,4) )\r\n  DrawEngine(tx+29, AdjustCliffY(ty+2, 1,2,3) )\r\n  \r\n  ?tx > 30\r\n    DrawChainCliff(tx+9,  AdjustCliffY(ty+4, 3,4,6), 3,4,6)\r\n  ?tx > 20\r\n    DrawChainCliff(tx+19, AdjustCliffY(ty+4, 2,3,5), 2,3,5)\r\n  ?tx > 12\r\n    DrawChainCliff(tx+27, AdjustCliffY(ty+4, 1,2,4), 1,2,4)\r\n  \r\n  DrawSmoke(tx, AdjustCliffY(ty, 1,2,3) )\r\n  \r\n  DrawEngineer(tx+28, AdjustCliffY(ty+2, 1,2,3) )\r\n\r\nfunc DrawEngine(x, y)\r\n  >`@x@,@y@,@color@,ascii\r\n#_\r\n| |#_|\r\n|-─-.()\r\n'o‾oo`\\\\\r\nasciiend\r\n  ?f_wheels > 20\r\n    >`@x@,@y@,@color@,ascii\r\n#\r\n#\r\n#\r\n#O#OO\r\nasciiend\r\n\r\nfunc DrawTinder(x, y)\r\n  >`@x@,@y@,@color@,ascii\r\n#,:;.\r\n|‾‾‾‾|\r\n'o‾‾o'\r\nasciiend\r\n  ?f_wheels > 16 & f_wheels <= 20\r\n    >`@x@,@y@,@color@,ascii\r\n#\r\n#\r\n#O##O\r\nasciiend\r\n\r\nfunc DrawBoxcar(x, y)\r\n  >`@x@,@y@,@color@,ascii\r\n#______\r\n|\\|‾‾|´|\r\n|,|''|\\|\r\n'oo‾‾oo'\r\nasciiend\r\n  ?f_wheels > 12 & f_wheels <= 16\r\n    >`@x@,@y@,@color@,ascii\r\n#\r\n#\r\n#\r\n#OO##OO\r\nasciiend\r\n\r\nfunc DrawCaboose(x, y)\r\n  >`@x@,@y@,@color@,ascii\r\n___┬──┬__\r\n`|╓┐╓┐╓┐|\r\n||╙┘╙┘╙┘|\r\n‾'oo‾‾oo'\r\nasciiend\r\n  ?f_wheels > 8 & f_wheels <= 12\r\n    >`@x@,@y@,@color@,ascii\r\n#\r\n#\r\n#\r\n##OO##OO\r\nasciiend\r\n\r\nfunc DrawChain(cx, cy, idx)\r\n  ?BridgeStateHit(idx)\r\n    ?train_bridge_state = idx+4\r\n      >`@cx@,@cy@,@color@,ascii\r\n`.\r\nasciiend\r\n    :\r\n      >`@cx@,@cy@,@color@,ascii\r\n,´\r\nasciiend\r\n  :\r\n    >`@cx@,@cy@,@color@,ascii\r\n……\r\nasciiend\r\n\r\nfunc DrawChainCliff(cx, cy, down, down2, up)\r\n  ?CliffStateHit(up)\r\n    >`@cx@,@cy@,@color@,ascii\r\n.´\r\nasciiend\r\n  :?CliffStateHit(down) | CliffStateHit(down2)\r\n    >`@cx@,@cy@,@color@,ascii\r\n`.\r\nasciiend\r\n  :\r\n    >`@cx@,@cy@,@color@,ascii\r\n……\r\nasciiend\r\n\r\nfunc DrawEngineer(x, y)\r\n  ?f_wave = 0| f_wave > 17\r\n    >`@x@,@y@,@color@,ascii\r\n#\r\n##O\r\nasciiend\r\n  :?f_wave = 1| f_wave = 17\r\n    >`@x@,@y@,@color@,ascii\r\n#\r\n#O,\r\nasciiend\r\n  :?f_wave = 2| f_wave = 16\r\n    >`@x@,@y@,@color@,ascii\r\nO\r\n#\\\r\nasciiend\r\n  :?f_wave = 3| f_wave = 15\r\n    >`@x@,@y@,@color@,ascii\r\nO\r\n`\\\r\nasciiend\r\n  :?f_wave = 4| f_wave = 14\r\n    >`@x@,@y@,@color@,ascii\r\nO\r\n(\\\r\nasciiend\r\n  :?f_wave = 5 | f_wave = 13\r\n    >`@x@,@y@,@color@,ascii\r\nO'\r\n(\\\r\nasciiend\r\n  :?f_wave = 6 | f_wave = 8 | f_wave = 10 | f_wave = 12\r\n    >`@x@,@y@,@color@,ascii\r\nO)\r\n(\\\r\nasciiend\r\n  :?f_wave = 7 | f_wave = 9 | f_wave = 11\r\n    >`@x@,@y@,@color@,ascii\r\nO/\r\n(\\\r\nasciiend\r\n\r\nfunc DrawUpdateSnow()\r\n  for p : p_snow\r\n    p[0] = p[0]-3\r\n    p[1] = p[1]+1\r\n    \r\n    p_x = p[0]\r\n    p_y = p[1]\r\n    >`@p_x@,@p_y@,#DDDDDD,.\r\n    //·\r\n  \r\n  for p : p_snowBig\r\n    p[0] = p[0]-4\r\n    p[1] = p[1]+1\r\n    \r\n    p_x = p[0]\r\n    p_y = p[1]\r\n    >`@p_x@,@p_y@,#DDDDDD,❄\r\n\r\nfunc DrawSmoke(sx, sy)\r\n  ?f_smoke > 12\r\n    >`@sx+34@,@sy+2@,@color@,.\r\n  :?f_smoke > 8\r\n    >`@sx+33@,@sy+2@,@color@,°\r\n  :?f_smoke > 4\r\n    >`@sx+32@,@sy+1@,#AAAAAA,o\r\n  :\r\n    >`@sx+31@,@sy@,#888888,O\r\n\r\nfunc DrawMoon(mx, my)\r\n  >`@mx@,@my@,#white,ascii\r\n###_,._######_\r\n#,´ ,´ `####((\r\n/  /#########‾\r\n|  '\r\n\\   `.__,/\r\n#`._  _,´\r\n####‾‾\r\nasciiend\r\n\r\nfunc DrawStars(sx, sy, s_color)\r\n  >`@sx@,@sy@,@s_color@,ascii\r\n#################################.###########################·###############\r\n#·###################################################################################.\r\n#\r\n######################·#################################·###################·\r\n#############################·####################################.\r\n#\r\n##########.\r\n##################·##############################################################.\r\n#######################################·####################·\r\n#############·##################################.######################·\r\n####·\r\n#########################·###########################·\r\nasciiend\r\n\r\nfunc DrawWater(wx, wide_wx, wy)\r\n  ?x <= -275\r\n    return\r\n  \r\n  >`@wide_wx@,@wy@,#444444,ascii\r\n         _       -       _     ~    #################       _                  _         \r\n_                                   ################# -          ~                  -    \r\n  _  ~               _            _ #################                   _                \r\n                _            _      #################      _                             \r\n           _           -            #################  _           _           ~        _\r\n     _                            _ #################                                    \r\n                     ~              #################        ~         _         _       \r\n      _                   _         #################                                 ~  \r\n _           _                   -  #################    _                 -        _    \r\nasciiend\r\n\r\n  >`@wx@,@wy@,@color@,ascii\r\n  _    -      -  \r\n-    _   _  -  _ \r\n  _    ~         \r\n -  _      -  ~  \r\n      -     _    \r\n  _  _     _    -\r\n-       ~     _  \r\n  ~   _    _     \r\n _  -   _   ~   _\r\nasciiend\r\n\r\nfunc DrawClouds(cx, cy, cs)\r\n  ?x > -275\r\n    return\r\n  \r\n  DrawClouds5(cx+x_c5,         cy, #444444)\r\n  DrawClouds5(cx+x_c5+ w_c5,   cy, #444444)\r\n  DrawClouds5(cx+x_c5+ 2*w_c5, cy, #444444)\r\n  \r\n  DrawClouds34(cx+x_c4,          cy+cs+1, #444444)\r\n  DrawClouds34(cx+x_c4+ w_c34,   cy+cs+1, #444444)\r\n  DrawClouds34(cx+x_c4+ 2*w_c34, cy+cs+1, #444444)\r\n  \r\n  DrawClouds34(cx+x_c3,          cy+2*cs+3, #444444)\r\n  DrawClouds34(cx+x_c3+ w_c34,   cy+2*cs+3, #444444)\r\n  DrawClouds34(cx+x_c3+ 2*w_c34, cy+2*cs+3, #444444)\r\n  \r\n  DrawClouds2(cx+x_c2,         cy+3*cs+4, #444444)\r\n  DrawClouds2(cx+x_c2+ w_c2,   cy+3*cs+4, #444444)\r\n  DrawClouds2(cx+x_c2+ 2*w_c2, cy+3*cs+4, #444444)\r\n  \r\n  DrawClouds1(cx+x_c1,         cy+4*cs+7, #444444)\r\n  DrawClouds1(cx+x_c1+ w_c1,   cy+4*cs+7, #444444)\r\n  DrawClouds1(cx+x_c1+ 2*w_c1, cy+4*cs+7, #444444)\r\n\r\nfunc DrawClouds5(cx, cy, color)\r\n  >`@cx@,@cy@,@color@,ascii\r\n -- __ - -- _ -- __ -- _ -- - _ -- __ - __ _ - __\r\nasciiend\r\n\r\nfunc DrawClouds34(cx, cy, color)\r\n  >`@cx@,@cy@,@color@,ascii\r\n  -.-.  ,-,- ──.  ,- ── -.  ,-,──. ,─,─  -──.-.  ,──,── -.-.  ,-,- ──. ,─ ── ─.\r\nasciiend\r\n\r\nfunc DrawClouds2(cx, cy, color)\r\n  >`@cx@,@cy@,@color@,ascii\r\n   _,-.__    _,--._    _,-.    _ ,-,--._    _,-._,-._ \r\n  ( (‾   )  (  ‾‾  )  ( (‾‾)  ( (‾ ‾‾‾) )  ( ‾(‾  ‾) )\r\nasciiend\r\n\r\nfunc DrawClouds1(cx, cy, color)\r\n  >`@cx@,@cy@,@color@,ascii\r\n   ,( ‾)_    (‾),     ,-(‾ )      _,(‾‾)‾)\r\n  (‾  ‾) )  (‾( ‾)  (‾(‾   ‾)‾)  (  (   ‾)‾)\r\nasciiend\r\n\r\nfunc DrawTitle(x, y)\r\n  ?t_animDone\r\n    ?tlogo_1t > 75\r\n      DrawTitleStone(x, y, #white)\r\n    ?tlogo_1t > 125\r\n      DrawTitleStory(x, y+6, #white)\r\n    ?tlogo_1t > 178\r\n      DrawTitleRPG(x+12,y+15,#white)\r\n\r\nfunc DrawTitleStone(x, y, color)\r\n  >`@x@,@y@,@color@,ascii\r\n########################_\r\n#############,--._#####'-\\-´\r\n#######,----/-.,_#`-.___.'\r\n#####,(-,#_/____#`'---´\r\n#_##(\\#‾##//##_###)-,###,-.\r\n/#`,#\\)##//##(_)#/#//##((-'\r\n'.__.´###`‾#####´##`-´##`-´\r\nasciiend\r\n\r\nfunc DrawTitleStory(x, y, color)\r\n  >`@x@,@y@,@color@,ascii\r\n############,\r\n#####,--,#_/____\r\n#_##(\\#´##//##_###/-,#,##(\r\n/#`.#\\)##//##(_)#/###//#//\r\n'.__\\´###`-´#########'-//\r\n#####`,-\"-.,_###,-.###//\r\n####,'#`._###`'----)-´´\r\n##,-\\-.###`'-.,,.-´\r\n#####‾\r\nasciiend\r\n\r\nfunc DrawTitleRPG(x, y, color)\r\n  >`@x@,@y@,@color@,RPG\r\n\r\nfunc DrawLeaveButton()\r\n  // draw leave button after animation completes\r\n  ?t_animDone & tlogo_1t > 240\r\n    >`@btnLeaveX@,@btnLeaveY@,@colorBtn@,ascii\r\n┌─────────┐\r\n│         │\r\n└─────────┘\r\nasciiend\r\n    >`@txtLeaveX@,@txtLeaveY@,@te.xt(\"Leave\")@\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/TrainAdventure/Deadwood.txt" - Parse error: Failed to parse completely. Remaining: "?bg1_x = -1000 //TODO set to x= trigger point for mushrooms\r\n    bg1_x = x - bg1_dx\r\n    bg2_x = x - bg2_dx\r\n  \r\n  mt_1t++\r\n  ?(mt_1t % 4) = 0\r\n    bg1_x--\r\n  \r\n  ?(mt_1t % 5) = 0\r\n    bg2_x--\r\n  \r\n  bg1_y = y - bg1_dy\r\n  bg2_y = y - bg2_dy\r\n  \r\n  fg1_y = y - fg1_dy\r\n  fg1_x = x - fg1_dx\r\n\r\n\r\n\r\nfunc Draw(x, y)\r\n  >`@x@,@y@,#666666,ascii\r\n │ ││  │ │  │ │  │  │  ││  │ │ ││  │ │   │ │ │ │ ││ │ │ │ │ │  │  │  │\\\r\n │ ││  │ │  │ │  │  `  ││  │ │ ││  │ │   │ │ │ │ │| │ │ │ │ │  |  │  `│`\r\n │ ││  ` │  │ │  │  │  ││  │ │ ││  │ │   │ │ │ │ ││ │ │ │ │ │  │  │  ││ ,\r\n │ ││  │ │  │ │  │  │  ││  │ │ `│  │ │   │ │ | │ ││ │ │ │ │ │  │  │  │| │\r\n │ ││  │ │  | │  │  │  ││  │ | ││  │ │   │ │ │ │ ││ │ │ │ │ `  │  │  ││ '\\\r\n │ ││  │ │  │ │  │  │  `│  │ │ ││  │ │   ` | │ │ |│ │ │ │ │ │  │  │  ││  │`. \r\n │ ││  │ │  │ │  │  │  ││  │ │ ││  | │   │ │ │ │ ││ │ │ │ │ │  │  │  `│  \\ │\\\r\n !/\\│-'\\ │ /'-!_/\\_ │  ││  |_│ '│__│ │ '/`\\_ │ '/\\│-'_│ │/'-!_/\\_ │  ││  | ││\r\n/‾      \\│'        `-__│/`-' \\_│-  `-│_/    \\│/‾      `-'        `-__│/`-'‾\\│\r\n   `                `                    `                    `             `\r\n              `                   `                `                      `  \r\n        `                                       `                            \r\n                       `                                               `     \r\n#\r\n#\r\n´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´\r\n‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾\r\n             `                     `                            `            \r\n                   `                             `                `          \r\n  `                        `                        `                        \r\n          `                           `                     `              ` \r\n                       `                 `                              `    \r\n     `                          `                                    `       \r\n`              `                             `         `                    `\r\n__,-'-,-,--_,--,_--,_/`--,-,__,'-,_/`-._-,__,-'-,-,_,--_,--,_--,_/`--,-,__   \r\n|'| || |' '|  | '| | |  '|'   | '| |' '|  |  '|   |'   '|  |'  | |   | ' \\`. \r\n~~^~~     ~~     ~~-~     ~^-~-~        ~~^~   ~  ~~~   ~^     -~-~    ~^~- \\\r\nasciiend\r\n\r\n  >`@x@,@y@,#888888,ascii\r\n#\r\n#\r\n#\r\n###########################################################|,\r\n#####################################################-\\_\\ \\|  |/\r\n#####.###################################################\\ | \\/--\r\n#####|#,##############################################-,_`|| /-,\r\n###`-|/##################################################\\\\^/\r\n#####}####################################################} {\r\n#####{####################################################{ }\r\n####/|\\###################################################} {\r\n########################################################‾//`,\\-\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n##################################################################|#,\r\n################################################################`-|/\r\n##################################################################}\r\n##################################################################{\r\n#################################################################/|\\\r\n#\r\n__,-'-,-,--_,--,_--,_/`--,-,__,'-,_/`-._-,__,-'-,-,_,--_,--,_--,_/`--,-,__\r\n##########################################################################`.\r\n############################################################################\\\r\nasciiend\r\n\r\nfunc DrawFG(x, y)\r\n  >`@x@,@y@,#888888,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n####################################\\|\r\n#################################-\\| ||/\r\n##################################‾\\,'/-,\r\n####################################{}\r\n####################################}{\r\n####################################{}\r\n###################################//'\\\r\nasciiend\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/TrainAdventure/DeadwoodStart.txt" - Parse error: Failed to parse completely. Remaining: "?bg1_x = -1000 //TODO set to x= trigger point for mushrooms\r\n    bg1_x = x - bg1_dx\r\n    bg2_x = x - bg2_dx\r\n  \r\n  mt_1t++\r\n  ?(mt_1t % 4) = 0\r\n    bg1_x--\r\n  \r\n  ?(mt_1t % 5) = 0\r\n    bg2_x--\r\n  \r\n  bg1_y = y - bg1_dy\r\n  bg2_y = y - bg2_dy\r\n  \r\n  fg1_y = y - fg1_dy\r\n  fg1_x = x - fg1_dx\r\n\r\n\r\n\r\nfunc Draw(x, y)\r\n  >`@x@,@y@,#666666,ascii\r\n││ │ ││  │ │ ││  │ │  │ │  │  │  ││  │ │ ││  │ │   │ │ │ │ ││ │ │ │ │ │  │  │  │\\\r\n│` | ││  ` │ ││  │ │  │ │  │  `  ││  │ │ ││  │ │   │ │ │ │ │| │ │ │ │ │  |  │  `│`\r\n││ │ ││  │ │ ││  ` │  │ │  │  │  ││  │ │ ││  │ │   │ │ │ │ ││ │ │ │ │ │  │  │  ││ ,\r\n││ │ `│  │ │ ││  │ │  │ │  │  │  ││  │ │ `│  │ │   │ │ | │ ││ │ │ │ │ │  │  │  │| │\r\n││ │ ││  │ │ ││  │ │  | │  │  │  ││  │ | ││  │ │   │ │ │ │ ││ │ │ │ │ `  │  │  ││ '\\\r\n│| │ ││  │ │ ││  │ │  │ │  │  │  `│  │ │ ││  │ │   ` | │ │ |│ │ │ │ │ │  │  │  ││  │`. \r\n`│ │ ││  ` │ ││  │ │  │ │  │  │  ││  │ │ ││  | │   │ │ │ │ ││ │ │ │ │ │  │  │  `│  \\ │\\\r\n││ │_'│  │ !/\\│-'\\ │ /'-!_/\\_ │  ││  |_│ '│__│ │ '/`\\_ │ '/\\│-'_│ │/'-!_/\\_ │  ││  | ││\r\n|/`' `-__│/‾      \\│'        `-__│/`-' \\_│-  `-│_/    \\│/‾      `-'        `-__│/`-'‾\\│\r\n‾            `                `                    `                    `             `\r\n      `                 `                   `                `                      `  \r\n                  `                                       `\r\n `                               `                                               `     \r\n#\r\n#\r\n´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──,´──\r\n‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´‾‾‾´\r\n     `                 `                     `                            `            \r\n                             `                             `                `          \r\n `          `                        `                        `                        \r\n       `            `                           `                     `              ` \r\n                                 `                 `                              `    \r\n`              `                          `                                    `       \r\n     `    `              `                             `         `                    `\r\n,_.--,_,-,__,-'-,-,--_,--,_--,_/`--,-,__,'-,_/`-._-,__,-'-,-,_,--_,--,_--,_/`--,-,__   \r\n '|  | |' |'| || |' '|  | '| | |  '|'   | '| |' '|  |  '|   |'   '|  |'  | |   | ' \\`. \r\n -~   ~-  ~~^~~     ~~     ~~-~     ~^-~-~        ~~^~   ~  ~~~   ~^     -~-~    ~^~- \\\r\nasciiend\r\n\r\n  >`@x@,@y@,#888888,ascii\r\n#\r\n#\r\n#\r\n#####################################################################|,\r\n###############################################################-\\_\\ \\|  |/\r\n###############.###################################################\\ | \\/--\r\n###############|#,##############################################-,_`|| /-,\r\n#############`-|/##################################################\\\\^/\r\n###############}####################################################} {\r\n###############{####################################################{ }\r\n##############/|\\###################################################} {\r\n##################################################################‾//`,\\-\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n############################################################################|#,\r\n##########################################################################`-|/\r\n############################################################################}\r\n############################################################################{\r\n###########################################################################/|\\\r\n#\r\n,_.--,_,-,__,-'-,-,--_,--,_--,_/`--,-,__,'-,_/`-._-,__,-'-,-,_,--_,--,_--,_/`--,-,__\r\n####################################################################################`.\r\n######################################################################################\\\r\nasciiend\r\n\r\nfunc DrawFG(x, y)\r\n  >`@x@,@y@,#888888,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#########################################\\|\r\n######################################-\\| ||/\r\n#######################################‾\\,'/-,\r\n#########################################{}\r\n#########################################}{\r\n#########################################{}\r\n########################################//'\\\r\nasciiend\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/TrainAdventure/Mountain.txt" - Parse error: Failed to parse completely. Remaining: "###################################################/    . ´   ,###########################/   \r\n##################################################,    |      |`.#########################'   \r\n#################################################/     ,      '  \\######################/‾    \r\n################################################´     '        `. \\#####################,     \r\n###############################################;     .           : '####################|     \r\n##############################################/      ;   _        \\ \\##################,;     \r\n#############################################,'     /     `.       `.'###############.´/     '\r\n#############################################;    ,´        \\        |############,´  '     / \r\n############################################/    '           `.       '##########/   /      | \r\n##########################################,'    /      '        `.     \\#######.´  .´      /  \r\n#########################################/     ´        \\         \\     `.##.´   ,´       '   \r\n########################################'                .         \\      \\´    /       ,´    \r\n#######################################/           __     `. _      .      `.  '   _   /      \r\n######################################|         ,´‾  `.    ;´ \\      '.      `/   ; `.'       \r\n######################################;         :     ;   ,    `,      \\     '   /    \\       \r\n#####################################.´         |     |  '  _ ,´ `      .       ;-.    '      \r\n#####################################|     .    |-  _ '    / `.     ,-.  `    .´   `        _ \r\n####################################/      '\\  |`._       _        ´  _'          _       _   \r\n##################################,´       | `.| | `─-.____        _           _        ____,─\r\n#################################;        /'   \\ | ´   | ' `───-.__________,─-──-´‾‾‾‾‾‾||´         \r\n################################/       ,´       `/  , '  . |   || ´  ,    |'    |'     |'    \r\n###############################/        '       ,´          `;  |'          ;    '            \r\n###############################'       /       /            /              /               _.-\r\n##############################/        |       :          .´         ,\\   '              .'   \r\n#############################,        /       /          /          '  `./            .´      \r\n############################,|       '       '           |         /   ,´            /        \r\n###########################/ ;      /                   /        ,´   ;            ,´         \r\nasciiend\r\n  \r\n  >`@cliff_x@,@cliff_y@,#AAAAAA,ascii\r\n###################################################/####.#´###,###########################/\r\n##################################################,####|######|###########################'\r\n#################################################/#####,######'#########################/‾\r\n################################################´#####'########`.########################\r\n###############################################;#################:#######################\r\n##############################################/##########_########\\####################,;\r\n#############################################,'###########`.#######`.################.´/\r\n#############################################;##############\\########|################'\r\n############################################/################`.#######'##############/\r\n##########################################,'####################`.#####\\###########.´\r\n#########################################/########################\\#####`.#######,´\r\n########################################'##########################\\######\\#####/\r\n#######################################/###########__###############.######`.##'\r\n######################################|#########,´‾##`.##############'.######`/\r\n######################################;#########:#####;################\\\r\n#####################################.´#########|#####|#################.\r\n#####################################|##########|#####'##################`\r\n####################################/###########`._\r\n##################################,´###############`─-.____#############################____,─\r\n#################################;#########################`───-.__________,─-──-´‾‾‾‾‾‾\r\nasciiend\r\n\r\nfunc DrawFG(x, y)\r\n  >`@cliff_x@,@cliff_y@,#AAAAAA,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n###################################################__\r\n#######################################         ,´‾\r\n#######################################         :\r\n#######################################         |\r\n#######################################         |\r\nasciiend\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/AcronianGuardian.txt" - Parse error: Failed to parse completely. Remaining: ":\r\nasciiend\r\n\r\n>`2,25,@atkcolor@,ascii\r\nÖ\r\nasciiend\r\n\r\n>`1,25,#white,ascii\r\n<#>\r\nasciiend\r\n\r\n>`6,25,#white,ascii\r\n@hp*127@/@maxhp*127@\r\nasciiend\r\n\r\n>`0,25,@wingcolor@,ascii\r\n^###^ \r\nasciiend\r\n\r\nvar EH\r\nvar EyeX\r\n\r\n?time = 1\r\n play bearer4_talk_evolving\r\n EyeX = 0\r\n?time = 40\r\n play bearer5_talk\r\n\r\nvar wingcolor\r\nvar atkcolor\r\nvar bod\r\n\r\nwingcolor = #8f9101\r\natkcolor = #yellow\r\nbod = #fffdd4\r\n?loc = icy |\r\n^buffs.string = chill\r\n wingcolor = #0095a6\r\n atkcolor = #cyan\r\n bod = #d4fffe\r\n?foe = boss |\r\n^buffs.string = berserk\r\n wingcolor = #ba0000\r\n atkcolor = #red\r\n bod = #ffd4d4\r\n\r\n?time % 40 < 10\r\n EH = 0\r\n >o@-15+EyeX@,-4,@wingcolor@,ascii\r\n##/‾‾‾‾‾`.\r\n#/  `     `.\r\n#\\   _____` \\\r\n##\\`/#####`,/\r\n###\\;\r\nasciiend\r\n\r\n?time % 40 > 9 &\r\n^time % 40 < 20\r\n EH = 0\r\n >o@-15+EyeX@,-5,@wingcolor@,ascii\r\n###/‾‾‾‾‾‾‾`.\r\n##/   `      \\\r\n#/`_____     |\r\n#\\/#####`. ` |\r\n##########`.,/\r\nasciiend\r\n\r\n?time % 40 > 19 &\r\n^time % 40 < 30\r\n EH = -1\r\n play bat_wing 125\r\n >o@-15+EyeX@,-4,@wingcolor@,ascii\r\n#########____\r\n###/‾‾‾‾‾  ` \\\r\n###\\ `  ___.,/\r\n####\\  /_/\\\r\n#####\\ ‾` /\r\n######‾‾‾‾\r\nasciiend\r\n\r\n?time % 40 > 29 &\r\n^time % 40 <= 40\r\n EH = 0\r\n >o@-15+EyeX@,-3,@wingcolor@,ascii\r\n##/‾‾‾‾‾`.\r\n#/  `     `.\r\n#\\   _____` \\\r\n##\\`/#####`,/\r\n###\\;\r\nasciiend\r\n\r\n?time % 40 < 10\r\n >o@5+EyeX@,-4,@wingcolor@,ascii\r\n###.´‾‾‾‾‾\\\r\n#.´     ´  \\\r\n/ ´_____   /\r\n\\.´#####\\´/\r\n########;/\r\nasciiend\r\n\r\n?time % 40 > 9 &\r\n^time % 40 < 20\r\n >o@4+EyeX@,-5,@wingcolor@,ascii\r\n#.´‾‾‾‾‾‾‾\\\r\n/      ´   \\\r\n|     _____´\\\r\n| ´ .´#####\\/\r\n\\,.´\r\nasciiend\r\n\r\n?time % 40 > 19 &\r\n^time % 40 < 30\r\n >o@4+EyeX@,-4,@wingcolor@,ascii\r\n#____\r\n/ ´  ‾‾‾‾‾\\\r\n\\,.___  ´ /\r\n###/\\_\\  /\r\n###\\ ´‾ /\r\n####‾‾‾‾\r\nasciiend\r\n\r\n?time % 40 > 29 &\r\n^time % 40 <= 40\r\n >o@5+EyeX@,-3,@wingcolor@,ascii\r\n###.´‾‾‾‾‾\\\r\n#.´     ´  \\\r\n/ ´_____   /\r\n\\.´#####\\´/\r\n########;/\r\nasciiend\r\n\r\n?time % 40 < 10\r\n >o@-8+EyeX@,2,@wingcolor@,ascii\r\n/‾‾‾|\r\n| ´/\r\n\\_(\r\nasciiend\r\n\r\n?time % 40 > 9 &\r\n^time % 40 < 20\r\n >o@5+EyeX@,0,@wingcolor@,ascii\r\n#.´‾‾‾`.\r\n/    ´ |\r\n#`‾‾‾‾\\/\r\nasciiend\r\n\r\n?time % 40 > 29 &\r\n^time % 40 <= 40\r\n >o@5+EyeX@,1,@wingcolor@,ascii\r\n#.´‾‾‾`.\r\n/    ´ |\r\n#`‾‾‾‾\\/\r\nasciiend\r\n\r\n?time % 40 < 10\r\n play bat_wing_small 100\r\n >o@6+EyeX@,2,@wingcolor@,ascii\r\n|‾‾‾\\\r\n#\\` |\r\n##)_/\r\nasciiend\r\n\r\n?time % 40 > 9 &\r\n^time % 40 < 20\r\n >o@-10+EyeX@,0,@wingcolor@,ascii\r\n.´‾‾‾`.\r\n| `   \\\r\n\\/‾‾‾‾´\r\nasciiend\r\n\r\n?time % 40 > 29 &\r\n^time % 40 <= 40\r\n >o@-10+EyeX@,1,@wingcolor@,ascii\r\n.´‾‾‾`.\r\n| `   \\\r\n\\/‾‾‾‾´\r\nasciiend\r\n\r\n?foe ! boss &\r\n^time % 70 < 65 &\r\n^buffs.string ! berserk &\r\n^time % 70 < 65\r\n >o@-4+EyeX@,@-2+EH@,@bod@,ascii\r\n#\\###|###/\r\n#.´‾‾‾‾‾`.\r\n/  /‾‾‾\\  \\\r\n\\  \\___/  /\r\n#`———————´\r\nasciiend\r\n\r\n?foe ! boss &\r\n^time % 70 < 65\r\n >o@-1+EyeX@,@0+EH@,@atkcolor@,ascii\r\n/‾‾‾\\\r\n\\___/\r\nasciiend\r\n\r\n?foe ! boss &\r\n^time % 70 < 65 &\r\n^foe.distance < 30\r\n >o@-1+EyeX@,@0+EH@,@atkcolor@,ascii\r\n /‾‾‾\\\r\n \\___/\r\nasciiend\r\n\r\n?foe = boss &\r\n^time % 70 < 65 &\r\n^foe.distance >= 30 |\r\n^buffs.string = berserk &\r\n^time % 70 < 65 &\r\n^foe.distance >= 30\r\n >o@-4+EyeX@,@-2+EH@,@bod@,ascii\r\n#\\#######/\r\n#.-.#|#.-.\r\n/  /\\_/\\  \\\r\n\\  \\___/  /\r\n#`———————´\r\nasciiend\r\n\r\n?foe = boss &\r\n^time % 70 < 65 |\r\n^buffs.string = berserk &\r\n^time % 70 < 65\r\n >o@-1+EyeX@,@0+EH@,@atkcolor@,ascii\r\n/###\\\r\n\\___/\r\nasciiend\r\n\r\n?foe = boss &\r\n^time % 70 < 65 &\r\n^foe.distance < 30 |\r\n^buffs.string = berserk &\r\n^time % 70 < 65 &\r\n^foe.distance < 30\r\n >o@-4+EyeX@,@-2+EH@,@bod@,ascii\r\n#\\########/\r\n#.-._#|#,.\r\n/  / \\_/  \\\r\n\\  \\___/  /\r\n#`———————´\r\nasciiend\r\n\r\n?foe = boss &\r\n^time % 70 < 65 &\r\n^foe.distance < 30 |\r\n^buffs.string = berserk &\r\n^time % 70 < 65 &\r\n^foe.distance < 30\r\n >o@-1+EyeX@,@0+EH@,@atkcolor@,ascii\r\n /###\\\r\n \\___/\r\nasciiend\r\n\r\n?time % 70 > 64\r\n >o@-4+EyeX@,@0+EH@,#white,ascii\r\n\\`.——.——.´/\r\n#`/——|——\\´\r\nasciiend\r\n\r\n?time < 110\r\n >o-1,-6,#white,ascii\r\n#___\r\n'.,—'\r\nasciiend\r\n\r\n?time < 108\r\n >o-3,-6,#white,ascii\r\n.———————.\r\n'——.,———'\r\nasciiend\r\n\r\n?time < 104\r\n >o-7,-6,#white,ascii\r\n.———————————————.\r\n'——————.,———————'\r\n#######'\r\nasciiend\r\n\r\n?time < 99\r\n >o-7,-7,#white,ascii\r\n.———————————————.\r\n| BE NOT AFRAID |\r\n'——————.,———————'\r\n#######|\r\nasciiend\r\n\r\n?item.right.state = 2 &\r\n^item.right.time <= 5\r\n play bearer_attack 100\r\n >f1,0,@atkcolor@,ascii\r\n•\r\nasciiend\r\n\r\n?time % 3 = 1 &\r\n^item.right.state = 2 &\r\n^item.right.time > 5\r\n >f1,0,@atkcolor@,ascii\r\n+\r\nasciiend\r\n\r\n?time % 3 = 1 &\r\n^item.right.state = 2 &\r\n^item.right.time > 10\r\n >f1,0,@atkcolor@,ascii\r\n┼\r\nasciiend\r\n\r\n?item.right.state = 3 &\r\n^item.right.time = 1\r\n play bomb_cart_explosion\r\n\r\n?item.right.state = 3 &\r\n^item.right.time <= 2\r\n >f-1,-1,@atkcolor@,ascii\r\n#.—.\r\n(   )\r\n#`—´\r\nasciiend\r\n\r\n?item.right.state = 3 &\r\n^item.right.time <= 4 &\r\n^item.right.time > 2\r\n >f0,-1,@atkcolor@,ascii\r\n#_\r\n(_)\r\nasciiend\r\n\r\n?item.right.state = 3 &\r\n^item.right.time <= 6 &\r\n^item.right.time > 4\r\n >f1,0,@atkcolor@,ascii\r\nO\r\nasciiend\r\n\r\n?item.right.state = 3 &\r\n^item.right.time <= 8 &\r\n^item.right.time > 6 |\r\n^item.right.state = 4\r\n >f1,0,@atkcolor@,ascii\r\n•\r\nasciiend\r\n\r\n?item.left.state <= 1\r\n EyeX = 0\r\n\r\n?item.left.state = 2 &\r\n^item.left.time < 5\r\n EyeX = -1\r\n play bell_ringer_attack\r\n\r\n?item.left.state = 2 &\r\n^item.left.time < 10 &\r\n^item.left.time >= 5\r\n EyeX = -2\r\n\r\n?item.left.state = 3 &\r\n^item.left.time <= 5\r\n EyeX = 12\r\n play bomb_cart_explosion\r\n\r\n?item.left.state = 3 &\r\n^item.left.time <= 7 &\r\n^item.left.time > 5\r\n EyeX = 8\r\n\r\n?item.left.state = 3 &\r\n^item.left.time <= 10 &\r\n^item.left.time > 7\r\n EyeX = 5\r\n\r\n?item.left.state = 3 &\r\n^item.left.time <= 13 &\r\n^item.left.time > 10\r\n EyeX = 2"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Explosion.txt" - Parse error: Failed to parse completely. Remaining: "= []\r\nvar ExplosionMaxRadius = 15\r\nvar ExplosionMaxDuration = 10\r\nvar ExplosionFrameTick = 2\r\nvar ExplosionMaxTicks = ExplosionMaxDuration/ExplosionFrameTick\r\nvar ExplosionRadialExpansion = (1.0*ExplosionMaxRadius) / ExplosionMaxTicks\r\n\r\nvar CanvasHeight = 4\r\n\r\nvar ExplosionBaseFGShade = [256,50,0]\r\nvar ExplosionBaseBGShade = [24,4,0]\r\nvar ExplosionParticleBGShade = [25,20,0]\r\n\r\nvar shadeFG\r\nvar shadeBG\r\nvar shade3\r\nvar ExplosionCanvas = []\r\nvar R\r\nvar G\r\nvar B\r\nvar RGMultiplier\r\n\r\nvar ExplosionCurrentDuration = -1\r\nvar ExplosionCurrentRadius\r\nvar ExplosionX = 0\r\nvar ExplosionY = 0\r\n\r\nvar screenw = screen.w/2\r\nvar screenh = screen.h/2\r\n\r\nfunc Explosion(Ex,Ey)\r\n  ExplosionX = Ex\r\n  ExplosionY = Ey\r\n  ExplosionCurrentDuration = ExplosionMaxDuration\r\n  ?ExplosionCanvas.Count()>0\r\n    for d=0..ExplosionCanvas.Count()-1\r\n      ExplosionCanvas[d].Recycle()\r\n  ExplosionCanvas.Clear()\r\n  play bomb_cart_explosion (80+((40*rng)/10000))\r\n\r\n?key = PrimaryBegin\r\n  Explosion(input.x,input.y)\r\n\r\nfunc ColourFade(Colour)\r\n  return (ExplosionCurrentDuration*Colour)/ExplosionMaxDuration\r\n\r\nfunc ExplosionCanvasBar(num)\r\n  ExplosionCanvas[num].w = math.CeilToInt((CanvasHeight/7+ExplosionCurrentRadius)*2 - math.Abs(0.8*math.Pow((ExplosionCurrentRadius/2.0)-num,2)))\r\n  ExplosionCanvas[num].h = CanvasHeight\r\n  ExplosionCanvas[num].x = ExplosionX-screenw\r\n  ExplosionCanvas[num].y = ExplosionY-screenh+(ExplosionCurrentRadius/2)-num\r\n\r\n  ExplosionCanvas[num].blend = add\r\n  ExplosionCanvas[num].SetFG(shadeFG)\r\n  ExplosionCanvas[num].SetBG(shadeBG)\r\n\r\n  ExplosionCanvas[num].SetBG((ExplosionCurrentRadius*rng)/10050+2,0, shade3)\r\n\r\nfunc ExplosionStatus()\r\n  ?ExplosionCurrentDuration > -1\r\n    var ExplosionLastRadius = 0\r\n    ExplosionCurrentDuration --\r\n    ExplosionCurrentRadius = math.RoundToInt(((ExplosionMaxDuration - ExplosionCurrentDuration)/ExplosionFrameTick) * ExplosionRadialExpansion)\r\n\r\n    R = (ColourFade( ExplosionBaseFGShade[0] ) ) / CanvasHeight\r\n    G = (ColourFade( ExplosionBaseFGShade[1] ) ) / CanvasHeight\r\n    B = (ColourFade( ExplosionBaseFGShade[2] ) ) / CanvasHeight\r\n    shadeFG = color.FromRGB(R,G,B)\r\n\r\n    R = ColourFade(ExplosionBaseBGShade[0])\r\n    G = ColourFade(ExplosionBaseBGShade[1])\r\n    B = ColourFade(ExplosionBaseBGShade[2])\r\n    shadeBG = color.FromRGB(R,G,B)\r\n\r\n    R = ColourFade(ExplosionParticleBGShade[0])\r\n    G = ColourFade(ExplosionParticleBGShade[1])\r\n    B = ColourFade(ExplosionParticleBGShade[2])\r\n    shade3 = color.FromRGB(R,G,B)\r\n\r\n    ?ExplosionCurrentRadius ! ExplosionLastRadius\r\n      ?ExplosionCurrentRadius>0\r\n        for c = ExplosionCanvas.Count()..ExplosionCurrentRadius\r\n          ExplosionCanvas.Add(ui.AddCanvas())\r\n        for c = 0..ExplosionCanvas.Count()-1\r\n          ExplosionCanvasBar(c)\r\n\r\n    ExplosionLastRadius = ExplosionCurrentRadius\r\n\r\n    ?ExplosionCurrentDuration = -1\r\n      ExplosionLastRadius = 0\r\n      for d=0..ExplosionCanvas.Count()-1\r\n        ExplosionCanvas[d].Recycle()\r\n      ExplosionCanvas.Clear()\r\n\r\nExplosionStatus()\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Wisp.txt" - Parse error: Failed to parse completely. Remaining: "= true      // Show daily chest with sparkles\r\nvar Chatter = true        // Enable chatter\r\nvar NaviMode = false      // Hey! Listen!\r\nvar NaviChance = 100      // 1 in n chance to enable on init\r\nvar AnimInterval = 3      // Animations update every n frames\r\nvar ChatInterval = 300    // Minimum frames before next chatter\r\nvar ChatDuration = 45     // Base chatter duration\r\nvar ChanceAttack = 0.2    // foe.state chatter\r\nvar ChanceBoss = 0.5      // boss chatter\r\nvar ChanceLocation = 0.5  // location chatter\r\nvar ChanceOther = 0.5     // other chatter\r\n\r\n//\r\n// Variable declarations\r\n//\r\n\r\n// Chatter\r\nvar QuoteTime = 0\r\nvar Chatting = false\r\nvar ThisQuote = \"\"\r\nvar ForceQuote = false\r\n\r\n// Wisp\r\nvar ShowWisp = false\r\nvar WispColor\r\nvar WispX = 0\r\nvar WispY = 0\r\nvar LastPX = 0\r\nvar LastPY = 0\r\nvar LastXMove = 0\r\nvar LastYMove = 0\r\nvar WispXNear = -2\r\nvar WispXFar = -10\r\nvar WispYLower = -2\r\nvar WispYUpper = -8\r\nvar LastScreen = 0\r\n\r\n// System object offloads\r\nvar T = 0   // time\r\nvar TT = 0  // totaltime\r\nvar SI = 0  // screen.i\r\nvar SW = 0  // screen.w\r\nvar SH = 0  // screen.h\r\nvar F = \"\"  // foe\r\nvar FS = 0  // foe.state\r\nvar FT = 0  // foe.time\r\nvar FD = 0  // foe.distance\r\nvar FH = 0  // foe.hp\r\nvar FHX = 0 // foe.maxhp\r\nvar FA = 0  // foe.armor\r\nvar FAX = 0 // foe.maxarmor\r\nvar L = \"\"  // loc\r\nvar PX = 0  // pos.x\r\nvar PZ = 0  // pos.z\r\n\r\n// Wisp animation\r\nvar WispF1 = ascii\r\n###\r\n#ʘ#\r\n###\r\nasciiend\r\nvar WispF2 = ascii\r\n###\r\n#☺#\r\n###\r\nasciiend\r\nvar WispF3 = ascii\r\n###\r\n#•#\r\n###\r\nasciiend\r\nvar WispF4 = ascii\r\n###\r\n#·#\r\n###\r\nasciiend\r\n\r\n// Spinning animation\r\nvar SpinF1 = ascii\r\n#│#\r\n###\r\n#│#\r\nasciiend\r\nvar SpinF2 = ascii\r\n##/\r\n###\r\n/##\r\nasciiend\r\nvar SpinF3 = ascii\r\n###\r\n─#─\r\n###\r\nasciiend\r\nvar SpinF4 = ascii\r\n\\##\r\n###\r\n##\\\r\nasciiend\r\n\r\n// Horizontal flapping animation\r\nvar FlapHF1 = ascii\r\n\\##\r\n###\r\n/##\r\nasciiend\r\nvar FlapHF2 = ascii\r\n#│#\r\n###\r\n#│#\r\nasciiend\r\nvar FlapHF3 = ascii\r\n##/\r\n###\r\n##\\\r\nasciiend\r\n\r\n// Vertical flapping animation\r\nvar FlapVF1 = ascii\r\n\\#/\r\n###\r\n###\r\nasciiend\r\nvar FlapVF2 = ascii\r\n###\r\n─#─\r\n###\r\nasciiend\r\nvar FlapVF3 = ascii\r\n###\r\n###\r\n/#\\\r\nasciiend\r\n\r\n// Animation variables\r\nvar WispAnim = [WispF1,WispF2,WispF3,WispF4,WispF3,WispF2]\r\nvar WispIndex = 3\r\nvar Cycle = 0\r\nvar SpinAnim = [SpinF1,SpinF2,SpinF3,SpinF4]\r\nvar SpinIndex = 0\r\nvar SpinDirection = true\r\nvar SpinDuration = 0\r\nvar FlapAnimH = [FlapHF1,FlapHF2,FlapHF3,FlapHF2]\r\nvar FlapAnimV = [FlapVF1,FlapVF2,FlapVF3,FlapVF2]\r\nvar FlapAnim = []\r\nvar FlapIndex = 0\r\nvar FlapDuration = 0\r\nvar Busy = false\r\nvar Spinning = false\r\nvar Flapping = false\r\nvar Sparkling = false\r\nvar SparkleDuration = 0\r\n\r\n// Spinning animation\r\nfunc SpinWisp()\r\n  >o@WispX@,@WispY@,@WispColor@,@SpinAnim[SpinIndex]@\r\n\r\n// Flapping animation\r\nfunc FlapWisp()\r\n  >o@WispX@,@WispY@,@WispColor@,@FlapAnim[FlapIndex]@\r\n\r\n// Sparkle at absolute X,Y\r\nvar SparklePoint1X\r\nvar SparklePoint1Y\r\nvar SparklePoint2X\r\nvar SparklePoint2Y\r\nfunc SparklePoint(x,y)\r\n  ?TT % AnimInterval = 0 | !SparklePoint1X\r\n    SparklePoint1X = x + ((rng % 8) - 3)\r\n    SparklePoint1Y = y + ((rng % 4) - 2)\r\n    SparklePoint2X = x + ((rng % 6) - 2)\r\n    SparklePoint2Y = y + ((rng % 3) - 1)\r\n  >`@SparklePoint1X@,@SparklePoint1Y@,#rainbow,·\r\n  >`@SparklePoint2X@,@SparklePoint2Y@,#rainbow,•\r\n\r\n// Sparkle at wisp\r\nvar SparkleWisp1X\r\nvar SparkleWisp1Y\r\nvar SparkleWisp2X\r\nvar SparkleWisp2Y\r\nfunc SparkleWisp()\r\n  ?TT % AnimInterval = 0 | !SparkleWisp1X\r\n    SparkleWisp1X = WispX + (rng % 5) - 1\r\n    SparkleWisp1Y = WispY + (rng % 5) - 1\r\n    SparkleWisp2X = WispX + (rng % 3)\r\n    SparkleWisp2Y = WispY + (rng % 3)\r\n  >o@SparkleWisp1X@,@SparkleWisp1Y@,#rainbow,·\r\n  >o@SparkleWisp2X@,@SparkleWisp2Y@,#rainbow,•\r\n\r\n//\r\n// Quotes for chattering\r\n//\r\n\r\n// Annoying chatter!\r\nvar Navi = [\r\n  \"Hello!\",\r\n  \"Hey!\",\r\n  \"Listen!\",\r\n  \"Look!\",\r\n  \"Watch out!\",\r\n  \"Hey! Listen!\"\r\n]\r\n// Boss attacks\r\nvar QBossAttack = [\r\n  \"Oh, no!\",\r\n  \"Watch out!\",\r\n  \"Beware!\",\r\n  \"Incoming!\"\r\n]\r\n// Bosses\r\nvar QDysangelos1 = [\r\n  \"He's a lot uglier now.\",\r\n  \"Time to chill out!\"\r\n]\r\nvar QDysangelos2 = [\r\n  \"Uh, this isn't even my final form?\",\r\n  \"Elemental, my dear Watson.\"\r\n]\r\nvar QDysangelos3 = [\r\n  \"Wow, he hulked out!\",\r\n  \"We're almost there!\"\r\n]\r\nvar QXyloalgia = [\r\n  \"This is tree-son!\",\r\n  \"Inappropriate tree-tment!\",\r\n  \"Treebeard he's not!\",\r\n  \"Make like a tree and leaf!\"\r\n]\r\nvar QPoena = [\r\n  \"Creepy!\",\r\n  \"Gee, that's not creepy at all.\"\r\n]\r\nvar QBolesh = [\r\n  \"Ewwwwww!\",\r\n  \"That's a big spider!\",\r\n  \"Don't let it bite you!\"\r\n]\r\nvar QAngryShroom = [\r\n  \"We're in so much truffle!\",\r\n  \"Knock the spores out of him!\"\r\n]\r\nvar QMorel = [\r\n  \"There's morel of them?\",\r\n  \"Another one?\"\r\n]\r\nvar QEnoki = [\r\n  \"He doesn't look like a fun guy!\",\r\n  \"Spoooooring...\"\r\n]\r\nvar QPallas1 = [\r\n  \"We've got a bone to pick with you!\",\r\n  \"What a numbskull!\"\r\n]\r\nvar QPallas2 = [\r\n  \"Not even a leg to stand on!\",\r\n  \"That's not very humerous.\",\r\n  \"We're down to a skeleton crew!\"\r\n]\r\nvar QGuardian1 = [\r\n  \"The bigger they are...\",\r\n  \"Hammer time!\",\r\n  \"Smash him into spare parts!\"\r\n]\r\nvar QGuardian2 = [\r\n  \"The harder they fall!\",\r\n  \"You've got him now!\"\r\n]\r\nvar QHrimnir = [\r\n  \"Wow, ugliest foe yeti.\",\r\n  \"Time to bring the heat!\",\r\n  \"Ice him!\",\r\n  \"Water the odds?\"\r\n]\r\nvar QNagaraja = [\r\n  \"♫ Na ga ra ja na ga ra! ♫\",\r\n  \"That's why you're careful of strange holes!\"\r\n]\r\n// Passed a foe\r\nvar Missed = [\r\n  \"Hey, you missed one!\",\r\n  \"Leaving foes behind?\"\r\n]\r\n// Locations\r\nvar Plateau = [\r\n  \"The stars at night...\",\r\n  \"...are big and bright!\",\r\n  \"Ready to rock?\"\r\n]\r\nvar Deadwood = [\r\n  \"Got wood?\",\r\n  \"This place bugs me...\",\r\n  \"Down by the river...\"\r\n]\r\nvar Fear = [\r\n  \"I hope you're not claustrophobic...\",\r\n  \"I hope you're not arachnophobic...\",\r\n  \"A lunk spelunks for gunk!\",\r\n  \"What a poisonous atmosphere...\"\r\n]\r\nvar Forest = [\r\n  \"Such vigorous growth!\",\r\n  \"There's not mush room in here...\"\r\n]\r\nvar Haunted = [\r\n  \"OooOOOooooOOoOOooOOoOO...\",\r\n  \"Welcome to the bone zone!\",\r\n  \"This is a grave situation!\"\r\n]\r\nvar Boiling1 = [\r\n  \"It's getting hot in here.\",\r\n  \"Crack that whip!\",\r\n  \"Whip it!\",\r\n  \"Back to work, pusher!\"\r\n]\r\nvar Boiling2 = [\r\n  \"A boiling lake?\",\r\n  \"I'm sure nothing bad will happen here!\"\r\n]\r\nvar IcyR = [\r\n  \"Brrrrrrrr...\",\r\n  \"What an ice place...\"\r\n]\r\nvar Temple0 = [\r\n  \"Looking to join a cult?\",\r\n  \"Are they expecting visitors?\"\r\n]\r\nvar Temple1 = [\r\n  \"So many cultists!\",\r\n  \"Have you heard of our lord and worm?\",\r\n  \"These cultists have a poisonous attitude!\"\r\n]\r\nvar Temple2 = [\r\n  \"Don't let yourself be sacrificed!\",\r\n  \"What did you say this room was called?\",\r\n  \"Sacrificial Chamber? Uh oh.\"\r\n]\r\nvar Scotty = [\r\n  \"Don't get a head of yourself.\",\r\n  \"Time for a skull session?\"\r\n]\r\nvar Bridge = [\r\n  \"We'll burn that bridge when we get to it!\",\r\n  \"It's a long way down!\"\r\n]\r\nvar StreamSilent = [\r\n  \"What a magical view.\",\r\n  \"The stream of the silent...\",\r\n  \"...\"\r\n]\r\nvar HotSpring = [\r\n  \"Nice, are we having a spa day?\",\r\n  \"Hi, Uulaa!\",\r\n  \"Time to relax!\"\r\n]\r\nvar Falls = [\r\n  \"Are we going fishing?\",\r\n  \"Don't fall off the edge!\"\r\n]\r\n// Other foes\r\nvar Acro = [\r\n  \"An Acronian? Down here?\",\r\n  \"You'd better be careful!\"\r\n]\r\nvar Explosive = [\r\n  \"Don't get too close!\",\r\n  \"That looks dangerous!\"\r\n]\r\n\r\n//\r\n// Functions\r\n//\r\n\r\n// Update system variables once per frame\r\nfunc UpdateVars()\r\n  T = time\r\n  TT = totaltime\r\n  SI = screen.i\r\n  SW = screen.w\r\n  SH = screen.h\r\n  F = foe\r\n  ?F\r\n    FD = foe.distance\r\n    FS = foe.state\r\n    FT = foe.time\r\n    FH = foe.hp\r\n    FHX = foe.maxhp\r\n    FA = foe.armor\r\n    FAX = foe.maxarmor\r\n  L = loc\r\n  PX = pos.x\r\n  PZ = pos.z\r\n\r\n// Reset location and movement bounds\r\nfunc Init()\r\n  ShowWisp = true\r\n  LastPX = PX\r\n  LastPY = PZ\r\n  WispX = -3\r\n  WispY = -3\r\n  LastXMove = TT\r\n  LastYMove = TT\r\n  QuoteTime = 0\r\n  LastScreen = 0\r\n  ?TT = 1\r\n    ?!NaviMode & rng % NaviChance = 0\r\n      NaviMode = true\r\n    ?NaviMode\r\n      Chatter = true\r\n      ChatInterval = 150\r\n      ChatDuration = 15\r\n\r\n// Wisp movement\r\nfunc WispMovement()\r\n  WispX = WispX - (PX - LastPX)\r\n  WispY = WispY - (PZ - LastPY)\r\n  LastPX = PX\r\n  LastPY = PZ\r\n  ?!Chatting\r\n    ?WispX < WispXFar\r\n      WispX++\r\n      LastXMove = TT\r\n    :?WispX > WispXNear\r\n      WispX--\r\n      LastXMove = TT\r\n    :?TT > LastXMove + 4\r\n      WispX = WispX + ((rng%3)-1)\r\n      LastXMove = TT\r\n    ?WispY > WispYLower\r\n      WispY--\r\n      LastYMove = TT\r\n    :?WispY < WispYUpper\r\n      WispY++\r\n      LastYMove = TT\r\n    :?TT > LastYMove + 4\r\n      WispY = WispY + ((rng%3)-1)\r\n      LastYMove = TT\r\n\r\n// Color selection is rainbow because I'm lazy.\r\nfunc GetWispColor()\r\n  return #rainbow\r\n\r\n// As above, so below.\r\nfunc GetChatColor()\r\n  return #rainbow\r\n\r\n// False rotates to widdershins.\r\nfunc CoinFlip()\r\n  ?rng % 2 = 1\r\n    return true\r\n  :\r\n    return false\r\n\r\n// Check for location changes.\r\nfunc CheckScreenChange()\r\n  ?LastScreen <= SI\r\n    LastScreen = SI\r\n  :\r\n    LastScreen = SI\r\n    Init()\r\n\r\n// Process animations.\r\nfunc Animate()\r\n  ?!Busy\r\n    Cycle = (rng % 3) - 1\r\n    ?Cycle > 0\r\n      WispIndex++\r\n    :?Cycle < 0\r\n      WispIndex--\r\n    ?WispIndex < 0\r\n      WispIndex = WispAnim.Count() - 1\r\n    :?WispIndex >= WispAnim.Count()\r\n      WispIndex = 0\r\n    ?WispIndex = 3 & SparkleDuration = 0\r\n      ?rng % 20 = 0\r\n        Busy = true\r\n        Sparkling = true\r\n        SparkleDuration = (rng % 10) + 4\r\n    :?WispIndex = 0 & SpinDuration = 0 & FlapDuration = 0\r\n      ?rng % 10 = 0\r\n        ?CoinFlip()\r\n          SpinDuration = (rng % 20) + 4\r\n          SpinDirection = CoinFlip()\r\n          SpinIndex = rng % SpinAnim.Count()\r\n          Busy = true\r\n          Spinning = true\r\n        :\r\n          FlapDuration = (rng % 20) + 4\r\n          ?CoinFlip()\r\n            FlapAnim = FlapAnimH\r\n          :\r\n            FlapAnim = FlapAnimV\r\n          FlapIndex = rng % FlapAnim.Count()\r\n          Busy = true\r\n          Flapping = true\r\n  :?Spinning\r\n    ?SpinDuration > 0\r\n      SpinDuration--\r\n      ?SpinDirection\r\n        SpinIndex++\r\n        ?SpinIndex >= SpinAnim.Count()\r\n          SpinIndex = 0\r\n      :\r\n        SpinIndex--\r\n        ?SpinIndex < 0\r\n          SpinIndex = SpinAnim.Count() - 1\r\n    ?SpinDuration = 0\r\n      Busy = false\r\n      Spinning = false\r\n  :?Flapping\r\n    ?FlapDuration > 0\r\n      FlapDuration--\r\n      FlapIndex++\r\n      ?FlapIndex >= FlapAnim.Count()\r\n        FlapIndex = 0\r\n    ?FlapDuration = 0\r\n      Busy = false\r\n      Flapping = false\r\n  :?Sparkling\r\n    ?SparkleDuration > 0\r\n      SparkleDuration--\r\n    ?SparkleDuration = 0\r\n      Busy = false\r\n      Sparkling = false\r\n\r\n// Check quote chance and select quote.\r\nfunc Quote(quotes)\r\n  ?ForceQuote\r\n    Chatting = true\r\n    QuoteTime = TT\r\n    ThisQuote = quotes[rng % quotes.Count()]\r\n  :?NaviMode\r\n    Chatting = true\r\n    QuoteTime = TT\r\n    ThisQuote = quotes[rng % quotes.Count()]\r\n  :?F = boss\r\n    ?Unhurt()\r\n      ?rngf > ChanceBoss\r\n        QuoteTime = TT\r\n      :\r\n        Chatting = true\r\n        QuoteTime = TT\r\n        ThisQuote = quotes[rng % quotes.Count()]\r\n    :?AttackState()\r\n      ?rngf > ChanceAttack\r\n        QuoteTime = TT\r\n      :\r\n        Chatting = true\r\n        QuoteTime = TT\r\n        ThisQuote = quotes[rng % quotes.Count()]\r\n  :?SI = 0\r\n    ?rngf > ChanceLocation\r\n      QuoteTime = TT\r\n    :\r\n      Chatting = true\r\n      QuoteTime = TT\r\n      ThisQuote = quotes[rng % quotes.Count()]\r\n  :\r\n    ?rngf > ChanceOther\r\n      QuoteTime = TT\r\n    :\r\n      Chatting = true\r\n      QuoteTime = TT\r\n      ThisQuote = quotes[rng % quotes.Count()]\r\n\r\n// Is it time for another quote?\r\nfunc CanQuote()\r\n  ?!Chatting &\r\n  ^(TT > QuoteTime + ChatInterval | QuoteTime = 0)\r\n    return true\r\n  :\r\n    return false\r\n\r\n// Is foe undamaged?\r\nfunc Unhurt()\r\n  return FH = FHX & FA = FAX\r\n\r\n// Is foe attacking?\r\nfunc AttackState()\r\n  return FS = 33 | FS = 112 | FS = 115 | FS = 133 | FS = 142\r\n\r\n// Chatter\r\nfunc WispChatter()\r\n  ?NaviMode\r\n    Quote(Navi)\r\n  :?F & FD <= -5\r\n    Quote(Missed)\r\n  :?AttackState() & F = boss\r\n    Quote(QBossAttack)\r\n  :?F = acronian_scout | F = acronian_cultist & FD <= 23\r\n    Quote(Acro)\r\n  :?F = explode & FD <= 23\r\n    Quote(Explosive)\r\n  :?L = Rocky\r\n    ?T = 15\r\n      Quote(Plateau)\r\n    :?Unhurt() & FD <= 28\r\n      ?F = dysangelos\r\n        ?F = dysangelos_bearer\r\n          Quote(QDysangelos1)\r\n        :?F = dysangelos_elementalist\r\n          Quote(QDysangelos3)\r\n        :?F = dysangelos_perfected\r\n          Quote(QDysangelos3)\r\n  :?L = Canyon\r\n    ?T = 15\r\n      Quote(Deadwood)\r\n    :?Unhurt() & FD <= 28\r\n      ?F = tree_boss\r\n        Quote(QXyloalgia)\r\n      :?F = poena\r\n        Quote(QPoena)\r\n  :?L = Caves\r\n    ?T = 15\r\n      Quote(Fear)\r\n    :?Unhurt() & FD <= 28\r\n      ?F = spider_boss\r\n        Quote(QBolesh)\r\n  :?L = Mushroom\r\n    ?T = 5\r\n      Quote(Forest)\r\n    :?Unhurt() & FD <= 28\r\n      ?F = mushroom_boss_skinny\r\n        Quote(QEnoki)\r\n      :?F = mushroom_boss_fat\r\n        Quote(QMorel)\r\n      :?F = mushroom_boss\r\n        Quote(QAngryShroom)\r\n  :?L = Halls\r\n    ?T = 90\r\n      Quote(Haunted)\r\n    :?Unhurt() & FD <= 28\r\n      ?F = skeleton_boss\r\n        ?F = phase1\r\n          Quote(QPallas1)\r\n        :?F = phase2\r\n          Quote(QPallas2)\r\n  :?L = Guardian\r\n    ?T = 30\r\n      Quote(Boiling2)\r\n    :?F = bronze_guardian\r\n      ?FA <= 0\r\n        Quote(QGuardian2)\r\n      :\r\n        Quote(QGuardian1)\r\n  :?L = Mine\r\n    ?T = 30\r\n      Quote(Boiling1)\r\n  :?L = icy_ridge\r\n    ?T = 30\r\n      Quote(IcyR)\r\n    :?F = hrimnir | F = yeti\r\n      Quote(QHrimnir)\r\n  :?L = Sacrificial\r\n    ?T = 90\r\n      Quote(Temple2)\r\n    :?F = nagaraja\r\n      Quote(QNagaraja)\r\n  :?L = Temple\r\n    ?T = 30\r\n      Quote(Temple1)\r\n  :?L = \"undead_crypt_intro\"\r\n    ?T = 30\r\n      Quote(Scotty)\r\n  :?L = \"uulaa_shop\"\r\n    ?T = 30\r\n      Quote(HotSpring)\r\n  :?L = \"waterfall\"\r\n    ?T = 90\r\n      Quote(Falls)\r\n  :?L = \"cross_bridge\"\r\n    ?T = 90\r\n      Quote(Bridge)\r\n    :?PX = 134\r\n      Quote(StreamSilent)\r\n    :?PX = 318\r\n      Quote(Temple0)\r\n\r\n// Render wisp on screen.\r\nfunc DisplayWisp()\r\n  ?SpinDuration > 0\r\n    SpinWisp()\r\n  :?FlapDuration > 0\r\n    FlapWisp()\r\n  :?SparkleDuration > 0\r\n    SparkleWisp()\r\n  WispColor = GetWispColor()\r\n  >o@WispX@,@WispY@,@WispColor@,@WispAnim[WispIndex]@\r\n\r\n// Render quote on screen.\r\nfunc DisplayChatter()\r\n  >o@WispX + 3@,@WispY - 1@,@GetChatColor()@,/\r\n  >o@WispX + 4@,@WispY - 2@,@GetChatColor()@,@ThisQuote@\r\n\r\n//\r\n// Track daily chest in Haunted Gate\r\n//\r\nvar LCheckX\r\nvar LCheckY\r\nvar RCheckX\r\nvar RCheckY\r\nvar ChestLX\r\nvar ChestLY\r\nvar ChestMX\r\nvar ChestMY\r\nvar ChestRX\r\nvar ChestRY\r\nvar CheckL\r\nvar CheckR\r\nvar SwapTime = 0\r\nvar ChestL = false\r\nvar ChestM = true\r\nvar ChestR = false\r\nvar ChestChatter = [\r\n  \"Shining treasure!\",\r\n  \"Fairy dust!\",\r\n  \"Sparkle time!\"\r\n]\r\n// Chest Tracking\r\nfunc TrackChest()\r\n  ForceQuote = true\r\n  ?PX = 50 & !Chatting\r\n    Quote(ChestChatter)\r\n  :?PX = 52\r\n    LCheckX = (SW/2)-4\r\n    LCheckY = (SH/2)-7\r\n    RCheckX = (SW/2)+1\r\n    RCheckY = (SH/2)-5\r\n    ChestLX = (SW/2)-4\r\n    ChestLY = (SH/2)-10\r\n    ChestMX = (SW/2)+2\r\n    ChestMY = (SH/2)-7\r\n    ChestRX = (SW/2)+8\r\n    ChestRY = (SH/2)-4\r\n    // Check for left swap\r\n    CheckL = draw.GetSymbol(LCheckX, LCheckY)\r\n      ?TT > SwapTime + 3\r\n        ?CheckL = \"(\" | CheckL = \")\"\r\n          ?ChestL | ChestM\r\n            SwapTime = TT\r\n            ChestL = !ChestL\r\n            ChestM = !ChestM\r\n    // Check for right swap\r\n    CheckR = draw.GetSymbol(RCheckX, RCheckY)\r\n      ?TT > SwapTime + 3\r\n        ?CheckR = \"(\" | CheckR = \")\"\r\n          ?ChestR | ChestM\r\n            SwapTime = TT\r\n            ChestR = !ChestR\r\n            ChestM = !ChestM\r\n    ?ChestL\r\n      SparklePoint(ChestLX,ChestLY)\r\n    :?ChestM\r\n      SparklePoint(ChestMX,ChestMY)\r\n    :?ChestR\r\n      SparklePoint(ChestRX,ChestRY)\r\n\r\n//\r\n// Wisp process flow\r\n//\r\nUpdateVars()\r\n?TT = 1\r\n  Init()\r\n?TT % AnimInterval = 0\r\n  Animate()\r\n?ShowWisp\r\n  CheckScreenChange()\r\n  WispMovement()\r\n  DisplayWisp()\r\n  ?L = \"undead_crypt_intro\" & ShowChest\r\n    TrackChest()\r\n  ?Chatter & CanQuote()\r\n    WispChatter()\r\n  ?Chatting & TT < QuoteTime + ChatDuration\r\n    DisplayChatter()\r\n  :\r\n    Chatting = false\r\n    ThisQuote = \"\"\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/WavyScarf.txt" - Parse error: Failed to parse completely. Remaining: "= #red\r\n\r\nvar interval = 3\r\nvar total_sprites = 4\r\nvar total_time = total_sprites * interval\r\n\r\nvar bigScarfFrame1 = \",-._.-=\"\r\nvar bigScarfFrame2 = \"-._.-.=\"\r\nvar bigScarfFrame3 = \"._.-._=\"\r\nvar bigScarfFrame4 = \"_.-._.=\"\r\nvar smallScarfFrame1 = \"_..\"\r\nvar smallScarfFrame2 = \".-.\"\r\nvar smallScarfFrame3 = \"-._\"\r\nvar smallScarfFrame4 = \"._.\"\r\nvar _time\r\nvar _bighead = bighead\r\n\r\nScarfMain()\r\n\r\nfunc ScarfMain()\r\n  _time = time\r\n  ?_bighead\r\n    //bighead\r\n    ?_time % total_time < interval\r\n      >h-6,1,@scarfColor@,@bigScarfFrame1@\r\n    :?_time % total_time < interval * 2\r\n      >h-6,1,@scarfColor@,@bigScarfFrame2@\r\n    :?_time % total_time < interval * 3\r\n      >h-6,1,@scarfColor@,@bigScarfFrame3@\r\n    :?_time % total_time < interval * 4\r\n      >h-6,1,@scarfColor@,@bigScarfFrame4@\r\n  :\r\n    //non-bighead\r\n    ?_time % total_time < interval\r\n      >h-4,1,@scarfColor@,@smallScarfFrame1@\r\n    :?_time % total_time < interval * 2\r\n      >h-4,1,@scarfColor@,@smallScarfFrame2@\r\n    :?_time % total_time < interval * 3\r\n      >h-4,1,@scarfColor@,@smallScarfFrame3@\r\n    :?_time % total_time < interval * 4\r\n      >h-4,1,@scarfColor@,@smallScarfFrame4@\r\n  "
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/ChrWings.txt" - Parse error: Failed to parse completely. Remaining: ":?P = 1\r\n    P = 0\r\n    >On\r\n\r\nvar button = ui.AddButton()\r\nbutton.x=5\r\nbutton.y=7\r\nbutton.w=8\r\nbutton.h=3\r\nbutton.text=＂SWITCH＂\r\nbutton.dock=top_left\r\nbutton.SetPressed(OnPress)\r\n\r\n?P = 0\r\n  >h-6,+0,#red,@DW@\r\n:\r\n  >h-7,-1,#yellow,@AW@\r\n\r\n\r\nvar DW = ascii\r\n###人#####人\r\n##)`\\└#┘/´(\r\n##v^´###`^v\r\nasciiend\r\n\r\nvar AW = ascii\r\n###(\\#####/)\r\n##(##(#_#)##)\r\n###(#´###`#)\r\n####＂～###～＂\r\nasciiend\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetSnowman.txt" - Parse error: Failed to parse completely. Remaining: "= #808080 //eyes, buttons and hat\r\nnoseColor = #CC9020 //carrot nose\r\narmsColor = #706020 //stick arms\r\n\r\nvar keepDistance = -25 // distance at which the movement animation will play (stateMoving)\r\nvar maxX = -24         // closest offset pet will get to character.  Closer to 0, closer to character\r\nvar maxDistance = -35  // if the pet exceeds this distance, it will teleport to this distance (cannot be further away than this)\r\nvar targetZ = 2       //start the drawing 1 unit above the player\r\n\r\n?loc.loop\r\n  keepDistance = -25\r\n  maxX = -12\r\n  maxDistance = -35\r\n  targetZ = 2\r\n\r\nvar x = 0\r\nvar y = 0\r\nvar myX = 0\r\nvar myZ = 0\r\nvar lastPlayerX = 0\r\nvar lastPlayerZ = 0\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1\r\nvar stateMoving = 2\r\nvar currentState = stateNone\r\nvar stateTime = 0\r\n\r\nfunc SetState(newState)\r\n  ?newState = stateMoving\r\n    play haunted_gate_shuffle //play sound when moving\r\n  \r\n  currentState = newState\r\n  stateTime = 0\r\n\r\n?currentState = stateNone | time = 1\r\n  lastPlayerX = pos.x\r\n  lastPlayerZ = pos.z\r\n  myX = keepDistance\r\n  myZ = targetZ\r\n\r\n// Start further away if snowman is summoned while the location is already running\r\n  ?time > 1\r\n    myX = maxDistance\r\n\r\n  SetState(stateIdle)\r\n\r\nmyX = myX - (pos.x - lastPlayerX) // If player has moved, increment myX (distance from player)\r\n\r\nstateTime++\r\n\r\n?currentState = stateIdle \r\n  ?myX < maxDistance | myX > -maxDistance\r\n    myX = maxDistance\r\n  myZ = myZ - (pos.z - lastPlayerZ)\r\n\r\n  ?myX < keepDistance\r\n    SetState(stateMoving)\r\n\t\r\n:?currentState = stateMoving\r\n  ?myX < maxX\r\n    myX++\r\n\t\r\n  ?stateTime >= 6\r\n    ?myZ > targetZ\r\n      myZ--\r\n    :?myZ < targetZ\r\n      myZ++\r\n\r\n  ?stateTime >= 12\r\n    SetState(stateIdle)\r\n\t\r\nlastPlayerX = pos.x\r\nlastPlayerZ = pos.z\r\n\r\n//draw snowman-----------------------------\r\n?currentState = stateIdle \r\n  >o@myX@,@myZ-3@,@#white@,ascii\r\n####__\r\n##_|__|_\r\n.#( •,•)#,.\r\n'`(  : )'\r\n#(    : )\r\n##`----´\r\nasciiend\r\n  >o@myX@,@myZ-3@,@coalColor@,ascii\r\n####__\r\n##_|__|_\r\n####•#•\r\n#####:\r\n######:\r\nasciiend\r\n  >o@myX@,@myZ-3@,@noseColor@,ascii\r\n#\r\n#\r\n#####,\r\nasciiend\r\n  >o@myX@,@myZ-3@,@armsColor@,ascii\r\n#\r\n#\r\n.########,.\r\n'`######'\r\nasciiend\r\n\r\n//eye expressions\r\n  ?face = \"°°\"\r\n    >o@myX@,@myZ-3@,@coalColor@,ascii\r\n#\r\n#\r\n####ʘ#ʘ\r\nasciiend\r\n\r\n  ?face = \"^^\"\r\n    >o@myX@,@myZ-3@,@coalColor@,ascii\r\n#\r\n#\r\n####^#^\r\nasciiend\r\n    >o@myX@,@myZ-3@,@#white@,ascii\r\n#\r\n##❄####❄\r\n❄########❄\r\n########❄\r\nasciiend\r\n\r\n//Blink\r\n?currentState = stateIdle\r\n  ?face ! \"^^\"\r\n    ?face ! \"°°\"\r\n      ?stateTime % 50 >= 48\r\n        >o@myX@,@myZ-3@,@coalColor@,ascii\r\n#\r\n#\r\n####-#-\r\nasciiend\r\n      :?stateTime % 50 >= 46\r\n        >o@myX@,@myZ-3@,@coalColor@,ascii\r\n#\r\n#\r\n####-#-\r\nasciiend\r\n      :?stateTime % 50 >= 44\r\n        >o@myX@,@myZ-3@,@coalColor@,ascii\r\n#\r\n#\r\n####-#-\r\nasciiend\r\n\r\n//draw moving----------------------------\r\n?currentState = stateMoving\r\n  ?stateTime/3 = 0\r\n    >o@myX@,@myZ-3@,@#white@,ascii\r\n####__\r\n##_|__|_\r\n.#( •,•)#,.\r\n'`(  : )'\r\n#(    : )\r\n##`----´\r\nasciiend\r\n    >o@myX@,@myZ-3@,@coalColor@,ascii\r\n####__\r\n##_|__|_\r\n####•#•\r\n#####:\r\n######:\r\nasciiend\r\n    >o@myX@,@myZ-3@,@noseColor@,ascii\r\n#\r\n#\r\n#####,\r\nasciiend\r\n    >o@myX@,@myZ-3@,@armsColor@,ascii\r\n#\r\n#\r\n.########,.\r\n'`######'\r\nasciiend\r\n\r\n  ?stateTime/3 = 1\r\n    >o@myX@,@myZ-3@,@#white@,ascii\r\n####__\r\n##_|__|_\r\n##.  •,).\r\n##`   :)\r\n#(     :)\r\n##`----´\r\nasciiend\r\n    >o@myX@,@myZ-3@,@coalColor@,ascii\r\n####__\r\n##_|__|_\r\n#####•#\r\n######:\r\n#######:\r\nasciiend\r\n    >o@myX@,@myZ-3@,@noseColor@,ascii\r\n#\r\n#\r\n######,\r\nasciiend\r\n    >o@myX@,@myZ-3@,@armsColor@,ascii\r\n#\r\n#\r\n##.#####.\r\n##`\r\nasciiend\r\n\r\n  ?stateTime/3 = 2\r\n    >o@myX@,@myZ-3@,@#white@,ascii\r\n####__\r\n##_|__|_\r\n##('  •-\r\n##( `  ;\r\n#(      ;\r\n##`----´\r\nasciiend\r\n    >o@myX@,@myZ-3@,@coalColor@,ascii\r\n####__\r\n##_|__|_\r\n######•\r\n#######;\r\n########;\r\nasciiend\r\n    >o@myX@,@myZ-3@,@noseColor@,ascii\r\n#\r\n#\r\n#######-\r\nasciiend\r\n    >o@myX@,@myZ-3@,@armsColor@,ascii\r\n#\r\n#\r\n###'\r\n####`\r\nasciiend\r\n\r\n  ?stateTime/3 = 3\r\n    >o@myX@,@myZ-3@,@#white@,ascii\r\n####__\r\n##_|__|_\r\n#.( •,•).\r\n#`(   ;)\r\n#(     :)\r\n##`----´\r\nasciiend\r\n    >o@myX@,@myZ-3@,@coalColor@,ascii\r\n####__\r\n##_|__|_\r\n####•#•\r\n######:\r\n#######:\r\nasciiend\r\n    >o@myX@,@myZ-3@,@noseColor@,ascii\r\n#\r\n#\r\n#####,\r\nasciiend\r\n    >o@myX@,@myZ-3@,@armsColor@,ascii\r\n#\r\n#\r\n#.######.\r\n#`######\r\nasciiend\r\n\r\n  ?stateTime/3 = 4\r\n    >o@myX@,@myZ-3@,@#white@,ascii\r\n####__\r\n##_|__|_\r\n.#( •,•)#,.\r\n'`(  : )'\r\n#(    : )\r\n##`----´\r\nasciiend\r\n    >o@myX@,@myZ-3@,@coalColor@,ascii\r\n####__\r\n##_|__|_\r\n####•#•\r\n#####:\r\n######:\r\nasciiend\r\n    >o@myX@,@myZ-3@,@noseColor@,ascii\r\n#\r\n#\r\n#####,\r\nasciiend\r\n    >o@myX@,@myZ-3@,@armsColor@,ascii\r\n#\r\n#\r\n.#######,.\r\n'`######'\r\nasciiend\r\n\r\n  ?stateTime/3 = 5\r\n    >o@myX@,@myZ-3@,@#white@,ascii\r\n####__\r\n##_|__|_\r\n#.( •,•,\r\n##( :  '\r\n#(   :  )\r\n##`----´\r\nasciiend\r\n    >o@myX@,@myZ-3@,@coalColor@,ascii\r\n####__\r\n##_|__|_\r\n####•#•\r\n####:\r\n#####:\r\nasciiend\r\n    >o@myX@,@myZ-3@,@noseColor@,ascii\r\n#\r\n#\r\n#####,\r\nasciiend\r\n    >o@myX@,@myZ-3@,@armsColor@,ascii\r\n#\r\n#\r\n#.#####,\r\n#######'\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetDracula.txt" - Parse error: Failed to parse completely. Remaining: "= draculaX - (playerX - lastplayerX)\r\n\r\n?draculaX<-12\r\n  ?draculaX<-17&bat=false\r\n    ?pooftime=0\r\n      dracula.Load(poofanim1)\r\n      dracula.frame=0\r\n      pooftime=5\r\n    :?time%2=0\r\n      dracula.frame++\r\n      pooftime--\r\n      ?pooftime=0\r\n        dracula.Load(batanim)\r\n        dracula.frame=1\r\n        bat=true\r\n  ?pooftime!0\r\n    ?bat\r\n      ?time%2=0\r\n        dracula.frame++\r\n        pooftime--\r\n        ?pooftime=0\r\n          dracula.Load(draculanim)\r\n          dracula.frame=0\r\n          bat=false\r\n  :?bat\r\n    ?time%2=0\r\n      dracula.frame++\r\n      draculaX++\r\n    :?draculaX<-23\r\n      dracula.frame++\r\n      draculaX++\r\n  :?time%3=0\r\n    dracula.frame++\r\n    ?dracula.frame=0\r\n      dracula.frame=1\r\n    draculaX++\r\n:?bat\r\n  ?pooftime=0\r\n    dracula.Load(poofanim2)\r\n    dracula.frame=0\r\n    pooftime=5\r\n  :?time%2=0\r\n    dracula.frame++\r\n    pooftime--\r\n    ?pooftime=0\r\n      dracula.Load(draculanim)\r\n      dracula.frame=0\r\n      bat=false\r\n:?pooftime=0\r\n  dracula.frame=0\r\n\r\n?draculaX < -70 | draculaX > 70\r\n  draculaX = -30\r\n\r\n?dracula.y>refZ-8\r\n  dracula.y=dracula.y-1\r\n:?dracula.y<refZ-8\r\n  dracula.y=dracula.y+1\r\n\r\nlastrefX=screen.FromWorldX(pos.x)\r\nlastplayerX=pos.x\r\ndracula.x=refX+draculaX"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/DragonWorm.txt" - Parse error: Failed to parse completely. Remaining: "=\r\n    ^screen.ToWorldX(dragonwormstart)\r\n  dragonwormposy = screen.h - 4\r\n  ?foe = phase1 |\r\n  ^foe.distance > 300 & pos.x > 150\r\n    disabledragonworm = 1\r\n  :?loc.loop\r\n    disabledragonworm = 0\r\n  ?disabledragonworm = 1\r\n    ?time = 1\r\n      dragonwormpos = -20\r\n  ?time % 3 = 0\r\n    ?dragonwormmode = 0\r\n      dragonwormanim++\r\n      dragonwormworldpos--\r\n      ?dragonwormanim = 5\r\n        dragonwormmode = 1\r\n    :\r\n      dragonwormanim--\r\n      ?dragonwormanim = 1\r\n        dragonwormmode = 0\r\n\r\n  dragonwormpos = \r\n  ^screen.FromWorldX(dragonwormworldpos)\r\n\r\n  ?dragonwormpos < -20 & disabledragonworm = 0\r\n    dragonwormworldpos = \r\n    ^screen.ToWorldX(dragonwormstart)\r\n\r\n  ?dragonwormpos >= -20 | disabledragonworm = 0\r\n    ?dragonwormanim = 1\r\n      >`@dragonwormpos@,@dragonwormposy@,\r\n      ^#rain77,@dragonworm1@\r\n    :?dragonwormanim = 2\r\n      >`@dragonwormpos@,@dragonwormposy@,\r\n      ^#rain77,@dragonworm2@\r\n    :?dragonwormanim = 3\r\n      >`@dragonwormpos@,@dragonwormposy@,\r\n      ^#rain77,@dragonworm3@\r\n    :?dragonwormanim = 4\r\n      >`@dragonwormpos@,@dragonwormposy@,\r\n      ^#rain77,@dragonworm4@\r\n    :\r\n      >`@dragonwormpos@,@dragonwormposy@,\r\n      ^#rain77,@dragonworm5@\r\n:?loc = waterfall\r\n  >c0,-8,#rain77,@dragonwormstand@\r\n:?loc = bridge\r\n  ?pos.x < 10\r\n    dragonwormposy = pos.z - 10\r\n  dragonwormworldpos = 330\r\n  dragonwormpos = \r\n  ^screen.FromWorldX(dragonwormworldpos)\r\n  >`@dragonwormpos@,@dragonwormposy@,\r\n  ^#rain77,@dragonwormstand@\r\n  >`@dragonwormpos+7@,@dragonwormposy+11@,\r\n  ^#rain77,@dragonwormstand@"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetSkully.txt" - Parse error: Failed to parse completely. Remaining: "= #808080   //grey\r\n\r\n//CHOOSE YOUR CHEST---------------------------------------<\r\n//Replace with one below: bone | delta\r\nchestType = bone\r\n\r\n//CHOOSE YOUR MOVEMENT TRAIL--------------------------------<\r\n//Replace with one below: cloud | sparks | wings | chesttrail\r\ncloudType = cloud\r\n\r\n//CHOOSE YOUR AFTER-EFFECT COLOR--------------------------------<\r\ncloudColor = #808080   //grey\r\nclouderColor = #2e2e2e //grey but darker\r\nsparkColor = #white    //white\r\nsparkerColor = #808080 //grey\r\nwingColor = #yellow\r\nchesttrailColor = #white\r\nchesttrailerColor = #808080\r\n\r\n?chestType = bone\r\n  chestColor = #white\r\n:?chestType = delta\r\n  chestColor = #rainbow\r\n\r\nvar keepDistance = -26 // distance at which the movement animation will play (stateMoving)\r\nvar maxX = -16         // closest offset pet will get to character.  Closer to 0, closer to character\r\nvar maxDistance = -70  // if the pet exceeds this distance, it will teleport to this distance (cannot be further away than this)\r\nvar targetZ = -1       // We want to start the drawing 1 unit above the player agent\r\n\r\n?loc.loop\r\n  keepDistance = -26\r\n  maxX = -16\r\n  maxDistance = -70\r\n  targetZ = -1\r\n\r\nvar x = 0\r\nvar y = 0\r\nvar myX = 0\r\nvar myZ = 0\r\nvar lastPlayerX = 0\r\nvar lastPlayerZ = 0\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1\r\nvar stateMoving = 2\r\nvar currentState = stateNone\r\nvar stateTime = 0\r\nvar chestTime = 0\r\n\r\n\r\nfunc SetState(newState)\r\n  ?newState = stateMoving\r\n    play haunted_gate_shuffle //play sound when moving\r\n  currentState = newState\r\n  stateTime = 0\r\n\r\n?currentState = stateNone | time = 1\r\n  lastPlayerX = pos.x\r\n  lastPlayerZ = pos.z\r\n  myX = keepDistance\r\n  myZ = targetZ\r\n\r\n// Start further away if skully is summoned while the location is already running\r\n  ?time > 1\r\n    myX = maxDistance\r\n\r\n  SetState(stateIdle)\r\n\r\nmyX = myX - (pos.x - lastPlayerX) // If player has moved, increment myX (distance from player)\r\n\r\nstateTime++\r\n\r\n?face = \"( ^^\" & stateTime > 30\r\n  chestTime++\r\n?face ! \"( ^^\"\r\n  chestTime = 0\r\n\r\n?currentState = stateIdle \r\n  ?myX < maxDistance | myX > -maxDistance\r\n    myX = maxDistance\r\n  myZ = myZ - (pos.z - lastPlayerZ)\r\n\r\n  ?myX < keepDistance\r\n    SetState(stateMoving)\r\n\t\r\n:?currentState = stateMoving\r\n  ?myX < maxX\r\n    myX++\r\n\t\r\n  ?stateTime >= 6\r\n    ?myZ > targetZ\r\n      myZ--\r\n    :?myZ < targetZ\r\n      myZ++\r\n\r\n  ?stateTime >= 12\r\n    SetState(stateIdle)\r\n\t\r\nlastPlayerX = pos.x\r\nlastPlayerZ = pos.z\r\n\r\n//DRAW state timers--------------------------------<\r\n//for debugging or whatever, uncomment if you want to see\r\n\r\n//>`0,7,StateTime = @stateTime@\r\n//>`0,8,ChestTime = @chestTime@\r\n\r\n//IDLE---------------------------------------------<\r\n\r\n?currentState = stateIdle & face ! \"( ^^\" \r\n  >o@myX@,@myZ@,@skullColor@,ascii\r\n#####\r\n#####\r\n#####\r\n#####,--.\r\n####(_o,o)\r\n######`\"´\r\nasciiend\r\n\r\n//EYES----------------------------------------<\r\n?currentState = stateIdle\r\n  ?face = \"°°\"\r\n      ?time % 10 = 0 & myX > keepDistance\r\n        myX--\r\n\r\n      ?time % 4 <= 1\r\n        >o@myX@,@myZ@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n######O,o\r\nasciiend\r\n      ?time % 4 > 1\r\n       >o@myX@,@myZ@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n######o,O\r\nasciiend\r\n\r\n//BLINKING----------------------------\r\n\r\n  ?face ! \"( ^^\"\r\n    ?stateTime % 50 >= 48\r\n        >o@myX@,@myZ@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n######=,=\r\nasciiend\r\n    :?stateTime % 50 >= 46\r\n        >o@myX@,@myZ@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n######-,-\r\nasciiend\r\n    :?stateTime % 50 >= 44\r\n        >o@myX@,@myZ@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n######=,=\r\nasciiend\r\n\r\n//CHEST ANIMATION-----------------------------------------------<\r\n\r\n  x = myX + 6\r\n  y = myZ + 4\r\n?face = \"( ^^\" \r\n    ?chestTime <= 5 | chestTime > 40\r\n      >o@myX@,@myZ@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#####,--.\r\n####(_o,o)\r\n######`\"´\r\nasciiend\r\n//-------------------------------\r\n    :?chestTime <= 10 | chestTime <= 40  & chestTime > 35\r\n      >o@myX@,@myZ@,@skullColor@,ascii\r\n#\r\n#\r\n#####,--.\r\n####(_o,o)\r\n######`\"´\r\n#\r\nasciiend\r\n      ?chestType = bone\r\n        >o@myX@,@myZ@,@chestColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n####ε╪###╪3\r\n#####└───┘\r\nasciiend\r\n      :?chestType = delta\r\n       >o@myX@,@myZ@,@chestColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#####╞###╡\r\n#####└───┘\r\nasciiend\r\n//-------------------------------\r\n    :?chestTime <= 15 | chestTime <= 35  & chestTime > 30\r\n      >o@myX@,@myZ@,@skullColor@,ascii\r\n#\r\n#####,--.\r\n####(_o,o)\r\n######`\"´\r\n#\r\n#\r\nasciiend\r\n      ?chestType = bone\r\n        >o@myX@,@myZ@,@chestColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n####ε╪=o=╪3\r\n#####└───┘\r\nasciiend\r\n      :?chestType = delta\r\n        >o@myX@,@myZ@,@chestColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#####╞-∆-╡\r\n#####└───┘\r\nasciiend\r\n//-------------------------------\r\n    :?chestTime <= 30\r\n      >o@myX@,@myZ@,@skullColor@,ascii\r\n#####,--.\r\n####(_o,o)\r\n######`\"´\r\n#\r\n#\r\n#\r\nasciiend\r\n      ?chestType = bone\r\n        >o@myX@,@myZ@,@chestColor@,ascii\r\n#\r\n#\r\n#\r\n######___\r\n####ε╪=o=╪3\r\n#####└───┘\r\nasciiend\r\n      :?chestType = delta\r\n        >o@myX@,@myZ@,@chestColor@,ascii\r\n#####\r\n#####\r\n#####\r\n######___\r\n#####╞-∆-╡\r\n#####└───┘\r\nasciiend\r\n\r\n//MOVING-------------------------------------------<\r\n?currentState = stateMoving\r\n  ?stateTime/2 = 0\r\n    >o@myX@,@myZ@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#####,--.\r\n####(_o,o)\r\n######`\"´\r\nasciiend\r\n\r\n  ?stateTime/2 = 1\r\n    >o@myX@,@myZ@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#####,--.\r\n####(_o,o)\r\n######`\"´\r\nasciiend\r\n\r\n  ?stateTime/2 = 2\r\n    >o@myX@,@myZ@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#####,--.\r\n####(_o,o)\r\n######`\"´\r\nasciiend\r\n\r\n  ?stateTime/2 = 3\r\n    >o@myX@,@myZ@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#####,--.\r\n####(_o,o)\r\n######`\"´\r\nasciiend\r\n\r\n  ?stateTime/2 = 4\r\n    >o@myX@,@myZ@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#####,--.\r\n####(_o,o)\r\n######`\"´\r\nasciiend\r\n\r\n  ?stateTime/2 = 5\r\n    >o@myX@,@myZ@,@skullColor@,ascii\r\n#\r\n#\r\n#\r\n#####,--.\r\n####(_o,o)\r\n######`\"´\r\nasciiend\r\n\r\n//MOVING CLOUD POOT---------------------------------<\r\n\r\n?currentState = stateMoving\r\n  ?stateTime/2 = 0\r\n    ?cloudType = cloud\r\n      >o@myX@,@myZ@,@cloudColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n    :?cloudType = sparks\r\n      >o@myX@,@myZ@,@sparkColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#####\\\r\nasciiend\r\n    :?cloudType = wings\r\n      >o@myX@,@myZ@,@wingColor@,ascii\r\n#\r\n##.\\###;\r\n##( \\#| \r\n####¯\r\n#\r\n#\r\nasciiend\r\n    :?cloudType = chesttrail\r\n      >o@myX@,@myZ@,@chesttrailColor@,ascii\r\n#\r\n#\r\n#\r\n####\r\n###\r\n####└─\r\nasciiend\r\n\r\n//-------------------------------1\r\n\r\n  ?stateTime/2 = 1\r\n    ?cloudType = cloud\r\n      >o@myX@,@myZ@,@cloudColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n####(\\\r\nasciiend\r\n    :?cloudType = sparks\r\n      >o@myX@,@myZ@,@sparkColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n###\\\r\n####-\r\nasciiend\r\n    :?cloudType = wings\r\n      >o@myX@,@myZ@,@wingColor@,ascii\r\n#\r\n##__###_\r\n#\\  \\#/ \r\n##`¯¯\r\n#\r\n#\r\nasciiend\r\n    :?cloudType = chesttrail\r\n      >o@myX@,@myZ@,@chesttrailColor@,ascii\r\n#\r\n#\r\n#\r\n###_\r\n##├\r\n##└──\r\nasciiend\r\n\r\n//-------------------------------2\r\n\r\n  ?stateTime/2 = 2\r\n    ?cloudType = cloud\r\n      >o@myX@,@myZ@,@cloudColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n##_\r\n#( `\r\nasciiend\r\n    :?cloudType = sparks\r\n      >o@myX@,@myZ@,@sparkColor@,ascii\r\n#\r\n#\r\n#\r\n##_\r\n###_\r\n#\r\nasciiend\r\n    :?cloudType = wings\r\n      >o@myX@,@myZ@,@wingColor@,ascii\r\n#\r\n#\r\n#___\r\n/_.'¯#¯\r\n#\r\n#\r\nasciiend\r\n    :?cloudType = chesttrail\r\n      >o@myX@,@myZ@,@chesttrailColor@,ascii\r\n#\r\n#\r\n#\r\n##__\r\n#├─\r\n#└───\r\nasciiend\r\n\r\n\r\n//-------------------------------3\r\n\r\n  ?stateTime/2 = 3\r\n    ?cloudType = cloud\r\n      >o@myX@,@myZ@,@clouderColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#_\r\n´ `\r\nasciiend\r\n    :?cloudType = sparks\r\n      >o@myX@,@myZ@,@sparkColor@,ascii\r\n#\r\n#\r\n#\r\n#-\r\n##_\r\n#\r\nasciiend\r\n    :?cloudType = wings\r\n      >o@myX@,@myZ@,@wingColor@,ascii\r\n#\r\n##__###_\r\n#\\  \\#/ \r\n##`¯¯\r\n#\r\n#\r\nasciiend\r\n    :?cloudType = chesttrail\r\n      >o@myX@,@myZ@,@chesttrailColor@,ascii\r\n#\r\n#\r\n#\r\n#___\r\n├─o\r\n└───┘\r\nasciiend\r\n\r\n//-------------------------------4\r\n\r\n  ?stateTime/2 = 4\r\n    ?cloudType = cloud\r\n      >o@myX@,@myZ@,@clouderColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n;`.\r\nasciiend\r\n    :?cloudType = sparks\r\n      >o@myX@,@myZ@,@sparkerColor@,ascii\r\n#\r\n#\r\n#\r\n_\r\n#\r\n/\r\nasciiend\r\n    :?cloudType = wings\r\n      >o@myX@,@myZ@,@wingColor@,ascii\r\n#\r\n##.\\###;\r\n##( \\#| \r\n####¯\r\n#\r\n#\r\nasciiend\r\n    :?cloudType = chesttrail\r\n      >o@myX@,@myZ@,@chesttrailerColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#__\r\n├─o─┤\r\nasciiend\r\n\r\n//-------------------------------5\r\n\r\n  ?stateTime/2 = 5\r\n    ?cloudType = cloud\r\n      >o@myX@,@myZ@,@clouderColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n.\r\nasciiend\r\n    :?cloudType = sparks\r\n      >o@myX@,@myZ@,@sparkerColor@,ascii\r\n#\r\n#\r\n#\r\n_\r\n#\r\n#\r\nasciiend\r\n    :?cloudType = wings\r\n      >o@myX@,@myZ@,@wingColor@,ascii\r\n#\r\n#\r\n###(\\#| \r\n####¯\r\n#\r\n#\r\nasciiend\r\n    :?cloudType = chesttrail\r\n      >o@myX@,@myZ@,@chesttrailerColor@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#.\r\n\\_|_\r\nasciiend\r\n\r\n//-------------------------------6\r\n\r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetDragon.txt" - Parse error: Failed to parse completely. Remaining: "= [ascii\r\n#####\\`-`~.\r\n######{_ ` `~;\r\n########‾`/~´\r\n#####´‾‾`´\r\nasciiend,ascii\r\n#####\\`-`~.\r\n######{_ ` `~;\r\n########‾`/~´\r\n#####´‾`-´\r\nasciiend,ascii\r\n#####\\`-`~.\r\n######{_ ` `~;\r\n########‾`/~´\r\n#####´`--´\r\nasciiend,ascii\r\n#####\\`-`~.\r\n######{_ ` `~;\r\n########‾`/~´\r\n#####`._,´\r\nasciiend,ascii\r\n#####\\`-`~.\r\n######{_ ` `~;\r\n########‾`/~´\r\n#####-.-´´\r\nasciiend,ascii\r\n#####\\`-`~.\r\n######{_ ` `~;\r\n########‾`/~´\r\n#####,´‾`´\r\nasciiend]\r\n\r\nvar DragonAttack = [ascii\r\n#\r\n#\r\n########################\\`-`~.\r\n####################_###,｛_ ` `~;\r\n######_..-.._####,´‾ ‾`´  ,‾`/~´\r\n###.´‾. --   ‾`-´  _._   ;\r\n##/´‾##))##`._  _,´###((´\r\n#'####,´######‾‾#######`´\"\r\n#####\"\r\nasciiend,ascii\r\n######################.# .\r\n#######################\\`-`~.\r\n########################｛_ ` `~;\r\n#######################,  `/~-`\r\n######__...__####,´‾‾`´  ,\r\n###.´‾  __   ‾`-´  ,._   ;\r\n#.´´‾##))##`.._ _,´###((´\r\n######,´#######‾#######`.\r\n#####\"###################\"\r\nasciiend,ascii\r\n######################. .\r\n######################|`-`~.\r\n#######################｛_ ` `´;\r\n######################/  `._\\‾\r\n#`.########__####,´‾‾´  ( \r\n##``---´‾‾‾  ‾`-´    _  ;\r\n###`- `))-- .._  _.´‾#))\r\n######,´#######‾####\".´\r\n#####\"\r\nasciiend,ascii\r\n######################. .\r\n######################|`-`~.\r\n#######################｛_ ` `´;\r\n###.´##############__#/  `._\\‾\r\n##(´-._####__###,´‾  ´  / \r\n###`.  ‾‾‾‾  `-´     _  ;\r\n##### `))`--.._  _.´‾#))\r\n######,´#######‾####\".´\r\n#####\"\r\nasciiend,ascii\r\n#######################. .\r\n#######################|`-`~.\r\n#######################,｛_ ` `´;\r\n######################/  ,`._\\‾\r\n#`.########__####,´‾‾´  ( \r\n##``---´‾‾‾  ‾`-´    _  ;\r\n###`- `))-- .._  _.´‾#))\r\n######,´#######‾####\".´\r\n#####\"\r\nasciiend,ascii\r\n#\r\n#\r\n#######################\\`-`~.\r\n#######################,｛_ ` `´;\r\n######__...__####,´‾‾`´  ,`._\\‾\r\n###.´‾  __   ‾`-´  ,._   ;\r\n#.´´‾##))##`.._ _,´###((´\r\n######,´#######‾#######`.\r\n#####\"###################\"\r\nasciiend,ascii\r\n#\r\n#\r\n########################\r\n########################_\\`-`~.\r\n######__...__####,´‾‾`´‾ ‾｛_ ` `´;\r\n###.´‾  __   ‾`-´  ,._   ;##`._\\‾\r\n#.´´‾##))##`.._ _,´###((´\r\n######,´#######‾#######`.\r\n#####\"###################\"\r\nasciiend,ascii\r\n#\r\n#\r\n########################\r\n########################_\\`-`~.\r\n######__...__####,´‾‾`´‾ ‾｛_ ` `´;\r\n###.´‾  __   ‾`-´  ,._   ;##`._\\‾\r\n#.´´‾##))##`.._ _,´###((´\r\n######,´#######‾#######`.\r\n#####\"###################\"\r\nasciiend,ascii\r\n#\r\n#\r\n#######################\\`-`~.\r\n#######################,｛_ ` `´;\r\n######__...__####,´‾‾`´  ,`/~-`\r\n###.´‾  __   ‾`-´  ,._   ;\r\n#.´´‾##))##`.._ _,´###((´\r\n######,´#######‾#######`.\r\n#####\"###################\"\r\nasciiend]\r\n\r\nvar ChineseDragonBody = [ascii\r\n####################_###,\r\n######_..-.._####,´‾ ‾`´  ,\r\n###.´‾. --   ‾`-´  _._   ;\r\n##/´‾##))##`._  _,´###((´\r\n#'####,´######‾‾#######`´\"\r\n#####\"\r\nasciiend,ascii\r\n###################_####,\r\n######_.-.._####,´‾ ‾'-´  ,\r\n###.´‾  __   ‾`‾   _     ;\r\n##/´‾‾#))#`._   _,´#‾`((´\r\n#´####,´#####‾‾########`´\"\r\n#####\"\r\nasciiend,ascii\r\n##################_#####,\r\n#####_.-.._####,´‾ ‾'- ´  ,\r\n###.´  __  ‾‾`´   _      /\r\n#,´´‾‾#))`._   _,´#‾‾`((´\r\n######,´#####‾‾########`.\r\n#####\"###################\"\r\nasciiend,ascii\r\n#################_######,\r\n#####_.-._####,´‾ ‾'-.-´  ,\r\n###.´ _     ‾`´   _      /\r\n#-´ ´‾#))`._  _,´#‾` (/´\r\n######,´####‾‾########`.\r\n#####\"#################\"\r\nasciiend,ascii\r\n################_#######,\r\n#####_##_####,´‾ ‾'-._,'  ,\r\n#-.-´ ‾‾  ‾`´   _        /\r\n####‾` ))._  _,´#‾`._// ´\r\n######,´###‾‾########`,\r\n#####\"###############\"\r\nasciiend,ascii\r\n###############_########,\r\n########_###,´‾ ‾'-._#,'  ,\r\n#´`\\`--´  ‾´   _         /\r\n####`-.))_  _,´#‾`-.-))´\r\n######.´##‾‾########,´\r\n######`\"###########\"\r\nasciiend,ascii\r\n##############_#########,\r\n#,.#####_##,´‾ ‾'-._##,'  ,\r\n###\\`--´ ‾´   _     ‾‾   /\r\n####`-.//_ _,´#‾`-._.))´\r\n######`,##‾#########,´\r\n#######\"###########\"\r\nasciiend,ascii\r\n#############_##########,\r\n#`..######,´‾ ‾'-._##_.´  ,\r\n###\\``-.-´   _      ‾   .´\r\n####`-.(( _,´#‾`-.__.))´\r\n########`´\"#########,´\r\n###################\"\r\nasciiend,ascii\r\n############_###########,\r\n#,`.#####,´‾ ‾'-._##_.-´  ,\r\n###\\``--´   _      ‾    .´\r\n####`-.((_,´#‾`-.__ _,))\r\n########`´\"########‾#,´\r\n####################\"\r\nasciiend,ascii\r\n###########_############,\r\n#,`.####,´‾ ‾'-._##_.´`´  ,\r\n###\\``-´   _      ‾     ,´\r\n####`-.((,´#‾`-.__  _.))\r\n########`.########‾‾#,´\r\n#########\"##########\"\r\nasciiend,ascii\r\n##########_#############,\r\n#``.###,´‾ ‾'-._##_#,´`´  ,\r\n###\\`-´   _      ‾      ,´\r\n####`-´((‾#‾`-. _ _ _,|)\r\n########`.#########‾##`,\r\n#########\"############\"\r\nasciiend,ascii\r\n########################,\r\n#´`.###.´ ‾`-.#_#_.--´`´  ,\r\n###\\ ‾´  _      ‾       ,´\r\n####`-´(/#‾`-._ __,-._(/\r\n########`,#####‾#######`.\r\n########\"###############\"\r\nasciiend,ascii\r\n########################,\r\n##'.#_,-´ ‾`-.._#.'´‾´`´  ,\r\n##`.`  __               ,´\r\n####`‾#//‾`-._  _-´`._((\r\n#######`,#####‾########`.\r\n#######\"#################\"\r\nasciiend,ascii\r\n########################,\r\n#####.-´ ‾`-..#_#.'´‾´`´  ,\r\n`..-´  _._               ;\r\n##``´´#))#‾`._   _-´`._((\r\n######,´######‾#########`.\r\n#####\"####################\"\r\nasciiend]\r\n\r\nvar ScreenX\r\nvar px\r\nvar t\r\nvar tt\r\n\r\nvar x = pos.x-40\r\nvar y = -5\r\nvar Attackframe = -1\r\nvar CancelAttack = false\r\nvar MovementFrame = 0\r\nvar ExplosionCoords = []\r\nvar Boom = import Cosmetics/Explosion\r\nvar customStyle = ui.AddStyle(\"\r\n^###\r\n^###\r\n^###\")\r\n\r\nvar MotherPanel\r\nvar DragonBody\r\nvar DragonHead\r\nvar FirePanel\r\nvar ResetPosition\r\n\r\n?key = UpBegin\r\n  y++\r\n  MotherPanel.y = y\r\n:?key = DownBegin\r\n  y--\r\n  MotherPanel.y = y\r\n\r\n\r\nScreenX = screen.FromWorldX(x)\r\npx = pos.x\r\nt = time\r\ntt = totalTime\r\n\r\n?loc.begin | loc.loop\r\n  MotherPanel = ui.AddPanel()\r\n  DragonBody = ui.AddText()\r\n  DragonHead = ui.AddText()\r\n  FirePanel = ui.AddPanel()\r\n  FirePanel.style = customStyle\r\n  x = px-30\r\n  MotherPanel.style = customStyle\r\n  MotherPanel.Add(DragonBody)\r\n  MotherPanel.Add(DragonHead)\r\n  DragonBody.w = 99\r\n  DragonHead.w = 99\r\n  DragonHead.y = -1\r\n  DragonHead.x = 19\r\n  ResetPosition = true\r\n  MotherPanel.y = y\r\n\r\n?t%28 = 2\r\n  DragonHead.x = 37 - DragonHead.x\r\nMotherPanel.x = ScreenX\r\n\r\nfunc MoveFoward()\r\n  ?px - x > 15 & t%2=0\r\n    x++\r\n  :?px - x > 50 & t%4=1\r\n    x++\r\n  ?screen.FromWorldX(px) < 14\r\n    x = math.Max( x , px - 38 )\r\n\r\nfunc FlyingAnimation()\r\n  DragonBody.y = 0\r\n  ?tt%4 = 0\r\n    MovementFrame = (MovementFrame+1)\r\n    DragonBody.text = ChineseDragonBody[MovementFrame%ChineseDragonBody.Count()]\r\n    DragonHead.text = ChineseDragonHead[MovementFrame%ChineseDragonHead.Count()]\r\n\r\n?Attackframe > -1\r\n  ?MovementFrame = 0\r\n    DragonHead.text = \"\"\r\n    ?Attackframe%4 = 0\r\n      DragonBody.text = DragonAttack[Attackframe/4]\r\n      DragonBody.y = -3\r\n    Attackframe = (Attackframe+1)%(DragonAttack.Count()*4)\r\n    ?Attackframe = 0\r\n      Attackframe = -1\r\n    :?Attackframe = 22\r\n      ?foe.distance < 25\r\n        ExplosionCoords = [px+foe.distance+3,pos.z]\r\n      SetFireBall()\r\n    ?screen.FromWorldX(px) < 14\r\n      x = math.Max( x , px - 38 )\r\n  :\r\n    MoveFoward()\r\n    ?t%2\r\n      ?MovementFrame%14 < 6\r\n        MovementFrame--\r\n      :\r\n        MovementFrame = (MovementFrame + 1)%14\r\n    DragonBody.text = ChineseDragonBody[MovementFrame%ChineseDragonBody.Count()]\r\n    DragonHead.text = ChineseDragonHead[MovementFrame%ChineseDragonHead.Count()]\r\n:\r\n  MoveFoward()\r\n  FlyingAnimation()\r\n\r\n?Attackframe = -1\r\n  ?key = PrimaryBegin\r\n    ?ScreenX+27<input.x\r\n      ExplosionCoords = [screen.ToWorldX(input.x),input.y]\r\n      Attackframe = 0\r\n  ?foe.distance < 30 & ScreenX > -13\r\n    ExplosionCoords = [px+foe.distance+3,pos.z]\r\n    Attackframe = 0\r\n\r\n?t ! tt & ResetPosition\r\n  ?loc=harder\r\n    x = px-40\r\n    ResetPosition = false\r\n\r\nvar FireColour = color.FromRGB(18,5,0)\r\nvar FireBallX\r\nvar FireBallStartX\r\nvar FireBallVelocity = []\r\nvar FireBallA\r\nvar FireBallB\r\nvar FireBallC\r\nvar FireBallD\r\nvar FireText\r\nvar drawFireball = !sys.isMobile\r\n\r\n?FireBallVelocity.Count()>0\r\n  var PercentTraveled\r\n  PercentTraveled = (1.0*FireBallX-FireBallStartX)/(ExplosionCoords[0]-FireBallStartX)\r\n  FireBallX = FireBallX + FireBallVelocity[0]\r\n  FirePanel.x = screen.FromWorldX(FireBallX)-46\r\n  FirePanel.y = y + math.FloorToInt(PercentTraveled*FireBallVelocity[1])\r\n\r\n  ?PercentTraveled >= 1.0\r\n    FireBallVelocity.Clear()\r\n    FirePanel.Recycle()\r\n    ?drawFireball\r\n      Boom.Explosion(0,ExplosionCoords[1])\r\n    :\r\n      play bomb_cart_explosion 100\r\n\r\nfunc SetFireBall()\r\n  FirePanel.Recycle()\r\n  FirePanel = ui.AddPanel()\r\n  FirePanel.style = customStyle  \r\n\r\n  FireBallA = ui.AddCanvas() \r\n  FireBallB = ui.AddCanvas() \r\n  FireBallC = ui.AddCanvas() \r\n  FireBallD = ui.AddCanvas() \r\n  FireText = ui.AddText(\"φ\")\r\n\r\n  FireBallX = x+28\r\n  FireBallStartX = x+28\r\n  FirePanel.x = screen.FromWorldX(FireBallX)\r\n  FirePanel.y = y\r\n  FireBallVelocity = [ math.RoundToInt(math.Sign(ExplosionCoords[0]-x-28)*3) ,ExplosionCoords[1]-screen.h/2-y]\r\n\r\n  FireBallA.w = 5\r\n  FireBallA.h = 3\r\n\r\n  FireBallB.w = 7\r\n  FireBallB.h = 1\r\n\r\n  FireBallC.w = 3\r\n  FireBallC.h = 3\r\n\r\n  FireBallD.w = 1\r\n  FireBallD.h = 5\r\n\r\n  FireText.align = center\r\n  FireText.y = 2\r\n  FireText.color = #yellow\r\n\r\n  FireBallA.blend = Add\r\n  FireBallB.blend = Add\r\n  FireBallC.blend = Add\r\n  FireBallD.blend = Add\r\n\r\n  FireBallA.SetBG(FireColour)\r\n  FireBallB.SetBG(FireColour)\r\n  FireBallC.SetBG(FireColour)\r\n  FireBallD.SetBG(FireColour)\r\n\r\n  FirePanel.Add(FireBallA)\r\n  FirePanel.Add(FireBallB)\r\n  FirePanel.Add(FireBallC)\r\n  FirePanel.Add(FireBallD)\r\n  FirePanel.Add(FireText)\r\n\r\nBoom.ExplosionStatus()\r\n?Boom.ExplosionCurrentDuration > -1\r\n  Boom.ExplosionX = screen.FromWorldX(ExplosionCoords[0])\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Bear.txt" - Parse error: Failed to parse completely. Remaining: "= [ascii\r\n##_###_\r\n#(_)_(_)\r\n#/     \\\r\n(   '-' )\r\n#\\_____/\r\nasciiend,\r\n^ascii\r\n##_###_\r\n#(_)_(_)\r\n#/     \\\r\n(   `-` )\r\n#\\_____/\r\nasciiend,\r\n^ascii\r\n##_###_\r\n#(_)_(_)\r\n#/     \\\r\n(  '-'  )\r\n#\\_____/\r\nasciiend,\r\n^ascii\r\n##_###_\r\n#(_)_(_)\r\n#/     \\\r\n(  `-`  )\r\n#\\_____/\r\nasciiend,\r\n^ascii\r\n##_###_\r\n#(_)_(_)\r\n#/     \\\r\n(   >_< )\r\n#\\_____/\r\nasciiend]\r\n\r\n//0~3(loop:01210 / 01230) move / stop(1 / 3)\r\n//4 stop\r\nvar body = [\r\n//move / stop\r\n^ascii\r\n#/ /  |\\\r\n(_/   |_)\r\n##|_|\\_)\r\nasciiend,\r\n^ascii\r\n#| |  ||\r\n#(_)  |)\r\n##|_|_|\r\nasciiend,\r\n^ascii\r\n##\\ \\ |\r\n##|\\_)|\r\n## \\_)|\r\nasciiend,\r\n^ascii\r\n#| |  ||\r\n#(_)  |)\r\n##|_|_|\r\nasciiend,\r\n\r\n//sit\r\n^ascii\r\n#|\\ \\|_\\\r\n#._\\_)_))\r\nasciiend]\r\n\r\nvar icecream = ascii\r\n###___\r\n##(  .)\r\n#( '  ,)\r\n(_______)\r\n#\\_____/\r\n##\\   /\r\n###\\_/\r\nasciiend\r\n\r\n////////// ascii data // end //////////\r\n\r\n\r\n////////// variables // start //////////\r\n\r\nvar headindex = 0\r\nvar bodyindex = 1\r\nvar img\r\n\r\nvar x = pos.x - 20\r\nvar y = pos.y\r\nvar z = pos.z\r\n\r\nvar stopX = 9999\r\nvar stopY = 0\r\nvar stopZ = 0\r\n\r\nvar sx\r\nvar sy\r\n\r\nvar bossFight = false\r\n\r\nvar mode = \"stop\"\r\nvar timer = 0\r\nvar speed\r\n\r\n////////// variables // end //////////\r\n\r\n\r\n///////////////////////////////////\r\n////////// main // start //////////\r\n///////////////////////////////////\r\n\r\nfunc main()\r\n\t?loc.loop | (time = 1 & loc ! rocky)\r\n\t\tresetting()\r\n\t?mode ! \"fixed\"\r\n\t\tcheckStopPosition()\r\n\t\tupdateMoveMode()\r\n\tmoveProcessing()\r\n\t?pos.x - x < 70\r\n\t\tupdateDraw()\r\n\t//test()\r\n\r\n/////////////////////////////////\r\n////////// main // end //////////\r\n/////////////////////////////////\r\n\r\n\r\n////////// loop initialize // start //////////\r\n\r\nfunc resetting()\r\n\theadindex = 0\r\n\tbodyindex = 1\r\n\r\n\t?loc = harder\r\n\t\tx = -500\r\n\t\tz = 20\r\n\t:\r\n\t\tx = pos.x - 20\r\n\t\tz = pos.z\r\n\ty = pos.y\r\n\r\n\tstopX = 9999\r\n\tstopY = 0\r\n\r\n\tbossFight = false\r\n\t\r\n\tmode = \"stop\"\r\n\ttimer = 0\r\n\r\n////////// loop initialize // end //////////\r\n\r\n\r\n////////// check boss fight // start //////////\r\n\r\nfunc checkStopPosition()\r\n\t?foe.count & (foe = boss | (loc.stars > 10 & ((loc = hall & screen.i = 7) | (loc = deadwood & screen.i = 6))))\r\n\t\t?(foe.distance <= 35 & pos.x < screen.x)\r\n\t\t\tstopX = screen.x - screen.w / 2 + 4\r\n\r\n\t\t?loc = icy\r\n\t\t\tstopY = -1\r\n\t\t:?loc = temple | loc = deadwood\r\n\t\t\tstopY = -2\r\n\t\t:?loc = caves | loc = mine | (loc = hall & loc ! harder)\r\n\t\t\tstopY = -3\r\n\t\t:\r\n\t\t\tstopY = -4\r\n\r\n\t\t?foe = phase1\r\n\t\t\tbossFight = true\r\n\t:?!bossFight\r\n\t\t?loc = temple & ai.paused & !foe.count & loc ! harder\r\n\t\t//((loc.stars > 5 & pos.x >= 1154) | (loc.stars > 10 & pos.x >= 1085))\r\n\t\t\tstopX = pos.x - 15\t\r\n\t\t\tmode = \"fixed\"\r\n\t\t:\r\n\t\t\tstopX = 9999\r\n\t\t\tstopY = 0\r\n\r\n////////// check boss fight // end //////////\r\n\r\n////////// check move // start //////////\r\n\r\nfunc updateMoveMode()\r\n\t?x >= stopX & y = stopY\r\n\t\tmode = \"sit\"\r\n\t:?mode ! \"fixed\"\r\n\t\t?x >= pos.x - 15 & stopX = 9999\r\n\t\t\tmode = \"stop\"\r\n\t\t:?mode ! \"find location\"\r\n\t\t\tstopZ = pos.z\r\n\r\n\t\t\t?x >= stopX - y + stopY\r\n\t\t\t\tmode = \"find location\"\r\n\t\t\t:?mode ! \"run\"\r\n\t\t\t\t?x < pos.x - 70\r\n\t\t\t\t\tmode = \"run\"\r\n\t\t\t\t:?x < pos.x - 30\r\n\t\t\t\t\tmode = 3\r\n\t\t\t\t:?x < pos.x - 25\r\n\t\t\t\t\tmode = 2\r\n\t\t\t\t:?x < pos.x - 18\r\n\t\t\t\t\tmode = 1\r\n\r\n////////// check move // end //////////\r\n\r\n\r\n////////// move // start //////////\r\n\r\nfunc moveProcessing()\r\n\theadindex = 0\r\n\r\n\t?mode = \"sit\"\r\n\t\tbodyindex = 4\r\n\t\t?totaltime % 330 >= 0 & totaltime % 330 < 12\r\n\t\t\theadindex = 2\r\n\r\n\t:?mode ! \"stop\" & (x ! stopX | y ! stopY | z ! stopZ)\r\n\t\tupdateMoveSpeed()\r\n\t\ttimer = (timer + 1) % speed\r\n\r\n\t\t?timer = 0\r\n\t\t\tbodyindex = (bodyindex + 1) % 4\r\n\r\n\t\t\t?x < stopX\r\n\t\t\t\tx++\r\n\t\t\t\t?mode = \"run\"\r\n\t\t\t\t\tx++\r\n\r\n\t\t\t?mode = \"find location\"\r\n\t\t\t\t?y > stopY\r\n\t\t\t\t\ty--\r\n\t\t\t\t:\r\n\t\t\t\t\ty = stopY\r\n\t\t\t:\r\n\t\t\t\t?y < 0\r\n\t\t\t\t\ty++\r\n\r\n\t\t\t?z > stopZ\r\n\t\t\t\tz--\r\n\t\t\t:?z < stopZ\r\n\t\t\t\tz++\r\n\t:\r\n\t\ttimer = 0\r\n\t\tbodyindex = 1\r\n\r\n\t?mode = \"run\"\r\n\t\theadindex = 4\r\n\t//blink\r\n\t:?totaltime % 90 >= 0 & totaltime % 90 < 3\r\n\t\theadindex = headindex + 1\r\n\r\nfunc updateMoveSpeed()\r\n\t?type(mode) = int\r\n\t\tspeed = 4 - mode\r\n\t:?mode = \"run\"\r\n\t\tspeed = 1\r\n\t:?mode = \"find location\"\r\n\t\tspeed = 3\r\n\r\n////////// move // end //////////\r\n\r\n\r\n////////// draw // start //////////\r\n\r\nfunc updateDraw()\r\n\tsy = y + pos.y - 4 + z - pos.z\r\n\r\n\t?mode = \"sit\"\r\n\t\tsy++\r\n\t\t\r\n\t\t// icecream\r\n\t\t//sx = x - pos.x + 9\r\n\t\t//>o@sx@,@sy@,@icecream@\r\n\r\n\tsx = x - pos.x\r\n\r\n\t// head\r\n\timg = head[headindex]\r\n\t>o@sx@,@sy@,@img@\r\n\r\n\tsy = sy + 5\r\n\r\n\t// body\r\n\timg = body[bodyindex]\r\n\t>o@sx@,@sy@,@img@\r\n\r\n////////// draw // end //////////\r\n\r\n\r\n////////// test //////////\r\nfunc test()\r\n\timg = head[headindex]\r\n\t>`0,0,@img@\r\n\timg = body[bodyindex]\r\n\t>`0,5,@img@\r\n\ta = foe = phase1\r\n\t>`0,10,@headindex@ @bodyindex@ @mode@ @bossFight@\\n@x@ @y@ @z@\\n@stopX@ @stopY@ @stopZ@\\n@sx@ @sy@\r\n\r\n\r\nmain()"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/TwinSuns.txt" - Parse error: Failed to parse completely. Remaining: "?loc=＂icy＂\r\n  pos=22\r\n:?loc=＂rocky＂\r\n  ?foe=＂phase＂\r\n    pos=22\r\n  :\r\n    pos=26\r\n?loc=＂icy＂|loc=＂rocky＂\r\n  ?glasses\r\n    >`@pos@,1,ascii\r\n        .   \r\n  `.   _!_   .´ _ \r\n    ,´¯   ¯`.  ｛＂｝\r\n   /-._______\\  ¯\r\n-- |  |__||__| --\r\n   \\         /\r\n    `._   _.´\r\n  .´   ¯¡¯   `.\r\n        '\r\nasciiend\r\n  : \r\n    >`@pos@,1,ascii\r\n        .   \r\n  `.   _!_   .´ _ \r\n    ,´¯   ¯`.  ｛ ｝\r\n   /         \\  ¯\r\n-- |         | --\r\n   \\         /\r\n    `._   _.´\r\n  .´   ¯¡¯   `.\r\n        '\r\nasciiend\r\n?loc=temple&(screen.i%4=1)&loc!＂nagaraja＂\r\n  ?glasses\r\n    >`35,1,ascii\r\n_\r\n＂｝\r\n¯\r\nasciiend\r\n\r\n  :\r\n    >`35,1,ascii\r\n_\r\n ｝\r\n¯\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Pomeranian.txt" - Parse error: Failed to parse completely. Remaining: "= #FFFFFF\r\nvar backpackColour = #AD7A40\r\nvar candleColour = #fff0af\r\nvar fireColour = #ff7300\r\nvar lightColour = #0e0a07\r\nvar lightColour2 = #26201a\r\n// var lightColour = #ff7300\r\n\r\nvar keepDistance = -10                     // Distance from Stonehead\r\nvar maxX = -9                              // Closest to Stonehead\r\n\r\nvar maxDistance = -20                      // Max distance before teleporting back     \r\n\r\nvar targetZ = 0                           // Z position relative\r\n\r\nvar x = 0\r\nvar y = 0\r\nvar myX = 0\r\nvar myZ = 0\r\nvar lastPlayerX = 0\r\nvar lastPlayerZ = 0\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1                          // Standing around\r\nvar stateSit = 2                           // Standing too long\r\nvar stateWalk = 3                          // Walking\r\nvar currentState = stateNone\r\nvar stateTime = 0                          // Time in current state\r\nvar sitting = 0                            // Time to determine sit\r\n\r\nfunc SetState(newState)\r\n  currentState = newState                  // Set new state\r\n  stateTime = 0                            // Reset time\r\n\r\n?currentState = stateNone | time = 1       // If start\r\n  lastPlayerX = pos.x                      // Set last player position\r\n  lastPlayerZ = pos.z                      // Set last player position\r\n  myX = keepDistance                       // Set distance from Stonehead\r\n  myZ = targetZ                            // Set Z position\r\n\r\n  ?time > 1                                // If you're already in\r\n    myX = maxDistance                      // Set to farthest\r\n\r\n  SetState(stateWalk)                      // Start walking\r\n\r\nmyX = myX - (pos.x - lastPlayerX)          // Move with player\r\n\r\nstateTime++                                // Increment time\r\n\r\n?currentState = stateIdle                  // If he's idle\r\n  ?myX < maxDistance | myX > -maxDistance  // If not in range\r\n    myX = maxDistance                      // Set to farthest\r\n  myZ = myZ - (pos.z - lastPlayerZ)        // Set height\r\n\r\n  ?myX < keepDistance                      // If too far\r\n    SetState(stateWalk)                    // Start walking\r\n\r\n:?currentState = stateWalk                 // If he's walking\r\n  ?myX < maxX                              // and too far\r\n    myX++                                  // Move closer\r\n  \r\n  ?loc = \"waterfall\"\r\n    ?rng % 10 = 0 & myZ < 0\r\n      myZ++\r\n    :?rng % 10 = 1 & myZ > -4\r\n      myZ--\r\n  :\r\n    ?rng % 10 = 0 & myZ < 7\r\n      myZ++\r\n    :?rng % 10 = 1 & myZ > 0\r\n      myZ--\r\n\r\n// ?stateTime >= 6                            // If more than 6 frames\r\n//   ?myZ > targetZ                           // Reset Z position\r\n//     myZ--\r\n//   :?myZ < targetZ\r\n//     myZ++\r\n\r\n?currentState = stateWalk                  // If he's walking\r\n  >c0,2,Why\r\n  sitting = 0                              // Reset sitting timer\r\n  ?!ai.walking                             // But if you're not walking\r\n    SetState(stateIdle)                    // Set him to idle\r\n\r\n?currentState = stateIdle                  // If he's idle\r\n  sitting++                                // Start counting\r\n  ?sitting >= 50 & foe.distance = 9999     // If the count is high enough and no enemies\r\n    SetState(stateSit)                     // Sit\r\n\r\nlastPlayerX = pos.x                        // Set last player position\r\nlastPlayerZ = pos.z\r\n\r\n?currentState = stateSit & stateTime % 6 < 3\r\n    >o@myX@,@myZ@,@dogColour@,ascii\r\n##;\"|\r\nι/, ;\r\nasciiend\r\n:?currentState = stateSit & stateTime % 6 >= 3\r\n    >o@myX@,@myZ@,@dogColour@,ascii\r\n##;\"|\r\n_/, ;\r\nasciiend\r\n:?currentState = stateIdle\r\n    >o@myX@,@myZ@,@dogColour@,ascii\r\n:_;\"|\r\n;.,,'\r\nasciiend\r\n:?currentState = stateWalk & stateTime % 3 = 0\r\n^| stateTime % 3 = 1\r\n    >o@myX@,@myZ@,@dogColour@,ascii\r\n:_;\"|\r\n:.,.'\r\nasciiend\r\n:?currentState = stateWalk & stateTime % 3 = 2\r\n    >o@myX@,@myZ@,@dogColour@,ascii\r\n:_;\"|\r\n;.メ'\r\nasciiend\r\n\r\n// Backpack\r\n?currentState = stateWalk\r\n^& stateTime % 20 < 5\r\n  >o@myX@,@myZ@,@backpackColour@,ascii\r\n#⌐\r\n#´\r\nasciiend\r\n:?currentState = stateWalk\r\n^& stateTime % 20 < 10\r\n  >o@myX@,@myZ@,@backpackColour@,ascii\r\n#⌐\r\n#'\r\nasciiend\r\n:?currentState = stateWalk\r\n^& stateTime % 20 < 15\r\n  >o@myX@,@myZ@,@backpackColour@,ascii\r\n#⌐\r\n#`\r\nasciiend\r\n:?currentState = stateWalk\r\n^& stateTime % 20 < 20\r\n  >o@myX@,@myZ@,@backpackColour@,ascii\r\n#⌐\r\n#'\r\nasciiend\r\n:?currentState = stateIdle\r\n  >o@myX@,@myZ@,@backpackColour@,ascii\r\n#⌐\r\n#'\r\nasciiend\r\n:?currentState = stateSit\r\n  >o@myX@,@myZ@,@backpackColour@,ascii\r\n#┌\r\n#y\r\nasciiend\r\n\r\n// candle\r\n>o@myX@,@myZ@,@candleColour@,ascii\r\n###╨\r\nasciiend\r\n\r\nvar fireStill = []\r\nfireStill = [\r\nascii\r\n#\r\n·\r\nasciiend,\r\nascii\r\n#\r\n'\r\nasciiend,\r\nascii\r\n#\r\n·\r\nasciiend,\r\nascii\r\n#\r\n'\r\nasciiend,\r\nascii\r\n#\r\n·\r\nasciiend,\r\nascii\r\n#\r\n'\r\nasciiend,\r\nascii\r\n#\r\n•\r\nasciiend,\r\nascii\r\n#\r\n:\r\nasciiend,\r\nascii\r\n.\r\n·\r\nasciiend,\r\nascii\r\n·\r\n'\r\nasciiend,\r\nascii\r\n'\r\n'\r\nasciiend\r\n]\r\n\r\nvar fireWalk = []\r\nfireWalk = [\r\nascii\r\n#\r\n###·\r\nasciiend,\r\nascii\r\n#\r\n###`\r\nasciiend,\r\nascii\r\n#\r\n###·\r\nasciiend,\r\nascii\r\n#\r\n###`\r\nasciiend,\r\nascii\r\n#\r\n###·\r\nasciiend,\r\nascii\r\n#\r\n###`\r\nasciiend,\r\nascii\r\n#\r\n###•\r\nasciiend,\r\nascii\r\n#\r\n###:\r\nasciiend,\r\nascii\r\n##.\r\n###·\r\nasciiend,\r\nascii\r\n#·\r\n###`\r\nasciiend,\r\nascii\r\n'\r\n###`\r\nasciiend\r\n]\r\n\r\n// fire\r\nvar fireTimer = 0\r\n?currentState = stateIdle\r\n^| currentState = stateSit\r\n  >o@myX+3@,@myZ-2@,@fireColour@,@fireStill[fireTimer]@\r\n:?currentState = stateWalk\r\n  >o@myX@,@myZ-2@,@fireColour@,@fireWalk[fireTimer]@\r\n?fireTimer >= 6 & totaltime % 5 = 0\r\n    fireTimer++\r\n:?fireTimer % 2 = 0 & totaltime % 10 = 0\r\n  fireTimer++\r\n:?totaltime % 30 = 0\r\n  fireTimer++\r\n?fireTimer = fireStill.Count()\r\n  fireTimer = 0\r\n\r\nvar fireLightA\r\nvar fireLightB\r\nvar fireLightC\r\nvar fireLightD\r\nvar fireLightE\r\nvar fireLightF\r\nvar basePanel\r\nvar customStyle = ui.AddStyle(\"\r\n^###\r\n^###\r\n^###\")\r\n\r\nfunc SetFire()\r\n  basePanel = ui.AddPanel()\r\n  basePanel.style = customStyle\r\n\r\n  fireLightA = ui.AddCanvas()\r\n  fireLightB = ui.AddCanvas()\r\n  fireLightC = ui.AddCanvas()\r\n  fireLightD = ui.AddCanvas()\r\n  fireLightE = ui.AddCanvas()\r\n  fireLightF = ui.AddCanvas()\r\n\r\n  basePanel.x = 20\r\n  basePanel.y = 10\r\n  basePanel.anchor = top_left\r\n  basePanel.dock = top_left\r\n\r\n  fireLightA.w = 12\r\n  fireLightA.h = 16\r\n  fireLightB.w = 20\r\n  fireLightB.h = 14\r\n  fireLightC.w = 24\r\n  fireLightC.h = 12\r\n  fireLightD.w = 28\r\n  fireLightD.h = 10\r\n  fireLightE.w = 32\r\n  fireLightE.h = 6\r\n\r\n  fireLightA.blend = Add\r\n  fireLightB.blend = Add\r\n  fireLightC.blend = Add\r\n  fireLightD.blend = Add\r\n  fireLightE.blend = Add\r\n\r\n  fireLightA.SetBG(lightColour)\r\n  fireLightB.SetBG(lightColour)\r\n  fireLightC.SetBG(lightColour)\r\n  fireLightD.SetBG(lightColour)\r\n  fireLightE.SetBG(lightColour)\r\n\r\n  fireLightA.SetFG(lightColour2)\r\n  fireLightB.SetFG(lightColour2)\r\n  fireLightC.SetFG(lightColour2)\r\n  fireLightD.SetFG(lightColour2)\r\n  fireLightE.SetFG(lightColour2)\r\n\r\n  basePanel.Add(fireLightA)\r\n  basePanel.Add(fireLightB)\r\n  basePanel.Add(fireLightC)\r\n  basePanel.Add(fireLightD)\r\n  basePanel.Add(fireLightE)\r\n\r\n?totaltime = 1\r\n  SetFire()\r\n:\r\n  basePanel.x = screen.FromWorldX(pos.x + myX - 1)\r\n  basePanel.y = screen.FromWorldZ(pos.z + myZ - 6)\r\n\r\nvar barkColour = #FFFFFF\r\nvar barkCount = 4\r\nvar num\r\n\r\nvar rng_x = 0\r\nvar rng_xmax = 2\r\nvar rng_xmin = -2\r\n\r\nvar rng_z = 0\r\nvar rng_zmax = -1\r\nvar rng_zmin = -2\r\n\r\nvar barks_xpos = []\r\nvar barks_zpos = []\r\n\r\nvar draw_x\r\nvar draw_z\r\n\r\n//extract integer color channels from hex value\r\nvar c_ints = colorToInt(barkColour)\r\nvar c_ints_r = c_ints[0]\r\nvar c_ints_g = c_ints[1]\r\nvar c_ints_b = c_ints[2]\r\n\r\n//modify integer values to get note colors\r\nvar c_ints_age1 = [c_ints_r, c_ints_g, c_ints_b]\r\nvar c_ints_age2 = [math.Clamp(c_ints_r-68,0,512), math.Clamp(c_ints_g-68,0,512), math.Clamp(c_ints_b-68,0,512)]\r\nvar c_ints_age3 = [math.Clamp(c_ints_r-136,0,256), math.Clamp(c_ints_g-136,0,256), math.Clamp(c_ints_b-136,0,256)]\r\n\r\n//generate hex color values from modified color channels\r\nvar color_age1 = intToColor(c_ints_age1)\r\nvar color_age2 = intToColor(c_ints_age2)\r\nvar color_age3 = intToColor(c_ints_age3)\r\n\r\nrng_x = rng_xmin + rng % (rng_xmax - rng_xmin + 1)\r\nrng_z = rng_zmin + rng % (rng_zmax - rng_zmin + 1)\r\n\r\nbarks_xpos.Add((myX + rng_x))\r\nbarks_zpos.Add((myZ + rng_z))\r\n\r\n?barks_xpos.Count() > barkCount\r\n  barks_xpos.RemoveAt(0)\r\n  barks_zpos.RemoveAt(0)\r\n\r\n?rng % foe.distance = 0\r\n  num = barks_xpos.Count()\r\n  ?num > 0\r\n    ?num > barkCount\r\n      num = barkCount\r\n    for i = 0 .. num-1\r\n      draw_x = barks_xpos[i]\r\n      draw_z = barks_zpos[i]\r\n\r\n      ?i = 0\r\n        >o@draw_x@,@draw_z@,@color_age1@,-bark-\r\n      :?i < 3\r\n        >o@draw_x@,@draw_z@,@color_age2@,-bark-\r\n      :?i < barkCount\r\n        >o@draw_x@,@draw_z@,@color_age3@,-bark-\r\n\r\n//color conversion helper functions\r\n\r\n//converts 6-digit color code to integers\r\n//returns a 3-element array containing r,g,b as integers\r\nfunc colorToInt(color)\r\n  ?string.Size(color) < 7\r\n    return [0,0,0]\r\n\r\n  ?color = \"#rainbow\"\r\n    return [1024,1024,1024]\r\n\r\n  var r = hexInt(string.Sub(color, 1, 2))\r\n  var g = hexInt(string.Sub(color, 3, 2))\r\n  var b = hexInt(string.Sub(color, 5, 2))\r\n\r\n  return [r,g,b]\r\n\r\n\r\n//converts 3-element integer array to 6-digit color code\r\n//returns a hex color code in the form #rrggbb\r\nfunc intToColor(ints)\r\n  var t = ints[0]\r\n  ?t > 512\r\n    return \"#rainFF\"\r\n  :?t > 256\r\n    return \"#rain88\"\r\n  :?t > 255\r\n    return \"#rain44\"\r\n\r\n  var r = minLength(intHex(ints[0]), 2, 0)\r\n  var g = minLength(intHex(ints[1]), 2, 0)\r\n  var b = minLength(intHex(ints[2]), 2, 0)\r\n\r\n  return \"#\"+r+g+b\r\n\r\n\r\n//converts 2-digit hex to integer\r\nfunc hexInt(hex)\r\n  var int = 0\r\n  var size = string.Size(hex)\r\n  var digit = string.Sub(hex, 0, 1)\r\n\r\n  var msb = 1\r\n  var lsb = 0\r\n\r\n  ?string.Size(hex) > 1\r\n    int = hexInt(string.Sub(hex, 1, size-1)) + int\r\n\r\n  :?string.Size(hex) = 1\r\n    msb = 0\r\n    lsb = 1\r\n\r\n  ?digit = \"0\"\r\n    int = int + 0 * (16*msb)\r\n  :?digit = \"1\"\r\n    int = int + 1 * (16*msb + lsb)\r\n  :?digit = \"2\"\r\n    int = int + 2 * (16*msb + lsb)\r\n  :?digit = \"3\"\r\n    int = int + 3 * (16*msb + lsb)\r\n  :?digit = \"4\"\r\n    int = int + 4 * (16*msb + lsb)\r\n  :?digit = \"5\"\r\n    int = int + 5 * (16*msb + lsb)\r\n  :?digit = \"6\"\r\n    int = int + 6 * (16*msb + lsb)\r\n  :?digit = \"7\"\r\n    int = int + 7 * (16*msb + lsb)\r\n  :?digit = \"8\"\r\n    int = int + 8 * (16*msb + lsb)\r\n  :?digit = \"9\"\r\n    int = int + 9 * (16*msb + lsb)\r\n  :?digit = \"A\"\r\n    int = int + 10 * (16*msb + lsb)\r\n  :?digit = \"B\"\r\n    int = int + 11 * (16*msb + lsb)\r\n  :?digit = \"C\"\r\n    int = int + 12 * (16*msb + lsb)\r\n  :?digit = \"D\"\r\n    int = int + 13 * (16*msb + lsb)\r\n  :?digit = \"E\"\r\n    int = int + 14 * (16*msb + lsb)\r\n  :?digit = \"F\"\r\n    int = int + 15 * (16*msb + lsb)\r\n  :\r\n    int = int + 0\r\n  return int\r\n\r\n\r\n//function by DarkLucifer69\r\n//backfills a string to a particular length with a specified value\r\nfunc minLength(string, length, append)\r\n ?string.Size(string) < length\r\n  string = append + minLength(string, length-1, append)\r\n\r\n return string\r\n\r\n\r\n//function by DarkLucifer69\r\n//converts integer to hex value\r\nfunc intHex(int)\r\n var hex = \"\"\r\n \r\n ?int >= 16\r\n  hex = intHex(int/16) + hex \r\n  \r\n ?int % 16 <= 9\r\n  hex = hex + (int % 16)\r\n :?int % 16 = 10\r\n  hex = hex + \"A\"\r\n :?int % 16 = 11\r\n  hex = hex + \"B\"\r\n :?int % 16 = 12\r\n  hex = hex + \"C\"\r\n :?int % 16 = 13\r\n  hex = hex + \"D\"\r\n :?int % 16 = 14\r\n  hex = hex + \"E\"\r\n :?int % 16 = 15\r\n  hex = hex + \"F\"\r\n \r\n return hex"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Beach.txt" - Parse error: Failed to parse completely. Remaining: "##_____\r\n#\\#####\\\r\n# #\\-----\\\r\n#####\\#####\\\r\n######------\r\nasciiend\r\n  ui.root.visible = true\r\n  >c0,-12,#white,ascii\r\n#######################/\r\n######################/\r\n######################/\r\n#####################/\r\n####--###############/\r\n############-_######/\r\n#####################-\r\n######################/\r\n#####################/\r\n#############-######/. \r\n###################/.\r\n#################/.\r\n################/-    \r\n#######_--_##/.       \r\n############/ \r\n###########/\r\n##########/\r\n########/.  \r\n#######/\r\n#####/.               \r\n###/\r\n##/\r\n#/\r\n/\r\n/\r\nasciiend\r\n?loc = waterfall\r\n  >`85,0,#yellow,ascii\r\n##\r\n#<||||\r\n  /|||\r\n    V|\r\nasciiend\r\n// Kids/people\r\nvar sandC\r\n?loc = waterfall\r\n  ?loc.begin\r\n    sandC = ui.AddAnim(ascii\r\n#O\r\n#|= ,',\r\n##- |_|\r\n%%\r\n#O_\r\n#|##_~_\r\n##- |_|^\r\n###^\r\n%%\r\n#O\r\n#|-#_•_\r\n##-#|O|\r\n###^#- ^\r\nasciiend)\r\n  sandC.duration = 100\r\n  sandC.x = -20\r\n  sandC.Play()\r\n  sandC.loop = true\r\nvar ball\r\n?loc = waterfall\r\n  ?loc.begin\r\n    ball = ui.AddAnim(ascii\r\n\r\n\r\n(O-o\r\n#`#######\\O/\r\n—--######- --     \r\n%%\r\n\r\n\r\n .  o\r\n(O/######\\O/\r\n-•######- --\r\n%%\r\n#####O\r\n`  \r\n(O/######\\O/\r\n---####--#--\r\n%%\r\n      o    \r\n\r\n\r\n\\O/######\\O/\r\n—--######- -\r\n%%\r\n\r\n\r\n       o\r\n(O/######\\O/\r\n—--######- --\r\n\r\n\r\n%%\r\n\r\n\r\n         o\r\n(O/######<O>\r\n—--######- --\r\n%%\r\n\r\n\r\n         O !\r\n(O/######\\O>\r\n—--######- --\r\n%%\r\n\r\n\r\n        o###!\r\n(O/######\\O>\r\n—--######- --\r\n%%\r\n#######o\r\n       ######•\r\n(O/######\\O>\r\n—--######- --\r\n%%\r\n######o\r\n       ######.\r\n(O/######\\O>\r\n—--######- --\r\n%%\r\n#####o\r\n       ######.\r\n(O/######\\O>\r\n—--######- --\r\n%%\r\n####o\r\n       ####.     -\r\n(O/######\\O>\r\n—--######- --       \r\n%%\r\n\r\n\r\n    O   #########-#•\r\n(O/######\\O>\r\n—--######- --      \r\nasciiend)\r\n  ball.duration = 40\r\n  ball.loop = true\r\n  ball.Play()\r\n  ball.x = 35\r\n\r\n\r\nfunc OnPressed()\r\n  loc.leave()\r\n\r\n\r\n?loc = waterfall\r\n  var button = ui.AddButton()\r\n  button.h = 3\r\n  button.w = 5\r\n  button.y = -10\r\n  button.text = «\r\n  button.SetPressed(OnPressed)\r\n  button.x = -42\r\n\r\n\r\nvar vb\r\n?loc = waterfall\r\n  ?loc.begin\r\n    vb = ui.AddAnim(ascii\r\n\r\n\r\n#########\\ \\##########\r\n#O/#O####|||#########O\r\n#|/#######||#########=\\\r\n/ \\##################/#\\\r\n%%\r\n\r\n\r\n#####O###\\ \\##########\r\n#O/######|||#########O\r\n#|/#######||#########=\\\r\n/ \\##################/#\\\r\n%%\r\n        O\r\n#########\\ \\##########\r\n#O#######|||#########O\r\n#|/#######||#########=\\\r\n/ \\##################/#\\\r\n%%\r\n         O\r\n#########\\ \\##########\r\n#O#######|||#########O\r\n#|/#######||#########=\\\r\n/ \\##################/#\\\r\n%%\r\n            O\r\n#########\\ \\##########\r\n#O#######|||#########O\r\n#|/#######||#########=\\\r\n/ \\##################/#\\\r\n%%\r\n                O\r\n#########\\ \\##########\r\n#O### ###|||###### ##O\r\n#|/#######||#########=\\\r\n/ \\##################/#\\\r\n%%\r\n            \r\n#########\\ \\##########\r\n#O#######|||#######O#O\r\n#|/#######||#########=\\\r\n/ \\##################/#\\\r\n%%\r\n            \r\n#########\\ \\##########\r\n#O#######|||######O###O\r\n#|/#######||#########\\\\\r\n/ \\##################/#\\\r\n%%\r\n            O\r\n#########\\ \\##########\r\n#O/######|||##########O\r\n#|/#######||#########=|\r\n/ \\##################/#\\\r\n%%\r\n          O\r\n#########\\ \\##########\r\n#O/######|||#########O\r\n#|/#######||#########=\\\r\n/ \\##################/#\\\r\n%%\r\n      \r\n#########\\ \\##########\r\n#O/##O# #|||#########O\r\n#|/#######||#########=\\\r\n/ \\##################/#\\\r\nasciiend)\r\n  vb.duration = 40\r\n  vb.x = -30\r\n  vb.y = 10\r\n  vb.Play()\r\n  vb.loop = true\r\nimport UI/MindstoneButton"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetSnowBunny.txt" - Parse error: Failed to parse completely. Remaining: "= #white\r\n\r\nvar keepDistance = -18\r\nvar maxX = -11\r\n\r\nvar maxDistance\r\nmaxDistance = -70\r\n\r\nvar targetZ = -1\r\n\r\nvar x = 0\r\nvar y = 0\r\nvar myX = 0\r\nvar myZ = 0\r\nvar lastPlayerX = 0\r\nvar lastPlayerZ = 0\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1\r\nvar stateJump = 2\r\nvar currentState = stateNone\r\nvar stateTime = 0\r\n\r\n\r\nfunc SetState(newState)\r\n  ?newState = stateJump\r\n    play scout_wing\r\n\r\n  currentState = newState\r\n  stateTime = 0\r\n\r\n\r\n?currentState = stateNone | time = 1\r\n  lastPlayerX = pos.x\r\n  lastPlayerZ = pos.z\r\n  myX = keepDistance\r\n  myZ = targetZ\r\n\r\n  // Start further away if the bunny is summoned while the location is already running\r\n  ?time > 1\r\n    myX = maxDistance\r\n\r\n  SetState(stateIdle)\r\n\r\n\r\nmyX = myX - (pos.x - lastPlayerX)\r\n\r\nstateTime++\r\n\r\n?currentState = stateIdle\r\n  ?myX < maxDistance | myX > -maxDistance\r\n    myX = maxDistance\r\n  myZ = myZ - (pos.z - lastPlayerZ)\r\n\r\n  ?myX < keepDistance\r\n    SetState(stateJump)\r\n\r\n:?currentState = stateJump\r\n  ?myX < maxX\r\n    myX++\r\n\r\n  ?stateTime >= 6\r\n    ?myZ > targetZ\r\n      myZ--\r\n    :?myZ < targetZ\r\n      myZ++\r\n\r\n  ?stateTime >= 12\r\n    SetState(stateIdle)\r\n\r\n\r\nlastPlayerX = pos.x\r\nlastPlayerZ = pos.z\r\n\r\n// Draw\r\n\r\n?currentState = stateIdle\r\n  >o@myX@,@myZ@,@bunnyColor@,ascii\r\n#\r\n#####(\\(\\\r\n####( n.n)\r\n##o(,`_\"_)\r\nasciiend\r\n  x = myX + 6\r\n  y = myZ + 2\r\n  ?face = \"( ^^\"\r\n    >o@x@,@y@,@bunnyColor@,ascii\r\n^.^\r\nasciiend\r\n\r\n  :?stateTime % 50 >= 44\r\n    >o@x@,@y@,@bunnyColor@,ascii\r\n-.-\r\nasciiend\r\n\r\n?currentState = stateJump\r\n  ?stateTime/2 = 0\r\n    >o@myX@,@myZ@,@bunnyColor@,ascii\r\n#\r\n####(\\(\\\r\n#o__( n.n)\r\n,/ _'| \"|\r\nasciiend\r\n\r\n  :?stateTime/2 = 1\r\n    >o@myX@,@myZ@,@bunnyColor@,ascii\r\n#\r\n####(\\(\\\r\n#o__( n.n)\r\n##\\_'/_\"/\r\nasciiend\r\n\r\n  :?stateTime/2 = 2\r\n    >o@myX@,@myZ@,@bunnyColor@,ascii\r\n#\r\n###/( n.n)\r\n#o,- \\ \" \\\r\n#|_.-  \" \"\r\nasciiend\r\n\r\n  :?stateTime/2 = 3\r\n    >o@myX@,@myZ@,@bunnyColor@,ascii\r\n###/( n.n)\r\n#o,-' \\\" \\\r\n,/_.-'  \" \"\r\n#\r\nasciiend\r\n\r\n  :?stateTime/2 = 4\r\n    >o@myX@,@myZ@,@bunnyColor@,ascii\r\n####\\ \\\\\r\n#o--( n.n)\r\n= __' \\\" \\\r\n########\" \"\r\nasciiend\r\n\r\n  :?stateTime/2 = 5\r\n    >o@myX@,@myZ@,@bunnyColor@,ascii\r\n#\r\n##o_ \\ \\\\\r\n=_,  ( n.n)\r\n###`-' \\\" \\\r\nasciiend\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/LanternTalisman.txt" - Parse error: Failed to parse completely. Remaining: "?item.left = ＂golden＂\r\n    >o-3,1,#FFCC66,@lanterntalisman@\r\n  :?item.left = ＂+0＂\r\n    >o-3,1,#white,@lanterntalisman@\r\n  :?item.left = ＂+1＂\r\n    >o-3,1,#cyan,@lanterntalisman@\r\n  :?item.left = ＂+2＂ | item.left = ＂+3＂\r\n    >o-3,1,#yellow,@lanterntalisman@\r\n  :?item.left = ＂+4＂ | item.left = ＂+5＂ |\r\n  ^item.left = ＂+6＂\r\n    >o-3,1,#green,@lanterntalisman@\r\n  :?item.left = ＂+7＂ | item.left = ＂+8＂ |\r\n  ^item.left = ＂+9＂ | item.left = ＂+10＂\r\n    >o-3,1,#blue,@lanterntalisman@\r\n  :?item.left = ＂+11＂ | item.left = ＂+12＂ |\r\n  ^item.left = ＂+13＂ | item.left = ＂+14＂ |\r\n  ^item.left = ＂+15＂\r\n    >o-3,1,#red,@lanterntalisman@\r\n  :\r\n    >o-3,1,#rainFF,@lanterntalisman@\r\n  ?item.left.state ! 1\r\n    >o-2,2,#FFCC99,φ\r\n:?item.right = fire_talisman\r\n  ?item.right = ＂golden＂\r\n    >o1,1,#FFCC66,@lanterntalisman@\r\n  :?item.right = ＂+0＂\r\n    >o1,1,#white,@lanterntalisman@\r\n  :?item.right = ＂+1＂\r\n    >o1,1,#cyan,@lanterntalisman@\r\n  :?item.right = ＂+2＂ | item.right = ＂+3＂\r\n    >o1,1,#yellow,@lanterntalisman@\r\n  :?item.right = ＂+4＂ | item.right = ＂+5＂ |\r\n  ^item.right = ＂+6＂\r\n    >o1,1,#green,@lanterntalisman@\r\n  :?item.right = ＂+7＂ | item.right = ＂+8＂ |\r\n  ^item.right = ＂+9＂ | item.right = ＂+10＂\r\n    >o1,1,#blue,@lanterntalisman@\r\n  :?item.right = ＂+11＂ | item.right = ＂+12＂ |\r\n  ^item.right = ＂+13＂ | item.right = ＂+14＂ |\r\n  ^item.right = ＂+15＂\r\n    >o1,1,#red,@lanterntalisman@\r\n  :\r\n    >o1,1,#rainFF,@lanterntalisman@\r\n  ?item.right.state ! 1\r\n    >o2,2,#FFCC99,φ"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/LegsTurkeyPet.txt" - Parse error: Failed to parse completely. Remaining: "=    #774014\r\nvar color_hlights = #996236\r\nvar color_beak =    #CF933E\r\nvar color_legs =    #BE822D\r\nvar color_eye =     #AAAAAA\r\nvar color_eyelid =  #996236\r\nvar color_hat =     #552009\r\nvar color_cool =    #rainDD\r\n\r\n//player tracking variables\r\nvar prevPosX\r\nvar prevPosY\r\n\r\nvar plr_min_dist = 20       //stands still if within this distance from you\r\nvar plr_min_dist_boss = 28  //stands still if within this distance from you, while fighting a boss\r\n\r\n//animation variables\r\nvar frm_std_count = 4       // num frames for stand up animation\r\nvar frm_sit_count = 4       // num frames for sit animation\r\nvar frm_L_count = 15        // num frames for left leg walk animation\r\nvar frm_R_count = 15        // num frames for right leg walk animation\r\n\r\nvar frm                     // frame counter\r\nvar frm_interval = 1        // ticks/frame (leave at 1 for best results)\r\nvar stand_time = 60         // num ticks turkey will stand still before sitting\r\n\r\nvar prevStepL               // alternate the leading step from standstill for variety\r\n\r\nvar open_time = 115         // num ticks eye is open\r\nvar blink_time = 5          // num ticks eye is closed\r\nvar blinking = false\r\nvar catching = false\r\n\r\n//position variables\r\nvar tx                      // turkey x,y\r\nvar ty\r\n\r\nvar lx                      // legs x,y\r\nvar ly\r\n\r\n//          --MAIN LOOP--\r\nUpdate()\r\nDraw(0, 0)\r\n\r\n//          --RESET LOGIC--\r\nfunc TryReset()\r\n  ?loc.begin | loc.loop\r\n    initialized = false\r\n  \r\n  :?time <= 2 & (loc ! rocky_plateau)\r\n    initialized = false\r\n    \r\n  ?!initialized\r\n    initialized = true\r\n    \r\n    prevPosX = pos.x\r\n    prevPosY = pos.z - pos.y\r\n    prevStepL = false\r\n    tx = -15\r\n    ty = 0\r\n    lx = tx+3\r\n    ly = ty+3\r\n    state = SITTING\r\n    frm = 0\r\n\r\n//          --MAIN UPDATE LOGIC--\r\nfunc Update()\r\n  TryReset()\r\n\r\n  ?time % frm_interval = 0\r\n    frm++\r\n\r\n    ?state = SITTING\r\n      state = NextState()\r\n      frm = 0\r\n    \r\n    :?state = STAND_UP\r\n      ?frm >= frm_std_count\r\n        state = NextState()\r\n        frm = 0\r\n        \r\n    :?state = STANDING\r\n      state = NextState()\r\n      ?frm >= stand_time\r\n        frm = 0\r\n      ?state ! STANDING\r\n        frm = 0\r\n    \r\n    :?state = WALK_L\r\n      ?frm >= frm_L_count\r\n        prevStepL = true\r\n        state = NextState()\r\n        frm = 0\r\n        lx = lx+6   //adjust leg position after walk cycle but before next draw\r\n\r\n    :?state = WALK_R\r\n      ?frm >= frm_R_count\r\n        prevStepL = false\r\n        state = NextState()\r\n        frm = 0\r\n        lx = lx+6   //adjust leg position after walk cycle but before next draw\r\n\r\n    :?state = SIT_DOWN\r\n      ?frm >= frm_sit_count\r\n        state = NextState()\r\n        frm = 0\r\n    \r\n    :\r\n      state = NextState()\r\n      frm = 0\r\n    \r\n    Move()\r\n  \r\n  //update twice per tick if turkey gets too far behind\r\n  ?!catching & -tx > (screen.w/2 - 10)\r\n    catching = true\r\n    Update()\r\n  :\r\n    catching = false\r\n\r\n//          --NEXT STATE LOGIC--\r\nfunc NextState()\r\n  ?state = SITTING\r\n    ?NearPlayer()\r\n      return SITTING\r\n    :\r\n      return STAND_UP\r\n    \r\n  :?state = STAND_UP\r\n    return STANDING\r\n      \r\n  :?state = STANDING\r\n    ?NearPlayer()\r\n      ?frm >= stand_time\r\n        return SIT_DOWN\r\n      :\r\n        return STANDING\r\n    :?prevStepL\r\n      return WALK_R\r\n    :\r\n      return WALK_L\r\n    \r\n  :?state = WALK_L\r\n    ?NearPlayer()\r\n      return STANDING\r\n    :\r\n      return WALK_R\r\n    \r\n  :?state = WALK_R\r\n    ?NearPlayer()\r\n      return STANDING\r\n    :\r\n      return WALK_L\r\n    \r\n  :?state = SIT_DOWN\r\n    return SITTING\r\n  \r\n  :\r\n    return SITTING\r\n\r\n//          --MOVEMENT LOGIC--\r\nfunc Move()\r\n  //animation movements\r\n  ?state = STAND_UP\r\n    //move up\r\n    ?frm = 0 | frm = 1\r\n      ty = ty-1\r\n      ly = ty+3\r\n    :?frm = 2 | frm = 3\r\n      ty = ty-2\r\n      ly = ty+3\r\n    \r\n  :?state = STANDING\r\n    //register legs to body\r\n    lx = tx+3\r\n    ly = ty+3\r\n    \r\n  :?state = WALK_L\r\n    //move forward with legs\r\n    ?frm = 6 | frm = 12\r\n      tx = tx+1\r\n    :?frm = 7 | frm = 8\r\n      tx = tx+2\r\n    \r\n    //track character on large vertical movements\r\n    ?frm = 14\r\n      ?ty < -4\r\n        ty++\r\n        ly++\r\n      :?ty > 4\r\n        ty--\r\n        ly--\r\n  \r\n  :?state = WALK_R\r\n    //move forward with legs\r\n    ?frm = 3 | frm = 6 | frm = 8 | frm = 11\r\n      tx = tx+1\r\n    :?frm = 7\r\n      tx = tx+2\r\n    \r\n    //track character on large vertical movements\r\n    ?frm = 14\r\n      ?ty < -4\r\n        ty++\r\n        ly++\r\n      :?ty > 4\r\n        ty--\r\n        ly--\r\n      \r\n  :?state = SIT_DOWN\r\n    //move down\r\n    ?frm = 0 | frm = 1\r\n      ty = ty+2\r\n      ly = ty+3\r\n    :?frm = 2 | frm = 3\r\n      ty = ty+1\r\n      ly = ty+3\r\n  \r\n  //extra rubberbanding if turkey gets really far behind\r\n  ?-tx > screen.w/2\r\n    var rb = (rng%2) + 1\r\n    tx = tx + rb\r\n    lx = lx + rb\r\n  \r\n  //adjust for player movement\r\n  tx = tx - (pos.x - prevPosX)\r\n  lx = lx - (pos.x - prevPosX)\r\n  \r\n  ty = ty - (pos.z - pos.y - prevPosY)\r\n  ly = ly - (pos.z - pos.y - prevPosY)\r\n  \r\n  prevPosX = pos.x\r\n  prevPosY = pos.z - pos.y\r\n\r\n//          --DRAW LOGIC--\r\nfunc Draw(dx, dy)\r\n  //determine draw position\r\n  var dtx = tx+dx\r\n  var dlx = lx+dx\r\n  var dty = ty+dy\r\n  var dly = ly+dy\r\n  \r\n  //cull if out of range\r\n  ?dtx < -screen.w\r\n    return\r\n  \r\n  //legs\r\n  ?state = STAND_UP\r\n    ?frm = 0\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n<<\r\nasciiend\r\n    :?frm = 1\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n||\r\n<<\r\nasciiend\r\n    :?frm = 2\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n||\r\n||\r\n||\r\n<<\r\nasciiend\r\n    :?frm = 3\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n||\r\n||\r\n||\r\n||\r\n||\r\n<<\r\nasciiend\r\n\r\n  :?state = STANDING\r\n    >o@dlx@,@dly@,@color_legs@,ascii\r\n||\r\n||\r\n||\r\n||\r\n||\r\n<<\r\nasciiend\r\n\r\n  :?state = WALK_L\r\n    ?frm = 0\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n||\r\n||\r\n||\r\n||\r\n||\r\n<<\r\nasciiend\r\n    :?frm = 1\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n||\r\n||\r\n:|\r\n#\\\r\n#|\\\r\n#<<\r\nasciiend\r\n    :?frm = 2\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n:|\r\n#\\\r\n#|\\\r\n#|#\\\r\n#|##<\r\n#<###\r\nasciiend\r\n    :?(3 <= frm) & (frm <= 5)\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n#\\\r\n#|\\\r\n#|#\\\r\n#|##\\\r\n#|###\\\r\n#<####<\r\nasciiend\r\n    :?frm = 6\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n#\\´\r\n#|\\\r\n#|#\\\r\n#|##\\\r\n#|###\\\r\n#<####<\r\nasciiend\r\n    :?frm = 7\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n###\\´\r\n##/#\\\r\n#;###\\\r\n#|####:\r\n#|####|\r\n#<####<\r\nasciiend\r\n    :?(8 <= frm) & (frm <= 10)\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n#####\\´\r\n####/#:\r\n###/##|\r\n##/###|\r\n#/####|\r\n#<####<\r\nasciiend\r\n    :?frm = 11\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n#####\\;\r\n#####/:\r\n####/#|\r\n###/##|\r\n##<###|\r\n######<\r\nasciiend\r\n    :?frm = 12\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n######||\r\n######|;\r\n######|\r\n#####/|\r\n####<#|\r\n######<\r\nasciiend\r\n    :?frm = 13\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n######||\r\n######||\r\n######||\r\n######|;\r\n######|\r\n######<\r\nasciiend\r\n    :?frm = 14\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n######||\r\n######||\r\n######||\r\n######||\r\n######||\r\n######<<\r\nasciiend\r\n\r\n  :?state = WALK_R\r\n    ?frm = 0\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n||\r\n||\r\n||\r\n|:\r\n|#\\\r\n<#<\r\nasciiend\r\n    :?frm = 1\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n||\r\n|:\r\n|\\\r\n|#\\\r\n|##<\r\n<####\r\nasciiend\r\n    :?frm = 2\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n|\\\r\n|#\\\r\n|##\\\r\n|###\\\r\n|####<\r\n<######\r\nasciiend\r\n    :?(3 <= frm) & (frm <= 5)\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n|#\\\r\n|##\\\r\n|###\\\r\n|####\\\r\n|#####\\\r\n<######<\r\nasciiend\r\n    :?frm = 6\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n#;#\\\r\n/###\\\r\n|####\\\r\n|#####\\\r\n|######:\r\n<######<\r\nasciiend\r\n    :?frm = 7\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n###;#\\\r\n##/###\\\r\n#/#####:\r\n/######|\r\n|######|\r\n<######<\r\nasciiend\r\n    :?(8 <= frm) & (frm <= 10)\r\n      ?frm = 14\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n####/##\\\r\n###/###|\r\n##/####|\r\n#/#####|\r\n/######|\r\n<######<\r\nasciiend\r\n    :?frm = 11\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n#####/#|\r\n####/##|\r\n###/###|\r\n##/####|\r\n#<#####|\r\n#######<\r\nasciiend\r\n    :?frm = 12\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n######||\r\n######;|\r\n#####/#|\r\n####/##|\r\n###<###|\r\n#######<\r\nasciiend\r\n    :?frm = 13\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n######||\r\n######||\r\n######||\r\n######;|\r\n#####/#|\r\n#####<#<\r\nasciiend\r\n    :?frm = 14\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n######||\r\n######||\r\n######||\r\n######||\r\n######||\r\n######<<\r\nasciiend\r\n\r\n  :?state = SIT_DOWN\r\n    ?frm = 0\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n||\r\n||\r\n||\r\n<<\r\nasciiend\r\n    :?frm = 1\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n||\r\n<<\r\nasciiend\r\n    :?frm = 2\r\n      >o@dlx@,@dly@,@color_legs@,ascii\r\n<<\r\nasciiend\r\n\r\n  //body\r\n  >o@dtx@,@dty@,@color_body@,ascii\r\n#_###_\r\n( `.;\r\n#•  _)\r\nasciiend\r\n\r\n  //highlights\r\n  >o@dtx@,@dty@,@color_hlights@,ascii\r\n#\r\n#≈\r\n##,;#)\r\n##´\r\nasciiend\r\n\r\n  //hat\r\n  >o@dtx@,@dty@,@color_hat@,ascii\r\n####_◘_\r\nasciiend\r\n\r\n  //beak\r\n  >o@dtx@,@dty@,@color_beak@,ascii\r\n#\r\n######≥\r\nasciiend\r\n\r\n  //eye\r\n  ?blinking\r\n    ?time % blink_time = 0\r\n      blinking = false\r\n\r\n    >o@dtx@,@dty@,@color_eyelid@,ascii\r\n#\r\n#####¯\r\nasciiend\r\n  :\r\n    ?time % open_time = 0\r\n      blinking = true\r\n\r\n    >o@dtx@,@dty@,@color_eye@,ascii\r\n#\r\n#####°\r\nasciiend\r\n\r\n  //cool sunglasses\r\n  ?cool\r\n    >o@dtx@,@dty@,@color_cool@,ascii\r\n#\r\n####⌐▼\r\nasciiend\r\n\r\n//          --NEAR PLAYER LOGIC--\r\nfunc NearPlayer()\r\n  ?foe = boss\r\n    ?foe = bronze_guardian\r\n      return (-tx < plr_min_dist_boss) | (foe.distance < 15)\r\n    :\r\n      return -tx < plr_min_dist_boss\r\n  :\r\n    return -tx < plr_min_dist\r\n\r\n//          --UPDATE 'COOL' STATUS--\r\nfunc SetCool(c)\r\n  cool = c\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Acrocorn.txt" - Parse error: Failed to parse completely. Remaining: ":\r\nasciiend\r\n\r\n?mount = 1 &\r\n^time % 20 = 15 &\r\n^ai.walking\r\n play crossbow_hit 55\r\n\r\n?mount = 1 &\r\n^time % 20 = 20 &\r\n^ai.walking\r\n play crossbow_hit 55\r\n\r\n?mount = 1\r\n >o-9,-1,#white,ascii\r\n######O\r\n#####/|\\\r\n##(‾)¯7, )\r\nasciiend\r\n\r\n?mount = 1 &\r\n^bighead\r\n >o-5,-3,#white,ascii\r\n#.-.\r\n( '')\r\n#`.´\r\nasciiend\r\n\r\n?mount = 1 &\r\n^item.left = triskelion &\r\n^ai.walking |\r\n^mount = 1 &\r\n^item.right = triskelion &\r\n^ai.walking\r\n >o-12,1,#white,ascii\r\n—===;\r\nasciiend\r\n:?mount = 1 &\r\n^item.left ! triskelion |\r\n^mount = 1 &\r\n^item.right ! triskelion\r\n >o-11,1,#white,ascii\r\n##,;\r\n#//\r\n#'\r\nasciiend\r\n\r\n?!ai.walking &\r\n^mount = 1\r\n >o-9,2,#white,ascii\r\n##||###//\r\n##|,###\\,\r\nasciiend\r\n\r\n?ai.walking &\r\n^mount = 1 &\r\n^time % 20 < 5\r\n >o-9,2,#white,ascii\r\n##//###//\r\n##\\,###\\,\r\nasciiend\r\n\r\n?ai.walking &\r\n^mount = 1 &\r\n^time % 20 < 10 &\r\n^time % 20 > 5\r\n >o-9,2,#white,ascii\r\n##//####|/'\r\n##\\,####´\r\nasciiend\r\n\r\n?ai.walking &\r\n^mount = 1 &\r\n^time % 20 < 15 &\r\n^time % 20 > 10\r\n >o-9,2,#white,ascii\r\n##|/'####\\\\\r\n##´#######\\,\r\nasciiend\r\n\r\n?ai.walking &\r\n^mount = 1 &\r\n^time % 20 <= 20 &\r\n^time % 20 > 15\r\n >o-9,2,#white,ascii\r\n##\\\\###||\r\n###\\,##|,\r\nasciiend\r\n\r\n?mount = 1 &\r\n^item.right.state ! 3\r\n >o-2,-1,#white,ascii\r\n##,--._\r\n#/ /\\|\r\n#####´\r\nasciiend\r\n\r\n?mount = 1 &\r\n^item.right.state = 3 &\r\n^item.right.time <= 4\r\n >o-2,-2,#white,ascii\r\n###.|`-.\r\n##/ ,—`#'\r\n#/ /##\r\n#####\r\nasciiend\r\n\r\n?mount = 1 &\r\n^item.right.state = 3 &\r\n^item.right.time > 4\r\n >o-2,-2,#white,ascii\r\n###.|_\r\n##/ ,—`\r\n#/ /##\r\n#####\r\nasciiend\r\n\r\n?mount = 1 &\r\n^item.left.state = 2 &\r\n^item.right.state ! 3\r\n play wand_aether_cast 100\r\n >o4,-1,#green,ascii\r\n_*\r\nasciiend\r\n\r\n?mount = 1 &\r\n^item.left.state = 3 &\r\n^item.right.state ! 3\r\n >o4,-2,#green,ascii\r\n##_\r\n_(_)\r\nasciiend\r\n\r\n?mount = 1 &\r\n^item.left.state = 4 &\r\n^item.right.state ! 3\r\n >o4,-1,#green,ascii\r\n_\r\nasciiend\r\n\r\n?mount = 1 &\r\n^item.left.state = 2 &\r\n^item.right.state = 3\r\n play wand_aether_cast 100\r\n >o2,-3,#green,ascii\r\n*\r\n|\r\nasciiend\r\n\r\n?mount = 1 &\r\n^item.left.state = 3 &\r\n^item.right.state = 3\r\n >o1,-4,#green,ascii\r\n#_\r\n(_)\r\n#|\r\nasciiend\r\n\r\n?mount = 1 &\r\n^item.left.state = 4 &\r\n^item.right.state = 3\r\n >o2,-3,#green,ascii\r\n☤\r\n|\r\nasciiend\r\n\r\n?mount = 1 &\r\n^item.left.state = 3\r\n play wand_aether_hit 100\r\n >f-1,-1,#green,ascii\r\n#_\r\n(_)\r\nasciiend\r\n\r\n?mount = 1 &\r\n^item.left.state = 4\r\n >f0,0,#green,ascii\r\nO\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Drill.txt" - Parse error: Failed to parse completely. Remaining: "［O］>:\r\nasciiend\r\n\r\n?mount = 5\r\n >o0,0,#yellow,ascii\r\n≈~.\r\n=-~\\\r\n≈~-/\r\n=-'\r\nasciiend\r\n\r\n?mount = 5 &\r\n^item.right.state > 1 &\r\n^time % 2 = 1\r\n play scorpion_death 35\r\n >o0,0,#yellow,ascii\r\n=-,\r\n≈~-)\r\n=-~)\r\n≈~＂\r\nasciiend\r\n\r\n?mount = 5\r\n >o-14,-2,#white,ascii\r\n##########o\r\n#/‾\\#####/|\\\r\n´##|‾‾‾‾‾‾‾‾‾|\r\n###|: |‾|   :|\r\n###|:  ‾    :|\r\n###|_________|\r\nasciiend\r\n\r\n?mount = 5 &\r\n^item.right.state = 1 &\r\n^item.right.time >= 5\r\n >o-2,-1,#yellow,ascii\r\nT\r\nasciiend\r\n:?mount = 5 &\r\n^item.right.state > 1 |\r\n^mount = 5 &\r\n^item.right.state = 1 &\r\n^item.right.time < 5\r\n >o-2,-1,#yellow,ascii\r\n_\r\nasciiend\r\n\r\n?mount = 5 &\r\n^foe = boss &\r\n^time % 30 <= 15\r\n >o-5,-1,#white,ascii\r\nv|v\r\nasciiend\r\n\r\n?mount = 5 &\r\n^foe = boss &\r\n^time % 30 > 15\r\n >o-5,-2,#white,ascii\r\n\\o/\r\n | \r\nasciiend\r\n\r\n?mount = 5 &\r\n^hp < foe.damage * 2 &\r\n^foe ! boss |\r\n^mount = 5 &\r\n^hp < foe.damage\r\n >o-5,-2,#white,ascii\r\n <o>\r\n ( \r\nasciiend\r\n\r\n?mount = 5 &\r\n^hp < foe.damage * 2 &\r\n^time % 8 <= 4 &\r\n^foe ! boss |\r\n^mount = 5 &\r\n^time % 8 <= 4 &\r\n^hp < foe.damage\r\n >o-1,-3,#red,ascii\r\n!\r\nasciiend\r\n\r\n?mount = 5 &\r\n^item.left.id = vigor\r\n >o-9,1,#red,ascii\r\n♥\r\nasciiend\r\n\r\n?mount = 5 &\r\n^item.left.id = poison\r\n >o-9,1,#green,ascii\r\n∞\r\nasciiend\r\n\r\n?mount = 5 &\r\n^item.left.id = ice\r\n >o-9,1,#cyan,ascii\r\n❄\r\nasciiend\r\n\r\n?mount = 5 &\r\n^item.left.id = fire\r\n >o-9,1,#yellow,ascii\r\nφ\r\nasciiend\r\n\r\n?mount = 5 &\r\n^item.left.id = aether\r\n >o-9,1,#magenta,ascii\r\n*\r\nasciiend\r\n\r\n?mount = 5 &\r\n^item.left.id = stone |\r\n^mount = 5 &\r\n^item.left.id ! socketed\r\n >o-9,1,#white,ascii\r\no\r\nasciiend\r\n\r\n?mount = 5 &\r\n^＂ ＂ = item.left\r\n >o-9,1,#blue,ascii\r\n@\r\nasciiend\r\n\r\n?mount = 5 &\r\n^item.right.id = vigor\r\n >o-5,1,#red,ascii\r\n♥\r\nasciiend\r\n\r\n?mount = 5 &\r\n^item.right.id = poison\r\n >o-5,1,#green,ascii\r\n∞\r\nasciiend\r\n\r\n?mount = 5 &\r\n^item.right.id = ice\r\n >o-5,1,#cyan,ascii\r\n❄\r\nasciiend\r\n\r\n?mount = 5 &\r\n^item.right.id = fire\r\n >o-5,1,#yellow,ascii\r\nφ\r\nasciiend\r\n\r\n?mount = 5 &\r\n^item.right.id = aether\r\n >o-5,1,#magenta,ascii\r\n*\r\nasciiend\r\n\r\n?mount = 5 &\r\n^item.right.id = stone |\r\n^mount = 5 &\r\n^item.right.id ! socketed\r\n >o-5,1,#white,ascii\r\no\r\nasciiend\r\n\r\n?mount = 5 &\r\n^＂ ＂ = item.right\r\n >o-5,1,#blue,ascii\r\n@\r\nasciiend\r\n\r\n?mount = 5\r\n >o-12,3,#B3B3B3,ascii\r\n/‾‾‾‾‾‾‾‾‾‾‾\\\r\n\\___________/\r\nasciiend\r\n\r\n?mount = 5 &\r\n^!ai.walking |\r\n^mount = 5 &\r\n^ai.walking &\r\n^time % 40 <= 20\r\n >o-12,3,#8C8C8C,ascii\r\n#‾#‾#‾#‾#‾#‾#\r\n\\#_#_#_#_#_#/\r\nasciiend\r\n\r\n?mount = 5 &\r\n^ai.walking &\r\n^time % 40 > 20\r\n >o-12,3,#8C8C8C,ascii\r\n/#‾#‾#‾#‾#‾#\\\r\n#_#_#_#_#_#_#\r\nasciiend\r\n\r\n?mount = 5 &\r\n^ai.walking &\r\n^loc ! icy ridge\r\n play mine_walker_attack_hit 115\r\n\r\n?mount = 5 &\r\n^ai.walking &\r\n^loc = icy ridge\r\n play ki_slerper_walk 100\r\n\r\n?mount = 5 &\r\n^item.left.state < 3 &\r\n^foe.distance <= 10\r\n >o-9,2,#yellow,ascii\r\n#//_\r\n#|__=—\r\nasciiend\r\n\r\n?mount = 5 &\r\n^item.left.state > 2 &\r\n^item.left.time < 5\r\n >o-9,2,#yellow,ascii\r\n,´≤\r\n|__=—\r\nasciiend\r\n\r\n?mount = 5 &\r\n^item.left.state > 2 &\r\n^item.left.time < 1\r\n play bomb_cart_explosion 100\r\n >o-5,2,#yellow,ascii\r\n#_\r\n(_)\r\nasciiend\r\n\r\n?mount = 5 &\r\n^item.left.state > 2 &\r\n^item.left.time = 2\r\n >o-4,3,#yellow,ascii\r\nO\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetBunny.txt" - Parse error: Failed to parse completely. Remaining: "= #white\r\n\r\nvar keepDistance = -20\r\nvar maxX = -12\r\n\r\nvar maxDistance\r\nmaxDistance = -80\r\n\r\nvar targetZ = -1\r\n\r\nvar x = 0\r\nvar y = 0\r\nvar myX = 0\r\nvar myZ = 0\r\nvar lastPlayerX = 0\r\nvar lastPlayerZ = 0\r\n\r\nvar stateNone = 0\r\nvar stateIdle = 1\r\nvar stateJump = 2\r\nvar currentState = stateNone\r\nvar stateTime = 0\r\n\r\n\r\nfunc SetState(newState)\r\n  ?newState = stateJump\r\n    play open_note 400\r\n\r\n  currentState = newState\r\n  stateTime = 0\r\n\r\n\r\n?currentState = stateNone | time = 1\r\n  lastPlayerX = pos.x\r\n  lastPlayerZ = pos.z\r\n  myX = keepDistance\r\n  myZ = targetZ\r\n\r\n \r\n  ?time > 1\r\n    myX = maxDistance\r\n\r\n  SetState(stateIdle)\r\n\r\n\r\nmyX = myX - (pos.x - lastPlayerX)\r\n\r\nstateTime++\r\n\r\n?currentState = stateIdle\r\n  ?myX < maxDistance | myX > -maxDistance\r\n    myX = maxDistance\r\n  myZ = myZ - (pos.z - lastPlayerZ)\r\n\r\n  ?myX < keepDistance\r\n    SetState(stateJump)\r\n\r\n:?currentState = stateJump\r\n  ?myX < maxX\r\n    myX++\r\n\r\n  ?stateTime >= 9\r\n    ?myZ > targetZ\r\n      myZ--\r\n    :?myZ < targetZ\r\n      myZ++\r\n\r\n  ?stateTime >= 16\r\n    SetState(stateIdle)\r\n\r\n\r\nlastPlayerX = pos.x\r\nlastPlayerZ = pos.z\r\n\r\n// Draw\r\n\r\n?currentState = stateIdle\r\n  >o@myX@,@myZ@,@rabbitColor@,ascii\r\n#\r\n#\r\n######\\\\\r\n#####__()\r\n###α(_-\\\r\nasciiend\r\n\r\n  ?face = ＂°°＂\r\n    ?time % 4 <= 1\r\n      >o@myX@,@myZ@,@rabbitColor@,ascii\r\n#\r\n#\r\n###### ||\r\nasciiend\r\n    ?time % 4 > 1\r\n      >o@myX@,@myZ@,@rabbitColor@,ascii\r\n#\r\n#\r\n###### ((\r\nasciiend\r\n  \r\n?currentState = stateJump\r\n  ?stateTime/2 = 0\r\n    >o@myX@,@myZ@,@rabbitColor@,ascii\r\n#\r\n#\r\n#\r\n#####_\\\\\r\n###α(_.()\r\nasciiend\r\n\r\n  :?stateTime/2 = 1\r\n    >o@myX@,@myZ@,@rabbitColor@,ascii\r\n#\r\n#\r\n#######_\r\n#####_‾()\r\n###α(_-/\r\nasciiend\r\n\r\n  :?stateTime/2 = 2\r\n    >o@myX@,@myZ@,@rabbitColor@,ascii\r\n#######_\r\n######‾()\r\n#####/´)\r\n###α(_\r\nasciiend\r\n\r\n  :?stateTime/2 = 3\r\n    >o@myX@,@myZ@,@rabbitColor@,ascii\r\n######\\\\\r\n#####__()\r\n###α( -\\\r\n#####)\r\nasciiend\r\n\r\n  :?stateTime/2 = 4\r\n    >o@myX@,@myZ@,@rabbitColor@,ascii\r\n######((\r\n#####__()\r\n###α(_-‾'\r\n#####\r\nasciiend\r\n\r\n  :?stateTime/2 = 5\r\n    >o@myX@,@myZ@,@rabbitColor@,ascii\r\n#\r\n#\r\n#####__((\r\n###α(_-.()\r\n########‾'\r\nasciiend\r\n\r\n  :?stateTime/2 = 6\r\n    >o@myX@,@myZ@,@rabbitColor@,ascii\r\n#\r\n#\r\n#####_\r\n###α( \\\\\r\n#####\\.()\r\nasciiend\r\n\r\n  :?stateTime/2 = 7\r\n    >o@myX@,@myZ@,@rabbitColor@,ascii\r\n#\r\n#\r\n#\r\n####_\\\\\r\n##α(_.()\r\nasciiend\r\n\r\n  :?stateTime/2 = 8\r\n    >o@myX@,@myZ@,@rabbitColor@,ascii\r\n#\r\n#\r\n#######_\r\n#####_‾()\r\n###α(_-(\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetStonehead.txt" - Parse error: Failed to parse completely. Remaining: "?(StoneheadPetFrame = 1 | !ai.walking)\r\n ^& !StoneheadRunAway = true & DisableStonehead\r\n ^=false \r\n   StoneheadPet = ascii\r\n#####,\r\n####/-\r\n#o_/##\r\n#|‾###\r\n/#\\###\r\nasciiend\r\n:?StoneheadPetFrame = 2 & !StoneheadRunAway\r\n^ = true & DisableStonehead =false\r\n StoneheadPet = ascii\r\n#####,\r\n####/-\r\n#o_/##\r\n#|‾###\r\n#>\\###\r\nasciiend\r\n:?StoneheadPetFrame = 3 & !StoneheadRunAway \r\n^=true & DisableStonehead =false\r\n StoneheadPet = ascii\r\n#####,\r\n####/-\r\n#o_/##\r\n#|‾###\r\n#|>###\r\nasciiend \r\n:?StoneheadPetFrame = 4 & !StoneheadRunAway\r\n^=true \r\n StoneheadPet = ascii\r\n#####,\r\n####/-\r\n#o_/##\r\n#|‾###\r\n#|\\###\r\nasciiend \r\n?foe = phase & foe.distance < 25 & ai.enabled\r\n ?time % 2 = 0 & StoneheadPetX < 101\r\n \r\n  StoneheadPetX++\r\n  StoneheadRunAway = true\r\n  ?StoneheadPetFrame = 1 & StoneheadRunAway \r\n  ^=true & DisableStonehead =false\r\n   StoneheadPet = ascii\r\n############\r\n#AAAAAHHHHHH\r\n####\\o/#####\r\n#####|######\r\n####/#\\#####\r\nasciiend\r\n :?StoneheadPetFrame = 2 & StoneheadRunAway \r\n  ^=true & DisableStonehead =false\r\n\r\n   StoneheadPet = ascii\r\n############\r\n#AAAAAHHHHHH\r\n####\\o/#####\r\n#####|######\r\n####/<######\r\nasciiend\r\n :?StoneheadPetFrame = 3 & StoneheadRunAway \r\n  ^=true & DisableStonehead =false\r\n\r\n  StoneheadPet = ascii\r\n############\r\n#AAAAAHHHHHH\r\n####\\o/#####\r\n#####|######\r\n####<|######\r\nasciiend\r\n :?StoneheadPetFrame = 4 & StoneheadRunAway \r\n  ^=true & DisableStonehead =false \r\n\r\n   StoneheadPet = ascii\r\n############\r\n#AAAAAHHHHHH\r\n####\\o/#####\r\n#####|######\r\n####/|######\r\nasciiend\r\n?StoneheadPetX > 100\r\n  DisableStonehead = true\r\n\r\n>o-@StoneheadPetX@,@StoneheadPetY@,@StoneheadPet@\r\n//—————END—————//"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/CaveParty.txt" - Parse error: Failed to parse completely. Remaining: "= \"false\"\r\nvar charToPrint = \"#\"\r\n\r\nvar dialogueState = 0\r\nvar isBetweenDialogue = \"false\"\r\nvar betweenTimer = 0\r\nvar whoAmITalkingTo = \"myself\"\r\nvar UIList = []\r\nvar BoxList = []\r\nvar NonTriggerList = []\r\nfunc MakeUIAnim(x,y,art,color,length,loop,playInstantly,visibleAtStart,listToAdd,draggable)\r\n  var animation\r\n  animation = ui.AddAnim(art)\r\n  animation.x = x\r\n  animation.y = y\r\n  animation.color = color\r\n  animation.loop = loop\r\n  animation.duration = length\r\n  ?playInstantly = true\r\n   animation.Play()\r\n  ?visibleAtStart = false\r\n   animation.visible = false\r\n  ?listToAdd = \"triggers\"\r\n   UIList.Add(animation)\r\n  :?listToAdd = \"boxes\"\r\n   BoxList.Add(animation)\r\n  :?listToAdd = \"static\"\r\n   NonTriggerList.Add(animation)\r\n  ?art = speaker\r\n   animation.dock = \"top_left\"\r\n  return animation\r\n//Dialogue Handler function-------------------------------------------\r\nfunc HandleDialogue()\r\n ?whoAmITalkingTo = \"John\"\r\n  ?textTimer = 1\r\n   yapping.ShowText()\r\n   yapping.x = -6\r\n   yapping.y = 1\r\n   BoxList[0].x = -6\r\n   BoxList[0].y = 2\r\n   yapping.Reset()\r\n  ?dialogueState = 1 & textTimer < 42\r\n   BoxList[0].visible = true\r\n   yapping.FinishingText = \"The name's Backflip. John Backflip.\"\r\n  ?dialogueState = 1 & totaltime % 2 = 0 & textTimer < 42\r\n   yapping.Update()\r\n  ?textTimer = 42\r\n   yapping.Reset()\r\n   yapping.HideText()\r\n   BoxList[0].visible = false\r\n\r\n  ?textTimer = 47\r\n   UIList[0].Play()\r\n   yapping.HideText()\r\n  ?textTimer = 60\r\n   dialogueState = 2\r\n   yapping.width = 16\r\n   yapping.y = 2\r\n   yapping.x = -7\r\n   yapping.FinishingText = \"I am a master of the dark arts.\"\r\n   yapping.Reset()\r\n   yapping.ShowText()\r\n   BoxList[1].y = 2\r\n   BoxList[1].x = -7\r\n  ?dialogueState = 2 & totaltime % 2 = 0\r\n   yapping.Update()\r\n   BoxList[1].visible = true\r\n  ?textTimer > 90\r\n   dialogueState = 3\r\n   clickAnywhere = \"true\"\r\n ?whoAmITalkingTo = \"Sticky Stick\"\r\n  ?dialogueState = 1\r\n   BoxList[1].x = 19\r\n   BoxList[1].y = -2\r\n   yapping.x = 19\r\n   yapping.y = -2\r\n  ?textTimer = 1\r\n   yapping.Reset()\r\n   yapping.ShowText()\r\n  ?dialogueState = 1 & textTimer < 45\r\n   BoxList[1].visible = true\r\n   yapping.FinishingText = \"Yes! Yes! It's working!\"\r\n  ?dialogueState = 1 & totaltime % 2 = 0 & textTimer < 42\r\n   yapping.Update()\r\n  ?textTimer = 46\r\n   yapping.Reset()\r\n   yapping.HideText()\r\n   BoxList[1].visible = false\r\n  ?textTimer = 50\r\n   dialogueState = 2\r\n   yapping.width = 16\r\n   yapping.x = 19\r\n   yapping.y = -3\r\n   BoxList[0].visible = true\r\n   BoxList[0].x = 19\r\n   BoxList[0].y = -2\r\n   yapping.FinishingText = \"I will imbue my sticky stick with vast power!\"\r\n   yapping.Reset()\r\n  ?dialogueState = 2 & totaltime % 2 = 0\r\n   yapping.ShowText()\r\n   yapping.Update()\r\n  ?textTimer = 100\r\n   dialogueState = 3\r\n   yapping.FinishingText = \"And then, the world will fear my name!\"\r\n   yapping.Reset()\r\n  ?dialogueState = 3 & totaltime % 2 = 0\r\n   yapping.Update()\r\n  ?textTimer > 165\r\n   clickAnywhere = true\r\n   dialogueState = 4\r\n  ?textTimer = 170\r\n   BoxList[0].visible = false\r\n   yapping.HideText()\r\n ?whoAmITalkingTo = \"sorceress\"//---------------------------------------------sorceress dialogue\r\n  ?dialogueState = 1\r\n   BoxList[3].x = -2\r\n   BoxList[3].y = -11\r\n   yapping.x = -2\r\n   yapping.y = -11\r\n  ?textTimer = 1\r\n   yapping.Reset()\r\n   yapping.ShowText()\r\n  ?dialogueState = 1 & textTimer < 35\r\n   BoxList[3].visible = true\r\n   yapping.FinishingText = \"Greetings, young one.\"\r\n  ?dialogueState = 1 & totaltime % 2 = 0 & textTimer < 52\r\n   yapping.Update()\r\n  ?textTimer = 44\r\n   yapping.Reset()\r\n   yapping.HideText()\r\n   BoxList[3].visible = false\r\n  ?textTimer = 46\r\n   dialogueState = 2\r\n   BoxList[4].x = 3\r\n   BoxList[4].y = -9\r\n   BoxList[4].visible = true\r\n   yapping.y = -9\r\n   yapping.x = 4\r\n   yapping.width = 16\r\n   yapping.FinishingText = \"I sense great things in your future.\"\r\n   yapping.Reset()\r\n  ?dialogueState = 2 & totaltime % 2 = 0\r\n   yapping.ShowText()\r\n   yapping.Update()\r\n  ?textTimer = 100\r\n   dialogueState = 3\r\n   yapping.FinishingText = \"May you be fortunate in your travels.\"\r\n   yapping.Reset()\r\n  ?dialogueState = 3 & totaltime % 2 = 0\r\n   yapping.Update()\r\n  ?textTimer > 150\r\n   clickAnywhere = true\r\n   dialogueState = 4\r\n ?whoAmITalkingTo = \"annoying\"\r\n  ?dialogueState = 1\r\n   BoxList[2].x = 24\r\n   BoxList[2].y = -11\r\n   yapping.x = 24\r\n   yapping.y = -11\r\n   yapping.width = 17\r\n  ?textTimer = 1\r\n   yapping.Reset()\r\n   yapping.ShowText()\r\n  ?dialogueState = 1 & textTimer < 30\r\n   BoxList[2].visible = true\r\n   yapping.FinishingText = \"Damn, she's hot\"\r\n  ?dialogueState = 1 & totaltime % 2 = 0 & textTimer < 29\r\n   yapping.Update()\r\n  ?textTimer = 35\r\n   yapping.FinishingText = \"Smash 100%\"\r\n   yapping.Reset()\r\n   dialogueState = 2\r\n  ?dialogueState = 2 & totaltime % 2 = 0\r\n   yapping.ShowText()\r\n   yapping.Update()\r\n  ?textTimer = 70\r\n   dialogueState = 3\r\n   yapping.HideText()\r\n   yapping.Reset()\r\n   BoxList[2].visible = false\r\n   NonTriggerList[5].frame = 1\r\n   NonTriggerList[6].Play()\r\n   NonTriggerList[6].visible = true\r\n  ?textTimer = 100\r\n   NonTriggerList[7].visible = true\r\n   NonTriggerList[7].Play()\r\n   NonTriggerList[6].visible = false\r\n   UIList[3].Play()   \r\n  ?textTimer = 110\r\n   play bomb_cart_explosion\r\n  ?textTimer = 120\r\n   UIList[3].color = #bbbbbb\r\n   UIList[3].x = UIList[3].x + 1\r\n   NonTriggerList[5].frame = 0\r\n  ?textTimer = 122\r\n   UIList[3].x = UIList[3].x + 1\r\n  ?textTimer = 125\r\n   UIList[3].visible = false\r\n?loc = waterfall\r\n ?totaltime = 1\r\n  //Function thing:art,color,duration,loop,play,visible,list,draggable\r\n  MakeUIAnim(0,5,Backflip,#a1f0fc,26,false,false,true,triggers,nah)\r\n  MakeUIAnim(-9,-7,sorceress,#white,1,false,false,true,triggers,nah)\r\n  MakeUIAnim(22,6,ladder,#bbbbbb,1,false,false,true,static,nah)\r\n  MakeUIAnim(26,2,stickyStickGuy,#white,90,true,true,true,triggers,nah)\r\n  MakeUIAnim(-12,-9,magicStaff,#magenta,20,true,true,true,static,nah)\r\n   \r\n  MakeUIAnim(51,20,speaker,#white,1,false,false,true,static,nah)\r\n  MakeUIAnim(13,-5,lavaPool,#aaaaaa,1,false,false,true,static,nah)\r\n  MakeUIAnim(11,-6,lavaAnim,#bababa,40,true,true,true,static,yeah)\r\n  MakeUIAnim(13,-9,uulaaIdle,#white,1,false,false,true,static,nah)\r\n  MakeUIAnim(17,-8,fireChargeUp,#FF7312,48,true,false,false,static,nah)\r\n  MakeUIAnim(37,-8,annoyingGuy,#white,32,false,false,true,triggers,nah)\r\n  MakeUIAnim(28,-12,fireBlast,#FF7312,24,false,false,false,static,nah)\r\n  MakeUIAnim(-10,1,cake,#FFFFBD,1,false,false,true,static,nah)\r\n  MakeUIAnim(-10,1,sprinkles,#cyan,1,false,false,true,static,nah)\r\n  MakeUIAnim(-9,4,table,#bbbbbb,1,false,false,true,static,nah)\r\n  MakeUIAnim(13,7,musicNotes,#white,168,true,true,true,static,nah)\r\n  MakeUIAnim(-6,2,speechBox,#aaaaaa,1,false,false,false,boxes,nah)\r\n  MakeUIAnim(-7,2,speechBoxShort,#aaaaaa,1,false,false,false,boxes,nah)\r\n  MakeUIAnim(24,-11,speechBoxTiny,#aaaaaa,1,false,false,false,boxes,nah)\r\n  MakeUIAnim(24,-11,speechBoxShortFlipped,#aaaaaa,1,false,false,false,boxes,nah)\r\n  MakeUIAnim(24,-11,speechBoxSide,#aaaaaa,1,false,false,false,boxes,nah)\r\n  NonTriggerList[11].flipX = true\r\n ?totaltime > 2\r\n  CheckForDialogueTrigger()\r\n var isDialogueActive = \"false\"\r\n var textTimer = 0\r\n ?totaltime % 2 = 0 & isDialogueActive = \"true\" & whoAmITalkingTo ! \"myself\" \r\n  textTimer++\r\nfunc CheckForDialogueTrigger()\r\n charToPrint = \"#\"\r\n for i = 0..UIList.Count()-1\r\n   ?(input.x >= UIList[i].absoluteX & input.x <= UIList[i].w + UIList[i].absoluteX\r\n   ^&input.y >= UIList[i].absoluteY & input.y <= UIList[i].h + UIList[i].absoluteY)\r\n   ^|clickAnywhere = \"true\"\r\n    charToPrint = \"…\"\r\n    ?key = Begin\r\n      ?i = 0 //For John\r\n       ?whoAmITalkingTo = \"myself\"\r\n        whoAmITalkingTo = \"John\"\r\n\t    isDialogueActive = \"true\"\r\n       ?dialogueState < 2\r\n        dialogueState = 1\r\n       ?dialogueState = 3\r\n        dialogueState = 0\r\n        whoAmITalkingTo = \"myself\"\r\n        yapping.HideText()\r\n        yapping.Reset()\r\n        BoxList[1].visible = false\r\n        clickAnywhere = \"false\"\r\n        textTimer = 0\r\n      ?i = 1 // for the sorceress\r\n       ?whoAmITalkingTo = \"myself\"\r\n        whoAmITalkingTo = \"sorceress\"\r\n        isDialogueActive = \"true\"\r\n       ?dialogueState < 2\r\n         dialogueState = 1\r\n       ?dialogueState = 4\r\n         dialogueState = 0\r\n         whoAmITalkingTo = myself\r\n         yapping.HideText()\r\n         yapping.Reset()\r\n         BoxList[4].visible = false\r\n         clickAnywhere = \"false\"\r\n         textTimer = 0 \r\n      ?i = 2 //for sticky stick guy\r\n       ?whoAmITalkingTo = \"myself\"\r\n        whoAmITalkingTo = \"Sticky Stick\"\r\n        isDialogueActive = \"true\"\r\n       ?dialogueState < 2\r\n         dialogueState = 1\r\n       ?dialogueState = 4\r\n         dialogueState = 0\r\n         whoAmITalkingTo = myself\r\n         yapping.HideText()\r\n         yapping.Reset()\r\n         BoxList[0].visible = false\r\n         clickAnywhere = \"false\"\r\n         textTimer = 0 \r\n      ?i = 3 //For the annoying person\r\n       ?whoAmITalkingTo = \"myself\"\r\n        whoAmITalkingTo = \"annoying\"\r\n\t    isDialogueActive = \"true\"\r\n       ?dialogueState < 2\r\n        dialogueState = 1\r\nfunc HandleAutoCloseDialogue()\r\n ?whoAmITalkingTo = \"John\"\r\n  ?dialogueState = 3\r\n   ?textTimer > 120\r\n    dialogueState = 0\r\n        whoAmITalkingTo = myself\r\n        yapping.HideText()\r\n        yapping.Reset()\r\n        BoxList[1].visible = false\r\n        clickAnywhere = \"false\"\r\n        textTimer = 0\r\n?loc = waterfall //declaring text at the bottom to avoid it getting hidden by text boxes\r\n \r\n var yapping = new UI/BetterText\r\n ?loc.begin\r\n  yapping.x = -6\r\n  yapping.y = 1\r\n ?totaltime = 2\r\n  yapping.UpdateVariables()\r\nHandleDialogue()\r\nHandleAutoCloseDialogue()\r\n\r\n>`@input.x@,@input.y@,#000000,@charToPrint@\r\n\r\n/*\r\n⚿§†☤❄☼☆♂♀°☺ʘ◙◘⏹\r\n❤♦♣♠♪♫ ↑→↓←▲▶▼◀\r\n@$%&€£￥₩!¡?¿:;*\r\n,….·•'＂´`¯-_┊|\r\n≡=≠≈~÷+±≤≥<>«»^\r\n/\\[]{}()░▒▓█▄▀\r\nABCDEFGHIJKLM\r\nNOPQRSTUVWXYZ\r\nabcdefghijklm\r\nnopqrstuvwxyz \r\n0123456789\r\nãäâáàåÄÅÁÀëêéèÉ\r\nïîíìõöôóòÖñüûúù\r\nÜýçÇÑ Ææœ∞\r\nαβγ∆δεέζηΘιλ\r\nμξπρΣστΦφψΩω\r\n┌┬┐╔╦╗╒╤╕╓╥╖⌐ ¬ \r\n├┼┤╠╬╣╞╪╡╟╫╢║ │ \r\n└┴┘╚╩╝╘╧╛╙╨╜═ ─\r\n*/\r\n//---------Big A** Music Array---------\\\\\r\nvar MusicList = [bronze_guardian_3,bronze_guardian_4,bronze_guardian_5,bronze_guardian_cyan,\r\n^bronze_mine_0,bronze_mine_1,bronze_mine_2,bronze_mine_3,bronze_mine_4,bronze_mine_5,\r\n^bronze_mine_cyan,slave_outro_climb,slave_outro_loop,caustic_caves,spider_boss,\r\ncross_deadwood_river,cross_deadwood_wind,deadwood_0,deadwood_1,deadwood_2,deadwood_3,\r\ndeadwood_4,deadwood_5,deadwood_cyan,tree_boss,waterfall_descent,poena,skeleton_boss,\r\nundead_crypt_0,undead_crypt_1,undead_crypt_2,undead_crypt_3,undead_crypt_4,undead_crypt_5,\r\nundead_crypt_cyan,undead_crypt_intro,bridge_broken,bridge_crossing,icy_ridge_0,icy_ridge_1,\r\nicy_ridge_2,icy_ridge_3,icy_ridge_4,icy_ridge_5,icy_ridge_cyan,yeti,fire_loop,\r\nfungus_forest_0,fungus_forest_1,fungus_forest_2,fungus_forest_3,fungus_forest_4,\r\nfungus_forest_5,fungus_forest_cyan,mushroom_boss,mushroom_boss_cyan,shop,rocky_plateau_0,\r\nrocky_plateau_1,rocky_plateau_2,rocky_plateau_3,rocky_plateau_4,rocky_plateau_5,\r\nrocky_plateau_epilogue,rocky_plateau_fight,rocky_plateau_talk,nagaraja,temple_0,temple_1,\r\ntemple_2,temple_3,temple_4,temple_5,temple_cyan,event_fall,event_hamartia,event_spring,\r\nevent_stonejam,event_summer,event_winter,credits,main_menu,bone_factory,osteophone,uulaa]\r\nvar musicDisplay = new UI/BetterText\r\n?totaltime = 1\r\n musicDisplay.x = 15\r\n musicDisplay.y = 13\r\n musicDisplay.width = 35\r\n musicDisplay.FinishingText = \"currently playing:event_stonejam\"\r\n musicDisplay.color = #76d46a\r\n?totaltime = 2\r\n musicDisplay.UpdateVariables()\r\nvar playButtonDisplayX\r\nvar playButtonDisplayY\r\n\r\nmusicDisplay.Update()\r\nfunc RandomRange(min, max)\r\n  ?min >= max\r\n    return min\r\n  return min + rng % (max - min + 1)\r\nvar chosenSong\r\n?loc.begin\r\n music.Play(event_stonejam)\r\n?input.x >= 50 & input.x <= 53 & input.y >= 19 & input.y <= 22\r\n  playButtonDisplayX = input.x\r\n  playButtonDisplayY = input.y\r\n  ?key = \"Begin\"\r\n   chosenSong = RandomRange(0,84)\r\n   music.Stop()\r\n   musicDisplay.FinishingText = \"currently playing:\" + MusicList[chosenSong]\r\n   musicDisplay.Reset()\r\n   music.Play(MusicList[chosenSong])\r\n:\r\n  playButtonDisplayX = screen.w\r\n  playButtonDisplayY = screen.h\r\n>`@playButtonDisplayX@,@playButtonDisplayY@,#000000,▶"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/StoneClause.txt" - Parse error: Failed to parse completely. Remaining: ",-2,#FF2222,ascii\r\n .•~~.\r\n(,.###)\r\n#\r\nasciiend\r\n\r\nh-4,-2,#FFFFFF,ascii\r\n #####\r\n###___#\r\nʘ\r\nasciiend\r\n\r\n\r\nh-8,-1,#FF2222,ascii\r\n  \r\n ####\r\n#############\r\n####(          )\r\n####`-,----,---´ \r\n##\r\nasciiend\r\n\r\n\r\nh-8,-1,#EFCE10,ascii\r\n  __\r\n#(, #`\r\n##### '––.__.-.\r\n###############\r\n################ _\r\n   _____________)\r\nasciiend \r\n\r\nh-20,0,#A50000,ascii\r\n   \r\n  '--'\r\n.´¯¯¯¯`.\r\n(      )\r\n(______)\r\nasciiend\r\n\r\n\r\n var animframes = ［ascii\r\n  \r\n☺\r\n#┴#  \r\n#####_☺#####☺\r\n######)####¯\r\n########\r\nasciiend,ascii\r\n  \r\n☺\r\n#┴#    \r\n#####_☺#####☺\r\n######)####¯\r\n########\r\nasciiend,ascii\r\n  \r\n☺\r\n#┴#   \r\n#####_☺#####☺\r\n######)####¯\r\n######v##v\r\nasciiend,ascii\r\n  \r\n☺\r\n#┴#    \r\n#####_☺#####☺\r\n######)####¯\r\n#########\r\nasciiend,ascii\r\n  \r\n☺\r\n#┴#  \r\n#####_☺#####☺\r\n######)####¯\r\n######## \r\nasciiend］ \r\n var i = 0\r\n h-17,-1,#FFFFFF,@animframes［i］@\r\n totaltime % 7 = 0 \r\n   i++\r\n i = animframes.Count()\r\n  i = 0"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/StoneHeadless.txt" - Parse error: Failed to parse completely. Remaining: "=[]\r\nvar spiderarray=[]\r\nvar skelearray=[]\r\nvar ghostarray=[]\r\nvar delete=[]\r\nvar random\r\nvar fC\r\nfC=foe.count\r\n\r\nvar smallbat=ascii\r\n#\r\n###,,\r\n##,\"-\\\r\n##|,#|;\r\n%%\r\n#\r\n###,,\r\n#.'\"-`.\r\n#\\####/\r\n%%\r\n#_####__\r\n#`\\,,/.'\r\n###\"-'\r\n%%\r\n#\r\n#\\_,,_/.\r\n##`\"-`'\r\nasciiend\r\n/*%%\r\n#\r\n###,,\r\n##,ö-\\\r\n##|,#|;\r\n%%\r\n#\r\n###,,\r\n#.'ö-`.\r\n#\\####/\r\n%%\r\n#_####__\r\n#`\\,,/.'\r\n###ö-'\r\n%%\r\n#\r\n#\\_,,_/.\r\n##`ö-`'\r\nasciiend\r\n*/\r\nvar bigbat=ascii\r\n###_##__\r\n##|(#/_(\r\n##\\(#|\\(\r\n###v)`/#\r\n###＂─'##\r\n%%\r\n#########\r\n#_#####__\r\n|(####/_(\r\n`.\\V)/.'#\r\n##`＂─'###\r\n%%\r\n#######\r\n#######\r\n#######\r\n###v)_#\r\n##/＂─#\\\r\n##|(#|(\r\n##\\(#\\)\r\n%%\r\n########\r\n########\r\n########\r\n##.v)─.#\r\n#/#＂─\\.\\\r\n#\\(###)/\r\nasciiend\r\n\r\nvar smallspider=ascii\r\n#\r\n###,-,\r\n#/∞|¯\\\r\n%%\r\n#\r\n###,-,\r\n#(∞/<\\\r\n%%\r\n#\r\n###,-,\r\n#<∞|/>\r\n%%\r\n#\r\n###,-,\r\n#/∞(|)\r\n%%\r\n#\r\n###,-,\r\n#|∞<(|\r\n%%\r\n#\r\n###,-,\r\n#/∞|<\\\r\nasciiend\r\n/*%%\r\n#\r\n###,-,\r\n#¯∞/|\\\r\n%%\r\n#\r\n##\\#,-,\r\n## ∞`))\r\n%%\r\n#\r\n##(#\\-,\r\n## ∞ ))\r\n%%\r\n#\r\n##(#(-,\r\n## ∞ ))\r\n%%\r\n##,.\r\n#/ /-,\r\n( ' |\\\r\n#`'\r\nasciiend\r\n*/\r\nvar bigspider=ascii\r\n#####_\r\n####( )\r\n#/`∞|´\\\\\r\n´###'##``\r\n%%\r\n#####_\r\n####( )\r\n#|`(`^´|\r\n#'#####'\r\n%%\r\n#####_\r\n####( )\r\n#(`∞/<´\\\r\n##`´####`\r\n%%\r\n#####_\r\n####( )\r\n#<;∞|/#`.\r\n####'####`\r\n%%\r\n#####_\r\n#_##( )#_\r\n'#`∞(|#`#'\r\n#####`\r\n%%\r\n#####_\r\n####( )_\r\n,´`∞<'|#)\r\n######'\r\n%%\r\n#####_\r\n###_( )\r\n#/'∞`´\\)\r\n´######`\r\n%%\r\n#####_\r\n####( )\r\n#/'∞<#\\)\r\n´######`\r\n%%\r\n#####_\r\n####( )\r\n#/`∞|´\\\\\r\n´###'##``\r\nasciiend\r\n/*%%\r\n     _\r\n    ( )\r\n´¯`∞/´\\\\\r\n    `  ``\r\n%%\r\n     _\r\n -. ( )\r\n   (`´\\\\\r\n      ' `\r\n%%\r\n     _\r\n `\\_( )\r\n   ∞`´\\\\\r\n      ' `\r\n%%\r\n    , _\r\n   (\\( )\r\n    ∞`´)\\\r\n      ´ '\r\n%%\r\n    ,,_\r\n   ((( )\r\n    ∞`´)\\\r\n      ´ '\r\n%%\r\n    ,,_\r\n   ((( )\r\n    ∞`´)\\\r\n      ´ '\r\n%%\r\n  ,´/_\r\n / .( )\r\n(  | ´\\\\\r\n \\ '  ' `\r\n  ``\r\n%%\r\n  ,´/_\r\n / .( )\r\n(  | ´\\\\\r\n \\ '  ' `\r\n  ``\r\n%%\r\n     _\r\n    ( )\r\n  ,∞.´\\\\\r\n  \\ |  ``\r\nasciiend\r\n*/\r\n\r\nvar smallskele=ascii\r\n#\r\n#_{)\r\n''¯)\r\n##/(\r\n%%\r\n#\r\n#_{)\r\n''¯)\r\n##(V\r\n%%\r\n#\r\n#_{)\r\n''¯)\r\n##<|\r\n%%\r\n#\r\n#_{)\r\n''¯)\r\n##/|\r\nasciiend\r\n\r\nvar bigskele=ascii\r\n####__\r\n###,o_)\r\n###\"':_\r\n##_.-/)\\\r\n#\"`,-´_/\r\n##'\"###;\r\n######/¯\r\n####,-`\\\r\n#######,/\r\n%%\r\n####__\r\n###,o_)\r\n###\"':_\r\n##_.-/)\\\r\n#\"`,-´_/\r\n##'\"###;\r\n######`/\r\n######/#\\\r\n####,-'#,/\r\n%%\r\n####__\r\n###,o_)\r\n###\"':_\r\n\"`¯¯,-'\\\r\n#'\"¯#\\_/\r\n#######;\r\n######//\r\n######`|/\r\n#####,-'\r\n%%\r\n####__\r\n###,o_)\r\n###\"':_\r\n\"`¯¯,-'\\\r\n#'\"¯#\\_/\r\n#######;\r\n#####\\¯#|\r\n#####,/#|\r\n######,-'\r\n%%\r\n####__\r\n###,o_)\r\n###\"':_\r\n\"`¯¯,-'\\\r\n#'\"¯#\\_/\r\n#######;\r\n#####/¯#|\r\n###,-`##\\\r\n########,/\r\n%%\r\n####__\r\n###,o_)\r\n###\"':_\r\n\"`¯¯,-'\\\r\n#'\"¯#\\_/\r\n#######;\r\n######/#\\\r\n#####/###\\\r\n###,-'###,/\r\n%%\r\n####__\r\n###,o_)\r\n###\"':_\r\n##_.-/)\\\r\n#\"`,-´_/\r\n##'\"###;\r\n######|/\r\n######|\\_;\r\n####,-'##'\r\n%%\r\n####__\r\n###,o_)\r\n###\"':_\r\n##_.-/)\\\r\n#\"`,-´_/\r\n##'\"###;\r\n######\\¯\r\n######,/\r\n######,-'\r\nasciiend\r\n\r\nvar smallghost=ascii\r\n##.-.\r\n#(* *)\r\n-' ° '-\r\n##\\ (_,\r\n###`-'\r\n%%\r\n##.-.\r\n#(* *)\r\n^´ ° `^\r\n##) /_,\r\n##'--'\r\n%%\r\n##.-.\r\n#(* *)\r\n-' ° '-\r\n##) /,\r\n#'--'\r\n%%\r\n##.-.\r\n#(* *)\r\n^´ ° `^\r\n##) /\r\n#'-'\r\n%%\r\n##.-.\r\n#(* *)\r\n-' ° '-\r\n##\\ (\r\n##'-'\r\n%%\r\n##.-.\r\n#(* *)\r\n^´ ° `^\r\n##\\ (,\r\n###`-'\r\nasciiend\r\n\r\nvar bigghost=ascii\r\n\\`-.-.-´/\r\n#) \\ / (\r\n_\\ * * /_\r\n`   .   ´\r\n##\\   (_.\\\r\n###`~...~'\r\n%%\r\n\\`-.-.-´/\r\n#) \\ / (\r\n#\\ * * /\r\n<'  .  `>\r\n##)   /.-)\r\n##'~...~'\r\n%%\r\n\\`-.-.-´/\r\n#) \\ / (\r\n_\\ * * /_\r\n`   .   ´\r\n##)   /-/\r\n##'~..~'\r\n%%\r\n\\`-.-.-´/\r\n#) \\ / (\r\n#\\ * * /\r\n<'  .  `>\r\n##)   //\r\n##'~.~'\r\n%%\r\n\\`-.-.-´/\r\n#) \\ / (\r\n_\\ * * /_\r\n`   .   ´\r\n##\\   ((\r\n##'~..~'\r\n%%\r\n\\`-.-.-´/\r\n#) \\ / (\r\n#\\ * * /\r\n<'  .  `>\r\n##\\   (.\\\r\n###`~..~'\r\nasciiend\r\n\r\nfunc CreateBat(x,y)\r\n  var asci\r\n  ?rng%5=0\r\n    asci=bigbat\r\n  :\r\n    asci=smallbat\r\n  var bat=UI.AddAnim(asci)\r\n  bat.dock=top_left\r\n  bat.anchor=top_left\r\n  bat.x=x+3\r\n  bat.y=y-2\r\n  bat.flipX=true\r\n  var attacktime=0\r\n  batarray.Add([bat,attacktime])\r\n\r\nfunc CreateSpider(x,y)\r\n  var asci\r\n  ?rng%5=0\r\n    asci=bigspider\r\n  :\r\n    asci=smallspider\r\n  var bat=UI.AddAnim(asci)\r\n  bat.dock=top_left\r\n  bat.anchor=top_left\r\n  bat.x=x+3\r\n  bat.y=y-2\r\n  bat.flipX=true\r\n  var attacktime=0\r\n  spiderarray.Add([bat,attacktime])\r\n\r\nfunc CreateSkele(x,y)\r\n  var asci\r\n  ?rng%5=0\r\n    asci=bigskele\r\n  :\r\n    asci=smallskele\r\n  var bat=UI.AddAnim(asci)\r\n  bat.dock=top_left\r\n  bat.anchor=top_left\r\n  bat.x=x+3\r\n  bat.y=y-2\r\n  bat.flipX=true\r\n  var attacktime=0\r\n  skelearray.Add([bat,attacktime])\r\n\r\nfunc CreateGhost(x,y)\r\n  var asci\r\n  ?rng%5=0\r\n    asci=bigghost\r\n  :\r\n    asci=smallghost\r\n  var bat=UI.AddAnim(asci)\r\n  bat.dock=top_left\r\n  bat.anchor=top_left\r\n  bat.x=x+3\r\n  bat.y=y-2\r\n  bat.flipX=true\r\n  var attacktime=0\r\n  ghostarray.Add([bat,attacktime])\r\n\r\nfunc RunBat()\r\n  var count=0\r\n  var targetx\r\n  var targety\r\n  var remove\r\n  ?fC=0\r\n    targetx=\"none\"\r\n    targety=\"none\"\r\n  :\r\n    targetx=refX+foe.distance-2\r\n    targety=refZ-4\r\n  for b : batarray\r\n    ?time%2=0\r\n      ?fC=0|disableattack\r\n        b[0].x=b[0].x+1\r\n        b[0].frame=b[0].frame+1\r\n        //?b[0].frame>=4\r\n        //  b[0].frame=b[0].frame-4\r\n      :\r\n        ?b[0].x<targetx|b[0].x>targetx+3\r\n          b[0].x=b[0].x+1\r\n          b[0].frame=b[0].frame+1\r\n          ?b[0].frame>=4\r\n            b[0].frame=b[0].frame-4\r\n        :?b[1]>=10\r\n          b[0].frame=b[0].frame+1\r\n          ?b[0].frame<=3\r\n            b[0].frame=b[0].frame+4\r\n          b[1]=b[1]+1\r\n          ?b[1]>=15\r\n            b[1]=0\r\n        :\r\n          b[1]=b[1]+1\r\n          b[0].frame=b[0].frame+1\r\n          ?b[0].frame>=4\r\n            b[0].frame=b[0].frame-4\r\n        ?b[0].y<targety\r\n          b[0].y=b[0].y+1\r\n        :?b[0].y>targety\r\n          b[0].y=b[0].y-1\r\n      ?b[0].x>screen.w\r\n        delete.Add(count)\r\n          b[0].Recycle()\r\n    count++\r\n  count=0\r\n    ?delete.Count()>0\r\n      for d : delete\r\n        batarray.Emplace(d,0)\r\n      for d : delete\r\n        remove=batarray.IndexOf(0)\r\n        batarray.RemoveAt(remove)\r\n      delete.Clear()\r\n\r\nfunc RunSpider()\r\n  var count=0\r\n  var targetx\r\n  var targety\r\n  var remove\r\n  ?fC=0\r\n    targetx=\"none\"\r\n    targety=\"none\"\r\n  :\r\n    targetx=refX+foe.distance-2\r\n    targety=refZ-4\r\n  for b : spiderarray\r\n    ?time%3=0\r\n      ?fC=0|disableattack\r\n        b[1]=0\r\n        b[0].x=b[0].x+1\r\n        b[0].frame=b[0].frame+1\r\n        //?b[0].frame>=6\r\n        //  b[0].frame=0\r\n      :\r\n        ?b[0].x<targetx|b[0].x>targetx+3\r\n          b[1]=0\r\n          b[0].x=b[0].x+1\r\n          b[0].frame=b[0].frame+1\r\n          ?b[0].frame>=6\r\n            b[0].frame=0\r\n        :?b[1]>=5\r\n          b[0].frame=b[0].frame+1\r\n          ?b[0].frame<=5\r\n            b[0].frame=6\r\n          b[1]=b[1]+1\r\n          ?b[1]>=10\r\n            b[1]=0\r\n        :\r\n          b[1]=b[1]+1\r\n          b[0].frame=0\r\n        ?b[0].y<targety\r\n          b[0].y=b[0].y+1\r\n        :?b[0].y>targety\r\n          b[0].y=b[0].y-1\r\n      ?b[0].x>screen.w\r\n        delete.Add(count)\r\n          b[0].Recycle()\r\n    count++\r\n  count=0\r\n    ?delete.Count()>0\r\n      for d : delete\r\n        spiderarray.Emplace(d,0)\r\n      for d : delete\r\n        remove=spiderarray.IndexOf(0)\r\n        spiderarray.RemoveAt(remove)\r\n      delete.Clear()\r\n\r\nfunc RunSkele()\r\n  var count=0\r\n  var targetx\r\n  var targety\r\n  var remove\r\n  ?fC=0\r\n    targetx=\"none\"\r\n    targety=\"none\"\r\n  :\r\n    targetx=refX+foe.distance-2\r\n    targety=refZ-4\r\n  for b : skelearray\r\n    ?time%5=0\r\n      ?fC=0|disableattack\r\n        b[1]=0\r\n        b[0].x=b[0].x+1\r\n        b[0].frame=b[0].frame+1\r\n      ?b[0].x>screen.w\r\n        delete.Add(count)\r\n          b[0].Recycle()\r\n    count++\r\n  count=0\r\n    ?delete.Count()>0\r\n      for d : delete\r\n        skelearray.Emplace(d,0)\r\n      for d : delete\r\n        remove=skelearray.IndexOf(0)\r\n        skelearray.RemoveAt(remove)\r\n      delete.Clear()\r\n\r\nfunc RunGhost()\r\n  var count=0\r\n  var targetx\r\n  var targety\r\n  var remove\r\n  ?fC=0\r\n    targetx=\"none\"\r\n    targety=\"none\"\r\n  :\r\n    targetx=refX+foe.distance-2\r\n    targety=refZ-4\r\n  for b : ghostarray\r\n    ?time%4=0\r\n      ?fC=0|disableattack\r\n        b[1]=0\r\n        b[0].x=b[0].x+1\r\n        b[0].frame=b[0].frame+1\r\n      ?b[0].x>screen.w\r\n        delete.Add(count)\r\n          b[0].Recycle()\r\n    count++\r\n  count=0\r\n    ?delete.Count()>0\r\n      for d : delete\r\n        ghostarray.Emplace(d,0)\r\n      for d : delete\r\n        remove=ghostarray.IndexOf(0)\r\n        ghostarray.RemoveAt(remove)\r\n      delete.Clear()\r\n\r\n?totaltime=1\r\n  blood._bighead=true\r\n  batarray.Clear()\r\n  spiderarray.Clear()\r\n  skelearray.Clear()\r\n  ghostarray.Clear()\r\n?headless\r\n  blood.ScarfMain()\r\n  ?bighead\r\n    >h-3,-1,       \r\n    >h-3,0,       \r\n    >h1,1, \r\n?key=primaryBegin\r\n  random=rng\r\n  ?random%4=0\r\n    CreateBat(input.x,input.y)\r\n  :?random%4=1\r\n    CreateSpider(input.x,input.y)\r\n  :?random%4=2\r\n    CreateSkele(input.x,input.y)\r\n  :\r\n    CreateGhost(input.x,input.y)\r\nRunBat()\r\nRunSpider()\r\nRunSkele()\r\nRunGhost()"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/WitchBroom.txt" - Parse error: Failed to parse completely. Remaining: "= #964B00\r\nvar legcolor   = #white\r\nvar bubblecolors = [#cyan,\r\n                    #green,\r\n                    #blue]\r\n\r\n//*******************************\r\n// Drawing Code \r\n//*******************************\r\n\r\n//Broom\r\n\r\n>h-3,3,@broomcolor@,»──>>──\r\n>h0,3,@legcolor@,>>\r\n\r\n//Bubbles\r\n\r\nvar bubbles = ［＂＂,＂＂,＂＂,＂＂,＂＂］\r\nvar colors = [null,null,null,null,null]\r\n\r\nvar bubblearray = ［\r\n＂＂, ＂＂, ＂＂, ＂＂,＂ ＂, ＂＂,\r\n＂.＂,＂·＂,＂•＂,＂☺＂,＂O＂,＂°＂］\r\n\r\n?time%3 = 0\r\n  bubbles［4］ = bubbles［3］\r\n  bubbles［3］ = bubbles［2］\r\n  bubbles［2］ = bubbles［1］\r\n  bubbles［1］ = bubbles［0］\r\n  bubbles［0］ = bubblearray［rng % 12］\r\n\r\n  colors［4］ = colors［3］\r\n  colors［3］ = colors［2］\r\n  colors［2］ = colors［1］\r\n  colors［1］ = colors［0］\r\n  colors［0］ = bubblecolors［\r\n        ^rng % bubblecolors.Count()］\r\n  \r\n>h-9,3,@colors［4］@,@bubbles［4］@\r\n>h-8,3,@colors［3］@,@bubbles［3］@\r\n>h-7,3,@colors［2］@,@bubbles［2］@\r\n>h-6,3,@colors［1］@,@bubbles［1］@\r\n>h-5,3,@colors［0］@,@bubbles［0］@\r\n\r\n//*******************************\r\n// End of File\r\n//*******************************"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/BadApple.txt" - Parse error: Failed to parse completely. Remaining: "=[[841, 95], [847, 107], [854, 113], [860, 127], [867, 142], [880, 190], [886, 169], [893, 142], [906, 95], [919, 142], [926, 127], [932, 113], [939, 107], [945, 95], [952, 107], [958, 113], [965, 127], [972, 142], [978, 142], [984, 127], [991, 113], [997, 107], [1004, 95], [1010, 107], [1017, 113], [1023, 107], [1030, 95], [1036, 90], [1043, 107], [1049, 95], [1056, 107], [1063, 113], [1069, 127], [1076, 142], [1089, 190], [1095, 169], [1102, 142], [1115, 95], [1128, 142], [1134, 127], [1141, 113], [1147, 107], [1154, 95], [1160, 107], [1167, 113], [1173, 127], [1180, 142], [1186, 142], [1193, 127], [1199, 113], [1206, 107], [1219, 113], [1232, 127], [1245, 142], [1258, 95], [1265, 107], [1271, 113], [1278, 127], [1284, 142], [1297, 190], [1304, 169], [1310, 142], [1323, 95], [1336, 142], [1343, 127], [1349, 113], [1356, 107], [1363, 95], [1369, 107], [1376, 113], [1382, 127], [1389, 142], [1402, 127], [1408, 113], [1415, 107], [1421, 95], [1428, 107], [1434, 113], [1441, 107], [1447, 95], [1454, 90], [1460, 107], [1467, 95], [1473, 107], [1480, 113], [1486, 127], [1493, 142], [1506, 190], [1513, 169], [1519, 142], [1532, 95], [1545, 142], [1552, 127], [1558, 113], [1565, 107], [1571, 95], [1578, 107], [1584, 113], [1591, 127], [1597, 142], [1610, 127], [1617, 113], [1623, 107], [1636, 113], [1649, 127], [1663, 142], [1676, 169], [1682, 190], [1689, 142], [1695, 127], [1702, 142], [1715, 127], [1721, 142], [1728, 169], [1734, 190], [1741, 142], [1747, 127], [1754, 142], [1767, 127], [1773, 142], [1780, 127], [1786, 113], [1793, 107], [1799, 85], [1806, 95], [1819, 85], [1826, 95], [1832, 107], [1839, 113], [1845, 127], [1852, 142], [1858, 95], [1871, 142], [1878, 169], [1884, 169], [1891, 190], [1897, 142], [1904, 127], [1910, 142], [1923, 127], [1930, 142], [1936, 169], [1943, 190], [1949, 142], [1956, 127], [1963, 142], [1976, 127], [1982, 142], [1989, 127], [1995, 113], [2002, 107], [2008, 85], [2015, 95], [2028, 85], [2034, 95], [2041, 107], [2047, 113], [2054, 127], [2060, 142], [2067, 95], [2080, 142], [2086, 169], [2093, 169], [2099, 190], [2106, 142], [2113, 127], [2119, 142], [2132, 127], [2139, 142], [2145, 169], [2152, 190], [2158, 142], [2165, 127], [2171, 142], [2184, 127], [2191, 142], [2197, 127], [2204, 113], [2210, 107], [2217, 85], [2223, 95], [2236, 85], [2243, 95], [2249, 107], [2256, 113], [2263, 127], [2269, 142], [2276, 95], [2289, 142], [2295, 169], [2302, 169], [2308, 190], [2315, 142], [2321, 127], [2328, 142], [2341, 127], [2347, 142], [2354, 169], [2360, 190], [2367, 142], [2373, 127], [2380, 142], [2393, 190], [2399, 213], [2406, 226], [2413, 213], [2419, 190], [2426, 169], [2433, 142], [2439, 142], [2445, 127], [2452, 142], [2458, 127], [2465, 113], [2471, 107], [2478, 85], [2485, 95], [2491, 95], [2497, 142], [2504, 169], [2510, 169], [2517, 190], [2523, 142], [2530, 127], [2536, 142], [2549, 127], [2556, 142], [2563, 169], [2569, 190], [2576, 142], [2582, 127], [2589, 142], [2602, 127], [2608, 142], [2615, 127], [2621, 113], [2628, 107], [2634, 85], [2641, 95], [2654, 85], [2660, 95], [2667, 107], [2673, 113], [2680, 127], [2686, 142], [2693, 95], [2706, 142], [2713, 169], [2719, 169], [2726, 190], [2732, 142], [2739, 127], [2745, 142], [2758, 127], [2765, 142], [2771, 169], [2778, 190], [2784, 142], [2791, 127], [2797, 142], [2810, 127], [2817, 142], [2823, 127], [2830, 113], [2836, 107], [2843, 85], [2849, 95], [2863, 85], [2869, 95], [2876, 107], [2882, 113], [2889, 127], [2895, 142], [2902, 95], [2915, 142], [2921, 169], [2928, 169], [2934, 190], [2941, 142], [2947, 127], [2954, 142], [2967, 127], [2973, 142], [2980, 169], [2986, 190], [2993, 142], [2999, 127], [3006, 142], [3019, 127], [3026, 142], [3032, 127], [3039, 113], [3045, 107], [3052, 85], [3058, 95], [3071, 85], [3078, 95], [3084, 107], [3091, 113], [3097, 127], [3104, 142], [3110, 95], [3123, 142], [3130, 169], [3136, 169], [3143, 190], [3149, 142], [3156, 127], [3163, 142], [3176, 127], [3182, 142], [3189, 169], [3195, 190], [3202, 142], [3208, 127], [3215, 142], [3228, 190], [3234, 213], [3241, 226], [3247, 213], [3254, 190], [3260, 169], [3267, 142], [3273, 142], [3280, 127], [3286, 142], [3293, 127], [3299, 113], [3306, 107], [3313, 85], [3319, 95], [3763, 95], [3769, 107], [3776, 113], [3782, 127], [3789, 142], [3802, 190], [3808, 169], [3815, 142], [3828, 95], [3841, 142], [3847, 127], [3854, 113], [3860, 107], [3867, 95], [3873, 107], [3880, 113], [3886, 127], [3893, 142], [3899, 142], [3906, 127], [3913, 113], [3919, 107], [3926, 95], [3932, 107], [3939, 113], [3945, 107], [3952, 95], [3958, 90], [3965, 107], [3971, 95], [3978, 107], [3984, 113], [3991, 127], [3997, 142], [4010, 190], [4017, 169], [4023, 142], [4036, 95], [4049, 142], [4056, 127], [4063, 113], [4069, 107], [4076, 95], [4082, 107], [4089, 113], [4095, 127], [4102, 142], [4108, 142], [4115, 127], [4121, 113], [4128, 107], [4141, 113], [4154, 127], [4167, 142], [4180, 95], [4186, 107], [4193, 113], [4199, 127], [4206, 142], [4219, 190], [4226, 169], [4232, 142], [4245, 95], [4258, 142], [4265, 127], [4271, 113], [4278, 107], [4284, 95], [4291, 107], [4297, 113], [4304, 127], [4310, 142], [4323, 127], [4330, 113], [4336, 107], [4343, 95], [4349, 107], [4356, 113], [4363, 107], [4369, 95], [4376, 90], [4382, 107], [4389, 95], [4395, 107], [4402, 113], [4408, 127], [4415, 142], [4428, 190], [4434, 169], [4441, 142], [4454, 95], [4467, 142], [4473, 127], [4480, 113], [4486, 107], [4493, 95], [4499, 107], [4506, 113], [4513, 127], [4519, 142], [4532, 127], [4539, 113], [4545, 107], [4558, 113], [4571, 127], [4584, 142], [4597, 169], [4604, 190], [4610, 142], [4617, 127], [4623, 142], [4636, 127], [4643, 142], [4649, 169], [4656, 190], [4663, 142], [4669, 127], [4676, 142], [4689, 127], [4695, 142], [4702, 127], [4708, 113], [4715, 107], [4721, 85], [4728, 95], [4741, 85], [4747, 95], [4754, 107], [4760, 113], [4767, 127], [4773, 142], [4780, 95], [4793, 142], [4799, 169], [4806, 169], [4813, 190], [4819, 142], [4826, 127], [4832, 142], [4845, 127], [4852, 142], [4858, 169], [4865, 190], [4871, 142], [4878, 127], [4884, 142], [4897, 127], [4904, 142], [4910, 127], [4917, 113], [4923, 107], [4930, 85], [4936, 95], [4949, 85], [4956, 95], [4963, 107], [4969, 113], [4976, 127], [4982, 142], [4989, 95], [5002, 142], [5008, 169], [5015, 169], [5021, 190], [5028, 142], [5034, 127], [5041, 142], [5054, 127], [5060, 142], [5067, 169], [5073, 190], [5080, 142], [5086, 127], [5093, 142], [5106, 127], [5113, 142], [5119, 127], [5126, 113], [5132, 107], [5139, 85], [5145, 95], [5158, 85], [5165, 95], [5171, 107], [5178, 113], [5184, 127], [5191, 142], [5197, 95], [5210, 142], [5217, 169], [5223, 169], [5230, 190], [5236, 142], [5243, 127], [5249, 142], [5263, 127], [5269, 142], [5276, 169], [5282, 190], [5289, 142], [5295, 127], [5302, 142], [5315, 190], [5321, 213], [5328, 226], [5334, 213], [5341, 190], [5347, 169], [5354, 142], [5360, 142], [5367, 127], [5373, 142], [5380, 127], [5386, 113], [5393, 107], [5399, 85], [5407, 95], [5413, 95], [5419, 151], [5426, 179], [5432, 179], [5439, 201], [5445, 151], [5452, 134], [5458, 151], [5471, 134], [5478, 151], [5484, 179], [5491, 201], [5497, 151], [5504, 134], [5510, 151], [5523, 134], [5530, 151], [5536, 134], [5543, 120], [5549, 113], [5556, 90], [5563, 101], [5576, 90], [5582, 101], [5589, 113], [5595, 120], [5602, 134], [5608, 151], [5615, 101], [5628, 151], [5634, 179], [5641, 179], [5647, 201], [5654, 151], [5660, 134], [5667, 151], [5680, 134], [5686, 151], [5693, 179], [5699, 201], [5706, 151], [5713, 134], [5719, 151], [5732, 134], [5739, 151], [5745, 134], [5752, 120], [5758, 113], [5765, 90], [5771, 101], [5784, 90], [5791, 101], [5797, 113], [5804, 120], [5810, 134], [5817, 151], [5823, 101], [5836, 151], [5843, 179], [5849, 179], [5856, 201], [5863, 151], [5869, 134], [5876, 151], [5889, 134], [5895, 151], [5902, 179], [5908, 201], [5915, 151], [5921, 134], [5928, 151], [5941, 134], [5947, 151], [5954, 134], [5960, 120], [5967, 113], [5973, 90], [5980, 101], [5993, 90], [5999, 101], [6006, 113], [6013, 120], [6019, 134], [6026, 151], [6032, 101], [6045, 151], [6052, 179], [6058, 179], [6065, 201], [6071, 151], [6078, 134], [6084, 151], [6097, 134], [6104, 151], [6110, 179], [6117, 201], [6123, 151], [6130, 134], [6136, 151], [6149, 201], [6156, 226], [6163, 239], [6169, 226], [6176, 201], [6182, 179], [6189, 151], [6195, 151], [6202, 134], [6208, 151], [6215, 134], [6221, 120], [6228, 113], [6234, 90], [6241, 101]]\r\nvar a=[[423, 28], [427, 56], [430, 56], [436, 56], [440, 50], [443, 56], [449, 28], [453, 56], [456, 56], [463, 56], [466, 50], [469, 56], [479, 56], [482, 56], [489, 56], [492, 50], [495, 56], [505, 56], [508, 67], [515, 75], [518, 67], [521, 75], [531, 56], [534, 56], [541, 56], [544, 50], [547, 56], [557, 56], [560, 56], [567, 56], [570, 50], [573, 56], [583, 56], [593, 56], [606, 75], [609, 67], [613, 75], [619, 67], [622, 56], [626, 67], [635, 56], [639, 56], [645, 56], [648, 50], [652, 56], [661, 56], [665, 56], [671, 56], [674, 50], [678, 56], [688, 56], [691, 56], [697, 56], [701, 50], [704, 56], [714, 56], [717, 67], [723, 75], [727, 67], [730, 75], [740, 56], [743, 56], [749, 56], [753, 50], [756, 56], [766, 56], [769, 56], [776, 56], [779, 50], [782, 56], [792, 56], [795, 56], [802, 56], [815, 75], [818, 67], [821, 75], [828, 67], [834, 67], [2556, 45], [2608, 50], [2713, 56], [2765, 45], [2817, 50], [3339, 67], [3348, 113], [3352, 113], [3358, 113], [3361, 100], [3365, 113], [3374, 113], [3378, 113], [3384, 113], [3388, 100], [3391, 113], [3401, 113], [3404, 113], [3410, 113], [3414, 100], [3417, 113], [3430, 134], [3436, 150], [3440, 134], [3443, 150], [3453, 113], [3456, 113], [3463, 113], [3466, 100], [3469, 113], [3479, 113], [3482, 113], [3489, 113], [3492, 100], [3495, 113], [3505, 113], [3508, 113], [3515, 113], [3528, 150], [3531, 134], [3534, 150], [3541, 134], [3544, 113], [3547, 134], [3557, 113], [3560, 113], [3567, 113], [3570, 100], [3573, 113], [3583, 113], [3586, 113], [3593, 113], [3596, 100], [3599, 113], [3609, 113], [3613, 113], [3619, 113], [3622, 100], [3626, 113], [3635, 113], [3639, 134], [3645, 150], [3648, 134], [3652, 150], [3661, 113], [3665, 113], [3671, 113], [3674, 100], [3678, 113], [3688, 113], [3691, 113], [3697, 113], [3701, 100], [3704, 113], [3714, 113], [3717, 113], [3723, 113], [3736, 150], [3740, 134], [3743, 150], [3749, 134], [3756, 134], [5478, 47], [5530, 53], [5634, 60], [5686, 47], [5739, 53], [5843, 60], [5895, 47], [5947, 53], [6052, 60], [6104, 47], [6156, 53], [6208, 60], [6273, 60], [6283, 60], [6290, 60], [6299, 60], [6309, 60], [6316, 60], [6326, 60], [6335, 60], [6342, 60], [6352, 60], [6361, 60], [6368, 60], [6378, 60], [6388, 60], [6394, 60], [6404, 60], [6414, 60], [6420, 60], [6430, 60], [6440, 60], [6446, 60], [6456, 60], [6469, 60]]\r\nvar da=[0, 6, 13, 19, 26, 32, 39, 42, 45, 48, 52, 58, 65, 71, 78, 84, 91, 97, 104, 110, 117, 123, 130, 136, 143, 146, 149, 153, 156, 163, 169, 176, 182, 189, 195, 202, 208, 215, 221, 228, 234, 241, 247, 251, 254, 257, 260, 267, 273, 280, 286, 293, 299, 306, 313, 319, 326, 332, 339, 345, 352, 355, 358, 361, 365, 371, 378, 384, 391, 397, 404, 417, 423, 430, 436, 443, 449, 1617, 2499, 2954, 3006, 3058, 3110, 3163, 3215, 3267, 3313, 4539, 5421, 6260]\r\nvar da_ptr=0\r\nvar a_ptr=0\r\nvar b_ptr=0\r\nvar fr=-30\r\n?fr<0\r\n ?fr=-29\r\n    play ui_starold2\r\n :?fr=-28\r\n    play frog\r\n :?fr=27\r\n    play hammer_hit\r\n ambient.Stop()\r\n music.Stop()\r\n\r\n?fr=b[b_ptr][0]\r\n    play ui_starold2 @b[b_ptr][1]@\r\n    ?b_ptr<661\r\n        b_ptr=b_ptr+1\r\n?fr=da[da_ptr]\r\n play hammer_hit 115\r\n ?da_ptr<89\r\n  da_ptr=da_ptr+1\r\n?fr=a[a_ptr][0]\r\n    play frog @a[a_ptr][1]@\r\n    ?a_ptr<194\r\n     a_ptr=a_ptr+1\r\n?fr<6500\r\n fr++\r\n:\r\n fr=0\r\n da_ptr=0\r\n a_ptr=0\r\n b_ptr=0\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/SillyGoose.txt" - Parse error: Failed to parse completely. Remaining: "! 1 &\r\n^((pickup.distance > 3) |\r\n^((item.right = star stone) |\r\n^(item.left = star stone)))\r\n GooseEat = 0\r\n\r\n?pickup.distance <= 3 &\r\n^((item.right ! star stone) &\r\n^(item.left ! star stone)) &\r\n^!ai.walking\r\n GooseEat = 1\r\n\r\n?GooseEat = 1\r\n timerGoose4++\r\n ?timerGoose4 < 3\r\n  >o-4,-1,#white,ascii\r\n#####_\r\n####/'l\r\n####\\(\r\n#,###\\\\\r\n( ‾‾‾  )\r\n#\\____/\r\n#\r\nasciiend\r\n  >o-4,-1,#yellow,ascii\r\n#\r\n#######=\r\n#\r\n#\r\n#\r\n#\r\n###L#L\r\nasciiend\r\n :?timerGoose4 < 6\r\n  >o-4,-1,#white,ascii\r\n#\r\n#######_\r\n######/'l\r\n#,###((\r\n( ‾‾‾  )\r\n#\\____/\r\n#\r\nasciiend\r\n  >o-4,-1,#yellow,ascii\r\n#\r\n#\r\n#########<\r\n#\r\n#\r\n#\r\n###L#L\r\nasciiend\r\n :?timerGoose4 < 9\r\n  >o-4,-1,#white,ascii\r\n#\r\n#\r\n#\r\n#,######_\r\n( ‾‾‾.`~'l\r\n#\\____ì'\r\n#\r\nasciiend\r\n  >o-4,-1,#yellow,ascii\r\n#\r\n#\r\n#\r\n#\r\n##########<\r\n#\r\n###L#L\r\nasciiend\r\n :?timerGoose4 < 12\r\n  >o-4,-1,#white,ascii\r\n#\r\n#\r\n#\r\n#,######_\r\n( ‾‾‾.`~'l\r\n#\\____ì'\r\n#\r\nasciiend\r\n  >o-4,-1,#yellow,ascii\r\n#\r\n#\r\n#\r\n#\r\n##########=\r\n#\r\n###L#L\r\nasciiend\r\n :?timerGoose4 < 15\r\n  >o-4,-1,#white,ascii\r\n#\r\n#######_\r\n######/~l\r\n#,###((\r\n( ‾‾‾  )\r\n#\\____/\r\n#\r\nasciiend\r\n  >o-4,-1,#yellow,ascii\r\n#\r\n#\r\n#########=\r\n#\r\n#\r\n#\r\n###L#L\r\nasciiend\r\n :?timerGoose4 < 25\r\n  >o-4,-1,#white,ascii\r\n#####_\r\n####/'l\r\n####\\(\r\n#,###\\\\\r\n( ‾‾‾  )\r\n#\\____/\r\n#\r\nasciiend\r\n  >o-4,-1,#yellow,ascii\r\n#\r\n#######=\r\n#\r\n#\r\n#\r\n#\r\n###L#L\r\nasciiend\r\n :\r\n  timerGoose4 = 0\r\n  GooseEat = 0\r\n\r\n\r\n?ai.walking & \r\n^(foe.distance > 23 |\r\n^pickup.distance < 23)\r\n timerGoose2 = 0\r\n timerGoose3 = 0\r\n timerGoose++\r\n ?timerGoose < 5\r\n  >o-4,-1,#yellow,ascii\r\n#\r\n#######=\r\n#\r\n#\r\n#\r\n#\r\n##<###v\r\nasciiend\r\n  >o-4,-1,#white,ascii\r\n#####_\r\n####/'l\r\n####\\(\r\n#,###\\\\\r\n( ‾‾‾  )\r\n#\\____/\r\n#\r\nasciiend\r\n :?timerGoose < 10\r\n  >o-4,-1,#yellow,ascii\r\n#\r\n#######=\r\n#\r\n#\r\n#\r\n#\r\n###L##L\r\nasciiend\r\n  >o-4,-1,#white,ascii\r\n#####_\r\n####/'l\r\n####\\(\r\n#,###\\\\\r\n( ‾‾‾  )\r\n#\\____/\r\n#\r\nasciiend\r\n :?timerGoose < 15\r\n  >o-4,-1,#yellow,ascii\r\n#\r\n#######<\r\n#\r\n#\r\n#\r\n#\r\n###V#<\r\nasciiend\r\n  >o-4,-1,#white,ascii\r\n#####_\r\n####/'l###*Honk*\r\n####\\(\r\n#,###\\\\\r\n( ‾‾‾  )\r\n#\\____/\r\n#\r\nasciiend\r\n :?timerGoose < 20\r\n  >o-4,-1,#yellow,ascii\r\n#\r\n#######=\r\n#\r\n#\r\n#\r\n#\r\n###L#L\r\nasciiend\r\n  >o-4,-1,#white,ascii\r\n#####_\r\n####/'l\r\n####\\|\r\n#,###\\\\\r\n( ‾‾‾  )\r\n#\\____/\r\n#\r\nasciiend\r\n :?timerGoose < 25\r\n  >o-4,-1,#yellow,ascii\r\n#\r\n#######=\r\n#\r\n#\r\n#\r\n#\r\n##<###v\r\nasciiend\r\n  >o-4,-1,#white,ascii\r\n#####_\r\n####/'l\r\n####\\\\\r\n#,###\\\\\r\n( ‾‾‾  )\r\n#\\____/\r\n#\r\nasciiend\r\n :?timerGoose < 30\r\n  >o-4,-1,#yellow,ascii\r\n#\r\n##########<\r\n#\r\n#\r\n#\r\n#\r\n###L#L\r\nasciiend\r\n  >o-4,-1,#white,ascii\r\n########_\r\n#######('l##*Honk*\r\n#######//\r\n#,####//\r\n( ‾‾‾  )\r\n#\\____/\r\n#\r\nasciiend\r\n :?timerGoose < 35\r\n  >o-4,-1,#yellow,ascii\r\n#\r\n########<\r\n#\r\n#\r\n#\r\n#\r\n###V#<\r\nasciiend\r\n  >o-4,-1,#white,ascii\r\n######_##########*Honk*\r\n#####('l\r\n######\\\\\r\n#,####//\r\n( ‾‾‾  )\r\n#\\____/\r\n#\r\nasciiend\r\n :?timerGoose < 40\r\n  >o-4,-1,#yellow,ascii\r\n#\r\n#######=\r\n#\r\n#\r\n#\r\n#\r\n###L#L\r\nasciiend\r\n  >o-4,-1,#white,ascii\r\n#####_\r\n####/'l\r\n####\\(\r\n#,###\\\\\r\n( ‾‾‾  )\r\n#\\____/\r\n#\r\nasciiend\r\n :?timerGoose < 45\r\n  >o-4,-1,#yellow,ascii\r\n#\r\n#######=\r\n#\r\n#\r\n#\r\n#\r\n##<###v\r\nasciiend\r\n  >o-4,-1,#white,ascii\r\n#####_\r\n####/'l\r\n####\\(\r\n#,###\\\\\r\n( ‾‾‾  )\r\n#\\____/\r\n#\r\nasciiend\r\n :?timerGoose < 50\r\n  >o-4,-1,#yellow,ascii\r\n#\r\n#######=\r\n#\r\n#\r\n#\r\n#\r\n###L#L\r\nasciiend\r\n  >o-4,-1,#white,ascii\r\n#####_\r\n####/'l\r\n####\\(\r\n#,###\\\\\r\n( ‾‾‾  )\r\n#\\____/\r\n#\r\nasciiend\r\n :?timerGoose < 55\r\n  >o-4,-1,#yellow,ascii\r\n#\r\n#######=\r\n#\r\n#\r\n#\r\n#\r\n###V#<\r\nasciiend\r\n  >o-4,-1,#white,ascii\r\n#####_\r\n####/'l\r\n####\\(\r\n#,###\\\\\r\n( ‾‾‾  )\r\n#\\____/\r\n#\r\nasciiend\r\n :?timerGoose < 61\r\n  >o-4,-1,#yellow,ascii\r\n#\r\n#######=\r\n#\r\n#\r\n#\r\n#\r\n###L#L\r\nasciiend\r\n  >o-4,-1,#white,ascii\r\n#####_\r\n####/~l\r\n####\\(\r\n#,###\\\\\r\n( ‾‾‾  )\r\n#\\____/\r\n#\r\nasciiend\r\n\r\n ?timerGoose >= 60\r\n  timerGoose = 0\r\n\r\n\r\n?(ai.paused |\r\n^ai.idle) &\r\n^GooseEat = 0 &\r\n^((foe.distance > 23) |\r\n^((foe = boss) &\r\n^(foe.hp = 0)) |\r\n^(pickup.distance < 23 &\r\n^pickup ! stone &\r\n^pickup ! wood &\r\n^pickup ! tar))\r\n >o-4,-1,#white,ascii\r\n#####_\r\n####/'l\r\n####\\(\r\n#,###\\\\\r\n( ‾‾‾  )\r\n#\\____/\r\n#\r\nasciiend\r\n >o-4,-1,#yellow,ascii\r\n#\r\n#######=\r\n#\r\n#\r\n#\r\n#\r\n###L#L\r\nasciiend\r\n\r\n\r\n?ai.paused &\r\n^!ai.walking &\r\n^foe = boss &\r\n^pickup.distance > 23 &\r\n^GooseEat = 0 &\r\n^foe.hp > 0\r\n >o-4,-1,#white,ascii\r\n#####_\r\n####/òl\r\n####\\(\r\n#,###\\\\\r\n( ‾‾‾  )\r\n#\\____/\r\n#\r\nasciiend\r\n >o-4,-1,#yellow,ascii\r\n#\r\n#######=\r\n#\r\n#\r\n#\r\n#\r\n###L#L\r\nasciiend\r\n >o-4,-1,#red,ascii\r\n#\r\n#####ò\r\nasciiend\r\n\r\n?(foe.distance <= 23 |\r\n^(foe = spawner &\r\n^foe.hp = 0)) &\r\n^GooseEat = 0 &\r\n^pickup.distance > 23\r\n timerGoose = 0\r\n timerGoose2++\r\n ?timerGoose2 <= 2\r\n  >o-6,0,#white,ascii\r\n###_##*HONK*\r\n##( \\\\###_\r\n,.#( \\\\_/ò］\r\n( ‾ ` .,-'\r\n#\\____/##*HONK*\r\n#\r\nasciiend\r\n  >o-6,0,#yellow,ascii\r\n#\r\n#\r\n###########<\r\n#\r\n#\r\n#\r\nasciiend\r\n :\r\n  >o-6,-1,#white,ascii\r\n###########*HONK*\r\n#\r\n#########_\r\n,.(‾,\\\\_/ò］\r\n((_/` .,-'\r\n#\\____/\r\n#\r\nasciiend\r\n  >o-6,0,#yellow,ascii\r\n#\r\n#\r\n###########=\r\n#\r\n#\r\n#\r\nasciiend\r\n ?timerGoose2 >= 6\r\n  timerGoose2 = 0\r\n\r\n ?ai.walking\r\n  timerGoose3++\r\n  ?timerGoose3 = 0 |\r\n  ^timerGoose3 = 1 |\r\n  ^timerGoose3 = 2 |\r\n  ^timerGoose3 = 3\r\n   >o-5,5,#yellow,ascii\r\n#<###v\r\nasciiend\r\n  ?timerGoose3 = 4 |\r\n  ^timerGoose3 = 5 |\r\n  ^timerGoose3 = 6 |\r\n  ^timerGoose3 = 7\r\n   >o-5,5,#yellow,ascii\r\n##V#<\r\nasciiend\r\n ?!ai.walking\r\n  timerGoose3++\r\n  ?timerGoose3 = 0 |\r\n  ^timerGoose3 = 1 |\r\n  ^timerGoose3 = 2 |\r\n  ^timerGoose3 = 3\r\n   >o-5,5,#yellow,ascii\r\n##L#L\r\nasciiend\r\n  ?timerGoose3 = 4 |\r\n  ^timerGoose3 = 5 |\r\n  ^timerGoose3 = 6 |\r\n  ^timerGoose3 = 7\r\n   >o-5,5,#yellow,ascii\r\n##V#v\r\nasciiend\r\n ?timerGoose3 >= 8\r\n  timerGoose3 = 0"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/StonePhone.txt" - Parse error: Failed to parse completely. Remaining: "= #ff227a\r\nvar hatColor = #333388\r\nvar mushColor_ = #ffaaaa\r\n\r\n\r\n// Ui Elements\r\n\r\nvar pPanel\r\nvar CosmeticsApp\r\nvar CosmeticsPanel\r\nvar sleepSH\r\nvar wavyS\r\nvar santahat\r\nvar chefhat\r\nvar mushhat\r\nvar UIsApp\r\nvar PetsPanel\r\nvar petpanda\r\nvar legsturkeypet\r\nvar tarpusher\r\nvar petsnowman\r\nvar StatsApp\r\nvar StatsPanel\r\nvar SettingsApp\r\nvar SettingsPanel\r\nvar scarfC\r\nvar hatColorC\r\nvar styleTr\r\nvar styleNC\r\nvar sChange\r\nvar resetXY\r\n\r\nvar flipflop_cell = false\r\nvar flipflop_cosm = false\r\nvar flipflop_ssh = false\r\nvar flipflop_ws = false\r\nvar flipflop_sh = false\r\nvar flipflop_ch = false\r\nvar flipflop_mhH = false\r\nvar flipflop_pets = false\r\nvar flipflop_pp = false\r\nvar flipflop_ltp = false\r\nvar flipflop_tp = false\r\nvar flipflop_ps = false\r\nvar flipflop_stats = false\r\nvar flipflop_settings = false\r\nvar flipflop_styleTr = true\r\n\r\nvar xi = storage.get(＂xStone＂, 5)\r\nvar yi = storage.get(＂yStone＂, 6)\r\n?totaltime = 1\r\n  pPanel = Ui.AddPanel()\r\n  pPanel.w = 21\r\n  pPanel.h = 19\r\n  pPanel.dock = top_left\r\n  pPanel.anchor = top_left\r\n\r\n  CosmeticsApp=Ui.AddButton()\r\n  CosmeticsApp.w = 7\r\n  CosmeticsApp.h = 4\r\n  CosmeticsApp.text = ＂＂\r\n  CosmeticsApp.x = -4\r\n  CosmeticsApp.y = 0\r\n  CosmeticsApp.SetPressed(CosmeticsF)\r\n  pPanel.Add(CosmeticsApp)\r\n\r\n  CosmeticsPanel = Ui.AddPanel()\r\n  CosmeticsPanel.w = 21\r\n  CosmeticsPanel.h = 19\r\n  CosmeticsPanel.dock = top_left\r\n  CosmeticsPanel.anchor = top_left\r\n\r\n  sleepSH = Ui.AddButton()\r\n  sleepSH.w = 17\r\n  sleepSH.h = 3\r\n  sleepSH.dock = top_left\r\n  sleepSH.y = 2\r\n  sleepSH.x = 10\r\n  sleepSH.text = ＂SleepyStonehead＂\r\n  CosmeticsPanel.Add(sleepSH)\r\n\r\n  wavyS = Ui.AddButton()\r\n  wavyS.w = 17\r\n  wavyS.h = 3\r\n  wavyS.dock = top_left\r\n  wavyS.y = 5\r\n  wavyS.x = 10\r\n  wavyS.text = ＂WavyScarf＂\r\n  wavyS.SetPressed(wavySF)\r\n  CosmeticsPanel.Add(wavyS)\r\n\r\n  santahat = Ui.AddButton()\r\n  santahat.w = 17\r\n  santahat.h = 3\r\n  santahat.dock = top_left\r\n  santahat.y = 8\r\n  santahat.x = 10\r\n  santahat.text = ＂SantaHat＂\r\n  santahat.SetPressed(santaHF)\r\n  CosmeticsPanel.Add(santahat)\r\n\r\n  chefhat = Ui.AddButton()\r\n  chefhat.w = 17\r\n  chefhat.h = 3\r\n  chefhat.dock = top_left\r\n  chefhat.y = 11\r\n  chefhat.x = 10\r\n  chefhat.text = ＂ChefHat＂\r\n  chefhat.SetPressed(chefHF)\r\n  CosmeticsPanel.Add(chefhat)\r\n\r\n  mushhat = Ui.AddButton()\r\n  mushhat.w = 17\r\n  mushhat.h = 3\r\n  mushhat.dock = top_left\r\n  mushhat.y = 14\r\n  mushhat.x = 10\r\n  mushhat.text = ＂MushroomHat＂\r\n  mushhat.SetPressed(mushhF)\r\n  CosmeticsPanel.Add(mushhat)\r\n\r\n  UIsApp = Ui.AddButton()\r\n  UIsApp.w = 7\r\n  UIsApp.h = 4\r\n  UIsApp.text = ＂＂\r\n  UIsApp.x = 4\r\n  UIsApp.y = 0\r\n  UIsApp.SetPressed(PetsF)\r\n  pPanel.Add(UIsApp)\r\n\r\n  PetsPanel = Ui.AddPanel()\r\n  PetsPanel.w = 21\r\n  PetsPanel.h = 19\r\n  PetsPanel.dock = top_left\r\n  PetsPanel.anchor = top_left\r\n\r\n  petpanda = Ui.AddButton()\r\n  petpanda.w = 17\r\n  petpanda.h = 3\r\n  petpanda.dock = top_left\r\n  petpanda.y = 2\r\n  petpanda.x = 10\r\n  petpanda.text = ＂PetPanda＂\r\n  petpanda.SetPressed(petpandaF)\r\n  PetsPanel.Add(petpanda)\r\n\r\n  legsturkeypet = Ui.AddButton()\r\n  legsturkeypet.w = 17\r\n  legsturkeypet.h = 3\r\n  legsturkeypet.dock = top_left\r\n  legsturkeypet.y = 5\r\n  legsturkeypet.x = 10\r\n  legsturkeypet.text = ＂LegsTurkeyPet＂\r\n  legsturkeypet.SetPressed(legsturkeypetF)\r\n  PetsPanel.Add(legsturkeypet)\r\n\r\n  tarpusher = Ui.AddButton()\r\n  tarpusher.w = 17\r\n  tarpusher.h = 3\r\n  tarpusher.dock = top_left\r\n  tarpusher.y = 8\r\n  tarpusher.x = 10\r\n  tarpusher.text = ＂TarPusher＂\r\n  tarpusher.SetPressed(tarpusherF)\r\n  PetsPanel.Add(tarpusher)\r\n\r\n  petsnowman = Ui.AddButton()\r\n  petsnowman.w = 17\r\n  petsnowman.h = 3\r\n  petsnowman.dock = top_left\r\n  petsnowman.y = 11\r\n  petsnowman.x = 10\r\n  petsnowman.text = ＂PetSnowman＂\r\n  petsnowman.SetPressed(petsnowmanF)\r\n  PetsPanel.Add(petsnowman)\r\n\r\n  StatsApp = Ui.AddButton()\r\n  StatsApp.w = 7\r\n  StatsApp.h = 4\r\n  StatsApp.text = ＂＂\r\n  StatsApp.x = -4\r\n  StatsApp.y = 5\r\n  pPanel.Add(StatsApp)\r\n  StatsApp.SetPressed(StatsF)\r\n\r\n  StatsPanel = Ui.AddPanel()\r\n  StatsPanel.w = 21\r\n  StatsPanel.h = 19\r\n  StatsPanel.dock = top_left\r\n  StatsPanel.anchor = top_left\r\n\r\n  SettingsApp = Ui.AddButton()\r\n  SettingsApp.w = 7\r\n  SettingsApp.h = 4\r\n  SettingsApp.text = ＂＂\r\n  SettingsApp.x = 4\r\n  SettingsApp.y = 5\r\n  pPanel.Add(SettingsApp)\r\n  SettingsApp.SetPressed(SettingsF)\r\n\r\n  SettingsPanel = Ui.AddPanel()\r\n  SettingsPanel.w = 21\r\n  SettingsPanel.h = 19\r\n  SettingsPanel.dock = top_left\r\n  SettingsPanel.anchor = top_left\r\n  \r\n  scarfC = Ui.AddButton()\r\n  scarfC.w = 17\r\n  scarfC.h = 3\r\n  scarfC.dock = top_left\r\n  scarfC.y = 2\r\n  scarfC.x = 10\r\n  scarfC.text = ＂＂\r\n  scarfC.SetPressed(scarfCF)\r\n  SettingsPanel.Add(scarfC)\r\n\r\n  hatColorC = Ui.AddButton()\r\n  hatColorC.w = 17\r\n  hatColorC.h = 3\r\n  hatColorC.dock = top_left\r\n  hatColorC.y = 5\r\n  hatColorC.x = 10\r\n  hatColorC.text = ＂＂\r\n  hatColorC.SetPressed(hatColorF)\r\n  SettingsPanel.Add(hatColorC)\r\n\r\n  styleTr = Ui.AddButton()\r\n  styleTr.w = 17\r\n  styleTr.h = 3\r\n  styleTr.dock = top_left\r\n  styleTr.y = 9\r\n  styleTr.x = 10\r\n  styleTr.text = ＂Transparent＂\r\n  styleTr.SetPressed(styleTrF)\r\n  SettingsPanel.Add(styleTr)\r\n\r\n  styleNC = Ui.AddButton()\r\n  styleNC.w = 17\r\n  styleNC.h = 3\r\n  styleNC.dock = top_left\r\n  styleNC.y = 12\r\n  styleNC.x = 10\r\n  styleNC.SetPressed(styleNF)\r\n  SettingsPanel.Add(styleNC)\r\n\r\n  resetXY = Ui.AddButton()\r\n  resetXY.w = 17\r\n  resetXY.h = 3\r\n  resetXY.dock = top_left\r\n  resetXY.x = 10\r\n  resetXY.y = 15\r\n  resetXY.text = ＂Reset＂\r\n  resetXY.SetPressed(resetF)\r\n  SettingsPanel.Add(resetXY)\r\n\r\n  sChange = Ui.AddButton()\r\n  sChange.dock = top_left\r\n  sChange.anchor = top_left\r\n  sChange.w = 7\r\n  sChange.h = 3\r\n  sChange.text = ＂ -=- ＂\r\n  sChange.SetPressed(sChangeF)\r\n  sChange.style = -1\r\n\r\npPanel.x = xi\r\npPanel.y = yi\r\n\r\nCosmeticsPanel.x = xi\r\nCosmeticsPanel.y = yi\r\nCosmeticsPanel.color = pPanel.color\r\n\r\nPetsPanel.x = xi\r\nPetsPanel.y = yi\r\nPetsPanel.color = pPanel.color\r\n\r\nStatsPanel.x = xi\r\nStatsPanel.y = yi\r\nStatsPanel.color = pPanel.color\r\n\r\nSettingsPanel.x = xi\r\nSettingsPanel.y = yi\r\nSettingsPanel.color = pPanel.color\r\n\r\nsChange.y = yi+17\r\nsChange.x = xi+7\r\n\r\nvar xi_ = xi\r\nvar yi_ = yi\r\nvar prevXi = 0\r\nvar prevYi = 0\r\nvar delay = 30\r\n?input.x >= xi+2\r\n^& input.x <= xi+20\r\n^& input.y >= yi\r\n^& input.y <= yi+19\r\n^& key = Primary\r\n^& delay >=0\r\n  delay--\r\n  ?delay = 0\r\n    prevXi = input.x\r\n    prevYi = input.y\r\n  ?delay<20\r\n    pPanel.color = #aaffaa\r\n:?delay < 0 & input.y < 26 & input.y >1\r\n^& input.x > 1 & input.x < 91\r\n^& key = Primary\r\n  xi = xi_+(input.x-prevXi)\r\n  yi = yi_+(input.y-prevYi)\r\n  pPanel.color = #77df77\r\n  storage.Set(＂xStone＂, xi)\r\n  storage.Set(＂yStone＂, yi)\r\n:\r\n  delay = 30\r\n  pPanel.color = #ffffff\r\n  storage.Set(＂xStone＂, xi)\r\n  storage.Set(＂yStone＂, yi)\r\n  xi_ = xi\r\n  yi_ = yi\r\n\r\nvar s = -9\r\n?storage.Has(＂SS＂) = false\r\n  storage.Set(＂SS＂, 1)\r\n:?s ! storage.Get(＂SS＂) & s ! -9 & s ! 9\r\n  storage.Set(＂SS＂, s)\r\n\r\nstyleNC.text = ＂Style ＂ + storage.Get(＂SS＂)\r\n\r\n?s = 7\r\n  s = 1\r\n\r\nvar sN = s\r\n\r\nfunc styleTrF()\r\n  flipflop_styleTr =\r\n^!storage.Get(＂flipflopTR＂)\r\n  storage.Set(＂flipflopTR＂, flipflop_styleTr)\r\n\r\n?storage.Get(＂flipflopTR＂) = true\r\n  styleTr.tcolor = #88da88\r\n  ?storage.Get(＂SS＂) > 0\r\n    storage.Set(＂SS＂, storage.Get(＂SS＂)*-1) \r\n:\r\n  styleTr.tcolor = #5a5a5a\r\n  ?storage.Get(＂SS＂) < 0\r\n    storage.Set(＂SS＂, storage.Get(＂SS＂)*-1)\r\n\r\nfunc styleNF()\r\n  ?storage.Get(＂SS＂) = 6 | storage.Get(＂SS＂) =-6\r\n    storage.Set(＂SS＂, 1)\r\n  :?storage.Get(＂SS＂) < 0\r\n    storage.Set(＂SS＂, storage.Get(＂SS＂)-1)\r\n  :\r\n    storage.Incr(＂SS＂)\r\n\r\nfunc sChangeF()\r\n  flipflop_cell = ! flipflop_cell\r\n  flipflop_cosm = false\r\n  flipflop_pets = false\r\n  flipflop_stats = false\r\n  flipflop_settings = false\r\n\r\n\r\npPanel.style = storage.Get(＂SS＂)\r\n\r\nCosmeticsPanel.style = storage.Get(＂SS＂)\r\nPetsPanel.style = storage.Get(＂SS＂)\r\nStatsPanel.style = storage.Get(＂SS＂)\r\nSettingsPanel.style = storage.Get(＂SS＂)\r\n\r\npPanel.visible = flipflop_cell\r\nCosmeticsApp.visible = flipflop_cell\r\nCosmeticsPanel.visible = flipflop_cosm\r\nsleepSH.visible = flipflop_cosm\r\nwavyS.visible = flipflop_cosm\r\nsantahat.visible = flipflop_cosm\r\nchefhat.visible = flipflop_cosm\r\nmushhat.visible = flipflop_cosm\r\nUIsApp.visible = flipflop_cell\r\nPetsPanel.visible = flipflop_pets\r\npetpanda.visible = flipflop_pets\r\nlegsturkeypet.visible = flipflop_pets\r\ntarpusher.visible = flipflop_pets\r\npetsnowman.visible = flipflop_pets\r\nStatsApp.visible = flipflop_cell\r\nStatsPanel.visible = flipflop_stats\r\nSettingsApp.visible = flipflop_cell\r\nSettingsPanel.visible = flipflop_settings\r\nscarfC.visible = flipflop_settings\r\nhatColorC.visible = flipflop_settings\r\nstyleTr.visible = flipflop_settings\r\nstyleNC.visible = flipflop_settings\r\n\r\n\r\n// Hour clock\r\n\r\nvar min\r\nmin = time.minute\r\nvar period\r\nvar hour\r\n\r\n?time.hour < 12\r\n  hour = time.hour\r\n  period = ＂a.m.＂\r\n:?time.hour = 12\r\n  hour = time.hour\r\n  period = ＂p.m.＂\r\n:\r\n  hour = time.hour-12\r\n  period = ＂p.m.＂\r\n\r\nvar nArr = ［ascii\r\n _\r\n| |\r\n|_|\r\nasciiend, ascii\r\n  _\r\n /|\r\n  |\r\nasciiend, ascii\r\n _\r\n _］\r\n［_\r\nasciiend, ascii\r\n _\r\n _］\r\n _］\r\nasciiend, ascii\r\n   \r\n/_|\r\n  |\r\nasciiend, ascii\r\n _\r\n［_\r\n _］\r\nasciiend, ascii\r\n _\r\n|_\r\n|_|\r\nasciiend, ascii\r\n__\r\n _|\r\n  |\r\nasciiend, ascii\r\n _\r\n［_］\r\n［_］\r\nasciiend, ascii\r\n _\r\n［_|\r\n _|\r\nasciiend］\r\n\r\nvar hh = 0\r\nvar hours\r\nhours = ＂＂+(hour/10.0)\r\nvar hArr\r\nhArr = string.Split(hours, ＂,＂)\r\nvar nH\r\nnH = int.Parse(hArr［0］)\r\nvar NH = 0\r\n?string.Size(hours) > 1\r\n  NH = int.Parse(hArr［1］)\r\nvar NHA\r\nNHA = nArr［NH］\r\nvar nHA\r\nnHA = nArr［nH］\r\n\r\nvar mm = 0\r\nvar mins\r\n?min < 1\r\n  mins = ＂0,0＂\r\n:?min < 10\r\n  mins = ＂＂+ (0 + (min/10.0))\r\n:\r\n  mins = ＂＂+ (min/10.0)+＂,0＂\r\nvar mArr\r\nmArr = string.Split(mins,＂,＂)\r\nvar mH\r\nmH = int.Parse(mArr［0］)\r\nvar MH\r\nMH = int.Parse(mArr［1］)\r\nvar MHA\r\nMHA = nArr［MH］\r\nvar mHA\r\nmHA = nArr［mH］\r\n\r\n?totaltime%2 = 0\r\n  hArr.Clear()\r\n  mArr.Clear()\r\n\r\n?flipflop_cell = true\r\n  >`@xi+12@,@yi+1@,@mHA@ \r\n  >`@xi+15@,@yi+1@,@MHA@ \r\n  ?NH = 0 & nH ! 1\r\n    >`@xi+3@,@yi+1@,@NHA@ \r\n    >`@xi+6@,@yi+1@,@nHA@ \r\n  :\r\n    >`@xi+3@,@yi+1@,@nHA@ \r\n    >`@xi+6@,@yi+1@,@NHA@\r\n  >`@xi+10@,@yi+2@,'\\n'\r\n  >`@xi+6@,@yi+4@,   @period@\r\n  ^\\n@time.month@/@time.day@/@time.year@\r\n\r\n  >`@xi+4@,@yi+8@, _◘_ ###( '')\\n\r\n        ^ `-´ ### / /\r\n  >`@xi+5@,@yi+13@,  ▓#####───\\n\r\n         ^▓ ▓#####───\r\n\r\n\r\n// Cosmetics Panel\r\n\r\nfunc CosmeticsF()\r\n  flipflop_cosm = ! flipflop_cosm\r\n  flipflop_cell = false\r\n\r\n?flipflop_cosm = true & !bighead\r\n  >`@xi+2@,@yi+17@,#red,*Activate bighead\r\n\r\n// SleepyStonehead\r\n  // Author: mr doo doo fart (or Cem )\r\n  // v1.0\r\n\r\n?storage.Get(＂flipflopSSH＂) = true\r\n  sleepSH.tcolor = #33ff33\r\n  \r\n  // Hat\r\n  >h-3,-2,@hatColor@,ascii\r\n#____\r\n/____|\r\no\r\nasciiend\r\n\r\n  // Scarf\r\n  >h-2,1,@scarfColor@,ascii\r\n#==:\r\n|\r\nasciiend\r\n\r\n  // Eyes\r\n  >h-2,0,#white,( --)\r\n:\r\n  sleepSH.tcolor = #5a5a5a\r\nsleepSH.SetPressed(sleepSHF)\r\n\r\nfunc sleepSHF()\r\n  flipflop_ssh = !storage.Get(＂flipflopSSH＂)\r\n  storage.Set(＂flipflopSSH＂, flipflop_ssh)\r\n\r\n\r\n// Wavy Scarf\r\n  // Bighead Wavy Scarf animated by electronic\r\n  // Script by Deaymon\r\n  // Edited by Bitty45\r\n\r\n?storage.Get(flipflopWS) = true\r\n  var wavyS_ = import Cosmetics/WavyScarf\r\n  wavyS_.scarfColor = scarfColor\r\n  wavyS_._bighead = bighead\r\n  import Cosmetics/WavyScarf\r\n  wavyS.tcolor = #33ff33\r\n:\r\n  wavyS.tcolor = #5a5a5a\r\n\r\nfunc wavySF()\r\n  flipflop_ws = !storage.Get(flipflopWS)\r\n  storage.Set(flipflopWS, flipflop_ws)\r\n\r\n\r\n// ChefHat\r\n  // by: Fyda\r\n  // edited by bitty45 to allow smallhead\r\n  // small guidance on the smallhat\r\n  // ^art from standardcombo\r\n\r\nvar bigHat = ascii\r\n## _ _ _\r\n##( | | )\r\n###|   |\r\n###╘═══╛\r\nasciiend\r\n\r\nvar smallhat = ascii\r\nCCO\r\n|_|\r\n`#´\r\nasciiend\r\n\r\n?storage.Get(flipflopCH)=true\r\n  ?bighead\r\n    >h-5,-4,@hatColor@,@bigHat@\r\n  :\r\n    >h-1,-1,@hatColor@,@smallhat@\r\n\r\n  chefhat.tcolor = #33ff33\r\n:\r\n  chefhat.tcolor = #5a5a5a\r\n\r\nfunc chefHF()\r\n  flipflop_ch = !storage.Get(flipflopCH)\r\n  storage.Set(flipflopCH, flipflop_ch)\r\n\r\n\r\n// MushroomHat\r\n  // Created by TeumessianSven\r\n\r\n?!bighead\r\n  mushhat.tcolor = #ff3333\r\n  flipflop_mhH = false\r\n:?storage.Get(flipflopMHH) = true\r\n  var mush_ = import Hats/MushroomHat\r\n  mush_.topcolor = hatColor\r\n  import Hats/MushroomHat\r\n  mushhat.tcolor = #33ff33\r\n:\r\n  mushhat.tcolor = #5a5a5a\r\n\r\nfunc mushhF()\r\n  ?bighead\r\n    flipflop_mhH = !storage.Get(flipflopMHH)\r\n    storage.Set(flipflopMHH, flipflop_mhH)\r\n  :\r\n    play smithy_hammer_fail\r\n\r\n\r\n// SantaHat\r\n  // by: link2_thepast, martosss\r\n\r\n?storage.Get(flipflopSH) = true\r\n  import Cosmetics/Hats/SantaHat\r\n  santahat.tcolor = #33ff33\r\n:\r\n  santahat.tcolor = #5a5a5a\r\n\r\nfunc santaHF()\r\n  flipflop_sh = !storage.Get(flipflopSH)\r\n  storage.Set(flipflopSH, flipflop_sh)\r\n\r\n\r\n// Pets Panel\r\n\r\nfunc PetsF()\r\n  flipflop_pets = ! flipflop_pets\r\n  flipflop_cell = false\r\n\r\n// PetPanda\r\n  // by Mind Stone Thief and xx.\r\n\r\n?storage.Get(flipflopPP) = true\r\n  import Pets/Panda\r\n  petpanda.tcolor = #33ff33\r\n:\r\n  petpanda.tcolor = #5a5a5a\r\n\r\nfunc petpandaF()\r\n  flipflop_pp = !storage.Get(flipflopPP)\r\n  storage.Set(flipflopPP, flipflop_pp)\r\n\r\n\r\n// LegsTurkeyPet\r\n  // by Link2_thepast\r\n\r\n?storage.Get(flipflopLTP) = true\r\n  import Pets/LegsTurkey\r\n  legsturkeypet.tcolor = #33ff33\r\n:\r\n  legsturkeypet.tcolor = #5a5a5a\r\n\r\nfunc legsturkeypetF()\r\n  flipflop_ltp = !storage.Get(flipflopLTP)\r\n  storage.Set(flipflopLTP, flipflop_ltp)\r\n\r\n// TarPusher\r\n  // by: basic.gameplay\r\n\r\n?storage.Get(flipflopTP) = true\r\n  import Pets/TarPusher\r\n  tarpusher.tcolor = #33ff33\r\n:\r\n  tarpusher.tcolor = #5a5a5a\r\n\r\nfunc tarpusherF()\r\n  flipflop_tp = !storage.Get(flipflopTP)\r\n  storage.Set(flipflopTP, flipflop_tp)\r\n\r\n\r\n// PetSnowman\r\n  // by: micahel.g.g\r\n\r\n?storage.Get(flipflopPS) = true\r\n  import Pets/Snowman\r\n  petsnowman.tcolor = #33ff33\r\n:\r\n  petsnowman.tcolor = #5a5a5a\r\n\r\nfunc petsnowmanF()\r\n  flipflop_ps = !storage.Get(flipflopPS)\r\n  storage.Set(flipflopPS, flipflop_ps)\r\n\r\n\r\n// Stats Panel\r\n\r\nvar prevsec = 0\r\nvar storedtime = 0\r\nvar fps = 0\r\n?time.second ! prevsec\r\n fps = (totaltime - storedtime) / \r\n ^ (time.second - prevsec)\r\n prevsec = time.second\r\n storedtime = totaltime\r\n\r\n// BragMeter\r\n  // Made by insult2\r\n\r\nvar bragScore = 0\r\nvar bragImport_ = import UI/BragMeter\r\nbragScore = bragImport_.acgr\r\n\r\n///\r\n\r\nvar RunCount_c = 0\r\n?totaltime = 1\r\n  RunCount_c++\r\n?flipflop_stats = true\r\n  >`@xi+2@,@yi+1@,Brag Score: \r\n^@math.FloorToInt(bragScore)@%\r\n  ?loc.besttime/30>=60\r\n    >`@xi+2@,@yi+3@,@loc.name@ @loc.stars@☆\\n\r\n    ^Best Time: \r\n    ^@(loc.besttime/30)/60@m\r\n    ^@(loc.besttime/30)-60@s\r\n  :?loc = ＂waterfall＂\r\n    >`@xi+2@,@yi+3@,Deadwood Waterfall\r\n    >`@xi+2@,@yi+4@,Best Time: \r\n    ^@loc.besttime/30@s\r\n  :\r\n    >`@xi+2@,@yi+3@,@loc.name@ @loc.stars@☆\r\n    ^\\nBest Time: \r\n    ^@loc.besttime/30@s\r\n  ?totaltime/30>=60\r\n    >`7,11,Total Time: \r\n    ^@(totaltime/30)/60@m\r\n    ^@(totaltime/30)-60@s\r\n  :\r\n    >`@xi+2@,@yi+5@,Total Time: \r\n    ^@totaltime/30@s\r\n  >`@xi+2@,@yi+7@,@fps-1@ FPS\\n\\n\r\n  ^Screen: @screen.i@\\n\r\n  ^Foe Count: @foe.count@\\n\r\n  ^@foe.name@#\\n\r\n  ^Name: @player.name@\\n\r\n  ^Level: \r\n^@(item.GetTreasureLimit()-100)/5@\\n\r\n  ^Run Count: @RunCount_c@\r\n\r\nfunc StatsF()\r\n  flipflop_stats = ! flipflop_stats\r\n  flipflop_cell = false\r\n\r\n\r\n// Settings Panel\r\n\r\nfunc SettingsF()\r\n  flipflop_settings = ! flipflop_settings\r\n  flipflop_cell = false\r\n\r\n?flipflop_settings = true\r\n  >`@xi+5@,@yi+2@,@scarfColor@,ScarfColor\r\n  >`@xi+6@,@yi+5@,@hatColor@,HatColor\r\n\r\n\r\n// Changing Scarf Color\r\n\r\nvar scarfCArr = ［＂#blue＂, ＂#red＂,＂#green＂,\r\n^＂#ff339a＂, ＂#yellow＂, ＂#rainbow＂］\r\n\r\n?!storage.Has(＂scarfCIND＂)\r\n  storage.Set(＂scarfCIND＂, 0)\r\nscarfColor = scarfCArr［storage.Get(＂scarfCIND＂)］\r\n\r\nfunc scarfCF()\r\n  ?storage.Get(＂scarfCIND＂)<scarfCArr.Count()-1\r\n    storage.Incr(＂scarfCIND＂)\r\n  :\r\n    storage.Set(＂scarfCIND＂, 0)\r\n\r\n\r\n// Changing Hat Color\r\n\r\nvar hatColorArr = ［＂#blue＂, ＂#red＂, ＂#green＂,\r\n^＂#ff339a＂, ＂#yellow＂, ＂#rainbow＂］\r\n\r\n?storage.Has(＂hatColorIND＂) = false\r\n  storage.Set(＂hatColorIND＂, 1)\r\n\r\nhatColor =\r\n^ hatColorArr［storage.Get(＂hatColorIND＂)-1］\r\n\r\nfunc hatColorF()\r\n  ?storage.Get(hatColorIND)<hatColorArr.Count()\r\n    storage.Incr(hatColorIND)\r\n  :\r\n    storage.Set(hatColorIND, 1)\r\n\r\n// Reset\r\n\r\nfunc resetF()\r\n  xi = 5\r\n  yi = 6\r\n  flipflop_ssh = false\r\n  storage.Set(＂flipflopSSH＂, false)\r\n\r\n  flipflop_ws = false\r\n  storage.Set(＂flipflopWS＂, false)\r\n\r\n  flipflop_sh = false\r\n  storage.Set(＂flipflopSH＂, false)\r\n\r\n  flipflop_ch = false\r\n  storage.Set(＂flipflopCH＂, false)\r\n\r\n  flipflop_mhH = false\r\n  storage.Set(＂flipflopMHH＂, false)\r\n\r\n  flipflop_pp = false\r\n  storage.Set(＂flipflopPP＂, false)\r\n\r\n  flipflop_ltp = false\r\n  storage.Set(＂flipflopLTP＂, false)\r\n\r\n  flipflop_tp = false\r\n  storage.Set(＂flipflopTP＂, false)\r\n\r\n  flipflop_ps = false\r\n  storage.Set(＂flipflopPS＂, false)\r\n\r\n  flipflop_styleTr = true\r\n  storage.Set(＂flipflopTR＂, true)\r\n\r\n  storage.Delete(＂SS＂)\r\n  storage.Delete(＂scarfCIND＂)\r\n  storage.Delete(＂hatColorIND＂)\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetPanda.txt" - Parse error: Failed to parse completely. Remaining: "= [ascii\r\n#########▄▄▄▄▄▄▄▄▄▄-▄▄▄  _\r\n######▄██████████▀´ `▀██( ▄ \r\n####▄████████████     ▀██▄██\r\n##▄▓▓▓███████████      ▓███o██\r\n##░░████▒▒▓▓▓████     |▒▒████▄\r\n##; `▀▀█▓▓▓██████|   /   ▀▀▀\r\n#/  /##\\   \\#####|  /  \r\n|  |####`   \\####!  `_)\r\n#.__)####`___)####\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄-▄▄▄  _\r\n######▄██████████▀´ `▀██( ▄ \r\n####▄████████████     ▀██▄██\r\n##▄▓▓▓███████████      ▓███o██\r\n##░░████▒▒▓▓▓████     |▒▒████▄\r\n##; `▀▀█▓▓▓██████|   /\\  ▀▀▀\r\n#/  /##\\   \\#####|  /|_)  \r\n|  |####`   \\####!  `\r\n#.__)####`___)####\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄-▄▄▄  _\r\n######▄██████████▀´ `▀██( ▄ \r\n####▄████████████     ▀██▄██\r\n##▄▓▓▓███████████      ▓███o██\r\n##░░████▒▒▓▓▓████     |▒▒████▄\r\n##; `▀▀▓▓▓░██████|   /|  ▀▀▀\r\n##¡  ||  |#######|  |#\\  |\r\n##|  !#|  `######!  \\##|_)\r\n###\\__)#`__)######\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄-▄▄▄  _\r\n######▄██████████▀´ `▀██( ▄ \r\n####▄████████████     ▀██▄██\r\n##▄▓▓▓███████████      ▓███o██\r\n##░░████▒▒▓▓▓████     |▒▒████▄\r\n##; `▀▀▓▓▓░██████|   /\\  ▀▀▀\r\n##¡  |  \\########|  |##\\  |\r\n##\\__)`  \\#######!  \\###. \\\r\n#######\\__)#######\\__)##\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄-▄▄▄  _\r\n######▄██████████▀´ `▀██( ▄ \r\n####▄████████████     ▀██▄██\r\n##▄▓▓▓███████████      ▓███o██\r\n##░░████▒▒▓▓▓████     |▒▒████▄\r\n###█; `▓▓▓░██████|   /|  ▀▀▀\r\n####\\  /#########|  |#\\  |\r\n#####\\__)########/  |##. \\\r\n######\\__)######(._/###\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄-▄▄▄  _\r\n######▄██████████▀´ `▀██( ▄ \r\n####▄████████████     ▀██▄██\r\n##▄▓▓▓██████████       ▓███o██\r\n##░░████▒▒▓▓▓███       ▒▒████▄\r\n###███; `▓▓░███|   _/--- ▀▀▀\r\n####| ¡  |#####/  /#\\  \\ \r\n###/  /\\__)###/  /###|  |\r\n###|__)######(._/#####\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄-▄▄▄  _\r\n######▄██████████▀´ `▀██( ▄ \r\n####▄████████████     ▀██▄██\r\n##▄▓▓▓███████████      ▓███o██\r\n##░░████▒▒▓▓▓███▀    _|▒▒████▄\r\n###████; `▓░████|   /_   ▀▀▀\r\n####/ ¡\\  \\#####|  /  \\ \r\n###/  /#`  `###(._/#|  |\r\n##|__)####\\__)######\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄-▄▄▄  _\r\n######▄██████████▀´ `▀██( ▄ \r\n####▄████████████     ▀██▄██\r\n##▄▓▓▓███████████      ▓███o██\r\n##░░████▒▒▓▓▓████     |▒▒████▄\r\n###████;  `░█████|   /   ▀▀▀\r\n####/ ¡#\\  \\######\\__)  \r\n###/  /##`  |#####|  |\r\n##|__)####\\__)#####\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄  _\r\n######▄███████████▀´ `▀██( ▄ \r\n####▄█████████████     ▀██▄██\r\n##▄▓▓▓████████████      ▓███o██\r\n##░░████▒▒▓▓▓█████       ▒████▄\r\n###███;  `▓░███████__   / ▀▀▀\r\n#####/¡  |#######|  /\\  |  \r\n####/ .\\  \\######\\  | \\__)\r\n###|__)#`__)######\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄  _\r\n######▄███████████▀´ `▀██( ▄ \r\n####▄█████████████     ▀██▄██\r\n##▄▓▓▓████████████      ▓███o██\r\n##░░████▒▒▓▓▓▓▓▓▓██      ▒████▄\r\n###███;  `▓░████████      |▀▀\r\n######¡  |######|  /##\\   /  \r\n#####|_\\  \\#####|  |###\\  \\\r\n########`__)###(._/#####|__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄  _\r\n######▄███████████▀´ `▀██( ▄ \r\n####▄█████████████     ▀██▄██\r\n##▄▓▓▓████████████      ▓███o██\r\n##░░████▒▒▓▓▓▓▓████      ▒████▄\r\n###█; `██▓▒░████████     / ▀▀\r\n###|  !######/  /####|  / \r\n### \\  \\####/  /#####!  \\\r\n#####.__)##(._/#######\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄  _\r\n######▄███████████▀´ `▀██( ▄ \r\n####▄█████████████     ▀██▄██\r\n##▄▓▓▓████████████      ▓███o██\r\n##░░████▒▒▓▓▓█████      ▒▒████▄\r\n##; `▀▀███▓░███████    /   ▀▀\r\n#/  !  \\####|  /####\\  | \r\n#\\  |\\__)###/  /####`  |\r\n##.__)#####(._/#####|__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄  _\r\n######▄███████████▀´ `▀██( ▄ \r\n####▄█████████████     ▀██▄██\r\n##▄▓▓▓████████████      ▓███o██\r\n##░░████▒▒▓▓▓█████     ▒▒▒████▄\r\n##; `▀▀█▓▓▓░██████    /   ▀▀\r\n#/  !`   \\##|  /###\\  | \r\n#|  |##`__)#/  /###|  /\r\n##.__)#####(._/####/_)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄  _\r\n######▄███████████▀´ `▀██( ▄ \r\n####▄█████████████     ▀██▄██\r\n##▄▓▓▓████████████      ▓███o██\r\n##░░████▒▒▓▓▓█████     ▒▒▒████▄\r\n##; `▀▀█▓▓▓░██████    /   ▀▀\r\n#/  !#|   |#|###\\ |  | \r\n#|  |##\\   \\#####\\|  |\r\n##.__)##\\___)#####|__)\r\nasciiend\r\n^]\r\n//turn his head\r\nvar animationFrames = [ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄▄▄\r\n######▄███████████▀´ `▀██████▄_\r\n####▄████████████      ░( )███ )\r\n##▄▓▓▓███████████     ░▒▓▄█████▄\r\n##░░████▒▒▓▓▓████   __.░▒█#███#█▄\r\n##; `▀▀█▓▓▓██████|  \\ /-▀███╩███▀\r\n#/  /##\\   \\#####|  |_)   ▀▄▄▄▀\r\n|  |####`   \\####!  `\r\n#.__)####`___)####\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄▄▄\r\n######▄███████████▀´ `▀██████▄_\r\n####▄████████████      ░( )███ )\r\n##▄▓▓▓███████████     ░▒▓▄█████▄\r\n##░░████▒▒▓▓▓████     .░▒█#███#█▄\r\n##; `▀▀▓▓▓░██████|  ----▀███╩███▀\r\n##¡  ||  |#######|  | \\  |▀▄▄▄▀\r\n##|  !#|  `######!  \\ |__)\r\n###\\__)#`__)######\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄▄▄\r\n######▄███████████▀´ `▀██████▄_\r\n####▄████████████      ░( )███ )\r\n##▄▓▓▓███████████     ░▒▓▄█████▄\r\n##░░████▒▒▓▓▓████     .░▒█#███#█▄\r\n##; `▀▀▓▓▓░██████|  /---▀███╩███▀\r\n##¡  |  \\########|  | #\\  ▀▄▄▄▀\r\n##\\__)`  \\#######!  \\ ##|  |\r\n#######\\__)#######\\__)##\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄▄▄\r\n######▄███████████▀´ `▀██████▄_\r\n####▄████████████      ░( )███ )\r\n##▄▓▓▓███████████     ░▒▓▄█████▄\r\n##░░████▒▒▓▓▓████     .░▒█#███#█▄\r\n###█; `▓▓▓░██████|  /---▀███╩███▀\r\n####\\  /#########|  |##\\  ▀▄▄▄▀\r\n#####\\__)########/  |##|  |\r\n######\\__)######(._/###\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄▄▄\r\n######▄███████████▀´ `▀██████▄_\r\n####▄████████████      ░( )███ )\r\n##▄▓▓▓██████████      ░▒▓▄█████▄\r\n##░░████▒▒▓▓▓███      .░▒█#███#█▄\r\n###███; `▓▓░███|   !----▀███╩███▀\r\n####| ¡  |#####/  /#\\  \\  ▀▄▄▄▀\r\n###/  /\\__)###/  /###|  |\r\n###|__)######(._/#####\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄▄▄\r\n######▄███████████▀´ `▀██████▄_\r\n####▄████████████      ░( )███ )\r\n##▄▓▓▓███████████     ░▒▓▄█████▄\r\n##░░████▒▒▓▓▓███▀     .░▒█#███#█▄\r\n###████; `▓░████   !----▀███╩███▀\r\n####/ ¡\\  \\#####|  /\\  \\  ▀▄▄▄▀\r\n###/  /#`  `###(._/##|  |\r\n##|__)####\\__)#######\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄▄▄\r\n######▄███████████▀´ `▀██████▄_\r\n####▄████████████      ░( )███ )\r\n##▄▓▓▓███████████     ░▒▓▄█████▄\r\n##░░████▒▒▓▓▓████     .░▒█#███#█▄\r\n###████;  `░█████\\  !---▀███╩███▀\r\n####/ ¡#\\  \\######\\__)\\   ▀▄▄▄▀\r\n###/  /##`  |######|  |\r\n##|__)####\\__)######\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄▄▄\r\n######▄███████████▀´ `▀██████▄_\r\n####▄█████████████     ░( )███ )\r\n##▄▓▓▓████████████    ░▒▓▄█████▄\r\n##░░████▒▒▓▓▓█████    .░▒█#███#█▄\r\n###███;  `▓░██████\\  `. ▀███╩███▀\r\n#####/¡  |########||  |   ▀▄▄▄▀\r\n####/ .\\  \\#######\\ \\__)\r\n###|__)#`__)#######\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄▄▄\r\n######▄███████████▀´ `▀██████▄_\r\n####▄█████████████     ░( )███ )\r\n##▄▓▓▓████████████    ░▒▓▄█████▄\r\n##░░████▒▒▓▓▓▓▓▓▓██_  .░▒█#███#█▄\r\n###███;  `▓░████████\\_ \\▀███╩███▀\r\n######¡  |######|  /##\\_  ▀▄▄▄▀\r\n#####|_\\  \\#####|  |####\\  \\\r\n########`__)###(._/######\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄▄▄\r\n######▄███████████▀´ `▀██████▄_\r\n####▄█████████████     ░( )███ )\r\n##▄▓▓▓████████████    ░▒▓▄█████▄\r\n##░░████▒▒▓▓▓▓▓████   .░▒█#███#█▄\r\n###█; `██▓▒░████████_  \\▀███╩███▀\r\n###|  !######/  /####\\  \\ ▀▄▄▄▀\r\n### \\  \\####/  /######!  \\\r\n#####.__)##(._/########\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄▄▄\r\n######▄███████████▀´ `▀██████▄_\r\n####▄█████████████     ░( )███ )\r\n##▄▓▓▓████████████    ░▒▓▄█████▄\r\n##░░████▒▒▓▓▓▓▓███    .░▒█#███#█▄\r\n##; `████▓▒░████████_  \\▀███╩███▀\r\n#/  ! \\######/  /####\\  \\ ▀▄▄▄▀\r\n#\\  |__)####/  /######!  \\\r\n##.__)#####(._/########\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄▄▄\r\n######▄███████████▀´ `▀██████▄_\r\n####▄█████████████     ░( )███ )\r\n##▄▓▓▓████████████    ░▒▓▄█████▄\r\n##░░████▒▒▓▓▓█████_   .░▒█#███#█▄\r\n##; `▀▀███▓░███████   \\ ▀███╩███▀\r\n#/  !  \\####|  /####\\  \\  ▀▄▄▄▀\r\n#\\  |\\__)###/  /######!  \\\r\n##.__)#####(._/########\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄▄▄\r\n######▄███████████▀´ `▀██████▄_\r\n####▄█████████████     ░( )███ )\r\n##▄▓▓▓████████████    ░▒▓▄█████▄\r\n##░░████▒▒▓▓▓█████_   .░▒█#███#█▄\r\n##; `▀▀█▓▓▓░███████|  \\ ▀███╩███▀\r\n#/  !`   \\###|  \\###\\  \\  ▀▄▄▄▀\r\n#|  |##`__)###\\__)###!  \\\r\n##.__)################\\__)\r\nasciiend\r\n^,ascii\r\n#########▄▄▄▄▄▄▄▄▄▄▄-▄▄▄▄▄\r\n######▄███████████▀´ `▀██████▄_\r\n####▄████████████      ░( )███ )\r\n##▄▓▓▓███████████     ░▒▓▄█████▄\r\n##░░████▒▒▓▓▓████_    .░▒█#███#█▄\r\n##; `▀▀█▓▓▓░████\\ \\  \\--▀███╩███▀\r\n#/  !#|   |######\\_\\  \\   ▀▄▄▄▀\r\n#|  |##\\   \\#######!  |\r\n##.__)##\\___)#######\\__)\r\nasciiend\r\n^]\r\n//0 : openeye\r\n//1 : blinkeye\r\n//2 : closedeye\r\n//3 : happyeye\r\nvar phiz = [\r\n^ascii\r\no###o\r\nasciiend,\r\n^ascii\r\n=###=\r\nasciiend,\r\n^ascii\r\n ### \r\nasciiend,\r\n^ascii\r\n^###^\r\nasciiend]\r\n  \r\nvar count = animationFrames.Count()\r\nvar frame = 0\r\nvar phizFrame = 0\r\n\r\nvar minDistance = 38 //minimum distance\r\nvar x = pos.x - minDistance\r\nvar z = pos.z\r\nvar side = true\r\nvar speed = 0\r\nvar t = 0\r\nvar phizTimer = 0\r\n\r\n\r\nfunc PlayAnimation()\r\n  // target location\r\n  var d = pos.x - minDistance\r\n\r\n  //setup outset position\r\n  ?loc.loop | (time = 1 & loc ! rocky)\r\n    x = d\r\n    z = pos.z\r\n    speed = 0\r\n    t = 0\r\n  \r\n  ?x >= d\r\n    speed = 0\r\n  :?speed ! 1\r\n    ?x < d - 20 // 5 + 5 + 10\r\n      speed = 1\r\n    :?x < d - 10 // 5 + 5\r\n      speed = 2\r\n    :?x < d - 5 // 5\r\n      speed = 3\r\n\r\n\r\n  //speed = count - math.clamp(speed, 0, count - 1)\r\n  ?speed <= 1 | !(time % (speed - 1))\r\n    //move\r\n    ?speed ! 0 & (x < d | z ! pos.z)\r\n      frame = (frame + 1) % count\r\n      ?x < d\r\n        x++\r\n        ?speed = 1\r\n          t = (t + 1) % 30\r\n          ?t = 0\r\n            >`0,5,@t@\r\n            x++\r\n      ?z > pos.z\r\n        z--\r\n      :?z < pos.z\r\n        z++\r\n    : //stop\r\n      frame = 0\r\n      t = 0\r\n    \r\n  ?phizTimer <= 0\r\n    phizTimer = 120 + rng % 30\r\n  phizTimer--\r\n  ?foe = boss & foe.hp <= 0\r\n    phizFrame = 3\r\n    phizTimer = 60\r\n  :?phizFrame = 3\r\n    ?phizTimer = 0\r\n      phizFrame = 1\r\n      phizTimer = 4\r\n  :\r\n    ?phizTimer <= 4\r\n      ?phizTimer = 4 | phizTimer = 0\r\n        phizFrame = 1\r\n      :?phizTimer < 4 & phizTimer > 0\r\n        phizFrame = 2\r\n    :\r\n      phizFrame = 0\r\n  ?frame = 0\r\n    side = !(phizTimer <= 28 | phizFrame = 3)\r\n  var sx = x - pos.x\r\n  ?-sx < 100 //keep in screen\r\n    var sy = z - pos.z + pos.y - 5\r\n    ?side\r\n      var currentframe = animationFramesSide[frame]\r\n      >o@sx@,@sy@,#white,@currentframe@\r\n    :\r\n      var currentframe = animationFrames[frame]\r\n      >o@sx@,@sy@,#white,@currentframe@\r\n\r\n      var eyeposX = sx + 26\r\n      var eyeposY = sy + 4\r\n\t  \r\n      var currentPhizFrame = phiz[phizFrame]\r\n      >o@eyeposX@,@eyeposY@,#white,@currentPhizFrame@\r\nPlayAnimation()"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Turret.txt" - Parse error: Failed to parse completely. Remaining: "╤═］>:\r\nasciiend\r\n\r\n?loc = temple & foe.distance > 30 &\r\n^foe ! boss\r\n equipR cultist mask\r\n\r\n?loc = temple & foe.distance < 30 &\r\n^foe ! boss\r\n loadout 1\r\n\r\n?foe.state = 115 &\r\n^foe.time >= 50 &\r\n^foe = perfected\r\n equipR mind stone\r\n\r\n?mount = 3 &\r\n^ai.walking\r\n play bomb_cart_move 100\r\n\r\n?mount = 3 &\r\n^ai.walking &\r\n^item.left = trisk |\r\n^mount = 3 &\r\n^ai.walking &\r\n^item.right = trisk\r\n play bomb_cart_move 250\r\n\r\n?foe.damage > hp &\r\n^mount = 3\r\n play bomb_cart_fuse\r\n\r\n?mount = 3 &\r\n^loc ! uulaa_shop\r\n >`0,10,ascii\r\n######§\r\n######│\r\n######│\r\n(‾‾‾‾‾‾‾)\r\n#‾`———´‾\r\nasciiend\r\n\r\n?mount = 3 &\r\n^item.left.state <= 1 &\r\n^loc ! uulaa_shop\r\n >`2,10,#white,ascii\r\n##O\r\n#/|\r\n#/#\\\r\nasciiend\r\n\r\n?mount = 3 &\r\n^item.left.state > 1\r\n >`2,10,#white,ascii\r\n##O/\r\n##|\r\n#/#\\\r\nasciiend\r\n\r\n?mount = 3 &\r\n^item.right.state = 1 &\r\n^loc ! uulaa_shop\r\n >`2,10,#white,ascii\r\n##O\r\n##|v\r\n#/#\\\r\nasciiend\r\n\r\n?mount = 3 &\r\n^item.right.state > 1 &\r\n^item.left.state > 1\r\n >`2,10,#white,ascii\r\n##O_\r\n##|‾\r\n#/#\\\r\nasciiend\r\n\r\n?mount = 3 &\r\n^item.right.state > 1\r\n >`2,10,#white,ascii\r\n##O#\r\n##|‾\r\n#/#\\\r\nasciiend\r\n\r\n?mount = 3 &\r\n^buffs.string = berserk\r\n >`2,10,#white,ascii\r\n##ò>\r\n# |‾\r\n#/#\\\r\nasciiend\r\n\r\n?mount = 3 &\r\n^ai.walking &\r\n^time % 30 > 10 &\r\n^time % 30 < 17\r\n >`3,12,#white,ascii\r\n >\r\nasciiend\r\n\r\n?mount = 3 &\r\n^ai.walking &\r\n^time % 30 >= 17\r\n >`3,12,#white,ascii\r\n \\\r\nasciiend\r\n\r\n?mount = 3 &\r\n^ai.walking &\r\n^time % 30 <= 5\r\n >`3,12,#white,ascii\r\n/_\r\nasciiend\r\n\r\n?mount = 3\r\n >o-1,1,#white,ascii\r\n.\r\n╧═╤═］>\r\n#/|\\\r\n°#o#°\r\nasciiend\r\n\r\n?mount = 3 &\r\n^buffs.string = smite &\r\n^item.left.state ! 3\r\n >o1,1,#white,ascii\r\n__\r\n╪\r\nasciiend\r\n\r\n?mount = 3 &\r\n^buffs.string = smite &\r\n^item.left.state = 3 &\r\n^item.left = socketed\r\n play bearer_attack_hit 100\r\n >o0,1,#white,ascii\r\n__\r\n#╪\r\nasciiend\r\n\r\n?mount = 3 &\r\n^item.right = trisk |\r\n^mount = 3 &\r\n^item.left = trisk\r\n >o-1,4,#cyan,ascii\r\n°#o#°\r\nasciiend\r\n\r\n?mount = 3 &\r\n^item.left.state = 2 |\r\n^mount = 3 &\r\n^item.left.state = 4\r\n >o4,2,#white,ascii\r\n—>\r\nasciiend\r\n\r\n?mount = 3 &\r\n^item.left.state = 3\r\n play sword_hit 110\r\n >o4,2,#white,ascii\r\n——>\r\nasciiend\r\n\r\n?mount = 3 &\r\n^buffs.string = vampiric\r\n >o4,2,#red,ascii\r\n♥\r\nasciiend\r\n\r\n?mount = 3 &\r\n^item.left.state = 2 &\r\n^buffs.string = vampiric |\r\n^mount = 3 &\r\n^item.left.state = 4 &\r\n^buffs.string = vampiric\r\n >o4,2,#red,ascii\r\n~♥\r\nasciiend\r\n\r\n?mount = 3 &\r\n^item.left.state = 3 &\r\n^buffs.string = vampiric\r\n play life_gain 110\r\n >o4,2,#red,ascii\r\n~~♥\r\nasciiend\r\n\r\n?mount = 3 &\r\n^item.right.state = 2\r\n >o-1,1,#red,ascii\r\n.\r\nasciiend\r\n\r\n?mount = 3 &\r\n^item.right.state = 2 &\r\n^item.right.time < 7\r\n >o-2,-1,#red,ascii\r\n#.\r\n`'´\r\nasciiend\r\n\r\n?mount = 3 &\r\n^item.right.state = 3\r\n play bomb_cart_explosion 75\r\n >f0,0,#red,ascii\r\n#.-.\r\n(   )\r\n#`-´\r\nasciiend\r\n\r\n?mount = 3 &\r\n^item.right.state = 4\r\n >f1,0,#red,ascii\r\n#_\r\n(_)\r\nasciiend\r\n\r\n?mount = 3 &\r\n^item.left = fire talisman |\r\n^mount = 3 &\r\n^item.right = fire talisman\r\n >o-2,2,#yellow,ascii\r\ni\r\nφ\r\n'\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/AuroraBorealis.txt" - Parse error: Failed to parse completely. Remaining: "= []\r\nvar RGB\r\nvar R\r\nvar G\r\nvar B\r\nvar YOffset = [1,2,3,4,4,5,5,6,6,6,7,7,7,7,7,7,6,6,6,5,5,4,4,3,2,1,0,-1,-2,-3,-4,-4,-5,-5,-6,-6,-6,-7,-7,-7,-7,-7,-7,-6,-6,-6,-5,-5,-4,-4,-3,-2,-1,0]\r\nvar YMod = YOffset.Count()\r\nvar RGB_Fade\r\nvar MotherXOffset = 0\r\nvar dx = 4\r\n\r\nfunc SinWave(Offset,Yset)\r\n  return 128 * math.sin((2 * pi * Yset) / ColourLoop + Offset) + 128\r\n\r\nvar CanvasListA = []\r\nvar CanvasListB = []\r\nvar Wave_MotherPanel\r\nvar StyleInvisible = ui.AddStyle(\"#########\")\r\n\r\nfunc MakeCanvas(UI,X)\r\n  UI.blend = divide\r\n  UI.w = 3\r\n  UI.h = BarHeight\r\n  UI.x = X\r\n  UI.y = 99\r\n  UI.dock = top_left\r\n  Wave_MotherPanel.Add(UI)\r\n  return UI\r\nvar c\r\nfunc WaveBase()\r\n  SetColours.Clear()\r\n  CanvasListA.Clear()\r\n  CanvasListB.Clear()\r\n  MotherXOffset = 0\r\n  Wave_MotherPanel = ui.AddPanel()\r\n  Wave_MotherPanel.style = StyleInvisible\r\n  Wave_MotherPanel.dock = top_left\r\n  Wave_MotherPanel.y = screen.h / 2 + 3\r\n  Wave_MotherPanel.x =  MotherXOffset + 3\r\n\r\nfunc ColourRound(Percent)\r\n return color.FromRGB(math.RoundToInt(R*Percent),math.RoundToInt(G*Percent),math.RoundToInt(B*Percent))\r\n\r\nvar ScreenW = screen.w\r\nfunc Canvas(UI,X,Y,BG)\r\n  UI.x = X\r\n  UI.y = Y\r\n  UI.w = ScreenW\r\n  UI.h = 1\r\n  UI.blend = add\r\n  UI.dock = top_left\r\n  UI.anchor = top_left\r\n  UI.SetFG(#000000)\r\n  UI.SetBG(BG)\r\n  return UI\r\n\r\nvar Bar_MotherPanel\r\nvar RockyBGSlopeOffsets = [46, 44, 43, 39, 37, 34, 31, 27, 23, 18, 13]\r\nvar ValidLoc = false\r\nvar LocOffset = CheckLoc()\r\nfunc CheckLoc()\r\n  ?loc = \"icy\"\r\n    ValidLoc = true\r\n    return 3\r\n  ?loc = \"rocky\"\r\n    ValidLoc = true\r\n    return -3\r\n  ?loc = \"bridge\"\r\n    ValidLoc = true\r\n    return 1\r\n\r\nfunc Bars()\r\n  var Max = screen.h/2+LocOffset\r\n  for a = 0..Max\r\n    var Fade = math.Max(0,2*(5+a-Max))\r\n    R = SinWave(0, a+20) / (30+Fade)\r\n    G = SinWave(2 * pi / 2, a+20) / (15+Fade)\r\n    B = SinWave(-0.5 * pi / 2, a+20) / (15+Fade)\r\n    RGB = ColourRound(1)\r\n    var Z = Canvas(ui.AddCanvas(),0,a,RGB)\r\n\r\n  Bar_MotherPanel = ui.AddPanel()\r\n  Bar_MotherPanel.style = StyleInvisible\r\n  Bar_MotherPanel.anchor = top_left\r\n  Bar_MotherPanel.dock = top_left\r\n  Bar_MotherPanel.y = 0\r\n\r\n  ?loc = \"rocky\"\r\n    ?loc.stars > 15\r\n      RockyXSet = 136 + (loc.stars - 15)*69\r\n    :?loc.stars < 11\r\n      RockyXSet = 136\r\n    :\r\n      RockyXSet = 274\r\n    var YPos = screen.h/2-2\r\n    for a : RockyBGSlopeOffsets\r\n      var Fade = math.Max(0,2*(5+YPos-Max))\r\n      R = SinWave(0, YPos+20) / (30+Fade)\r\n      G = SinWave(2 * pi / 2, YPos+20) / (15+Fade)\r\n      B = SinWave(-0.5 * pi / 2, YPos+20) / (15+Fade)\r\n      RGB = ColourRound(1)\r\n      var Z = Canvas(ui.AddCanvas(),50-a,YPos,RGB)\r\n      Bar_MotherPanel.Add(Z)\r\n      YPos++\r\n\r\n  ?loc = \"bridge\"\r\n    for a = screen.h/2+LocOffset+8..screen.h\r\n      var Fade = math.Max(0,2*(5+a-Max))\r\n      R = SinWave(0, a+20) / (30+Fade)\r\n      G = SinWave(2 * pi / 2, a+20) / (15+Fade)\r\n      B = SinWave(-0.5 * pi / 2, a+20) / (15+Fade)\r\n      RGB = ColourRound(1)\r\n      var Z = Canvas(ui.AddCanvas(),0,a,RGB)\r\n\r\nfunc RngRange(Min, Max)\r\n  var Range = Max - Min + 1\r\n  return rng%Range + Min\r\n\r\nvar MotherYOffset = 0\r\nvar YShiftA = [0,0,5]\r\nvar YShiftB = [0,0,12]\r\nvar RockyXSet = 0\r\n\r\nfunc Wave(List,YShift)\r\n  ?List.Count() < BarLoop\r\n    List.Add(MakeCanvas(ui.AddCanvas(),List.Count()))\r\n    List[List.Count()-1].SetBG(#B4B4B4)\r\n\r\n    for a = 0..3\r\n      var Z = 240-a*10\r\n      RGB = color.FromRGB(Z,Z,Z)\r\n      List[List.Count()-1].SetBG(0,a,RGB)\r\n      List[List.Count()-1].SetBG(0,BarHeight-a-1,RGB)\r\n  :\r\n    ?YShift[1] = 0\r\n      YShift[1] = RngRange(-10, 20)\r\n    :?YShift[1] > 0\r\n      YShift[1] = YShift[1] - 1\r\n      YShift[0] = YShift[0]+1\r\n    :\r\n      YShift[1] = YShift[1]+1\r\n      YShift[0] = math.Max(0,YShift[0]-1)\r\n    ?time % 2 = 0\r\n      List[0].x = BarLoop - Wave_MotherPanel.x + 4\r\n      List[0].y = YShift[2] - YOffset[YShift[0]/dx%YMod] + BarLoop/4 - Wave_MotherPanel.y\r\n    List.Add(List[0])\r\n    List.RemoveAt(0)\r\n\r\nvar Init = true\r\nfunc Run()\r\n  ?totaltime = 1\r\n    Init = true\r\n  ?Init\r\n    Bars()\r\n    WaveBase()\r\n    Init = false\r\n  Wave(CanvasListA,YShiftA)\r\n  Wave(CanvasListB,YShiftB)\r\n\r\n  Wave_MotherPanel.x =  MotherXOffset + 3\r\n  Wave_MotherPanel.y =  MotherYOffset + 3\r\n  ?time % 4 = 0\r\n    MotherYOffset--\r\n  ?time % 2 = 0\r\n    MotherXOffset--\r\n  ?Bar_MotherPanel\r\n    Bar_MotherPanel.x = screen.FromWorldX(RockyXSet)\r\n\r\n?LocOffset ! null\r\n  Run()\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/SleepyStonehead.txt" - Parse error: Failed to parse completely. Remaining: "#____\r\n/____|\r\no\r\nasciiend\r\n\r\n// Scarf\r\n>h-2,1,#blue,ascii\r\n#==:\r\n|\r\nasciiend\r\n\r\n// Eyes\r\n>h-2,0,#white,( --)"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetSpider.txt" - Parse error: Failed to parse completely. Remaining: "a.x = 1 + rng % (screen.w-1)\n//\n\n?time % waittime = 0 & !a.paused\n  a.Play()\n  wait = 0\n//\n\n?wait = 1\n  ?waitcounter < 90\n    waitcounter++\n  :\n    a.Play()\n    wait = 1\n//\n    \n?a.frame = 5 & wait = 0\n  a.Pause()\n  wait = 1\n:?a.frame = 10\n  a.x = 1 + rng % (screen.w-1)\n  waittime = 30 + rng % (171)\n  waitcounter = 0\n//\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/FrogInvasion.txt" - Parse error: Failed to parse completely. Remaining: "(LocXSet[0], LocXSet[1])\r\nvar FrogYOrign = NormRNG(LocYSet[0], LocYSet[1])\r\nvar ResetPosition\r\nvar Frog\r\nvar FrogList = []\r\nvar Init = true\r\nvar InitTime = totaltime\r\nvar SleepTime = 0\r\n\r\nvar Colours = [\r\n^ \"#FF7F7F\",\"#FF3F3F\",\"#FF0000\",\"#BF0000\",\"#7F0000\"\r\n^,\"#FEBE7F\",\"#FD9E3F\",\"#FD7E00\",\"#BE5E00\",\"#7E3F00\"\r\n^,\"#FED97F\",\"#FEC63F\",\"#FEB300\",\"#BE8600\",\"#7F5900\"\r\n^,\"#FEED7F\",\"#FDE43F\",\"#FDDB00\",\"#BEA400\",\"#7E6D00\"\r\n^,\"#FFFF7F\",\"#FFFF3F\",\"#FFFF00\",\"#BFBF00\",\"#7F7F00\"\r\n^,\"#EDFE7F\",\"#E4FD3F\",\"#DBFD00\",\"#A4BE00\",\"#6D7E00\"\r\n^,\"#D9FE7F\",\"#C6FE3F\",\"#B3FE00\",\"#86BE00\",\"#597F00\"\r\n^,\"#BEFE7F\",\"#9EFD3F\",\"#7EFD00\",\"#5EBE00\",\"#3F7E00\"\r\n^,\"#7FFF7F\",\"#3FFF3F\",\"#00FF00\",\"#00BF00\",\"#007F00\"\r\n^,\"#7FFEBE\",\"#3FFD9E\",\"#00FD7E\",\"#00BE5E\",\"#007E3F\"\r\n^,\"#7FFED9\",\"#3FFEC6\",\"#00FEB3\",\"#00BE86\",\"#007F59\"\r\n^,\"#7FFEED\",\"#3FFDE4\",\"#00FDDB\",\"#00BEA4\",\"#007E6D\"\r\n^,\"#7FFFFF\",\"#3FFFFF\",\"#00FFFF\",\"#00BFBF\",\"#007F7F\"\r\n^,\"#7FEDFE\",\"#3FE4FD\",\"#00DBFD\",\"#00A4BE\",\"#006D7E\"\r\n^,\"#7FD9FE\",\"#3FC6FE\",\"#00B3FE\",\"#0086BE\",\"#00597F\"\r\n^,\"#7FBEFE\",\"#3F9EFD\",\"#007EFD\",\"#005EBE\",\"#003F7E\"\r\n^,\"#7F7FFF\",\"#3F3FFF\",\"#0000FF\",\"#0000BF\",\"#00007F\"\r\n^,\"#BE7FFE\",\"#9E3FFD\",\"#7E00FD\",\"#5E00BE\",\"#3F007E\"\r\n^,\"#D97FFE\",\"#C63FFE\",\"#B300FE\",\"#8600BE\",\"#59007F\"\r\n^,\"#ED7FFE\",\"#E43FFD\",\"#DB00FD\",\"#A400BE\",\"#6D007E\"\r\n^,\"#FF7FFF\",\"#FF3FFF\",\"#FF00FF\",\"#BF00BF\",\"#7F007F\"\r\n^,\"#FE7FED\",\"#FD3FE4\",\"#FD00DB\",\"#BE00A4\",\"#7E006D\"\r\n^,\"#FE7FD9\",\"#FE3FC6\",\"#FE00B3\",\"#BE0086\",\"#7F0059\"\r\n^,\"#FE7FBE\",\"#FD3F9E\",\"#FD007E\",\"#BE005E\",\"#7E003F\"]\r\n\r\nfunc StartUp()\r\n  Init = false\r\n  Frog = ui.AddAnim(FrogJump)\r\n  Frog.duration = 20\r\n  Frog.loop = false\r\n  Frog.gamePause = true\r\n  Frog.anchor = top_left\r\n  Frog.dock = top_left\r\n  FrogXPosition = FrogXOrign\r\n  FrogYPosition = FrogYOrign\r\n  Frog.y = FrogYPosition\r\n  ResetPosition = true\r\n  ?TurnTheFrogsGay\r\n    Frog.color = Colours[NormRNG(0, 119)]\r\n    //Frog.color = Colours2[NormRNG(0, 167)]\r\n\r\nfunc HeavyBiasRNG(HomePos, CurrentPos, Min, Max)\r\n  var Range = Max - Min\r\n  var Rand = (rngf * rngf * rngf)\r\n  ?CurrentPos > HomePos\r\n    return math.FloorToInt((1 - Rand )* Range) + Min\r\n  :\r\n    return math.FloorToInt(Rand * Range) + Min\r\n\r\nfunc BiasRNG(HomePos, CurrentPos, Min, Max)\r\n  var Range = Max - Min\r\n  var Rand = (rngf * rngf)\r\n  ?CurrentPos > HomePos\r\n    return math.FloorToInt((1 - Rand )* Range) + Min\r\n  :\r\n    return math.FloorToInt(Rand * Range) + Min\r\n\r\nfunc NormRNG(Min, Max)\r\n  var Range = Max - Min\r\n  return math.FloorToInt(Range * rngf) + Min\r\n\r\nfunc Run(that)\r\n  TurnTheFrogsGay = that.TurnTheFrogsGay\r\n  ?Init\r\n    StartUp()\r\n\r\n  ?FrogXPosition < pos.x - 70\r\n    FrogXPosition += NormRNG(150, 250)\r\n    FrogXOrign = FrogXPosition\r\n    FrogYOrign = NormRNG(LocYSet[0], LocYSet[1])\r\n\r\n  ?Frog.playing\r\n    SleepTime = 0\r\n    ?FrogYDestination ! 0\r\n      ?time % (20/FrogYDestination) = 0\r\n        ?FrogYDestination > 0 \r\n          FrogYPosition--\r\n        :\r\n          FrogYPosition++\r\n        Frog.y = FrogYPosition\r\n    ?FrogXDestination ! 0\r\n      ?time % (20/FrogXDestination) = 0\r\n        ?FrogXDestination > 0 \r\n          FrogXPosition--\r\n        :\r\n          FrogXPosition++\r\n  :?rng > 9525\r\n    FrogYDestination = HeavyBiasRNG(FrogYOrign,FrogYPosition,-4,4)\r\n\r\n    ?math.Abs(FrogXPosition - FrogXOrign) < 10\r\n      FrogXDestination = NormRNG(-8,8)\r\n    :?math.Abs(FrogXPosition - FrogXOrign) < 30\r\n      FrogXDestination = BiasRNG(FrogYOrign,FrogYPosition,-8,8)\r\n    :\r\n      FrogXDestination = HeavyBiasRNG(FrogYOrign,FrogYPosition,-8,8)\r\n\r\n    ?FrogXDestination > 0\r\n     ?Frog.flipX = false\r\n        FrogXPosition += 9\r\n      Frog.flipX = true\r\n    :?FrogXDestination < 0\r\n      ?Frog.flipX = true\r\n        FrogXPosition -= 9\r\n      Frog.flipX = false\r\n    Frog.Play()\r\n    ?FrogXPosition < pos.x + 70\r\n      play haunted_gate_point_lost 50\r\n  :\r\n    SleepTime++\r\n    ?SleepTime > 60\r\n      Frog.frame = 0\r\n  Frog.x = screen.FromWorldX(FrogXPosition)\r\n\r\nfunc CheckLocXOffsets()\r\n  ?Location = \"uulaa_shop\" \r\n    return [0,40]\r\n  :?Location = \"waterfall\"\r\n    return [-40,-5]\r\n  :\r\n    return [0,20*NumberOfFrogs]\r\n\r\nfunc CheckLocYOffsets()\r\n  Location = loc\r\n  ?Location = \"waterfall\"\r\n    return [0,5]\r\n  :?Location = \"uulaa_shop\"\r\n    return [5, 15]\r\n  :?Location = \"deadwood_valley\"\r\n    return [8,12]\r\n  :?Location = \"temple\"\r\n    return [18,21]\r\n  :?Location = \"undead_crypt\"\r\n    return [14,21]\r\n  :?Location = \"fungus_forest\"\r\n    return [11,19]\r\n  :?Location = \"caustic_caves\"\r\n    return [13,17]\r\n  :?Location = \"icy_ridge\"\r\n    return [16,21]\r\n  :?Location = \"bronze_mine\"\r\n    return [7,11]\r\n  :?Location = \"rocky_plateau\"\r\n    return [11,16]\r\n  :\r\n    return [5, 15]\r\n\r\n\r\nfunc RunAll()\r\n  ?totaltime = 1\r\n    InitTime = 1\r\n    FrogList.Clear()\r\n  ?totaltime >= InitTime+1\r\n    ?FrogList.Count() < NumberOfFrogs\r\n      for a = FrogList.Count()..NumberOfFrogs - 1\r\n        var TempNew = new Cosmetics/FrogInvasion\r\n        FrogList.Add(TempNew)\r\n    :?FrogList.Count() > NumberOfFrogs\r\n      for a = FrogList.Count()..NumberOfFrogs + 1\r\n        FrogList[0].BasePanel.Recycle()\r\n        FrogList.RemoveAt(0)\r\n  for a : FrogList\r\n    a.Run(this)\r\nRunAll()\r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/CozyCave.txt" - Parse error: Failed to parse completely. Remaining: "=      #333333\r\nvar colorDoor =       #666666\r\nvar colorRock =       #444444\r\nvar colorRockLit =    #666666\r\nvar colorStation =    #aaaaaa\r\nvar colorStationLit = #cccccc\r\nvar colorHighlight =  #ffffff\r\nvar colorPile =       #aaaaaa\r\nvar colorBtn =        #777777\r\n\r\n// item counts for resource pile sizes\r\nvar moon = item.GetCount(\"moon stone\")\r\nvar wands = item.GetCount(\"stone wand +0 *0\")\r\nvar stones = res.stone\r\nvar prune = item.GetCount(\"poison rune +0 *0\")\r\nvar vrune = item.GetCount(\"vigor rune +0 *0\")\r\nvar arune = item.GetCount(\"aether rune +0 *0\")\r\nvar frune = item.GetCount(\"fire rune +0 *0\")\r\nvar irune = item.GetCount(\"ice rune +0 *0\")\r\nvar runes = prune + vrune + arune + frune + irune\r\n\r\n// thresholds for resource pile sizes\r\nvar wandThresh1 = 10\r\nvar wandThresh2 = 200\r\nvar wandThresh3 = 5000\r\nvar wandThresh4 = 10000\r\n\r\nvar stoneThresh1 = 1000\r\nvar stoneThresh2 = 7500\r\nvar stoneThresh3 = 50000\r\nvar stoneThresh4 = 100000\r\n\r\nvar runeThresh1 = 300\r\nvar runeThresh2 = 1000\r\nvar runeThresh3 = 6000\r\n\r\n// fire timers\r\nvar fTick = 0\r\nvar sTick = 0\r\nvar LTick = 0\r\n\r\n// global illumination flag, for animations\r\nvar illuminated = false\r\n\r\n// global \"initialized\" flag\r\nvar initialized = false\r\n\r\n// randomly generated smoke particles\r\nvar smokeChars = []\r\n\r\n\r\n\r\n//- UI COMPONENT DECLARATIONS -\r\n//transparency style\r\nvar stlTransp = ui.AddStyle(\"#########\")\r\n\r\n//UI Component container objects\r\n//  no need to save a reference to child components\r\nvar pnlMain\r\nvar pnlBg\r\nvar pnlStationsPiles\r\nvar pnlFlickerSP\r\nvar pnlFlickerWalls\r\n\r\n//declare graphics strings\r\nvar strFloor\r\nvar strFloor2\r\nvar strFireRock\r\nvar strFireRockLit\r\nvar strDoor\r\nvar strDoorBg\r\nvar strDoorFrameBg\r\nvar strAnvil\r\nvar strAnvilLit\r\nvar strCauldron\r\nvar strCauldronLit\r\nvar strTable\r\nvar strTableLit\r\nvar strBook\r\nvar strBookLit\r\n\r\nvar strURRock\r\nvar strURRockLit\r\nvar strURock\r\nvar strURockLit\r\nvar strULRock\r\nvar strBLRock\r\nvar strBRRock\r\n\r\nvar strPotion\r\nvar strBottle\r\nvar strEmblem\r\nvar strMoondial\r\n\r\nvar strFireB\r\nvar strFireT\r\n\r\nvar arrStrStones\r\nvar arrStrWands\r\nvar arrStrRunes\r\n\r\n//define graphics strings so their values can be used as parameters below\r\nBuildGraphics()\r\n\r\n//UI Component parameters (pos, size, style, etc.)\r\nvar pnlMain_params =        [0,0, screen.w,screen.h, 0]\r\nvar pnlContainer_params =   [0,0, screen.w,screen.h, -1]\r\n\r\nvar txtFloor_params =       [0,screen.h-14, screen.w,13, colorFloor,strFloor]\r\nvar txtFloor2_params =      [5,screen.h-18, screen.w,3, colorFloor,strFloor2]\r\nvar txtURRock_params =      [screen.w-13,0, 14,12, colorRock,strURRock]\r\nvar txtURRockLit_params =   [screen.w-13,0, 14,12, colorRockLit,strURRockLit]\r\nvar txtURock_params =       [screen_hw+3,0, 18,9, colorRock,strURock]\r\nvar txtURockLit_params =    [screen_hw+3,0, 18,9, colorRockLit,strURockLit]\r\nvar txtULRock_params =      [17,0, 12,9, colorRock,strULRock]\r\n\r\nvar txtFireRock_params =    [screen.w-20,10, 6,3, colorRock,strFireRock]\r\nvar txtFireRockLit_params = [screen.w-20,10, 6,3, colorRockLit,strFireRockLit]\r\nvar txtDoor_params =        [7,4, 8,6, colorDoor,strDoor]\r\nvar txtDoorBg_params =      [0,5, 6,2, colorRock,strDoorBg]\r\nvar txtDoorFrameBg_params = [6,5, 1,5, colorStation,strDoorFrameBg]\r\nvar txtAnvil_params =       [screen_hw+4,12, 11,4, colorStation,strAnvil]\r\nvar txtAnvilLit_params =    [screen_hw+4,12, 11,4, colorStationLit,strAnvilLit]\r\nvar txtCauldron_params =    [screen.w-20,16, 11,6, colorStation,strCauldron]\r\nvar txtCauldronLit_params = [screen.w-20,16, 9,1, colorStationLit,strCauldronLit]\r\nvar txtTable_params =       [screen_hw+4,screen.h-9, 12,6, colorStation,strTable]\r\nvar txtTableLit_params =    [screen_hw+4,screen.h-9, 12,3, colorStationLit,strTableLit]\r\nvar txtBook_params =        [screen_hw+13,screen.h-5, 7,5, colorStation,strBook]\r\nvar txtBookLit_params =     [screen_hw+13,screen.h-5, 7,1, colorStationLit,strBookLit]\r\nvar txtPotion_params =      [screen_hw+11,screen.h-8, 2,1, colorHighlight,strPotion]\r\nvar txtBottle_params =      [screen_hw+10,screen.h-9, 4,3, colorHighlight,strBottle]\r\nvar txtEmblem_params =      [screen_hw+16,screen.h-4, 3,1, colorHighlight,strEmblem]\r\nvar txtMoondial_params =    [screen_hw+6,screen.h-7, 3,2, colorHighlight,strMoondial]\r\nvar txtStonesFg_params =    [5,screen.h-12, 11,5, colorPile,\"\"]\r\nvar txtWandsFg_params =     [screen_hw-16,screen.h-7, 12,5, colorPile,\"\"]\r\nvar txtRunesFg_params =     [17,screen.h-14, 14,7, colorPile,\"\"]\r\nvar txtStonesBg_params =    [5,screen.h-12, 11,5, colorRock,\"\" ]\r\nvar txtWandsBg_params =     [screen_hw-16,screen.h-7, 12,5, colorRock,\"\" ]\r\nvar txtRunesBg_params =     [17,screen.h-14, 14,7, colorRock,\"\" ]\r\n\r\nvar txtBLRock_params =      [-1,screen.h-11, 32,11, colorRock,strBLRock]\r\nvar txtBRRock_params =      [screen.w-22,screen.h-9, 23,9, colorRock,strBRRock]\r\n\r\nvar anmFireB_params =       [screen.w-19,11, 4,1, colorHighlight,strFireB,30]\r\nvar anmFireT_params =       [screen.w-18,10, 2,1, colorHighlight,strFireT,20]\r\n\r\nvar btnLeave_params =       [0,4, 15,8, #000000, \"\"]\r\n\r\n\r\n\r\n//- MAIN UPDATE FUNCTION -\r\nUpdate()\r\nfunc Update()\r\n  ?loc = waterfall & !loc.isQuest\r\n    //- FIRST-TICK SETUP -\r\n    ?!initialized\r\n      initialized = true\r\n      \r\n      //change music\r\n      ambient.Stop()\r\n      music.Play(shop)\r\n      \r\n      //assemble UI components\r\n      BuildUI()\r\n\r\n      //create banner\r\n      ui.ShowBanner(te.xt(\"Hovel Home\"))\r\n\r\n    //- MAIN LOOP -\r\n    :\r\n      //raise player above UI components\r\n      disable pause\r\n      draw.Player()\r\n      \r\n      //update\r\n      UpdateFlicker()\r\n      UpdateFire(screen.w-20, 10)\r\n      \r\n      //draw FG elements above player\r\n      DrawDoor(0,4)\r\n      DrawSmoke()\r\n\r\n\r\n\r\n//- HELPER FUNCTIONS -\r\n//set Component size given array of parameters\r\nfunc SizeFromParams(component, params)\r\n  component.x = params[0]\r\n  component.y = params[1]\r\n  component.w = params[2]\r\n  component.h = params[3]\r\n  \r\n  component.anchor = top_left\r\n  component.dock = top_left\r\n\r\n//set Component style given its type and array of parameters\r\nfunc StyleFromParams(type, component, params)\r\n  ?type = 'text'\r\n    component.visible = true\r\n    component.color = params[4]\r\n    component.text = params[5]\r\n\r\n  :?type = 'panel'\r\n    ?params[4] < 0\r\n      component.visible = false\r\n    :\r\n      component.style = params[4]\r\n\r\n  :?type = 'button'\r\n    component.visible = true\r\n    component.tcolor = params[4]\r\n    component.text = params[5]\r\n  \r\n  :?type = 'anim'\r\n    component.visible = true\r\n    component.color = params[4]\r\n    component.duration = params[6]\r\n\r\n//create Panel component\r\nfunc RegisterPanel(parent, params)\r\n  var component = ui.AddPanel()\r\n  SizeFromParams(component, params)\r\n  StyleFromParams('panel', component, params)\r\n  \r\n  parent.Add(component)\r\n  return component\r\n\r\n//create Text component\r\nfunc RegisterText(parent, params)\r\n  var component = ui.AddText()\r\n  component.visible = true\r\n  SizeFromParams(component, params)\r\n  StyleFromParams('text', component, params)\r\n  \r\n  parent.Add(component)\r\n  return component\r\n\r\n//create Text components for displaying a resource pile\r\nfunc RegisterPile(type, parent, fg_params, bg_params)\r\n  fg_params[5] = GetFgPileStr(type)\r\n  bg_params[5] = GetBgPileStr(type)\r\n  \r\n  ?type = 'stone'\r\n    RegisterText(parent, bg_params)\r\n    RegisterText(parent, fg_params)\r\n\r\n  :?type = 'wand'\r\n    RegisterText(parent, bg_params)\r\n    RegisterText(parent, fg_params)\r\n\r\n  :?type = 'rune'\r\n    RegisterText(parent, bg_params)\r\n    RegisterText(parent, fg_params)\r\n\r\n//create Animation component\r\nfunc RegisterAnim(parent, params)\r\n  var component = ui.AddAnim(params[5])\r\n  SizeFromParams(component, params)\r\n  StyleFromParams('anim', component, params)\r\n  component.loop = true\r\n  \r\n  parent.Add(component)\r\n  return component\r\n\r\n//create Button component for SFX\r\nfunc RegisterSFXButton(parent, params, sound)\r\n  params.Emplace(5, \"\")\r\n  \r\n  var component = ui.AddButton()\r\n  SizeFromParams(component, params)\r\n  StyleFromParams('button', component, params)\r\n  component.sound = sound\r\n  component.style = stlTransp\r\n  \r\n  parent.Add(component)\r\n  return component\r\n\r\n//create general-use transparent Button component\r\nfunc RegisterTranspButton(parent, params, callback)\r\n  var component = ui.AddButton()\r\n  SizeFromParams(component, params)\r\n  StyleFromParams('button', component, params)\r\n  component.SetPressed(callback)\r\n  component.style = stlTransp\r\n  \r\n  parent.Add(component)\r\n  return component\r\n\r\n//set visibility of a Component's children\r\nfunc SetVisibility(component, val)\r\n  var count\r\n  count = component.children.Count()\r\n  \r\n  for i = 0 .. count-1\r\n    component.children[i].visible = val\r\n\r\n//determine which pile string should be used, given res amounts\r\nfunc GetFgPileIndex(amt, t1,t2,t3)\r\n  ? amt > t3 | NO_DYN_ITEMS\r\n    return 3\r\n  :?amt > t2\r\n    return 2\r\n  :?amt > t1\r\n    return 1\r\n  return 0\r\n\r\n// convert pile index -> string from array\r\nfunc GetFgPileStr(type)\r\n  ?type = 'stone'\r\n    return arrStrStones[ GetFgPileIndex(stones, stoneThresh1,stoneThresh2,stoneThresh3) ]\r\n\r\n  :?type = 'wand'\r\n    return arrStrWands[ GetFgPileIndex(wands, wandThresh1,wandThresh2,wandThresh3) ]\r\n\r\n  :?type = 'rune'\r\n    return arrStrRunes[ GetFgPileIndex(runes, runeThresh1,runeThresh2,runeThresh3) ]\r\n\r\n//determine which BG pile string should be used (comparisons are simpler than FG)\r\nfunc GetBgPileStr(type)\r\n  ? type = 'stone' & stones > stoneThresh4\r\n    return arrStrStones[4]\r\n  :?type = 'wand' & wands > wandThresh4\r\n    return arrStrWands[4]\r\n  :?type = 'rune' & runes > runeThresh1\r\n    return arrStrRunes[4]\r\n  return \"\"\r\n\r\n//update fire particles and flicker effect\r\nfunc UpdateFire(x,y)\r\n  // update timers\r\n  fTick++\r\n  fTick = fTick % 5\r\n  sTick++\r\n  sTick = sTick % (10 * (rng%2 + 1))\r\n  LTick++\r\n  LTick = LTick % (5 * (rng%2 + 1))\r\n  \r\n  // on fire tick, advance smoke altitude\r\n  ?fTick = 0\r\n    for c : smokeChars\r\n      c[1] = c[1]-1\r\n  \r\n  // on smoke tick, create new smoke particle\r\n  ?sTick = 0\r\n    var sx = x + 2 + (rng % 3)\r\n    smokeChars.Add( [sx, y] )\r\n    \r\n    // pop old smoke particles\r\n    ?smokeChars.Count() > 10\r\n      smokeChars.RemoveAt(0)\r\n  \r\n  // on light tick, flicker lit surfaces\r\n  ?LTick = 0\r\n    illuminated = !illuminated\r\n\r\n//apply flicker to Components under a highlight Panel\r\nfunc UpdateFlicker()\r\n  ?illuminated\r\n    ?!NO_STATIONS_OR_PILES\r\n      SetVisibility(pnlFlickerSP, true)\r\n    SetVisibility(pnlFlickerWalls, true)\r\n  :\r\n    SetVisibility(pnlFlickerSP, false)\r\n    SetVisibility(pnlFlickerWalls, false)\r\n\r\n\r\n\r\n//- DRAWING FUNCTIONS -\r\n//top-level UI constructor\r\nfunc BuildUI()\r\n  //allow extra time during UI setup\r\n  stonescript.SetMaxExecutionTime(250)\r\n  \r\n  //create opaque container Panel to blank out screen\r\n  pnlMain = RegisterPanel(ui.root, pnlMain_params)\r\n\r\n  //create and register child Panels to simplify visibility controls\r\n  //  save reference to allow interaction later\r\n  pnlBg =             RegisterPanel(pnlMain, pnlContainer_params)\r\n  pnlFlickerWalls =   RegisterPanel(pnlMain, pnlContainer_params)\r\n  pnlStationsPiles =  RegisterPanel(pnlMain, pnlContainer_params)\r\n  pnlFlickerSP =      RegisterPanel(pnlMain, pnlContainer_params)\r\n  \r\n  //create and register Text components for the various graphical elements\r\n  //  register components to different panels depending on their visibility conditions\r\n  //  no need to save reference\r\n  RegisterText(pnlBg, txtFloor_params)\r\n  RegisterText(pnlBg, txtFloor2_params)\r\n  RegisterText(pnlBg, txtULRock_params)\r\n  RegisterText(pnlBg, txtDoor_params)\r\n  RegisterText(pnlBg, txtDoorBg_params)\r\n  RegisterText(pnlBg, txtDoorFrameBg_params)\r\n  RegisterText(pnlBg, txtURRock_params)\r\n  RegisterText(pnlBg, txtURock_params)\r\n  RegisterText(pnlBg, txtFireRock_params)\r\n  \r\n  RegisterText(pnlFlickerWalls, txtURRockLit_params)\r\n  RegisterText(pnlFlickerWalls, txtURockLit_params)\r\n  RegisterText(pnlFlickerWalls, txtFireRockLit_params)\r\n  \r\n  RegisterText(pnlStationsPiles, txtAnvil_params)\r\n  RegisterText(pnlStationsPiles, txtCauldron_params)\r\n  RegisterText(pnlStationsPiles, txtTable_params)\r\n  RegisterText(pnlStationsPiles, txtBook_params)\r\n  RegisterText(pnlStationsPiles, txtPotion_params)\r\n  RegisterText(pnlStationsPiles, txtBottle_params)\r\n  RegisterText(pnlStationsPiles, txtEmblem_params)\r\n  \r\n  RegisterPile('stone', pnlStationsPiles, txtStonesFg_params,txtStonesBg_params)\r\n  RegisterPile('wand',  pnlStationsPiles, txtWandsFg_params,txtWandsBg_params)\r\n  RegisterPile('rune',  pnlStationsPiles, txtRunesFg_params,txtRunesBg_params)\r\n  \r\n  ?moon > 0 | NO_DYN_ITEMS\r\n    RegisterText(pnlStationsPiles, txtMoondial_params)\r\n    RegisterSFXButton(pnlStationsPiles, txtMoondial_params, blade_glow)\r\n  \r\n  RegisterText(pnlFlickerSP, txtAnvilLit_params)\r\n  RegisterText(pnlFlickerSP, txtCauldronLit_params)\r\n  RegisterText(pnlFlickerSP, txtTableLit_params)\r\n  RegisterText(pnlFlickerSP, txtBookLit_params)\r\n  \r\n  RegisterText(pnlMain, txtBLRock_params)\r\n  RegisterText(pnlMain, txtBRRock_params)\r\n  \r\n  //create, register, and start Anim components for the flame\r\n  RegisterAnim(pnlMain, anmFireB_params).Play()\r\n  RegisterAnim(pnlMain, anmFireT_params).Play()\r\n  \r\n  //create and register Button components for SFX easter eggs\r\n  RegisterSFXButton(pnlStationsPiles, txtAnvil_params, smithy_hammer_fail)\r\n  RegisterSFXButton(pnlStationsPiles, txtCauldron_params, waterfall_splash)\r\n  RegisterSFXButton(pnlStationsPiles, txtBook_params, booklet_turn_page)\r\n  RegisterSFXButton(pnlStationsPiles, txtBottle_params, key_drop)\r\n  RegisterSFXButton(pnlStationsPiles, txtFireRock_params, torch_cast)\r\n  RegisterSFXButton(pnlStationsPiles, txtStonesFg_params, pickup_stone)\r\n  RegisterSFXButton(pnlStationsPiles, txtWandsFg_params, wand_air_cast)\r\n  RegisterSFXButton(pnlStationsPiles, txtRunesFg_params, treasure_item_cyan)\r\n  \r\n  //create leave button over door\r\n  RegisterTranspButton(pnlBg, btnLeave_params, loc.Leave)\r\n  \r\n  //hide stations & resource piles if setting is checked\r\n  ?NO_STATIONS_OR_PILES\r\n    SetVisibility(pnlStationsPiles, false)\r\n    SetVisibility(pnlFlickerSP, false)\r\n  \r\n  //TODO: revert execution time now that setup is done\r\n  //  reduce function calls or split across several ticks\r\n  //stonescript.SetMaxExecutionTime(100)\r\n\r\n\r\n\r\n//define previously declared graphics strings\r\n//  runs once on startup\r\nfunc BuildGraphics()\r\n  ?loc = waterfall & !loc.isQuest & !initialized\r\n    BuildArt()\r\n    strFloor =  BuildFloor(screen.w, 14)\r\n    strFloor2 = BuildFloor(screen.w-5, 3)\r\n    strPotion = BuildPotion()\r\n    strEmblem = BuildEmblem()\r\n\r\n\r\n\r\n// randomly generate a 'w' x 'h' horizontal floor\r\nfunc BuildFloor(w, h)\r\n  var prev = \"\"\r\n  var f = \"\"\r\n\r\n  for y = 0..h-1\r\n    for x = 0..w-1\r\n      ?(rng % 30) = 0 & (prev ! \"-\")\r\n        f = f + \"-\"\r\n        prev = \"-\"\r\n      :\r\n        f = f + \" \"\r\n        prev = \" \"\r\n    f = f + \"\\n\"\r\n  return f\r\n\r\n\r\n\r\n//randomly select potion contents\r\nfunc BuildPotion()\r\n  var t\r\n  \r\n  var r = rng % 8\r\n  ? r=0\r\n    t = \"o/\"\r\n  :?r=1\r\n    t = \"/`\"\r\n  :?r=2\r\n    t = \"~≈\"\r\n  :?r=3\r\n    t = \".:\"\r\n  :?r=4\r\n    t = \"~:\"\r\n  :?r=5\r\n    t = \"~o\"\r\n  :?r=6\r\n    t = \"o:\"\r\n  :?r=7\r\n    t = \"~/\"\r\n  :\r\n    t = \"  \"\r\n  \r\n  return t\r\n\r\n\r\n\r\n//randomly select book cover\r\nfunc BuildEmblem()\r\n  var t\r\n  var r = rng % 3\r\n  ?  r=0 | r=1\r\n    t = \" Σ \"\r\n  :? r=2\r\n    t = \"(∆)\"\r\n  :\r\n    t = \"   \"\r\n  \r\n  return t\r\n\r\n\r\n\r\n//define most art strings\r\nfunc BuildArt()\r\n  strFireRock = ascii\r\n#.##•\r\nO####o\r\n#o##O\r\nasciiend\r\n\r\n  strFireRockLit = ascii\r\n#.##•\r\nO####o\r\n#o##O\r\nasciiend\r\n\r\n  strDoorBg = ascii\r\n######\r\n######\r\n#####,\r\n###/`#\r\n##´,-.\r\n#####^\r\nasciiend\r\n\r\n  strDoorFrameBg = ascii\r\n:\r\n|\r\n|\r\n|\r\n|\r\nasciiend\r\n\r\n  strDoor = ascii\r\n ,´ ‾ '\r\n;    ` :\r\n╡ ;    │\r\n|   : o|\r\n╡ '    │\r\n|_ , - '\r\nasciiend\r\n\r\n  strAnvil = ascii\r\n_.──────.__\r\n`|      !.´\r\n##)____(\r\n#'──────'\r\nasciiend\r\n\r\n  strAnvilLit = ascii\r\n####────.__\r\n########!.´\r\n#######(\r\n########'\r\nasciiend\r\n\r\n  strCauldron = ascii\r\n##,─────,\r\n#_)‾‾‾‾‾(_\r\n(/       \\)\r\n#\\       /\r\n#/`--;--´\\\r\n#####\r\nasciiend\r\n\r\n  strCauldronLit = ascii\r\n##,─────,\r\nasciiend\r\n\r\n  strTable = ascii\r\n###,───────,\r\n##/       /║\r\n#/       /#║\r\n/       ,\r\n║‾‾‾‾‾‾‾║\r\n║#######║\r\nasciiend\r\n\r\n  strTableLit = ascii\r\n####───##──,\r\n##########/║\r\n###########║\r\nasciiend\r\n\r\n  strBook = ascii\r\n###____\r\n##/   /\r\n#/___//\r\n(≡≡≡≡/\r\n#‾‾‾‾\r\nasciiend\r\n\r\n  strBookLit = ascii\r\n###____\r\nasciiend\r\n  \r\n  strBottle = ascii\r\n#)(\r\n(##)\r\n#‾‾\r\nasciiend\r\n\r\n  strMoondial = ascii\r\n,C.\r\n`-´\r\nasciiend\r\n\r\n  strURRock = ascii\r\n\\  V  \\ , /##|\r\n#`,    v ;###|\r\n##\\    ,´####|\r\n###|  /######|\r\n###|  |######|\r\n##,  ,|######|\r\n#;  : \\######|\r\n/  _;  ´\\####|\r\n ,´ \\    `###|\r\n###########;`|\r\n#######/`;´  |\r\n######; / ^ ;|\r\nasciiend\r\n\r\n  strURRockLit = ascii\r\n#\r\n#\r\n##\\\r\n###|\r\n###|\r\n##,##,\r\n#;##:\r\n/##_;\r\n#,´#\\\r\n#\r\n#######/#;\r\n######;#/\r\nasciiend\r\n\r\n  strURock = ascii\r\n\\' ,\\ V ' ;#\\  v,´\r\n#`'##\\ ,´v###`:/\r\n######`#######'\r\n#\r\n#\r\n#\r\n##############_\r\n###########_.´ `.\r\n#########,´ \\´;  \\\r\nasciiend\r\n\r\n  strURockLit = ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n###############`.\r\n############\\´;##\\\r\nasciiend\r\n\r\n  strULRock = ascii\r\n#\\ ,  V /\r\n, v    ;\r\n#`   ,´\r\n##\\  |\r\n##|  |\r\n#;'  \\   ,\r\n/  `. `-' \\\r\n   _  `\\   `\r\n#,´ \\######^\r\nasciiend\r\n\r\n  strBLRock = ascii\r\n|\\\r\n| `. _\r\n|  ;´ :\r\n|      ‾\\-.\r\n|       ´  `.\r\n|  ,-.       \\ ,-._  ,-.\r\n|     '     .      `/  ;.-,\r\n|     _      \\     ´  ´   \\\r\n|   ;´ \\      `     _     ,`.\r\n|  ,    `,         ; `.      \\\r\n| '    ,´ '       ´    \\   ^  `.\r\nasciiend\r\n\r\n  strBRRock = ascii\r\n###################_##|\r\n#################_; `.|\r\n###############.´     |\r\n##############;       |\r\n#######,##_##(    _   |\r\n#####,´;.´ ',`   ; `. |\r\n###_;           /    \\|\r\n#,´ \\          ;-.    |\r\n/    `.^     .´   \\   |\r\nasciiend\r\n\r\n  strFireB = ascii\r\n#',)\r\n%%\r\n#`.)\r\n%%\r\n(` #\r\n%%\r\n#,')\r\n%%\r\n(.´#\r\n%%\r\n( ´#\r\nasciiend\r\n\r\n  strFireT = ascii\r\n(`\r\n%%\r\n(,\r\n%%\r\n,)\r\n%%\r\n´)\r\nasciiend\r\n\r\n  arrStrStones = [\"\",\r\n^ascii\r\n#\r\n##.\r\n#O8\r\n####o8Oo.\r\n#\r\nasciiend,\r\n^ascii\r\n##o\r\n#.O8\r\n8oOo##o8\r\n####o8OoO.\r\n#\r\nasciiend,\r\n^ascii\r\n#\r\n###8o\r\n##oO8o.\r\n#.O8Ooo8\r\n8oOoo8OoO.\r\nasciiend,\r\n^ascii\r\n#######.\r\n######.O8\r\n#######oO.\r\n########o8o\r\n#\r\nasciiend]\r\n\r\n  arrStrWands = [\"\",\r\n^ascii\r\n#\r\n#\r\n####o\r\n###─o\\###o\r\n########/\r\nasciiend,\r\n^ascii\r\n#\r\n#\r\n######o\r\no####o´\\,\r\n#\\##/-o`o-\r\nasciiend,\r\n^ascii\r\n####o\r\n#o#/o-\r\n##\\`/-o\r\n#/´o|´o\r\no─ |o/´─o\r\nasciiend,\r\n^ascii\r\n#\r\n########o\r\n#######/,|o\r\n#######o─`o\\\r\n#\r\nasciiend]\r\n\r\n  arrStrRunes = [\"\",\r\n^ascii\r\n#\r\n#\r\n####❤φ *❄∞,\r\n###│‾‾'‾‾││\r\n###└─────┘´\r\nasciiend,\r\n^ascii\r\n#\r\n#####❄∞φ❤\r\n####❤φ∞*❄∞,\r\n###│‾‾'‾‾││\r\n###└─────┘´#❤\r\n####∞\r\n######φ\r\nasciiend,\r\n^ascii\r\n#####*❤\r\n#####❄∞φ❤\r\n####❤φ∞*❄∞,\r\n#❤φ│‾‾'‾‾││#\r\n❄φ*└─────┘´φ❤\r\n####∞####∞❄∞φ*\r\n######φ\r\nasciiend,\r\n^ascii\r\n#####__.__\r\n####│`````│\r\nasciiend]\r\n\r\n\r\n\r\n//draw foreground door elements\r\nfunc DrawDoor(x,y)\r\n  //draw fg door frame\r\n  >`@x@,@y@,@colorStation@,ascii\r\n  ,--.\r\n ´\r\n;\r\n|\r\n|\r\n|\r\n|\r\n|\r\nasciiend\r\n\r\n  //draw fg rock\r\n  >`@x@,@y@,@colorRock@,ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#,-.\r\n‾'.#\\\r\nasciiend\r\n\r\n\r\n\r\n//draw dynamic smoke particles\r\nfunc DrawSmoke()\r\n  for c : smokeChars\r\n    var cx = c[0]\r\n    var cy = c[1]\r\n    >`@cx@,@cy@,#aaaaaa,'\r\n\r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Components/Vector.txt" - Parse error: Failed to parse completely. Remaining: "\"[\" + x + \", \" + y + \"]\"\r\n\r\nfunc Add(otherVect)\r\n  x = x + otherVect.x\r\n  y = y + otherVect.y\r\n\r\nfunc Subtract(otherVect)\r\n  x = x - otherVect.x\r\n  y = y - otherVect.y\r\n\r\nfunc GetDistance(otherVect)\r\n  var deltaX = x - otherVect.x\r\n  var deltaY = y - otherVect.y\r\n  var solution = math.Sqrt(math.Pow(deltaX, 2) + math.Pow(deltaY, 2))\r\n  return solution"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Components/OVERHAUL.txt" - Parse error: Failed to parse completely. Remaining: "IRI=φ\r\n?IR=ice\r\n IRE=ice\r\n IRI=❄\r\n?IR=poison\r\n IRE=poison\r\n IRI=∞\r\n?IR=vigor\r\n IRE=vigor\r\n IRI=❤\r\n?IR=aether\r\n IRE=aether\r\n IRI=＂*＂\r\n?IR=stone\r\n IRE=stone\r\n IRI=o\r\n?IL=fire\r\n ILE=fire\r\n ILI=φ\r\n?IL=ice\r\n ILE=ice\r\n ILI=❄\r\n?IL=poison\r\n ILE=poison\r\n ILI=∞\r\n?IL=vigor\r\n ILE=vigor\r\n ILI=❤\r\n?IL=aether\r\n ILE=aether\r\n ILI=＂*＂\r\n?IL=stone\r\n ILE=stone\r\n ILI=o\r\n?IRD = ＂+0 ＂\r\n ICR = #white\r\n?IR = Common\r\n ICR = #cyan\r\n?IR = Rare\r\n ICR = #yellow\r\n?IR = Heroic\r\n ICR = #green\r\n?IR = Epic\r\n ICR = #blue\r\n?IR = Legendary\r\n ICR = #red\r\n?IR = Transcendent\r\n ICR = #rainbow\r\n?IRD = ＂golden＂&\r\n^time%20 <=15\r\n ICR = #e6b000\r\n?IRD = ＂golden＂&\r\n^time%30<=20&\r\n^time%30>15\r\n ICR = #fac61b\r\n?IRD = ＂golden＂&\r\n^time%30<=25&\r\n^time%30>20\r\n ICR = #d9b02b\r\n?IRD = ＂golden＂&\r\n^time%30>25\r\n ICR = #bf9611\r\n?IRD = ＂prismatic＂\r\n ICR = #magenta\r\n?ILD = ＂+0 ＂\r\n ICL = #white\r\n?IL = Common\r\n ICL = #cyan\r\n?IL = Rare\r\n ICL = #yellow\r\n?IL = Heroic\r\n ICL = #green\r\n?IL = Epic\r\n ICL = #blue\r\n?IL = Legendary\r\n ICL = #red\r\n?IL = Transcendent\r\n ICL = #rainbow\r\n?ILD = ＂golden＂&\r\n^time%20 <=15\r\n ICL = #e6b000\r\n?ILD = ＂golden＂&\r\n^time%30<=20&\r\n^time%30>15\r\n ICL = #fac61b\r\n?ILD = ＂golden＂&\r\n^time%30<=25&\r\n^time%30>20\r\n ICL = #d9b02b\r\n?ILD = ＂golden＂&\r\n^time%30>25\r\n ICL = #bf9611\r\n?ILD = ＂prismatic＂\r\n ICL = #magenta\r\n\r\nIRS=item.right.state\r\nILS=item.left.state\r\nIRT=item.right.time\r\nILT=item.left.time\r\n\r\ndisable player\r\n\r\n?Idl=Y\r\n >o0,1,#white,ascii\r\nO\r\n|\r\nasciiend\r\n\r\n?!ai.walking&\r\n^Idl=Y\r\n >o-1,3,#white,ascii\r\n/#\\\r\nasciiend\r\n\r\n?ai.walking &\r\n^time % 15 <= 5&\r\n^Idl=Y\r\n >o-1,3,#white,ascii\r\n/#>\r\nasciiend\r\n\r\n?ai.walking &\r\n^time % 15 > 5 &\r\n^time % 15 <= 10&\r\n^Idl=Y\r\n >o-1,3,#white,ascii\r\n#>\\\r\nasciiend\r\n\r\n?ai.walking &\r\n^time % 15 > 10&\r\n^Idl=Y\r\n >o-1,3,#white,ascii\r\n#X#\r\nasciiend\r\nIdl=Y"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/cColorTetris.txt" - Parse error: Failed to parse completely. Remaining: "= 10     // field width\r\nvar H = 20 + 1 // field height\r\n\r\nvar figure_glyph_a = \"[\" // any ascii symbol\r\nvar figure_glyph_b = \"]\" // [] () {} ██\r\n\r\nvar game_x = screen.w/2 - (W*2 + 18)/2\r\nvar game_y = screen.h/2 - H/2\r\n\r\n?sys.isMobile\r\n  game_x = screen.w/2 - W // center x only by bottle\r\n\r\nvar gui_x = game_x + 2*W + 3\r\nvar gui_y = game_y\r\n\r\nvar figure_x = W/2 - 2\r\nvar figure_y = 0\r\n\r\nvar figure_max_x = 22\r\nvar figure_min_x = -2\r\n\r\nvar figure = 15\r\nvar figure_next = 1\r\n\r\nvar figure_color = 7\r\nvar figure_next_color = 2\r\n\r\nvar clear_line = \"\"\r\nvar full_line = \"\"\r\nvar lower_border = \" \"\r\n\r\nvar figures = []\r\nvar field = []\r\n\r\nvar field_colors = []\r\nvar colors = [#white, #yellow, #cyan, #green, #red, #f80, #blue, #f0f]\r\n\r\nvar button_left = 0\r\nvar button_right = 1\r\nvar button_rotate = 2\r\nvar button_down = 3\r\nvar button_restart = 4\r\nvar button_exit = 5\r\n\r\n// enum\r\nvar x = 0\r\nvar y = 1\r\nvar w = 2\r\nvar h = 3\r\nvar is_pressed = 4\r\nvar key_name = 5\r\nvar icon = 6\r\n\r\nvar buttons = [\r\n  // x, y, w, h, is_pressed, key, icon\r\n  [0, screen.h/2, 11, 5, false, primaryBegin, \"<\"],                 // left\r\n  [11, screen.h/2, 11, 5, false, primaryBegin, \">\"],                // right\r\n  [screen.w-22, screen.h/2, 11, 5, false, primaryBegin, \"O\"],       // rotate\r\n  [screen.w-11, screen.h/2, 11, 5, false, primary, \"v\"],            // down\r\n  [screen.w-21, screen.h - 3, 11, 3, false, primaryEnd, \"restart\"], // restart\r\n  [screen.w-10, screen.h - 3, 10, 3, false, primaryEnd, \"exit\"],    // exit\r\n]\r\n\r\n?sys.isMobile\r\n  // get input from buttons\r\n  for i = 0..5\r\n    ?key = buttons[i][key_name] &\r\n    ^input.x >= buttons[i][x] & input.x < buttons[i][x] + buttons[i][w] &\r\n    ^input.y >= buttons[i][y] & input.y < buttons[i][y] + buttons[i][h]\r\n      buttons[i][is_pressed] = true\r\n    :\r\n      buttons[i][is_pressed] = false\r\n\r\nfunc coutField()\r\n  // field\r\n  for y = 0..H-1\r\n    >`@game_x@,@game_y+y@,#white,|\r\n    >`@game_x+W*2+1@,@game_y+y@,#white,|\r\n\r\n    ?field[y] ! clear_line\r\n      for x = 0..W-1\r\n        ?string.Sub(field[y], x, 1) = figure_glyph_a\r\n          >`@game_x+x*2+1@,@game_y+y@,@colors[field_colors[y*W+x]]@,@figure_glyph_a@@figure_glyph_b@\r\n          \r\n  >`@game_x@,@game_y+H@,#white,@lower_border@\r\n\r\n  // next figure\r\n  >`@gui_x@,@gui_y + 1@,#white,Lines: @lines@\r\n  >`@gui_x@,@gui_y + 2@,#white,Score: @score@\r\n  >`@gui_x@,@gui_y + 3@,#white,Next figure:\r\n\r\n  var render_line = \"\"\r\n  for y = 0..3\r\n    render_line = \"\"\r\n    for x = 0..3\r\n      ?string.Sub(figures[figure_next], y*4+x, 1) = \"@\"\r\n        render_line += figure_glyph_a + figure_glyph_b\r\n      :\r\n        render_line += \"  \"\r\n      \r\n    >`@gui_x@,@gui_y + 4 + y@,@colors[figure_next_color]@,@render_line@\r\n  \r\n  ?sys.isPC | sys.isConsole\r\n    ?is_game_ended\r\n      >`@gui_x@,@gui_y + H - 5@,#yellow,game is ended\r\n      >`@gui_x@,@gui_y + H - 4@,#666,[Z] - restart game\r\n\r\n    // controls\r\n    >`@gui_x@,@gui_y + H - 3@,#666,[A], [D] - move\r\n    >`@gui_x@,@gui_y + H - 2@,#666,[C] - rotate\r\n    >`@gui_x@,@gui_y + H - 1@,#666,[X] - exit\r\n  \r\n  // draw buttons for phones\r\n  ?sys.isMobile\r\n    var pivot_x = 0\r\n    var pivot_y = 0\r\n\r\n    for i = 0..5\r\n      ?!is_game_ended & i = button_restart\r\n        continue\r\n  \r\n      draw.Box(buttons[i][x], buttons[i][y], buttons[i][w], buttons[i][h], #white)\r\n\r\n      pivot_x = buttons[i][x] + (buttons[i][w] - string.Size(buttons[i][icon])) / 2\r\n      pivot_y = buttons[i][y] + buttons[i][h] / 2\r\n\r\n      >`@pivot_x@,@pivot_y@,#white,@buttons[i][icon]@\r\n\r\n  /* debug /\r\n  >`@gui_x@,@gui_y + 10@,#yellow,x, y: @figure_x@, @figure_y@ GX, GY: @game_x@, @game_y@\r\n  >`@gui_x@,@gui_y + 11@,#yellow,figure: @figure@, next: @figure_next@\r\n  >`@gui_x@,@gui_y + 12@,#yellow,totaltime: @totaltime@, \r\n  >`@gui_x@,@gui_y + 13@,#yellow,ticks: @ticks@, upd: @(30 - score/100)@\r\n  \r\n  ?totaltime % 2 = 0\r\n    >`@gui_x@,@gui_y + 14@,#yellow,█\r\n  // */\r\n\r\nfunc setFigure()\r\n  for y = 0..3\r\n    for x = 0..3\r\n      ?string.Sub(figures[figure], x+y*4, 1) = \"@\"\r\n        >`@game_x+figure_x*2+x*2+1@,@game_y+figure_y+y@,@colors[figure_color]@,@figure_glyph_a@@figure_glyph_b@\r\n\r\nfunc setMaxXY()\r\n  // max\r\n  ?[0, 2, 10, 14, 18].Contains(figure)\r\n    figure_max_x = W-3\r\n  : \r\n    figure_max_x = W-4\r\n\r\n  // min\r\n  ?[2, 4, 6, 8, 12, 16].Contains(figure)\r\n    figure_min_x = -2\r\n  :?figure = 1\r\n    figure_min_x = 0\r\n  :\r\n    figure_min_x = -1\r\n\r\n  // x normalization, especially when rotating\r\n  ?figure_x < figure_min_x\r\n    figure_x = figure_min_x\r\n  \r\n  ?figure_x > figure_max_x\r\n    figure_x = figure_max_x\r\n\r\nfunc rotate()\r\n  var figure_heap = figure\r\n  var figure_x_heap = figure_x\r\n  var figure_y_heap = figure_y\r\n  \r\n  //               O  I     S     Z     L            J               T\r\n  var rotations = [0, 2, 1, 4, 3, 6, 5, 10, 7, 8, 9, 14, 11, 12, 13, 18, 15, 16, 17]\r\n  figure = rotations[figure]\r\n\r\n  // if rotate is not possible\r\n  setMaxXY()\r\n  for y = 0..3\r\n    for x = 0..3\r\n      ?string.Sub(figures[figure], x+y*4, 1) = \"@\" & (figure_y+y>H-1 | string.Sub(field[figure_y+y], figure_x+x, 1) = figure_glyph_a)\r\n        figure = figure_heap\r\n        figure_x = figure_x_heap\r\n        figure_y = figure_y_heap\r\n        setMaxXY()\r\n        return\r\n\r\nfunc move(move_direction)\r\n  ?figure_x + move_direction < figure_min_x | figure_x + move_direction > figure_max_x\r\n    return\r\n\r\n  for y = 3..0\r\n    for x = 0..3\r\n      ?string.Sub(figures[figure], x+y*4, 1) = \"@\" & (string.Sub(field[figure_y+y], figure_x+x+move_direction, 1) = figure_glyph_a)\r\n        return\r\n      \r\n  figure_x += move_direction\r\n\r\nfunc checkCollision()\r\n  var figures_id = [0, 1, 3, 5, 7, 11, 15]\r\n  var clip = false\r\n\r\n  for y = 3..0\r\n    for x = 0..3\r\n      ?string.Sub(figures[figure], x+y*4, 1) = \"@\" & (figure_y+y = H-1 | string.Sub(field[figure_y+y+1], figure_x+x, 1) = figure_glyph_a)\r\n        clip = true\r\n        play pickup_bronze\r\n      \r\n        break\r\n  \r\n  ?!clip\r\n    return\r\n  \r\n  for y = 3..0\r\n    for x = 0..3\r\n      // place figure\r\n      ?string.Sub(figures[figure], x+y*4, 1) = \"@\"\r\n        field[figure_y+y] = string.Sub(field[figure_y+y], 0, figure_x+x) + figure_glyph_a + string.Sub(field[figure_y+y], figure_x+x+1)\r\n        field_colors[figure_y*W + y*W + figure_x + x] = figure_color\r\n  \r\n  for y = 3..0\r\n    for x = 0..3\r\n      // if new figure can't be spawned\r\n      ?string.Sub(figures[figure_next], x+y*4, 1) = \"@\" & string.Sub(field[y], W/2 - 2+x, 1) = figure_glyph_a\r\n        is_game_ended = true\r\n        play uulaa_voice\r\n        \r\n        break\r\n  \r\n  figure_x = W/2 - 2\r\n  figure_y = -1\r\n\r\n  figure = figure_next\r\n  figure_color = figure_next_color\r\n\r\n  figure_next = rng % 7\r\n  figure_next_color = figure_next\r\n\r\n  figure_next_color = figure_next_color + 1\r\n  figure_next = figures_id[figure_next]\r\n\r\nfunc checkLines()\r\n  for y = H-1..0\r\n    ?field[y] = full_line\r\n      play quest_stone_jump\r\n\r\n      score += 10\r\n      lines++\r\n      field[y] = clear_line\r\n      \r\n      for yy = y-1..0\r\n        for x = 0..W-1\r\n          field_colors[(yy+1)*W + x] = field_colors[yy*W + x]\r\n        \r\n        field[yy+1] = field[yy]\r\n      \r\n      return\r\n\r\nfunc init()\r\n  // generate figures\r\n  figures.Add(\".....@@..@@.....\") // O\r\n\r\n  figures.Add(\"....@@@@........\") // I\r\n  figures.Add(\"..@...@...@...@.\")\r\n\r\n  figures.Add(\"......@@.@@.....\") // S\r\n  figures.Add(\"..@...@@...@....\")\r\n\r\n  figures.Add(\".....@@...@@....\") // Z\r\n  figures.Add(\"...@..@@..@.....\")\r\n\r\n  figures.Add(\".....@@@.@......\") // L\r\n  figures.Add(\"..@...@...@@....\") \r\n  figures.Add(\"...@.@@@........\") \r\n  figures.Add(\".@@...@...@.....\") \r\n\r\n  figures.Add(\".....@@@...@....\") // J\r\n  figures.Add(\"..@@..@...@.....\") \r\n  figures.Add(\".@...@@@........\") \r\n  figures.Add(\"..@...@..@@.....\")\r\n\r\n  figures.Add(\".....@@@..@.....\") // T\r\n  figures.Add(\"..@...@@..@.....\") \r\n  figures.Add(\"..@..@@@........\") \r\n  figures.Add(\"..@..@@...@.....\")\r\n\r\n  // generate lines\r\n  for x = 0..W-1\r\n    clear_line += \" \"\r\n    full_line += figure_glyph_a\r\n    lower_border += \"--\"\r\n  \r\n  // generate field\r\n  for y = 0..H-1\r\n    field.Add(clear_line)\r\n\r\n  // generate colors\r\n  for xy = 0..W*H - 1\r\n    field_colors.Add(0)\r\n\r\nfunc gameLoop()\r\n  ?key = backBegin | buttons[button_exit][is_pressed] // X\r\n    loc.Leave()\r\n\r\n  ?!is_game_ended\r\n    ?totaltime % (30 - score/100) = 0 | key = down | buttons[button_down][is_pressed] // S\r\n      setMaxXY()\r\n      checkCollision()\r\n      checkLines()\r\n      figure_y++\r\n      ticks++\r\n\r\n      ?ticks % 10 = 0\r\n        score += 1\r\n\r\n    ?key = bumpRBegin | buttons[button_rotate][is_pressed] // C\r\n      rotate()\r\n      play grappling_idle\r\n\r\n    ?key = leftBegin | buttons[button_left][is_pressed] // A\r\n      move(-1)\r\n    \r\n    ?key = rightBegin | buttons[button_right][is_pressed] // D\r\n      move(1)\r\n\r\n  :?key = bumpLEnd | buttons[button_restart][is_pressed] // Z\r\n    is_game_ended = false\r\n    \r\n    score = 0\r\n    ticks = 0\r\n    lines = 0\r\n    \r\n    field.Clear()\r\n    field_colors.Clear()\r\n\r\n    for y = 0..H-1\r\n      field.Add(clear_line)\r\n\r\n    for xy = 0..W*H - 1\r\n      field_colors.Add(0)\r\n\r\n  // update board\r\n  draw.Clear()\r\n  coutField()\r\n  \r\n  ?!is_game_ended\r\n    setFigure()\r\n\r\n?loc.begin\r\n  disable abilities\r\n  disable pause\r\n  disable hud\r\n  disable banner\r\n  disable loadout input\r\n  disable player\r\n\r\n  ambient.Stop()\r\n  init()\r\n:\r\n  gameLoop()\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/cTetris.txt" - Parse error: Failed to parse completely. Remaining: "= 10     // field width\r\nvar H = 20 + 1 // field height\r\n\r\nvar figure_glyph_a = \"[\" // any ascii symbol\r\nvar figure_glyph_b = \"]\" // [] () {} ██\r\n\r\nvar game_x = screen.w/2 - (W*2 + 18)/2\r\nvar game_y = screen.h/2 - H/2\r\n\r\n?sys.isMobile\r\n  game_x = screen.w/2 - W // center x only by bottle\r\n\r\nvar gui_x = game_x + 2*W + 3\r\nvar gui_y = game_y\r\n\r\nvar figure_x = W/2 - 2\r\nvar figure_y = 0\r\n\r\nvar figure_max_x = 22\r\nvar figure_min_x = -2\r\n\r\nvar figure = 15\r\nvar figure_next = 1\r\n\r\nvar clear_line = \"\"\r\nvar full_line = \"\"\r\nvar lower_border = \" \"\r\n\r\nvar figures = []\r\nvar field = []\r\n\r\nvar button_left = 0\r\nvar button_right = 1\r\nvar button_rotate = 2\r\nvar button_down = 3\r\nvar button_restart = 4\r\nvar button_exit = 5\r\n\r\n// enum\r\nvar x = 0\r\nvar y = 1\r\nvar w = 2\r\nvar h = 3\r\nvar is_pressed = 4\r\nvar key_name = 5\r\nvar icon = 6\r\n\r\nvar buttons = [\r\n  // x, y, w, h, is_pressed, key, icon\r\n  [0, screen.h/2, 11, 5, false, primaryBegin, \"<\"],                 // left\r\n  [11, screen.h/2, 11, 5, false, primaryBegin, \">\"],                // right\r\n  [screen.w-22, screen.h/2, 11, 5, false, primaryBegin, \"O\"],       // rotate\r\n  [screen.w-11, screen.h/2, 11, 5, false, primary, \"v\"],            // down\r\n  [screen.w-21, screen.h - 3, 11, 3, false, primaryEnd, \"restart\"], // restart\r\n  [screen.w-10, screen.h - 3, 10, 3, false, primaryEnd, \"exit\"],    // exit\r\n]\r\n\r\n?sys.isMobile\r\n  // get input from buttons\r\n  for i = 0..5\r\n    ?key = buttons[i][key_name] &\r\n    ^input.x >= buttons[i][x] & input.x < buttons[i][x] + buttons[i][w] &\r\n    ^input.y >= buttons[i][y] & input.y < buttons[i][y] + buttons[i][h]\r\n      buttons[i][is_pressed] = true\r\n    :\r\n      buttons[i][is_pressed] = false\r\n\r\nfunc coutField()\r\n  var render_line = \"\"\r\n\r\n  // field\r\n  for y = 0..H-1\r\n    render_line = \"|\"\r\n    \r\n    ?field[y] = clear_line\r\n      render_line += clear_line + clear_line\r\n    :\r\n      for x = 0..W-1\r\n        ?string.Sub(field[y], x, 1) = figure_glyph_a\r\n          render_line += figure_glyph_a + figure_glyph_b\r\n        :\r\n          render_line += \"  \"\r\n\r\n    >`@game_x@,@game_y+y@,#white,@render_line@|\r\n\r\n  >`@game_x@,@game_y+H@,#white,@lower_border@\r\n\r\n  // next figure\r\n  >`@gui_x@,@gui_y + 1@,#white,Lines: @lines@\r\n  >`@gui_x@,@gui_y + 2@,#white,Score: @score@\r\n  >`@gui_x@,@gui_y + 3@,#white,Next figure:\r\n\r\n  for y = 0..3\r\n    render_line = \"\"\r\n    for x = 0..3\r\n      ?string.Sub(figures[figure_next], y*4+x, 1) = \"@\"\r\n        render_line += figure_glyph_a + figure_glyph_b\r\n      :\r\n        render_line += \"  \"\r\n\r\n    >`@gui_x@,@gui_y + 4 + y@,#white,@render_line@\r\n\r\n  ?sys.isPC | sys.isConsole\r\n    ?is_game_ended\r\n      >`@gui_x@,@gui_y + H - 5@,#yellow,game is ended\r\n      >`@gui_x@,@gui_y + H - 4@,#666,[Z] - restart game\r\n\r\n    // controls\r\n    >`@gui_x@,@gui_y + H - 3@,#666,[A], [D] - move\r\n    >`@gui_x@,@gui_y + H - 2@,#666,[C] - rotate\r\n    >`@gui_x@,@gui_y + H - 1@,#666,[X] - exit\r\n  \r\n  // draw buttons for phones\r\n  ?sys.isMobile\r\n    var pivot_x = 0\r\n    var pivot_y = 0\r\n\r\n    for i = 0..5\r\n      ?!is_game_ended & i = button_restart\r\n        continue\r\n  \r\n      draw.Box(buttons[i][x], buttons[i][y], buttons[i][w], buttons[i][h], #white)\r\n\r\n      pivot_x = buttons[i][x] + (buttons[i][w] - string.Size(buttons[i][icon])) / 2\r\n      pivot_y = buttons[i][y] + buttons[i][h] / 2\r\n\r\n      >`@pivot_x@,@pivot_y@,#white,@buttons[i][icon]@\r\n\r\n  /* debug /\r\n  >`@gui_x@,@gui_y + 10@,#yellow,x, y: @figure_x@, @figure_y@ GX, GY: @game_x@, @game_y@\r\n  >`@gui_x@,@gui_y + 11@,#yellow,figure: @figure@, next: @figure_next@\r\n  >`@gui_x@,@gui_y + 12@,#yellow,totaltime: @totaltime@, \r\n  >`@gui_x@,@gui_y + 13@,#yellow,ticks: @ticks@, upd: @(30 - score/100)@\r\n  >`@gui_x@,@gui_y + 14@,#yellow,v @string.Size(buttons[0][icon])@\r\n  \r\n  ?totaltime % 2 = 0\r\n    >`@gui_x@,@gui_y + 14@,#yellow,█\r\n  // */\r\n\r\nfunc setFigure()\r\n  for y = 0..3\r\n    for x = 0..3\r\n      ?string.Sub(figures[figure], x+y*4, 1) = \"@\"\r\n        >`@game_x+figure_x*2+x*2+1@,@game_y+figure_y+y@,#white,@figure_glyph_a@@figure_glyph_b@\r\n\r\nfunc setMaxXY()\r\n  // max\r\n  ?[0, 2, 10, 14, 18].Contains(figure)\r\n    figure_max_x = W-3\r\n  : \r\n    figure_max_x = W-4\r\n\r\n  // min\r\n  ?[2, 4, 6, 8, 12, 16].Contains(figure)\r\n    figure_min_x = -2\r\n  :?figure = 1\r\n    figure_min_x = 0\r\n  :\r\n    figure_min_x = -1\r\n\r\n  // x normalization, especially when rotating\r\n  ?figure_x < figure_min_x\r\n    figure_x = figure_min_x\r\n  \r\n  ?figure_x > figure_max_x\r\n    figure_x = figure_max_x\r\n\r\nfunc rotate()\r\n  var figure_heap = figure\r\n  var figure_x_heap = figure_x\r\n  var figure_y_heap = figure_y\r\n  \r\n  //               O  I     S     Z     L            J               T\r\n  var rotations = [0, 2, 1, 4, 3, 6, 5, 10, 7, 8, 9, 14, 11, 12, 13, 18, 15, 16, 17]\r\n  figure = rotations[figure]\r\n\r\n  // if rotate is not possible\r\n  setMaxXY()\r\n  for y = 0..3\r\n    for x = 0..3\r\n      ?string.Sub(figures[figure], x+y*4, 1) = \"@\" & (figure_y+y>H-1 | string.Sub(field[figure_y+y], figure_x+x, 1) = figure_glyph_a)\r\n        figure = figure_heap\r\n        figure_x = figure_x_heap\r\n        figure_y = figure_y_heap\r\n        setMaxXY()\r\n        return\r\n\r\nfunc move(move_direction)\r\n  ?figure_x + move_direction < figure_min_x | figure_x + move_direction > figure_max_x\r\n    return\r\n\r\n  for y = 0..3\r\n    for x = 0..3\r\n      ?string.Sub(figures[figure], x+y*4, 1) = \"@\" & (string.Sub(field[figure_y+y], figure_x+x+move_direction, 1) = figure_glyph_a)\r\n        return\r\n      \r\n  figure_x += move_direction\r\n\r\nfunc checkCollision()\r\n  var figures_id = [0, 1, 3, 5, 7, 11, 15]\r\n  var clip = false\r\n\r\n  for y = 3..0\r\n    for x = 0..3\r\n      ?string.Sub(figures[figure], x+y*4, 1) = \"@\" & (figure_y+y = H-1 | string.Sub(field[figure_y+y+1], figure_x+x, 1) = figure_glyph_a)\r\n        clip = true\r\n        play pickup_bronze\r\n        \r\n        break\r\n    \r\n  ?!clip\r\n    return\r\n  \r\n  for y = 3..0\r\n    for x = 0..3\r\n      // place figure\r\n      ?string.Sub(figures[figure], x+y*4, 1) = \"@\"\r\n        field[figure_y+y] = string.Sub(field[figure_y+y], 0, figure_x+x) + figure_glyph_a + string.Sub(field[figure_y+y], figure_x+x+1)\r\n  \r\n  for y = 3..0\r\n    for x = 0..3\r\n      // if new figure can't be spawned\r\n      ?string.Sub(figures[figure_next], x+y*4, 1) = \"@\" & string.Sub(field[y], W/2 - 2+x, 1) = figure_glyph_a\r\n        is_game_ended = true\r\n        play uulaa_voice\r\n        \r\n        break\r\n\r\n  figure_x = W/2 - 2\r\n  figure_y = -1\r\n\r\n  figure = figure_next\r\n  figure_next = rng % 7\r\n\r\n  figure_next = figures_id[figure_next]\r\n\r\nfunc checkLines()\r\n  for y = H-1..0\r\n    ?field[y] = full_line\r\n      play quest_stone_jump\r\n\r\n      score += 10\r\n      lines++\r\n      field[y] = clear_line\r\n\r\n      for yy = y-1..0\r\n        field[yy+1] = field[yy]\r\n      \r\n      return\r\n\r\nfunc init()\r\n  // generate figures\r\n  figures.Add(\".....@@..@@.....\") // O\r\n\r\n  figures.Add(\"....@@@@........\") // I\r\n  figures.Add(\"..@...@...@...@.\")\r\n\r\n  figures.Add(\"......@@.@@.....\") // S\r\n  figures.Add(\"..@...@@...@....\")\r\n\r\n  figures.Add(\".....@@...@@....\") // Z\r\n  figures.Add(\"...@..@@..@.....\")\r\n\r\n  figures.Add(\".....@@@.@......\") // L\r\n  figures.Add(\"..@...@...@@....\") \r\n  figures.Add(\"...@.@@@........\") \r\n  figures.Add(\".@@...@...@.....\")\r\n\r\n  figures.Add(\".....@@@...@....\") // J\r\n  figures.Add(\"..@@..@...@.....\") \r\n  figures.Add(\".@...@@@........\") \r\n  figures.Add(\"..@...@..@@.....\")\r\n\r\n  figures.Add(\".....@@@..@.....\") // T\r\n  figures.Add(\"..@...@@..@.....\") \r\n  figures.Add(\"..@..@@@........\") \r\n  figures.Add(\"..@..@@...@.....\")\r\n\r\n  // generate lines\r\n  for x = 0..W-1\r\n    clear_line += \" \"\r\n    full_line += figure_glyph_a\r\n    lower_border += \"--\"\r\n  \r\n  // generate field\r\n  for y = 0..H-1\r\n    field.Add(clear_line)\r\n\r\nfunc gameLoop()\r\n  ?key = backBegin | buttons[button_exit][is_pressed] // X\r\n    loc.Leave()\r\n\r\n  ?!is_game_ended\r\n    ?totaltime % (30 - score/100) = 0 | key = down | buttons[button_down][is_pressed] // S\r\n      setMaxXY()\r\n      checkCollision()\r\n      checkLines()\r\n      figure_y++\r\n      ticks++\r\n\r\n      ?ticks % 10 = 0\r\n        score += 1\r\n\r\n    ?key = bumpRBegin | buttons[button_rotate][is_pressed] // C\r\n      rotate()\r\n      play grappling_idle\r\n\r\n    ?key = leftBegin | buttons[button_left][is_pressed] // A\r\n      move(-1)\r\n    \r\n    ?key = rightBegin | buttons[button_right][is_pressed] // D\r\n      move(1)\r\n\r\n  :?key = bumpLEnd | buttons[button_restart][is_pressed] // Z\r\n    is_game_ended = false\r\n    \r\n    score = 0\r\n    ticks = 0\r\n    lines = 0\r\n    \r\n    field.Clear()\r\n\r\n    for y = 0..H-1\r\n      field.Add(clear_line)\r\n\r\n  // update board\r\n  draw.Clear()\r\n  coutField()\r\n\r\n  ?!is_game_ended \r\n    setFigure()\r\n\r\n?loc.begin\r\n  disable abilities\r\n  disable pause\r\n  disable hud\r\n  disable banner\r\n  disable loadout input\r\n  disable player\r\n\r\n  ambient.Stop()\r\n  init()\r\n:\r\n  gameLoop()\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Asteroids.txt" - Parse error: Failed to parse completely. Remaining: "= \"v2.1.0\"\r\n\r\n// INSTRUCTIONS\r\n// ============\r\n// 1. Backup your mindstone code first (if copypasting).\r\n// 2. Either\r\n//    (A) Copypaste this entire file into your mindstone, OR\r\n//    (B) Type 'import Games/Asteroids' (without the quotes)\r\n//        into your mindstone.          \r\n// 3. Go to Deadwood Waterfall.\r\n\r\nvar abs = math.Abs\r\nvar pow = math.Pow\r\n\r\nvar scrw = screen.w\r\nvar scrh = screen.h\r\nvar x_max = scrw * 100\r\nvar y_max = scrh * 100\r\nvar lang = te.language\r\n\r\nvar logoW = 56\r\nvar logoX = (scrw - logoW)/2\r\nvar logoY = 6\r\nvar logoSprite\r\nvar versionX = logoX + logoW - string.Size(version) - 1\r\nvar versionY = 12\r\nvar controlsStr = te.xt(\"tid_button_input\")\r\nvar controlsX = 5 - string.Size(controlsStr) / 2\r\n\r\nvar locIsNotWaterfall = !(loc = waterfall)\r\nvar mapStart = false\r\n\r\nvar shipPanel\r\nvar shipSprite     // 0 = 3:00, 1 = 4:00, ..., 11 = 2:00\r\nvar engineSprite\r\nvar backgroundSprite\r\nvar bulletSprite\r\nvar healthSprite\r\nvar explosionSprite\r\nvar asteroidSprite = []  // 0 = small, 1 = med, 2 = large\r\nvar asteroidScore = [10, 15, 20]\r\nvar asteroidRadius = [50, 100, 200]\r\nvar asteroidCenterOffset = [[100, 100], [200, 100], [150, 250]]\r\n\r\nvar bulletOffset = [[200, 0], [ 200, 100], [ 100, 100], [0, 100], [-100,100], [-200, 100],\r\n                     [-200,0], [-200,-100], [-100,-100], [0,-100], [100,-100], [ 200,-100]]\r\n\r\nvar shipAcceleration = [[20, 0], [ 16, 4], [  8, 8], [  0,10],\r\n                        [-8, 8], [-16, 4], [-20, 0], [-16,-4],\r\n                        [-8,-8], [ 0,-10], [  8,-8], [ 16,-4]]\r\n\r\nvar playerDead = 0\r\nvar playerDeadDuration = 90\r\nvar banner = 0\r\nvar bannerDuration = 90\r\nvar showSplash = true\r\nvar score = 0\r\nvar level\r\nvar highscore\r\n\r\nvar bulletList = []  // [x, y, vx, vy, framesRemaining]\r\nvar asteroidList = []  // [x, y, vx, vy, size]\r\n\r\nvar shipRadius = 150\r\nvar shipLife = 2\r\nvar bonusLifePointsRequired = 1000\r\nvar bonusLifeScoreToReach = 1000\r\nvar asteroidCount = 0\r\nvar bulletCount = 0\r\nvar safeAreaRadius = 1000\r\nvar shipRotationSpeed = 15\r\nvar ship_x\r\nvar ship_y\r\nvar ship_vx\r\nvar ship_vy\r\nvar ship_ax\r\nvar ship_ay\r\nvar shipAccelerating\r\nvar shipHalfturn = 0\r\nvar shipDirection = 0\r\nvar shipInvincibility = 0\r\nvar shipInvincibilityDuration = 30\r\nvar ship_vx_max = 60\r\nvar ship_vy_max = 30\r\nvar bulletLifespan = 60\r\nvar bulletRadius = 100\r\nvar bulletCooldownDuration = 7\r\nvar bulletCooldown = 0\r\n\r\nvar splashPanel\r\nvar gamePanel\r\nvar buttonX\r\n\r\n///////////////////////////////////////////////\r\n\r\n?locIsNotWaterfall\r\n  return\r\n\r\n?!mapStart\r\n  mapStart = true\r\n  disable banner\r\n  disable pause\r\n  ambient.Stop()\r\n  setupSprites()\r\n  setupUI()\r\n\r\nmain()\r\n\r\n///////////////////////////////////////////////\r\n\r\nfunc main()\r\n  ?showSplash\r\n    splashScreen()\r\n  :\r\n    ?banner\r\n      banner -= 1\r\n      ?banner = 0\r\n        disable banner\r\n        ?!playerDead & !asteroidCount\r\n          initLevel(level + 1)\r\n          return\r\n        :?shipLife = 0\r\n          newGame()\r\n          return\r\n    ?shipInvincibility\r\n      shipInvincibility -= 1\r\n    ?bulletCooldown\r\n      bulletCooldown -= 1\r\n    ?playerDead\r\n      playerDead -= 1\r\n      ?playerDead = 0\r\n        ?shipLife = 0\r\n          newGame()\r\n        :\r\n          resetShip()\r\n    :\r\n      updatePlayer()\r\n    updateAsteroids()\r\n    updateBullets()\r\n    checkCollision()\r\n    drawGame()\r\n\r\nfunc splashScreen()\r\n  >`@logoX@,@logoY@,@logoSprite@\r\n  >`@versionX@,@versionY@,@version@\r\n  >`@controlsX@,@screen.h - 5@,  @controlsStr@\r\n  >`1,@screen.h - 4@,╔══════════╗  \r\n  >`1,@screen.h - 3@,║ ← →    ∆ ║\r\n  >`1,@screen.h - 2@,╚══════════╝\r\n\r\nfunc newGame()\r\n  splashPanel.children[1].y = 9\r\n  splashPanel.children[2].visible = inherit\r\n  buttonX.visible = true\r\n  gamePanel.visible = true\r\n  shipLife = 2\r\n  updateHealth()\r\n  score = 0\r\n  highscore = storage.Get(\"Asteroids_Highscore\", storage.Get(\"highscore\", 0))\r\n  increaseScore(0)\r\n  bonusLifeScoreToReach = bonusLifePointsRequired\r\n  initLevel(1)\r\n  showSplash = false\r\n  splashPanel.visible = false\r\n  \r\nfunc continueGame()\r\n  showSplash = false\r\n  splashPanel.visible = false\r\n  buttonX.visible = true\r\n  gamePanel.visible = true\r\n  \r\nfunc returnMenu()\r\n  showSplash = true\r\n  splashPanel.visible = true\r\n  buttonX.visible = false\r\n  gamePanel.visible = false\r\n  \r\nfunc initLevel(lvl)\r\n  level = lvl\r\n  ?lang = \"ZH-CN\"\r\n    gamePanel.children[2].text = \"第 \" + level + \" 关\"\r\n  :\r\n    gamePanel.children[2].text = \" Level: \" + level\r\n  resetShip()\r\n  bulletCount = 0\r\n  asteroidCount = 0\r\n  bulletList.Clear()     // [x, y, vx, vy, framesRemaining]\r\n  asteroidList.Clear()   // [x, y, vx, vy, size]\r\n  for i = 0 .. lvl-1\r\n    var rnd_x = modulo(x_max/2 + safeAreaRadius + (10000 * rng + rng) % (x_max - 2 * safeAreaRadius), x_max)\r\n    var rnd_y = modulo(y_max/2 + safeAreaRadius + (10000 * rng + rng) % (y_max - 2 * safeAreaRadius), y_max)\r\n    var size = rng % 3\r\n    generateAsteroid(rnd_x, rnd_y, size)\r\n\r\nfunc resetShip()\r\n  shipInvincibility = shipInvincibilityDuration\r\n  shipDirection = 0\r\n  ship_x = x_max/2 - 400\r\n  ship_y = y_max/2 - 200\r\n  ship_vx = 0\r\n  ship_vy = 0\r\n  shipSprite.frame = 0\r\n  engineSprite.frame = 0\r\n  ship_ax = shipAcceleration[shipDirection][0]\r\n  ship_ay = shipAcceleration[shipDirection][1]\r\n\r\nfunc generateAsteroid(x, y, size)\r\n  var vx = rng % 101 - 50    // -50 to 50\r\n  var vy = rng % 51 - 25     // -25 to 25\r\n  asteroidList.Add([x, y, vx, vy, size])\r\n  asteroidCount += 1\r\n\r\nfunc updatePlayer()\r\n  ship_x = modulo(ship_x + ship_vx, x_max)\r\n  ship_y = modulo(ship_y + ship_vy, y_max)\r\n  var key_ = key\r\n  shipAccelerating = false\r\n  ?!key_\r\n    shipHalfturn = 0\r\n    return\r\n  ?key_ = primary\r\n    var input_x = input.x\r\n    ?input_x * 6 < scrw\r\n      turnShip(-1)\r\n    :?input_x * 3 < scrw\r\n      turnShip(1)\r\n    :\r\n      accelerateShip()\r\n  :\r\n    ?key_ = left\r\n      turnShip(-1)\r\n    ?key_ = right\r\n      turnShip(1)\r\n    ?key_ = up\r\n      accelerateShip()\r\n\r\nfunc turnShip(dir)\r\n  ?shipHalfturn = 1\r\n    shipHalfturn = 0\r\n    shipDirection = modulo(shipDirection + dir, 12)\r\n    shipSprite.frame = shipDirection\r\n    engineSprite.frame = shipDirection\r\n    ship_ax = shipAcceleration[shipDirection][0]\r\n    ship_ay = shipAcceleration[shipDirection][1]\r\n  :\r\n    shipHalfturn = 1\r\n\r\nfunc accelerateShip()\r\n  shipAccelerating = true\r\n  ship_vx += ship_ax\r\n  ship_vy += ship_ay\r\n  ?ship_vx > ship_vx_max\r\n    ship_vx = ship_vx_max\r\n  :?ship_vx < -ship_vx_max\r\n    ship_vx = -ship_vx_max\r\n  ?ship_vy > ship_vy_max\r\n    ship_vy = ship_vy_max\r\n  :?ship_vy < -ship_vy_max\r\n    ship_vy = -ship_vy_max\r\n  generateBullet()\r\n\r\nfunc generateBullet()\r\n  ?bulletCooldown | shipInvincibility\r\n    return\r\n  play wand_hit\r\n  bulletCount += 1\r\n  bulletCooldown = bulletCooldownDuration\r\n  bulletList.Add([ship_x + bulletOffset[shipDirection][0], ship_y + bulletOffset[shipDirection][1], shipAcceleration[shipDirection][0]*10, shipAcceleration[shipDirection][1]*10, bulletLifespan])\r\n\r\nfunc updateAsteroids()  // [x, y, vx, vy, size]\r\n  ?!asteroidCount\r\n    ?!playerDead & !banner\r\n      enable banner\r\n      ui.ShowBanner(\"AREA CLEARED\")\r\n      banner = bannerDuration\r\n    return\r\n  for a : asteroidList\r\n    a[0] = modulo(a[0] + a[2], x_max)\r\n    a[1] = modulo(a[1] + a[3], y_max)\r\n\r\nfunc updateBullets()  // [x, y, vx, vy, framesRemaining]\r\n  ?!bulletCount\r\n    return\r\n  for i = bulletCount-1 .. 0\r\n    bulletList[i][4] -= 1\r\n    ?bulletList[i][4] = 0\r\n      bulletList.RemoveAt(i)\r\n      bulletCount -= 1\r\n    :\r\n      bulletList[i][0] = modulo(bulletList[i][0] + bulletList[i][2], x_max)\r\n      bulletList[i][1] = modulo(bulletList[i][1] + bulletList[i][3], y_max)\r\n\r\nfunc checkCollision()\r\n  ?!asteroidCount\r\n    return\r\n  for a = asteroidCount-1 .. 0\r\n    var ax = asteroidList[a][0]\r\n    var ay = asteroidList[a][1]\r\n    var astSize = asteroidList[a][4]\r\n    ?!shipInvincibility & !playerDead & tooClose(ax, ay, ship_x, ship_y, asteroidRadius[astSize] + shipRadius)\r\n      play bomb_cart_explosion\r\n      playerDead = 90\r\n      shipSprite.frame = 12\r\n      engineSprite.visible = false\r\n      shipLife -= 1\r\n      updateHealth()\r\n      ?shipLife = 0\r\n        enable banner\r\n        ui.ShowBanner(\"GAME OVER\")\r\n        banner = bannerDuration\r\n    ?bulletCount\r\n      for b = bulletCount-1 .. 0    // check bullets hitting asteroid\r\n        var bx = bulletList[b][0]\r\n        var by = bulletList[b][1]\r\n        ?tooClose(ax, ay, bx, by, asteroidRadius[astSize] + bulletRadius)\r\n          increaseScore(asteroidScore[astSize])\r\n          ?astSize > 0\r\n            generateAsteroid(ax, ay, astSize - 1)\r\n            generateAsteroid(ax, ay, astSize - 1)\r\n          bulletList.RemoveAt(b)\r\n          asteroidList.RemoveAt(a)\r\n          bulletCount -= 1\r\n          asteroidCount -= 1\r\n          play bomb_cart_explosion\r\n          break\r\n\r\nfunc tooClose(x1, y1, x2, y2, dist)\r\n  var dx = abs(x1 - x2)\r\n  var dy = abs(y1 - y2)\r\n  ?dx > dist | dy > dist\r\n    return false\r\n  :\r\n    return pow(dx, 2) + pow(dy, 2) < pow(dist, 2)\r\n\r\nfunc increaseScore(x)\r\n  score += x\r\n  ?score > highscore\r\n    highscore = score\r\n    storage.Set(\"Asteroids_Highscore\", highscore)\r\n  ?score >= bonusLifeScoreToReach\r\n    play level_up\r\n    shipLife += 1\r\n    bonusLifeScoreToReach += bonusLifePointsRequired\r\n    updateHealth()\r\n  gamePanel.children[1].text = score + \"\\n\" + highscore\r\n\r\nfunc updateHealth()\r\n  gamePanel.children[3].text = string.Sub(\"❤❤❤❤❤❤❤❤❤❤\", 0, shipLife)\r\n\r\nfunc drawGame()\r\n  ?!playerDead\r\n    ?shipInvincibility % 2 = 0\r\n      shipPanel.visible = inherit\r\n      shipPanel.x = ship_x/100 - 5\r\n      shipPanel.y = ship_y/100 - 2\r\n      ?shipAccelerating\r\n        engineSprite.visible = inherit\r\n      :\r\n        engineSprite.visible = false\r\n    :\r\n      shipPanel.visible = false\r\n  ?asteroidCount\r\n    for a : asteroidList\r\n      var astSize = a[4]\r\n      >`@(a[0] - asteroidCenterOffset[astSize][0]) / 100@,@(a[1] - asteroidCenterOffset[astSize][1]) / 100@,#yellow,@asteroidSprite[astSize]@\r\n  ?bulletCount\r\n    for b : bulletList\r\n      >`@b[0]/100@,@b[1]/100@,#cyan,@bulletSprite@\r\n\r\nfunc modulo(x, m)  // x, m are ints\r\n  ?x < 0\r\n    // x += m - x / m * m\r\n    x += m\r\n  return x % m\r\n\r\nfunc setupSprites()  // logo, ship, engine, background, bullet, health,\r\n                     // explosion, asteroid\r\n\r\n  logoSprite = ascii\r\n  A    SSSS TTTTT EEEEE RRRR   OOOO  IIIII DDDDD   SSSS \r\n A A  S       T   E     R   R O    O   I   D    D S     \r\nAAAAA  SSSS   T   EEEE  RRRR  O    O   I   D    D  SSSS \r\nA   A      S  T   E     R   R O    O   I   D    D      S\r\nA   A SSSSS   T   EEEEE R   R  OOOO  IIIII DDDDD  SSSSS \r\nasciiend\r\n\r\n  shipSprite = ui.AddAnim(ascii\r\n###\r\n##|-._\r\n##|  O>\r\n##|-'‾\r\n%%\r\n##.\r\n###/ \\\r\n##/  O\\\r\n##‾ ‾‾ \r\n%%\r\n#####_.\r\n##.-´ |\r\n###`.O|\r\n#####`'\r\n%%\r\n###\r\n###\\‾‾‾/\r\n####\\O/\r\n#####'\r\n%%\r\n####._\r\n####| `-,\r\n####|O.´\r\n####'´\r\n%%\r\n######.  \r\n#####/ \\ \r\n####/O  \\\r\n#### ‾‾ ‾\r\n%%\r\n#\r\n#####_.-|\r\n####<O  |\r\n#####‾'-|\r\n%%\r\n#\r\n#### _\r\n####\\O ‾/\r\n#####\\ /\r\n######`\r\n%%\r\n#\r\n####. \r\n####|O`.\r\n####| _.`\r\n####'´\r\n%%\r\n#\r\n#####.\r\n####/O\\\r\n###/___\\\r\n%%\r\n#\r\n######.\r\n###.´O|\r\n##´-. |\r\n#####`'\r\n%%\r\n#\r\n#####_ \r\n##\\‾ O/\r\n###\\ /\r\n####´\r\n%%\r\n#\r\n###\\ | /\r\n###- o -\r\n###/ | \\\r\nasciiend)\r\n\r\n  engineSprite = ui.AddAnim(ascii\r\n#\r\n#\r\n·:\r\n%%\r\n#\r\n#`:\r\n%%\r\n###:.\r\n%%\r\n#####¡\r\n%%\r\n######.:\r\n%%\r\n#\r\n########:´\r\n%%\r\n#\r\n#\r\n#########:·\r\n%%\r\n#\r\n#\r\n#\r\n########:.\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n######`:\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n#####!\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n###:´\r\n%%\r\n#\r\n#\r\n#\r\n#,:\r\nasciiend)\r\n  \r\n  backgroundSprite = ascii\r\n#.###################.######################.#################################.#######\r\n######################################################################################\r\n#########.############################################################################\r\n############################.#######################################.#################\r\n######################################################################################\r\n####.#######################################################.#########################\r\n##################################.###################################################\r\n######################################################################################\r\n###############.#####################################.##############################.#\r\n######.###############################################################.###############\r\n######################################################################################\r\n#######################.####################################.#########################\r\n.#####################################################################################\r\n##########################################.################################.##########\r\n######################################################################################\r\n#####################.###################################.############################\r\n######################################################################################\r\n###########.##########################################################################\r\n######################################################################################\r\n##############################.####################################.##################\r\n######################################################################################\r\n###.############################################.################################.####\r\n######################################################################################\r\n################.#####################################################################\r\n###########################################################.##########################\r\n######################################################################################\r\nasciiend\r\n\r\n  bulletSprite = ascii\r\no\r\nasciiend\r\n\r\n  asteroidSprite.Add(ascii\r\n#_#  \r\n(_)\r\n###\r\nasciiend)\r\n\r\n  asteroidSprite.Add(ascii\r\n#.-.#\r\n(###)\r\n#`-´#\r\nasciiend)\r\n\r\n  asteroidSprite.Add(ascii\r\n#.--.#\r\n[####]\r\n[####]\r\n#`--´#\r\nasciiend)\r\n\r\nfunc setupUI()\r\n\r\n  var n = null\r\n  var b = makeUI(ui.AddText, n, n, scrw, scrh, n, n, n, backgroundSprite, \"center\", n, n)  \r\n  var bottomPanel = makeUI(ui.AddPanel, n, n, scrw, scrh, n, n, 0, n, n, n, n)\r\n  bottomPanel.Add(b)\r\n\r\n  buttonX = makeUI(ui.AddButton, n, n, 5, 3, \"top_right\", \"top_right\", n, \"X\", n, returnMenu, false)\r\n  \r\n  shipPanel = makeUI(ui.AddPanel, scrw/2 - 4, scrh/2 - 2, 1, 1, top_left, top_left, ui.AddStyle(\"#########\"), null, null, null, vis)\r\n  shipPanel.Add(shipSprite)\r\n  shipPanel.Add(engineSprite)\r\n  shipSprite.dock = top_left\r\n  shipSprite.anchor = top_left\r\n  engineSprite.dock = top_left\r\n  engineSprite.anchor = top_left\r\n  engineSprite.color = #ffbb22\r\n\r\n  gamePanel = makeUI(ui.AddPanel, 1, n, scrw, scrw, \"top_left\", \"top_left\", ui.AddStyle(\"#########\"), n, n, n, false)\r\n  ?lang = \"ZH-CN\"\r\n    gamePanel.Add(makeUI(ui.AddText, n, n, 4, 2, \"top_left\", \"top_left\", n, \"得分:\\n记录:\", n, n, n))\r\n    gamePanel.Add(makeUI(ui.AddText, 4, n, 7, 2, \"top_left\", \"top_left\", n, n, n, n, n))\r\n  :\r\n    gamePanel.Add(makeUI(ui.AddText, n, n, 8, 2, \"top_left\", \"top_left\", n, \" Score:\\nRecord:\", n, n, n))\r\n    gamePanel.Add(makeUI(ui.AddText, 8, n, 7, 2, \"top_left\", \"top_left\", n, n, n, n, n))\r\n  gamePanel.Add(makeUI(ui.AddText, n, 2, 10, 1, \"top_left\", \"top_left\", n, n, n, n, n))\r\n  gamePanel.Add(makeUI(ui.AddText, n, 4, 10, 1, \"top_left\", \"top_left\", n, n, n, n, n))\r\n  gamePanel.children[3].color = #red\r\n  gamePanel.Add(shipPanel)\r\n  \r\n  splashPanel = makeUI(ui.AddPanel, n, n, scrw, scrh, n, n, ui.AddStyle(\"#########\"), n, n, n, n)    \r\n  splashPanel.Add(makeUI(ui.AddButton, n, 3, 10, 3, n, n, n, te.xt(\"Play\"), n, newGame, n))\r\n  splashPanel.Add(makeUI(ui.AddButton, n, 6, 10, 3, n, n, n, te.xt(\"Exit\"), n, loc.Leave, n))\r\n  splashPanel.Add(makeUI(ui.AddButton, n, 6, 10, 3, n, n, n, te.xt(\"Continue\"), n, continueGame, false))\r\n\r\nfunc makeUI(type, x, y, w, h, dk, anc, sty, text, align, pressFunc, vis)\r\n  var u = type()\r\n  ?x ! null\r\n    u.x = x\r\n  ?y ! null\r\n    u.y = y\r\n  ?w ! null\r\n    u.w = w\r\n  ?h ! null\r\n    u.h = h\r\n  ?dk ! null\r\n    u.dock = dk\r\n  ?anc ! null\r\n    u.anchor = anc\r\n  ?sty ! null\r\n    u.style = sty\r\n  ?text ! null\r\n    u.text = text\r\n  ?pressFunc ! null\r\n    u.SetPressed(pressFunc)\r\n  ?vis ! null\r\n    u.visible = vis\r\n  return u"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/SwordGame.txt" - Parse error: Failed to parse completely. Remaining: "= minR + rng % (maxR - minR + 1)\r\n touche = 0\r\n score = score + 1\r\n>c@nR@,11,#A0A0A0,@rock@\r\nvar hR = nR + 8\r\nhR = nR + 8\r\n>c@hR-1@,11,#rainFF,`O´\r\n\r\n//Touche et descente\r\nvar points = 0\r\nvar descente = 0\r\n?key = downBegin\r\n descente = 1\r\n croissance = 3\r\n\r\n?descente = 1 & Y < 12\r\n Y = Y + 1\r\n ? Y = 11\r\n  descente = 0\r\n   ?hR = X | X = hR + 1 |X = hR - 1\r\n    touche = 1\r\n  Y = -6\r\n  croissance = A\r\n\r\n>Score : @score@    Put the mystic sword back\r\n^ in its sacred rock! (press down to launch)    "
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Fishing/RodFactory.txt" - Parse error: Failed to parse completely. Remaining: "?level = 0\r\n    rod.color = #white\r\n    rod.minFish = 0\r\n    rod.maxFish = 130\r\n\r\n  :?level = 1\r\n    rod.color = #cyan\r\n    rod.minFish = 90\r\n    rod.maxFish = 202\r\n\r\n  :?level = 2\r\n    rod.color = #yellow\r\n    rod.minFish = 110\r\n    rod.maxFish = 234\r\n\r\n  :?level = 3\r\n    rod.color = #green\r\n    rod.minFish = 120\r\n    rod.maxFish = 244\r\n\r\n  :?level = 4\r\n    rod.color = #blue\r\n    rod.minFish = 124\r\n    rod.maxFish = 249\r\n\r\n  :?level = 5\r\n    rod.color = #red\r\n    rod.minFish = 126\r\n    rod.maxFish = 252\r\n\r\n  : // Rainbow\r\n    rod.color = #rainbow\r\n    rod.lineColor = #rain88\r\n    rod.minFish = 127\r\n    rod.maxFish = 254\r\n\r\n  return rod\r\n\r\n\r\n\r\nfunc RngRange(min, max)\r\n  var n\r\n  n = min + rng % (max - min + 1)\r\n  return n\r\n\r\n\r\n\r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Fishing/FishingShop.txt" - Parse error: Failed to parse completely. Remaining: "┌──────────────────────────────────────────────────────────┐\r\n│                                                          │\r\n│                                                          │\r\n│                                                          │\r\n│                                                          │\r\n│                                                          │\r\n│                                                          │\r\n│                                                          │\r\n│                                                          │\r\n│                                                          │\r\n│                                                          │\r\n│                                                          │\r\n│                                                          │\r\n│                                                          │\r\n│                                                          │\r\n│                                                          │\r\n│                                                          │\r\n│                                                          │\r\n│                                                          │\r\n│                                                          │\r\n│                                                          │\r\n└──────────────────────────────────────────────────────────┘\r\nasciiend\r\n\r\n\r\nfunc DrawSelection(x, y)\r\n  >`@x@,@y@,#white,ascii\r\n┌──────┐\r\n│######│\r\n│######│\r\n│######│\r\n│######│\r\n│######│\r\n└──────┘\r\nasciiend\r\n\r\nfunc DrawSelectionBottom(x, y)\r\n  y = y + 6\r\n  >`@x@,@y@,#white,ascii\r\n└──────┘\r\nasciiend\r\n\r\n\r\nfunc DrawDetails(x, y)\r\n  >`@x@,@y@,#888888,ascii\r\n#####/\\\r\n|‾‾‾‾  ‾‾‾‾|\r\n|          |\r\n|          |\r\n|__________|\r\nasciiend\r\n\r\n\r\nfunc DrawSoldOut(x, y)\r\n  x = x - 3\r\n  >`@x@,@y@,#888888,*SOLD*\r\n\r\n\r\nfunc DrawSlot(x, y, sprite, color, price, isPriceKnown, isSoldOut)\r\n\r\n  ?slotX = seleX & slotY = seleY\r\n    DrawSelection(x, y)\r\n\r\n  // Draw Sprite\r\n  >`@x@,@y@,@color@,@sprite@\r\n\r\n  x = x + 4\r\n  y = y + 5\r\n  //?isPriceKnown\r\n  //  money.Draw(x, y, price)\r\n  //:\r\n  //  money.DrawStr(x, y, \"???\")\r\n\r\n  ?isSoldOut\r\n    DrawSoldOut(x, y - 2)\r\n// func end\r\n\r\n\r\nfunc DrawRodSlot(x, y, color, price, isPriceKnown, isSoldOut)\r\n  var rodSpriteA = ascii\r\n#\r\n#####,\r\n####/;\r\n###/´\r\n##/!\r\nasciiend\r\n\r\n  var rodSpriteB = ascii\r\n#\r\n#####,\r\n####/\r\n###/\r\n##/\r\nasciiend\r\n  DrawSlot(x, y, rodSpriteA, #888888, price, isPriceKnown, isSoldOut)\r\n  DrawSlot(x, y, rodSpriteB, color, price, isPriceKnown, isSoldOut)\r\n\r\n\r\nfunc Update()\r\n  dialogX = (screen.w - dialogW) / 2\r\n  dialogY = (screen.h - dialogH) / 2\r\n  x = dialogX\r\n  y = dialogY\r\n  DrawBorder(x, y)\r\n\r\n  // Title\r\n  var titleStr = \"SHOP\"\r\n  x = x + (dialogW - string.Size(titleStr)) / 2\r\n  y++\r\n  >`@x@,@y@,#888888,@titleStr@\r\n\r\n  // Instructions\r\n  x = dialogX + 1\r\n  y = dialogY + dialogH - 1\r\n  >`@x@,@y@,[x]Back\r\n\r\n\r\n  // Move Selection\r\n\r\n  ?key = leftBegin & seleX > 0\r\n    seleX--\r\n  ?key = rightBegin & seleX < 6\r\n    seleX++\r\n\r\n  ?key = upBegin & seleY > 0\r\n    seleY--\r\n  ?key = downBegin & seleY < 2\r\n    seleY++\r\n\r\n\r\n  // Rods\r\n\r\n  slotX = 0\r\n  slotY = 0\r\n\r\n  x = dialogX + 2\r\n  y = dialogY + 2\r\n  DrawRodSlot(x, y, #white, 100, true, true)\r\n\r\n  slotX++\r\n  x = x + slotW\r\n  DrawRodSlot(x, y, #cyan, 200, true, false)\r\n\r\n  slotX++\r\n  x = x + slotW\r\n  DrawRodSlot(x, y, #yellow, 400, true, false)\r\n\r\n  slotX++\r\n  x = x + slotW\r\n  DrawRodSlot(x, y, #green, 800, true, false)\r\n\r\n  slotX++\r\n  x = x + slotW\r\n  DrawRodSlot(x, y, #blue, 1600, true, false)\r\n\r\n  slotX++\r\n  x = x + slotW\r\n  DrawRodSlot(x, y, #red, 3200, false, false)\r\n\r\n  slotX++\r\n  x = x + slotW\r\n  DrawRodSlot(x, y, #rainbow, 6400, false, false)\r\n\r\n\r\n  //DrawDetails(x - 36, y + 5)\r\n\r\n\r\n  // Helpers\r\n\r\n\r\n  // Skeletimmy\r\n\r\n  slotX = 0\r\n  slotY++\r\n  x = dialogX + 2\r\n  y = y + slotH\r\n\r\n  var skeletimmySprite = ascii\r\n##\r\n##\r\n###_{)\r\n##''¯)\r\n####/(\r\nasciiend\r\n\r\n  DrawSlot(x, y, skeletimmySprite, #white, 1000, true, false)\r\n  slotX++\r\n  x = x + slotW\r\n  DrawSlot(x, y, skeletimmySprite, #cyan, 2000, false, false)\r\n  slotX++\r\n  x = x + slotW\r\n  DrawSlot(x, y, skeletimmySprite, #yellow, 4000, false, false)\r\n  slotX++\r\n  x = x + slotW\r\n  DrawSlot(x, y, skeletimmySprite, #green, 8000, false, false)\r\n  slotX++\r\n  x = x + slotW\r\n  DrawSlot(x, y, skeletimmySprite, #blue, 16000, false, false)\r\n  slotX++\r\n  x = x + slotW\r\n  DrawSlot(x, y, skeletimmySprite, #red, 32000, false, false)\r\n  slotX++\r\n  x = x + slotW\r\n  DrawSlot(x, y, skeletimmySprite, #rainbow, 64000, false, false)\r\n\r\n\r\n  // Spider\r\n\r\n  slotX = 0\r\n  slotY++\r\n  x = dialogX + 2\r\n  y = y + slotH\r\n\r\n  var spiderSprite = ascii\r\n##\r\n####_\r\n###( )\r\n#/∞|´\\\\\r\n#`#'#´´\r\nasciiend\r\n\r\n  DrawSlot(x, y, spiderSprite, #white, 10000, false, false)\r\n  slotX++\r\n  x = x + slotW\r\n  DrawSlot(x, y, spiderSprite, #cyan, 20000, false, false)\r\n  slotX++\r\n  x = x + slotW\r\n  DrawSlot(x, y, spiderSprite, #yellow, 40000, false, false)\r\n  slotX++\r\n  x = x + slotW\r\n  DrawSlot(x, y, spiderSprite, #green, 80000, false, false)\r\n  slotX++\r\n  x = x + slotW\r\n  DrawSlot(x, y, spiderSprite, #blue, 160000, false, false)\r\n  slotX++\r\n  x = x + slotW\r\n  DrawSlot(x, y, spiderSprite, #red, 320000, false, false)\r\n  slotX++\r\n  x = x + slotW\r\n  DrawSlot(x, y, spiderSprite, #rainbow, 640000, false, false)\r\n\r\n\r\n  // Bottom part of selector\r\n\r\n  x = dialogX + 2 + seleX * slotW\r\n  y = dialogY + 2 + seleY * slotH\r\n  DrawSelectionBottom(x, y)\r\n// func end\r\n\r\n\r\n// Ghost\r\nvar ghostSprite = ascii\r\n##.-.\r\n#(* *)\r\n#/ ° \\\r\n##\\ (_,\r\n###`-'\r\nasciiend\r\n\r\n// Bat\r\nvar batSprite = ascii\r\n_####__\r\n`\\,,/.'\r\n##\"-'\r\nasciiend\r\n\r\n// Pusher\r\nvar pusherSprite = ascii\r\n#O\r\n/|\\\r\n/#\\\r\nasciiend\r\n\r\n// Snail\r\nvar snailSprite = ascii\r\n.#,#.---.\r\n#)//  __ \\\r\n( )  / _) )\r\n#\\ `-\\___/-/\r\n##`-------´\r\nasciiend\r\n\r\n// Skeletony\r\nvar skeletonySprite = ascii\r\n###__\r\n##,o_)\r\n##\"':_\r\n#_.-/)\\\r\n\"`,-´_/\r\nasciiend\r\n\r\n// Controller\r\nvar controllerSprite = ascii\r\n#########└O┘\r\n########_/|\\\r\n_______/#/#\\\r\nasciiend\r\n\r\n// Dominotaur\r\nvar dominotaurSprite = ascii\r\n#############(#__#)\r\n##############¯\\/¯\r\n#############,-´'-.\r\n############//\\. ¯`)\r\n#########,==´#/-´\\\"\r\n########/####( `\\ \\\r\n_______/######)/#)/\r\n##############\"##\"\r\nasciiend\r\n\r\n// Ki Eater\r\nvar kiEaterSprite = ascii\r\n#_.-._\r\n/`\\\"/-\\\r\n|\\###/|\r\n#\\|#|/\r\nasciiend\r\n\r\n// Ice Elemental\r\nvar iceElementalSprite = ascii\r\n##/|\r\n`/| \\,\r\n#\\o_/\r\nasciiend\r\n\r\n// Cultist\r\nvar cultistSprite = ascii\r\n####/\r\n###/_\r\n##/{))\r\n#/¯\\ `,\r\n('#/ \\-,\r\n###`¯`´\r\nasciiend\r\n\r\n// Poison Adept\r\nvar poisonAdeptSprite = ascii\r\n###,\r\n∞_/(_\r\n|{\\\\\r\n|-´ )\r\n|/__\\\r\n#`##´\r\nasciiend\r\n\r\n// Snake\r\nvar snakesSprite = ascii\r\n#.-.\r\n'-´))#|#/)\r\n##// #|/ )\r\n#((_.-´_¯'.\r\n##`--´####`)\r\n#######_.-´\r\nasciiend\r\n\r\n// Acronian Scout\r\nvar scoutSprite = ascii\r\n######/\r\n###),_#____\r\n###`o/(  -´\r\n##,/_\\#);\r\n##/##/\\´\r\n#/#-´#_)_\r\nL####/#.´\r\n####;#(\r\n###/###\\\r\nasciiend\r\n\r\n// Wasp Nest\r\nvar waspNestSprite = ascii\r\n######,\r\n#.###\\|###,\r\n#-\\##_|#|/\r\n###\\/´ \\/-´\r\n.__{(_)/}#_/-\r\n####\\./´-'\r\n#`-\\}  {\r\n####{  }\r\n####}  {\r\n####{  }\r\n###//´\\`\\\r\nasciiend\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Fishing/FishingHUD.txt" - Parse error: Failed to parse completely. Remaining: "= \"♠\"\r\nvar progress = import Games/Fishing/FishingProgress\r\nvar topPanel\r\nvar moneyText\r\n\r\nfunc Init()\r\n  topPanel = ui.AddPanel()\r\n  topPanel.style = 0\r\n  topPanel.anchor = top_center\r\n  topPanel.dock = top_center\r\n  topPanel.w = screen.w\r\n  topPanel.h = 1\r\n  \r\n  moneyText = ui.AddText()\r\n  moneyText.anchor = top_center\r\n  moneyText.dock = top_center\r\n  moneyText.align = center\r\n  moneyText.x = 0\r\n  moneyText.y = 0\r\n  moneyText.w = 31\r\n\r\n  topPanel.Add(moneyText)\r\n\r\n  Update()\r\n\r\n\r\nfunc Update()\r\n  moneyText.text = currencyGlyph + progress.scales\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Fishing/FishingProgress.txt" - Parse error: Failed to parse completely. Remaining: "(\"key_scales\", 0)\r\nvar recordWeight = storage.Get(\"key_record\", 0)\r\nvar rod = 0\r\n\r\nfunc AddScales(amount)\r\n  scales = scales + amount\r\n  storage.Set(\"key_scales\", scales)\r\n\r\nfunc CheckRecord(newWeight)\r\n  ?recordWeight < newWeight\r\n    recordWeight = newWeight\r\n    storage.Set(\"key_record\", recordWeight)\r\n    return true\r\n  return false\r\n\r\nfunc IsFTUE()\r\n  ?scales = 0\r\n    return true\r\n  return false"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Fishing/FishFactory.txt" - Parse error: Failed to parse completely. Remaining: "?selectedFish >= 0 & selectedFish < 128\r\n    fish.name = te.xt(tid_fish_speedyfin)\r\n    fish.art = ascii\r\n#########\r\n#><))8>##\r\nasciiend\r\n    fish.rodPivotX = 7\r\n    fish.rodPivotY = 0\r\n    fish.height = 3\r\n    fish.scalesMin = 1\r\n    fish.scalesMax = 3\r\n    fish.acceleration = 15\r\n\r\n\r\n  :?selectedFish >= 128 & selectedFish < 192\r\n    fish.name = te.xt(tid_fish_bowfish)\r\n    fish.art = ascii\r\n#.  )  ##\r\n# )( o>##\r\n#´  )´ ##\r\nasciiend\r\n    fish.rodPivotX = 7\r\n    fish.rodPivotY = 0\r\n    fish.height = 3\r\n    fish.scalesMin = 5\r\n    fish.scalesMax = 10\r\n    fish.acceleration = 16\r\n\r\n\r\n  :?selectedFish >= 192 & selectedFish < 224\r\n    fish.name = te.xt(tid_fish_spookfin)\r\n    fish.art = ascii\r\n#  (°_ ##\r\n#_/_ o\\##\r\n#´  `'\"##\r\nasciiend\r\n    fish.rodPivotX = 7\r\n    fish.rodPivotY = 0\r\n    fish.height = 3\r\n    fish.scalesMin = 15\r\n    fish.scalesMax = 20\r\n    fish.acceleration = 17\r\n\r\n\r\n  :?selectedFish >= 224 & selectedFish < 240\r\n    fish.name = te.xt(tid_fish_poker)\r\n    fish.art = ascii\r\n##,\\_####\r\n≥´_ °`──-\r\n##/´‾####\r\nasciiend\r\n    fish.rodPivotX = 6\r\n    fish.rodPivotY = 0\r\n    fish.height = 3\r\n    fish.scalesMin = 25\r\n    fish.scalesMax = 30\r\n    fish.acceleration = 18\r\n\r\n\r\n  :?selectedFish >= 240 & selectedFish < 248\r\n    fish.name = te.xt(tid_fish_outchboi)\r\n    fish.art = ascii\r\n# .`'´,##\r\n#); <°c##\r\n# ´.,.`##\r\nasciiend\r\n    fish.rodPivotX = 7\r\n    fish.rodPivotY = 0\r\n    fish.height = 3\r\n    fish.scalesMin = 35\r\n    fish.scalesMax = 40\r\n    fish.acceleration = 19\r\n\r\n  :?selectedFish >= 248 & selectedFish < 252\r\n    fish.name = te.xt(tid_fish_whopper)\r\n    fish.art = ascii\r\n##(‾‾`._#\r\n(\\,' ‾ o\\\r\n(:   >( <\r\n(/`;-.,-´\r\n###‾‾####\r\nasciiend\r\n    fish.rodPivotX = 9\r\n    fish.rodPivotY = 1\r\n    fish.height = 5\r\n    fish.scalesMin = 45\r\n    fish.scalesMax = 50\r\n    fish.acceleration = 20\r\n\r\n  :?selectedFish >= 252 & selectedFish < 254\r\n    fish.name = te.xt(tid_fish_moonfin)\r\n    fish.art = ascii\r\n###.--.##\r\n(./ o,-\\#\r\n#)) (   #\r\n(´\\  `-;#\r\n###`--´##\r\nasciiend\r\n    fish.rodPivotX = 7\r\n    fish.rodPivotY = 1\r\n    fish.height = 5\r\n    fish.scalesMin = 55\r\n    fish.scalesMax = 65\r\n    fish.acceleration = 21\r\n\r\n  :\r\n    fish.name = te.xt(tid_fish_angrish)\r\n    fish.art = ascii\r\n###__####\r\n_.-. `. _\r\n`.  `; ò/\r\n-´_.´`,´#\r\n####/´###\r\nasciiend\r\n    fish.rodPivotX = 8\r\n    fish.rodPivotY = 1\r\n    fish.height = 5\r\n    fish.scalesMin = 70\r\n    fish.scalesMax = 99\r\n    fish.acceleration = 22\r\n\r\n\r\n  fish.scales = RngRange(fish.scalesMin, fish.scalesMax)\r\n  var weightD = (fish.scales / 10)\r\n  fish.weight = weightD + \".\" + (fish.scales - weightD * 10)\r\n  //>@fish.scalesMin@, @fish.scalesMax@, @fish.scales@; @weightD@, @fish.weight@\r\n\r\n  return fish\r\n\r\n\r\n\r\nfunc RngRange(min, max)\r\n  var n\r\n  n = min + rng % (max - min + 1)\r\n  return n\r\n\r\n\r\n\r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Fishing/FishingMoney.txt" - Parse error: Failed to parse completely. Remaining: "= \"♠\"\r\n//var currencyGlyph = \"α\"\r\n\r\nfunc DrawStr(x, y, value)\r\n  var str = currencyGlyph + value\r\n  x = x - string.Size(str) / 2\r\n  >`@x@,@y@,@str@\r\n\r\nfunc Draw(x, y, value)\r\n  // TODO - Format number e.g. 1,000,000\r\n  DrawStr(x, y, value)"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Fishing/RodData.txt" - Parse error: Failed to parse completely. Remaining: "= #white\r\nvar lineColor = #888888\r\nvar minFish = 0\r\nvar maxFish = 130"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Fishing/FishingGame.txt" - Parse error: Failed to parse completely. Remaining: "= \"0.8.0\"\r\n\r\nvar x = 0\r\nvar y = 0\r\nvar s = \"\"\r\n\r\nvar uiX = -11\r\nvar uiY = 7\r\nvar barColor = #303030\r\nvar progressValue = 1000\r\nvar progressPositive = 7\r\nvar progressNegative = 14\r\nvar progressX = uiX + 1\r\nvar progressY = uiY + 3\r\nvar progressColor = 00ff00\r\n\r\nvar fishWidth = 600\r\nvar fishArea = 2300\r\nvar fishLimit = fishArea - fishWidth\r\nvar fishMinSpeed = -70\r\nvar fishMaxSpeed = 100\r\nvar fishAccelDelay = 30\r\nvar reelImpulse = 260\r\nvar reelBadLow = 200\r\nvar reelGoodLow = 600\r\nvar reelGoodHigh = 1200\r\nvar reelBadHigh = 1600\r\n\r\nvar catchingPanel = null\r\nvar catchingFrame = null\r\nvar catchingZoneOutside = null\r\nvar catchingZoneInside = null\r\nvar catchingBar = null\r\nvar catchingFish = null\r\nvar catchingFtueText = null\r\n\r\nvar horizontalBarsStyle = ui.AddStyle(\"\r\n^───\r\n^###\r\n^───\")\r\nvar fullBoxStyle = ui.AddStyle(\"\r\n^███\r\n^███\r\n^███\")\r\n\r\nvar playerAnimRoot = null\r\nvar playerAnimWalk = null\r\nvar playerAnimArrived = null\r\nvar playerAnimThrowing = null\r\nvar playerAnimCatching = null\r\nvar playerAnimBigHead = null\r\nvar playerAnimExpressions = null\r\n\r\nvar fishPos = 0\r\nvar fishSpeed = 0\r\nvar fishAccel = 0\r\nvar fishDrawX = 0\r\nvar fishDrawY = uiY + 1\r\nvar fish\r\n\r\nvar waitTimeMin = 30 * 2\r\nvar waitTimeMax = 30 * 10\r\n\r\nvar progress = import Games/Fishing/FishingProgress\r\nvar topHud = new Games/Fishing/FishingHUD\r\n\r\nvar shop = new Games/Fishing/FishingShop\r\nvar logo = new Games/Fishing/FishingLogo\r\n\r\nvar resultDialog = new Games/Fishing/ResultsDialog\r\n\r\nvar fishFactory = import Games/Fishing/FishFactory\r\nvar rodFactory = import Games/Fishing/RodFactory\r\nvar flyup = new Games/FlyupText\r\n\r\n// States:\r\n// - Hidden\r\n// - Arriving\r\n// - Menu\r\n// - Throwing\r\n// - Waiting\r\n// - FTUE\r\n// - Catching\r\n// - Fail1\r\n// - Fail2\r\n// - Success1\r\n// - Success2\r\n// - Success3\r\n// - Collection\r\n// - Shop\r\n\r\nvar state = null\r\nvar stateTime = 0\r\nvar currentStateFunction = null\r\n\r\n// Used by Throwing Stones quest to delay showing the results dialog\r\nvar preventStateSuccess3 = false\r\n\r\nvar playButton = null\r\nfunc AddMenuUI()\r\n  ?playButton = null\r\n    var button = ui.AddButton()\r\n    button.anchor = top_right\r\n    button.dock = top_right\r\n    button.x = -13\r\n    button.y = 13\r\n    button.text = te.xt(Play)\r\n    button.SetPressed(OnPlayPressed)\r\n    playButton = button\r\n\r\nfunc RemoveMenuUI()\r\n  ?playButton ! null\r\n    playButton.Recycle()\r\n  playButton = null\r\n\r\n\r\nfunc AddCatchingUI()\r\n  ?catchingPanel\r\n    catchingPanel.visible = true\r\n    return\r\n\r\n  // Base panel\r\n  catchingPanel = ui.AddPanel()\r\n  catchingPanel.x = 0\r\n  catchingPanel.y = -1\r\n  catchingPanel.w = 25\r\n  catchingPanel.h = 5\r\n  catchingPanel.ay = bottom\r\n  catchingPanel.dy = bottom\r\n\r\n  // The visual design of the panel\r\n  catchingFrame = ui.AddAnim(ascii\r\n┌───────────────────────┐\r\n│                       │\r\n├───────────────────────┤\r\n│                       │\r\n└───┴───┴───┴───┴───┴───┘\r\nasciiend)\r\n  catchingPanel.Add(catchingFrame)\r\n  catchingFrame.color = barColor\r\n\r\n  // The grey sections above and below the fish, indicating valid zone\r\n  catchingZoneOutside = ui.AddPanel()\r\n  catchingPanel.Add(catchingZoneOutside)\r\n  catchingZoneOutside.style = horizontalBarsStyle\r\n  catchingZoneOutside.w = 11\r\n  catchingZoneOutside.h = 3\r\n  catchingZoneOutside.x = 7\r\n  catchingZoneOutside.y = 0\r\n  catchingZoneOutside.anchor = top_left\r\n  catchingZoneOutside.dock = top_left\r\n  catchingZoneOutside.color = #888888\r\n  catchingZoneInside = ui.AddPanel()\r\n  catchingPanel.Add(catchingZoneInside)\r\n  catchingZoneInside.style = horizontalBarsStyle\r\n  catchingZoneInside.w = 7\r\n  catchingZoneInside.h = 3\r\n  catchingZoneInside.x = 9\r\n  catchingZoneInside.y = 0\r\n  catchingZoneInside.anchor = top_left\r\n  catchingZoneInside.dock = top_left\r\n\r\n  // The progress bar inside the panel\r\n  catchingBar = ui.AddPanel()\r\n  catchingPanel.Add(catchingBar)\r\n  catchingBar.style = fullBoxStyle\r\n  catchingBar.x = 1\r\n  catchingBar.y = 3\r\n  catchingBar.w = 12\r\n  catchingBar.h = 1\r\n  catchingBar.anchor = top_left\r\n  catchingBar.dock = top_left\r\n\r\n  // Fish sprite inside panel\r\n  catchingFish = ui.AddAnim(ascii\r\n<°((><\r\nasciiend)\r\n  catchingPanel.Add(catchingFish)\r\n  catchingFish.x = 9\r\n  catchingFish.y = 1\r\n  catchingFish.anchor = top_left\r\n  catchingFish.dock = top_left\r\n  catchingFish.pivotX = -1\r\n\r\n\r\nfunc AddFTUE_UI()\r\n  var msg = te.xt(\"tid_fish_ftue_1\")\r\n  catchingFtueText = ui.AddText(msg)\r\n  catchingPanel.Add(catchingFtueText)\r\n  catchingFtueText.x = 0\r\n  catchingFtueText.y = 0\r\n  catchingFtueText.w = 69\r\n  catchingFtueText.h = 1\r\n  catchingFtueText.anchor = bottom_center\r\n  catchingFtueText.dock = top_center\r\n  catchingFtueText.align = center\r\n\r\n\r\nfunc RemoveCatchingUI()\r\n  catchingPanel.visible = false\r\n  ?catchingFtueText\r\n    catchingFtueText.text = \"\"\r\n  \r\n\r\nfunc OnPlayPressed()\r\n  SetState(Throwing)\r\n\r\n\r\nfunc Reset()\r\n  RemoveMenuUI()\r\n  SetState(Hidden)\r\n\r\n\r\nfunc GetState()\r\n  return state\r\n\r\n\r\nfunc SetState(newState)\r\n  //debug.Log(\"state = \" + state + \", newState = \" + newState)\r\n\r\n  // Exit state\r\n\r\n  ?state = Arriving\r\n    playerAnimWalk.visible = false\r\n    playerAnimArrived.visible = false\r\n\r\n  :?state = Menu\r\n    RemoveMenuUI()\r\n\r\n  :?state = Throwing\r\n    playerAnimThrowing.visible = false\r\n\r\n  :?state = Catching\r\n    RemoveCatchingUI()\r\n\r\n  :?state = Fail2\r\n    playerAnimCatching.visible = false\r\n\r\n  :?state = Success3\r\n    resultDialog.Hide()\r\n    playerAnimCatching.visible = false\r\n  \r\n\r\n  // Enter state\r\n\r\n  ?newState = Hidden\r\n    currentStateFunction = UpdateStateHidden\r\n\r\n  :?newState = Arriving\r\n    currentStateFunction = UpdateStateArriving\r\n    logo.Reset()\r\n    playerAnimWalk.visible = true\r\n    playerAnimWalk.Play()\r\n\r\n  :?newState = Menu\r\n    currentStateFunction = UpdateStateMenu\r\n    enable pause\r\n    AddMenuUI()\r\n    playerAnimThrowing.visible = true\r\n    playerAnimThrowing.frame = 0\r\n    ?playerAnimBigHead\r\n      playerAnimBigHead.flipX = true\r\n      playerAnimExpressions.frame = 0\r\n    \r\n  :?newState = Throwing\r\n    currentStateFunction = UpdateStateThrowing\r\n    logo.Hide()\r\n    disable pause\r\n    playerAnimThrowing.Play()\r\n\r\n  :?newState = Waiting\r\n    currentStateFunction = UpdateStateWaiting\r\n    playerAnimCatching.visible = true\r\n    playerAnimCatching.frame = 0\r\n\r\n  :?newState = FTUE\r\n    currentStateFunction = UpdateStateFTUE\r\n    AddCatchingUI()\r\n    AddFTUE_UI()\r\n    \r\n  :?newState = Catching\r\n    currentStateFunction = UpdateStateCatching\r\n    AddCatchingUI()\r\n  \r\n  :?newState = Fail1\r\n    currentStateFunction = UpdateStateFail1\r\n    playerAnimCatching.frame = 1\r\n    ?playerAnimExpressions\r\n      playerAnimExpressions.frame = 1\r\n\r\n  :?newState = Fail2\r\n    currentStateFunction = UpdateStateFail2\r\n    play error\r\n    playerAnimCatching.frame = 2\r\n    ?playerAnimExpressions\r\n      playerAnimExpressions.frame = 2\r\n\r\n  :?newState = Success1\r\n    currentStateFunction = UpdateStateSuccess1\r\n    playerAnimCatching.frame = 1\r\n    ?playerAnimExpressions\r\n      playerAnimExpressions.frame = 1\r\n\r\n  :?newState = Success2\r\n    currentStateFunction = UpdateStateSuccess2\r\n    play pickup_success\r\n    playerAnimCatching.frame = 2\r\n    ?playerAnimExpressions\r\n      playerAnimExpressions.frame = 3\r\n\r\n  :?newState = Success3\r\n    currentStateFunction = UpdateStateSuccess3\r\n    x = screen.w / 2 - 27\r\n    y = screen.h / 2 - 5\r\n    flyup.Show(x, y, string.Format(te.xt(tid_fish_scales), fish.scales))\r\n    progress.AddScales(fish.scales)\r\n    topHud.Update()\r\n    var isRecordWeight = progress.CheckRecord(fish.scales)\r\n    resultDialog.Show(fish, isRecordWeight)\r\n\r\n  :?newState = Shop\r\n    currentStateFunction = UpdateStateShop\r\n\r\n  state = newState\r\n  stateTime = 0\r\n\r\n\r\nvar rod\r\n\r\nfunc Init()\r\n  ?!rod\r\n    rod = rodFactory.MakeRod(progress.rod)\r\n\r\n    disable hud\r\n    disable player\r\n\r\n    topHud.Init()\r\n    logo.Init(version)\r\n    resultDialog.Init()\r\n    InitPlayerAnimations()\r\n\r\n\r\nfunc UpdateStateHidden()\r\n  Init()\r\n  SetState(Arriving)\r\n\r\n\r\nfunc UpdateStateArriving()\r\n  logo.Update()\r\n  UpdatePlayerAnimPosition()\r\n\r\n  ?stateTime = 105\r\n    logo.Show()\r\n\r\n  :?stateTime = 168\r\n    playerAnimWalk.visible = false\r\n    playerAnimArrived.visible = true\r\n    playerAnimArrived.Play()\r\n\r\n  :?stateTime >= 177\r\n    SetState(Menu)\r\n\r\n\r\nfunc UpdateStateMenu()\r\n  logo.Update()\r\n  flyup.Update()\r\n  // Wait for button event to OnPlayPressed\r\n\r\n\r\nfunc UpdateStateThrowing()\r\n  logo.Update()\r\n\r\n  ?key = backBegin\r\n    SetState(Menu)\r\n\r\n  ?stateTime = 5\r\n    play grappling_idle\r\n\r\n  :?stateTime = 13\r\n    play cross_deadwood_row\r\n\r\n  :?stateTime >= 18\r\n    SetState(Waiting)\r\n\r\n\r\nfunc UpdateStateWaiting()\r\n  logo.Update()\r\n\r\n  ?key = backBegin\r\n    SetState(Menu)\r\n    logo.Show()\r\n\r\n  :?stateTime >= waitTimeMin\r\n    ?catchingFtueText = null & progress.IsFTUE()\r\n      SetState(FTUE)\r\n    :\r\n      SetState(Catching)\r\n\r\n    play haunted_gate_shuffle_fast\r\n\r\n    // Reset progress bar\r\n    progressValue = fishArea * 3 / 5\r\n\r\n    // Reset fish\r\n    fishPos = fishLimit / 2\r\n    fishSpeed = 0\r\n\r\n    fish = fishFactory.MakeFish(rod.minFish, rod.maxFish)\r\n    catchingFish.color = fish.color\r\n    fishAccel = fish.acceleration\r\n\r\n\r\nfunc UpdateStateFTUE()\r\n  catchingFtueText.visible = true\r\n\r\n  ?key = primaryBegin\r\n    var msg = te.xt(\"tid_fish_ftue_2\") + \"\\n\" + te.xt(\"tid_fish_ftue_3\") + \"\\n\" + \" ↓ \"\r\n    catchingFtueText.text = msg\r\n    catchingFtueText.h = 3\r\n\r\n    SetState(Catching)\r\n\r\n  // Blink FTUE text\r\n  :?time % 18 >= 9\r\n    catchingFtueText.visible = false\r\n\r\n\r\nfunc UpdateStateCatching()\r\n\r\n// TODO - For debug only\r\n    //?key = backBegin\r\n    //  SetState(Menu)\r\n    //:?key = ability1Begin\r\n    //  SetState(Success1)\r\n\r\n    // Select player anim frame based on primary input or not\r\n    ?key = primary\r\n      playerAnimCatching.frame = 1\r\n    :\r\n      playerAnimCatching.frame = 0\r\n\r\n    // Control the fishing rod\r\n    ?key = primaryBegin\r\n      fishSpeed += reelImpulse\r\n\r\n    // Apply force of fish pulling away\r\n    fishSpeed -= fishAccel\r\n\r\n    // Frame skip to gain performance\r\n    ?stateTime % 2 = 0\r\n      return\r\n\r\n    // Constrain speed\r\n    fishSpeed = math.Clamp(fishSpeed, fishMinSpeed, fishMaxSpeed)\r\n\r\n    // Simulate\r\n    fishPos += fishSpeed + fishSpeed\r\n\r\n    // Constrain position\r\n    fishPos = math.Clamp(fishPos, 0, fishLimit)\r\n\r\n    // Update progress\r\n    ?fishPos < reelBadLow | fishPos > reelBadHigh\r\n      // Bad area\r\n      catchingBar.color = #ff0000\r\n      progressValue -= progressNegative\r\n      ?progressValue < 0\r\n        // Failure condition\r\n        SetState(Fail1)\r\n\r\n    :?fishPos >= reelGoodLow & fishPos <= reelGoodHigh\r\n      // Good area\r\n      catchingBar.color = #ffffff\r\n      progressValue += progressPositive\r\n      ?progressValue > fishArea\r\n        // Victory condition\r\n        SetState(Success1)\r\n    :\r\n      // Neutral area\r\n      catchingBar.color = #bbbbbb\r\n\r\n    // Update UI components to match simulation\r\n    catchingBar.w = math.CeilToInt(progressValue / 100.0)\r\n    catchingFish.x = fishPos / 100\r\n\r\n\r\nfunc UpdateStateFail1()\r\n  ?stateTime >= 20\r\n    SetState(Fail2)\r\n\r\n\r\nfunc UpdateStateFail2()\r\n  ?key = primaryBegin & stateTime > 1\r\n    SetState(Menu)\r\n    logo.Show()\r\n\r\n  // Failure message\r\n  ?fishPos < fishLimit / 2\r\n    >o-4,-4,@te.xt(tid_fish_got_away)@\r\n  :\r\n    >o-4,-4,@te.xt(tid_fish_line_snapped)@\r\n\r\n\r\nfunc UpdateStateSuccess1()\r\n  ?stateTime >= 30\r\n    SetState(Success2)\r\n\r\n\r\nfunc UpdateStateSuccess2()\r\n  ?stateTime >= 45 & !preventStateSuccess3\r\n    SetState(Success3)\r\n  \r\n  // Draw the fish\r\n  fish.DrawO(-15, 1)\r\n\r\n\r\nfunc UpdateStateSuccess3()\r\n  flyup.Update()\r\n\r\n  ?key = primaryBegin & stateTime > 1\r\n    SetState(Menu)\r\n    logo.Show()\r\n  \r\n  // Draw the fish\r\n  fish.DrawO(-15, 1)\r\n\r\n\r\nfunc UpdateStateShop()\r\n  ?key = backBegin\r\n    SetState(Menu)\r\n  :\r\n    shop.Update()\r\n\r\n\r\nfunc Update()\r\n  stateTime++\r\n  currentStateFunction()\r\n\r\n// TODO - Debug state\r\n//  >`0,0,State: @state@\r\n//  >`0,1,STime: @stateTime@\r\n\r\n\r\nfunc UpdatePlayerAnimPosition()\r\n  playerAnimRoot.x = screen.FromWorldX(pos.x)\r\n  playerAnimRoot.y = screen.FromWorldZ(pos.z - pos.y) - 2\r\n\r\n\r\nfunc InitPlayerAnimations()\r\n  playerAnimRoot = ui.AddPanel()\r\n  playerAnimRoot.w = 1\r\n  playerAnimRoot.h = 1\r\n  playerAnimRoot.dock = top_left\r\n\r\n  AddPlayerAnimWalk()\r\n  AddPlayerAnimArrived()\r\n  AddPlayerAnimThrowing()\r\n  AddPlayerAnimCatching()\r\n  AddPlayerAnimBigHead()\r\n\r\n\r\nfunc AddPlayerAnimWalk()\r\n  // Base layer\r\n  playerAnimWalk = ui.AddAnim(artPlayerWalk1)\r\n  playerAnimRoot.Add(playerAnimWalk)\r\n  playerAnimWalk.visible = false\r\n  playerAnimWalk.anchor = top_left\r\n  playerAnimWalk.pivotX = 5\r\n  playerAnimWalk.pivotY = 0\r\n  playerAnimWalk.duration = 15\r\n  playerAnimWalk.loop = true\r\n  // Rod\r\n  var layer3 = playerAnimWalk.AddLayer(artPlayerWalk2)\r\n  layer3.color = rod.color\r\n  layer3.pivotX = 5\r\n  layer3.pivotY = 0\r\n  // Line\r\n  var layer4 = playerAnimWalk.AddLayer(artPlayerWalk3)\r\n  layer4.color = rod.lineColor\r\n  layer4.pivotX = 5\r\n  layer4.pivotY = 0\r\n\r\n\r\nfunc AddPlayerAnimArrived()\r\n  // Base layer\r\n  playerAnimArrived = ui.AddAnim(artPlayerArrived1)\r\n  playerAnimRoot.Add(playerAnimArrived)\r\n  playerAnimArrived.visible = false\r\n  playerAnimArrived.anchor = top_left\r\n  playerAnimArrived.pivotX = 5\r\n  playerAnimArrived.pivotY = 2\r\n  playerAnimArrived.duration = 9\r\n  // Rod\r\n  var layer3 = playerAnimArrived.AddLayer(artPlayerArrived2)\r\n  layer3.color = rod.color\r\n  layer3.pivotX = 5\r\n  layer3.pivotY = 2\r\n  // Line\r\n  var layer4 = playerAnimArrived.AddLayer(artPlayerArrived3)\r\n  layer4.color = rod.lineColor\r\n  layer4.pivotX = 5\r\n  layer4.pivotY = 2\r\n\r\n\r\nfunc AddPlayerAnimThrowing()\r\n  // Base layer\r\n  playerAnimThrowing = ui.AddAnim(artPlayerThrowing1)\r\n  playerAnimRoot.Add(playerAnimThrowing)\r\n  playerAnimThrowing.visible = false\r\n  playerAnimThrowing.anchor = top_left\r\n  playerAnimThrowing.pivotX = 18\r\n  playerAnimThrowing.pivotY = 3\r\n  playerAnimThrowing.duration = 18\r\n  // Rod\r\n  var layer3 = playerAnimThrowing.AddLayer(artPlayerThrowing2)\r\n  layer3.color = rod.color\r\n  layer3.pivotX = 18\r\n  layer3.pivotY = 3\r\n  // Line\r\n  var layer4 = playerAnimThrowing.AddLayer(artPlayerThrowing3)\r\n  layer4.color = rod.lineColor\r\n  layer4.pivotX = 18\r\n  layer4.pivotY = 3\r\n\r\n\r\nfunc AddPlayerAnimCatching()\r\n  // Base layer\r\n  playerAnimCatching = ui.AddAnim(artPlayerCatching1)\r\n  playerAnimRoot.Add(playerAnimCatching)\r\n  playerAnimCatching.visible = false\r\n  playerAnimCatching.anchor = top_left\r\n  playerAnimCatching.pivotX = 18\r\n  playerAnimCatching.pivotY = 3\r\n  // Rod\r\n  var layer3 = playerAnimCatching.AddLayer(artPlayerCatching2)\r\n  layer3.color = rod.color\r\n  layer3.pivotX = 4\r\n  layer3.pivotY = 3\r\n  // Line\r\n  var layer4 = playerAnimCatching.AddLayer(artPlayerCatching3)\r\n  layer4.color = rod.lineColor\r\n  layer4.pivotX = 18\r\n  layer4.pivotY = 3\r\n  // Water\r\n  var layer2 = playerAnimCatching.AddLayer(artPlayerCatching4)\r\n  layer2.color = #bbbbbb\r\n  layer2.pivotX = 18\r\n  layer2.pivotY = -7\r\n\r\n\r\nfunc AddPlayerAnimBigHead()\r\n  ?bighead\r\n    playerAnimBigHead = ui.AddAnim(artBigHead)\r\n    playerAnimRoot.Add(playerAnimBigHead)\r\n    playerAnimBigHead.anchor = top_left\r\n    playerAnimBigHead.pivotX = 2\r\n    playerAnimBigHead.pivotY = 2\r\n    playerAnimBigHead.duration = 90\r\n    playerAnimBigHead.loop = true\r\n    playerAnimBigHead.Play()\r\n\r\n    playerAnimExpressions = ui.AddAnim(artBigHeadExpressions)\r\n    playerAnimRoot.Add(playerAnimExpressions)\r\n    playerAnimExpressions.anchor = top_left\r\n    playerAnimExpressions.pivotX = 2\r\n    playerAnimExpressions.pivotY = 1\r\n\r\n\r\nconst artPlayerWalk1 = ascii\r\n#____O__\r\n`-´\"/|´ !\r\n####/ \\\r\n%%\r\n#____O__\r\n`-´\"/|´ !\r\n#####>\\\r\n%%\r\n#____O__\r\n`-´\"/|´ !\r\n#####|\\\r\n%%\r\n#____O__\r\n`-´\"/|´ !\r\n#####|>\r\nasciiend\r\n\r\nconst artPlayerWalk2 = ascii\r\n#____#__\r\n`-´\"### !\r\nasciiend\r\n\r\nconst artPlayerWalk3 = ascii\r\n#\r\n`-´\"### !\r\nasciiend\r\n\r\n\r\nconst artPlayerArrived1 = ascii\r\n###,\r\n###!\\\r\n####`O\r\n####(|\\\r\n####/ \\\r\n%%\r\n######,\r\n#####;|\r\n#####O|\r\n#####\\|\r\n####/ \\\r\n%%\r\n#########,\r\n########/;\r\n#####O_/´\r\n#####\\/!\r\n####/ \\\r\nasciiend\r\n\r\nconst artPlayerArrived2 = ascii\r\n###,\r\n###!\\\r\n####`#\r\n######\\\r\n%%\r\n######,\r\n#####;|\r\n######|\r\n######|\r\n%%\r\n#########,\r\n########/;\r\n#######/´\r\n######/!\r\nasciiend\r\n\r\nconst artPlayerArrived3 = ascii\r\n###,\r\n###!\r\n####`\r\n%%\r\n######,\r\n#####;\r\n%%\r\n#\r\n#########;\r\n########´\r\n#######!\r\nasciiend\r\n\r\n\r\nconst artPlayerThrowing1 = ascii\r\n#\r\n#\r\n######################,\r\n##################O  /;\r\n#################(|`/´\r\n#################/ /!\r\n%%\r\n#\r\n###################,\r\n#################,´|\r\n#################`O|\r\n##################\\|`,\r\n#################/ \\\r\n%%\r\n#\r\n####################/)\r\n###################/;\r\n##################/)'-.\r\n#################`|   '\r\n#################/ \\\r\n%%\r\n####################,\r\n###################/`,\r\n##################/ (\r\n################°(O  `-.\r\n################ `|\r\n################ / \\\r\n%%\r\n#################,_\r\n#################| `.\r\n#################|   \\\r\n################°(O   `.\r\n################ `|\r\n################ / \\\r\n%%\r\n################,\r\n################|`-.\r\n################|   `.\r\n###############°|\\O   `\r\n###############  `|\r\n###############  / \\\r\n%%\r\n#\r\n############.-,--._\r\n###########'-´#\\   `\r\n################\\_O\r\n################°\\/\r\n################ / \\\r\n%%\r\n#\r\n###########_.-,\r\n#########,´ .´#\\\r\n#########`-´### \\_O\r\n############### °\\/\r\n###############  / \\\r\n%%\r\n#\r\n##############,\r\n######.'´###.´#\\\r\n#####(___.-´### \\_O\r\n############### °\\/\r\n###############  / \\\r\n%%\r\n#\r\n##############,\r\n############.´ \\\r\n###########/    \\_O\r\n#########.´     °\\/\r\n###,####/        / \\\r\n##(__.-´\r\n%%\r\nasciiend\r\n\r\nconst artPlayerThrowing2 = ascii\r\n#\r\n#\r\n######################,\r\n#####################/;\r\n####################/´\r\n###################/!\r\n%%\r\n#\r\n###################,\r\n#################,´|\r\n#################`#|\r\n###################|`,\r\n%%\r\n#\r\n####################/)\r\n###################/;\r\n##################/#'-.\r\n###################   '\r\n%%\r\n####################,\r\n###################/`,\r\n##################/ (\r\n################°##  `-.\r\n%%\r\n#################,_\r\n#################| `.\r\n#################|   \\\r\n################°##   `.\r\n%%\r\n################,\r\n################|`-.\r\n################|   `.\r\n###############°|##   `\r\n%%\r\n#\r\n############.-,--._\r\n###########'-´#\\   `\r\n################\\\r\n################°\\\r\n%%\r\n#\r\n###########_.-,\r\n#########,´ .´#\\\r\n#########`-´### \\\r\n############### °\\\r\n%%\r\n#\r\n##############,\r\n######.'´###.´#\\\r\n#####(___.-´### \\\r\n############### °\\\r\n%%\r\n#\r\n##############,\r\n############.´ \\\r\n###########/    \\\r\n#########.´     °\\\r\n###,####/\r\n##(__.-´\r\n%%\r\nasciiend\r\n\r\nconst artPlayerThrowing3 = ascii\r\n#\r\n#\r\n#\r\n######################;\r\n#####################´\r\n####################!\r\n%%\r\n#\r\n###################\r\n#################,´\r\n#################`\r\n####################`,\r\n%%\r\n#\r\n#####################)\r\n####################;\r\n####################'-.\r\n###################   '\r\n%%\r\n#\r\n####################`,\r\n################### (\r\n###################  `-.\r\n%%\r\n##################_\r\n################## `.\r\n##################   \\\r\n###################   `.\r\n%%\r\n#\r\n#################`-.\r\n#################   `.\r\n###################   `\r\n%%\r\n#\r\n############.-#--._\r\n###########'-´##   `\r\n%%\r\n#\r\n###########_.-\r\n#########,´ .´\r\n#########`-´\r\n%%\r\n#\r\n#\r\n######.'´###.´\r\n#####(___.-´\r\n%%\r\n#\r\n#\r\n############.´\r\n###########/\r\n#########.´\r\n###,####/\r\n##(__.-´\r\n%%\r\nasciiend\r\n\r\n\r\nconst artPlayerCatching1 = ascii\r\n#\r\n##############,\r\n############.´ \\\r\n###########/    \\_O\r\n#########.´     °\\/\r\n########/        / \\\r\n######.´\r\n#####/\r\n###.´\r\n##/\r\n,´__ _\r\n%%\r\n################,\r\n##############.´|\r\n#############/  |\r\n############/  °|\\O\r\n##########.´     `|\r\n#########/       / \\\r\n########/\r\n######.´\r\n#####/\r\n####/\r\n##,´__ _\r\n%%\r\n#################__\r\n##############.´  /\r\n#############/  ./  !\r\n####,-.#####/   /(O\r\n###´###`._.´     `|\r\n########         / \\\r\nasciiend\r\n\r\nconst artPlayerCatching2 = ascii\r\n#\r\n,\r\n \\\r\n  \\\r\n  °\\\r\n%%\r\n##,\r\n  |\r\n  |\r\n °|\r\n%%\r\n#\r\n    /\r\n  ./\r\n  /\r\nasciiend\r\n\r\nconst artPlayerCatching3 = ascii\r\n#\r\n#\r\n############.´\r\n###########/\r\n#########.´\r\n########/\r\n######.´\r\n#####/\r\n###.´\r\n##/\r\n,´\r\n%%\r\n#\r\n##############.´\r\n#############/\r\n############/\r\n##########.´\r\n#########/\r\n########/\r\n######.´\r\n#####/\r\n####/\r\n##,´\r\n%%\r\n#################__\r\n##############.´\r\n#############/\r\n####,-.#####/\r\n###´###`._.´\r\nasciiend\r\n\r\nconst artPlayerCatching4 = ascii\r\n##__ _\r\n%%\r\n####__ _\r\n%%\r\n###\r\nasciiend\r\n\r\n\r\nconst artBigHead = ascii\r\n#.-.\r\n(   )\r\n#`·´\r\n%% {repeat:14}\r\n#.-.\r\n( '')\r\n#`·´\r\nasciiend\r\n\r\nconst artBigHeadExpressions = ascii\r\n#####\r\n%%\r\n(--')\r\n%%\r\n(TT )\r\n%%\r\n(^^ )\r\nasciiend\r\n\r\n\r\nSetState(Hidden)\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Fishing/ResultsDialog.txt" - Parse error: Failed to parse completely. Remaining: "?isRecord\r\n    isRecordText.visible = inherit\r\n  :\r\n    isRecordText.visible = false\r\n\r\n\r\nfunc Hide()\r\n  panel.visible = false\r\n  \r\n\r\nfunc Init()\r\n  panel = ui.AddPanel()\r\n  panel.visible = false\r\n  panel.ax = right\r\n  panel.dx = right\r\n  panel.x = -16\r\n  panel.w = 1\r\n  panel.h = 1\r\n  // Background frame\r\n  var bg = ui.AddAnim(ascii\r\n#########/\\\r\n#_#######\\/#######_\r\n(______/\\/\\/\\______)\r\n#                  #\r\n#                  #\r\n#                  #\r\n#                  #\r\n#                  #\r\n#                  #\r\n#                  #\r\n#                  #\r\n#                  #\r\n#                  #\r\n#______      ______#\r\n(_#####\\/\\/\\/#####_)\r\n#########/\\\r\n#########\\/\r\nasciiend)\r\n  bg.color = #666666\r\n  panel.Add(bg)\r\n  // Title\r\n  nameText = ui.AddText()\r\n  nameText.align = center\r\n  nameText.x = 1\r\n  nameText.y = -2\r\n  nameText.w = 18\r\n  panel.Add(nameText)\r\n  // Fish icon\r\n  icon = ui.AddAnim(\"\")\r\n  icon.ax = left\r\n  icon.dock = center_center\r\n  icon.x = -4\r\n  icon.y = -2\r\n  panel.Add(icon)\r\n  // Fish weight\r\n  weightText = ui.AddText()\r\n  weightText.align = center\r\n  weightText.y = 4\r\n  weightText.w = 18\r\n  panel.Add(weightText)\r\n  // Label displayed if the fish's weight is your best\r\n  isRecordText = ui.AddText()\r\n  isRecordText.align = center\r\n  isRecordText.y = 5\r\n  isRecordText.w = 18\r\n  isRecordText.text = te.xt(tid_fish_ui_record)\r\n  panel.Add(isRecordText)\r\n\r\n\r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Fishing/FishData.txt" - Parse error: Failed to parse completely. Remaining: "= \"\"\r\nvar art = \"\"\r\nvar color = #ffffff\r\nvar rodPivotX = 7\r\nvar rodPivotY = 1\r\nvar height = 3\r\n\r\nvar scalesMin = 0\r\nvar scalesMax = 0\r\nvar scales = 0\r\nvar weight = \"\"\r\n\r\nvar acceleration = 10\r\n\r\n\r\nfunc Draw(x, y)\r\n  >`@x@,@y@,@color@,@art@\r\n\r\nfunc DrawO(x, y)\r\n  x = x - rodPivotX\r\n  y = y - rodPivotY\r\n  >o@x@,@y@,@color@,@art@\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Fishing/FishingLogo.txt" - Parse error: Failed to parse completely. Remaining: "= \"\"\r\nvar isDisabled = true\r\nvar logoIn = false\r\nvar logoOut = false\r\nvar panel\r\n\r\n\r\nfunc Init(versionStr)\r\n  panel = ui.AddPanel()\r\n  panel.visible = false\r\n  panel.dock = top_right\r\n  panel.anchor = top_right\r\n  panel.w = 1\r\n  panel.h = 1\r\n  panel.x = 0\r\n  panel.y = 4\r\n\r\n  var versionNumber = ui.AddText()\r\n  versionNumber.visible = true\r\n  versionNumber.w = 16\r\n  \r\n  ?te.language = \"ZH-CN\"\r\n    var imgStr = ascii\r\n###┌-.####┌-.#######┌-.#######.-,##.-,\r\n#┌-┘ └-.--┘ └--. ┌--┘ └--.  .' /_ / /___\r\n#'-. .-'--. .--' '--. .--'.'.---´/ ,--. |\r\n##.' '. __| |__    ,' '. └-´|‾‾‾|`´   | |\r\n#; . .-┘  ___  |  / . . .   _| |_ \\`. | |\r\n└-´| | | |   | | ' /| |\\ \\ |_   _| \\/ | |\r\n###| | | └---┘ |└-´ | | `-┘  | |_  ___| |\r\n###'-'#|.-----.|    '-'      '__/  '.__/\r\n##############                #\r\nasciiend\r\n    var img = ui.AddAnim(imgStr)\r\n    img.visible = true\r\n    panel.Add(img)\r\n    img.x = 23\r\n    img.y = 1\r\n\r\n    panel.Add(versionNumber)\r\n    versionNumber.text = \"阿尔法 v\" + versionStr\r\n    versionNumber.x = 26\r\n    versionNumber.y = 8\r\n  :\r\n    var imgStrA = ascii\r\n   __   #########  __ #################__\r\n  /  \\ __  __ _ __/ /_ _ _  __  __  __/ /\r\n / / // _\\/. `//. `// / / )/. \\/. \\/. `/\r\n/__.´ \\__/\\_,/ \\_,/ \\_,._/ \\__/\\__/\\_,/\r\nasciiend\r\n    var imgStrB = ascii\r\n###____ __#####__###__\r\n##/ __//_/___#/ /##/_/_ _##__ _\r\n#/ _/ / /( _// ´‾)/ // ` )/. `/\r\n/_/  /_//` )/_/_//_//_/_/ \\  /\r\n#########‾‾########     \\-´ /\r\n#########################‾‾‾\r\nasciiend\r\n    var img = ui.AddAnim(imgStrA)\r\n    img.visible = true\r\n    panel.Add(img)\r\n    img.x = 22\r\n    img.y = 0\r\n\r\n    img = ui.AddAnim(imgStrB)\r\n    img.visible = true\r\n    panel.Add(img)\r\n    img.x = 22\r\n    img.y = 5\r\n\r\n    panel.Add(versionNumber)\r\n    versionNumber.text = \"ALPHA v\" + versionStr\r\n    versionNumber.x = 25\r\n    versionNumber.y = 9\r\n\r\n\r\nfunc Reset()\r\n  isDisabled = true\r\n  logoIn = false\r\n  logoOut = false\r\n\r\n\r\nfunc Show()\r\n  isDisabled = false\r\n  logoIn = true\r\n  logoOut = false\r\n  panel.x = 0\r\n\r\n\r\nfunc Hide()\r\n  isDisabled = false\r\n  logoIn = false\r\n  logoOut = true\r\n\r\n\r\nfunc Update()\r\n  ?isDisabled\r\n    return\r\n\r\n  ?logoOut\r\n    panel.x += 2\r\n    ?panel.x >= 0\r\n      Reset()\r\n  :?logoIn\r\n    panel.x -= 2\r\n    ?panel.x <= -44\r\n      panel.x = -44\r\n      logoIn = false\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/FlyupText.txt" - Parse error: Failed to parse completely. Remaining: "= \"\"\r\nvar color = #white\r\nvar x = 0\r\nvar y = 0\r\nvar frames = 0\r\nvar flyupTime = 7\r\nvar holdTime = 13\r\nvar isActive = false\r\n\r\n\r\nfunc Show(x, y, msg)\r\n  isActive = true\r\n  this.x = x\r\n  this.y = y\r\n  message = msg\r\n  frames = 0\r\n\r\n\r\nfunc Update()\r\n  ?isActive\r\n    frames++\r\n    ?frames <= flyupTime\r\n      ?frames % 2 = 0\r\n        y--\r\n    \r\n    ?frames <= flyupTime + holdTime\r\n      >`@x@,@y@,@color@,@message@\r\n    :\r\n      isActive = false"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/DigitsPuzzle/CustomPuzzle.txt" - Parse error: Failed to parse completely. Remaining: "= \"01020304050607080910111213140015\""
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/DigitsPuzzle/DigitsPuzzleCore.txt" - Parse error: Failed to parse completely. Remaining: "= []\r\nvar puzzleRowCount = 0\r\nvar puzzleColCount = 0\r\n\r\nvar runningPuzzle = []\r\nvar panelWidth = 0\r\nvar panelHeight = 0\r\nvar panelPosX = 0\r\nvar panelPosY = 0\r\n\r\n//Index of current EMPTY cell (digit = 0)\r\nvar emptyRowIndex = 0\r\nvar emptyColIndex = 0\r\n\r\nfunc InitGame(isCustomPuzzle)\r\n  InitPanel()\r\n  return InitRunningPuzzle(isCustomPuzzle)\r\n\r\nfunc InitPanel()\r\n  var tempCell = new Games/DigitsPuzzle/DigitCell\r\n  panelWidth = tempCell.boxWidth * puzzleGenerator.COL_COUNT + 2\r\n  panelHeight = tempCell.boxHeight * puzzleGenerator.ROW_COUNT + 2\r\n  panelPosX = (screen.w - panelWidth) / 2\r\n  panelPosY = (screen.h - panelHeight) / 2\r\n\r\nfunc InitRunningPuzzle(isCustomPuzzle)\r\n  puzzle = puzzleGenerator.GetPuzzle(isCustomPuzzle)\r\n  ?puzzle = null\r\n    return false\r\n  puzzleRowCount = puzzle.Count()\r\n  puzzleColCount = puzzle[0].Count()\r\n  ResetGame()\r\n  return true\r\n\r\nfunc ResetGame()\r\n  runningPuzzle = []\r\n  var oneDigitCell = null\r\n  for i = 0 .. puzzle.Count() - 1\r\n    var oneRow = null\r\n    oneRow = []\r\n    for j = 0 .. puzzle[i].Count() - 1\r\n      oneDigitCell = new Games/DigitsPuzzle/DigitCell\r\n      oneDigitCell.digit = puzzle[i][j]\r\n      oneDigitCell.digitColor = white\r\n      oneDigitCell.boxPosX = panelPosX + 1 + j * oneDigitCell.boxWidth\r\n      oneDigitCell.boxPosY = panelPosY + 1 + i * oneDigitCell.boxHeight\r\n      oneRow.Add(oneDigitCell)\r\n\r\n      ?puzzle[i][j] = 0\r\n        emptyRowIndex = i\r\n        emptyColIndex = j\r\n\r\n    runningPuzzle.Add(oneRow)\r\n\r\nfunc JudgeToWin()\r\n  for i = 0 .. runningPuzzle.Count() - 1\r\n    for j = 0 .. runningPuzzle[i].Count() - 1\r\n      ?runningPuzzle[i][j].digit = (i * puzzleRowCount + j + 1)\r\n        runningPuzzle[i][j].digitColor = rainFF\r\n      :\r\n        runningPuzzle[i][j].digitColor = white\r\n\r\n  ?emptyRowIndex = puzzleRowCount - 1 & emptyColIndex = puzzleColCount - 1\r\n    for i = 0 .. runningPuzzle.Count() - 1\r\n      for j = 0 .. runningPuzzle[i].Count() - 1\r\n        ?runningPuzzle[i][j].digit ! 0 & runningPuzzle[i][j].digit ! (i * puzzleRowCount + j + 1)\r\n          return false\r\n\r\n    return true\r\n  :\r\n    return false\r\n\r\n//Show the game, but hide empty cell. \r\nfunc ShowGame()\r\n  draw.Box(panelPosX, panelPosY, panelWidth, panelHeight, white, 2)\r\n  for i = 0 .. runningPuzzle.Count() - 1\r\n    for j = 0 .. runningPuzzle[i].Count() - 1\r\n      ?runningPuzzle[i][j].digit ! 0\r\n        runningPuzzle[i][j].Show()\r\n\r\n//Exchange digits to move the cell, instead of moving the cell itself. \r\nfunc MoveUp()\r\n  ?emptyRowIndex < runningPuzzle[0].Count() - 1\r\n    runningPuzzle[emptyRowIndex][emptyColIndex].digit = runningPuzzle[emptyRowIndex + 1][emptyColIndex].digit\r\n    runningPuzzle[emptyRowIndex + 1][emptyColIndex].digit = 0\r\n    emptyRowIndex++\r\n\r\nfunc MoveRight()\r\n  ?emptyColIndex > 0\r\n    runningPuzzle[emptyRowIndex][emptyColIndex].digit = runningPuzzle[emptyRowIndex][emptyColIndex - 1].digit\r\n    runningPuzzle[emptyRowIndex][emptyColIndex - 1].digit = 0\r\n    emptyColIndex--\r\n\r\nfunc MoveDown()\r\n  ?emptyRowIndex > 0\r\n    runningPuzzle[emptyRowIndex][emptyColIndex].digit = runningPuzzle[emptyRowIndex - 1][emptyColIndex].digit\r\n    runningPuzzle[emptyRowIndex - 1][emptyColIndex].digit = 0\r\n    emptyRowIndex--\r\n\r\nfunc MoveLeft()\r\n  ?emptyColIndex < runningPuzzle.Count() - 1\r\n    runningPuzzle[emptyRowIndex][emptyColIndex].digit = runningPuzzle[emptyRowIndex][emptyColIndex + 1].digit\r\n    runningPuzzle[emptyRowIndex][emptyColIndex + 1].digit = 0\r\n    emptyColIndex++\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/DigitsPuzzle/PuzzleGenerator.txt" - Parse error: Failed to parse completely. Remaining: "= []\r\nvar ROW_COUNT = 4\r\nvar COL_COUNT = 4\r\nvar CELL_COUNT = ROW_COUNT * COL_COUNT\r\nvar PARSE_STEP = 2\r\n\r\nInitPuzzleCodePool()\r\n\r\nfunc GetPuzzle(isCustomPuzzle)\r\n  var puzzleCode\r\n  ?isCustomPuzzle\r\n    var cusPuzzleClass = new Games/DigitsPuzzle/CustomPuzzle\r\n    puzzleCode = cusPuzzleClass.CUSTOM_PUZZLE_CODE\r\n  :\r\n    var codeCount = PUZZLE_CODE_POOL.Count()\r\n    var min = 0\r\n    var max = PUZZLE_CODE_POOL.Count() - 1\r\n    var codeIndex = min + rng % (max - min + 1)\r\n    puzzleCode = PUZZLE_CODE_POOL[codeIndex]\r\n  return ParsePuzzleFromCode(puzzleCode)\r\n\r\nfunc ParsePuzzleFromCode(puzzleCode)\r\n  var codeLength = string.Size(puzzleCode)\r\n  ?codeLength = CELL_COUNT * PARSE_STEP\r\n    var puzzle = []\r\n    var cellRow = []  \r\n    var temp = \"\"\r\n    for i = 0 .. CELL_COUNT - 1\r\n      temp = string.Sub(puzzleCode, i * PARSE_STEP, PARSE_STEP)    \r\n      cellRow.Add(int.Parse(temp))\r\n      ?i % COL_COUNT = COL_COUNT - 1\r\n        puzzle.Add(cellRow)\r\n        cellRow = []\r\n    return puzzle\r\n  :\r\n    return null\r\n\r\nfunc InitPuzzleCodePool()\r\n  PUZZLE_CODE_POOL = [\r\n    \"02101105060701030812150414130900\",\r\n    \"11041407130612030508021009001501\",\r\n    \"06140002010507031112041008130915\",\r\n    \"07040015060208141112010313100905\",\r\n    \"12060702131103011504081410050900\",\r\n    \"09080412140510000213061501070311\",\r\n    \"13070214110610001508040905011203\",\r\n    \"11130903040607120010150102140508\",\r\n    \"08120513020604000301111409101507\",\r\n    \"05090713021208110015010304141006\",\r\n    \"10030013151209020104060511071408\",\r\n    \"03060914131101101215040205070800\",\r\n    \"11011405060810151309000403120702\",\r\n    \"11121309041401000210050308061507\",\r\n    \"12070406011405101508000902031311\",\r\n    \"11130001071404031210080205061509\",\r\n    \"05140601131511030409000212081007\",\r\n    \"14060003051309150408120102071011\",\r\n    \"08070402121306031410051511090100\",\r\n    \"11090806151312000207140403100105\",\r\n    \"01081405071303001002150609041112\",\r\n    \"04091408031307011006050215121100\",\r\n    \"14021312070511150410030801090600\",\r\n    \"06121105140301041307001009081502\",\r\n    \"06151105101202091314080107040300\",\r\n    \"04110901050215071213100308140600\",\r\n    \"11130706020901001415121003050408\",\r\n    \"07110012100508010413140906030215\",\r\n    \"09060407120501111503101408001302\",\r\n    \"10090005141201061315030411070802\",\r\n    \"12061102090804000710050113150314\",\r\n    \"07150103120805000213091404100611\",\r\n    \"11020012091307011008030415140605\",\r\n    \"12010813070906001105140402031015\",\r\n    \"12091102150601031307051410000408\",\r\n    \"02011405110608000904070312131510\",\r\n    \"15130403020614001012090705081101\",\r\n    \"06071011040515020301081309001214\",\r\n    \"05061114090415030210000807120113\",\r\n    \"05071011090112060213001403081504\",\r\n    \"15051107140106020308100413091200\",\r\n    \"09010611021012140703000513150408\",\r\n    \"07110004011015130805030912140206\",\r\n    \"10081211090715000302050113041406\",\r\n    \"08011113151002140709000504120306\",\r\n    \"11100214011513040008050703091206\",\r\n    \"04130510011209070008061502110314\",\r\n    \"04121403010515110913020807100600\",\r\n    \"09081506140503111007000213120401\",\r\n    \"12040103110806020513000715141009\",\r\n    \"14130704100812020506030109001511\",\r\n    \"08150701101312060504111409020300\",\r\n    \"08070010111406021204030915051301\",\r\n    \"12080704051401101511130306020900\",\r\n    \"08040113121406110715050309000210\",\r\n    \"09010012020813041106030510071514\",\r\n    \"07050302121004110906001314011508\",\r\n    \"11061512040509071002130114030800\",\r\n    \"06091405040710021215130103110800\",\r\n    \"06120115091107040502000313081014\",\r\n    \"02070603111314040010051215010809\",\r\n    \"11020409151303080005120714100601\",\r\n    \"14150105030211080004071210130609\",\r\n    \"11051310150108061403020407120900\",\r\n    \"09130205060114041007001503081211\",\r\n    \"02130003110405081407151209100106\",\r\n    \"11120601090213100715001403040805\",\r\n    \"09061505011204080211100307131400\",\r\n    \"03011110120215000907061308140504\",\r\n    \"00090106120410141303050711020815\",\r\n    \"15020614070810090001120413030511\",\r\n    \"13011205030614100011150708090402\",\r\n    \"12070601130504150002111410080903\",\r\n    \"00050115020310070809061304111214\",\r\n    \"12030806070109020015110405131410\",\r\n    \"09060308050201001407111012130415\",\r\n    \"08100115050904070006111214030213\",\r\n    \"11051204020813010910000607031415\",\r\n    \"05040013070809021103140112150610\",\r\n    \"05081311070904031206100214150100\",\r\n    \"15100406010208071412000313110905\",\r\n    \"15041002010811000305070612141309\",\r\n    \"11060002090801041203071505131410\",\r\n    \"04021503071308001412050106100911\",\r\n    \"01150205130709140411081006031200\",\r\n    \"15021004090713080503141201000611\",\r\n    \"13070810060905120003040111150214\",\r\n    \"00010806150912130210051411040703\",\r\n    \"10041107120615130508000309020114\",\r\n    \"13060309100414071501020805111200\",\r\n    \"15140408111209000610021301050703\",\r\n    \"00060812020903131011140507041501\",\r\n    \"04070614010212150008031109051013\",\r\n    \"13150803051412061004020907011100\",\r\n    \"12090003141013040711050108150206\",\r\n    \"08010709060510111514120413020300\",\r\n    \"06010913120814020503150711100400\",\r\n    \"14130203070106040005150809101211\",\r\n    \"08111202010906140003071513051004\",\r\n    \"04090802110307151005130614000112\"\r\n  ]\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/DigitsPuzzle/DigitsPuzzleMain.txt" - Parse error: Failed to parse completely. Remaining: "?!initSuccess\r\n    >`0,0,#white,Wrong Custome Puzzle Code!!!\r\n\r\n?GameStep = 1\r\n  GameInitialize()\r\n\r\n?GameStep = 2\r\n  DrawTheGame()\r\n  ShowTipsForGamePlay()\r\n  MonitorKeysForGamePlay()\r\n\r\n  ?gameCore.JudgeToWin()\r\n    GameStep = 3\r\n\r\n?GameStep = 3\r\n  DrawTheGame()\r\n  ShowWin()\r\n  MonitorKeysForWin()\r\n\r\n?GameStep = 4\r\n  DrawTheGame()\r\n  ShowTipsForAfterWin()\r\n  MonitorKeysForAfterWin()\r\n\r\nfunc ShowTitleScreen()\r\n  var titleWidth = 59\r\n  var titleHeight = 13\r\n  var titleString = ascii\r\nDDDDDD#####IIIIII#####GGGGGG###IIIIII###TTTTTTTT####SSSSSS\r\nDD####DD#####II#####GG###########II########TT#####SS######\r\nDD####DD#####II#####GG##GGGG#####II########TT#######SSSS##\r\nDD####DD#####II#####GG####GG#####II########TT###########SS\r\nDDDDDD#####IIIIII#####GGGGGG###IIIIII######TT#####SSSSSS##\r\n\r\nPPPPPP####UU####UU##ZZZZZZZZ##ZZZZZZZZ##LL########EEEEEEEE\r\nPP####PP##UU####UU#######ZZ########ZZ###LL########EE######\r\nPPPPPP\t##UU####UU#####ZZ########ZZ#####LL########EEEEEEEE\r\nPP########UU####UU###ZZ########ZZ#######LL########EE######\r\nPP##########UUUU####ZZZZZZZZ##ZZZZZZZZ##LLLLLLLL##EEEEEEEE\r\n\r\n#########################################Coded By Okamiroy\r\nasciiend\r\n\r\n  var titlePosX = 0\r\n  titlePosX = (screen.w - titleWidth) / 2\r\n  ?titlePosX < 0\r\n    titlePosX = 0\r\n  var titlePosY = 0\r\n  titlePosY = (screen.h - titleHeight - 7) / 2\r\n  ?titlePosY < 0\r\n    titlePosY = 0\r\n\r\n  >`@titlePosX@,@titlePosY@,#white,@titleString@\r\n\r\n  var optionA = \"Play Random 4*4\"\r\n  var optionAX = titlePosX + 22\r\n  var optionAY = titlePosY + titleHeight + 3\r\n  \r\n  var optionB = \"Play Custom 4*4\"\r\n  var optionBX = optionAX\r\n  var optionBY = optionAY + 1\r\n\r\n  ?selectedIndex = 0\r\n    PrintOption(optionAX, optionAY, optionA, true)\r\n    PrintOption(optionBX, optionBY, optionB, false)\r\n  :\r\n    PrintOption(optionAX, optionAY, optionA, false)\r\n    PrintOption(optionBX, optionBY, optionB, true)\r\n\r\nfunc PrintOption(posX, posY, optionString, isSelected)\r\n  ?isSelected\r\n    var arrowMarkPosX = posX - 2\r\n    var arrowMarkPosY = posY\r\n    >`@posX@,@posY@,#rainFF,@optionString@\r\n    >`@arrowMarkPosX@,@arrowMarkPosY@,#white,▶\r\n  :\r\n    >`@posX@,@posY@,#white,@optionString@\r\n\r\nfunc ShowTipsForTitleScreen()\r\n  var tips = ascii\r\n   ↑↓: Select\r\n    Z: Confirm\r\nSHIFT: Show/Hide BG\r\nasciiend\r\n  var tipsHeight = 3\r\n  var tipsPosY = screen.h - tipsHeight\r\n  >`0,@tipsPosY@,#white,@tips@\r\n\r\nfunc MonitorKeysForTitleScreen()\r\n  ?key = upBegin\r\n    ?selectedIndex > 0\r\n      selectedIndex--\r\n  :?key = downBegin\r\n    ?selectedIndex < maxIndex\r\n      selectedIndex++\r\n  :?key = bumpLBegin\r\n    ?maxIndex >= 0\r\n      GameStep = 1\r\n\r\nfunc GameInitialize()\r\n  ?selectedIndex = 0\r\n    initSuccess = gameCore.InitGame(false)\r\n  :\r\n    initSuccess = gameCore.InitGame(true)\r\n\r\n  ?initSuccess\r\n    GameStep = 2\r\n  :\r\n    GameStep = 0\r\n\r\nfunc DrawTheGame()\r\n  gameCore.ShowGame()\r\n\r\nfunc ShowTipsForGamePlay()\r\n  var tips = ascii\r\n ↑↓←→: Move\r\n    X: Retry\r\n    C: Back To Title\r\nSHIFT: Show/Hide BG\r\nasciiend\r\n  var tipsHeight = 4\r\n  var tipsPosY = screen.h - tipsHeight\r\n  >`0,@tipsPosY@,#white,@tips@\r\n\r\n  >`1,1,#white,Move all the digits in ascending order, left to right, top to bottom. \r\n  >`1,2,#white,Digits at correct position should be in ####### color.\r\n  >`41,2,#rainFF,RAINBOW\r\n\r\nfunc MonitorKeysForGamePlay()\r\n  ?key = begin\r\n    ?key = upBegin\r\n      gameCore.MoveUp()\r\n    :?key = rightBegin\r\n      gameCore.MoveRight()\r\n    :?key = downBegin\r\n      gameCore.MoveDown()\r\n    :?key = leftBegin\r\n      gameCore.MoveLeft()\r\n    :?key = backBegin\r\n      gameCore.ResetGame()\r\n    :?key = bumpRBegin\r\n      GameStep = 0\r\n\r\nfunc ShowWin()\r\n  var message = ascii\r\n                                                         \r\n                    Conguatulations!                     \r\n                                                         \r\nIf you want to create your own puzzle, please check the  \r\nfile \"CustomPuzzle.txt\" in \"\\Games\\DigitsPuzzle\\\" folder.\r\n                                                         \r\n                                                         \r\n                                                         \r\n                                                         \r\n                                                         \r\n                Press Z to go back to game.              \r\n                                                         \r\nasciiend\r\n  var messageWidth = 58\r\n  var messageHeight = 12\r\n  var messagePosX = 0\r\n  var messagePosY = 0\r\n  var windowWidth = messageWidth + 2\r\n  var windowHeight = messageHeight + 2\r\n  var windowPosX = 0\r\n  var windowPosY = 0\r\n\r\n  messagePosX = (screen.w - messageWidth) / 2\r\n  messagePosY = (screen.h - messageHeight) / 2\r\n  windowPosX = messagePosX - 1\r\n  windowPosY = messagePosY - 1\r\n\r\n  >`@messagePosX@,@messagePosY@,#white,@message@\r\n  draw.Box(windowPosX, windowPosY, windowWidth, windowHeight, white, 2)\r\n\r\nfunc MonitorKeysForWin()\r\n  ?key = bumpLBegin\r\n    GameStep = 4\r\n\r\nfunc ShowTipsForAfterWin()\r\n  var tips = ascii\r\n    X: Retry\r\n    C: Back To Title\r\nSHIFT: Show/Hide BG\r\nasciiend\r\n  var tipsHeight = 3\r\n  var tipsPosY = screen.h - tipsHeight\r\n  >`0,@tipsPosY@,#white,@tips@\r\n\r\nfunc MonitorKeysForAfterWin()\r\n  ?key = backBegin\r\n    gameCore.ResetGame()\r\n    GameStep = 2\r\n  :?key = bumpRBegin\r\n    GameStep = 0"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/DigitsPuzzle/DigitCell.txt" - Parse error: Failed to parse completely. Remaining: "?digit < 10\r\n    digitPosX++\r\n  >`@boxPosX@,@boxPosY@,#@boxColor@,@box@\r\n  >`@digitPosX@,@digitPosY@,#@digitColor@,@digit@"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/GetawayDriver/main.txt" - Parse error: Failed to parse completely. Remaining: "#.-'--`-._\r\n '-O---O--'\r\nasciiend\r\n // car ^^\r\n\r\n var width = 86\r\n var b\r\n var x1\r\n var x2\r\n var divider = 4\r\n var lane = 2\r\n var d = width*divider\r\n\r\n var obst =ascii\r\n #___\r\n |   |\r\n |TNT|\r\n |___|\r\nasciiend \r\n\r\n ?divider > 1\r\n  d--\r\n :\r\n  d=d-2\r\n b=d/divider\r\n\r\n ?d <= -5\r\n  ?divider > 1\r\n   divider--\r\n  d=width*divider\r\n\r\n  lane = 1 + rng % (3 - 1 + 1)\r\n\r\n ?lane = 1\r\n  x1 = 10\r\n  x2 = 14\r\n :? lane = 2\r\n  x1 = 6\r\n  x2 = 14\r\n :\r\n  x1 = 6\r\n  x2 = 10\r\n\r\n ?(x1+2 = y)\r\n  ?b <= 15+offset & b > 13\r\n   // game over\r\n   loc.leave()\r\n :?(x2+2 = y | x2+1 = y)\r\n  ?b <= 15+offset & b > 13\r\n   //game over\r\n   loc.leave()\r\n\r\n >`@b@,@x1@,#white,@obst@\r\n >`@b@,@x2@,#white,@obst@\r\n\r\n //>`0,1,#white,@x1@\r\n //>`0,2,#white,@x2@\r\n\r\n //b is the x of the barrels\r\n //15 is x of the car\r\n //y is the y of the car\r\n //x1/x2 is y of the barrels (sorry bad name)"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/GetawayDriver/drawLines.txt" - Parse error: Failed to parse completely. Remaining: "= \" - - - - - - - - - - - - - - - -\"\r\nvar line = \"-----------------------------------\"\r\n\r\n>`0,14,#white,@line@\r\n>`27,14,#white,@line@\r\n>`54,14,#white,@line@\r\n>`70,14,#white,@line@\r\n\r\n>`0,12,#yellow,@midLine@\r\n>`28,12,#yellow,@midLine@\r\n>`54,12,#yellow,@midLine@\r\n>`70,12,#yellow,@midLine@\r\n\r\n>`0,10,#white,@line@\r\n>`27,10,#white,@line@\r\n>`54,10,#white,@line@\r\n>`70,10,#white,@line@\r\n\r\n>`0,8,#yellow,@midLine@\r\n>`28,8,#yellow,@midLine@\r\n>`54,8,#yellow,@midLine@\r\n>`70,8,#yellow,@midLine@\r\n\r\n>`0,6,#white,@line@\r\n>`27,6,#white,@line@\r\n>`54,6,#white,@line@\r\n>`70,6,#white,@line@\r\n\r\n>`0,16,#yellow,@midLine@\r\n>`28,16,#yellow,@midLine@\r\n>`54,16,#yellow,@midLine@\r\n>`70,16,#yellow,@midLine@\r\n\r\n>`0,18,#white,@line@\r\n>`27,18,#white,@line@\r\n>`54,18,#white,@line@\r\n>`70,18,#white,@line@"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/2048.txt" - Parse error: Failed to parse completely. Remaining: "=\"    Z: Undo\"\r\nvar str_tips_pc=ascii\r\n ↑↓←→: Move\r\n    X: Restart\r\n    C: Back To Title\r\nSHIFT: Show/Hide BG\r\nasciiend\r\n\r\n\r\nvar int__FUSEDCOUNT=10//animation param\r\nvar int_boxW=6\r\nvar int_boxH=3\r\nvar str_gamestate=\"title\"// title/game/game_undo\r\nvar bool_showbg=true\r\n\r\n//show_hide\r\nvar arrint2_tiles=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]\r\nvar listarrint2_hist=[]\r\nvar listint_scorehist=[]\r\nvar int_score=0\r\nvar str_highscorekey=\"ap2048best\"\r\nvar int_highscore=storage.Get(str_highscorekey, 0)\r\nvar str_highscorekey_undo=\"ap2048bestundo\"\r\nvar int_highscore_undo=storage.Get(str_highscorekey_undo, 0)\r\n//system vars and funcs\r\nvar int_screenW\r\nint_screenW=screen.w\r\nvar int_screenH\r\nint_screenH=screen.h\r\nvar int_FloorToInt=math.FloorToInt\r\nvar int_CeilToInt=math.CeilToInt\r\nvar draw_Bg=draw.Bg\r\nvar draw_Box=draw.Box\r\nvar draw_Clear=draw.Clear\r\nvar int_string_Size=string.Size\r\nvar bool_isMobile=sys.isMobile\r\n\r\nfunc int_rnd(bins)//generate 0-(bins-1) int\r\n    return int_FloorToInt(rngf*bins)\r\nfunc init_tiles()\r\n    arrint2_tiles=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]\r\n    var first_tile=int_rnd(16)\r\n    var second_tile=int_rnd(15)\r\n    var rand=rngf\r\n    ?second_tile>=first_tile\r\n        second_tile=second_tile+1\r\n    ?rand<0.81\r\n        arrint2_tiles[int_FloorToInt(first_tile/4)][first_tile%4]=2\r\n        arrint2_tiles[int_FloorToInt(second_tile/4)][second_tile%4]=2\r\n    :?rand<0.99\r\n        arrint2_tiles[int_FloorToInt(first_tile/4)][first_tile%4]=4\r\n        arrint2_tiles[int_FloorToInt(second_tile/4)][second_tile%4]=2\r\n    :\r\n        arrint2_tiles[int_FloorToInt(first_tile/4)][first_tile%4]=4\r\n        arrint2_tiles[int_FloorToInt(second_tile/4)][second_tile%4]=4\r\n\r\nvar arrint_added=[-1,-1]\r\nvar int_addedcount=-1\r\nfunc add_tile()\r\n    var num_zerotile=0//# of zero tile\r\n    for i = 0..15\r\n        ?arrint2_tiles[int_FloorToInt(i/4)][i%4]=0\r\n            num_zerotile=num_zerotile+1\r\n    var index_add=int_rnd(num_zerotile)\r\n    var zero_count=0\r\n    for i=0..15\r\n        ?arrint2_tiles[int_FloorToInt(i/4)][i%4]=0\r\n            ?index_add-zero_count=0\r\n                ?rngf<0.9\r\n                    arrint2_tiles[int_FloorToInt(i/4)][i%4]=2\r\n                :\r\n                    arrint2_tiles[int_FloorToInt(i/4)][i%4]=4\r\n                arrint_added[0]=int_FloorToInt(i/4)\r\n                arrint_added[1]=i%4\r\n                int_addedcount=int__FUSEDCOUNT\r\n            zero_count=zero_count+1\r\n\r\nfunc arrint2_clone(arrint2_arg)\r\n    var a=arrint2_arg\r\n    return [[a[0][0],a[0][1],a[0][2],a[0][3]],[a[1][0],a[1][1],a[1][2],a[1][3]],[a[2][0],a[2][1],a[2][2],a[2][3]],[a[3][0],a[3][1],a[3][2],a[3][3]]]\r\n\r\n\r\nfunc show_title()\r\n    var int_titleW=33\r\n    var int_titleH=6\r\n    var offsetX=int_CeilToInt((int_screenW-int_titleW)/2)\r\n    var offsetY=int_CeilToInt((int_screenH-int_titleH)/2-5)\r\n    >`@offsetX@,@offsetY@,#white,@str_title@\r\n    var start=\"Press a button to select mode\"\r\n    offsetX=int_CeilToInt((int_screenW-38)/2)\r\n    offsetY=int_CeilToInt((int_screenH)/2+3)\r\n    >`@offsetX@,@offsetY@,#white,@start@\r\n\r\nfunc show_gameover()\r\n    var gameoverW=52\r\n    var gameoverH=4\r\n    var offsetX=int_CeilToInt((int_screenW-gameoverW)/2)\r\n    var offsetY=int_CeilToInt((int_screenH-gameoverH)/2)\r\n    >`@offsetX@,@offsetY@,#white,@str_gameover@\r\nfunc str_numcolor(number)\r\n    ?number=0\r\n        return \"#000000\"\r\n    :?number=2\r\n        return \"#white\"\r\n    :?number=4\r\n        return \"#white\"\r\n    :?number=8\r\n        return \"#cyan\"\r\n    :?number=16\r\n        return \"#cyan\"\r\n    :?number=32\r\n        return \"#yellow\"\r\n    :?number=64\r\n        return \"#yellow\"\r\n    :?number=128\r\n        return \"#green\"\r\n    :?number=256\r\n        return \"#green\"\r\n    :?number=512\r\n        return \"#blue\"\r\n    :?number=1024\r\n        return \"#blue\"\r\n    :?number=2048\r\n        return \"#red\"\r\n    :?number=4096\r\n        return \"#red\"\r\n    :\r\n        return \"#rainFF\"\r\nfunc str_bgcolor(number)\r\n    ?number=0\r\n        return \"#000000\"\r\n    :?number=2\r\n        return \"#3D3D3D\"\r\n    :?number=4\r\n        return \"#4D4D4D\"\r\n    :?number=8\r\n        return \"#007B7B\"\r\n    :?number=16\r\n        return \"#008B8B\"\r\n    :?number=32\r\n        return \"#B8B800\"\r\n    :?number=64\r\n        return \"#C8C800\"\r\n    :?number=128\r\n        return \"#005400\"\r\n    :?number=256\r\n        return \"#006400\"\r\n    :?number=512\r\n        return \"#00007B\"\r\n    :?number=1024\r\n        return \"#00008B\"\r\n    :?number=2048\r\n        return \"#7B0000\"\r\n    :?number=4096\r\n        return \"#8B0000\"\r\n    :\r\n        return \"#9400D3\"\r\nfunc show_tile(x,y,number)//xy:0-3int num:int\r\n    var offsetX=int_CeilToInt(int_screenW/2-int_boxW*2)+x*int_boxW\r\n    var offsetY=int_CeilToInt(int_screenH/2-int_boxH*2)+y*int_boxH\r\n    draw_Bg(offsetX,offsetY,str_bgcolor(number),int_boxW,int_boxH)\r\n    >`@offsetX@,@offsetY+1@,@str_numcolor(number)@,@number@\r\n\r\nvar button_origstart\r\nvar button_undostart\r\nfunc add_titlebuttons()\r\n    ui.Clear()\r\n    button_origstart = ui.AddButton()\r\n    button_origstart.y = 8\r\n    button_origstart.x = int_screenW/4\r\n    button_origstart.text = \"Original\"\r\n    button_origstart.SetPressed(start)\r\n    button_undostart = ui.AddButton()\r\n    button_undostart.y = 8\r\n    button_undostart.x = -int_screenW/4\r\n    button_undostart.text = \"Undoable\"\r\n    button_undostart.SetPressed(start)\r\n\r\n\r\n\r\nvar bool_moved=false\r\nvar arrint2_fused=[]\r\nvar int_fusedcount=0\r\nfunc int_shake_to(dir)\r\n    bool_moved=false\r\n    arrint2_fused.Clear()\r\n    var score_tmp=0//score\r\n    ?dir=\"right\"\r\n        for i=0..3\r\n            var first_pointer=0//next fuse index of i/j\r\n            var second_pointer=1//curr reading of i/j\r\n            for j=0..4//rev\r\n                ?second_pointer<4\r\n                    ?arrint2_tiles[i][3-second_pointer]!0\r\n                        ?arrint2_tiles[i][3-first_pointer]=arrint2_tiles[i][3-second_pointer]\r\n                            arrint2_tiles[i][3-first_pointer]=arrint2_tiles[i][3-first_pointer]*2\r\n                            score_tmp=score_tmp+arrint2_tiles[i][3-first_pointer]\r\n                            arrint2_tiles[i][3-second_pointer]=0\r\n                            arrint2_fused.Add([i,3-first_pointer])\r\n                            int_fusedcount=int__FUSEDCOUNT\r\n                            first_pointer=first_pointer+1\r\n                            second_pointer=second_pointer+1\r\n                            bool_moved=true\r\n                        :?arrint2_tiles[i][3-first_pointer]=0\r\n                            arrint2_tiles[i][3-first_pointer]=arrint2_tiles[i][3-second_pointer]\r\n                            arrint2_tiles[i][3-second_pointer]=0\r\n                            second_pointer=second_pointer+1\r\n                            bool_moved=true\r\n                        :\r\n                            ?second_pointer=first_pointer+1\r\n                                first_pointer=first_pointer+1\r\n                                second_pointer=second_pointer+1\r\n                            :\r\n                                first_pointer=first_pointer+1\r\n                    :\r\n                        second_pointer=second_pointer+1\r\n        return score_tmp\r\n    ?dir=\"left\"\r\n        for i=0..3\r\n            var first_pointer=0//next fuse index of i/j\r\n            var second_pointer=1//curr reading of i/j\r\n            for j=0..4//rev\r\n                ?second_pointer<4\r\n                    ?arrint2_tiles[i][second_pointer]!0\r\n                        ?arrint2_tiles[i][first_pointer]=arrint2_tiles[i][second_pointer]\r\n                            arrint2_tiles[i][first_pointer]=arrint2_tiles[i][first_pointer]*2\r\n                            score_tmp=score_tmp+arrint2_tiles[i][first_pointer]\r\n                            arrint2_tiles[i][second_pointer]=0\r\n                            arrint2_fused.Add([i,first_pointer])\r\n                            int_fusedcount=int__FUSEDCOUNT\r\n                            first_pointer=first_pointer+1\r\n                            second_pointer=second_pointer+1\r\n                            bool_moved=true\r\n                        :?arrint2_tiles[i][first_pointer]=0\r\n                            arrint2_tiles[i][first_pointer]=arrint2_tiles[i][second_pointer]\r\n                            arrint2_tiles[i][second_pointer]=0\r\n                            second_pointer=second_pointer+1\r\n                            bool_moved=true\r\n                        :\r\n                            ?second_pointer=first_pointer+1\r\n                                first_pointer=first_pointer+1\r\n                                second_pointer=second_pointer+1\r\n                            :\r\n                                first_pointer=first_pointer+1\r\n                    :\r\n                        second_pointer=second_pointer+1\r\n                :\r\n                    break\r\n        return score_tmp\r\n    ?dir=\"up\"\r\n        for i=0..3\r\n            var first_pointer=0//next fuse index of i/j\r\n            var second_pointer=1//curr reading of i/j\r\n            for j=0..4//rev\r\n                ?second_pointer<4\r\n                    ?arrint2_tiles[second_pointer][i]!0\r\n                        ?arrint2_tiles[first_pointer][i]=arrint2_tiles[second_pointer][i]\r\n                            arrint2_tiles[first_pointer][i]=arrint2_tiles[first_pointer][i]*2\r\n                            score_tmp=score_tmp+arrint2_tiles[first_pointer][i]\r\n                            arrint2_tiles[second_pointer][i]=0\r\n                            arrint2_fused.Add([first_pointer,i])\r\n                            int_fusedcount=int__FUSEDCOUNT\r\n                            first_pointer=first_pointer+1\r\n                            second_pointer=second_pointer+1\r\n                            bool_moved=true\r\n                        :?arrint2_tiles[first_pointer][i]=0\r\n                            arrint2_tiles[first_pointer][i]=arrint2_tiles[second_pointer][i]\r\n                            arrint2_tiles[second_pointer][i]=0\r\n                            second_pointer=second_pointer+1\r\n                            bool_moved=true\r\n                        :\r\n                            ?second_pointer=first_pointer+1\r\n                                first_pointer=first_pointer+1\r\n                                second_pointer=second_pointer+1\r\n                            :\r\n                                first_pointer=first_pointer+1\r\n                    :\r\n                        second_pointer=second_pointer+1\r\n        return score_tmp\r\n    ?dir=\"down\"\r\n        for i=0..3\r\n            var first_pointer=0//next fuse index of i/j\r\n            var second_pointer=1//curr reading of i/j\r\n            for j=0..4//rev\r\n                ?second_pointer<4\r\n                    ?arrint2_tiles[3-second_pointer][i]!0\r\n                        ?arrint2_tiles[3-first_pointer][i]=arrint2_tiles[3-second_pointer][i]\r\n                            arrint2_tiles[3-first_pointer][i]=arrint2_tiles[3-first_pointer][i]*2\r\n                            score_tmp=score_tmp+arrint2_tiles[3-first_pointer][i]\r\n                            arrint2_tiles[3-second_pointer][i]=0\r\n                            arrint2_fused.Add([3-first_pointer,i])\r\n                            int_fusedcount=int__FUSEDCOUNT\r\n                            first_pointer=first_pointer+1\r\n                            second_pointer=second_pointer+1\r\n                            bool_moved=true\r\n                        :?arrint2_tiles[3-first_pointer][i]=0\r\n                            arrint2_tiles[3-first_pointer][i]=arrint2_tiles[3-second_pointer][i]\r\n                            arrint2_tiles[3-second_pointer][i]=0\r\n                            second_pointer=second_pointer+1\r\n                            bool_moved=true\r\n                        :\r\n                            ?second_pointer=first_pointer+1\r\n                                first_pointer=first_pointer+1\r\n                                second_pointer=second_pointer+1\r\n                            :\r\n                                first_pointer=first_pointer+1\r\n                    :\r\n                        second_pointer=second_pointer+1\r\n        return score_tmp\r\n\r\nfunc bool_movable()\r\n    \r\n    var movable=false\r\n    for i=0..3\r\n        var tmp_x=-1//check -\r\n        var tmp_y=-1//check |\r\n        for j=0..3\r\n            ?tmp_x=arrint2_tiles[i][j]|arrint2_tiles[i][j]=0\r\n                movable=true\r\n                break\r\n            :\r\n                tmp_x=arrint2_tiles[i][j]\r\n            \r\n            ?tmp_y=arrint2_tiles[j][i]|arrint2_tiles[j][i]=0\r\n                movable=true\r\n                break\r\n            :\r\n                tmp_y=arrint2_tiles[j][i]\r\n        ?movable\r\n            break\r\n    return movable\r\n\r\n\r\nfunc show_fused()\r\n    var num_fused=arrint2_fused.Count()\r\n    ?num_fused!0\r\n        for i=0..num_fused-1\r\n            var offsetX=int_CeilToInt(int_screenW/2-int_boxW*2)+arrint2_fused[i][1]*int_boxW\r\n            var offsetY=int_CeilToInt(int_screenH/2-int_boxH*2)+arrint2_fused[i][0]*int_boxH\r\n            draw_Box(offsetX, offsetY, int_boxW, int_boxH, str_numcolor(arrint2_tiles[arrint2_fused[i][0]][arrint2_fused[i][1]]), -3)\r\nfunc show_added()\r\n            var offsetX=int_CeilToInt(int_screenW/2-int_boxW*2)+arrint_added[1]*int_boxW\r\n            var offsetY=int_CeilToInt(int_screenH/2-int_boxH*2)+arrint_added[0]*int_boxH\r\n            draw_Box(offsetX, offsetY, int_boxW, int_boxH, \"#8D8D8D\", -1)\r\nfunc show_score()\r\n    var offsetX=int_CeilToInt(int_screenW/2+int_boxW*2)\r\n    var offsetY=int_CeilToInt(int_screenH/2-int_boxH*2)-1\r\n    var strscore=\"SCORE:\"+int_score\r\n    ?str_gamestate=\"undo\"\r\n        strscore=strscore+\" BEST(Undo):\"+int_highscore_undo\r\n    :\r\n        strscore=strscore+\" BEST:\"+int_highscore\r\n    >`@offsetX-int_string_Size(strscore)@,@offsetY@,@strscore@\r\n\r\nvar bool_isgameover=false\r\nfunc reset_game()\r\n    int_score=0\r\n    init_tiles()\r\n    listarrint2_hist.Clear()\r\n    listint_scorehist.Clear()\r\n    ?str_gamestate=\"undo\"\r\n        listarrint2_hist.Add(arrint2_clone(arrint2_tiles))\r\n        listint_scorehist.Add(int_score)\r\n    bool_isgameover=false\r\nfunc aftermove()\r\n    ?bool_moved\r\n            add_tile()\r\n            ?str_gamestate=\"undo\"\r\n                listarrint2_hist.Add(arrint2_clone(arrint2_tiles))\r\n                listint_scorehist.Add(int_score)\r\n                ?listint_scorehist.Count()>100\r\n                    listint_scorehist.RemoveAt(0)\r\n                    listarrint2_hist.RemoveAt(0)\r\n            ?!bool_movable()\r\n                bool_isgameover=true\r\nvar int_mobilekey=-1\r\nvar bool_activatekey=false\r\n\r\nfunc update_game()\r\n    ?bool_isMobile&str_gamestate=\"game\"\r\n        ?int_mobilekey!-1&!bool_activatekey\r\n            int_mobilekey=-1\r\n        :?bool_activatekey\r\n            bool_activatekey=false\r\n    :\r\n        ?str_gamestate=\"undo\"\r\n            >`0,@int_screenH-7@,#FFFFFF,@str_undo_pc@\r\n        >`0,@int_screenH-6@,#FFFFFF,@str_tips_pc@\r\n    ?!bool_showbg\r\n        draw_Clear()\r\n    ?key=leftBegin|int_mobilekey=2\r\n        int_score+=int_shake_to(\"left\")\r\n        aftermove()\r\n    :?key=rightBegin|int_mobilekey=0\r\n        int_score+=int_shake_to(\"right\")\r\n        aftermove()\r\n    :?key=upBegin|int_mobilekey=1\r\n        int_score+=int_shake_to(\"up\")\r\n        aftermove()\r\n    :?key=downBegin|int_mobilekey=3\r\n        int_score+=int_shake_to(\"down\")\r\n        aftermove()\r\n    :?key=ability1Begin\r\n        bool_showbg=!bool_showbg\r\n    :?key = backBegin\r\n        reset_game()\r\n    :?key = bumpRBegin\r\n        str_gamestate=\"title\"\r\n        add_titlebuttons()\r\n    :?key=bumpLBegin&str_gamestate=\"undo\"\r\n        undo()\r\n    \r\n    ?int_fusedcount>0\r\n        show_fused()\r\n        int_fusedcount--\r\n    ?int_addedcount>0\r\n        show_added()\r\n        int_addedcount--\r\n    for i=0..3\r\n        for j=0..3\r\n            show_tile(j,i,arrint2_tiles[i][j])\r\n    show_score()\r\n    ?bool_isgameover\r\n        ?str_gamestate=\"undo\"\r\n            ?int_score>int_highscore_undo\r\n                storage.Set(str_highscorekey_undo, int_score)\r\n                int_highscore_undo=int_score\r\n        :?int_score>int_highscore\r\n            storage.Set(str_highscorekey,int_score)\r\n            int_highscore=int_score\r\n        show_gameover()\r\n        ?bool_isMobile&int_mobilekey!-1&!bool_moved\r\n            reset_game()\r\n            int_mobilekey=-1\r\n            bool_activatekey=false\r\n            str_gamestate=\"title\"\r\n            add_titlebuttons()\r\n\r\n\r\nfunc update_title()\r\n    show_title()\r\n    ?key = backBegin\r\n        reset_game()\r\n        str_gamestate=\"game\"\r\n        ui.Clear()\r\n\r\n\r\n//main\r\n//button 18*5\r\n\r\nvar button_undo\r\nvar button_r\r\nvar button_l\r\nvar button_u\r\nvar button_d\r\nfunc wasd(btn)\r\n    ?btn=button_r\r\n        int_mobilekey=0\r\n        bool_activatekey=true\r\n    :?btn=button_l\r\n        int_mobilekey=2\r\n        bool_activatekey=true\r\n    :?btn=button_d\r\n        int_mobilekey=3\r\n        bool_activatekey=true\r\n    :?btn=button_u\r\n        int_mobilekey=1\r\n        bool_activatekey=true\r\n\r\nfunc undo()\r\n    var int_histcount=listint_scorehist.Count()\r\n    ?str_gamestate=\"undo\"&int_histcount>1\r\n        arrint2_tiles=arrint2_clone(listarrint2_hist[int_histcount-2])\r\n        listarrint2_hist.RemoveAt(int_histcount-1)\r\n        int_score=listint_scorehist[int_histcount-2]\r\n        listint_scorehist.RemoveAt(int_histcount-1)\r\n        bool_isgameover=false\r\n\r\nfunc add_buttons()\r\n    button_r = ui.AddButton()\r\n    button_r.x = int_screenW/2-10\r\n    button_r.text = \"→\"\r\n    button_r.SetDown(wasd)\r\n    button_l = ui.AddButton()\r\n    button_l.x = -int_screenW/2+10\r\n    button_l.text = \"←\"\r\n    button_l.SetDown(wasd)\r\n    button_u = ui.AddButton()\r\n    button_u.y = -int_screenH/2+3\r\n    button_u.text = \"↑\"\r\n    button_u.SetDown(wasd)\r\n    button_d = ui.AddButton()\r\n    button_d.y = int_screenH/2-3\r\n    button_d.text = \"↓\"\r\n    button_d.SetDown(wasd)\r\n    ?str_gamestate=\"undo\"\r\n        button_undo=ui.AddButton()\r\n        button_undo.text=\"Undo\"\r\n        button_undo.x = -int_screenW/2+10\r\n        button_undo.y = int_screenH/2-3\r\n        button_undo.SetDown(undo)\r\n\r\nfunc start(btn)\r\n    ?btn=button_undostart\r\n        str_gamestate=\"game_undo\"\r\n    :\r\n        str_gamestate=\"game\"\r\n    reset_game()\r\n    ui.Clear()\r\n    ?bool_isMobile\r\n        add_buttons()\r\n?loc.loop&bool_isMobile&str_gamestate=\"game\"\r\n    add_buttons()\r\n:?loc.begin|loc.loop&str_gamestate=\"title\"\r\n    add_titlebuttons()\r\n\r\n?str_gamestate=\"title\"\r\n    update_title()\r\n:?str_gamestate=\"game\"\r\n    update_game()\r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/FeedABat.txt" - Parse error: Failed to parse completely. Remaining: "afpf.color = #1d1d1d\r\n  afpm.color = #252525\r\n  afpn.color = #404040\r\n  afpf.y = afpy\r\n  afpm.y = afpy+1\r\n  afpn.y = afpy+2\r\n  afpf.Play()\r\n  afpm.Play()\r\n  afpn.Play()\r\nvar candyAscii = ascii\r\n##_##\r\n>(_)<\r\nasciiend\r\n\r\nvar score = 0\r\n\r\nvar candies = ［］\r\nvar candiesx = ［］\r\nvar candiesy = ［］\r\n\r\nvar candyColor = ［#db38b3, #76d378, #d388b8,\r\n^#d3df96, #7977ff］\r\n\r\nvar lost = 0\r\n?lost = 1\r\n  >c-4,-8,#red,you lost!\r\n\r\nvar speed = 4\r\n?score >= 60\r\n  speed = 1\r\n:\r\n  speed = 4-(score/20)\r\nfunc CreateCandy()\r\n  var candy = Ui.AddAnim(candyAscii)\r\n  candy.dock = top_left\r\n  candy.color = candyColor［rng%5］\r\n  candy.y = 0\r\n  candy.x = (rng%87)+4\r\n  candies.Add(candy)\r\n  candiesx.Add(candy.x)\r\n  candiesy.Add(0)\r\n?candies.Count()>0\r\n  for i = 0..candies.Count()-1\r\n    ?totaltime%speed=0\r\n      candiesy［i］ = candiesy［i］+1\r\n      candies［i］.y = candiesy［i］\r\n    ?candiesy［i］ >= 19 & candiesy［i］<= 23\r\n    ^& candiesx［i］ <= input.x+5\r\n    ^& candiesx［i］ >= input.x-5\r\n      score++\r\n      play life_gain\r\n      candies［i］.Recycle()\r\n      candies.RemoveAt(i)\r\n      candiesx.RemoveAt(i)\r\n      candiesy.RemoveAt(i)\r\n      break\r\n    ?candiesy［i］ = 32\r\n      play smithy_hammer_fail\r\n      lost = 1\r\n    ?candiesy［i］ > 37\r\n      loc.Leave()\r\n?loc = ＂waterfall＂\r\n  >`0,16,#494949,@floor@\r\n  >`40,16,#404040,@floor@\r\n  >`78,16,#4f4f4f,@floor@\r\n  >`19,21,#494949,@floor@\r\n  >`58,21,#4f4f4f,@floor@\r\n  >`@input.x-7@,18,#7712aa,@Main@\r\n  >`0,3,#4488ff,@score@\r\n  ?totaltime%((speed*4)+13)=0\r\n    CreateCandy()\r\n  bPanel.style = 0\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/cGomoku.txt" - Parse error: Failed to parse completely. Remaining: "= #333\r\nvar fieldColor = #333\r\nvar playerColor = #blue\r\nvar botColor = #red\r\nvar cursorColor = #222\r\n\r\nvar fieldMark = \"-\"  // Marks can be two symbol wide\r\nvar playerMark = \"X\"\r\nvar botMark = \"O\"\r\n\r\n// Non editable\r\nvar turn = 1\r\nvar gameState = \"init\"\r\n\r\nvar halfLineMode = 0\r\n\r\nvar wins = storage.Get(\"Gomoku:wins\", 0)\r\nvar loses = storage.Get(\"Gomoku:loses\", 0)\r\n\r\nvar dx = (screen.w - fieldSize*2) / 2\r\nvar dy = (screen.h - fieldSize) / 2\r\n\r\nvar blinkX = 0\r\nvar blinkY = 0\r\nvar blinkTime = -42\r\n\r\nvar isDraw = false\r\n\r\nvar f = initField(0)\r\nvar s = initField(0.0)\r\nvar q = initField(0.0)\r\n\r\nvar userSq = 1\r\nvar machSq = -1\r\n\r\nvar winningMove = 9999999\r\n\r\n// Mobile\r\nvar cursorPos = [fieldSize / 2, fieldSize / 2]\r\n\r\nvar x = 0  // Enum\r\nvar y = 1\r\nvar w = 2\r\nvar h = 3\r\nvar isPressed = 4\r\nvar keyName = 5\r\nvar icon = 6\r\n\r\nvar buttonLeft = 0  // Enum\r\nvar buttonRight = 1\r\nvar buttonUp = 2\r\nvar buttonDown = 3\r\nvar buttonUpLeft = 4\r\nvar buttonUpRight = 5\r\nvar buttonBototomLeft = 6\r\nvar buttonBottomRight = 7\r\nvar buttonPlace = 8\r\nvar buttonRestart = 9\r\nvar buttonExit = 10\r\n\r\nvar ldx = (dx - 21) / 2\r\nvar rdx = (dx - 9) / 2\r\nvar buttons = [\r\n  // x, y, w, h, isPressed, keyName, icon\r\n  [0 + ldx, screen.h/2, 7, 3, false, primaryBegin, \"←\"  ],            // left\r\n  [14 + ldx, screen.h/2, 7, 3, false, primaryBegin, \"→\"],             // right\r\n  [7 + ldx, screen.h/2 - 3, 7, 3, false, primaryBegin, \"↑\"],          // up\r\n  [7 + ldx, screen.h/2 + 3, 7, 3, false, primaryBegin, \"↓\"],          // down\r\n  [0 + ldx, screen.h/2 - 3, 7, 3, false, primaryBegin, \"┌\"],          // upReft\r\n  [14 + ldx, screen.h/2 - 3, 7, 3, false, primaryBegin, \"┐\"],         // upRight\r\n  [0 + ldx, screen.h/2 + 3, 7, 3, false, primaryBegin, \"└\"],          // bottomLeft\r\n  [14 + ldx, screen.h/2 + 3, 7, 3, false, primaryBegin, \"┘\"],         // bottomLight\r\n  [screen.w - rdx - 9, screen.h/2 - 1, 9, 5, false, primary, \"X\"],    // place\r\n  [screen.w - 21, screen.h - 3, 11, 3, false, primaryEnd, \"restart\"], // restart\r\n  [screen.w - 10, screen.h - 3, 10, 3, false, primaryEnd, \"exit\"],    // exit\r\n]\r\n\r\nfunc initField(value)\r\n  var field = []\r\n  var line\r\n\r\n  for y = 0..fieldSize - 1\r\n    line = []\r\n    for x = 0..fieldSize - 1\r\n      line.Add(value)\r\n    field.Add(line)\r\n  \r\n  return field\r\n\r\nfunc gui()\r\n  var header = string.Format(\"{0}:{1}\", wins, loses)\r\n  var footer = string.Format(\"{0}\", turn / 2)\r\n\r\n  >`@dx@,@dy - 1@,@backgroundColor@,@header@\r\n  >`@dx + fieldSize*2 - string.Size(footer) - halfLineMode@,@dy + fieldSize@,@backgroundColor@,@footer@\r\n\r\n  // Game state\r\n  ?[\"win\", \"lose\", \"draw\"].Contains(gameState)\r\n    ?gameState = \"draw\"\r\n      >`@dx + fieldSize*2 + 1 - halfLineMode@,@dy@,@backgroundColor@,It's a draw\r\n    :\r\n      >`@dx + fieldSize*2 + 1 - halfLineMode@,@dy@,@backgroundColor@,You @gameState@\r\n\r\n  // Controls\r\n  ?sys.isPC | sys.isConsole\r\n    >`@dx + fieldSize*2 + 1 - halfLineMode@,@dy + fieldSize - 2@,@backgroundColor@,[C] - new game\r\n    >`@dx + fieldSize*2 + 1 - halfLineMode@,@dy + fieldSize - 1@,@backgroundColor@,[X] - exit\r\n  \r\n  ?sys.isMobile\r\n    // Mobile cursor\r\n    ?halfLineMode\r\n      draw.Bg(dx + cursorPos[0]*2, dy + cursorPos[1], cursorColor, 1, 1)\r\n    :\r\n      draw.Bg(dx + cursorPos[0]*2, dy + cursorPos[1], cursorColor, 2, 1)\r\n\r\n    // Hardcoded mobile buttons UI\r\n    var pivot_x = 0\r\n    var pivot_y = 0\r\n\r\n    for i = 0..buttons.Count() - 1\r\n      draw.Box(buttons[i][x], buttons[i][y], buttons[i][w], buttons[i][h], backgroundColor)\r\n\r\n      pivot_x = buttons[i][x] + (buttons[i][w] - string.Size(buttons[i][icon])) / 2\r\n      pivot_y = buttons[i][y] + buttons[i][h] / 2\r\n\r\n      >`@pivot_x@,@pivot_y@,@backgroundColor@,@buttons[i][icon]@\r\n\r\n  /* Debug /\r\n  >`0,0,#red,dx=@dx@\r\n  // */\r\n\r\nfunc cout()\r\n  var charColor\r\n  var charMark\r\n\r\n  for y = 0..fieldSize - 1\r\n    for x = 0..fieldSize - 1\r\n      ?f[y][x] = 0\r\n        charColor = fieldColor\r\n        charMark = fieldMark\r\n      :?f[y][x] = userSq\r\n        charColor = playerColor\r\n        charMark = playerMark\r\n      :\r\n        charColor = botColor\r\n        charMark = botMark\r\n\r\n      >`@dx + x*2@,@dy + y@,@charColor@,@charMark@\r\n  \r\nfunc blink()\r\n  var dt = totaltime - blinkTime\r\n\r\n  ?dt < 20 &\r\n  ^dt % 10 >= 5\r\n    >`@dx + blinkX*2@,@dy + blinkY@,#222,@fieldMark@\r\n\r\nfunc inputs()\r\n  ?sys.isMobile\r\n    for i = 0..buttons.Count() - 1\r\n      ?key = buttons[i][keyName] &\r\n      ^input.x >= buttons[i][x] & input.x < buttons[i][x] + buttons[i][w] &\r\n      ^input.y >= buttons[i][y] & input.y < buttons[i][y] + buttons[i][h]\r\n        buttons[i][isPressed] = true\r\n      :\r\n        buttons[i][isPressed] = false\r\n\r\n    // Left\r\n    ?cursorPos[x] > 0\r\n      ?buttons[buttonLeft][isPressed]\r\n        cursorPos[x] -= 1\r\n      \r\n      ?buttons[buttonUpLeft][isPressed] & cursorPos[x] > 0\r\n        cursorPos[x] -= 1\r\n        cursorPos[y] -= 1\r\n\r\n      ?buttons[buttonBototomLeft][isPressed] & cursorPos[x] < fieldSize - 1\r\n        cursorPos[x] -= 1\r\n        cursorPos[y] += 1\r\n\r\n    // Right\r\n    ?cursorPos[x] < fieldSize - 1\r\n      ?buttons[buttonRight][isPressed]\r\n        cursorPos[x] += 1\r\n\r\n      ?buttons[buttonUpRight][isPressed] & cursorPos[y] > 0\r\n        cursorPos[x] += 1\r\n        cursorPos[y] -= 1\r\n\r\n      ?buttons[buttonBottomRight][isPressed] & cursorPos[y] < fieldSize - 1\r\n        cursorPos[x] += 1\r\n        cursorPos[y] += 1\r\n\r\n    // Up and down\r\n    ?buttons[buttonUp][isPressed] & cursorPos[y] > 0\r\n      cursorPos[y] -= 1\r\n\r\n    ?buttons[buttonDown][isPressed] & cursorPos[y] < fieldSize - 1\r\n      cursorPos[y] += 1\r\n  \r\n  ?key = bumpRBegin | buttons[buttonRestart][isPressed]  // C\r\n    restartGame()\r\n\r\n  :?key = backBegin | buttons[buttonExit][isPressed] // X\r\n    loc.Leave()\r\n\r\nfunc restartGame()\r\n  f = initField(0)\r\n  s = initField(0.0)\r\n  q = initField(0.0)\r\n\r\n  turn = 1\r\n  gameState = \"game\"\r\n\r\nfunc turns()\r\n  ?gameState ! \"game\"\r\n    return\r\n\r\n  ?turn % 2 = 1\r\n    var turnPos = playerInput()\r\n    var playerSign = userSq\r\n    \r\n    ?!turnPos  // No input\r\n      return\r\n\r\n    play xp_tick\r\n  :\r\n    var turnPos = botInput()\r\n    var playerSign = machSq\r\n    play treasure_item_pop\r\n\r\n    // Blink for bot move\r\n    blinkTime = totaltime\r\n    blinkX = turnPos[0]\r\n    blinkY = turnPos[1]\r\n\r\n  // Place move on board\r\n  var x = turnPos[0]\r\n  var y = turnPos[1]\r\n\r\n  f[y][x] = playerSign\r\n  \r\n  // Check game state\r\n  ?isDraw\r\n    gameState = \"draw\"\r\n    play mindstone_off\r\n  :?winningPos(x, y, playerSign) = winningMove\r\n    ?playerSign = machSq\r\n      gameState = \"lose\"\r\n      loses = storage.Incr(\"Gomoku:loses\")\r\n      play uulaa_voice\r\n    :\r\n      gameState = \"win\"\r\n      wins = storage.Incr(\"Gomoku:wins\")\r\n      play ui_starnew\r\n  :\r\n    turn++\r\n\r\nfunc playerInput()\r\n  var ix = input.x\r\n  var iy = input.y\r\n\r\n  ?buttons[buttonPlace][isPressed]\r\n    ix = dx + cursorPos[0] * 2\r\n    iy = dy + cursorPos[1]\r\n\r\n  ?key = primaryEnd\r\n    ?ix - dx = -1  // Reason: -1 / 2 = 0\r\n      return false\r\n\r\n    ?halfLineMode & ix % 2 = (dx + 1) % 2  // Check only one symbol in halfline mode\r\n      return false\r\n\r\n    var x = (ix - dx) / 2\r\n    var y = (iy - dy)\r\n\r\n    ?0 <= x & x < fieldSize &\r\n    ^0 <= y & y < fieldSize &\r\n    ^f[y][x] = 0\r\n      return [x, y]\r\n\r\n  return false\r\n\r\nfunc botInput()\r\n  var nMax = 0\r\n  var xMax = [0, 0, 0, 0, 0, 0, 0, 0]\r\n  var yMax = [0, 0, 0, 0, 0, 0, 0, 0]\r\n  \r\n  var maxS = evaluatePos(s, userSq)\r\n  var maxQ = evaluatePos(q, machSq)\r\n\r\n  ?maxQ >= maxS\r\n    maxS = -1\r\n    for y = 0..fieldSize-1\r\n      for x = 0..fieldSize-1\r\n        ?q[y][x] = maxQ\r\n          ?(s[y][x] > maxS)\r\n            maxS = s[y][x]\r\n            nMax = 0\r\n\r\n          ?s[y][x] = maxS\r\n            yMax[nMax] = y\r\n            xMax[nMax] = x\r\n            nMax++\r\n  :\r\n    maxQ = -1\r\n    for y = 0..fieldSize - 1\r\n      for x = 0..fieldSize - 1\r\n        ?s[y][x] = maxS\r\n          ?q[y][x] > maxQ\r\n            maxQ = q[y][x]\r\n            nMax = 0\r\n\r\n          ?q[y][x] = maxQ\r\n            yMax[nMax] = y\r\n            xMax[nMax] = x\r\n            nMax++\r\n\r\n  var randomK = math.FloorToInt(rngf * nMax)\r\n\r\n  var x = xMax[randomK]\r\n  var y = yMax[randomK]\r\n\r\n  return [x, y]\r\n\r\nfunc evaluatePos(a, mySq)\r\n  var w = [0, 20, 17, 15.4, 14, 10]  // Some magic numbers\r\n  var nPos = [0, 0, 0, 0, 0]\r\n  var maxA = -1\r\n\r\n  isDraw = true\r\n  for y = 0..fieldSize - 1 \r\n    for x = 0..fieldSize - 1\r\n      ?f[y][x] ! 0\r\n        a[y][x] = -1\r\n        continue\r\n\r\n      ?!hasNeighbors(x, y)\r\n        a[y][x] = -1\r\n        continue\r\n\r\n      var wp = winningPos(x, y, mySq)\r\n\r\n      ?wp > 0\r\n        a[y][x] = wp\r\n      :\r\n        var minM = y - 4\r\n        ?minM < 0\r\n          minM = 0\r\n        \r\n        var minN = x - 4\r\n        ?minN < 0\r\n          minN = 0\r\n        \r\n        var maxM = y + 5\r\n        ?maxM > fieldSize\r\n          maxM = fieldSize\r\n        \r\n        var maxN = x + 5\r\n        ?maxN > fieldSize\r\n          maxN = fieldSize\r\n        \r\n        nPos[1] = 1\r\n        var A1 = 0\r\n        var m = 1\r\n        \r\n        for _ = 0..1984  // Waiting for a while loops...\r\n          ?!(x + m < maxN & f[y][x + m] ! -mySq)\r\n            break\r\n\r\n          nPos[1] += 1\r\n          A1 += w[m] * f[y][x + m]\r\n          m++\r\n\r\n        ?x + m >= fieldSize | f[y][x + m] = -mySq\r\n          ?f[y][x + m - 1] = mySq\r\n            A1 -= w[5] * mySq\r\n          \r\n        m = 1\r\n        for _ = 0..1984  // Waiting for a while loops...\r\n          ?!(x - m >= minN & f[y][x - m] ! -mySq)\r\n            break\r\n\r\n          nPos[1] += 1\r\n          A1 += w[m] * f[y][x - m]\r\n          m++ \r\n\r\n        ?x - m < 0 | f[y][x - m] = -mySq\r\n          ?f[y][x - m + 1] = mySq\r\n            A1 -= w[5] * mySq\r\n        \r\n        ?nPos[1] > 4\r\n          isDraw = false\r\n\r\n        nPos[2] = 1\r\n        var A2 = 0\r\n        m = 1\r\n        for _ = 0..1984  // Waiting for a while loops...\r\n          ?!(y + m < maxM & f[y + m][x] ! -mySq)\r\n            break\r\n          nPos[2] += 1\r\n          A2 += w[m] * f[y + m][x]\r\n          m++\r\n\r\n        ?(y + m >= fieldSize | f[y + m][x] = -mySq)\r\n          ?f[y + m - 1][x] = mySq\r\n            A2 -= w[5] * mySq\r\n\r\n        m = 1\r\n        for _ = 0..1984  // Waiting for a while loops...\r\n          ?!(y - m >= minM & f[y - m][x] ! -mySq)\r\n            break\r\n          nPos[2] += 1\r\n          A2 += w[m] * f[y - m][x]\r\n          m++\r\n        \r\n        ?y - m < 0 | f[y - m][x] = -mySq\r\n          ?f[y - m + 1][x] = mySq\r\n            A2 -= w[5] * mySq\r\n\r\n        ?nPos[2] > 4\r\n          isDraw = false\r\n\r\n        nPos[3] = 1\r\n        var A3 = 0\r\n        m = 1\r\n        for _ = 0..1984  // Waiting for a while loops...\r\n          ?!(y + m < maxM & x + m < maxN & f[y + m][x + m] ! -mySq)\r\n            break\r\n          nPos[3] += 1\r\n          A3 += w[m] * f[y + m][x + m]\r\n          m++\r\n        \r\n        ?(y + m >= fieldSize | x + m >= fieldSize | f[y + m][x + m] = -mySq)\r\n          ?f[y + m - 1][x + m - 1] = mySq\r\n            A3 -= w[5] * mySq\r\n        \r\n        m = 1\r\n        for _ = 0..1984  // Waiting for a while loops...\r\n          ?!(y - m >= minM & x - m >= minN & f[y - m][x - m] ! -mySq)\r\n            break\r\n          nPos[3] += 1\r\n          A3 += w[m] * f[y - m][x - m]\r\n          m++\r\n\r\n        ?y - m < 0 | x - m < 0 | f[y - m][x - m] = -mySq\r\n          ?f[y - m + 1][x - m + 1] = mySq\r\n            A3 -= w[5] * mySq\r\n\r\n        ?nPos[3] > 4\r\n          isDraw = false\r\n\r\n        nPos[4] = 1\r\n        var A4 = 0\r\n        m = 1\r\n        for _ = 0..1984  // Waiting for a while loops...\r\n          ?!(y + m < maxM & x - m >= minN & f[y + m][x - m] ! -mySq)\r\n            break\r\n          nPos[4] += 1\r\n          A4 += w[m] * f[y + m][x - m]\r\n          m++\r\n\r\n        ?y + m >= fieldSize | x - m < 0 | f[y + m][x - m] = -mySq\r\n          ?f[y + m - 1][x - m + 1] = mySq\r\n            A4 -= (w[5] * mySq)\r\n\r\n        m = 1\r\n        for _ = 0..1984  // Waiting for a while loops...\r\n          ?!(y - m >= minM & x + m < maxN & f[y - m][x + m] ! -mySq)\r\n            break\r\n          nPos[4] += 1\r\n          A4 += w[m] * f[y - m][x + m]\r\n          m++\r\n\r\n        ?y - m < 0 | x + m >= fieldSize | f[y - m][x + m] = -mySq\r\n          ?f[y - m + 1][x + m - 1] = mySq\r\n            A4 -= w[5] * mySq\r\n\r\n        var dirA = [0, 0, 0, 0, 0]\r\n\r\n        ?nPos[4] > 4\r\n          isDraw = false\r\n        \r\n        ?nPos[1] > 4\r\n          dirA[1] = A1 * A1\r\n\r\n        ?nPos[2] > 4\r\n          dirA[2] = A2 * A2\r\n        \r\n        ?nPos[3] > 4\r\n          dirA[3] = A3 * A3\r\n        \r\n        ?nPos[4] > 4\r\n          dirA[4] = A4 * A4\r\n\r\n        A1 = 0\r\n        A2 = 0\r\n        for k = 1..4\r\n          ?dirA[k] >= A1\r\n            A2 = A1\r\n            A1 = dirA[k]\r\n        \r\n        a[y][x] = A1 + A2\r\n      \r\n      ?a[y][x] > maxA\r\n        maxA = a[y][x]\r\n  \r\n  return maxA\r\n\r\nfunc hasNeighbors(x, y)\r\n  ?x > 0 & f[y][x - 1] ! 0\r\n    return true  // Left\r\n\r\n  ?x + 1 < fieldSize & f[y][x + 1] ! 0\r\n    return true  // Right\r\n\r\n  ?y > 0\r\n    ?f[y - 1][x] ! 0\r\n      return true  // Top\r\n    ?x > 0 & f[y - 1][x - 1] ! 0\r\n      return true  // Top left\r\n    ?x + 1 < fieldSize & f[y - 1][x + 1] ! 0\r\n      return true  // Top right\r\n  \r\n  ?y + 1 < fieldSize\r\n    ?f[y + 1][x] ! 0\r\n      return true  // Bottom\r\n    ?x > 0 & f[y + 1][x - 1] ! 0\r\n      return true  // Bottom left\r\n    ?x + 1 < fieldSize & f[y + 1][x + 1] ! 0\r\n      return true  // Bottom right\r\n  \r\n  return false\r\n  \r\nfunc winningPos(x, y, mySq)\r\n  var test3 = 0\r\n  var test4 = 0\r\n\r\n  var L = 1\r\n  var m = 1\r\n  for _ = 0..1984  // Waiting for a while loops...\r\n    ?!(x + m < fieldSize & f[y][x + m] = mySq) \r\n      break\r\n    L++\r\n    m++\r\n\r\n  var m1 = m\r\n  m = 1\r\n  for _ = 0..1984  // Waiting for a while loops...\r\n    ?!(x - m >= 0 & f[y][x - m] = mySq)\r\n      break\r\n    L++\r\n    m++\r\n  \r\n  var m2 = m\r\n  ?L > 4\r\n    return winningMove\r\n\r\n  var side1 = false\r\n  ?x + m1 < fieldSize & f[y][x + m1] = 0\r\n    side1 = true\r\n\r\n  var side2 = false\r\n  ?x - m2 >= 0 & f[y][x - m2] = 0\r\n    side2 = true\r\n\r\n  ?L = 4 & (side1 | side2)\r\n    test3++\r\n\r\n  ?side1 & side2\r\n    ?L = 4\r\n      test4 = 1\r\n    ?L = 3\r\n      test3++\r\n\r\n  L = 1\r\n  m = 1\r\n  for _ = 0..1984  // Waiting for a while loops...\r\n    ?!(y + m < fieldSize & f[y + m][x] = mySq)\r\n      break\r\n    L++\r\n    m++\r\n\r\n  m1 = m\r\n  m = 1\r\n  for _ = 0..1984  // Waiting for a while loops...\r\n    ?!(y - m >= 0 & f[y - m][x] = mySq)\r\n      break\r\n    L++\r\n    m++\r\n\r\n  m2 = m\r\n  ?L > 4\r\n    return winningMove\r\n  \r\n  ?y + m1 < fieldSize & f[y + m1][x] = 0\r\n    side1 = true\r\n  :\r\n    side1 = false\r\n\r\n  ?y - m2 >= 0 & f[y - m2][x] = 0\r\n    side2 = true\r\n  :\r\n    side2 = false\r\n\r\n  ?L = 4 & (side1 | side2)\r\n    test3++\r\n\r\n  ?side1 & side2\r\n    ?L = 4\r\n      test4 = 1\r\n    ?L = 3\r\n      test3++\r\n  \r\n  L = 1\r\n  m = 1\r\n  for _ = 0..1984  // Waiting for a while loops...\r\n    ?!(y + m < fieldSize & x + m < fieldSize & f[y + m][x + m] = mySq)\r\n      break\r\n    L++\r\n    m++\r\n\r\n  m1 = m\r\n  m = 1\r\n  for _ = 0..1984  // Waiting for a while loops...\r\n    ?!(y - m >= 0 & x - m >= 0 & f[y - m][x - m] = mySq)\r\n      break\r\n    L++\r\n    m++\r\n\r\n  m2 = m\r\n  ?L > 4\r\n    return winningMove\r\n  \r\n  ?y + m1 < fieldSize & x + m1 < fieldSize & f[y + m1][x + m1] = 0\r\n    side1 = true\r\n  :\r\n    side1 = false\r\n\r\n  ?y - m2 >= 0 & x - m2 >= 0 & f[y - m2][x - m2] = 0\r\n    side2 = true\r\n  :\r\n    side2 = false\r\n\r\n  ?L = 4 & (side1 | side2)\r\n    test3++\r\n\r\n  ?side1 & side2\r\n    ?L = 4\r\n      test4 = 1\r\n    ?L = 3\r\n      test3++\r\n\r\n  L = 1\r\n  m = 1\r\n  for _ = 0..1984  // Waiting for a while loops...\r\n    ?!(y + m < fieldSize & x - m >= 0 & f[y + m][x - m] = mySq)\r\n      break\r\n    L++\r\n    m++\r\n\r\n  m1 = m\r\n  m = 1\r\n  for _ = 0..1984  // Waiting for a while loops...\r\n    ?!(y - m >= 0 & x + m < fieldSize & f[y - m][x + m] = mySq)\r\n      break\r\n    L++\r\n    m++\r\n\r\n  m2 = m\r\n  ?L > 4\r\n    return winningMove\r\n\r\n  ?y + m1 < fieldSize & x - m1 >= 0 & f[y + m1][x - m1] = 0\r\n    side1 = true\r\n  :\r\n    side1 = false\r\n\r\n  ?y - m2 >= 0 & x + m2 < fieldSize & f[y - m2][x + m2] = 0\r\n    side2 = true\r\n  :\r\n    side2 = false\r\n\r\n  ?L = 4 & (side1 | side2)\r\n    test3++\r\n\r\n  ?side1 & side2\r\n    ?L = 4\r\n      test4 = 1\r\n    ?L = 3\r\n      test3++\r\n  \r\n  ?test4\r\n    return 8888888\r\n    \r\n  ?test3 >= 2\r\n    return 7777777\r\n\r\n  return -1\r\n\r\n// Main loop\r\nfunc main()\r\n  draw.Clear()\r\n  turns()\r\n  cout()\r\n  gui()\r\n  blink()\r\n  inputs()\r\n\r\n// Prepare game\r\n?loc.begin\r\n  disable banner\r\n  disable hud\r\n  disable pause\r\n  disable player\r\n  disable abilities\r\n  disable loadout input\r\n  disable loadout print\r\n\r\n  ambient.Stop()\r\n  music.Stop()\r\n\r\n  // Enable half line mode\r\n  ?string.Size(fieldMark) = 1  \r\n    halfLineMode = 1\r\n\r\n// Block all inputs first 15 tics\r\n?gameState = \"init\" & totaltime >= 15\r\n  gameState = \"game\"\r\n\r\nmain()\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/SpearThrowing.txt" - Parse error: Failed to parse completely. Remaining: "(\"╔─╗│#│╚─╝\")\r\nvar A2S = import UI/A2S\r\n\r\nvar start=false\r\nvar stopbtn\r\nvar uipnl\r\nvar uipnl2\r\nvar powerbar\r\nvar powerbar2\r\nvar powerbar3\r\nvar powerlvl=0\r\nvar powerarrow=1\r\nvar parrowdirection=1\r\nvar accuracybar\r\nvar accuracybar2\r\nvar accuracybar3\r\nvar accuracylvl=0\r\nvar accuracyarrow=1\r\nvar aarrowdirection=1\r\nvar luck\r\nvar luckrng\r\nvar outcome\r\nvar attempts=0\r\nvar target\r\nvar targetpos=3\r\nvar score=0\r\nvar minscore\r\nvar maxscore\r\nvar totalscore=0\r\nvar highscore\r\nvar highscores=[[1000,\"Scout\"],[3268.3,\"Dragon\"]]\r\nvar back\r\nvar background=ascii\r\n______________________|____________|_____________|_____________|___________/\r\n#####################/############/#############/#############/###########/ \r\n####################/############/#############/#############/###########/ /\r\n###################/############/#############/#############/###########/ /\r\n##################/############/#############/#############/###########/ /\r\n#################/############/#############/#############/###########/ /\r\n################/############/#############/#############/###########| /\r\n##############|/###########|/############|/############|/###########/|/\r\n______________|____________|_____________|_____________|___________/_|\r\n#############/############/#############/#############/###########/ /\r\n############/############/#############/#############/###########/ /\r\n###########/############/#############/#############/###########/ /\r\n##########/############/#############/#############/###########/ /\r\n#########/############/#############/#############/###########/ /\r\n########/############/#############/#############/###########| /\r\n######|/###########|/############|/############|/############|/\r\n######|############|#############|#############|#############|\r\n¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nasciiend\r\nvar back2\r\nvar background2=ascii\r\n______________________|____________|_____________|_____________|___________/\r\n                 ^   /            /     ^       /             / _         / \r\n        ^           /        ^   /             / _           /      ^    / /\r\n            _      /  ^         /  ^          /         ^   /           / /\r\n                  /       _    /      X      /      X      /   ^  X    / /\r\n      ^          /            /         _   /        _    /           / /\r\n          _     /   _        /             /    ^        /       _   | /\r\n              |/           |/  ^         |/            |/   ^       /|/\r\n______________|____________|_____________|_____________|___________/_|\r\n       ^     /            /    _        /         ^   /       _   / /\r\n            /         _  /             /  _          /           / /\r\n        _  /    ^       /             /             / ^         / /\r\n          /            /       X ^   /      ^X     /       X   / /\r\n     ^   /       _    /    ^        /             /       ^   / /\r\n        /            /             /         ^   /    ^      | /\r\n      |/   ^       |/       _    |/      _     |/            |/\r\n      |            |             |             |    _        |\r\n¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nasciiend\r\n\r\nvar side\r\nvar scorebar=ascii\r\n┌──Score───┐│\r\n│          ││\r\n├──Total───┤│\r\n│          ││\r\n└──────────┘│\r\n HighScores │\r\n            │\r\n            │\r\n            │\r\n            │\r\n            │\r\n            │\r\n            │\r\n            │\r\n            │\r\n            │\r\n            │\r\n            │\r\n            │\r\n            │\r\n            │\r\n            │\r\n            │\r\n            │\r\n            │\r\nasciiend\r\n\r\nvar rack\r\nvar spearrack=ascii\r\n. ∆  ∆  ∆ .\r\n│─│──│──│─│\r\n│ │  │  │ │\r\n│─│──│──│─│\r\n│ '  '  ' │\r\n%%\r\n. ∆  ∆    .\r\n│─│──│────│\r\n│ │  │    │\r\n│─│──│────│\r\n│ '  '    │\r\n%%\r\n. ∆       .\r\n│─│───────│\r\n│ │       │\r\n│─│───────│\r\n│ '       │\r\n%%\r\n.         .\r\n│─────────│\r\n│         │\r\n│─────────│\r\n│         │\r\nasciiend\r\n\r\nvar stonehead\r\nvar idle=ascii\r\n#\r\n####O\r\n-──´───>\r\n###/#\\\r\n%%\r\n####O\r\n###/|\\\r\n###/#\\\r\nasciiend\r\nvar powerup=ascii\r\n#\r\n####O\r\n-──´───>\r\n###/#\\\r\n%%\r\n#\r\n-──.───>\r\n###`|\\\r\n###/#\\\r\n%%\r\n-──────>\r\n###\\O\r\n####|\\\r\n###/#\\\r\nasciiend\r\n\r\nvar throw1=ascii\r\n-──────>\r\n###\\O\r\n####|\\\r\n###/#\\\r\n%%\r\n##-──────>\r\n####|\r\n####|\\\r\n###/#\\\r\n%%\r\n#######-──────>\r\n####O/\r\n####|\r\n###/#\\\r\n%%\r\n###########-──────>\r\n####O.´\r\n####|\r\n###/#\\\r\n%%\r\n##########\r\n####O__########-──────>\r\n####|\r\n###/#\\\r\n%%\r\n##########\r\n####O##############-──────>\r\n####|\\\r\n###/#\\\r\n%%\r\n##########\r\n####O##################-──────>\r\n###/|\\\r\n###/#\\\r\nasciiend\r\n\r\nvar throw2=ascii\r\n-──────>\r\n###\\O\r\n####|\\\r\n###/#\\\r\n%%\r\n##-──────>\r\n####|\r\n####|\\\r\n###/#\\\r\n%%\r\n#######-──────>\r\n####O/\r\n####|\r\n###/#\\\r\n%%\r\n###########-──────>\r\n####O.´\r\n####|\r\n###/#\\\r\n%%\r\n##########\r\n####O__########-──────>\r\n####|\r\n###/#\\\r\n%%\r\n##########\r\n####O##############-──────>\r\n####|\\\r\n###/#\\\r\n%%\r\n##########\r\n####O#\r\n###/|\\#################-──────>\r\n###/#\\\r\nasciiend\r\n\r\nvar throw3=ascii\r\n-──────>\r\n###\\O\r\n####|\\\r\n###/#\\\r\n%%\r\n##-──────>\r\n####|\r\n####|\\\r\n###/#\\\r\n%%\r\n#######-──────>\r\n####O/\r\n####|\r\n###/#\\\r\n%%\r\n###########-──────>\r\n####O.´\r\n####|\r\n###/#\\\r\n%%\r\n##########\r\n####O__########-──────>\r\n####|\r\n###/#\\\r\n%%\r\n##########\r\n####O#\r\n####|\\#############-──────>\r\n###/#\\\r\n%%\r\n##########\r\n####O#\r\n###/|\\\r\n###/#\\#################-──────>\r\nasciiend\r\n\r\nvar throw4=ascii\r\n-──────>\r\n###\\O\r\n####|\\\r\n###/#\\\r\n%%\r\n##-──────>\r\n####|\r\n####|\\\r\n###/#\\\r\n%%\r\n#########-──────>\r\n####O/\r\n####|\r\n###/#\\\r\n%%\r\n#################-──────>\r\n####O.´\r\n####|\r\n###/#\\\r\n%%\r\n##########\r\n####O__##################-──────>\r\n####|\r\n###/#\\\r\n%%\r\n##########\r\n####O##########################-──────>\r\n####|\\\r\n###/#\\\r\n%%\r\n##########\r\n####O###############################-──────>\r\n###/|\\\r\n###/#\\\r\nasciiend\r\n\r\nvar throw5=ascii\r\n-──────>\r\n###\\O\r\n####|\\\r\n###/#\\\r\n%%\r\n##-──────>\r\n####|\r\n####|\\\r\n###/#\\\r\n%%\r\n#########-──────>\r\n####O/\r\n####|\r\n###/#\\\r\n%%\r\n#################-──────>\r\n####O.´\r\n####|\r\n###/#\\\r\n%%\r\n##########\r\n####O__##################-──────>\r\n####|\r\n###/#\\\r\n%%\r\n##########\r\n####O##########################-──────>\r\n####|\\\r\n###/#\\\r\n%%\r\n##########\r\n####O#\r\n###/|\\##############################-──────>\r\n###/#\\\r\nasciiend\r\n\r\nvar throw6=ascii\r\n-──────>\r\n###\\O\r\n####|\\\r\n###/#\\\r\n%%\r\n##-──────>\r\n####|\r\n####|\\\r\n###/#\\\r\n%%\r\n#########-──────>\r\n####O/\r\n####|\r\n###/#\\\r\n%%\r\n#################-──────>\r\n####O.´\r\n####|\r\n###/#\\\r\n%%\r\n##########\r\n####O__##################-──────>\r\n####|\r\n###/#\\\r\n%%\r\n##########\r\n####O#\r\n####|\\#########################-──────>\r\n###/#\\\r\n%%\r\n##########\r\n####O#\r\n###/|\\\r\n###/#\\##############################-──────>\r\nasciiend\r\n\r\nvar throw7=ascii\r\n-──────>\r\n###\\O\r\n####|\\\r\n###/#\\\r\n%%\r\n##-──────>\r\n####|\r\n####|\\\r\n###/#\\\r\n%%\r\n###########-──────>\r\n####O/\r\n####|\r\n###/#\\\r\n%%\r\n######################-──────>\r\n####O.´\r\n####|\r\n###/#\\\r\n%%\r\n##########\r\n####O__########################-──────>\r\n####|\r\n###/#\\\r\n%%\r\n##########\r\n####O#####################################-──────>\r\n####|\\\r\n###/#\\\r\n%%\r\n##########\r\n####O#############################################-──────>\r\n###/|\\\r\n###/#\\\r\nasciiend\r\n\r\nvar throw8=ascii\r\n-──────>\r\n###\\O\r\n####|\\\r\n###/#\\\r\n%%\r\n##-──────>\r\n####|\r\n####|\\\r\n###/#\\\r\n%%\r\n###########-──────>\r\n####O/\r\n####|\r\n###/#\\\r\n%%\r\n######################-──────>\r\n####O.´\r\n####|\r\n###/#\\\r\n%%\r\n##########\r\n####O__########################-──────>\r\n####|\r\n###/#\\\r\n%%\r\n##########\r\n####O#####################################-──────>\r\n####|\\\r\n###/#\\\r\n%%\r\n##########\r\n####O#\r\n###/|\\############################################-──────>\r\n###/#\\\r\nasciiend\r\n\r\nvar throw9=ascii\r\n-──────>\r\n###\\O\r\n####|\\\r\n###/#\\\r\n%%\r\n##-──────>\r\n####|\r\n####|\\\r\n###/#\\\r\n%%\r\n###########-──────>\r\n####O/\r\n####|\r\n###/#\\\r\n%%\r\n######################-──────>\r\n####O.´\r\n####|\r\n###/#\\\r\n%%\r\n##########\r\n####O__########################-──────>\r\n####|\r\n###/#\\\r\n%%\r\n##########\r\n####O#\r\n####|\\####################################-──────>\r\n###/#\\\r\n%%\r\n##########\r\n####O#\r\n###/|\\\r\n###/#\\############################################-──────>\r\nasciiend\r\n\r\nfunc CreateUI()\r\n  uipnl=uiAP()\r\n  uipnl.w=screen.w\r\n  uipnl.h=screen.h\r\n  back=uiAA(background2)\r\n  back.dock=bottom_right\r\n  back.anchor=bottom_right\r\n  back.x=-1\r\n  back.y=-8\r\n  back.color=#808080\r\n  back2 = back.AddLayer(background)\r\n  side=uiAA(scorebar)\r\n  side.dock=top_left\r\n  side.anchor=top_left\r\n  side.x=1\r\n  side.y=1\r\n  uipnl2=uiAP()\r\n  uipnl2.w=screen.w\r\n  uipnl2.h=screen.h\r\n  uipnl2.style=corners\r\n  stonehead=uiAA(idle)\r\n  stonehead.dock=bottom_right\r\n  stonehead.anchor=bottom_right\r\n  stonehead.x=-65\r\n  stonehead.y=-13\r\n  stonehead.frame=1\r\n  stonehead.duration=15\r\n  stonehead.loop=false\r\n  target=uiAA(ascii\r\n#O\r\n´ʘ`\r\n#T\r\nasciiend)\r\n  target.dock=bottom_right\r\n  target.anchor=bottom_right\r\n  target.x=-44\r\n  target.y=-13\r\n  rack=uiAA(spearrack)\r\n  rack.dock=bottom_right\r\n  rack.anchor=bottom_right\r\n  rack.x=-61\r\n  rack.y=-2\r\n  stopbtn=uiAB()\r\n  stopbtn.dock=bottom_right\r\n  stopbtn.anchor=bottom_right\r\n  stopbtn.x=-43\r\n  stopbtn.y=-2\r\n  stopbtn.w=17\r\n  stopbtn.text=\"Play\"\r\n  stopbtn.style=corners\r\n  stopbtn.SetPressed(StopBar)\r\n  powerbar=uiAA(ascii\r\n╔═══════════════════════════════╗\r\n║████████████████████████████████║\r\n╚═══════════════════════════════╝\r\nasciiend)\r\n  powerbar.dock=bottom_right\r\n  powerbar.anchor=bottom_right\r\n  powerbar.x=-8\r\n  powerbar.y=-3\r\n  powerbar.color=#red\r\n  powerbar2=powerbar.AddLayer(ascii\r\n###############══════════════════╗\r\n###############██████████████████║\r\n###############══════════════════╝\r\nasciiend)\r\n  powerbar2.color=#yellow\r\n  powerbar3=powerbar.AddLayer(ascii\r\n###########################══════╗\r\n###########################██████║\r\n###########################══════╝\r\nasciiend)\r\n  powerbar3.color=#green\r\n  accuracybar=uiAA(ascii\r\n╔═╗\r\n║█║\r\n║█║\r\n║█║\r\n║█║\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n║█║\r\n║█║\r\n║█║\r\n║█║\r\n╚═╝\r\nasciiend)\r\n  accuracybar.dock=bottom_right\r\n  accuracybar.anchor=bottom_right\r\n  accuracybar.x=-3\r\n  accuracybar.y=-7\r\n  accuracybar.color=#red\r\n  accuracybar2=accuracybar.AddLayer(ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n║█║\r\n║█║\r\n║█║\r\n#\r\n#\r\n║█║\r\n║█║\r\n║█║\r\nasciiend)\r\n  accuracybar2.color=#yellow\r\n  accuracybar3=accuracybar.AddLayer(ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#\r\n║█║\r\n║█║\r\nasciiend)\r\n  accuracybar3.color=#green\r\n\r\nfunc Arrows()\r\n  ?powerlvl<1\r\n    ?parrowdirection=1\r\n      powerarrow++\r\n      ?powerarrow=15\r\n        parrowdirection=0\r\n    :\r\n      powerarrow--\r\n      ?powerarrow=0\r\n        parrowdirection=1\r\n  ?accuracylvl<1\r\n    ?aarrowdirection=1\r\n      accuracyarrow++\r\n      ?accuracyarrow=15\r\n        aarrowdirection=0\r\n    :\r\n      accuracyarrow--\r\n      ?accuracyarrow=0\r\n        aarrowdirection=1\r\n  ?targetpos=1\r\n    target.x=-44\r\n  :?targetpos=2\r\n    target.x=-30\r\n  :\r\n    target.x=-16\r\n  >`@screen.w-41+2*powerarrow@,@screen.h-6@,ascii\r\n\\/\r\n##\r\n/\\\r\nasciiend\r\n  >`@screen.w-6@,@screen.h-9-accuracyarrow@,>#<\r\n\r\nfunc StopBar()\r\n  ?start=false\r\n    start=true\r\n    rack.frame=1\r\n    stopbtn.text=\"Power\"\r\n  :?powerlvl=0\r\n    ?powerarrow<=6\r\n      powerlvl=1\r\n    :?powerarrow<=12\r\n      powerlvl=2\r\n    :\r\n      powerlvl=3\r\n    stopbtn.text=\"Accuracy\"\r\n    stonehead.Load(powerup)\r\n    stonehead.Play()\r\n  :?accuracylvl=0\r\n    ?accuracyarrow<=3|accuracyarrow>=12\r\n      accuracylvl=1\r\n    :?accuracyarrow<=6|accuracyarrow>=9\r\n      accuracylvl=2\r\n    :\r\n      accuracylvl=3\r\n    ?attempts<3\r\n      stopbtn.text=\"Next\"\r\n      DetermineOutcome()\r\n  :?attempts<3\r\n    targetpos=rng%3+1\r\n    powerlvl=0\r\n    accuracylvl=0\r\n    stopbtn.text=\"Power\"\r\n    stonehead.Load(idle)\r\n    ?attempts=1\r\n      rack.frame=2\r\n    :\r\n      rack.frame=3\r\n  :\r\n    targetpos=rng%3+1\r\n    attempts=0\r\n    powerlvl=0\r\n    accuracylvl=0\r\n    score=0\r\n    totalscore=0\r\n    stopbtn.text=\"Power\"\r\n    stonehead.Load(idle)\r\n    rack.frame=1\r\n\r\nfunc DetermineOutcome()\r\n  ?targetpos=1 //0% score bonus\r\n    ?powerlvl=1\r\n      ?accuracylvl=1\r\n        score=400+rng%(700-400+1) //(50%)\r\n        stonehead.Load(throw3)\r\n        stonehead.Play()\r\n      :?accuracylvl=2\r\n        score=650+rng%(950-650+1) //(75%)\r\n        stonehead.Load(throw2)\r\n        stonehead.Play()\r\n      :?accuracylvl=3\r\n        score=900+rng%(1000-900+1) //(100%)\r\n        stonehead.Load(throw1)\r\n        stonehead.Play()\r\n    :?powerlvl=2\r\n      score=150+rng%(450-150+1) //(25%)\r\n      stonehead.Load(throw6)\r\n      stonehead.Play()\r\n    :\r\n      score=0+rng%(100-0+1) //(0%)\r\n      stonehead.Load(throw9)\r\n      stonehead.Play()\r\n  :?targetpos=2 //10% score bonus\r\n    ?powerlvl=2\r\n      ?accuracylvl=1\r\n        score=(400+rng%(700-400+1))*1.1 //(50%)\r\n        stonehead.Load(throw6)\r\n        stonehead.Play()\r\n      :?accuracylvl=2\r\n        score=(650+rng%(950-650+1))*1.1 //(75%)\r\n        stonehead.Load(throw5)\r\n        stonehead.Play()\r\n      :?accuracylvl=3\r\n        score=(900+rng%(1000-900+1))*1.1 //(100%)\r\n        stonehead.Load(throw4)\r\n        stonehead.Play()\r\n    :?powerlvl=3\r\n      score=(150+rng%(450-150+1))*1.1 //(25%)\r\n      stonehead.Load(throw9)\r\n      stonehead.Play()\r\n    :\r\n      score=(150+rng%(450-150+1))*1.1 //(25%)\r\n      stonehead.Load(throw3)\r\n      stonehead.Play()\r\n  :?targetpos=3 //25% score bonus\r\n    ?powerlvl=3\r\n      ?accuracylvl=1\r\n        score=(400+rng%(700-400+1))*1.25 //(50%)\r\n        stonehead.Load(throw9)\r\n        stonehead.Play()\r\n      :?accuracylvl=2\r\n        score=(650+rng%(950-650+1))*1.25 //(75%)\r\n        stonehead.Load(throw8)\r\n        stonehead.Play()\r\n      :?accuracylvl=3\r\n        score=(900+rng%(1000-900+1))*1.25 //(100%)\r\n        stonehead.Load(throw7)\r\n        stonehead.Play()\r\n    :?powerlvl=2\r\n      score=(150+rng%(450-150+1))*1.25 //(25%)\r\n      stonehead.Load(throw6)\r\n      stonehead.Play()\r\n    :\r\n      score=(0+rng%(100-0+1))*1.25 //(0%)\r\n      stonehead.Load(throw3)\r\n      stonehead.Play()\r\n  luckrng=rng\r\n  ?luckrng%3=1\r\n    luckrng=rng\r\n    ?luckrng%3<2\r\n      score=score+(10+rng%(100-10+1))\r\n    :\r\n      score=score+(50+rng%(250-10+1))\r\n  :?luckrng%3=2\r\n    luckrng=rng\r\n    ?luckrng%3<2\r\n      score=score-(10+rng%(100-10+1))\r\n    :\r\n      score=score-(50+rng%(250-10+1))\r\n  totalscore=totalscore+score\r\n  attempts++\r\n  ?attempts=3\r\n    ?totalscore>highscore\r\n      highscore=totalscore\r\n      ?highscore>=3268.3\r\n        highscores.Add([totalscore,player.name])\r\n      :\r\n        highscores.Insert(highscores.Count()-1,[totalscore,player.name])\r\n      ?highscores.Count()>6\r\n        highscores.RemoveAt(0)\r\n      storage.set(\"highscore\",highscore)\r\n      storage.set(\"highscores\",A2S.Stringify(highscores))\r\n    stopbtn.text=\"Retry?\"\r\n      \r\n\r\nfunc ShowScore()\r\n  ?highscores.Count()>0\r\n    for s = 0..highscores.Count()-1\r\n      >`3,@24-3*s@,@highscores[s][0]@\r\n      >`3,@23-3*s@,@highscores[s][1]@\r\n\r\n?loc=\"waterfall\"\r\n  ?totaltime=1\r\n    CreateUI()\r\n    targetpos=rng%3+1\r\n    highscore=storage.Get(\"highscore\",0)\r\n    highscores=A2S.Arrayify(storage.Get(\"highscores\"))\r\n    ui.ShowBanner(\"Spear Throwing\")\r\n  ?start\r\n    Arrows()\r\n  ShowScore()\r\n\r\n  >`3,2,@score@\r\n  >`3,4,@totalscore@"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/SudokuEnchant/SudokuJamWindow.txt" - Parse error: Failed to parse completely. Remaining: "(\"·─·| |·─·\")\r\n  jamWindow.style = customStyle\r\n\r\n  var yellowJam = ui.AddText()\r\n  jamWindow.Add(yellowJam)\r\n  yellowJam.color = #EAD142\r\n  yellowJam.text = yellowJamText\r\n  yellowJam.w = 21\r\n  yellowJam.h = 13\r\n\r\n  var jamCloseButton = ui.AddButton()\r\n  jamWindow.Add(jamCloseButton)\r\n  jamCloseButton.SetDown(flyOut)\r\n  jamCloseButton.style = 2\r\n  jamCloseButton.dock = top_right\r\n  jamCloseButton.anchor = top_right\r\n  jamCloseButton.x = -1\r\n  jamCloseButton.y = 1\r\n  jamCloseButton.w = 5\r\n  jamCloseButton.h = 3\r\n  jamCloseButton.text = string.Format(\"×\")\r\n\r\n  var jamNote = ui.AddText()\r\n  jamWindow.Add(jamNote)\r\n  jamNote.color = #FFFFFF\r\n  jamNote.align = center\r\n  jamNote.w = jamWindow.w - 8\r\n  jamNote.h = 2\r\n  jamNote.y = 7\r\n  ?te.language = \"ZH-CN\"\r\n    jamNote.text = jamNoteText[0]\r\n  :?te.language = \"ZH-TW\"\r\n    jamNote.text = jamNoteText[1]\r\n  :\r\n    jamNote.text = jamNoteText[2]\r\n    jamNote.y = 6\r\n\r\n  for i = 0..5\r\n    var jamShinymAnim_ = ui.AddAnim(jamShiny)\r\n    jamShinymAnim_.duration = 11\r\n    jamShinymAnim_.color = #F7D930\r\n    jamShinymAnim_.loop = false\r\n    jamShinymAnim_.dock = top_left\r\n    jamShinymAnim_.x = rng % jamWindow.w\r\n    jamShinymAnim_.y = rng % jamWindow.h\r\n    jamShinyAnimList.Add(jamShinymAnim_)\r\n    jamWindow.Add(jamShinymAnim_)\r\n\r\nfunc shinyAnimPlay()\r\n  ?totaltime % 2 = 0\r\n    var i = (totaltime % 12)/2\r\n    jamShinyAnimList[i].x = rng % jamWindow.w\r\n    jamShinyAnimList[i].y = rng % jamWindow.h\r\n    jamShinyAnimList[i].Play()\r\n\r\n\r\n\r\nfunc fly()\r\n  ?flyDirection = 1\r\n    jamWindow.visible = true\r\n    ?jamWindow.y > 0\r\n      jamWindow.y = screen.h + 3 - dt(flyTime)\r\n    :?jamWindow.y <= 0\r\n      jamWindow.y = 0\r\n      flyDirection = 0\r\n  :?flyDirection = -1\r\n    jamWindow.visible = true\r\n    ?jamWindow.y < screen.h + 3\r\n      jamWindow.y = dt(flyTime)\r\n    :?jamWindow.y >= screen.h + 3\r\n      flyDirection = -2\r\n      jamWindow.Clear()\r\n      jamWindow.Recycle()\r\n\r\n\r\nfunc flyIn()\r\n  flyDirection = 1\r\n  flyTime = totaltime\r\n  play level_up\r\n\r\nfunc flyOut()\r\n  flyDirection = -1\r\n  flyTime = totaltime\r\n\r\nfunc dt(time_)\r\n  return (totaltime - time_)\r\n\r\n\r\nvar jamWindow\r\nvar flyTime = -1\r\nvar flyDirection = -2\r\n\r\nvar yellowJamText = ascii\r\n           _._\r\n       ,<‾´ \\ ‾`:\r\n      / /\\,.-^-.'\\\r\n     / |  :     \\ \\\r\n    /  |,-┤      \\ \\\r\n   / ,´\\  \\       ├-┤\r\n  /,´   \\  \\      | |\r\n /´      \\  \\_    | |\r\n  ‾‾`──.__\\ / `V´‾`;´\r\n          ‾`--_|_-´\r\n               ‾\r\nasciiend\r\n\r\nvar jamNoteText = [\r\n\"一颗黄宝石，如同闪耀的星星碎片，蕴含着对抗黑暗的力量。\\n(在Stone Dungeon标题输入←←→→后开始游戏以使用宝石)\",\r\n\"一顆黃寶石，如同閃耀的星星碎片，蘊含著對抗黑暗的力量。\\n(在Stone Dungeon標題輸入←←→→後開始遊戲以使用寶石)\",\r\n\"A yellow gem, like sparkling fragments of stars, contains the power to fight against darkness.\\n(Input ←←→→ at Stone Dungeon's title then start the game with this gem.)\"\r\n]\r\n\r\nvar jamShinyAnimList = []\r\nvar jamShiny = ascii\r\n\r\n\r\n##·\r\n\r\n\r\n%%\r\n\r\n\r\n##*\r\n\r\n\r\n%%\r\n\r\n\r\n##┼\r\n\r\n\r\n%%\r\n\r\n##|\r\n#-┼-\r\n##|\r\n\r\n%%\r\n##|\r\n##|\r\n--#--\r\n##|\r\n##|\r\n%%\r\n##|\r\n###\r\n-###-\r\n###\r\n##|\r\nasciiend\r\n\r\n//#EAD142"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/SudokuEnchant/SudokuStore.txt" - Parse error: Failed to parse completely. Remaining: "= [\r\n[//0.2 1-50\r\n    \"254603361205523461410530632150045026\",\r\n    \"021346346502065004134625403261612403\",\r\n    \"206513350462532640610025105204423156\",\r\n    \"152346346501503064264135600413431600\",\r\n    \"465230231650526043143026310405604312\",\r\n    \"000504541326253461416053120605365142\",\r\n    \"652030341526260143034265526010413602\",\r\n    \"620130314206106540042361063415451623\",\r\n    \"354620201543023064416235140356005412\",\r\n    \"065104130052521346046521413265050413\",\r\n    \"046251521463215046634020150634063012\",\r\n    \"053240210506021364346152402615160423\",\r\n    \"460013513604250436030152345261126340\",\r\n    \"152463360020501042246315025106613254\",\r\n    \"625010103256502360360021231645456132\",\r\n    \"030514514360125643603250360425452036\",\r\n    \"254603361245523461406532632000105026\",\r\n    \"051324243500365001124653506432432105\",\r\n    \"546210210465152604034021305106461352\",\r\n    \"452361316504503012240635625143034200\",\r\n    \"562140431650325416106035250060613524\",\r\n    \"002614140325253461460532604053305146\",\r\n    \"052403346521620134031256513042264005\",\r\n    \"120630034251306510512306051463463125\",\r\n    \"524610163500201406436251342165005324\",\r\n    \"005210124003251306430521642135513462\",\r\n    \"246531513462320146461053004620602014\",\r\n    \"003264240530650143134652401325320416\",\r\n    \"560001043625451036206014315462624153\",\r\n    \"523416460003030654654132216005345261\",\r\n    \"325060106253652010013026264135531642\",\r\n    \"026514014360253146601053062435435021\",\r\n    \"124603563241251436406512605300302065\",\r\n    \"021346346502260134130625053261602403\",\r\n    \"026513350062542631013045204106165324\",\r\n    \"152346346501503004264135625413431000\",\r\n    \"165240234650426315510020352060641532\",\r\n    \"002614146325053461460532600203325146\",\r\n    \"302401146523620134031256513042204305\",\r\n    \"025046014253106520542360260415451632\",\r\n    \"354620061543023004416235142356005412\",\r\n    \"065200124000251346430521642135513462\",\r\n    \"146253523461210046634105401630062014\",\r\n    \"013264206501652143034052401325320416\",\r\n    \"062003503624251036604052345261126345\",\r\n    \"152460364001030642246315425036610254\",\r\n    \"625010103206512360360021231645456132\",\r\n    \"026514514300253106640253062435435021\",\r\n    \"254603361245523461400532632100140320\"\r\n  ],\r\n  [//0.3 51-100\r\n    \"506213203460100630630521025046401352\",\r\n    \"050140140523010060264315625431431600\",\r\n    \"465230231650526003143026300060654310\",\r\n    \"004601561024152403340012610205420136\",\r\n    \"652030341026260143034205520304413600\",\r\n    \"120630634250046502012006251463003125\",\r\n    \"054013063042021036406251342165005304\",\r\n    \"005200130600250346340512613425504163\",\r\n    \"456231123405245010630502504620300054\",\r\n    \"053461106502625014314200502140430605\",\r\n    \"460013013620250436030050345061126345\",\r\n    \"002316361500004061010435125603643152\",\r\n    \"625010040056512360360521201640406132\",\r\n    \"036521012300250136300245043652625003\",\r\n    \"254010361045023401416032032150045026\",\r\n    \"051346346502460231100604004103613405\",\r\n    \"306521201460502600610352060205425136\",\r\n    \"251046006520500204462135625413104600\",\r\n    \"065243034651026305513026300104601530\",\r\n    \"002600146305253461460032610203320146\",\r\n    \"521063340021650134034050465302213600\",\r\n    \"620130314250036502042001203415451603\",\r\n    \"150620260540520436436210345160002304\",\r\n    \"000210124003050346430521642135503462\",\r\n    \"506231023465215306034050450613060024\",\r\n    \"013264206500652143134602060320320406\",\r\n    \"160043043621401006206050315062624315\",\r\n    \"152403364000030640206015425106613254\",\r\n    \"523060100253652304304526201600405132\",\r\n    \"026510504360253146000253062435435001\",\r\n    \"324601501040203416416032035120042065\",\r\n    \"021346346502260034130605003261610403\",\r\n    \"406513301460502601600045204106165324\",\r\n    \"251046046500500204462135620413134600\",\r\n    \"652140431650564031210465005026026500\",\r\n    \"000610146305253461460532010203320146\",\r\n    \"251060346021605034104250513602462300\",\r\n    \"120034034250300512010340051463463125\",\r\n    \"350620260540520164416235102056005402\",\r\n    \"005204120053051306406521642135003462\",\r\n    \"046250521463215306034020150634060012\",\r\n    \"013260240530652143134602061305020406\",\r\n    \"460013013604250436004050345061126345\",\r\n    \"452316360000030201010435125603643152\",\r\n    \"625010100256512304300521231605056032\",\r\n    \"026514014302253140041200160435435001\",\r\n    \"254603360240023461410530632100105026\",\r\n    \"001346346510065104134020400261612403\",\r\n    \"106523203460502010610352005106461235\"\r\n    ],\r\n  [\r\n    //0.38 101-150\r\n    \"562043031652020406140035200060013520\",\r\n    \"000601561024253406106532010200300165\",\r\n    \"021403346021650130004250405300213600\",\r\n    \"620030004256100542040300063415401623\",\r\n    \"150620260501021036436015340060002304\",\r\n    \"002104100052045016300245401523003461\",\r\n    \"465031031654020103140026300400604310\",\r\n    \"003201210500625143341602032006104005\",\r\n    \"460010003624250436030100345061106340\",\r\n    \"253406460000002041040352320104604235\",\r\n    \"600403040006512304064021231640006132\",\r\n    \"035214010305523140060520340050156002\",\r\n    \"254003360040523061410530630100045026\",\r\n    \"051304243500365041120603006430002105\",\r\n    \"062003000624251036604050345061106340\",\r\n    \"251046046501003000062135625410130600\",\r\n    \"365240204653020305530006140060052130\",\r\n    \"000604146025253401401532004050300146\",\r\n    \"152063340521605100431006013002204300\",\r\n    \"024006013204300521050400035642402315\",\r\n    \"350620061043023064416035140050035010\",\r\n    \"005204100003201346406521002135003462\",\r\n    \"306251521463205006034020150604000012\",\r\n    \"523406460000030604050132210305305261\",\r\n    \"062001004623450236030104120065605310\",\r\n    \"452300361000030201010435120603603152\",\r\n    \"105060030000652314041026263140004632\",\r\n    \"026514010302253046001250160405035001\",\r\n    \"524003360040253461400032032100045026\",\r\n    \"021346340500265034130605000261002403\",\r\n    \"506213003460002604604520320140061052\",\r\n    \"021306306520200100164205612450430600\",\r\n    \"652140431650060200213005140020026510\",\r\n    \"000010146305253460460032610203020146\",\r\n    \"251063340521605100134050500600462300\",\r\n    \"620030314250030540502000263415001623\",\r\n    \"053001201503504106316204145002002405\",\r\n    \"005200120003201346406521042105003462\",\r\n    \"602531513402236050051020120603000015\",\r\n    \"013064040500652103134650401300320406\",\r\n    \"460010013624201430600102340261006340\",\r\n    \"052310361000030260200435120603603152\",\r\n    \"605010040000512364064021231640006132\",\r\n    \"026514010300253146001250160405430001\",\r\n    \"254003360040523061410530032100045026\",\r\n    \"021346346002065034130020400261002403\",\r\n    \"300521200463000610610352060205405136\",\r\n    \"000600146305253460460032610203020146\",\r\n    \"065241014653020010531006140060052130\"\r\n      ],\r\n  [//0.45 151-200\r\n    \"521063340501602100130206000000213600\",\r\n    \"620000304250036502002000200415401623\",\r\n    \"020610103042051036406050340060005304\",\r\n    \"250003360040503061410530032100045006\",\r\n    \"106250523460005040630020450602000014\",\r\n    \"053060106000025314304250502100030605\",\r\n    \"460010013024200036030102340261006300\",\r\n    \"452306300000504201010405000603603152\",\r\n    \"013060206001652043034602060300020406\",\r\n    \"030521000004054136300245043050620003\",\r\n    \"000600146305250460460032010203020046\",\r\n    \"051346346002460001102050000163003400\",\r\n    \"600210000465000100120036301602402351\",\r\n    \"251046006501003004402135605403000600\",\r\n    \"265140431650506014100065300000602000\",\r\n    \"000010140320253061061032010203020046\",\r\n    \"452060316020620410043206000002264000\",\r\n    \"620000304206006540502000060415401623\",\r\n    \"050620260540021036406010340002002304\",\r\n    \"000010120003201346406501042030003462\",\r\n    \"040251521460005040630105100604000012\",\r\n    \"013060040500650143104650401300020406\",\r\n    \"051306346500465031030600000163003400\",\r\n    \"452306300000504060206405005003603152\",\r\n    \"013060206001652043034602060300020406\",\r\n    \"026510000060253146001250160030430001\",\r\n    \"320001560040203416406502630004002005\",\r\n    \"021346346000265034030020000261002400\",\r\n    \"500210003065000600034021305106401352\",\r\n    \"062003000620251006604050345061100340\",\r\n    \"165240234650406015500420300000041000\",\r\n    \"652031340506205100134060000000413600\",\r\n    \"001460346501052034004250400000213600\",\r\n    \"620000010256006540502000200415401623\",\r\n    \"020610160502051006430201042005005304\",\r\n    \"000200120003201306430520602105003462\",\r\n    \"602531513400030104401026020600000015\",\r\n    \"003204040500652143004650401300020406\",\r\n    \"460010000620251006604050345061100340\",\r\n    \"352406400000030260206305005034040152\",\r\n    \"013060206001652043034602060300020406\",\r\n    \"026510000300253146001053062030430001\",\r\n    \"250003360040503461406502602000140020\",\r\n    \"021346346002260130104000003260002400\",\r\n    \"020610160502051036406050340005005304\",\r\n    \"250306300520500200062035625410100600\",\r\n    \"365240214650406015500026100000052000\",\r\n    \"000601561024203400140530600203020065\",\r\n    \"352060146020620130031206000002204300\"\r\n      ],\r\n  [//0.5 201-250\r\n    \"050620063041021036400200040002002304\",\r\n    \"250003360040503061010530030100045006\",\r\n    \"000000146305250460460002010203020046\",\r\n    \"053060206004625100340600502000060305\",\r\n    \"062003003600251006604050345001100300\",\r\n    \"002310061000004061000430100603603152\",\r\n    \"000000120003201346406501042030003062\",\r\n    \"030210000305520106000523042050150002\",\r\n    \"250000361005020461010032030100045006\",\r\n    \"000326263004340260106000004602002100\",\r\n    \"100520003400002000610302025046001235\",\r\n    \"051306040021010060060035025410100600\",\r\n    \"260140431650506004140005300000602000\",\r\n    \"000004146025203401400002010203020046\",\r\n    \"452061010020620410043200000000264100\",\r\n    \"620000304050036502000001063410051603\",\r\n    \"004013013046021034406000040002002401\",\r\n    \"000000120003050346430520602105003062\",\r\n    \"000000146305250460460002010203020046\",\r\n    \"013060206001652040034602060000020406\",\r\n    \"360040014023400036030050123005600300\",\r\n    \"002403064000001042000310400106603254\",\r\n    \"105060000001602310300026263100004602\",\r\n    \"000000120003201346406501042030003062\",\r\n    \"520003301005050401406032030100045006\",\r\n    \"020610160502051036406000300005005304\",\r\n    \"100520003400002004604002020106401235\",\r\n    \"251046006500500200400130625403000600\",\r\n    \"065041014653020305530006100000650000\",\r\n    \"000000146305250460460030010203020046\",\r\n    \"020610160502051036406000300005005304\",\r\n    \"652031040506205100134000000000413600\",\r\n    \"020610160540250436030001000060005304\",\r\n    \"000000120003201306430520602105003062\",\r\n    \"000000146305250460460002010203020046\",\r\n    \"013060206000652140034602060000020406\",\r\n    \"460010013024200036004050345001100300\",\r\n    \"460031031654020103140006300000604000\",\r\n    \"000000120003201346406501042030003062\",\r\n    \"020510000060253140001203062030430001\",\r\n    \"652041001506003004000130425603000400\",\r\n    \"000046346500265004104020000261002400\",\r\n    \"460031031654020103140006300000604000\",\r\n    \"460031031654020103140006300000604000\",\r\n    \"460031031654020103140006300000604000\",\r\n    \"000000541306250460410050104005060042\",\r\n    \"652030301020260140004260000000413600\",\r\n    \"652031040506205100134000000000413600\",\r\n    \"050620260540520164010005000050005402\"\r\n      ],\r\n  [//0.6  251-300\r\n    \"040253500001000306034020450002000010\",\r\n    \"000000046005250460460002000203020046\",\r\n    \"460031031600020103140006300000600000\",\r\n    \"000000046005250460460002000203020046\",\r\n    \"460031031600020103140006300000600000\",\r\n    \"030510000302125600040200300020400006\",\r\n    \"460031031600020103140006300000600000\",\r\n    \"000000046005250460460002000203020046\",\r\n    \"460031031600020103140006300000600000\",\r\n    \"000000046005250460460002000203020046\",\r\n    \"560140401600020406140005200000010000\",\r\n    \"652040001506003004000130420600000400\",\r\n    \"020610160502051006400000300005000304\",\r\n    \"000000046005250460460002000203020046\",\r\n    \"460031031600020103140006300000600000\",\r\n    \"652040001506003004000130420600000400\",\r\n    \"206531000400005040460203100020000010\",\r\n    \"000000046005250460460002000203020046\",\r\n    \"460031031600020103140006300000600000\",\r\n    \"000000046005250460460002000203020046\",\r\n    \"460031031600020103140006300000600000\",\r\n    \"652040001506003004000130420600000400\",\r\n    \"460031031600020103140006300000600000\",\r\n    \"000000046005250460460002000203020046\",\r\n    \"020003000460000600010200034056065024\",\r\n    \"251040006501003000400105025010000600\",\r\n    \"020610160502051006400000300005000304\",\r\n    \"000000046005250460460030000203020046\",\r\n    \"352061040500605000431000000002200300\",\r\n    \"025000000003000524040000060415401032\",\r\n    \"050021001503503100410000040006000402\",\r\n    \"652040001506003004000130420600000400\",\r\n    \"460031031600020103140006300000600000\",\r\n    \"000000046005250460460002000203020046\",\r\n    \"062003003604250036000102040061000000\",\r\n    \"000000046005250460460002000203020046\",\r\n    \"460031031600020103140006300000600000\",\r\n    \"652040001506003004000130420600000400\",\r\n    \"460031031600020103140006300000600000\",\r\n    \"000340346000065034030600000201002400\",\r\n    \"460031031600020103140006300000600000\",\r\n    \"000000046005250460460002000203020046\",\r\n    \"020610160502051006400000300005000304\",\r\n    \"652040001506003004000130420600000400\",\r\n    \"020610160502051006400000300005000304\",\r\n    \"000000046005250460460002000203020046\",\r\n    \"460031031600020103140006300000600000\",\r\n    \"652040001506003004000130420600000400\",\r\n    \"406231000400005010630040510003000050\"\r\n  ]\r\n]\r\n\r\n\r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/SudokuEnchant/SudokuStart.txt" - Parse error: Failed to parse completely. Remaining: "(musicList[rng % musicList.Count()])\r\n    banner(0)    \r\n    highLevel = storageLevel(0)\r\n\t\tinitUI()\r\n    adjustUI()\r\n  ?totaltime = 2\r\n    sudoCore.initUI()\r\n    ballFlashInit()\r\n  ?totaltime > 2\r\n    sudoCore.core()\r\n    loopEvent()\r\n\r\n\r\nfunc initUI()\r\n  mainWindow = ui.AddPanel()\r\n  mainWindow.clip = true\r\n\r\n  mainWindow.x = 0\r\n  mainWindow.y = 0\r\n  mainWindow.anchor = center_center\r\n  mainWindow.dock = center_center\r\n\tmainWindow.w = screen.w\r\n\tmainWindow.h = screen.h\r\n  var customStyle = ui.AddStyle(\"╔═╗║ ║╚═╝\")\r\n  mainWindow.style = customStyle\r\n\r\n  title = ui.AddText()\r\n  mainWindow.Add(title)\r\n  title.x = 0\r\n  title.y = 0\r\n  title.ay = center\r\n  title.dy = center\r\n  title.w = sudoW\r\n  title.h = sudoH\r\n  title.text = string.Format(sudoAnimVar.titleText)\r\n  title.color = #999999\r\n\r\n  buttonList.Clear()\r\n  enTitleAnim.Clear()\r\n  enTitleLayer.Clear()\r\n\r\n  for i = 0..5\r\n    buttonInit(enchantAnimPos[i][0],enchantAnimPos[i][1],i)\r\n    sudoEnchantAnimInit(mainWindow,enTitleAnim,enTitleLayer,enchantAnimPos[i][0],enchantAnimPos[i][1],i)\r\n    enTitleAnim[i].dock = center_center\r\n\r\n  startNote = ui.AddText()\r\n  mainWindow.Add(startNote)\r\n  startNote.color = #FFFFFF\r\n  startNote.align = center\r\n  startNote.dock = bottom_center\r\n  startNote.w = mainWindow.w - 16\r\n  startNote.h = 2\r\n  startNote.y = -2\r\n  ?te.language = \"ZH-CN\"\r\n    startNote.text = startNoteText[0]\r\n  :?te.language = \"ZH-TW\"\r\n    startNote.text = startNoteText[1]\r\n  :\r\n    startNote.text = startNoteText[2]\r\n\r\n  resetButton = ui.AddButton()\r\n  mainWindow.Add(resetButton)\r\n  resetButton.SetDown(resetButtonDown)\r\n  resetButton.style = 2\r\n  resetButton.dock = top_right\r\n  resetButton.anchor = top_right\r\n  resetButton.x = -1\r\n  resetButton.y = 1\r\n  resetButton.w = 5\r\n  resetButton.h = 3\r\n  resetButton.text = string.Format(\"R\")\r\n  \r\nfunc loopEvent()\r\n  ?ballFlashTime > 0\r\n    ?dt(ballFlashTime) = 36\r\n      ballFlashAnim.Pause()\r\n      ?sudoCore.mainWindow.visible = false \r\n        sudoCore.mainWindow.visible = true\r\n        mainWindow.visible = false\r\n      :\r\n        sudoCore.mainWindow.visible = false\r\n        mainWindow.visible = true\r\n      ballFlashAnim.visible = true\r\n    :?dt(ballFlashTime) = 50\r\n      ballFlashAnim.Play()\r\n    :?dt(ballFlashTime) > 180\r\n      ballFlashAnim.visible = false\r\n      ballFlashTime = -1\r\n\r\n  ?sudoCore.vectory = 1 \r\n    ?sudoCore.dt(sudoCore.vectoryTime) = 45\r\n      highLevel = storageLevel(nowLevel+1)\r\n      ballFlashStart(colorEnAnim[nowLevel],0,0)\r\n      adjustUI()\r\n      nowLevel = -1\r\n  \r\n  ?totaltime > 25\r\n    ?highLevel >= 6 \r\n      jamInit()\r\n    ?sudoJamWindow.flyDirection > -2\r\n      sudoJamWindow.shinyAnimPlay()\r\n      ?sudoJamWindow.flyDirection ! 0\r\n        sudoJamWindow.fly()\r\n        ?sudoJamWindow.flyDirection = -1\r\n            for i = 0..5\r\n              buttonList[i].visible = inherit\r\n            jamButton.visible = inherit\r\n            resetButton.visible = inherit\r\n\r\nfunc ballFlashStart(color_,x_,y_)\r\n  ballFlashAnim.color = color_\r\n  ballFlashAnim.x = x_ \r\n  ballFlashAnim.y = y_ \r\n  ballFlashAnim.visible = true\r\n  ballFlashAnim.Play()\r\n  play soul_stone\r\n  ballFlashTime = totaltime\r\n\r\nfunc ballFlashInit()\r\n  ballFlashAnim = ui.AddAnim(sudoAnimVar.ballFlash)\r\n  ballFlashAnim.visible = false\r\n  ballFlashAnim.duration = 60\r\n  ballFlashAnim.pivotY = -2\r\n  ballFlashAnim.loop = false\r\n  ballFlashAnim.dock = center_center\r\n\r\nfunc jamInit()\r\n  ?jamTime = -1\r\n    jamButton = ui.AddButton()\r\n    mainWindow.Add(jamButton)\r\n    jamButton.SetDown(jamShow)\r\n    jamButton.style = 0\r\n    jamButton.visible = false\r\n    jamButton.x = -1\r\n    jamButton.w = 3\r\n    jamButton.h = 3\r\n    jamButton.text = \"\"\r\n\r\n    jamTime = totaltime\r\n    jamAnim = ui.AddAnim(sudoAnimVar.yellowJam)\r\n    mainWindow.Add(jamAnim)\r\n    jamAnim.duration = 70\r\n    jamAnim.color = #EAD142\r\n    jamAnim.loop = true\r\n    jamAnim.pivotX = 0\r\n    jamAnim.pivotY = 0\r\n    jamAnim.Play()\r\n\r\n    boxAnim = ui.AddAnim(sudoAnimVar.jamBox)\r\n    mainWindow.Add(boxAnim)\r\n    boxAnim.duration = 90\r\n    boxAnim.pivotY = 0\r\n    boxAnim.pivotX = 1\r\n    boxAnim.color = #999999\r\n    boxAnim.loop = false\r\n  :?dt(jamTime) > 40 & dt(jamTime) <= 130\r\n    var t = dt(jamTime)\r\n    var t_c = math.sin(t*math.pi*0.05) / 2 + 0.5\r\n    ?t_c = 1\r\n      play haunted_gate_key_bounce_1\r\n    boxAnim.color = color.Lerp(\"#333333\", \"#ffffff\", t_c)\r\n  :?dt(jamTime) = 131\r\n    boxAnim.Play()\r\n  :?dt(jamTime) = 220\r\n    jamButton.visible = inherit\r\n\r\nfunc jamShow()\r\n  for i = 0..5\r\n    buttonList[i].visible = false\r\n  jamButton.visible = false\r\n  resetButton.visible = false\r\n  sudoJamWindow.initUI()\r\n  sudoJamWindow.flyIn()\r\n\r\nfunc adjustUI()\r\n  for i = 0..5\r\n    ?i < highLevel\r\n      enTitleAnim[i].visible = inherit\r\n      enTitleLayer[i].color = #FFFFFF\r\n      buttonList[i].visible = inherit\r\n    :?i = highLevel\r\n      enTitleAnim[i].visible = inherit\r\n      enTitleLayer[i].color = #888888\r\n      buttonList[i].visible = inherit\r\n    :?i > highLevel\r\n      enTitleAnim[i].visible = false\r\n      buttonList[i].visible = false\r\n  ?highLevel = 0\r\n    startNote.visible = inherit\r\n  :\r\n    startNote.visible = false\r\n\r\nfunc sudoEnchantAnimInit(window,enAnim_,enLayer_,x_,y_,n_)\r\n  var enchantAnim_ = ui.AddAnim(sudoAnimVar.enchantAnimText)\r\n  var edgeLayer_ = enchantAnim_.AddLayer(sudoAnimVar.enchantText)\r\n\r\n  edgeLayer_.pivotX = 1\r\n  edgeLayer_.pivotY = 1\r\n  window.Add(enchantAnim_)\r\n  enchantAnim_.duration = 138\r\n  enchantAnim_.loop = true\r\n\r\n  enchantAnim_.dock = center_center\r\n  enchantAnim_.w = 3\r\n  enchantAnim_.h = 1\r\n  enchantAnim_.x = x_\r\n  enchantAnim_.y = y_\r\n\r\n  edgeLayer_.color = #888888\r\n  enchantAnim_.color = colorEnAnim[n_]\r\n  enchantAnim_.Play()\r\n\r\n  enAnim_.Add(enchantAnim_)\r\n  enLayer_.Add(edgeLayer_)\r\n\r\nfunc buttonInit(x_,y_,i_)\r\n  var button_ = ui.AddButton()\r\n  button_.SetDown(startButtonPressed)\r\n  button_.style = 0\r\n  button_.x = x_\r\n  button_.y = y_\r\n  button_.w = 5\r\n  button_.h = 3\r\n  button_.text = string.Format(i_+\"\")\r\n\r\n  mainWindow.Add(button_)\r\n  buttonList.Add(button_)\r\n\r\nfunc startButtonPressed(btn)\r\n  nowLevel = int.Parse(btn.text)\r\n  sudoCore.matInit(nowLevel)\r\n  ballFlashStart(colorEnAnim[nowLevel],0,0)\r\n\r\nfunc resetButtonDown()\r\n  mainWindow.visible = false\r\n\r\n  resetWindow = ui.AddPanel()\r\n  resetWindow.w = screen.w\r\n  resetWindow.h = screen.h\r\n  mainWindow.style = ui.AddStyle(\"╔═╗║ ║╚═╝\")\r\n  \r\n  var resetNote = ui.AddText()\r\n  resetWindow.Add(resetNote)\r\n  resetNote.color = #FFFFFF\r\n  resetNote.align = center\r\n  resetNote.w = resetWindow.w - 24\r\n  resetNote.h = 2\r\n  resetNote.y = -5\r\n  ?te.language = \"ZH-CN\"\r\n    resetNote.text = resetNoteText[0]\r\n  :?te.language = \"ZH-TW\"\r\n    resetNote.text = resetNoteText[1]\r\n  :\r\n    resetNote.text = resetNoteText[2]\r\n\r\n  var resetTrueButton = ui.AddButton()\r\n  resetWindow.Add(resetTrueButton)\r\n  resetTrueButton.SetUp(resetTrueButtonUp)\r\n  resetTrueButton.style = 4\r\n  resetTrueButton.x = -5\r\n  resetTrueButton.h = 3\r\n  resetTrueButton.w = 7\r\n  resetTrueButton.tcolor = #red\r\n  resetTrueButton.text = \"Yes\"\r\n\r\n  var resetFalseButton = ui.AddButton()\r\n  resetWindow.Add(resetFalseButton)\r\n  resetFalseButton.SetUp(resetFalseButtonUp)\r\n  resetFalseButton.style = 4\r\n  resetFalseButton.x = 5\r\n  resetFalseButton.h = 3\r\n  resetFalseButton.w = 7\r\n  resetFalseButton.tcolor = #green\r\n  resetFalseButton.text = \"No\"\r\n\r\nfunc resetTrueButtonUp()\r\n  storage.Set(\"SudokuEnchantHighLevel\", 0)\r\n  loc.Leave()\r\n\r\nfunc resetFalseButtonUp()\r\n  resetWindow.Clear()\r\n  resetWindow.Recycle()\r\n  mainWindow.visible = inherit\r\n\r\n\r\nfunc dt(time_)\r\n  return (totaltime - time_)\r\n\r\nfunc storageLevel(level_)\r\n  ?storage.Has(\"SudokuEnchantHighLevel\")\r\n    var highLevel_ = storage.Get(\"SudokuEnchantHighLevel\")\r\n    ?highLevel_ >= level_\r\n      return highLevel_\r\n    :\r\n      storage.Set(\"SudokuEnchantHighLevel\",level_)\r\n      return level_\r\n  :\r\n    storage.Set(\"SudokuEnchantHighLevel\",0)\r\n    return 0\r\n\r\nfunc banner(No_)\r\n  ?te.language = \"ZH-CN\"\r\n    ui.ShowBanner(banners[No_][0][0],banners[No_][0][1])\r\n  :?te.language = \"ZH-TW\"\r\n    ui.ShowBanner(banners[No_][1][0],banners[No_][1][1])\r\n  :\r\n    ui.ShowBanner(banners[No_][2][0],banners[No_][2][1])\r\n\r\nvar musicList = [rocky_plateau_0,rocky_plateau_1,rocky_plateau_2,rocky_plateau_3,rocky_plateau_4]\r\nvar mainWindow\r\nvar highLevel = 0\r\nvar nowLevel = -1\r\nvar title\r\nvar startNote\r\nvar resetButton\r\nvar resetWindow\r\n\r\nvar boxAnim\r\nvar jamAnim\r\nvar jamButton\r\nvar jamTime = -1\r\n\r\nvar buttonList = []\r\n\r\nvar enchantAnimPos = [[-1,-7],[9,-3],[9,3],[-1,6],[-11,3],[-11,-3]]\r\nvar enTitleAnim = []\r\nvar enTitleLayer = []\r\nvar colorEnAnim = [#cyan,#yellow,#green,#blue,#red,#rainFF]\r\n\r\nvar ballFlashAnim\r\nvar ballFlashTime = -1\r\n\r\nvar sudoX = 0\r\nvar sudoY = 0\r\nvar sudoW = 34\r\nvar sudoH = 19\r\n\r\nvar banners = [\r\n  [\r\n    [\"宝庫\",\"奇特的六边锁\"],\r\n    [\"寶庫\",\"奇特的六边鎖\"],\r\n    [\"The Grand Treasury\",\"The Unique Hexagonal Lock\"]\r\n  ]\r\n]\r\n\r\nvar startNoteText = [\r\n\"\\\"附魔？好像雕刻在一个按键上，或许我能够试着按一下...\\\" \",\r\n\"\\\"附魔？好像雕刻在一個按鍵上，或許我能夠試著按一下...\\\" \",\r\n\"\\\"Enchantment? It seems carved on a button, perhaps I should try pressing it...\\\"\"\r\n]\r\n\r\nvar resetNoteText = [\r\n\"这个操作会[color=#red]重置游戏进度[/color]并离开，你确定吗？\\n如果想要[color=#green]保存游戏[/color]，正常离开关卡即可。\",\r\n\"這個操作會[color=#red]重置遊戲進度[/color]並離開，你確定嗎？\\n如果想要[color=#green]保存遊戲[/color]，正常離開關卡即可 。\",\r\n\"\\\"Enchantment? It seems carved on a button, perhaps I should try pressing it...\\\"\"\r\n]\r\n\r\n\r\nvar sudoCore = import Games/SudokuEnchant/SudokuCoreEn\r\nvar sudoAnimVar = import Games/SudokuEnchant/SudokuEnchantAnim\r\nvar sudoJamWindow = import Games/SudokuEnchant/SudokuJamWindow"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/SudokuEnchant/SudokuCoreEn.txt" - Parse error: Failed to parse completely. Remaining: "= []\r\nvar buttonX = 22\r\nvar buttonPos = [[0,3],[-7,-6],[0,-6],[7,-6],[-7,-1],[0,-1],[7,-1],[0,6]]\r\nvar buttonLast = -1\r\n\r\nvar noteButton\r\nvar noteTextPanel\r\n\r\nvar sudoNum = []\r\nvar enAnim = []\r\nvar enLayer = []\r\nvar enButtonAnim = []\r\nvar enButtonLayer = []\r\nvar colorReadOnly = #2E2E2E\r\nvar colorEdit = #FFFFFF\r\nvar colorEnAnim = [#cyan,#yellow,#green,#blue,#red,#rainFF]\r\nvar ifEvent = false\r\nvar highLightNum = -1\r\nvar selectBox\r\n\r\nvar vectory = 0\r\nvar vectoryTime = 0\r\n\r\nfunc core()\r\n  loopPrint()\r\n  loopEvent()\r\n\r\nfunc loopEvent()\r\n  ?key = primaryEnd\r\n    ifEvent = true\r\n    posX = (input.x - screen.w/2 + sudoW/2 - sudoX)\r\n    posY = (input.y - screen.h/2 + sudoH/2 - sudoY)\r\n    ?posX/6 >= 0 & posX/6 < 6 & posY/4 >= 0 & posY/4 < 6 & posX%6 ! 0 & posY%4 ! 0\r\n      clickX = posX/6\r\n      clickY = posY/4\r\n      ?ifReadOnly(sudoNum[clickX][clickY].color)\r\n        resetClick()\r\n    :?clickX_ >= 0 & clickY_ >= 0 \r\n      buttonClick()\r\n    :\r\n      resetClick()\r\n\r\n  //>`0,2,mouse:@input.x@,@input.y@\r\n  //>`0,3,pos:@posX@,@posY@ \r\n  //>`0,4,click:@clickX@,@clickY@\r\n\r\n\r\nfunc loopPrint()\r\n  ?ifEvent\r\n    ?clickX < 0 & clickY < 0\r\n      selectBox.x = -5\r\n      selectBox.y = -5\r\n    :\r\n      selectBox.x = clickX*6+3\r\n      selectBox.y = clickY*4+2\r\n  ?vectory = 0\r\n    vectoryTime = totaltime\r\n  :?vectory = -1\r\n    ?dt(vectoryTime) = 1\r\n      buttonList[buttonList.Count()-1].text = \"Error!\"\r\n      buttonList[buttonList.Count()-1].bcolor = #FF0000\r\n      buttonList[buttonList.Count()-1].tcolor = #FF0000\r\n    :?dt(vectoryTime) > 60\r\n      buttonList[buttonList.Count()-1].text = \"Verify\"\r\n      buttonList[buttonList.Count()-1].bcolor = #7F7F7F\r\n      buttonList[buttonList.Count()-1].tcolor = #FFFFFF\r\n      vectory = 0\r\n  :?vectory = 1\r\n    ?dt(vectoryTime) = 1\r\n      buttonList[buttonList.Count()-1].text = \"Success!\"\r\n      buttonList[buttonList.Count()-1].bcolor = #00FF00\r\n      buttonList[buttonList.Count()-1].tcolor = #00FF00\r\n    :?dt(vectoryTime) > 180\r\n      buttonList[buttonList.Count()-1].text = \"Verify\"\r\n      buttonList[buttonList.Count()-1].bcolor = #7F7F7F\r\n      buttonList[buttonList.Count()-1].tcolor = #FFFFFF\r\n      vectory = 0\r\n\r\n\r\nfunc initUI()\r\n  listClear()\r\n\r\n  mainWindow = ui.AddPanel()\r\n  mainWindow.visible = false\r\n  mainWindow.clip = true\r\n\r\n  mainWindow.x = 0\r\n  mainWindow.y = 0\r\n  mainWindow.anchor = center_center\r\n  mainWindow.dock = center_center\r\n\tmainWindow.w = screen.w\r\n\tmainWindow.h = screen.h\r\n  var customStyle = ui.AddStyle(\"╔═╗║ ║╚═╝\")\r\n  mainWindow.style = customStyle\r\n\r\n  sudoWindowInit()\r\n\r\n  buttonInit(buttonX + buttonPos[0][0],buttonPos[0][1],\"Remove\")\r\n  buttonList[0].w = 21\r\n  buttonList[0].h = 3\r\n  for i = 1..6\r\n    buttonInit(buttonX + buttonPos[i][0],buttonPos[i][1],i)\r\n    sudoEnchantAnimInit(mainWindow,enButtonAnim,enButtonLayer,buttonX + buttonPos[i][0],buttonPos[i][1])\r\n    enButtonLayer[i-1].color = colorReadOnly\r\n    enButtonAnim[i-1].color = colorEnAnim[i-1]\r\n    enButtonAnim[i-1].Play()\r\n    enButtonAnim[i-1].dock = center_center\r\n  buttonInit(buttonX + buttonPos[buttonPos.Count()-1][0],buttonPos[buttonPos.Count()-1][1],\"Verify\")\r\n  buttonList[buttonList.Count()-1].w = 21\r\n  buttonList[buttonList.Count()-1].h = 3\r\n  buttonList[buttonList.Count()-1].SetDown(verifyPressed)\r\n  \r\n  for i = 0..5\r\n    var sudoNum_ = []\r\n    var enAnim_ = []\r\n    var enLayer_ = []\r\n    for j = 0..5\r\n      posX = (i*6+3)\r\n      posY = (j*4+2)\r\n      sudoNumInit(sudoNum_,posX,posY)\r\n      sudoEnchantAnimInit(sudoWindow,enAnim_,enLayer_,posX,posY)\r\n    sudoNum.Add(sudoNum_)\r\n    enAnim.Add(enAnim_)\r\n    enLayer.Add(enLayer_)\r\n  \r\n  noteInit()\r\n\r\n\r\n\r\nfunc sudoWindowInit()\r\n\r\n  sudoWindow = ui.AddPanel()\r\n  mainWindow.Add(sudoWindow)\r\n  sudoWindow.clip = true\r\n  sudoWindow.x = sudoX\r\n  sudoWindow.y = sudoY\r\n  sudoWindow.anchor = center_center\r\n  sudoWindow.dock = center_center\r\n\tsudoWindow.w = sudoW\r\n\tsudoWindow.h = sudoH\r\n\r\n  var sudoWindowText_ = ui.AddText()\r\n  sudoWindow.Add(sudoWindowText_)\r\n  sudoWindowText_.x = 0\r\n  sudoWindowText_.y = 0\r\n  sudoWindowText_.ay = center\r\n  sudoWindowText_.dy = center\r\n  sudoWindowText_.w = sudoW\r\n  sudoWindowText_.h = sudoH\r\n  sudoWindowText_.text = string.Format(sudoWindowText)\r\n  sudoWindowText_.color = #999999\r\n\r\n  selectBox = ui.AddAnim(selectBoxText)\r\n  sudoWindow.Add(selectBox)\r\n  selectBox.duration = 30\r\n  selectBox.loop = true\r\n  selectBox.color = #FF0000\r\n  selectBox.Play()\r\n  selectBox.dock = top_left\r\n  selectBox.w = 5\r\n  selectBox.h = 3\r\n  selectBox.x = -5\r\n  selectBox.y = -5\r\n  \r\n\r\nfunc sudoNumInit(sudoNum_,x_,y_)\r\n  var sudoNumText_ = ui.AddText()\r\n  sudoNumText_.x = x_\r\n  sudoNumText_.y = y_\r\n\tsudoNumText_.w = 3\r\n\tsudoNumText_.h = 1\r\n\tsudoNumText_.align = center\r\n  sudoNumText_.dock = top_left\r\n\r\n\tsudoWindow.Add(sudoNumText_)\r\n  sudoNum_.Add(sudoNumText_)\r\n\r\nfunc sudoEnchantAnimInit(window,enAnim_,enLayer_,x_,y_)\r\n  var enchantAnim_ = ui.AddAnim(sudoAnimVar.enchantAnimText)\r\n  var edgeLayer_ = enchantAnim_.AddLayer(sudoAnimVar.enchantText)\r\n\r\n  edgeLayer_.pivotX = 1\r\n  edgeLayer_.pivotY = 1\r\n  window.Add(enchantAnim_)\r\n  enchantAnim_.duration = 138\r\n  enchantAnim_.loop = true\r\n\r\n  enchantAnim_.dock = top_left\r\n  enchantAnim_.w = 3\r\n  enchantAnim_.h = 1\r\n  enchantAnim_.x = x_\r\n  enchantAnim_.y = y_\r\n\r\n  enAnim_.Add(enchantAnim_)\r\n  enLayer_.Add(edgeLayer_)     \r\n\r\nfunc buttonInit(x_,y_,i_)\r\n  var button_ = ui.AddButton()\r\n  button_.SetDown(numPressed)\r\n  button_.style = 4\r\n  button_.x = x_\r\n  button_.y = y_\r\n  button_.w = 7\r\n  button_.h = 5\r\n  button_.text = string.Format(i_+\"\")\r\n\r\n  mainWindow.Add(button_)\r\n  buttonList.Add(button_)\r\n\r\nfunc numPressed(btn)\r\n  ?clickX >= 0 & clickX < 6 & clickY >= 0 & clickY < 6\r\n    ?string.Equals(btn.text,\"Remove\")\r\n      sudoNum[clickX][clickY].text = string.Format(\"\")\r\n      enAnim[clickX][clickY].color = colorReadOnly\r\n      enAnim[clickX][clickY].visible = false\r\n    :\r\n      sudoNum[clickX][clickY].text = string.Format(btn.text)\r\n      enAnim[clickX][clickY].color = colorEnAnim[int.Parse(btn.text)-1]\r\n      enAnim[clickX][clickY].visible = inherit\r\n      enAnim[clickX][clickY].Play()\r\n  clickX_ = clickX\r\n  clickY_ = clickY\r\n\r\nfunc verifyPressed(btn)\r\n  vectory = 0\r\n  var sudoArray = []\r\n  var sudoArray_ = []\r\n  for i = 0..5\r\n    for j = 0..5\r\n      ?string.Equals(sudoNum[i][j].text,\"\")\r\n        sudoMat[j][i] = 0\r\n        vectory = -1\r\n        i = 9\r\n        j = 9\r\n      :\r\n        sudoMat[j][i] = int.Parse(sudoNum[i][j].text)\r\n  ?vectory >= 0\r\n    for i = 0..5\r\n      sudoArray.Clear()\r\n      sudoArray_.Clear()\r\n      for j = 0..5\r\n        sudoArray.Add(sudoMat[j][i])\r\n        sudoArray_.Add(sudoMat[i][j])\r\n      sudoArray.Sort()\r\n      sudoArray_.Sort()\r\n      for v = 0..5\r\n        ?sudoArray[v] ! v+1 | sudoArray_[v] ! v+1\r\n          vectory = -1\r\n          i = 9\r\n          v = 9\r\n\r\n  ?vectory >= 0\r\n    for i = 0..2\r\n      for j = 0..1\r\n        sudoArray.Clear()\r\n        for i_ = 0..1\r\n          for j_ = 0..2\r\n            sudoArray.Add(sudoMat[2*i+i_][3*j+j_])\r\n        sudoArray.Sort()\r\n        for v = 0..5\r\n          ?sudoArray[v] ! v+1\r\n            vectory = false\r\n            i = 3\r\n            j = 3\r\n            v = 9\r\n\r\n  ?vectory >= 0\r\n    vectory = 1\r\n  :\r\n    vectory = -1\r\n\r\nfunc matInit(level_)\r\n  var sudoStore = import Games/SudokuEnchant/SudokuStore\r\n  var No_ =  rng % (sudoStore.sudoMat[level_].Count())\r\n  var array_ = sudoStore.sudoMat[level_][No_]\r\n  array2Mat(array_,sudoMat0)\r\n  sudoMat = sudoMat0\r\n\r\n  var n_ = 0\r\n  for i = 0..5\r\n    for j = 0..5\r\n      n_ = sudoMat0[j][i]\r\n      \r\n      ?n_ > 0 & n_ <=6\r\n        sudoNum[i][j].text = string.Format(n_+\"\")\r\n        sudoNum[i][j].color = colorReadOnly\r\n        enLayer[i][j].color = colorReadOnly\r\n        enAnim[i][j].color = colorEnAnim[n_-1]\r\n        enAnim[i][j].visible = inherit\r\n        enAnim[i][j].Play()\r\n      :\r\n        sudoNum[i][j].text = string.Format(\"\")\r\n        sudoNum[i][j].color = colorEdit\r\n        enLayer[i][j].color = colorEdit\r\n        enAnim[i][j].color = colorReadOnly\r\n        enAnim[i][j].visible = false\r\n\r\nfunc array2Mat(array_,mat_)\r\n  var sudoLength = string.Size(array_)\r\n  ?sudoLength = 6*6\r\n    mat_.Clear()\r\n    var temp = \"\"\r\n    for i = 0 .. 5\r\n      temp = string.Sub(array_, i*6, 6)\r\n      var row_ = [] \r\n      for j = 0 .. 5  \r\n        row_.Add(int.Parse(string.Sub(temp, j, 1)))\r\n      mat_.Add(row_)\r\n\r\nfunc noteInit()\r\n  noteButton = ui.AddButton()\r\n  mainWindow.Add(noteButton)\r\n  noteButton.SetDown(noteDown)\r\n  noteButton.SetUp(noteUp)\r\n  noteButton.style = 2\r\n  noteButton.dock = top_right\r\n  noteButton.anchor = top_right\r\n  noteButton.x = -1\r\n  noteButton.y = 1\r\n  noteButton.w = 5\r\n  noteButton.h = 3\r\n  noteButton.text = string.Format(\"?\")\r\n\r\n  noteTextPanel = ui.AddPanel()\r\n  mainWindow.Add(noteButton)\r\n  noteTextPanel.visible = false\r\n  var customStyle = ui.AddStyle(\"O_O▒ ▒O‾O\")\r\n  noteTextPanel.style = customStyle\r\n  noteTextPanel.dock = top_right\r\n  noteTextPanel.anchor = top_right\r\n  noteTextPanel.x = noteButton.x - noteButton.w\r\n  noteTextPanel.w = 28\r\n  noteTextPanel.h = 5\r\n\r\n  var noteText = ui.AddText()\r\n  noteTextPanel.Add(noteText)\r\n  ?te.language = \"ZH-CN\"\r\n    noteText.text = methodNote[0]\r\n  :?te.language = \"ZH-TW\"\r\n    noteText.text = methodNote[1]\r\n  :\r\n    noteText.text = methodNote[2]\r\n    noteTextPanel.w = 45\r\n    noteTextPanel.h = 7\r\n  noteText.w = noteTextPanel.w - 4\r\n  noteText.h = noteTextPanel.h - 2\r\n  \r\n\r\nfunc noteDown(btn)\r\n  noteTextPanel.visible = inherit\r\n  \r\nfunc noteUp(btn)\r\n  noteTextPanel.visible = false\r\n\r\n\r\nfunc listClear()\r\n  buttonList.Clear()\r\n  sudoNum.Clear()\r\n  enAnim.Clear()\r\n  enLayer.Clear()\r\n  enButtonAnim.Clear()\r\n  enButtonLayer.Clear()\r\n  \r\nfunc resetClick()\r\n  clickX = -1\r\n  clickY = -1\r\n  clickX_ = -1\r\n  clickY_ = -1\r\n\r\nfunc buttonClick()\r\n  clickX = clickX_\r\n  clickY = clickY_\r\n  clickX_ = -1\r\n  clickY_ = -1\r\n\r\nfunc ifReadOnly(color_)\r\n  for i = 0..1\r\n    ?color_ = colorReadOnly\r\n      return true\r\n  return false\r\n\r\nfunc dt(time_)\r\n  return (totaltime - time_)\r\n\r\n\r\nvar musicList = [rocky_plateau_0,rocky_plateau_1,rocky_plateau_2,rocky_plateau_3,rocky_plateau_4]\r\nvar sudoWindowText = ascii\r\n╔═════╤═════╤═════╦═════╤═════╤═════╗\r\n║     |     |     ║     |     |     ║\r\n║     |     |     ║     |     |     ║\r\n║     |     |     ║     |     |     ║\r\n╟─────┼─────┼─────╫─────┼─────┼─────╢\r\n║     |     |     ║     |     |     ║\r\n║     |     |     ║     |     |     ║\r\n║     |     |     ║     |     |     ║\r\n╠═════╪═════╪═════╬═════╪═════╪═════╣\r\n║     |     |     ║     |     |     ║\r\n║     |     |     ║     |     |     ║\r\n║     |     |     ║     |     |     ║\r\n╟─────┼─────┼─────╫─────┼─────┼─────╢\r\n║     |     |     ║     |     |     ║\r\n║     |     |     ║     |     |     ║\r\n║     |     |     ║     |     |     ║\r\n╠═════╪═════╪═════╬═════╪═════╪═════╣\r\n║     |     |     ║     |     |     ║\r\n║     |     |     ║     |     |     ║\r\n║     |     |     ║     |     |     ║\r\n╟─────┼─────┼─────╫─────┼─────┼─────╢\r\n║     |     |     ║     |     |     ║\r\n║     |     |     ║     |     |     ║\r\n║     |     |     ║     |     |     ║\r\n╚═════╧═════╧═════╩═════╧═════╧═════╝\r\nasciiend\r\n\r\nvar selectBoxText = ascii\r\n┌###┐\r\n#####\r\n└###┘\r\n%%\r\n#####\r\n#####\r\n#####\r\nasciiend\r\n\r\nvar methodNote = [\r\n\"这看上去像是一个特殊的……数独？填满面板并保持每个行、列和大格中附魔的独特性。\\n——研究员JianShang36\",\r\n\"這看上去像是一個特殊的……數獨？填滿面板並保持每個行、列和大格中附魔的獨特性。\\n——研究員JianShang36\",\r\n\"This looks like a special... Sudoku? Fill the panel and maintain the uniqueness of the enchantment in each row, column, and grid. \\n- Researcher JianShang36\"\r\n]\r\n\r\nvar sudoMat0 = [\r\n^[3,6,4,1,5,2],\r\n^[0,5,2,3,4,6],\r\n^[2,1,5,4,6,3],\r\n^[4,3,6,5,2,1],\r\n^[5,2,1,6,3,4],\r\n^[6,4,3,2,1,5],\r\n]\r\n\r\nvar sudoMat = sudoMat0\r\nvar sudoAnimVar = import Games/SudokuEnchant/SudokuEnchantAnim\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/StoneasaurGame.txt" - Parse error: Failed to parse completely. Remaining: "= []\r\n\r\nvar char\r\nvar moveAnim = ascii\r\n#O\r\n/|\\\r\n/#\\\r\n%%\r\n#O\r\n/|\\\r\n#>\\\r\n%%\r\n#O\r\n/|\\\r\n#|\\\r\n%%\r\n#O\r\n/|\\\r\n#|>\r\nasciiend\r\n\r\nvar jumpDuration = 30\r\nvar jumpDurationTimer = 0\r\n\r\nvar delta\r\n\r\nvar speed = 1\r\nvar gameTime = 0\r\nvar gameTimer = 0\r\nvar gameDelay = 2\r\n\r\nvar mainWindow\r\n\r\nvar backgroundList = []\r\nvar backgroundArt\r\n\r\nvar groundList = []\r\nvar groundHeight\r\n\r\nvar obstacleList = []\r\nvar baseDistance = 100\r\n// [[width, height, art]]\r\nvar obstacleArtList = [\r\n[5, 3, ascii\r\n#___\r\n├─•─┤\r\n└───┘\r\n%%\r\n#___\r\n├─o─┤\r\n└───┘\r\n%%\r\n┌-─-┐\r\n╞╤8╤╡\r\n└┴─┴┘\r\n%%\r\n#___\r\n┼┬Ω┬┼\r\n└┴─┴┘\r\nasciiend],\r\n[7, 5, ascii\r\n#│¯¯¯|\\\r\n#│(╬)|│\r\n#│ ║ |│\r\n#│   |│\r\n´¯¯¯¯'`\r\nasciiend]\r\n]\r\n\r\nvar scoreWindow\r\nvar scoreText\r\nvar scoreValueText\r\nvar highscoreText\r\nvar highscoreValueText\r\n\r\nvar fadeWindow\r\nvar fadeTimer = 0\r\nvar palette = [\"#FFFFFF\",\"#EEEEEE\",\"#DDDDDD\",\"#CCCCCC\",\"#BBBBBB\",\"#AAAAAA\",\"#999999\",\"#888888\",\"#777777\",\"#666666\",\"#555555\",\"#444444\",\"#333333\",\"#222222\",\"#111111\",\"#000000\"]\r\n\r\nvar messageWindow\r\nvar maxMessageWidth\r\nvar maxMessageHeight\r\n\r\nvar messageText\r\nvar messageIndex = 0\r\n\r\nvar jamText\r\nvar jamNode\r\n\r\n/*\r\n0: initialize\r\n1: title\r\n2: playing\r\n3: gameover\r\n*/\r\nvar state = 0\r\n\r\nvar score = 0\r\nvar highscore = 0\r\n\r\n\r\n\r\n//////////     MAIN     //////////\r\n\r\nfunc main()\r\n\t?loc ! fall\r\n\t\treturn\r\n\r\n\tcheckInput() // 預防輸入滯留\r\n\r\n\t?state = 2 // playing\r\n\t\tscore = score + 1\r\n\t\t?score > highscore\r\n\t\t\thighscore = score\r\n\t\tupdateScoreText()\r\n\t\tupdateSpeed()\r\n\r\n\t\t//gameTimer = (gameTimer + 1) % gameDelay\r\n\t\t//?!gameTimer\r\n\t\tgameTime++\r\n\r\n\t\tupdateGround()\r\n\t\tupdateObstacle()\r\n\t\t?delta.x > -5\r\n\t\t\tdelta.x = delta.x - speed\r\n\r\n\t\tupdateCharJump()\r\n\r\n\t:?state = 1 // title\r\n\r\n\t\t?updateFade()\r\n\t\t\treturn\r\n\t\t?checkKey()\r\n\t\t\t?!getWatch(3)\r\n\t\t\t\tstate = -3\r\n\t\t\t\treturn\r\n\t\t?gameTime // restart delay\r\n\t\t\tgameTime--\r\n\t\t\treturn\r\n\r\n\t\tupdateCharJump()\r\n\t\t?char.playing\r\n\t\t\tstate = 2\r\n\t\t\treturn\r\n\r\n\t\tshowHint()\r\n\r\n\t:?state = 3 // gameover\r\n\t\t>`@screen.w/2-5@,@screen.h/2-2@,GAME  OVER\r\n\t\t?gameTime // restart delay\r\n\t\t\tgameTime--\r\n\t\t\treturn\r\n\t\t?checkInput()\r\n\t\t\tgoto()\r\n\t\t\tgameTime = 15\r\n\r\n\t\tshowHint()\r\n\r\n\t:?state = 0 // initialize\r\n\t\tinit()\r\n\r\n\t\t?storage.Get(\"watch\", 0)\r\n\t\t\tfadeIn()\r\n\t\t\treset()\r\n\t\t:\r\n\t\t\tstate = -1\r\n\r\n\t:?state < 0\r\n\t\tstate = -watch(-state)\r\n\t\t?state >= 0\r\n\t\t\tgameTime = 15\r\n\r\n\t//showdata()\r\n\r\n\r\n\r\n//////////     CREATE SCREEN     //////////\r\n\r\nfunc createUI()\r\n\tmainWindow = ui.AddPanel()\r\n\tmainWindow.w = screen.w\r\n\tmainWindow.h = screen.h\r\n\tmainWindow.clip = true\r\n\tmainWindow.style = 0\r\n\r\n\tbackgroundList.Clear()\r\n\tcreateBackground()\r\n\tcreateBackground()\r\n\tcreateBackgroundArt()\r\n\r\n\tgroundList.Clear()\r\n\tcreateGround()\r\n\tcreateGround()\r\n\r\n\tcreateCharcter()\r\n\tcreateDelta()\r\n\r\n\tobstacleList.Clear()\r\n\tfor i = 0..obstacleArtList.Count() - 1\r\n\t\tcreateObstacle(obstacleArtList[i])\r\n\tresetObstaclePos()\r\n\r\n\tcreateScoreWindow()\r\n\r\n\tfadeWindow = ui.AddCanvas()\r\n\tfadeWindow.w = mainWindow.w\r\n\tfadeWindow.h = mainWindow.h\r\n\tfadeWindow.blend = multiply\r\n\tfadeWindow.SetFG(\"#000000\")\r\n\tmainWindow.Add(fadeWindow)\r\n\r\n\tcreateMessageWindow()\r\n\r\nfunc createBackground()\r\n\tvar background = ui.AddAnim(ascii\r\n                        .                                                                 .     .    \r\n.        .              .           .                           . .                                  \r\n                                 .                                                           .     . \r\n           .                      .                      .                                           \r\n                                                                          .                          \r\n                                                      .             .  .         .                   \r\n                  .                               .    .                                 .           \r\n     .                    .                                      .                                   \r\n.           .      .                                      .        .                                 \r\n                                    .    .                 .                            .            \r\n                                         .          .         .                                .     \r\n          .                                                                                       .  \r\n                                                                                                     \r\n                                                                              ..                     \r\n                                                                                                     \r\n                  .                                          .                                       \r\n      .                              .                                                               \r\n                  .                           .        ..                      .  .                  \r\n          .  .                              .                       .  .  .         .            .   \r\n                     .  .                        .           .                           ..          \r\n             .                .                                .                                     \r\n           .      .                                    .     ..       . . .            .       .     \r\n               .                                                  .    .                         .   \r\n      .                                                    .             .                     .     \r\n          .                            .       .                         .                           \r\n                 .       .                                                                  .        \r\n  .      .   .  .                                                 .            .                     \r\n   ..     .                            ..                            .     .   .         .    .      \r\n                      .    . .                                                      .                \r\n                               .      .     .                                              .         \r\nasciiend)\r\n\tbackground.anchor = center_left\r\n\tbackground.dock = center_left\r\n\tmainWindow.Add(background)\r\n\tbackgroundList.Add(background)\r\n\r\nfunc createBackgroundArt()\r\n\tbackgroundArt = ui.AddAnim(ascii\r\n\r\n%%\r\nwhite tree\r\n%%\r\nThundering Fortress\r\n%%\r\nGrand Treasury\r\nasciiend)\r\n\tbackgroundArt.x = screen.w\r\n\tbackgroundArt.anchor = center_left\r\n\tbackgroundArt.dock = center_left\r\n\tbackgroundArt.frame = 0\r\n\tmainWindow.Add(backgroundArt)\r\n\r\nfunc createGround()\r\n\tvar ground = ui.AddAnim(ascii\r\n-^-------^-^^---^---^-^------^--------^----------------^^---------------^--^----^--^----^-----^-----^---\r\n ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐  \r\n │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │  \r\n┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   \r\n│   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   \r\n   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌\r\n   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │\r\n  ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐   ┌   ┐ \r\n  │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │ \r\nasciiend)\r\n\tground.anchor = bottom_left\r\n\tground.dock = bottom_left\r\n\tground.color = \"#808080\"\r\n\tmainWindow.Add(ground)\r\n\tgroundList.Add(ground)\r\n\r\n\tgroundHeight = 8\r\n\r\nfunc createCharcter()\r\n\tchar = ui.AddAnim(moveAnim)\r\n\tchar.x = screen.w / 5\r\n\tchar.y = -groundHeight\r\n\tchar.anchor = bottom_left\r\n\tchar.dock = bottom_left\r\n\tchar.duration = 20\r\n\tchar.loop = true\r\n\tchar.Stop()\r\n\tmainWindow.Add(char)\r\n\r\nfunc createDelta()\r\n\tdelta = ui.AddAnim(ascii\r\n#\r\n#\r\n╒─,─╕\r\n└───┘\r\n%%\r\n#\r\n,───,\r\n╞─,─╡\r\n└───┘\r\n%%\r\n#___\r\n│```│\r\n╞─,─╡\r\n└───┘\r\n%%\r\n#___\r\n╞─∆─╡\r\n╞─,─╡\r\n└───┘\r\n%%\r\n#\r\n#___\r\n╞─∆─╡\r\n└───┘\r\nasciiend)\r\n\tdelta.x = char.x - 8\r\n\tdelta.y = -groundHeight\r\n\tdelta.anchor = bottom_left\r\n\tdelta.dock = bottom_left\r\n\tdelta.color = \"#rainbow\"\r\n\t?storage.Get(\"watch\", 0) < 8\r\n\t\tdelta.visible = false\r\n\tmainWindow.Add(delta)\r\n\r\nfunc createObstacle(art)\r\n\tvar width = art[0]\r\n\tvar height = art[1]\r\n\tvar anim = art[2]\r\n\tvar obstacle = ui.AddAnim(anim)\r\n\tobstacle.w = width\r\n\tobstacle.h = height\r\n\tobstacle.y = -groundHeight\r\n\tobstacle.anchor = bottom_left\r\n\tobstacle.dock = bottom_left\r\n\tmainWindow.Add(obstacle)\r\n\tobstacleList.Add(obstacle)\r\n\r\nfunc createScoreWindow()\r\n\tvar text\r\n\r\n\tscoreWindow = ui.AddPanel()\r\n\tscoreWindow.x = -3\r\n\tscoreWindow.y = 1\r\n\tscoreWindow.w = 15\r\n\tscoreWindow.h = 2\r\n\tscoreWindow.anchor = top_right\r\n\tscoreWindow.dock = top_right\r\n\tscoreWindow.style = 0\r\n\tmainWindow.Add(scoreWindow)\r\n\r\n\ttext = messageList[0][0] + \": \"\r\n\tscoreText = ui.AddText(text)\r\n\tscoreText.x = 1\r\n\tscoreText.w = string.Size(text)\r\n\tscoreText.h = 1\r\n\tscoreText.anchor = top_left\r\n\tscoreText.dock = top_left\r\n\tscoreWindow.Add(scoreText)\r\n\r\n\ttext = string.Format(\"{0}\", score)\r\n\tscoreValueText = ui.AddText(text)\r\n\tscoreValueText.w = string.Size(text)\r\n\tscoreValueText.h = 1\r\n\tscoreValueText.anchor = top_right\r\n\tscoreValueText.dock = top_right\r\n\tscoreWindow.Add(scoreValueText)\r\n\r\n\ttext = messageList[0][1] + \": \"\r\n\thighscoreText = ui.AddText(text)\r\n\thighscoreText.w = string.Size(text)\r\n\thighscoreText.h = 1\r\n\thighscoreText.anchor = bottom_left\r\n\thighscoreText.dock = bottom_left\r\n\tscoreWindow.Add(highscoreText)\r\n\r\n\ttext = string.Format(\"{0}\", highscore)\r\n\thighscoreValueText = ui.AddText(text)\r\n\thighscoreValueText.w = string.Size(text)\r\n\thighscoreValueText.h = 1\r\n\thighscoreValueText.anchor = bottom_right\r\n\thighscoreValueText.dock = bottom_right\r\n\tscoreWindow.Add(highscoreValueText)\r\n\r\nfunc createMessageWindow()\r\n\tmaxMessageWidth = mainWindow.w * 2 / 3\r\n\tmaxMessageHeight = mainWindow.h * 2 / 3\r\n\r\n\tmessageWindow = ui.AddPanel()\r\n\tmessageWindow.w = 0\r\n\tmessageWindow.h = 0\r\n\tmessageWindow.clip = true\r\n\tmessageWindow.style = 2\r\n\tmessageWindow.visible = false\r\n\tmainWindow.Add(messageWindow)\r\n\r\n\tmessageText = ui.AddText(\"\")\r\n\tmessageText.x = 2\r\n\tmessageText.y = 1\r\n\tmessageText.w = maxMessageWidth - 4\r\n\tmessageText.h = maxMessageHeight - 2\r\n\tmessageText.anchor = top_left\r\n\tmessageText.dock = top_left\r\n\tmessageWindow.Add(messageText)\r\n\r\nfunc createJam()\r\n\t?!jamText\r\n\t\tjamText = ui.AddText()\r\n\t\tjamText.text = greenJamText\r\n\t\tjamText.y = 2\r\n\t\tjamText.w = 21\r\n\t\tjamText.h = 9\r\n\t\tjamText.align = center\r\n\t\tjamText.anchor = top_center\r\n\t\tjamText.dock = top_center\r\n\t\tjamText.color = \"#00b300\"\r\n\t\tjamText.visible = false\r\n\t\tmessageWindow.Add(jamText)\r\n\r\n\t?!jamNode\r\n\t\tjamNode = ui.AddText()\r\n\t\tjamNode.text = messageList[0][3]\r\n\t\tjamNode.y = -1\r\n\t\tjamNode.w = maxMessageWidth - 4\r\n\t\tjamNode.h = 3\r\n\t\tjamNode.align = center\r\n\t\tjamNode.anchor = bottom_center\r\n\t\tjamNode.dock = bottom_center\r\n\t\tjamNode.visible = false\r\n\t\tmessageWindow.Add(jamNode)\r\n\r\n\t?!jamShinyList.Count()\r\n\t\t//jamShinyList.Clear()\r\n\t\tfor i = 0..1\r\n\t\t\tcreateJamShiny()\r\n\r\nfunc createJamShiny()\r\n\tvar anim = ui.AddAnim(jamShiny)\r\n\tanim.w = 5\r\n\tanim.h = 6\r\n\tanim.duration = 30 - rng % 5\r\n\tanim.color = \"#00E600\"\r\n\tanim.loop = false\r\n\tmainWindow.Add(anim)\r\n\tjamShinyList.Add(anim)\r\n\r\n\r\n\r\n//////////////////////////////\r\n\r\nfunc fadeIn()\r\n\tfadeTimer = 15\r\n\tupdateFade()\r\n\r\nfunc fadeOut()\r\n\tfadeTimer = -15\r\n\tupdateFade()\r\n\r\nfunc updateFade()\r\n\t?fadeTimer\r\n\t\tvar d = 3\r\n\t\t?fadeTimer > 0\r\n\t\t\tfadeWindow.SetFG(getPaletteColor(fadeTimer))\r\n\t\t\t?!(totaltime % d)\r\n\t\t\t\tfadeTimer--\r\n\t\t:?fadeTimer < 0\r\n\t\t\tfadeWindow.SetFG(getPaletteColor(fadeTimer + palette.Count()))\r\n\t\t\t?!(totaltime % d)\r\n\t\t\t\tfadeTimer++\r\n\treturn fadeTimer\r\n\r\nfunc getPaletteColor(n)\r\n\treturn palette[math.Clamp(n, 0, palette.Count() - 1)]\r\n\r\nfunc setupMessage(message)\r\n\tmessageWindow.visible = true\r\n\tmessageText.text = message\r\n\r\nfunc setupJam()\r\n\tjamText.visible = true\r\n\tjamNode.visible = true\r\n\tsetupMessage(\" \")\r\n\r\nfunc clearJam()\r\n\t?jamText\r\n\t\tjamText.visible = false\r\n\t?jamNode\r\n\t\tjamNode.visible = false\r\n\r\nfunc updateMessage()\r\n\tvar d = 10\r\n\t?messageWindow.visible\r\n\t\t?messageText.text\r\n\t\t\t?messageWindow.w = maxMessageWidth & messageWindow.h = maxMessageHeight\r\n\t\t\t\t?checkInput()\r\n\t\t\t\t\tmessageText.text = \"\"\r\n\t\t\t\t\tclearJam()\r\n\t\t\t:\r\n\t\t\t\t?messageWindow.w < maxMessageWidth\r\n\t\t\t\t\tmessageWindow.w = messageWindow.w + maxMessageWidth / d + 1\r\n\t\t\t\t?messageWindow.w > maxMessageWidth\r\n\t\t\t\t\tmessageWindow.w = maxMessageWidth\r\n\r\n\t\t\t\t?messageWindow.h < maxMessageHeight\r\n\t\t\t\t\tmessageWindow.h = messageWindow.h + maxMessageHeight / d + 1\r\n\t\t\t\t?messageWindow.h > maxMessageHeight\r\n\t\t\t\t\tmessageWindow.h = maxMessageHeight\r\n\r\n\t\t\t\tmessageText.w = messageWindow.w - 4\r\n\t\t\t\tmessageText.h = messageWindow.h - 2\r\n\t\t:\r\n\t\t\t?messageWindow.w = 0 & messageWindow.h = 0\r\n\t\t\t\tmessageWindow.visible = false\r\n\t\t\t:\r\n\t\t\t\t?messageWindow.w > 0\r\n\t\t\t\t\tmessageWindow.w = messageWindow.w - maxMessageWidth / d - 1\r\n\t\t\t\t?messageWindow.w < 0\r\n\t\t\t\t\tmessageWindow.w = 0\r\n\r\n\t\t\t\t?messageWindow.h > 0\r\n\t\t\t\t\tmessageWindow.h = messageWindow.h - maxMessageHeight / d - 1\r\n\t\t\t\t?messageWindow.h < 0\r\n\t\t\t\t\tmessageWindow.h = 0\r\n\t\t\t\t\r\n\treturn messageWindow.visible\r\n\r\nfunc updateMessageList(messageListIndex)\r\n\t?messageWindow.visible\r\n\t\tupdateMessage()\r\n\t:\r\n\t\tvar targetList = messageList[messageListIndex]\r\n\t\t?messageIndex < targetList.Count()\r\n\t\t\tsetupMessage(targetList[messageIndex])\r\n\t\t\tmessageIndex++\r\n\t\t:\r\n\t\t\tmessageIndex = 0\r\n\treturn messageIndex\r\n\r\nfunc updateJamShiny()\r\n\t?gameTime\r\n\t\tgameTime--\r\n\t:\r\n\t\tvar shiny\r\n\t\tfor i = 0..jamShinyList.Count() - 1\r\n\t\t\tshiny = jamShinyList[i]\r\n\t\t\t?!shiny.playing\r\n\t\t\t\tshiny.x = rng % maxMessageWidth - maxMessageWidth / 2\r\n\t\t\t\tshiny.y = rng % maxMessageHeight - maxMessageHeight / 2\r\n\t\t\t\tshiny.flipX = rng % 2 = 0\r\n\t\t\t\tshiny.Play()\r\n\t\t\t\tgameTime = 30 / jamShinyList.Count()\r\n\t\t\t\treturn i\r\n\treturn -1\r\n\r\n//////////     INIT     //////////\r\n\r\nfunc init()\r\n\thighscore = storage.Get(\"highscore\", 0)\r\n\tgetLanguage()\r\n\tcreateUI()\r\n\r\nfunc reset()\r\n\tstate = 1\r\n\tscore = 0\r\n\r\n\tgameTime = 0\r\n\tgameTimer = 0\r\n\tgameDelay = 2\r\n\tspeed = 1\r\n\r\n\tchar.x = screen.w / 5\r\n\tchar.pivotY = 0\r\n\tchar.frame = 0\r\n\tjumpDurationTimer = 0\r\n\r\n\tupdateGround()\r\n\tresetObstaclePos()\r\n\tdelta.x = char.x - 8\r\n\r\nfunc resetObstaclePos()\r\n\tfor i = 0..obstacleList.Count() - 1\r\n\t\tvar obstacle = obstacleList[i]\r\n\t\tobstacle.x = baseDistance + rng % baseDistance\r\n\t\tobstacle.frame = 0\r\n\r\n\r\n\r\n//////////     UPDATE     //////////\r\n\r\nfunc updateScoreText()\r\n\tvar text = string.Format(\"{0}\", score)\r\n\tscoreValueText.text = text\r\n\tscoreValueText.w = string.size(text)\r\n\t\r\n\r\nfunc updateSpeed()\r\n\t?score % 500 = 0\r\n\t\t?score = math.Pow(speed + 1, 2) * 500\r\n\t\t\tspeed = speed + 1\r\n\t\t\tchar.x--\r\n\t\t//:?score = 1000\r\n\t\t//\tgameDelay = 1\r\n\r\n//var acceleration = -0.0375\r\n//var velocity = 1.125\r\nfunc updateCharJump()\r\n\t?jumpDurationTimer\r\n\t\tjumpDurationTimer--\r\n\t\tchar.pivotY = math.CeilToInt(math.Sin((jumpDuration - jumpDurationTimer) * math.pi / jumpDuration) * 8)\r\n\t\t//var x = jumpDuration - jumpDurationTimer\r\n\t\t//char.pivotY = math.FloorToInt(velocity * x + acceleration * x * x)\r\n\t\t/*\r\n\t\t?jumpDurationTimer >= jumpDuration - 12\r\n\t\t\tchar.pivotY = (jumpDuration - jumpDurationTimer) / 2\r\n\t\t:?jumpDurationTimer <= 12\r\n\t\t\tchar.pivotY = jumpDurationTimer / 2\r\n\t\t*/\r\n\t\t?!jumpDurationTimer\r\n\t\t\tchar.Play()\r\n\t?checkInput() & !jumpDurationTimer\r\n\t\tchar.Stop()\r\n\t\tchar.frame = 0\r\n\t\tjumpDurationTimer = jumpDuration\r\n\r\nfunc checkInput()\r\n\treturn key = primary | key = bumpR\r\n\r\nfunc updateGround()\r\n\t/*\r\n\t?backgroundArt.x > -backgroundArt.w\r\n\t\tbackgroundArt.x = backgroundArt.x - gameTime / 9\r\n\t:?score % 1000 = 0\r\n\t\tbackgroundArt.frame = math.FloorToInt(score / 1000) % 4\r\n\t\tbackgroundArt.x = screen.w\r\n\t*/\r\n\tvar offset = gameTime * speed\r\n\tfor i = 0..1\r\n\t\tbackgroundList[i].x = screen.w * i - (offset / 81) % screen.w\r\n\t\tgroundList[i].x = screen.w * i - (offset) % screen.w\r\n\r\nfunc updateObstacle()\r\n\tfor i = 0..obstacleList.Count() - 1\r\n\t\tvar obstacle = obstacleList[i]\r\n\t\tobstacle.x = obstacle.x - speed\r\n\r\n\t\t?isCollision(char, obstacle)\r\n\t\t\tgameover()\r\n\r\n\t\t?obstacle.x < -obstacle.w\r\n\t\t\tobstacle.x = baseDistance + baseDistance / (2 - i) + rng % (baseDistance / (2 - i))\r\n\t\t\tobstacle.frame = rng % 4\r\n\r\nfunc isCollisionX(a, b)\r\n\treturn a.x + a.w > b.x & a.x < b.x + b.w\r\nfunc isCollisionY(a, b)\r\n\treturn a.y - a.pivotY < b.y - b.pivotY + b.h & a.y - a.pivotY + a.h > b.y - b.pivotY\r\nfunc isCollision(a, b)\r\n\t//return false\r\n\treturn isCollisionX(a, b) & isCollisionY(a, b)\r\n\r\n\r\n\r\n//////////     GAMEOVER     //////////\r\n\r\nfunc gameover()\r\n\tsaveHighscore()\r\n\tchar.Stop()\r\n\tgameTime = 15\r\n\tstate = 3\r\n\r\nfunc saveHighscore()\r\n\tstorage.Set(\"highscore\", highscore)\r\n\t\r\n\tvar text = string.Format(\"{0}\", highscore)\r\n\thighscoreValueText.text = text\r\n\thighscoreValueText.w = string.size(text)\r\n\r\nfunc goto()\r\n\t?speed >= 2\r\n\t\t?getWatch(3)\r\n\t\t\t?!getWatch(4)\r\n\t\t\t\tstate = -4\r\n\t\t\t\treturn\r\n\t\t:?getWatch(1)\r\n\t\t\t?!getWatch(2)\r\n\t\t\t\tstate = -2\r\n\t\t\t\treturn\r\n\treset()\r\n\r\n\r\n////////////////////////////////////////\r\n\r\nfunc checkKey()\r\n\t?key = leftEnd\r\n\t\t?gameTimer = 0\r\n\t\t\tgameTimer = 1\r\n\t\t\treturn false\r\n\t\t?gameTimer = 1\r\n\t\t\tgameTimer = 2\r\n\t\t\treturn false\r\n\t\tgameTimer = 0\r\n\t:?key = rightEnd\r\n\t\t?gameTimer = 2\r\n\t\t\tgameTimer = 3\r\n\t\t\treturn false\r\n\t\t?gameTimer = 3\r\n\t\t\tgameTimer = 0\r\n\t\t\treturn true\r\n\t\tgameTimer = 0\r\n\t:?key = upEnd\r\n\t\tgameTimer = 0\r\n\t:?key = downEnd\r\n\t\tgameTimer = 0\r\n\r\nfunc watch(i)\r\n\tvar s = i % 100\r\n\tvar t = math.FloorToInt(i / 100)\r\n\r\n\t?s = 1\r\n\t\tt = watch_badStart(t)\r\n\t:?s = 2\r\n\t\tt = watch_badEnd(t)\r\n\t:?s = 3\r\n\t\tt = watch_goodStart(t)\r\n\t:?s = 4\r\n\t\tt = watch_goodEnd(t)\r\n\r\n\t?t < 0\r\n\t\treturn -1\r\n\t:\r\n\t\treturn t * 100 + s\r\n\r\nfunc setCharState(anim, pivotX, pivotY, duration, loop)\r\n\tchar.Load(anim)\r\n\tchar.pivotX = pivotX\r\n\tchar.pivotY = pivotY\r\n\tchar.duration = duration\r\n\tchar.loop = loop\r\n\tchar.frame = 0\r\n\r\nfunc resetCharState()\r\n\tsetCharState(moveAnim, 0, 0, 20, true)\r\n\r\n\r\nvar badAnim = ascii\r\n\r\n\r\n>──>O\r\n%%\r\n\r\n\r\n#>─/O>\r\n%%\r\n\r\n###_\r\n#`┘<O\\\r\n%%\r\n\r\n##__\r\n#|\\/O\r\n%%\r\n\r\n##_\\O\r\n#|\\#\\\r\n%%\r\n###O\r\n##(\\\r\n#/#\\\r\n%%\r\n##O\r\n#/|\\\r\n#/#\\\r\nasciiend\r\nfunc watch_badStart(i)\r\n\t?i = 0\r\n\t\tfadeIn()\r\n\t\tsetCharState(badAnim, 1, 0, 30, false)\r\n\t\treturn i + 1\r\n\t:?i = 1\r\n\t\t?!updateFade()\r\n\t\t\treturn i + 1\r\n\t:?i = 2\r\n\t\tchar.Play()\r\n\t\treturn i + 1\r\n\t:?i = 3\r\n\t\t?!char.playing\r\n\t\t\treturn i + 1\r\n\t:?i = 4\r\n\t\t?!updateMessageList(1)\r\n\t\t\treturn i + 1\r\n\t:?i = 5\r\n\t\tresetCharState()\r\n\t\tsetWatch(1)\r\n\t\treturn -1\r\n\treturn i\r\n\r\nfunc watch_badEnd(i)\r\n\t?i = 0\r\n\t\tfadeOut()\r\n\t\tcreateJam()\r\n\t\treturn i + 1\r\n\t:?i = 1\r\n\t\t?!updateFade()\r\n\t\t\treturn i + 1\r\n\t:?i = 2\r\n\t\t?!updateMessageList(2)\r\n\t\t\treturn i + 1\r\n\t:?i = 3\r\n\t\tsetupJam()\r\n\t\treturn i + 1\r\n\t:?i = 4\r\n\t\t?!updateMessage()\r\n\t\t\treturn i + 1\r\n\t:?i = 5\r\n\t\tfadeIn()\r\n\t\treset()\r\n\t\tsetWatch(2)\r\n\t\treturn -1\r\n\treturn i\r\n\r\nvar goodAnim = ascii\r\n\r\n\r\n\r\n\r\n%%\r\n\r\n#\\O/\r\n\r\n\r\n%%\r\n\r\n#_O_\r\n\r\n\r\n%%\r\n###O\r\n#,((\r\n\r\n\r\n%%\r\n###O\r\n##'))`\r\n\r\n\r\n%%\r\n###O\r\n###))V\r\n\r\n\r\n%%\r\n####O\r\n###//\\\r\n#####/V\r\n\r\n%%\r\n\r\n####_O\r\n#####´)\r\n#####¯\\\r\n%%\r\n\r\n#####_O\r\n######|\\\r\n#####´(\r\n%%\r\n\r\n######O\r\n#####/|\\\r\n#####´(\r\n%%\r\n\r\n######O\r\n#####/|\\\r\n#####/<\r\n%%\r\n\r\n#######O\r\n######/|\\\r\n######<|\r\n%%\r\n\r\n########O\r\n#######/|\\\r\n########|\\\r\n%%\r\n\r\n#########O\r\n########/|\\\r\n########/#\\\r\nasciiend\r\nfunc watch_goodStart(i)\r\n\t?i = 0\r\n\t\tfadeIn()\r\n\t\tdelta.frame = 4\r\n\t\tdelta.visible = true\r\n\t\tsetCharState(goodAnim, 8, 1, 45, false)\r\n\t\treturn i + 1\r\n\t:?i = 1\r\n\t\t?!updateFade()\r\n\t\t\treturn i + 1\r\n\t:?i = 2\r\n\t\t?gameTime\r\n\t\t\tgameTime--\r\n\t\t:\r\n\t\t\t?delta.frame\r\n\t\t\t\tdelta.frame--\r\n\t\t\t:\r\n\t\t\t\treturn i + 1\r\n\t\t\tgameTime = 5\r\n\t:?i = 3\r\n\t\tchar.Play()\r\n\t\treturn i + 1\r\n\t:?i = 4\r\n\t\t?!char.playing\r\n\t\t\treturn i + 1\r\n\t:?i = 5\r\n\t\t?!updateMessageList(3)\r\n\t\t\treturn i + 1\r\n\t:?i = 6\r\n\t\tresetCharState()\r\n\t\tsetWatch(3)\r\n\t\treturn -1\r\n\treturn i\r\n\r\nfunc watch_goodEnd(i)\r\n\t?i = 0\r\n\t\tfadeOut()\r\n\t\tcreateJam()\r\n\t\treturn i + 1\r\n\t:?i = 1\r\n\t\t?!updateFade()\r\n\t\t\treturn i + 1\r\n\t:?i = 2\r\n\t\t?!updateMessageList(4)\r\n\t\t\treturn i + 1\r\n\t:?i = 3\r\n\t\tsetupJam()\r\n\t\treturn i + 1\r\n\t:?i = 4\r\n\t\tupdateJamShiny()\r\n\t\t?!updateMessage()\r\n\t\t\treturn i + 1\r\n\t:?i = 5\r\n\t\tfadeIn()\r\n\t\treset()\r\n\t\tsetWatch(4)\r\n\t\treturn -1\r\n\treturn i\r\n\r\nfunc setWatch(i)\r\n\t?!getWatch(i)\r\n\t\tstorage.Incr(\"watch\", math.Pow(2, i))\r\n\r\nfunc getWatch(i)\r\n\tvar w = storage.Get(\"watch\", 0)\r\n\t?w\r\n\t\tvar t = math.Pow(2, i)\r\n\t\treturn w % (t * 2) - w % t = t\r\n\treturn false\r\n\r\nfunc getLanguage()\r\n\t?te.language = \"EN\"\r\n\t\tgetLanguage_EN()\r\n\t:?te.language = \"PT-BR\"\r\n\t\tgetLanguage_PTBR()\r\n\t:?te.language = \"ZH-CN\"\r\n\t\tgetLanguage_ZHCN()\r\n\t:?te.language = \"ZH-TW\"\r\n\t\tgetLanguage_ZHTW()\r\n\t:?te.language = \"FR\"\r\n\t\tgetLanguage_FR()\r\n\t:?te.language = \"DE\"\r\n\t\tgetLanguage_DE()\r\n\t:?te.language = \"RU\"\r\n\t\tgetLanguage_RU()\r\n\t:?te.language = \"ES-LA\"\r\n\t\tgetLanguage_ESLA()\r\n\t:?te.language = \"ES-EU\"\r\n\t\tgetLanguage_ESEU()\r\n\t:?te.language = \"JP\"\r\n\t\tgetLanguage_JP()\r\n\t:?te.language = \"KR\"\r\n\t\tgetLanguage_KR()\r\n\t:?te.language = \"TK\"\r\n\t\tgetLanguage_TK()\r\n\r\nfunc getLanguage_EN()\r\n\tmessageList.Clear()\r\n\t// basic info\r\n\tmessageList.Add([\r\n\t\t\"score\",\r\n\t\t\"Hscore\",\r\n\t\t\"click\",\r\n\t\t\"A green gem, gentle yet hard,\\nwith rare attraction.\\n(input ↑←↓→ at the Stone Dungeon's title to use)\"\r\n\t])\r\n\r\n\tfor i = 0..3\r\n\t\tmessageList.Add([])\r\n\treturn\r\n\r\n\t// bad start\r\n\tmessageList.Add([])\r\n\t// bad end\r\n\tmessageList.Add([])\r\n\t// good start\r\n\tmessageList.Add([])\r\n\t// good end\r\n\tmessageList.Add([])\r\n\r\nfunc getLanguage_PTBR()\r\n\tgetLanguage_EN()\r\n\treturn\r\n\r\n\tmessageList.Clear()\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\r\nfunc getLanguage_ZHCN()\r\n\tmessageList.Clear()\r\n\t// basic info\r\n\tmessageList.Add([\r\n\t\t\"分数\",\r\n\t\t\"最高分\",\r\n\t\t\"点击\",\r\n\t\t\"一块绿宝石，温柔而坚硬，具有罕见的吸引力。\\n(在Stone Dungeon标题输入↑←↓→后开始游戏即可使用)\"\r\n\t])\r\n\r\n\tfor i = 0..3\r\n\t\tmessageList.Add([])\r\n\treturn\r\n\r\n\t// bad start\r\n\tmessageList.Add([\r\n\t\t\"\\\"好痛...\\\"\\n冷风钻进你的伤口内，刺痛的感觉让你精神一振。\",\r\n\t\t\"你站起来环顾四周，以往遥不可及的卫城正在你的眼前。\\n看来你坚定的信念的确打动了琉刻。\\n只是... 你似乎与卫城的大门还有一段距离。\",\r\n\t\t\"遍地都是宝箱和纪念无名尸体的墓碑，也许同样是从[color=#00ff00]静溪[/color]运送上来的?\\n但己经没空思考这种事情了，你不知道自己受伤的身体能不能支撑到进入卫城。\",\r\n\t\t\"但即使如此，你依然一步步的往前，向着美好的人生迈进。\"\r\n\t])\r\n\t// bad end\r\n\tmessageList.Add([\r\n\t])\r\n\t// good start\r\n\tmessageList.Add([\r\n\t])\r\n\t// good end\r\n\tmessageList.Add([\r\n\t])\r\n\r\nfunc getLanguage_ZHTW()\r\n\tmessageList.Clear()\r\n\t// basic info\r\n\tmessageList.Add([\r\n\t\t\"分數\",\r\n\t\t\"最高分\",\r\n\t\t\"點擊\",\r\n\t\t\"一顆綠寶石，溫柔而堅硬，具有罕見的吸引力。\\n(在Stone Dungeon標題輸入↑←↓→後開始遊戲即可使用)\"])\r\n\r\n\tfor i = 0..3\r\n\t\tmessageList.Add([])\r\n\treturn\r\n\r\n\t// bad start\r\n\tmessageList.Add([\r\n\t\t\"\\\"好痛...\\\"\\n冷風鑽進你的傷口內，刺痛的感覺讓你精神一振。\",\r\n\t\t\"你站起來環顧四周，以往遙不可及的衛城正在你的眼前。\\n看來你堅定的信念的確打動了琉刻。\\n只是... 你似乎與衛城的大門還有一段距離。\",\r\n\t\t\"遍地都是寶箱和紀念無名屍體的墓碑，也許同樣是從[color=#00ff00]靜默溪流[/color]運送上來的?\\n但己經沒空思考這種事情了，你不知道自己受傷的身軀能不能支撐到進入衛城。\",\r\n\t\t\"但即使如此，你仍然一步步的往前，向着美好的人生邁進。\"\r\n\t])\r\n\t// bad end\r\n\tmessageList.Add([\r\n\t\t\"只要能夠進去...\\n我就是高貴的衛... 城......\",\r\n\t\t\"經過漫長的道路，全身已經疲憊無力的你終於站立在高聳的大門前。\\n。\",\r\n\t\t\"\",\r\n\t\t\"\"\r\n\t])\r\n\t// good start\r\n\tmessageList.Add([\r\n\t])\r\n\t// good end\r\n\tmessageList.Add([\r\n\t])\r\n\r\nfunc getLanguage_FR()\r\n\tgetLanguage_EN()\r\n\treturn\r\n\r\n\tmessageList.Clear()\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\r\nfunc getLanguage_DE()\r\n\tgetLanguage_EN()\r\n\treturn\r\n\r\n\tmessageList.Clear()\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\r\nfunc getLanguage_RU()\r\n\tgetLanguage_EN()\r\n\treturn\r\n\r\n\tmessageList.Clear()\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\r\nfunc getLanguage_ESLA()\r\n\tgetLanguage_EN()\r\n\treturn\r\n\r\n\tmessageList.Clear()\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\r\nfunc getLanguage_ESEU()\r\n\tgetLanguage_EN()\r\n\treturn\r\n\r\n\tmessageList.Clear()\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\r\nfunc getLanguage_JP()\r\n\tgetLanguage_EN()\r\n\treturn\r\n\r\n\tmessageList.Clear()\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\r\nfunc getLanguage_KR()\r\n\tgetLanguage_EN()\r\n\treturn\r\n\r\n\tmessageList.Clear()\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\r\nfunc getLanguage_TK()\r\n\tgetLanguage_EN()\r\n\treturn\r\n\r\n\tmessageList.Clear()\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\tmessageList.Add([])\r\n\r\nvar greenJamText = ascii\r\n#########,/\\`-._\r\n#######,´/##\\###`-.\r\n######/#/###/`-·._#`.\r\n####,´#/###/######;‾:\r\n###/##/#_./######;##;\r\n#,´##.·´##‾`-.##;##|\r\n/.·´###`·._###‾`\\##;\r\n#‾‾‾`───.##`·._##\\:\r\n#########‾‾‾`──:-.|\r\nasciiend\r\n\r\nvar jamShinyList = []\r\nvar jamShiny = ascii\r\n\r\n%%\r\n\r\n\r\n##.\r\n##'\r\n\r\n\r\n%%\r\n\r\n##.\r\n###\\\r\n#\\\r\n##'\r\n\r\n%%\r\n##.\r\n###\\\r\n/#.\r\n##'#/\r\n#\\\r\n##'\r\n%%\r\n###\r\n##.\r\n#/\r\n###/\r\n##'\r\n\r\n%%\r\n##.\r\n#/\r\n##.#\\\r\n\\#'\r\n###/\r\n##'\r\n%%\r\n\r\n##.\r\n###\\\r\n#\\\r\n##'\r\n\r\n%%\r\n\r\n\r\n##.\r\n##'\r\n\r\n\r\n%%\r\n\r\nasciiend\r\n\r\nfunc showHint()\r\n\t?totaltime % 60 < 30\r\n\t\treturn\r\n\t?sys.isPC\r\n\t\t>`@screen.w/2-6@,@screen.h/2+2@,Press  C key\r\n\t:?sys.isMobile\r\n\t\t>`@screen.w/2-6@,@screen.h/2+2@,Click Screen\r\n\r\nfunc showdata()\r\n\t>`0,0,@state@ @score@ @highscore@ @gameDelay@ @speed@ @fadeTimer@ @storage.Get(\"watch\", 0)@\r\n\r\n\t?char\r\n\t\t>`0,1,@char.x@ @char.y@ @char.pivotY@ @char.w@ @char.h@\r\n\r\n\t?obstacleList.Count()\r\n\t\t>`0,2,@obstacleList[0].x@ @obstacleList[0].y@ @obstacleList[0].pivotY@ @obstacleList[0].w@ @obstacleList[0].h@ \r\n\t\t^@isCollisionX(char, obstacleList[0])@ @isCollisionY(char, obstacleList[0])@ @isCollision(char, obstacleList[0])@\r\n\r\n\t\t>`0,3,@obstacleList[1].x@ @obstacleList[1].y@ @obstacleList[1].pivotY@ @obstacleList[1].w@ @obstacleList[1].h@ \r\n\t\t^@isCollisionX(char, obstacleList[1])@ @isCollisionY(char, obstacleList[1])@ @isCollision(char, obstacleList[1])@\r\n\r\n\t?scoreText\r\n\t\t>`0,4,@scoreText.text@ @string.Size(scoreText.text)@ @scoreText.w@ @scoreText.h@ \r\n\t?highscoreText\r\n\t\t>`0,5,@highscoreText.text@ @string.Size(highscoreText.text)@ @highscoreText.w@ @highscoreText.h@\r\n\r\n\r\n\r\nmain()\r\n\r\nfunc removeHighScore()\r\n\thighscore = 0\r\n\tstorage.Delete(\"highscore\")\r\n\r\nfunc removeWatch()\r\n\tstorage.Delete(\"watch\")\r\n\r\nfunc removeAll()\r\n\tremoveHighScore()\r\n\tremoveWatch()\r\n\tloc.Leave()\r\n\r\n//removeAll()"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Stonemon.txt" - Parse error: Failed to parse completely. Remaining: "\\Stonemon\\Creatures\r\nvar enemy = new Games\\Stonemon\\Creatures\r\n\r\nvar battlePhase = new Games\\Stonemon\\BattlePhase\r\nvar gameUIController = new Games\\Stonemon\\GameUIController\r\nvar inputControl = new Games\\Stonemon\\InputControl\r\n\r\nvar intro\r\n\r\nvar phase = \"Boot\"\r\nvar index = -1\r\n\r\nvar delay = 0\r\n\r\nvar a = 0\r\n\r\nfunc main()\r\n\t?string.Equals(phase, \"Boot\") | loc.loop\r\n\t\tbattlePhase.Restart(character, enemy)\r\n\t\tgameUIController.createUI(character, enemy)\r\n\r\n\t?string.Equals(phase, \"Boot\")\r\n\t\t?storage.Get(\"skipIntro\", false)\r\n\t\t\tsetPhase(\"Restart\")\r\n\t\t:\r\n\t\t\tintro = new Games\\Stonemon\\Intro\r\n\t\t\tsetPhase(\"Intro\")\r\n\t\t\r\n\t:?string.Equals(phase, \"Intro\")\r\n\t\t?intro.Run()\r\n\t\t\tstorage.Set(\"skipIntro\", true)\r\n\t\t\tsetPhase(\"Restart\")\r\n\r\n\t:?string.Equals(phase, \"Restart\")\r\n\t\tbattlePhase.Restart(character, enemy)\r\n\t\tgameUIController.Restart(enemy.Name)\r\n\t\tinputControl.Restart()\r\n\t\tsetPhase(\"Battle\")\r\n\t\t\r\n\t:\r\n\t\t?gameUIController.needUpdateBar\r\n\t\t\tgameUIController.updateBar(character, enemy)\r\n\t\t?gameUIController.foeApproachOffset\r\n\t\t\tgameUIController.updateFoeOffset()\r\n\t\t?gameUIController.fade.index < 15 & !string.Equals(phase, \"playerDeath\")\r\n\t\t\tgameUIController.updateScreenOpacity()\r\n\r\n\t\t?string.Equals(phase, \"Battle\")\r\n\t\t\t//battlePhase.Run(inputControl.cursor, character, enemy)\r\n\t\t\t?battlePhase.envy > 0\r\n\t\t\t\tsetPhase(\"startEmpower\")\r\n\t\t\t:?enemy.CurrentHP <= 0\r\n\t\t\t\tgameUIController.initFoeDeath()\r\n\t\t\t\tsetPhase(\"foeDeath\")\r\n\t\t\t:?character.CurrentHP <= 0\r\n\t\t\t\tgameUIController.initPlayerDeath()\r\n\t\t\t\tsetPhase(\"playerDeath\")\r\n\t\t\t:\r\n\t\t\t\tsetPhase(\"TurnStart\")\r\n\r\n\t\t:?string.Equals(phase, \"TurnStart\")\r\n\t\t\t?battlePhase.turn = \"player\"\r\n\t\t\t\tbattlePhase.turnStart(character)\r\n\t\t\t\tsetPhase(\"playerTurn\")\r\n\t\t\t:\r\n\t\t\t\tbattlePhase.turnStart(enemy)\r\n\t\t\t\tdelay = 30\r\n\t\t\t\tsetPhase(\"foeTurn\")\r\n\r\n\t\t\tgameUIController.turnStart(character, enemy, battlePhase)\r\n\r\n\t\t:?string.Equals(phase, \"foeTurn\")\r\n\t\t\t?delay\r\n\t\t\t\tdelay--\r\n\t\t\t:\r\n\t\t\t\tbattlePhase.foeTrue(enemy, character)\r\n\t\t\t\tsetPhase(\"TurnEnd\")\r\n\t\t\r\n\t\t:?string.Equals(phase, \"playerTurn\")\r\n\t\t\tinputControl.Battle()\r\n\t\t\tinputControl.optionsControl()\r\n\t\t\tgameUIController.setBattleCursorPos(inputControl.cursor)\r\n\t\t\t?gameUIController.isConfirm(\"Stats\")\r\n\t\t\t\t?gameUIController.confirmIndex = 0\r\n\t\t\t\t\tsetPhase(\"startFoeStats\")\r\n\t\t\t\t:?gameUIController.confirmIndex = 1\r\n\t\t\t\t\tsetPhase(\"startPlayerStats\")\r\n\t\t\t:\r\n\t\t\t\tindex = getBtnIndex(\"Battle\")\r\n\t\t\t\t?index >= 0 & battlePhase.canUseFromBattle(index, character)\r\n\t\t\t\t\tbattlePhase.TurnHandler(index, character, enemy)\r\n\t\t\t\t\tsetPhase(\"TurnEnd\")\r\n\t\t\r\n\t\t:?string.Equals(phase, \"TurnEnd\")\r\n\t\t\tbattlePhase.turnEnd()\r\n\t\t\tgameUIController.turnEnd(character, enemy, battlePhase)\r\n\t\t\tsetPhase(\"Battle\")\r\n\r\n\r\n\r\n\t\t:?string.Equals(phase, \"startEmpower\")\r\n\t\t\tgameUIController.startEmpower(character, battlePhase)\r\n\t\t\tsetPhase(\"Empower\")\r\n\r\n\t\t:?string.Equals(phase, \"Empower\")\r\n\t\t\tinputControl.optionsControl()\r\n\t\t\tgameUIController.setEmpowerCursorPos(inputControl.cursor)\r\n\t\t\tindex = getBtnIndex(\"Empower\")\r\n\t\t\t?index >= 0 & battlePhase.canUseFromEmpower(index, character)\r\n\t\t\t\tbattlePhase.EmpowerCreature(index, character)\r\n\t\t\t\tgameUIController.setBar(character, enemy)\r\n\t\t\t\t?battlePhase.envy\r\n\t\t\t\t\tsetPhase(\"startEmpower\")\r\n\t\t\t\t:\r\n\t\t\t\t\tsetPhase(\"endEmpower\")\r\n\r\n\t\t:?string.Equals(phase, \"endEmpower\")\r\n\t\t\tgameUIController.closeEmpowerWindow()\r\n\t\t\tsetPhase(\"Battle\")\r\n\r\n\r\n\r\n\t\t:?string.Equals(phase, \"foeDeath\")\r\n\t\t\t?gameUIController.foeDeath()\r\n\t\t\t\tbattlePhase.RoundControl(character, enemy)\r\n\t\t\t\tgameUIController.resetFoeArt(enemy.Name)\r\n\t\t\t\tsetPhase(\"Battle\")\r\n\r\n\t\t:?string.Equals(phase, \"playerDeath\")\r\n\t\t\t?gameUIController.playerDeath()\r\n\t\t\t\tsetPhase(\"Restart\")\r\n\r\n\r\n\r\n\t\t:?string.Equals(phase, \"startPlayerStats\")\r\n\t\t\tgameUIController.openStatsWindow(\"player\", character)\r\n\t\t\tsetPhase(\"playerStats\")\r\n\r\n\t\t:?string.Equals(phase, \"playerStats\")\r\n\t\t\tinputControl.playerStats()\r\n\t\t\t?gameUIController.isConfirm(\"Stats\")\r\n\t\t\t\t?gameUIController.confirmIndex = 0\r\n\t\t\t\t\tsetPhase(\"startFoeStats\")\r\n\t\t\t\t:?gameUIController.confirmIndex = 1\r\n\t\t\t\t\tsetPhase(\"endStats\")\r\n\r\n\t\t:?string.Equals(phase, \"startFoeStats\")\r\n\t\t\tgameUIController.openStatsWindow(\"foe\", enemy)\r\n\t\t\tsetPhase(\"foeStats\")\r\n\t\t:?string.Equals(phase, \"foeStats\")\r\n\t\t\tinputControl.foeStats()\r\n\t\t\t?gameUIController.isConfirm(\"Stats\")\r\n\t\t\t\t?gameUIController.confirmIndex = 0\r\n\t\t\t\t\tsetPhase(\"endStats\")\r\n\t\t\t\t:?gameUIController.confirmIndex = 1\r\n\t\t\t\t\tsetPhase(\"startPlayerStats\")\r\n\r\n\t\t:?string.Equals(phase, \"endStats\")\r\n\t\t\tgameUIController.closeStatsWindow()\r\n\t\t\tsetPhase(\"playerTurn\")\r\n\r\n?inputControl.phase\r\n\tsetPhase(inputControl.phase)\r\n\r\nfunc setPhase(p)\r\n\t?p & !string.Equals(p, phase)\r\n\t\tphase = p\r\n\t\tinputControl.Restart()\r\n\t\tgameUIController.RestartConfirm()\r\n\r\nfunc getBtnIndex(type)\r\n\t?inputControl.confirm\r\n\t\treturn inputControl.cursor\r\n\t:?gameUIController.isConfirm(type)\r\n\t\treturn gameUIController.confirmIndex\r\n\t:\r\n\t\treturn -1\r\nmain()\r\n\r\n//>@phase@ @delay@"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Sudoku/SudokuStore.txt" - Parse error: Failed to parse completely. Remaining: "= [\r\n[//0.2 1-100\r\n  \"205078913916253784800491250620147538481035627573820109054309862162784395090502070\",\r\n  \"750129080108034000294786035635072841020348576807615302389251467412860953076493218\",\r\n  \"238946705041735286705280940082079561697150800000628497329067158870513629016892374\",\r\n  \"040589006502370418080142530417950203935261870268734195801607342674823901329415680\",\r\n  \"524910307080637045307425109005896000018273590793541620452169873836754912179302456\",\r\n  \"350240090014789503970356124125493687069128345483567219030914000691075432807630951\",\r\n  \"237654009954001276601297530592046183403812795708530402026078050849165327170923648\",\r\n  \"193706082570380096806001430350074629987625314642193758760209843439560271218407960\",\r\n  \"010067893065903004903241007297456130154738926800129475548302709671895342329674081\",\r\n  \"361957024502084307874002000719523648253806019648790253135279486927460005486315072\",\r\n  \"203060945946200080815079632024186759791304826650790410187620594560948371039517268\",\r\n  \"090752006745986102806130509058217963900308254062495718070843690539621487684579321\",\r\n  \"450090173182307596907516408819604237020003861673182954298761345361025789000839012\",\r\n  \"000925084592060307648137025157093208064782153203510769735241896426879531010356072\",\r\n  \"243690501960080040581432769726354908039218675810976324094823150372045806158760430\",\r\n  \"170908024946132578500406931304580102018624359625019807450703086869240713237861495\",\r\n  \"005006780010903200406872591524691837680030409973284615159068342847329156362145978\",\r\n  \"135207984006084125248901763307090806029648370684173592061825437003416259450739018\",\r\n  \"284730900090405286105289300320941068641852093958673412039127645470568139506304827\",\r\n  \"010738026708240591246195038594371602321804075607902103059623817073019264062487359\",\r\n  \"428010307063847021100260508256480730819736452074952810641378295985124673032690104\",\r\n  \"007924038306050749948637012531279406090581270782403195415306027273815904869702351\",\r\n  \"263905871500631429401078653706092300309814065805760294654029187930186042182457936\",\r\n  \"310407092749300601682509374157930280934028517826051439561003740403876125270145963\",\r\n  \"005604873764003591183050426402591630510730240039426157297065384048370915351849762\",\r\n  \"950273648072100935630050172709030284285741096346890751023589467597016823460327510\",\r\n  \"876090105002135068315680204287469351931850476650071982723008649160900527549726813\",\r\n  \"049573826732186954856904170301050468084301702207049305405237689923618507670495031\",\r\n  \"502603907431597820607048003268104079943870215175932468304785690859061032716329580\",\r\n  \"000927460029008105486135729514302986037689014908514273075041692691253847040796351\",\r\n  \"602495381040080256501623497004379010706210940198564723963052170425137069817946532\",\r\n  \"517394682430028105090506047753109826064852973908673500389467251605281739201930460\",\r\n  \"049260580012853400583749612050498731094037250137625048001582374475016829328974065\",\r\n  \"719503860025704913340619527200850649967100058584396172853201496192468705470905280\",\r\n  \"340760815798215430605348279274086103830152947159430680420501300980604521560823794\",\r\n  \"317905046482176395090304180753490801149508032268713459030209670074630528625847913\",\r\n  \"209600830016237940307849162408502371092378406570410289984165703601783094735924618\",\r\n  \"136750098057098263289006075521369084643287510978014306364801907792645801015903642\",\r\n  \"352090841964381050781405930270903108406218005803756420527839614609102583138564297\",\r\n  \"530078000406512078000963514315746829074821653862395140659204031283157496147039085\",\r\n  \"204095103795003040103246579452967831671430900830012467910624308528371694346809712\",\r\n  \"300506084506084932874309516137068245028145367045273100260837059780450623453692871\",\r\n  \"924780306037960420615234978060843510240157609108629743370090065496502837581376294\",\r\n  \"153498702402016590986752413800043609090105800264987135531079246609521387028634951\",\r\n  \"296108547030057060057460002925684071364571298871392654642905780580723416003846925\",\r\n  \"013754620702060104408321970106539482539480716284070359645807293397245801821003547\",\r\n  \"279563481040281579851470206730926148680710092912834057420698710597042803060057924\",\r\n  \"134906780507080046860030510703598624459621037608473195070269450985347261246815973\",\r\n  \"672409538190003746438065219024571080806932405350046921041698352260104097589327164\",\r\n  \"750600294308190760094502138137056802985201376246780951813467520502319487409805613\",\r\n  \"203080605460205839895061427687940201324510976109620040048130592936752184512894763\",\r\n  \"079524380304190002026378049738419265490200873265783904010652497607931528950847631\",\r\n  \"426813507085207034317594806690125400541376082073489605869742350132650749704930068\",\r\n  \"312904560057168304060502091105790482094285036286410975523649817679050243841307659\",\r\n  \"234790801975281346601534792009305178720418569018600230852907410346152987197003025\",\r\n  \"010003082604182097982576014409637108063801459128095763895704236370268945246359071\",\r\n  \"472150683090403000183027045941762350257831469830045021568314207714298536300576814\",\r\n  \"015700084067080219080619075791365842620147953043928761139856420872490506450273198\",\r\n  \"703926145260305970915480326820739401397154080451860093002091830148273569530648217\",\r\n  \"159307400370040019264159078405020867721468935086735142517603084843072601692814753\",\r\n  \"204681507316007480850043021400369875085472310673815094540138762168724953732096140\",\r\n  \"195376428027040506060925017013794065540281973789653102031567284604812739870400651\",\r\n  \"200048001070261480841537906984025137725813694603479850357106248068052719192704365\",\r\n  \"154936870308070064760845139537418296010309085809067341941703628675284903280691450\",\r\n  \"541270980090138050823945671402691030608453729935702410184520307067314895309867142\",\r\n  \"020306084973084506080502109307620948016749253249830617531908472762453891098217365\",\r\n  \"203460915900105783851730062480376159695814237137902640728643091310097820049281076\",\r\n  \"047089162010462309296371485173850096080106750504927813730005648458613927629748031\",\r\n  \"241060837030487020687030509400598300369172485578346192094623708826754913053819264\",\r\n  \"973002640561340279240709013192635784050401930304927156735294061409876325826513090\",\r\n  \"630085471790340080481267953203498715574610830918753206329074168846130007157806094\",\r\n  \"351008470948370006762104389496710805075926143123845907519467238634209001207501694\",\r\n  \"072050683051203070403967521264105730597608214038724965746019352825306197019572840\",\r\n  \"135602840269584000847139562001056024082901036694027185750208493428793651903465278\",\r\n  \"802070035630205470715308926124037659308159007057462301476521893593684710281793064\",\r\n  \"010342080387050009006897153934018207150703948768924305891235674673481590245679831\",\r\n  \"204109307056207498937504002420913876698472135371000924869325741513046080742891063\",\r\n  \"053629048924170365080354120537261084600403072248095601462517893391846057870902416\",\r\n  \"300000801407281635618590427742956318860312750053740962276104589530829106901675243\",\r\n  \"310604590645792108982135076751340620030520081806971300173809245594210863268453917\",\r\n  \"249050683760403519153098742504206038602539400397841256476310895901085360835964027\",\r\n  \"050602984276948531940001760512087609709264158684195307321009476867413095095726810\",\r\n  \"324090875690845213105270946930487651760152039451906728249018567800064092516009384\",\r\n  \"013807096800020507726935048147390052080704319369251784971683425402579861658412073\",\r\n  \"294830100016407080830961425421506378609378240378214659940753816105649032763180590\",\r\n  \"513700084967348105420516037239067548154903062786425009091274850645839271872050490\",\r\n  \"523749681040351020091628354974235168235010490816497200057002800369104572182573946\",\r\n  \"150397082309862104682145397015430928043708510826950743401603275508079461007514839\",\r\n  \"654000783270483960803567201020659138016730402385124697542876310769315824138902070\",\r\n  \"910750020706190805845302090130076502560843719479521368351289470284617950697435281\",\r\n  \"230641805068200039070893246026310957743002681901768023694587312387126594012409768\",\r\n  \"140502060957180302820743950031028406498657123062431589015879630389260715674315098\",\r\n  \"902800367658007010137469205421906073309702841875041602216594738593678124084123906\",\r\n  \"325690480691740302470502961739054628064203570582967104246009815907806203813425796\",\r\n  \"209045013030700069601290547025839071968510432713462908046978125850124396192356784\",\r\n  \"030795608906182307002346159413509206598621700627438900860953472375264891249807560\",\r\n  \"097680523861523907203049108945167832672908401100052796006805314504376089389214675\",\r\n  \"309501784175084296280607351503062849007148563806053127630279410792415608450830972\",\r\n  \"287394615390215748140000290020673451713459826600821937409568002801932564562147080\",\r\n  \"537194806418520079026378510871250600090461758654830291083705962749682105260913480\"\r\n  ],\r\n  [//0.4 101-200\r\n  \"305064008096020140040517000609070384073400056804650901001746802902835017087201060\",\r\n  \"603450901409001063001030700094608000260000849018749056740863095985074002036090478\",\r\n  \"010306040046080175082701693003000700970605300628137004800213407437009281061804030\",\r\n  \"071460000058203070903700206060001030010035804389074025027046390500092748194387052\",\r\n  \"100708004006009103094102576713256849020900315009013207050601030361080702480300601\",\r\n  \"209040005000890720815020609008009004920453006047160902784010253300584107150732490\",\r\n  \"150004020904026100000510048305102069090305287608000013740603051513478692060201074\",\r\n  \"500040007010007000007980006042805063036479025875023400490152608201768934700394052\",\r\n  \"170004020036020794028906130305090042004380060602450903060705089957043200801260357\",\r\n  \"293040081078001092001098700060805014504010970007039260006120800120907436389560127\",\r\n  \"310046082800570401700300090057004320000825609608730154000608217271090805086217043\",\r\n  \"074560903090003200803940705500078130900030426100204578729056301460309007308417090\",\r\n  \"012305080738020569040000102025716048100048050004003271050439020203670490097582310\",\r\n  \"680040107000005098035708204240006900300457612000900743970864031003070426456301879\",\r\n  \"070045000000360009080972001008093400034006517762514803820651030591037020643289075\",\r\n  \"508493000961027080007081502805264301640070058072805040050018700214006039009042615\",\r\n  \"190206050705084129048009600600130080017008360009600510530001890921863740076490231\",\r\n  \"620003708040280030000069420070356001056408200008972350067094583594037002083625970\",\r\n  \"500006780300182004060004010603570408004803167728600503075918230109060840286430901\",\r\n  \"097008140014203000850040000070925030082431567031006294728004015109572300365010072\",\r\n  \"170609820295040076000203509500027403937504060840000790351702900768090201029801607\",\r\n  \"700839050390701028005024309080006015600105042007940860473518096900460007008297134\",\r\n  \"134057080792000504500302090400000003875403912203090048040275060607039421020614375\",\r\n  \"204658371610037080007040206050000738042000090760000120420385007576924813983006540\",\r\n  \"039207080206900153500306000600093002090402560482160090010634078700821905803579614\",\r\n  \"370098201008001070251400689020365418060710052005280367594870030602000790037040025\",\r\n  \"030400700705010904040700030401038209396107845207054613070200091923840007614509320\",\r\n  \"006029438240100500903040200060904083487200605109856742600095820890002307325000961\",\r\n  \"000290000102064950094708001517900648060847035348015270870136492901070580020000710\",\r\n  \"204018365600005092035002807320104050800000006050380249703890024418526903502400681\",\r\n  \"003509800000326000096107043905013260031402080628975431017008092380790000060234178\",\r\n  \"802000107050237860607891405060512074005070682270486090520900018309700046706024900\",\r\n  \"913072060062048309500306010000720604000904030384610972430250090627030045805401723\",\r\n  \"200563981390281060001007300702956814006310790900724600004070138683102509000805200\",\r\n  \"000008042305090678600304050109005426063009010004010983957240861036780200208956734\",\r\n  \"700400083040700000100080007400950730976238401830174006084060510507841362361592870\",\r\n  \"390200054207004190060591023105720089006849010908053207670015040000470906480962071\",\r\n  \"200016453940205710305000920897600500401053009650089047102847300704000082589002174\",\r\n  \"150009080893462001700100493007000002000000100526041738439200865275630904681594320\",\r\n  \"028000103100007548350814002046903000810056924970421000504379061001542830030108059\",\r\n  \"000041768107060390560709041003092680021400079489600130010974850900016407804025016\",\r\n  \"254690001090001050081057406032009708470318620010726009043902180068070502027835004\",\r\n  \"010300000600512803300469057937180406001720000200030700163207589798651200425803670\",\r\n  \"709460580451083000603570001240906037976032100100004902800627005002308679067105028\",\r\n  \"050201080918634507074058010160509040020046850845020369091702000607003205402095076\",\r\n  \"060790105290035006735041000023907000609104082000320749912008560540213007387069014\",\r\n  \"140007020307126005286504710571040682432008000860015007904800060720650104000491278\",\r\n  \"500891600809407020100526089000160070603079100070354268214083006356012894708000012\",\r\n  \"007396080006008175008007306971030008020709610684020907005062803809073201432815069\",\r\n  \"096030481038401009701600500020945300000018200010002750962854137400173062173290045\",\r\n  \"190740000307500609082901047073094826016820790908073401800060270730210065060407038\",\r\n  \"501020963092403050638059007914070030206805009803901000027086091360207504105390720\",\r\n  \"170239084689014307300070010703800465290005130408301972000406051500087203040103096\",\r\n  \"008040605630215987700000200820409070973050008051708300002974106147502893509183700\",\r\n  \"040009526000002301020573089903040807000816002268930145491728050832600090075304210\",\r\n  \"290846500560937208800010600029403870485070069103609425346001700950700043000304950\",\r\n  \"059673008327040960060592170530010004070300090894265000640021809082050601015836042\",\r\n  \"920300001603501970701096004050409800209718435410605700594070163006054207070903048\",\r\n  \"010006802600090104090178050501760400347021600906850730070080563869345007053017948\",\r\n  \"052710400040800050608050172000108006807030510090064027286340091419280365375690240\",\r\n  \"030706820600004309942305710350060048000240531284003907010009000820030695496852173\",\r\n  \"006048905000700003395261008070004350489103627650007401008532070162809034507410092\",\r\n  \"350948006802000090000700100403090602589362000260014539024039875795480003638205940\",\r\n  \"269040378000007526500630901020904007635200009974100285150386094306000802090425160\",\r\n  \"039700080504390701278005300350074068042600007000001943615409000407812605823507419\",\r\n  \"605098701008031052701000948057942000004517300009683005082006093593800107170359084\",\r\n  \"703400000405082703092507610301000826070803140208050300086205031107006058534918267\",\r\n  \"000516983050403001103090406492658007017000500038900264260039845849105370075002010\",\r\n  \"130986024089700105704051680903068047070240910208100356097005062801072503000600870\",\r\n  \"087629001060405000405700296090800025603950847051204360076042508008097002532186070\",\r\n  \"193007280507006094006809005000090801025618437861070029009780053002901748058063012\",\r\n  \"200095317691007085000014296005168070006000052070052600513986004748523109960740500\",\r\n  \"020006940906048257080952100103520084200081390658030712000065870712090063060703029\",\r\n  \"700600201264001850901070306602750009090418560050062700429037618516809003870100920\",\r\n  \"090036000367480501482509060905070632030105000008060105800691254109247006246358900\",\r\n  \"709206803050003090683090205406500700598730102007628004902341506864070301010802079\",\r\n  \"300897620260504100794206500106752489020148076047069000673901040001483002002005010\",\r\n  \"900000004408195060205064978040613800103000240089072601090041503301729406804506719\",\r\n  \"003402076700386010080715320310800005020163090864050100401038050205947081098501743\",\r\n  \"205960130986007245107054860020600970003479682760003000890340051650700028070082490\",\r\n  \"030100648970340015080002300209030700703906100468021539340007860620810073097203451\",\r\n  \"257640001430981275009020300090004010648702950000890060900458127720009680104206539\",\r\n  \"130409000946080537080005090317000200004021078000530416071658020698213745053704801\",\r\n  \"609000703050603291180000005904762030065900402038154970072501369500306007096827104\",\r\n  \"130600948020084100080010020312895604050700010006102589593270461201050807070961250\",\r\n  \"290048105300000090615927308020401857470050206800276930160090583700000421034080679\",\r\n  \"059307420300046598046900100085010009001563040263000751517209680038604215604001030\",\r\n  \"420069357019307204000048106100906070206070831375021049852000700901780425040000968\",\r\n  \"010002708200078534470603000100046875507381000096020003032504609601830427084267301\",\r\n  \"256007001098601230300080004025006040600018009700924053502803416169045380034102975\",\r\n  \"070008930300090006090137040541000029830526070260910380703260054406301297008745163\",\r\n  \"571004603020003570083000290260009138004736925930028067148960300006302809390810006\",\r\n  \"000720060207040305894000700509010648631074200482000107918206470705431806340900512\",\r\n  \"204080930000205080815000000048903057120857603050400829431590270790304518086002394\",\r\n  \"070805300408020157006307980015402806280701039960000201741238600600054700850679013\",\r\n  \"028561307690207481300849000081600070500170060730028105960015708003792004004306529\",\r\n  \"153206098000384500000009032517020943090540680086790210020805376700062809860937020\",\r\n  \"723890651054231078900000300040609010390017085817352069070105806532060047000043090\",\r\n  \"015704080709500006860139007170050620958020070603010050090800003586293714237641095\"\r\n    ],\r\n  [//0.6 201-300\r\n  \"000008904008590006004310050300070000000100260409200103030807001040600700087020035\",\r\n  \"900080605061000090800001400020004050600009000410200000000807500732506080590013062\",\r\n  \"000458000005920000090700408000000069030002000060070305540890072008030004670045031\",\r\n  \"208605300000000400007400005002901070005008906070000814900700000500020048000836159\",\r\n  \"502010008703640500400029000300000200050000000284070300030090820007061000801205760\",\r\n  \"000475901900001030001030704000064000706003009100000000430050007620348005500900043\",\r\n  \"090005002608102594002980000016000700500607900007019006100800000003200001280700003\",\r\n  \"002000500060000090510080200000006800001034709037002400025690000486005907370008600\",\r\n  \"039008040006100900040096152502000004000085009300000705073500080820040500060017000\",\r\n  \"800000300000600000425810007090360050286050009150000040302190080049028070008000600\",\r\n  \"100080026809020000520000010035000209000369500068270104000000643301040002000902000\",\r\n  \"000009307010807209300010006102560900003970008070000000950000002406090100730020094\",\r\n  \"050903040302048500000207100015020009000009000400010302090400875030090006024670000\",\r\n  \"347900001500000020000000709030004015070310000080602300864090000059140200100506900\",\r\n  \"053406000700000503920000000617530020030008700005064000090600050004015090500900641\",\r\n  \"207000503000003000500070491000548030700000040000010600900020050856300002372180064\",\r\n  \"000000004005890300040321506570030600200740050380100000007003015600050009003907060\",\r\n  \"087000100000205700005010600920874006746000000000326000070680901001003080050100360\",\r\n  \"017034006804020305030100004043000000009300080000017000900283040002041509001500030\",\r\n  \"902050100000007080100490200050030018001000900300040000235700001604580020008301540\",\r\n  \"301000940002000500704159000007000005020680034408000109070400000203807006000560270\",\r\n  \"500060071760501090001090200043005080987000356010800702090007000806240007000000000\",\r\n  \"030508000400000000060390005003650800050827090928410500000006050509200084200080030\",\r\n  \"245060703000803000100270604000700030090008200078009000900310806407500000010400075\",\r\n  \"002000000607100200890000000100300008050708010000019736700096053900450807400203009\",\r\n  \"000084310000200840005030007910000050487600201650000030000108570078000060004306100\",\r\n  \"000005006500400100086032000305000608090000702207010903420001000013620405000340020\",\r\n  \"640000007098007000007096020050302000863001000070804000980020501531640000000005096\",\r\n  \"020000460004000721080104300003040600000600004408010235230005000600830002801006040\",\r\n  \"005000060403801000601000304034002006009010470000408050062004009948607032000009000\",\r\n  \"159003680700060000002819030014037000090008401000000003070304060405006007003000540\",\r\n  \"420000003680000070003060100500080030809070600060109020048590300096300705000807400\",\r\n  \"010200084006000100080005309501900607007400000040000890003059010009742008058630000\",\r\n  \"200093410070200000015040000032001754040000029000004000097100546600009030020430090\",\r\n  \"510008004000000000460507083301000006740002090096400018030804070820670000000901030\",\r\n  \"002645100000000090060108002000900050513070069070500000905006473706300015100000200\",\r\n  \"000060070002007600060495000004020907620000004089000000001609030006073201890100746\",\r\n  \"600000901000001630090040007400206010503000090180700003760000140008000002310469805\",\r\n  \"739004080150600039000300040401000800000108970080430006000000460000041307043060001\",\r\n  \"000097100090003060800650049000004000400030600008965700004000901089100320002579006\",\r\n  \"000705080506080002080000070250000009000200000040009213020178405800496007400503060\",\r\n  \"080930600300405080000820004000009050001600370653700090000003007140068020530004060\",\r\n  \"390105006000320000000900080401030200030460008900500040050890672000071900079200030\",\r\n  \"200406307001000000500080106000801973005603400070904000350000009709040538000000760\",\r\n  \"030502090956300201040700000002036004590004620004000000010005036005000902007400180\",\r\n  \"900004001050200639300000204070003000030800092010007046647090025590102007000000003\",\r\n  \"000040620500630000080015000003576480000803000020000500040300000007201954060459073\",\r\n  \"209060050007003000680050702060805000000000900930100205700980301800306009300001076\",\r\n  \"030209000609000050080015000700026048906140030040000601000803005307060089008750000\",\r\n  \"097040000000600080805310200080100050003050014100400002062800501400000720500720096\",\r\n  \"000009086500046007006308500009000000000001030860000700095600073708010624041070950\",\r\n  \"020001600480630290007000008052000004046008509000305000200904000590010060014060052\",\r\n  \"000000648004000307070004010001090780040200000800070000610703090507049061480102003\",\r\n  \"504076003000081497008000260420008000900013040050604700040032000000000056070005024\",\r\n  \"050800000904150006000300150700005428040700000008010900600240500401000067095001043\",\r\n  \"009010783010030009803000500700000030905820106000703000620170300070009450500300010\",\r\n  \"103972000507000160890600000200030670900407000706050900015000400009540000470000830\",\r\n  \"620000004000000109905008603070030010138050246000000090040067930096500001050900700\",\r\n  \"000009000408320100020050040935010002000800500804205730170900008540000903080001400\",\r\n  \"000500307060207980000096000120980000000000100076000258640059002003724006700100004\",\r\n  \"002374090309600701000005340503007904090400530004030007000002060700050000400100270\",\r\n  \"700400001050891200081030000369508000507010802000600000604000007100002008002705049\",\r\n  \"061009080900002104000000030005030027670001000020050000050804261086020905200695000\",\r\n  \"001062800076000040000070602524609030009008400300007006090020307600300004102000980\",\r\n  \"000100680102060009080509100501083046060000050700000300030000097010070405050608013\",\r\n  \"000004095340700080205800300400607050900050803057900000000000430030009560080026710\",\r\n  \"140028963903040080000300000019000020530700009208901005000010008000080204080003057\",\r\n  \"200040007040073001000010046000465003009300102073000000004038079001000024700600315\",\r\n  \"030064000916008230040300000005037800320400090604000310070920081000803009000006020\",\r\n  \"003028570040501006050300240000005010500010700010290050305600000400080025172003000\",\r\n  \"030706800004090103000000054000000000700100300006080517000634001368050409240800630\",\r\n  \"005041803018000500403000006260005037700002100530906000006507080000310052000008040\",\r\n  \"056708090003000708870200001509070640030000000600500307000302006001000905480905070\",\r\n  \"000040056040290000900063402020006000008900260050000070062089540400030009590074300\",\r\n  \"070004080300280107000500003901308400000100000007009008500000070069020801038641029\",\r\n  \"460000000850607000307010000000800070003970201010003980900050700030096000576180320\",\r\n  \"006500040250100000000000000100060009090780412084090503060400007932017004040650030\",\r\n  \"006300501003760820780045600079602000305814006000000000004007003890050000100000950\",\r\n  \"056000000903042000402060310000007002640508090008130405070904060809000001020600030\",\r\n  \"007005430954003060800000009200070015000000700000400002502001900480020650061859070\",\r\n  \"030906080705000000000300006510060802008002013000830005329600007600090238480200000\",\r\n  \"804060715090800040075000300037102000200000000050300080002538900480006030503040020\",\r\n  \"097041820000020000006700030008000462050009080300070501000500640005910278400007010\",\r\n  \"006180000800007010307069000080001579105000400973050000500090730030720051004000002\",\r\n  \"000000000092000007060007029900020000230100000084000100020504080107832096846901205\",\r\n  \"259740030000300050800050006020978003790000008000503090080000060010062300000895042\",\r\n  \"350007400700000306026900718507800900030402070042000000060205040900000000080701039\",\r\n  \"204700803000000007080500096000120030100000974030009050900008300500300749306900082\",\r\n  \"100062900000300006084905003310250009800100630000000107530000060200073400490506000\",\r\n  \"000006800600810037058070002040107350800000291005200046007000000500003104090002503\",\r\n  \"000900250700000008000103000003700000074010060060390704280670043030059607097402000\",\r\n  \"000560300060007008307040006030100000052070031070000820020700103586004092000082004\",\r\n  \"013000240000000300040500197000009084060400729080200000730001060450020903000653070\",\r\n  \"004060005690351700210000000029485060000010900000600040400036107080020056100500200\",\r\n  \"070006000000000003060100047000000306030002510506090084000289005008037690095604230\",\r\n  \"090008503460700090003059007200507030006001900008000070057042080020106000000875400\",\r\n  \"000250860060004003050000070501090400030800050806000000020106007680439200410700038\",\r\n  \"807340010600005840010700620392000000000050009074600030260100500903008000750900080\",\r\n  \"090003040700096000000400001007324009040068000802010000480600397200700108679000050\"\r\n      ]\r\n]\r\n\r\n\r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Sudoku/SudokuStart.txt" - Parse error: Failed to parse completely. Remaining: "(musicList[rng % musicList.Count()])\r\n    disable banner\r\n\t\tinitUI()\r\n  ?totaltime = 2\r\n    sudoCore.initUI()\r\n    sudoCore.matInit(0,0)\r\n  ?totaltime > 2\r\n    sudoCore.core()\r\n    loopEvent()\r\n\r\n\r\nfunc initUI()\r\n  buttonList.Clear()\r\n\r\n  mainWindow = ui.AddPanel()\r\n  mainWindow.clip = true\r\n\r\n  mainWindow.x = 0\r\n  mainWindow.y = 0\r\n  mainWindow.anchor = center_center\r\n  mainWindow.dock = center_center\r\n\tmainWindow.w = screen.w\r\n\tmainWindow.h = screen.h\r\n  var customStyle = ui.AddStyle(\"╔═╗║ ║╚═╝\")\r\n  mainWindow.style = customStyle\r\n\r\n  for i = 0..3\r\n    titleButtonInit(titleX + titleButtonPos[i][0],titleButtonPos[i][1],readText(titleButtonText[i]))\r\n  titleButtonList[0].SetUp(startPressed)\r\n  titleButtonList[1].SetDown(diffPressed)\r\n  diffPanelInit()\r\n  titleButtonList[2].SetDown(levelPressed)\r\n  adjustLevel(nowDiff,0)\r\n  titleButtonList[3].SetDown(recordPressed)\r\n  recordPanelInit()\r\n  recordUpdate(-1,-1)\r\n\r\n  var title = ui.AddText()\r\n  mainWindow.Add(title)\r\n  title.x = titleX\r\n  title.y = titleY\r\n  title.ay = center\r\n  title.dy = center\r\n  title.w = titleW\r\n  title.h = titleH\r\n  title.text = string.Format(titleText)\r\n  title.color = #999999\r\n\r\n  buttonInit(buttonX + buttonPos[0][0],buttonPos[0][1],readText(delText[0]))\r\n  buttonList[0].w = 15\r\n  for i = 1..9\r\n    buttonInit(buttonX + buttonPos[i][0],buttonPos[i][1],i)\r\n  buttonInit(buttonX + buttonPos[buttonPos.Count()-1][0],buttonPos[buttonPos.Count()-1][1],readText(delText[1]))\r\n  buttonList[buttonList.Count()-1].w = 15\r\n  //buttonList[buttonList.Count()-1].SetDown(startPressed)\r\n\r\nfunc loopEvent()\r\n  ?boardFlashTime > 0\r\n    boardFlashPlay()\r\n    ?dt(boardFlashTime) = boardFlashFrame * 9 & boardFlashDirection = 1\r\n      ?sudoCore.mainWindow.visible = false \r\n        sudoCore.mainWindow.visible = true\r\n        mainWindow.visible = false\r\n      :\r\n        sudoCore.mainWindow.visible = false\r\n        mainWindow.visible = true\r\n  ?sudoCore.vectory = 1 \r\n    ?sudoCore.dt(sudoCore.vectoryTime) = 45\r\n      adjustLevel(nowDiff,nowLevel+1)\r\n      recordUpdate(nowDiff,dt(startTime))\r\n      boardFlashStart()\r\n\r\n\r\n\r\nfunc titleButtonInit(x_,y_,i_)\r\n  var button_ = ui.AddButton()\r\n  button_.style = 0\r\n  button_.x = x_\r\n  button_.y = y_\r\n  button_.w = 11\r\n  button_.h = 3\r\n  button_.text = string.Format(i_+\"\")\r\n  mainWindow.Add(button_)\r\n  titleButtonList.Add(button_)\r\n\r\n\r\nfunc buttonInit(x_,y_,i_)\r\n  var button_ = ui.AddButton()\r\n  button_.SetDown(numPressed)\r\n  button_.style = 4\r\n  button_.x = x_\r\n  button_.y = y_\r\n  button_.w = 5\r\n  button_.h = 3\r\n  button_.text = string.Format(i_+\"\")\r\n\r\n  mainWindow.Add(button_)\r\n  buttonList.Add(button_)\r\n\r\nfunc numPressed(btn)\r\n  var a\r\n\r\nfunc startPressed(btn)\r\n  adjustLevel(nowDiff,0)\r\n  boardFlashStart()\r\n  sudoCore.matInit(nowDiff,nowLevel)\r\n  startTime = totaltime - boardFlashFrame * 18 - 45\r\n\r\nfunc diffPanelInit()\r\n  diffPanel = ui.AddPanel()\r\n  mainWindow.Add(diffPanel)\r\n  diffPanel.w = 13\r\n\tdiffPanel.h = 5\r\n  diffPanel.x = titleX + titleButtonPos[1][0]\r\n  diffPanel.y = titleY + titleH/2 + diffPanel.h/2 + 1\r\n  diffPanel.style = ui.AddStyle(\"┼─┼│ │┼─┼\")\r\n  diffPanel.visible = false\r\n\r\n  for i =0..2\r\n    var button_ = ui.AddButton()\r\n    diffPanel.Add(button_)\r\n    button_.w = 11\r\n\t  button_.h = 1\r\n    button_.y = i-1\r\n    button_.style = 0\r\n    button_.text = readText(diffText[i])\r\n    button_.SetDown(diffChoicePressed)\r\n  \r\n  nowDiff = 1\r\n  titleButtonList[1].text = readText(titleButtonText[1]) + readText(diffText[1])\r\n\r\nfunc diffPressed(btn)\r\n  ?diffPanel.visible = false\r\n    diffPanel.visible = inherit\r\n  :\r\n    diffPanel.visible = false\r\n  \r\n\r\nfunc diffChoicePressed(btn)\r\n  for i = 0..2\r\n    ?string.Equals(btn.text,readText(diffText[i]))\r\n      nowDiff = i\r\n      titleButtonList[1].text = readText(titleButtonText[1]) + readText(diffText[i])\r\n  adjustLevel(nowDiff,0)\r\n\r\nfunc levelPressed(btn)\r\n var a\r\n\r\nfunc adjustLevel(diff_,level_)\r\n  nowLevel = storageLevel(diff_,level_)\r\n  titleButtonList[2].text = readText(titleButtonText[2]) + string.Format(nowLevel+\"\")\r\n\r\nfunc storageLevel(diff_,level_)\r\n  var levelKey = storageLevelKey[diff_]\r\n  ?storage.Has(levelKey)\r\n    var highLevel_ = storage.Get(levelKey)\r\n    ?highLevel_ >= level_\r\n      return highLevel_\r\n    :\r\n      ?level_ > 99\r\n        level_ = 99\r\n      storage.Set(levelKey,level_)\r\n      return level_\r\n  :\r\n    storage.Set(levelKey,0)\r\n    return 0\r\n\r\nfunc recordPanelInit()\r\n  recordText.Clear()\r\n  recordPanel = ui.AddPanel()\r\n  mainWindow.Add(recordPanel)\r\n  recordPanel.w = 13\r\n\trecordPanel.h = 5\r\n  recordPanel.x = titleX + titleButtonPos[3][0]\r\n  recordPanel.y = titleY + titleH/2 + recordPanel.h/2 + 1\r\n  recordPanel.style = ui.AddStyle(\"┼─┼│ │┼─┼\")\r\n  recordPanel.visible = false\r\n\r\n  for i =0..2\r\n    var text_ = ui.AddText()\r\n    recordPanel.Add(text_)\r\n    text_.w = 11\r\n\t  text_.h = 1\r\n    text_.y = i-1\r\n    recordText.Add(text_)\r\n\r\nfunc recordUpdate(diff_,time_)\r\n  var t\r\n  for i = 0..2\r\n    ?diff_ = i\r\n      t = storageTime(i,time_)\r\n    :\r\n      t = storageTime(i,-1)\r\n    ?t >= 0 \r\n      ?t > 299970\r\n        t = 299970\r\n      recordText[i].text = string.Format(readText(diffText[i]) +\":\"+ t/30+\"s\")\r\n    :\r\n      recordText[i].text = readText(diffText[i]) +\":--s\"\r\n\r\nfunc storageTime(diff_,time_)\r\n  var timeKey = storageTimeKey[diff_]\r\n  ?storage.Has(timeKey) & ((time >=0 & storage.Get(timeKey) <= time_) | time_ < 0)\r\n    return storage.Get(timeKey)\r\n  :\r\n    ?time_ >=0\r\n      storage.Set(timeKey,time_)\r\n    return time_\r\n\r\nfunc recordPressed(btn)\r\n  ?recordPanel.visible = false\r\n    recordPanel.visible = inherit\r\n  :\r\n    recordPanel.visible = false\r\n\r\nfunc boardFlashStart()\r\n  boardFlashCanvas = ui.AddCanvas()\r\n  boardFlashCanvas.w = screen.w\r\n  boardFlashCanvas.h = screen.h\r\n  boardFlashCanvas.blend = Add\r\n  boardFlashTime = totaltime + 3\r\n  boardFlashDirection = 1\r\n\r\nfunc boardFlashPlay()\r\n  var f = boardFlashFrame\r\n  var f1 = f*3\r\n  var f2 = f*9\r\n\r\n  ?boardFlashDirection = 1\r\n    ?dt(boardFlashTime) % f = 0\r\n      for x_ = 0..screen.w\r\n        ?(x_ % 3) = math.floor((dt(boardFlashTime) % f1) / f)\r\n          for y_ = 0..screen.h\r\n            ?(y_ % 3) = math.floor((dt(boardFlashTime) % f2) / f1)\r\n              boardFlashCanvas.SetBG(x_,y_, #FFFFFF)\r\n              play stone_throw_hit\r\n    ?dt(boardFlashTime) > f2\r\n      boardFlashTime = totaltime + 3\r\n      boardFlashDirection = -1\r\n\r\n  :?boardFlashDirection = -1\r\n    ?dt(boardFlashTime) % f = 0\r\n      for x_ = 0..screen.w\r\n        ?(x_ % 3) = math.floor((dt(boardFlashTime) % f1) / f)\r\n          for y_ = 0..screen.h\r\n            ?(y_ % 3) = math.floor((dt(boardFlashTime) % f2) / f1)\r\n              boardFlashCanvas.SetBG(x_,y_, #000000)\r\n              play stone_throw_hit\r\n    ?dt(boardFlashTime) > f2 + 10\r\n      boardFlashTime = 0\r\n      boardFlashDirection = 0\r\n      boardFlashCanvas.Recycle()\r\n\r\nfunc dt(time_)\r\n  return (totaltime - time_)\r\n\r\n\r\nfunc readText(textList)\r\n  ?te.language = \"ZH-CN\" | te.language = \"ZH-TW\"\r\n    return textList[1]\r\n  :\r\n    return textList[0]\r\n  \r\n\r\n\r\nvar titleText = ascii\r\n╔═══╤═══╤═══╦═══╤═══╤═══╦═══╤═══╤═══╦═══╤═══╤═══╗\r\n║  █████| █ ║  █| ████  ║ ██|█  |█  ║ █ |█  | █ ║\r\n╟─█─┼───┼─█─╫──█┼─█─┼─█─╫█──┼─█─┼█──╫█──┼█──┼─█─╢\r\n║█  |   | █ ║  █| █ |  █║█  | █ |█  █   |█  | █ ║\r\n╟▓█─┼───┼─█─╫──█┼─█─┼──█╫█──┼─█─┼███║───┼█──┼─█─╢\r\n║ ▓████ | █ ║  █| █ |  █║█  | █ |██ ║   |█  | █ ║\r\n╠═══╪═█▓╪═█═╬══▓╪═█═╪══▓╬█══╪═▓═╪█═█╬═══╪█══╪═▓═╣\r\n║   | █▓| █ ║  ▓| █ |  ▓║█  | ▓ |█  ▓   |█  | ▓ ║\r\n╟───┼─▓─┼─█─╫──▓┼─█─┼─▓─╫█──┼─▓─┼█──╫▓──┼█──┼─▓─╢\r\n║▓██▓▓  |  █║█▓ | ██▓▓  ║ ██|▓  |█  ║ ▓ | ██|▓  ║\r\n╟───┴───┴───╫───┴───┴───╫───┴───┴───╫───┴───┴───╢\r\n║###########║###########║###########║###########║\r\n╚═══════════╩═══════════╩═══════════╩═══════════╝\r\nasciiend\r\n\r\nvar musicList = [rocky_plateau_0,rocky_plateau_1,rocky_plateau_2,rocky_plateau_3,rocky_plateau_4]\r\nvar mainWindow\r\nvar buttonList = []\r\nvar buttonX = 25\r\nvar buttonPos = [[0,3],[-5,-6],[0,-6],[5,-6],[-5,-3],[0,-3],[5,-3],[-5,0],[0,0],[5,0],[0,6]]\r\n\r\nvar titleButtonList = []\r\nvar titleButtonPos = [[-18,5],[-6,5],[6,5],[18,5]]\r\nvar titleButtonText = [\r\n[\"Start!\",\"开始！\"],\r\n[\"Diff:\",\"难度:\"],\r\n[\"LV:\",\"关卡:\"],\r\n[\"Record\",\"记录\"]\r\n]\r\n\r\nvar nowDiff = 0\r\nvar nowLevel = 0\r\nvar diffPanel\r\nvar diffText = [\r\n[\"Easy\",\"简单\"],\r\n[\"Norm\",\"普通\"],\r\n[\"Hard\",\"困难\"]\r\n]\r\nvar storageLevelKey=[\"SudokuHighLevel_0\",\"SudokuHighLevel_1\",\"SudokuHighLevel_2\"]\r\nvar storageTimeKey=[\"SudokuFastTime_0\",\"SudokuFastTime_1\",\"SudokuFastTime_2\"]\r\nvar recordPanel\r\nvar recordText = []\r\nvar startTime = 0\r\n\r\nvar delText = [\r\n[\"Delete\",\"删除\"],\r\n[\"Verify\",\"验证\"]\r\n]\r\n\r\nvar boardFlashCanvas\r\nvar boardFlashTime = -1\r\nvar boardFlashDirection = 0\r\nvar boardFlashFrame = 5\r\n\r\n\r\nvar titleX = -10\r\nvar titleY = 0\r\nvar titleW = 49\r\nvar titleH = 13\r\n\r\nvar sudoCore = import Games/Sudoku/SudokuCore"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Sudoku/SudokuCore.txt" - Parse error: Failed to parse completely. Remaining: "(\"╔═╗║ ║╚═╝\")\r\n  mainWindow.style = customStyle\r\n\r\n  sudoWindowInit()\r\n\r\n  buttonInit(buttonX + buttonPos[0][0],buttonPos[0][1],readText(delText))\r\n  buttonList[0].w = 15\r\n  for i = 1..9\r\n    buttonInit(buttonX + buttonPos[i][0],buttonPos[i][1],i)\r\n  buttonInit(buttonX + buttonPos[buttonPos.Count()-1][0],buttonPos[buttonPos.Count()-1][1],readText(verifyText))\r\n  buttonList[buttonList.Count()-1].w = 15\r\n  buttonList[buttonList.Count()-1].SetDown(verifyPressed)\r\n  \r\n  for i = 0..8\r\n    var sudoNum_ = []\r\n    for j = 0..8\r\n      posX = (i*4+2)\r\n      posY = (j*2+1)\r\n      sudoNumInit(sudoNum_,posX,posY)\r\n    sudoNum.Add(sudoNum_)\r\n  matInit(0,0)\r\n\r\n  noteInit()\r\n\r\nfunc sudoWindowInit()\r\n\r\n  sudoWindow = ui.AddPanel()\r\n  mainWindow.Add(sudoWindow)\r\n  sudoWindow.clip = true\r\n  sudoWindow.x = sudoX\r\n  sudoWindow.y = sudoY\r\n  sudoWindow.anchor = center_center\r\n  sudoWindow.dock = center_center\r\n\tsudoWindow.w = sudoW\r\n\tsudoWindow.h = sudoH\r\n\r\n  var sudoWindowText_ = ui.AddText()\r\n  sudoWindow.Add(sudoWindowText_)\r\n  sudoWindowText_.x = 0\r\n  sudoWindowText_.y = 0\r\n  sudoWindowText_.ay = center\r\n  sudoWindowText_.dy = center\r\n  sudoWindowText_.w = sudoW\r\n  sudoWindowText_.h = sudoH\r\n  sudoWindowText_.text = string.Format(sudoWindowText)\r\n  sudoWindowText_.color = #999999\r\n\r\n  sudoAnim = ui.AddAnim(sudoAnimText)\r\n  sudoWindow.Add(sudoAnim)\r\n  sudoAnim.duration = 30\r\n  sudoAnim.loop = true\r\n  sudoAnim.color = #FF0000\r\n  sudoAnim.Play()\r\n  sudoAnim.dock = top_left\r\n  sudoAnim.w = 3\r\n  sudoAnim.h = 1\r\n  sudoAnim.x = -1\r\n  sudoAnim.y = -1\r\n  \r\n\r\nfunc sudoNumInit(sudoNum_,x_,y_)\r\n  var sudoNumText_ = ui.AddText()\r\n  sudoNumText_.x = x_\r\n  sudoNumText_.y = y_\r\n\tsudoNumText_.w = 3\r\n\tsudoNumText_.h = 1\r\n\tsudoNumText_.align = center\r\n  sudoNumText_.dock = top_left\r\n\r\n\tsudoWindow.Add(sudoNumText_)\r\n  sudoNum_.Add(sudoNumText_)\r\n  \r\n\r\nfunc loopEvent()\r\n  ?key = primaryEnd\r\n    ifEvent = true\r\n    posX = (input.x - screen.w/2 + sudoW/2 - sudoX)\r\n    posY = (input.y - screen.h/2 + sudoH/2 - sudoY)\r\n    ?posX/4 >= 0 & posX/4 < 9 & posY/2 >= 0 & posY/2 < 9 & posX%4 ! 0 & posY%2 ! 0\r\n      clickX = posX/4\r\n      clickY = posY/2\r\n      ?!string.Equals(sudoNum[clickX][clickY].text,\"\")\r\n        highLightNum = int.Parse(sudoNum[clickX][clickY].text)\r\n      ?ifReadOnly(sudoNum[clickX][clickY].color)\r\n        resetClick()\r\n    :?clickX_ >= 0 & clickY_ >= 0 \r\n      buttonClick()\r\n    :\r\n      resetClick()\r\n      highLightNum = -1\r\n\r\nfunc loopPrint()\r\n  ?ifEvent\r\n    ifEvent = false\r\n    ?clickX < 0 & clickY < 0\r\n      sudoAnim.x = -1\r\n      sudoAnim.y = -1\r\n    :\r\n      sudoAnim.x = clickX*4+2\r\n      sudoAnim.y = clickY*2+1\r\n    for i = 0..8\r\n      for j = 0..8\r\n        ?string.Equals(sudoNum[i][j].text,highLightNum+\"\")\r\n          ?ifReadOnly(sudoNum[i][j].color)\r\n            sudoNum[i][j].color = colorReadOnly[1]\r\n          :\r\n            sudoNum[i][j].color = colorEdit[1]\r\n        :\r\n          ?ifReadOnly(sudoNum[i][j].color)\r\n            sudoNum[i][j].color = colorReadOnly[0]\r\n          :\r\n            sudoNum[i][j].color = colorEdit[0]\r\n\r\n  ?vectory = 0\r\n    vectoryTime = totaltime\r\n  :?vectory = -1\r\n    ?dt(vectoryTime) = 1\r\n      play error\r\n      buttonList[buttonList.Count()-1].text = readText(errorText)\r\n      buttonList[buttonList.Count()-1].bcolor = #FF0000\r\n      buttonList[buttonList.Count()-1].tcolor = #FF0000\r\n    :?dt(vectoryTime) > 60\r\n      buttonList[buttonList.Count()-1].text = readText(verifyText)\r\n      buttonList[buttonList.Count()-1].bcolor = #7F7F7F\r\n      buttonList[buttonList.Count()-1].tcolor = #FFFFFF\r\n      vectory = 0\r\n  :?vectory = 1\r\n    ?dt(vectoryTime) = 1\r\n      play ui_starnew\r\n      buttonList[buttonList.Count()-1].text = readText(successText)\r\n      buttonList[buttonList.Count()-1].bcolor = #00FF00\r\n      buttonList[buttonList.Count()-1].tcolor = #00FF00\r\n    :?dt(vectoryTime) > 180\r\n      buttonList[buttonList.Count()-1].text = readText(verifyText)\r\n      buttonList[buttonList.Count()-1].bcolor = #7F7F7F\r\n      buttonList[buttonList.Count()-1].tcolor = #FFFFFF\r\n      vectory = 0\r\n\r\nfunc buttonInit(x_,y_,i_)\r\n  var button_ = ui.AddButton()\r\n  button_.SetDown(numPressed)\r\n  button_.style = 4\r\n  button_.x = x_\r\n  button_.y = y_\r\n  button_.w = 5\r\n  button_.h = 3\r\n  button_.text = string.Format(i_+\"\")\r\n\r\n  mainWindow.Add(button_)\r\n  buttonList.Add(button_)\r\n\r\nfunc numPressed(btn)\r\n  ?clickX >= 0 & clickX < 9 & clickY >= 0 & clickY < 9\r\n    ?string.Equals(btn.text,readText(delText))\r\n      sudoNum[clickX][clickY].text = string.Format(\"\")\r\n      highLightNum = -1\r\n    :\r\n      sudoNum[clickX][clickY].text = string.Format(btn.text)\r\n      highLightNum = int.Parse(btn.text)\r\n  clickX_ = clickX\r\n  clickY_ = clickY\r\n\r\nfunc verifyPressed(btn)\r\n  vectory = 0\r\n  var sudoArray = []\r\n  var sudoArray_ = []\r\n  for i = 0..8\r\n    for j = 0..8\r\n      ?string.Equals(sudoNum[i][j].text,\"\")\r\n        sudoMat[j][i] = 0\r\n        vectory = -1\r\n        i = 9\r\n        j = 9\r\n      :\r\n        sudoMat[j][i] = int.Parse(sudoNum[i][j].text)\r\n  ?vectory >= 0\r\n    for i = 0..8\r\n      sudoArray.Clear()\r\n      sudoArray_.Clear()\r\n      for j = 0..8\r\n        sudoArray.Add(sudoMat[j][i])\r\n        sudoArray_.Add(sudoMat[i][j])\r\n      sudoArray.Sort()\r\n      sudoArray_.Sort()\r\n      for v = 0..8\r\n        ?sudoArray[v] ! v+1 | sudoArray_[v] ! v+1\r\n          vectory = -1\r\n          i = 9\r\n          v = 9\r\n\r\n  ?vectory >= 0\r\n    for i = 0..2\r\n      for j = 0..2\r\n        sudoArray.Clear()\r\n        for i_ = 0..2\r\n          for j_ = 0..2\r\n            sudoArray.Add(sudoMat[3*i+i_][3*j+j_])\r\n        sudoArray.Sort()\r\n        for v = 0..8\r\n          ?sudoArray[v] ! v+1\r\n            vectory = -1\r\n            i = 3\r\n            j = 3\r\n            v = 9\r\n\r\n  ?vectory >= 0\r\n    vectory = 1\r\n  :\r\n    vectory = -1\r\n\r\nfunc noteInit()\r\n  noteButton = ui.AddButton()\r\n  mainWindow.Add(noteButton)\r\n  noteButton.SetDown(noteDown)\r\n  noteButton.SetUp(noteUp)\r\n  noteButton.style = 2\r\n  noteButton.dock = top_right\r\n  noteButton.anchor = top_right\r\n  noteButton.x = -1\r\n  noteButton.y = 1\r\n  noteButton.w = 5\r\n  noteButton.h = 3\r\n  noteButton.text = string.Format(\"?\")\r\n\r\n  noteTextPanel = ui.AddPanel()\r\n  mainWindow.Add(noteButton)\r\n  noteTextPanel.visible = false\r\n  var customStyle = ui.AddStyle(\"O_O▒ ▒O‾O\")\r\n  noteTextPanel.style = customStyle\r\n  noteTextPanel.dock = top_right\r\n  noteTextPanel.anchor = top_right\r\n  noteTextPanel.x = noteButton.x - noteButton.w\r\n  noteTextPanel.w = 42\r\n  noteTextPanel.h = 5\r\n\r\n  var noteText = ui.AddText()\r\n  noteTextPanel.Add(noteText)\r\n  noteText.text = readText(methodNote)\r\n  ?te.language = \"ZH-CN\" | te.language = \"ZH-TW\"\r\n    noteTextPanel.w = 28\r\n  noteText.w = noteTextPanel.w - 4\r\n  noteText.h = noteTextPanel.h - 2\r\n  \r\n\r\nfunc noteDown(btn)\r\n  noteTextPanel.visible = inherit\r\n  \r\nfunc noteUp(btn)\r\n  noteTextPanel.visible = false\r\n\r\nfunc matInit(diff_,level_)\r\n  var sudoStore = import Games/Sudoku/SudokuStore\r\n  var array_ = sudoStore.sudoMat[diff_][level_]\r\n  array2Mat(array_,sudoMat0)\r\n  sudoMat = sudoMat0\r\n\r\n  var n_ = 0\r\n  for i = 0..8\r\n    for j = 0..8\r\n      n_ = sudoMat0[j][i]\r\n      \r\n      ?n_ > 0 & n_ <=9\r\n        sudoNum[i][j].text = string.Format(n_+\"\")\r\n        sudoNum[i][j].color = colorReadOnly[0]\r\n      :\r\n        sudoNum[i][j].text = string.Format(\"\")\r\n        sudoNum[i][j].color = colorEdit[0]\r\n\r\nfunc array2Mat(array_,mat_)\r\n  var sudoLength = string.Size(array_)\r\n  ?sudoLength = 9*9\r\n    mat_.Clear()\r\n    var temp = \"\"\r\n    for i = 0 .. 8\r\n      temp = string.Sub(array_, i*9, 9)\r\n      var row_ = [] \r\n      for j = 0 .. 8 \r\n        row_.Add(int.Parse(string.Sub(temp, j, 1)))\r\n      mat_.Add(row_)\r\n\r\nfunc readText(textList)\r\n  ?te.language = \"ZH-CN\" | te.language = \"ZH-TW\"\r\n    return textList[1]\r\n  :\r\n    return textList[0]\r\n  \r\nfunc resetClick()\r\n  clickX = -1\r\n  clickY = -1\r\n  clickX_ = -1\r\n  clickY_ = -1\r\n\r\nfunc buttonClick()\r\n  clickX = clickX_\r\n  clickY = clickY_\r\n  clickX_ = -1\r\n  clickY_ = -1\r\n\r\nfunc dt(time_)\r\n  return (totaltime - time_)\r\n\r\nfunc ifReadOnly(color_)\r\n  for i = 0..1\r\n    ?color_ = colorReadOnly[i]\r\n      return true\r\n  return false\r\n\r\n\r\n\r\nvar sudoWindowText = ascii\r\n╔═══╤═══╤═══╦═══╤═══╤═══╦═══╤═══╤═══╗\r\n║   |   |   ║   |   |   ║   |   |   ║\r\n╟───┼───┼───╫───┼───┼───╫───┼───┼───╢\r\n║   |   |   ║   |   |   ║   |   |   ║\r\n╟───┼───┼───╫───┼───┼───╫───┼───┼───╢\r\n║   |   |   ║   |   |   ║   |   |   ║\r\n╠═══╪═══╪═══╬═══╪═══╪═══╬═══╪═══╪═══╣\r\n║   |   |   ║   |   |   ║   |   |   ║\r\n╟───┼───┼───╫───┼───┼───╫───┼───┼───╢\r\n║   |   |   ║   |   |   ║   |   |   ║\r\n╟───┼───┼───╫───┼───┼───╫───┼───┼───╢\r\n║   |   |   ║   |   |   ║   |   |   ║\r\n╠═══╪═══╪═══╬═══╪═══╪═══╬═══╪═══╪═══╣\r\n║   |   |   ║   |   |   ║   |   |   ║\r\n╟───┼───┼───╫───┼───┼───╫───┼───┼───╢\r\n║   |   |   ║   |   |   ║   |   |   ║\r\n╟───┼───┼───╫───┼───┼───╫───┼───┼───╢\r\n║   |   |   ║   |   |   ║   |   |   ║\r\n╚═══╧═══╧═══╩═══╧═══╧═══╩═══╧═══╧═══╝\r\nasciiend\r\n\r\nvar sudoAnimText = ascii\r\n[#]\r\n%%\r\n###\r\nasciiend\r\n\r\nvar delText = [\"Delete\",\"删除\"]\r\nvar verifyText = [\"Verify\",\"验证\"]\r\nvar errorText = [\"Error!\",\"错误！\"]\r\nvar successText = [\"Success!\",\"完成！\"]\r\n\r\nvar methodNote = [\r\n\"A Sudoku! Fill the panel and maintain the uniqueness of the number in each row, column, and grid.\",\r\n\"这看上去像是一个数独！\\n填满面板并保持每个行、列和大格中数字的独特性。\"\r\n]\r\n\r\nvar sudoMat0 = [\r\n[8,3,9,6,5,7,2,1,4],\r\n[6,7,2,9,4,1,5,8,3],\r\n[1,5,4,8,3,2,9,6,7],\r\n[5,4,1,2,8,3,7,9,6],\r\n[2,8,7,4,9,6,3,5,1],\r\n[9,6,3,7,1,5,4,2,8],\r\n[7,1,8,3,2,9,6,4,5],\r\n[3,2,5,1,6,4,8,0,9],\r\n[4,9,6,5,7,8,1,3,0]\r\n]\r\nvar sudoMat = sudoMat0\r\n\r\nvar mainWindow\r\n\r\nvar sudoWindow\r\nvar clickX = -1\r\nvar clickY = -1\r\nvar clickX_ = -1\r\nvar clickY_ = -1\r\nvar ifEvent = false\r\n\r\nvar sudoX = -10\r\nvar sudoY = 0\r\nvar sudoW = 37\r\nvar sudoH = 19\r\nvar posX\r\nvar posY\r\n\r\nvar sudoNum = []\r\nvar colorReadOnly = [#27AE60,#FF008F]\r\nvar colorEdit = [#FFFFFF,#FF5A49]\r\nvar highLightNum = -1\r\nvar sudoAnim\r\n\r\nvar noteButton\r\nvar noteTextPanel\r\n\r\nvar vectory = 0\r\nvar vectoryTime\r\n\r\nvar buttonList = []\r\nvar buttonX = 20\r\nvar buttonPos = [[0,3],[-5,-6],[0,-6],[5,-6],[-5,-3],[0,-3],[5,-3],[-5,0],[0,0],[5,0],[0,6]]\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/WhackaMole.txt" - Parse error: Failed to parse completely. Remaining: "! waterfall | totaltime > 1\r\n    initialized = -1\r\n\r\n\r\n?initialized = 0\r\n\r\n  //*******************************\r\n  //** GLOBAL VARIABLES\r\n  //*******************************\r\n\r\n  var dynamic_screen = true //dynamic screen adjustment\r\n  var gamelayout = 0\r\n  var assist = 0\r\n  var gametime = 30\r\n  var anmtime = 40\r\n  var rngtime = 0\r\n  var easyanmtime = 60\r\n  var easyrngtime = 60\r\n  var medanmtime  = 40\r\n  var medrngtime  = 20\r\n  var hardanmtime = 40\r\n  var hardrngtime = 10 \r\n  var misspenalty = -10\r\n  var hitsound = smithy_hammer\r\n  var hitpitch = 150\r\n  var misssound = \r\n      ^smithy_hammer_fail\r\n  var misspitch = 150\r\n  var moleupsound = \r\n      ^haunted_gate_shuffle_fast\r\n  var moleuppitch = 100\r\n  var easydesc = \r\n      ^＂Plenty of time to spot ＂\r\n      ^+＂the mole\\nand line up ＂\r\n      ^+＂a good 'Whack'!\\n＂\r\n      ^+＂［Missed moles don't ＂\r\n      ^+＂count against you.］＂\r\n  var meddesc = \r\n      ^＂Moles come one after ＂\r\n      ^+＂another.\\nExcellent ＂\r\n      ^+＂for practicing.\\n＂\r\n      ^+＂［Missed moles subtract ＂\r\n      ^+＂10 points each.］＂\r\n  var harddesc =\r\n      ^＂Moles appear in rapid ＂\r\n      ^+＂fire.\\nHit moles in order＂\r\n      ^+＂ or risk missing one!\\n＂\r\n      ^+＂［Missed moles subtract ＂\r\n      ^+＂20 points each!］＂\r\n\r\n  var molestate = ［0,0,0,0,0,0,0,0,0,0］\r\n  var playing = 0\r\n  var timer = 0\r\n  var timerstr = ＂000＂\r\n  var score = 0\r\n  var scorestr = ＂000＂\r\n  var instrstr = ＂MASH!\\nMASH!＂\r\n  var starttime = time.msbn\r\n  var deltatime = time.msbn\r\n  var deltasecs = 0\r\n  var mframe\r\n  var finishing = 0\r\n  var screenw = screen.w\r\n  var screenh = screen.h\r\n  var dimx = 0\r\n  var dimy = 0\r\n  var dimw = screenw\r\n  var dimh = screenh\r\n\r\n\r\n  //*******************************\r\n  // ASCII Art\r\n  //*******************************\r\n\r\n  var bear = ascii\r\n####_\r\n(‾;:_)\r\n│   ..\r\n`_   T\r\n¡ . ‾;¡\r\n│ ¡  ｝;-..\r\n! ; ‾‾. !!\r\n#‾#‾‾‾#‾‾\r\nasciiend\r\n\r\n  var ball = ascii\r\n .'´:'·\r\n:`·.·.´:\r\n:.·'·'·:\r\n#·,_;_.'\r\nasciiend\r\n\r\n  var ball1 = ascii\r\n\r\n\r\n#.·\r\n#·,_;\r\nasciiend\r\n\r\n  var ball2 = ascii\r\n\r\n######´:\r\n######·:\r\n\r\nasciiend\r\n\r\n  var ball3 = ascii\r\n#.'´:\r\n#`·\r\n\r\n\r\nasciiend\r\n\r\n  var balloon = ascii\r\n#.·¯¯¯·.\r\n·     ;.·\r\n│     `!│\r\n'       '\r\n#`.   .´ \r\n###·.·\r\n####∞\r\n####│`,\r\n####│#;\r\n####│#'\r\n####│\r\n####│\r\n####│\r\n####│\r\n####│\r\n####│\r\n####│\r\n####│\r\n####│\r\n####│\r\n###_∞_\r\n##｛.;:｝\r\n###‾‾‾\r\nasciiend\r\n\r\n  var llamawscarf = ascii\r\n;'.-.':\r\n`.•_•.´\r\n#¡'='¡\r\n#!   !\r\n#;;~~:\r\nasciiend\r\n\r\n  var fox = ascii\r\n¡\\-/¡\r\n:^ ^;\r\n,\\./,\r\nn·-·n\r\nasciiend\r\n\r\n  var mole = ascii\r\n\r\n\r\n\r\n\r\n\r\n%%\r\n\r\n\r\n# …-… \r\n#:• •:\r\n\r\n%%\r\n\r\n# …-… \r\n#:• •:\r\n#:>•<:\r\n\r\n%%\r\n# …-… \r\n#:• •:\r\n#:>•<:\r\n#m   m\r\n\r\n%%\r\n# …-… \r\n#:• •:\r\n#:>•<:\r\n#m   m\r\n\r\n%%\r\n# …-… \r\n#:• •:\r\n#:>•<:\r\n#m   m\r\n\r\n%%\r\n# …-… \r\n#:• •:\r\n#:>•<:\r\n#m   m\r\n\r\n%%\r\n\r\n# …-… \r\n#:• •:\r\n#:>•<:\r\n\r\n%%\r\n\r\n\r\n# …-… \r\n#:• •:\r\n\r\n%%\r\n\r\n\r\n\r\n\r\n\r\nasciiend\r\n\r\n\r\n  var gameboard = ascii\r\n.~.´^`~._.~´^`~._.~´^`~._.~´^`~._.~´^`.~.\r\n║/│     )~TIMER~(       )~SCORE~(     │\\║\r\n║ │     ｛  000  ｝       ｛  000  ｝     │ ║\r\n║ ├───────────────────────────────────┤ ║\r\n║/│)(         )(         )(         )(│\\║\r\n║ │()  ｛   ｝  ()  ｛   ｝  ()  ｛   ｝  ()│ ║\r\n║ │)(         )(         )(         )(│ ║\r\n║ │() .─────. () .─────. () .─────. ()│ ║\r\n║ │)( `─────´ )( `─────´ )( `─────´ )(│ ║\r\n║ │~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~│ ║\r\n║/│)(         )(         )(         )(│\\║\r\n║ │()  ｛   ｝  ()  ｛   ｝  ()  ｛   ｝  ()│ ║\r\n║ │)(         )(         )(         )(│ ║\r\n║ │() .─────. () .─────. () .─────. ()│ ║\r\n║ │)( `─────´ )( `─────´ )( `─────´ )(│ ║\r\n║ │~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~│ ║\r\n║/│)(         )(         )(         )(│\\║\r\n║ │()  ｛   ｝  ()  ｛   ｝  ()  ｛   ｝  ()│ ║\r\n║ │)(         )(         )(         )(│ ║\r\n║ │() .─────. () .─────. () .─────. ()│ ║\r\n║ │)( `─────´ )( `─────´ )( `─────´ )(│ ║\r\n║ ├───────────────────────────────────┤ ║\r\n║/                                     \\║\r\n║                                       ║\r\n╫───────────────────────────────────────╫\r\n║.~´^`~._.~´^`~._.~´^`~._.~´^`~._.~´^`~.║\r\n║                                       ║\r\nasciiend\r\n\r\n\r\n\r\n  var boardlights = ascii\r\n)(#########)(#########)(#########)(\r\n()#########()#########()#########()\r\n)(#########)(#########)(#########)(\r\n()#########()#########()#########()\r\n)(#########)(#########)(#########)(\r\n()~~~~~~~~~()~~~~~~~~~()~~~~~~~~~()\r\n)(#########)(#########)(#########)(\r\n()#########()#########()#########()\r\n)(#########)(#########)(#########)(\r\n()#########()#########()#########()\r\n)(#########)(#########)(#########)(\r\n()~~~~~~~~~()~~~~~~~~~()~~~~~~~~~()\r\n)(#########)(#########)(#########)(\r\n()#########()#########()#########()\r\n)(#########)(#########)(#########)(\r\n()#########()#########()#########()\r\n)(#########)(#########)(#########)(\r\nasciiend\r\n\r\n  var sign1 = ascii\r\n┊#############################┊\r\n║´¯¯¯`~·._.·~´¯¯¯`~·._.·~´¯¯¯`║\r\n╠═════════════════════════════╣\r\n║:::~´ . . . .  _   _ .  `~:::║\r\n║:>´   \\^/ │─│ /─\\ (_ │<   `<:║\r\n║｛     _     .   _  .   _    ｝║\r\n║:>.  /─\\ ─ /v\\ ( ) │  │─  .<:║\r\n║:::~.' '   ' '  ‾   ‾  ‾.~:::║\r\n╠═════════════════════════════╣\r\n'.___.~·´¯`·~.___.~·´¯`·~.___.'\r\nasciiend\r\n\r\n  var sign2 = ascii\r\n . . . .  _   _ .\r\n \\^/ │─│ /─\\ (_ │<\r\n _     .   _  .   _\r\n/─\\ ─ /v\\ ( ) │  │─\r\n' '   ' '  ‾   ‾  ‾\r\nasciiend\r\n\r\n  var sign3 = ascii\r\n###~´###################`~\r\n#>´#######################`<\r\n｛###########################｝\r\n#>.#######################.<\r\n###~.###################.~\r\nasciiend\r\n\r\n  var trspstyl = ui.AddStyle(＂\r\n^###\r\n^###\r\n^###＂)\r\n\r\n\r\n  //*******************************\r\n  // Component Parameters\r\n  //*******************************\r\n\r\n  var blankpnl\r\n  var blankpnl_params = ［\r\nblankpnl,\r\ncenter_center,\r\ncenter_center,\r\n0,0,screen.w,screen.h,\r\ntrue,0,#888888,1］\r\n\r\n  var gamepnl\r\n  var gamepnl_params = ［\r\ngamepnl,\r\ncenter_center,\r\ncenter_center,\r\n0,0,screenw,screenh,\r\nfalse,trspstyl,#888888,true］\r\n\r\n  var board1anim\r\n  var board2anim\r\n  var board3anim\r\n  var boardanim_params = ［\r\nboard1anim,\r\ngameboard,\r\ntop_center,\r\ntop_center,\r\n0,0,41,29,\r\ninherit,#white,\r\n0,0,true,true,\r\ntrue,1］\r\n\r\n  var balloonanim\r\n  var balloonanim_params = ［\r\nballoonanim,\r\nballoon,\r\ntop_center,\r\ntop_center,\r\n37,1,9,23,\r\ninherit,#00FF00,\r\n0,0,true,true,\r\ntrue,1］\r\n\r\n  var menupnl\r\n  var menupnl_params = ［\r\nmenupnl,\r\ntop_center,\r\ntop_center,\r\n-26,0,31,29,\r\ninherit,trspstyl,#888888,false］\r\n\r\n  var bearanim\r\n  var bearanim_params = ［\r\nbearanim,\r\nbear,\r\ntop_center,\r\ntop_center,\r\n-13,16,10,9,\r\ninherit,#EE99EE,\r\n0,0,true,true,\r\ntrue,1］\r\n\r\n  var ballpnl\r\n  var ballpnl_params = ［\r\nballpnl,\r\ntop_center,\r\ntop_center,\r\n-25,20,8,4,//12,20,8,4,\r\ntrue,trspstyl,#888888,1］\r\n\r\n  var ballanim\r\n  var ballanim_params = ［\r\nballanim,\r\nball,\r\ncenter_center,\r\ncenter_center,\r\n0,0,8,4,\r\ninherit,#yellow,\r\n0,0,true,true,\r\ntrue,1］\r\n\r\n  var ball1anim\r\n  var ball1anim_params = ［\r\nball1anim,\r\nball1,\r\ncenter_center,\r\ncenter_center,\r\n0,0,8,4,\r\ninherit,#FF0000,\r\n0,0,true,true,\r\ntrue,1］\r\n\r\n  var ball2anim\r\n  var ball2anim_params = ［\r\nball2anim,\r\nball2,\r\ncenter_center,\r\ncenter_center,\r\n0,0,8,4,\r\ninherit,#00FF00,\r\n0,0,true,true,\r\ntrue,1］\r\n\r\n  var ball3anim\r\n  var ball3anim_params = ［\r\nball3anim,\r\nball3,\r\ncenter_center,\r\ncenter_center,\r\n0,0,8,4,\r\ninherit,#00FFFF,\r\n0,0,true,true,\r\ntrue,1］\r\n\r\n  var signpnl\r\n  var signpnl_params = ［\r\nsignpnl,\r\ntop_center,\r\ntop_center,\r\n-3,0,31,10,\r\ninherit,trspstyl,#888888,1］\r\n\r\n  var sign1anim\r\n  var sign1anim_params = ［\r\nsign1anim,\r\nsign1,\r\ntop_center,\r\ntop_center,\r\n0,0,31,10,\r\ninherit,#A0522D,//#white,\r\n0,0,true,true,\r\ntrue,1］\r\n\r\n  var sign2anim\r\n  var sign2anim_params = ［\r\nsign2anim,\r\nsign2,\r\ntop_center,\r\ntop_center,\r\n0,3,19,5,\r\ninherit,#white,\r\n0,0,true,true,\r\ntrue,1］\r\n\r\n  var sign3anim\r\n  var sign3anim_params = ［\r\nsign3anim,\r\nsign3,\r\ntop_center,\r\ntop_center,\r\n0,3,29,5,\r\ninherit,#DAA520,//#FFD700,\r\n0,0,true,true,\r\ntrue,1］\r\n\r\n  var mbtnpnl\r\n  var mbtnpnl_params = ［\r\nmbtnpnl,\r\ntop_center,\r\ntop_center,\r\n-1,11,17,9,\r\ninherit,trspstyl,#888888,1］\r\n\r\n  var diffbtn\r\n  var diffbtn_params = ［\r\ndiffbtn,\r\ntop_center,\r\ntop_center,\r\n0,0,17,3,\r\ninherit,＂GAME DIFFICULTY＂,#white,\r\n#888888,#880000,\r\ntorch_idle,\r\n3,1,DiffBtnPress］\r\n\r\n  var modebtn\r\n  var modebtn_params = ［\r\nmodebtn,\r\ntop_center,\r\ntop_center,\r\n0,3,17,3,\r\ninherit,＂GAME MODE＂,#888888,\r\n#888888,#880000,\r\ntorch_idle,\r\n3,1,ModeBtnPress］\r\n\r\n  var exitbtn\r\n  var exitbtn_params = ［\r\nexitbtn,\r\ntop_center,\r\ntop_center,\r\n0,6,17,3,\r\ninherit,＂LEAVE＂,#white,\r\n#888888,#880000,\r\ntorch_idle,\r\n3,1,ExitBtnPress］\r\n\r\n  var menubtn\r\n  var menubtn_params = ［\r\nmenubtn,\r\ntop_right,\r\ntop_right,\r\n0,0,5,3,\r\nfalse,＂←＂,#white,\r\n#888888,#008888,\r\ntorch_idle,\r\n3,1,MenuBtnPress］\r\n\r\n  var boardpnl\r\n  var boardpnl_params = ［\r\nboardpnl,\r\ntop_center,\r\ntop_center,\r\n10,0,41,29,\r\ninherit,trspstyl,#888888,false］\r\n\r\n  var lightsanim\r\n  var lightsanim2\r\n  var lightsanim_params = ［\r\nlightsanim,\r\nboardlights,\r\ntop_center,\r\ntop_center,\r\n0,4,35,17,\r\ninherit,#white,\r\n0,0,true,true,\r\ntrue,1］\r\n\r\n  var timertxt\r\n  var timertxt_params = ［\r\ntimertxt,\r\ntop_center,\r\ntop_center,\r\n-8,2,3,1,\r\ninherit,center,\r\n#red,timerstr］\r\n\r\n  var scoretxt\r\n  var scoretxt_params = ［\r\nscoretxt,\r\ntop_center,\r\ntop_center,\r\n8,2,3,1,\r\ninherit,center,\r\n#green,scorestr］\r\n\r\n  var molespnl\r\n  var molespnl_params = ［\r\nmolespnl,\r\ntop_center,\r\ntop_center,\r\n0,0,41,29,\r\ninherit,trspstyl,#888888,false］\r\n\r\n  var molepnl = ［\r\n0,0,0,0,0,0,0,0,0,0］\r\n  var molepnl_params = ［\r\nmolepnl,\r\ntop_center,\r\ntop_center,\r\n0,0,9,5,\r\ninherit,trspstyl,#888888,1］\r\n\r\n  var moletxt = ［\r\n0,0,0,0,0,0,0,0,0,0］\r\n  var moletxt_params = ［\r\nmoletxt,\r\ncenter_center,\r\ncenter_center,\r\n0,-1,5,1,\r\ninherit,center,\r\n#AAAAAA,＂｛   ｝＂］\r\n\r\n  var moleanm = ［\r\n0,0,0,0,0,0,0,0,0,0］\r\n  var moleanm_params = ［\r\nmoleanm,\r\nmole,\r\ncenter_center,\r\ncenter_center,\r\n0,0,7,5,\r\ninherit,#D2845F,\r\nanmtime,0,true,true,\r\nfalse,1］\r\n\r\n  var molebtn = ［\r\n0,0,0,0,0,0,0,0,0,0］\r\n  var molebtn_params = ［\r\nmolebtn,\r\ncenter_center,\r\ncenter_center,\r\n0,0,9,5,\r\nfalse,＂#＂,#white,\r\n#FFFF00,#880000,\r\ntorch_idle,\r\ntrspstyl,1,MoleBtnPress］\r\n\r\n  var startbtn\r\n  var startbtn_params = ［\r\nstartbtn,\r\ntop_center,\r\ntop_center,\r\n0,21,17,3,\r\ninherit,＂#＂,#red,\r\n#white,#000000,\r\nconfirm,\r\n4,2,StartBtnPress］\r\n\r\n  var instrtxt\r\n  var instrtxt_params = ［\r\ninstrtxt,\r\ntop_center,\r\ntop_center,\r\n0,22,21,2,\r\ninherit,center,\r\n#red,instrstr］\r\n\r\n  var diffpnl\r\n  var diffpnl_params = ［\r\ndiffpnl,\r\ncenter_center,\r\ncenter_center,\r\n10,0,41,22,\r\nfalse,3,#888888,1］\r\n\r\n  var easybtn\r\n  var easybtn_params = ［\r\neasybtn,\r\ntop_center,\r\ntop_center,\r\n0,1,17,3,\r\ninherit,＂EASY MODE＂,#green,\r\n#white,#green,\r\nconfirm,\r\n3,1,EasyBtnPress］\r\n\r\n  var easytxt\r\n  var easytxt_params = ［\r\neasytxt,\r\ntop_center,\r\ntop_center,\r\n0,4,41,3,\r\ninherit,center,\r\n#white,easydesc］\r\n\r\n  var medbtn\r\n  var medbtn_params = ［\r\nmedbtn,\r\ntop_center,\r\ntop_center,\r\n0,8,17,3,\r\ninherit,＂NORMAL MODE＂,#cyan,\r\n#white,#cyan,\r\nconfirm,\r\n3,1,MedBtnPress］\r\n\r\n  var medtxt\r\n  var medtxt_params = ［\r\nmedtxt,\r\ntop_center,\r\ntop_center,\r\n0,11,41,3,\r\ninherit,center,\r\n#white,meddesc］\r\n\r\n  var hardbtn\r\n  var hardbtn_params = ［\r\nhardbtn,\r\ntop_center,\r\ntop_center,\r\n0,15,17,3,\r\ninherit,＂HARD MODE＂,#red,\r\n#white,#red,\r\nconfirm,\r\n3,1,HardBtnPress］\r\n\r\n  var hardtxt\r\n  var hardtxt_params = ［\r\nhardtxt,\r\ntop_center,\r\ntop_center,\r\n0,18,41,3,\r\ninherit,center,\r\n#white,harddesc］\r\n\r\n\r\n\r\n  //*******************************\r\n  //** Initialization\r\n  //*******************************\r\n\r\n  disable hud\r\n  disable pause\r\n  disable abilities\r\n  disable loadout input\r\n  ambient.Stop()\r\n  equip shovel\r\n  equipR stone\r\n\r\n  DrawGame()\r\n  UpdateLayout()\r\n  MedBtnPress()\r\n  gamepnl.visible = true\r\n  initialized = 1\r\n//\r\n\r\n//*******************************\r\n//** Main\r\n//*******************************\r\n\r\n?initialized = 1\r\n//Classic Mode\r\n  ?dynamic_screen\r\n    UpdateLayout()\r\n  UpdatePlayBtn()\r\n  GenerateMole()\r\n  UpdateTimer()\r\n  UpdateMoles()\r\n  CheckFinished()\r\n//\r\n\r\n//*******************************\r\n//** Game Functions\r\n//*******************************\r\n\r\nfunc DiffBtnPress()\r\n  ?diffpnl.visible ! false\r\n    menupnl.visible = inherit\r\n    startbtn.visible = inherit\r\n    diffpnl.visible = false\r\n    molespnl.visible = inherit\r\n  :\r\n    QuickFinish()\r\n    ?gamelayout = 1\r\n      menupnl.visible = false\r\n    startbtn.visible = false\r\n    diffpnl.visible = inherit\r\n    molespnl.visible = false\r\n//\r\n\r\nfunc EasyBtnPress()\r\n  menupnl.visible = inherit\r\n  startbtn.visible = inherit\r\n  diffpnl.visible = false\r\n  anmtime = easyanmtime\r\n  rngtime = easyrngtime\r\n  for i=1..9\r\n    moleanm［i］.duration = anmtime\r\n    molebtn［i］.hcolor = #00AA00\r\n  lightsanim.color = #00FF00\r\n  score = 0\r\n  UpdateScore(0)\r\n  startbtn.visible = inherit\r\n  molespnl.visible = inherit\r\n//\r\n\r\nfunc MedBtnPress()\r\n  menupnl.visible = inherit\r\n  startbtn.visible = inherit\r\n  diffpnl.visible = false\r\n  anmtime = medanmtime\r\n  rngtime = medrngtime\r\n  for i=1..9\r\n    moleanm［i］.duration = anmtime\r\n    molebtn［i］.hcolor = #00AAAA\r\n  lightsanim.color = #00FFFF\r\n  score = 0\r\n  UpdateScore(0)\r\n  startbtn.visible = inherit\r\n  molespnl.visible = inherit\r\n//\r\n\r\nfunc HardBtnPress()\r\n  menupnl.visible = inherit\r\n  startbtn.visible = inherit\r\n  diffpnl.visible = false\r\n  anmtime = hardanmtime\r\n  rngtime = hardrngtime\r\n  for i=1..9\r\n    moleanm［i］.duration = anmtime\r\n    molebtn［i］.hcolor = #AA0000\r\n  lightsanim.color = #FF0000\r\n  score = 0\r\n  UpdateScore(0)\r\n  startbtn.visible = inherit\r\n  molespnl.visible = inherit\r\n//\r\n\r\nfunc ModeBtnPress()\r\n  >Under development: Future use\r\n//\r\n\r\nfunc ExitBtnPress()\r\n  loc.Leave()\r\n//\r\n\r\nfunc MenuBtnPress()\r\n  QuickFinish()\r\n  menupnl.visible = inherit\r\n  menubtn.visible = false\r\n  startbtn.y = 11\r\n  board3anim.color = #CCCCCC\r\n//\r\n\r\nfunc StartBtnPress()\r\n  ?gamelayout = 1\r\n    menupnl.visible = false\r\n    menubtn.visible = inherit\r\n    startbtn.y = 21\r\n    board3anim.color = #FFFFFF\r\n  molespnl.visible = inherit\r\n  playing = 1\r\n  startbtn.visible = false\r\n  timer = gametime\r\n  score = 0\r\n  UpdateScore(0)\r\n  starttime = time.msbn\r\n//\r\n\r\nfunc MoleBtnPress(btn)\r\n  var hit = 0\r\n  for i=1..9\r\n    ?btn = molebtn［i］\r\n      hit = 1\r\n      molebtn［i］.visible = false\r\n      moleanm［i］.frame = 0\r\n      moleanm［i］.Stop()\r\n      molestate［i］ = 0\r\n      UpdateScore(20)\r\n  ?hit = 1\r\n    play @hitsound@ @hitpitch@\r\n  :\r\n    play @misssound@ @misspitch@\r\n//\r\n\r\nfunc GenerateMole()\r\n  var r = 1\r\n  ?(time % rngtime) = 0 & timer > 0\r\n    r = 1 + rng % (9 - 1 + 1)\r\n\r\n    ?molestate［r］ < 1\r\n      molestate［r］ = 1\r\n      moleanm［r］.Play()\r\n      molebtn［r］.visible = inherit\r\n      play @moleupsound@ @moleuppitch@\r\n//\r\n\r\nfunc UpdateTimer()\r\n  ?timer > 0\r\n    deltatime = time.msbn\r\n    deltatime.Sub(starttime)\r\n    deltatime.Div(1000)\r\n\r\n    deltasecs = int.Parse(deltatime.ToString())\r\n    timer = gametime - deltasecs\r\n\r\n  UpdateGameTimer()\r\n//\r\n\r\nfunc UpdateGameTimer()\r\n  ?timer < 0\r\n    timer = 0\r\n  :?timer > 999\r\n    timer = 999\r\n  \r\n  ?timer >= 100\r\n    timerstr = ＂＂ + timer\r\n  :?timer >= 10\r\n    timerstr = ＂0＂ + timer\r\n  :?timer >= 1\r\n    timerstr = ＂00＂ + timer\r\n  :\r\n    timerstr = ＂000＂\r\n \r\n  timertxt.text = timerstr\r\n//\r\n\r\nfunc UpdateGameDiff(delta)\r\n  var t = 0.0\r\n  var t1 = 0.0\r\n  var t2 = 0.0\r\n\r\n  ?delta < (gametime / 2)\r\n    anmtime = anmmaxtimer\r\n    rngtime = rngmaxtimer\r\n :\r\n    t = deltasecs + (gametime/8.0)\r\n    t = t - (gametime/2.0)\r\n    t = t / (gametime/2.0)\r\n\r\n    t1 = (anmmaxtimer - anmmintimer) * t\r\n    t1 = anmmaxtimer - t1\r\n    t1 = math.CeilToInt(t1)\r\n    ?t1 < anmmintimer\r\n      t1 = anmmintimer\r\n    nextanmtime = t1\r\n    \r\n    t2 = (rngmaxtimer - rngmintimer) * t\r\n    t2 = rngmaxtimer - t2\r\n    t2 = math.CeilToInt(t2)\r\n    ?t2 < rngmintimer\r\n      t2 = rngmintimer\r\n    nextrngtime = t2\r\n//\r\n\r\nfunc UpdateGameTime()\r\n  var moleup = 0\r\n  ?playing = 1\r\n    for i=1..9\r\n      ?molestate［i］ > 0\r\n        moleup = 1\r\n    ?moleup < 1\r\n      anmtime = nextanmtime\r\n      for i=1..9\r\n        moleanm［i］.duration = anmtime\r\n      rngtime = nextrngtime \r\n//\r\n\r\nfunc UpdateScore(points)\r\n  score = score + points\r\n  ?score < 0\r\n    score = 0\r\n  :?score > 999\r\n    score = 999\r\n  \r\n  ?score >= 100\r\n    scorestr = ＂＂ + score\r\n  :?score >= 10\r\n    scorestr = ＂0＂ + score\r\n  :?score >= 1\r\n    scorestr = ＂00＂ + score\r\n  :\r\n    scorestr = ＂000＂\r\n \r\n  scoretxt.text = scorestr\r\n//\r\n\r\nfunc UpdatePlayBtn()\r\n  ?playing = 1\r\n    instrstr = ＂MASH THE SCREEN\\n＂\r\n    ^+ ＂TO 'WHACK' YOUR MOLE!＂\r\n  :?playing = 2\r\n    instrstr = ＂＂\r\n    startbtn.text = ＂PLAY AGAIN!＂\r\n  :\r\n    instrstr = ＂＂\r\n    startbtn.text = ＂PLAY!＂\r\n\r\n  instrtxt.text = instrstr\r\n//\r\n\r\nfunc UpdateMoles()\r\n  for i=1..9\r\n    mframe = moleanm［i］.frame\r\n    ?mframe >= 9\r\n      ?molestate［i］ > 0\r\n        molestate［i］ = 0\r\n        UpdateScore(misspenalty)\r\n        play haunted_gate_point_lost 200\r\n      moleanm［i］.Stop()\r\n      molebtn［i］.visible = false\r\n//\r\n\r\nfunc CheckFinished()\r\n  finishing = 0\r\n  ?timer <= 0 & playing = 1\r\n    for i=1..9\r\n      ?molestate［i］ > 0\r\n        finishing = 1\r\n    ?finishing = 0\r\n      play treasure_item_show 100\r\n      playing = 2\r\n      UpdatePlayBtn()\r\n      startbtn.visible = inherit\r\n//\r\n\r\nfunc QuickFinish()\r\n  timer = 0\r\n  UpdateTimer()\r\n  score = 0\r\n  UpdateScore(0)\r\n  for i=1..9\r\n    molestate［i］ = 0\r\n    moleanm［i］.Stop()\r\n    moleanm［i］.frame = 9\r\n    molebtn［i］.visible = false\r\n    molespnl.visible = false\r\n    playing = 2\r\n    UpdatePlayBtn()\r\n    startbtn.visible = inherit\r\n//\r\n\r\n\r\n//*******************************\r\n//** UI Functions\r\n//*******************************\r\n\r\nfunc DrawPanel(parent,params)\r\n  ?loc.begin | loc.loop\r\n    var p = ui.AddPanel()\r\n    p.anchor = params［1］\r\n    p.dock = params［2］\r\n    p.x = params［3］\r\n    p.y = params［4］\r\n    p.w = params［5］\r\n    p.h = params［6］\r\n    p.visible = params［7］\r\n    p.style = params［8］\r\n    p.color = params［9］\r\n    p.clip = params［10］\r\n    parent.Add(p)\r\n    params［0］ = p\r\n    return p\r\n  return params［0］\r\n//\r\n\r\nfunc DrawText(parent,params)\r\n  ?loc.begin | loc.loop\r\n    var t = ui.AddText()\r\n    t.anchor = params［1］\r\n    t.dock = params［2］\r\n    t.x = params［3］\r\n    t.y = params［4］\r\n    t.w = params［5］\r\n    t.h = params［6］\r\n    t.visible = params［7］\r\n    t.align = params［8］\r\n    t.color = params［9］\r\n    t.text = params［10］\r\n    parent.Add(t)\r\n    params［0］ = t\r\n    return t\r\n  return params［0］\r\n//\r\n\r\nfunc DrawButton(parent,params)\r\n  ?loc.begin | loc.loop\r\n    var b = ui.AddButton()\r\n    b.anchor = params［1］\r\n    b.dock = params［2］\r\n    b.x = params［3］\r\n    b.y = params［4］\r\n    b.w = params［5］\r\n    b.h = params［6］\r\n    b.visible = params［7］\r\n    b.text = params［8］\r\n    b.tcolor = params［9］\r\n    b.bcolor = params［10］\r\n    b.hcolor = params［11］\r\n    b.sound = params［12］\r\n    b.style = params［13］\r\n    ?params［14］ = 2\r\n      b.SetDown(params［15］)\r\n    :?params［14］ = 3\r\n      b.SetUp(params［15］)\r\n    :\r\n      b.SetPressed(params［15］)\r\n    parent.Add(b)\r\n    params［0］ = b\r\n    return b\r\n  return params［0］\r\n//\r\n\r\nfunc DrawAnim(parent,params)\r\n  ?loc.begin | loc.loop\r\n    var a = ui.AddAnim(params［1］)\r\n    a.anchor = params［2］\r\n    a.dock = params［3］\r\n    a.x = params［4］\r\n    a.y = params［5］\r\n    a.w = params［6］\r\n    a.h = params［7］\r\n    a.visible = params［8］\r\n    a.color = params［9］\r\n    a.duration = params［10］\r\n    a.frame = params［11］\r\n    a.gamePause = params［12］\r\n    a.loop = params［13］\r\n    a.playOnStart = params［14］\r\n    ?params［15］ = 0\r\n      a.Stop()\r\n    :\r\n      a.Play()\r\n    parent.Add(a)\r\n    params［0］ = a\r\n    return a\r\n  return params［0］\r\n//\r\n\r\nfunc DrawColCanvas(parent,params)\r\n  ?loc.begin | loc.loop\r\n    var c = ui.AddCanvas()\r\n    c.anchor = params［1］\r\n    c.dock = params［2］\r\n    c.x = params［3］\r\n    c.y = params［4］\r\n    c.w = params［5］\r\n    c.h = params［6］\r\n    c.visible = params［7］\r\n    c.blend = params［8］\r\n    c.SetFG(params［9］)\r\n    c.SetBG(params［10］)\r\n    parent.Add(c)\r\n    params［0］ = c\r\n    return c\r\n  return params［0］\r\n//\r\n\r\nfunc DrawGame()\r\n\r\n  blankpnl = DrawPanel(\r\n    ^ui.root,blankpnl_params)\r\n\r\n  gamepnl = DrawPanel(\r\n  ^ui.root,gamepnl_params)\r\n\r\n  boardanim_params［0］ = board1anim\r\n  board1anim = DrawAnim(\r\n  ^gamepnl,boardanim_params)\r\n  board1anim.x = -26\r\n  board1anim.color = #555555\r\n\r\n  boardanim_params［0］ = board2anim\r\n  board2anim = DrawAnim(\r\n  ^gamepnl,boardanim_params)\r\n  board2anim.x = 44\r\n  board2anim.color = #555555\r\n\r\n  balloonanim = DrawAnim(\r\n  ^gamepnl,balloonanim_params)\r\n\r\n  boardpnl = DrawPanel(\r\n  ^gamepnl,boardpnl_params)\r\n\r\n  menupnl = DrawPanel(\r\n  ^gamepnl,menupnl_params)\r\n\r\n  bearanim = DrawAnim(\r\n  ^menupnl,bearanim_params)\r\n\r\n  signpnl = DrawPanel(\r\n  ^menupnl,signpnl_params)\r\n\r\n  sign1anim = DrawAnim(\r\n  ^signpnl,sign1anim_params)\r\n\r\n  sign2anim = DrawAnim(\r\n  ^signpnl,sign2anim_params)\r\n\r\n  sign3anim = DrawAnim(\r\n  ^signpnl,sign3anim_params)\r\n\r\n  mbtnpnl = DrawPanel(\r\n  ^menupnl,mbtnpnl_params)\r\n\r\n  diffbtn = DrawButton(\r\n  ^mbtnpnl,diffbtn_params)\r\n\r\n  modebtn = DrawButton(\r\n  ^mbtnpnl,modebtn_params)\r\n\r\n  exitbtn = DrawButton(\r\n  ^mbtnpnl,exitbtn_params)\r\n\r\n  menubtn = DrawButton(\r\n  ^gamepnl,menubtn_params)\r\n\r\n  boardanim_params［0］ = board3anim\r\n  board3anim = DrawAnim(\r\n  ^boardpnl,boardanim_params)\r\n  board3anim.color = #white\r\n\r\n  lightsanim = DrawAnim(\r\n  ^boardpnl,lightsanim_params)\r\n  lightsanim.color = #00FFFF\r\n\r\n  ballpnl = DrawPanel(\r\n  ^boardpnl,ballpnl_params)\r\n\r\n  ballanim = DrawAnim(\r\n  ^ballpnl,ballanim_params)\r\n\r\n  ball1anim = DrawAnim(\r\n  ^ballpnl,ball1anim_params)\r\n\r\n  ball2anim = DrawAnim(\r\n  ^ballpnl,ball2anim_params)\r\n\r\n  ball3anim = DrawAnim(\r\n  ^ballpnl,ball3anim_params)\r\n\r\n  timertxt = DrawText(\r\n  ^boardpnl,timertxt_params)\r\n\r\n  scoretxt = DrawText(\r\n  ^boardpnl,scoretxt_params)\r\n\r\n  molespnl = DrawPanel(\r\n    ^boardpnl,molespnl_params)\r\n\r\n  for i=1..9\r\n    molepnl_params［0］ = molepnl［i］\r\n    molepnl［i］ = DrawPanel(\r\n    ^molespnl,molepnl_params)\r\n\r\n  molepnl［1］.x = -11\r\n  molepnl［1］.y = 16\r\n\r\n  molepnl［2］.x = 0\r\n  molepnl［2］.y = 16\r\n\r\n  molepnl［3］.x = 11\r\n  molepnl［3］.y = 16\r\n\r\n  molepnl［4］.x = -11\r\n  molepnl［4］.y = 10\r\n\r\n  molepnl［5］.x = 0\r\n  molepnl［5］.y = 10\r\n\r\n  molepnl［6］.x = 11\r\n  molepnl［6］.y = 10\r\n\r\n  molepnl［7］.x = -11\r\n  molepnl［7］.y = 4\r\n\r\n  molepnl［8］.x = 0\r\n  molepnl［8］.y = 4\r\n\r\n  molepnl［9］.x = 11\r\n  molepnl［9］.y = 4\r\n\r\n  for i=1..9\r\n    moletxt_params［0］ = moletxt［i］\r\n    moletxt［i］ = DrawText(\r\n    ^molepnl［i］,moletxt_params)\r\n    moletxt［i］.text = ＂｛ ＂+i+＂ ｝＂\r\n\r\n  for i=1..9\r\n    molebtn_params［0］ = molebtn［i］\r\n    molebtn［i］ = DrawButton(\r\n    ^molepnl［i］,molebtn_params)\r\n\r\n  for i=1..9\r\n    moleanm_params［0］ = moleanm［i］\r\n    moleanm［i］ = DrawAnim(\r\n    ^molepnl［i］,moleanm_params)\r\n  play @moleupsound@ @moleuppitch@\r\n\r\n  ?assist = 1\r\n    for i=1..9\r\n      molebtn［i］.style = -1\r\n  :\r\n    for i=1..9\r\n      molebtn［i］.style = trspstyl\r\n\r\n  startbtn = DrawButton(\r\n  ^boardpnl,startbtn_params)\r\n  \r\n  instrtxt = DrawText(\r\n  ^boardpnl,instrtxt_params)\r\n\r\n  diffpnl = DrawPanel(\r\n    ^gamepnl,diffpnl_params)\r\n\r\n  easybtn = DrawButton(\r\n  ^diffpnl,easybtn_params)\r\n\r\n  easytxt = DrawText(\r\n    ^diffpnl,easytxt_params)\r\n\r\n  medbtn = DrawButton(\r\n  ^diffpnl,medbtn_params)\r\n\r\n  medtxt = DrawText(\r\n    ^diffpnl,medtxt_params)\r\n\r\n  hardbtn = DrawButton(\r\n  ^diffpnl,hardbtn_params)\r\n\r\n  hardtxt = DrawText(\r\n    ^diffpnl,hardtxt_params)\r\n//\r\n\r\nfunc UpdateLayout()\r\n  screenw = screen.w\r\n  screenh = screen.h\r\n\r\n  gamepnl.w = screenw\r\n  gamepnl.h = screenh\r\n\r\n  var spc = screenw - (boardpnl.w + menupnl.w)\r\n\r\n  //>`0,1,#green,@screenw@,@screenh@\r\n\r\n  ?screenw < boardpnl.w + menupnl.w\r\n    gamelayout = 1\r\n\r\n    boardpnl.x = 0\r\n    board1anim.x = -35\r\n    board2anim.x =  35\r\n    board3anim.color = #CCCCCC\r\n    menupnl.x = 0\r\n    signpnl.x = 0\r\n    mbtnpnl.x = 0\r\n    mbtnpnl.y = 15\r\n    startbtn.y = 11\r\n    balloonanim.x = 26\r\n    diffpnl.x = 0\r\n    bearanim.x = -13\r\n\r\n  :?screenw >= boardpnl.w + menupnl.w & screenw < 80\r\n    gamelayout = 0\r\n   \r\n    boardpnl.x = 15 + math.CeilToInt(spc/2.0)\r\n    menupnl.x = -screenw/2+18+math.CeilToInt(spc/2.0)\r\n    bearanim.x = -13-math.CeilToInt(spc/2.0)\r\n    ?bearanim.x < -15\r\n      bearanim.x = -15\r\n    board1anim.x = -23 + math.CeilToInt(spc/2.0)\r\n    board2anim.x =  44\r\n    board3anim.color = #FFFFFF\r\n    signpnl.x = -3\r\n    mbtnpnl.x = -1\r\n    mbtnpnl.y = 11\r\n    startbtn.y = 21\r\n    balloonanim.x = 37\r\n    diffpnl.x = boardpnl.x\r\n\r\n  :?screenw >= 80\r\n    gamelayout = 0\r\n   \r\n    boardpnl.x = -screenw/2 + boardpnl.w + 17\r\n    menupnl.x = -screenw/2 + menupnl.w/2 + 7\r\n    bearanim.x = -13-math.CeilToInt(spc/2.0)\r\n    ?bearanim.x < -15\r\n      bearanim.x = -15\r\n    board1anim.x = -screenw/2 + board1anim.w/2\r\n    board2anim.x = boardpnl.x + boardpnl.w/2 + board2anim.w/2 - 8\r\n    board3anim.color = #FFFFFF\r\n    signpnl.x = -3\r\n    mbtnpnl.x = -1\r\n    mbtnpnl.y = 11\r\n    startbtn.y = 21\r\n    balloonanim.x = boardpnl.x + boardpnl.w/2 + 5\r\n    ?screenw < 84\r\n      balloonanim.x = screenw\r\n    diffpnl.x = boardpnl.x\r\n//\r\n\r\n//*******************************\r\n// End of File\r\n//*******************************\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Blackjack/Hand.txt" - Parse error: Failed to parse completely. Remaining: "= []\r\nvar size = 0\r\n\r\n// Constants\r\nvar MAX_CARDS = 6\r\nvar BUST_LIMIT = 21\r\n\r\n// UI/graphics variables\r\nvar pnlMain\r\nvar pnlCards\r\nvar txtName\r\nvar txtTotal\r\nvar txtTotalNum\r\n\r\n// Constructor, init Hand object\r\nfunc Init(name, style, color, colorAccent)\r\n  pnlMain = ui.AddPanel()\r\n  pnlMain.style = style\r\n  pnlMain.color = color\r\n  pnlMain.anchor = top_left\r\n  pnlMain.dock = top_left\r\n  pnlMain.clip = false\r\n  pnlMain.w = 25\r\n  pnlMain.h = 5\r\n  \r\n  pnlCards = ui.AddPanel()\r\n  pnlCards.style = 0\r\n  pnlCards.anchor = top_left\r\n  pnlCards.dock = top_left\r\n  pnlCards.clip = false\r\n  pnlCards.x = 1\r\n  pnlCards.y = 1\r\n  pnlCards.w = pnlMain.w-1\r\n  pnlCards.h = pnlMain.h-1\r\n  \r\n  txtName = ui.AddText(name)\r\n  txtName.anchor = top_left\r\n  txtName.dock = top_left\r\n  txtName.w = string.Size(name)\r\n  txtName.h = 1\r\n  txtName.x = 1\r\n  \r\n  txtTotal = ui.AddText()\r\n  txtTotal.anchor = top_right\r\n  txtTotal.dock = top_right\r\n  txtTotal.color = color\r\n  txtTotal.h = 1\r\n  txtTotal.x = -2\r\n  \r\n  txtTotalNum = ui.AddText()\r\n  txtTotalNum.anchor = top_right\r\n  txtTotalNum.dock = top_right\r\n  txtTotalNum.color = colorAccent\r\n  txtTotalNum.h = 1\r\n  txtTotalNum.x = -3\r\n  \r\n  pnlMain.Add(pnlCards)\r\n  pnlMain.Add(txtName)\r\n  pnlMain.Add(txtTotal)\r\n  pnlMain.Add(txtTotalNum)\r\n  \r\n  UpdateValueDisp()\r\n  \r\n  return this\r\n\r\n// Update the displayed value\r\nfunc UpdateValueDisp()\r\n  var tot = \"\" + GetBestTotal()\r\n  \r\n  //show both soft/hard values if applicable\r\n  ?CanSoften() & IsSoft()\r\n    tot = tot + \"(\" + GetTotal(false) + \")\"\r\n  \r\n  var t_w = string.Size(tot)\r\n  \r\n  txtTotal.text = \"[\" + tot + \"]\"\r\n  txtTotal.w = t_w + 2\r\n  txtTotalNum.text = tot\r\n  txtTotalNum.w = t_w\r\n\r\n// Update frame x,y pos\r\nfunc MoveTo(x,y)\r\n  pnlMain.x = x\r\n  pnlMain.y = y\r\n\r\n// Update frame size\r\nfunc Size(w,h)\r\n  pnlMain.w = w\r\n  pnlMain.h = h\r\n  pnlCards.w = w-1\r\n  pnlCards.h = h-1\r\n\r\n// Update visiblity\r\nfunc Visible(v)\r\n  pnlMain.visible = v\r\n\r\n//- CARD INTERACTION FUNCTIONS -\r\n// Add a card\r\nfunc Add(value, suit)\r\n  var card = new Games/Blackjack/Card\r\n  card.Init(value, suit)\r\n  card.MoveTo(size*4, 0)\r\n  \r\n  cards.Add(card)\r\n  pnlCards.Add(card.pnlMain)\r\n  size++\r\n\r\n// Get a particular card\r\nfunc GetAt(index)\r\n  ?size = 0\r\n    return\r\n  \r\n  ?index < 0\r\n    index = index + size\r\n  \r\n  return cards[index]\r\n\r\n// Remove a particular card\r\nfunc RemoveAt(index)\r\n  ?size = 0\r\n    return\r\n  \r\n  cards.RemoveAt(index)\r\n  pnlCards.Remove(index)\r\n  size--\r\n\r\n// Remove all cards\r\nfunc Clear()\r\n  pnlCards.Clear()\r\n  cards.Clear()\r\n  size = 0\r\n\r\n//- HAND VALUE INTERACTION FUNCTIONS -\r\n// Get soft/hard total value of hand\r\nfunc GetTotal(soft)\r\n  var hasAce = false\r\n  var total = 0\r\n  \r\n  ?cards.Count() < 1\r\n    return 0\r\n  \r\n  for i = 0..cards.Count()-1\r\n    var v = cards[i].value\r\n    \r\n    ?v = 1\r\n      hasAce = true\r\n    \r\n    ?v > 10\r\n      total = total + 10\r\n    :\r\n      total = total + v\r\n\r\n  ?soft & hasAce\r\n    total = total + 10\r\n  return total\r\n\r\n// Get total value of hand, automatically choosing hard if soft would bust\r\nfunc GetBestTotal()\r\n  var softTotal = GetTotal(true)\r\n  \r\n  ?softTotal <= BUST_LIMIT\r\n    return softTotal\r\n  \r\n  return GetTotal(false)\r\n\r\n// Check if hand is using soft total\r\nfunc IsSoft()\r\n  return ( GetBestTotal() = GetTotal(true) )\r\n\r\n// Check if soft total would be less than hard total\r\nfunc CanSoften()\r\n  return ( GetTotal(false) < GetTotal(true) )\r\n\r\n// Check if hand can be doubled down\r\nfunc CanDoubleDown()\r\n  return ( cards.Count() = 2 )\r\n\r\n// Check if 21 was dealt as starting hand\r\nfunc HasBlackjack()\r\n  return ( CanDoubleDown() & ( GetBestTotal() = BUST_LIMIT ))\r\n\r\n// Check if 21 has been exceeded\r\nfunc HasBusted()\r\n  return ( GetBestTotal() > BUST_LIMIT )"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Blackjack/Card.txt" - Parse error: Failed to parse completely. Remaining: "(\"#_#│ │#‾#\")\r\nvar strFront = \"\"\r\nvar strBack = ascii\r\n::\r\n::\r\nasciiend\r\n\r\nvar clrRed =   #FF0000\r\nvar clrBlack = #FFFFFF\r\nvar clrFront = #999999\r\nvar clrBack =  #666666\r\n\r\n// Constructor, init Card object\r\nfunc Init(value, suit)\r\n  ?!initialized\r\n    initialized = true\r\n    this.value = value\r\n    this.suit = suit\r\n    \r\n    pnlMain = ui.AddPanel()\r\n    pnlMain.style = stlCard\r\n    pnlMain.color = clrFront\r\n    pnlMain.anchor = top_left\r\n    pnlMain.dock = top_left\r\n    pnlMain.clip = true\r\n    pnlMain.w = 4\r\n    pnlMain.h = 4\r\n  \r\n    strFront = strFront + GetValStr(value) + \"\\n\"\r\n    strFront = strFront + \" \" + GetSuitStr(suit)\r\n  \r\n    txtFront = ui.AddText(strFront)\r\n    txtFront.color = GetSuitColor(suit)\r\n    txtFront.anchor = top_left\r\n    txtFront.dock = top_left\r\n    txtFront.x = 1\r\n    txtFront.y = 1\r\n    \r\n    txtBack = ui.AddText(strBack)\r\n    txtBack.color = clrBack\r\n    txtBack.anchor = top_left\r\n    txtBack.dock = top_left\r\n    txtBack.x = 1\r\n    txtBack.y = 1\r\n    \r\n    pnlMain.Add(txtFront)\r\n    pnlMain.Add(txtBack)\r\n    SetFaceUp(true)\r\n    \r\n    return this\r\n\r\n\r\n\r\n// Show/hide components to flip card face up or face down\r\nfunc SetFaceUp(f)\r\n  face_up = f\r\n  ?f\r\n    txtFront.visible = inherit\r\n    txtBack.visible = false\r\n    pnlMain.color = clrFront\r\n  :\r\n    txtFront.visible = false\r\n    txtBack.visible = inherit\r\n    pnlMain.color = clrBack\r\n\r\n// Invert faceup state\r\nfunc Flip()\r\n  face_up = !face_up\r\n  SetFaceUp(face_up)\r\n\r\n// Update card x,y pos\r\nfunc MoveTo(x,y)\r\n  pnlMain.x = math.RoundToInt(x)\r\n  pnlMain.y = math.RoundToInt(y)\r\n\r\n// Show/hide\r\nfunc SetVisible(v)\r\n  pnlMain.visible = v\r\n\r\n\r\n\r\n// Convert value specifier to value\r\n//   accepts suit values (1-10,J,Q,K,A), or an integer from 1-14\r\nfunc GetValStr(v)\r\n  ?Type(v) = int\r\n    ?v = 11\r\n      return \"J\"\r\n    :?v = 12\r\n      return \"Q\"\r\n    :?v = 13\r\n      return \"K\"\r\n    :?v = 14 | v = 1\r\n      return \"A\"\r\n    \r\n    return v\r\n  return v\r\n\r\n// Convert suit specifier to suit character\r\n//   accepts suit names, suit characters, or an integer from 0-3\r\nfunc GetSuitStr(s)\r\n  ?s = heart | s = 0\r\n    return \"♥\"\r\n  :?s = diamond | s = 1\r\n    return \"♦\"\r\n  :?s = club | s = 2\r\n    return \"♣\"\r\n  :?s = spade | s = 3\r\n    return \"♠\"\r\n  :\r\n    return s\r\n\r\n// Convert suit specifier to suit color\r\n//   accepts suit names, suit characters, or an integer from 0-3\r\nfunc GetSuitColor(s)\r\n  ?s = heart | s = diamond | s = ♥ | s = ♦ | s = 0 | s = 1\r\n    return clrRed\r\n  :\r\n    return clrBlack\r\n\r\nfunc GetValue()\r\n  return value\r\n\r\nfunc GetSuit()\r\n  return suit\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Blackjack/Bank.txt" - Parse error: Failed to parse completely. Remaining: "=  #green  //duh\r\nvar clrBet =    #yellow\r\n\r\n// Constructor, init Bank object\r\nfunc Init(storage_key, seed)\r\n  this.storage_key = storage_key\r\n  \r\n  bet = 0\r\n  money = storage.Get(storage_key, seed)\r\n  \r\n  //catch type errors while fetching score from storage\r\n  ?Type(money) = float\r\n    money = math.RoundToInt(money)\r\n  :?Type(money) ! int\r\n    money = seed\r\n  \r\n  f_money = 0.0 + money\r\n  f_bet = 0.0\r\n  \r\n  pnlMain = ui.AddPanel()\r\n  pnlMain.style = 0\r\n  pnlMain.anchor = center_right\r\n  pnlMain.dock = center_right\r\n  pnlMain.clip = true\r\n  pnlMain.x = -1\r\n  pnlMain.y = 0\r\n  pnlMain.w = 7\r\n  pnlMain.h = 4\r\n  \r\n  txtMoney = ui.AddText()\r\n  txtMoney.color = clrMoney\r\n  txtMoney.align = right\r\n  txtMoney.anchor = top_right\r\n  txtMoney.dock = top_right\r\n  txtMoney.w = pnlMain.w\r\n  txtMoney.h = 1\r\n  \r\n  txtBet = ui.AddText()\r\n  txtBet.color = clrBet\r\n  txtBet.align = right\r\n  txtBet.anchor = top_right\r\n  txtBet.dock = top_right\r\n  txtBet.w = pnlMain.w\r\n  txtBet.h = 1\r\n  txtBet.y = 1\r\n  \r\n  txtIconMoney = ui.AddText()\r\n  txtIconMoney.text = \"  $\"\r\n  txtIconMoney.color = clrMoney\r\n  txtIconMoney.anchor = top_left\r\n  txtIconMoney.dock = top_left\r\n  txtIconMoney.w = 3\r\n  txtIconMoney.h = 1\r\n  \r\n  txtIconBet = ui.AddText()\r\n  txtIconBet.text = \"Bet\"\r\n  txtIconBet.color = clrBet\r\n  txtIconBet.anchor = top_left\r\n  txtIconBet.dock = top_left\r\n  txtIconBet.w = 3\r\n  txtIconBet.h = 1\r\n  txtIconBet.y = 1\r\n  \r\n  pnlMain.Add(txtIconMoney)\r\n  pnlMain.Add(txtIconBet)\r\n  pnlMain.Add(txtMoney)\r\n  pnlMain.Add(txtBet)\r\n  \r\n  UpdateDisplay()\r\n  \r\n  return this\r\n\r\n// Tick bet and money displays\r\nfunc UpdateDisplay()\r\n  UpdateMoneyDisplay()\r\n  UpdateBetDisplay()\r\n\r\n// Tick displayed money until it matches actual held money\r\nfunc UpdateMoneyDisplay()\r\n  ?math.Abs(money - disp_money) > DIST_FAR\r\n    f_money = math.Lerp(f_money, money, TICK_RATE_FAST)\r\n  :?math.Abs(money - disp_money) > DIST_AT\r\n    f_money = math.Lerp(f_money, money, TICK_RATE_SLOW)\r\n  \r\n  ?disp_money ! money\r\n    disp_money = math.RoundToInt(f_money)\r\n    txtMoney.text = \"\" + disp_money\r\n\r\n// Tick displayed bet until it matches actual bet\r\nfunc UpdateBetDisplay()\r\n  ?math.Abs(bet - disp_bet) > DIST_FAR\r\n    f_bet = math.Lerp(f_bet, bet, TICK_RATE_FAST)\r\n  :?math.Abs(bet - disp_bet) > DIST_AT\r\n    f_bet = math.Lerp(f_bet, bet, TICK_RATE_SLOW)\r\n  \r\n  disp_bet = math.RoundToInt(f_bet)\r\n  txtBet.text = \"\" + disp_bet\r\n\r\n// Increase/decrease held money\r\nfunc AddMoney(d_money)\r\n    f_money = 0.0 + money\r\n    money = math.Clamp(money+d_money, 0, MONEY_MAX)\r\n\r\n// Move money from bank to bet\r\nfunc AddBet(d_bet)\r\n  ?(bet+d_bet < 0) | (money-d_bet < 0)\r\n    return\r\n  \r\n  f_bet = 0.0 + bet\r\n  bet = math.Clamp(bet+d_bet, 0, MONEY_MAX)\r\n  AddMoney(-d_bet)\r\n\r\n// Move money from bank to bet, bypassing bet display ticks\r\nfunc AddBetImmediate(d_bet)\r\n  ?(bet+d_bet < 0) | (money-d_bet < 0)\r\n    return\r\n  \r\n  AddBet(d_bet)\r\n  f_bet = 0.0 + bet\r\n  disp_bet = bet\r\n\r\n// Set current bet multiplier (0x lose, 1x push, 2x win, 2.5x blackjack)\r\nfunc SetBetMult(mult)\r\n  this.bet_mult = mult\r\n\r\n// Move money from bet to bank, times the current multiplier\r\n//   Save money to permanent storage, so it can be used later\r\nfunc Settle()\r\n  AddMoney(bet * bet_mult)\r\n  storage.Set(storage_key, math.RoundToInt(money) )\r\n  bet_mult = 1\r\n  bet = 0\r\n\r\n// Has enough money to double down?\r\nfunc CanDoubleDown()\r\n  return (money >= bet)\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/PlayingCards.txt" - Parse error: Failed to parse completely. Remaining: "= \"\"\r\ncardFront = ascii\r\n#__\r\n│  │\r\n│  │\r\n#‾‾\r\nasciiend\r\n\r\nvar cardBack = \"\"\r\ncardBack = ascii\r\n#__\r\n│::│\r\n│::│\r\n#‾‾\r\nasciiend\r\n\r\nvar cardCompact = \"\"\r\ncardCompact = ascii\r\n#_ \r\n│  │\r\n│  │\r\n#‾ \r\nasciiend\r\n\r\n\r\nvar compact = false\r\n\r\n\r\nfunc DrawBack(x, y)\r\n  >`@x@,@y@,#666666,@cardBack@\r\n\r\n\r\nfunc Draw(x, y, value, suit)\r\n\r\n  var color = #999999\r\n  >`@x@,@y@,@color@,@cardFront@\r\n\r\n  var numberX = x + 1\r\n  y = y + 1\r\n  \r\n  // Suit can be int or string\r\n  ?Type(suit) = int\r\n    >Int suit = @suit@\r\n    ?suit = 0\r\n      suit = heart\r\n    :?suit = 1\r\n      suit = diamond\r\n    :?suit = 2\r\n      suit = club\r\n    :\r\n      suit = spade\r\n  \r\n  // Card value can be int or string\r\n  ?Type(value) = int\r\n    ?value = 10 & compact\r\n      numberX--\r\n    ?value = 11\r\n      value = \"J\"\r\n    :?value = 12\r\n      value = \"Q\"\r\n    :?value = 13\r\n      value = \"K\"\r\n    :?value = 1 | value = 14\r\n      value = \"A\"\r\n  \r\n  color = #ff0000\r\n  ?suit = club | suit = spade\r\n    color = #ffffff\r\n\r\n  \r\n  >`@numberX@,@y@,@color@,@value@\r\n\r\n  x++\r\n  ?compact = false\r\n    x++\r\n  y = y + 1\r\n  ?suit = heart\r\n    suit = \"♥\"\r\n  :?suit = diamond\r\n    suit = \"♦\"\r\n  :?suit = club\r\n    suit = \"♣\"\r\n  :\r\n    suit = \"♠\"\r\n\r\n  >`@x@,@y@,@color@,@suit@\r\n\r\n\r\nfunc DrawCompact(x, y, value, suit)\r\n  compact = true\r\n  Draw(x, y, value, suit)\r\n  compact = false\r\n\r\n  \r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/FrogJump.txt" - Parse error: Failed to parse completely. Remaining: "= [0,1,1,1,1,1,1,1]\r\nvar CoinAry = [0,0,1,1,1,1,1,1]\r\nvar LOGO\r\nvar River\r\nvar edge\r\nvar LilyPod0\r\nvar LilyPod1\r\nvar LilyPod2\r\nvar LilyPod3\r\nvar LilyPod4\r\nvar LilyPod5\r\nvar LilyPod6\r\nvar LilyPod7\r\nvar Coin0\r\nvar Coin1\r\nvar Coin2\r\nvar Coin3\r\nvar Coin4\r\nvar Coin5\r\nvar Coin6\r\nvar Coin7\r\nvar CurrentCoin\r\nvar TotalCoin\r\nvar CurrentScore\r\nvar HighScore\r\nvar Startbutton\r\nvar Modebutton\r\nvar Easybutton\r\nvar Hardbutton\r\nvar Mainmenubutton\r\nvar GAMEOVER\r\nvar eagle\r\nvar transtyle\r\nvar Frog\r\nvar FrogJump\r\nvar FrogEye\r\nvar JumpArrow\r\nvar croakonce = 0\r\nvar startpos = 1\r\nvar flytime = 0\r\nvar staytime = 0\r\nvar frogtime = -1\r\nvar starttime = 0\r\nvar presstime = -1\r\nvar tranphase = 12.0\r\nvar rngLD = 0\r\nvar EmAry = [0,0,0,0,0,0]\r\nvar CoinSubAry = [0,0,0,0,0,0]\r\nvar CoinNO = 0\r\nvar totalCoinNO = storage.Get(\"totalcoins\", 0)\r\nvar modename = \"Easy\"\r\nvar score = 0\r\nvar hscore = storage.Get(\"eahighscore\", 0)\r\nvar EAhighscore = storage.Get(\"eahighscore\", 0)\r\nvar HDhighscore = storage.Get(\"hdhighscore\", 0)\r\n\r\n?loc.begin\r\n\tambient.Stop()\r\n\trngLD = rng % 64\r\n\tfor i = 0..5\r\n\t\t?(rngLD + i) % 3 = 0\r\n\t\t\tCoinAry[i+2] = 1\r\n\t\t:\r\n\t\t\tCoinAry[i+2] = 0\r\n\r\n\tLOGO = ui.AddAnim(ascii\r\n    __\r\n   / _)              _          _\r\n _/ /_ _ __  ___   _( )       _( )_   _  _ _  _ __\r\n|_   _| '__|/ _ \\ / _ \\      |_  | | | |'_'_'| '_ \\\r\n  | | | |  | (_) | |_) |    _  | | |_| || | || |_) |\r\n  | | |_|   \\___/ \\__. |   | | | |\\___/|| | || .__/\r\n  |_|              __/ /   | \\_/ |     ‾‾ ‾ ‾| |\r\n                  |___/     \\___/            |_|\r\nasciiend)\r\n\tLOGO.x = 7\r\n\tLOGO.y = -8\r\n\tLOGO.w = 54\r\n\tLOGO.h = 8\r\n\tLOGO.anchor = center_center\r\n\tLOGO.dock = center_center\r\n\tLOGO.pivotX = 0\r\n\tLOGO.pivotY = 0\r\n\tLOGO.color = #32da5a\r\n\tLOGO.duration = 0\r\n\tLOGO.frame = 0\r\n\tLOGO.loop = false\r\n\tLOGO.playOnStart = false\r\n\tLOGO.Stop()\r\n\r\n\tRiver = ui.AddAnim(ascii\r\n-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~\r\n~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -\r\n ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~\r\n  ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~- \r\n-   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  -\r\n  -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~  \r\n ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~\r\n~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   \r\n  ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~  \r\n    ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   - \r\n~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~\r\n   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -\r\n  ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     - \r\n -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~   \r\n%%\r\n~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-\r\n- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~\r\n~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ \r\n ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-  \r\n   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --\r\n -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~   \r\n~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ \r\n -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~\r\n ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~   \r\n   ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -  \r\n  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~\r\n  ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     - \r\n ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -  \r\n-    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    \r\n%%\r\n ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~\r\n -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~-\r\n-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~\r\n~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   \r\n  - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  -- \r\n-~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    \r\n -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~\r\n-   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ \r\n~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    \r\n  ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -   \r\n -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~ \r\n ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -  \r\n~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   \r\n    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -\r\n%%\r\n~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ \r\n-~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- \r\n  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-\r\n ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~\r\n - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --  \r\n~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -\r\n-     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ \r\n   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -\r\n  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~\r\n ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -    \r\n-     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  \r\n~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   \r\n     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~\r\n   ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    - \r\n%%\r\n- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~\r\n~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -\r\n ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~- \r\n~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ \r\n- ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   \r\n-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~\r\n     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -\r\n  ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ - \r\n - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~ \r\n~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     \r\n     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -\r\n     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~\r\n    -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~ \r\n  ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -  \r\n%%\r\n -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~-\r\n-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~\r\n~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  \r\n  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~\r\n ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   -\r\n  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-\r\n    ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ - \r\n ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -  \r\n- ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  \r\n   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~\r\n    ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  - \r\n    -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~ \r\n   -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~  \r\n ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -   \r\n%%\r\n-~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- \r\n~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-\r\n  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~\r\n ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~ \r\n~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - \r\n ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~- \r\n   ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -  \r\n~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   \r\n ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  -\r\n  -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~ \r\n   ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -  \r\n   -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~  \r\n  -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~   \r\n~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    \r\n%%\r\n~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -\r\n- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~\r\n -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~ \r\n~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  \r\n  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~\r\n~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  \r\n  ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -   \r\n   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~\r\n~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - \r\n -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~  \r\n  ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -   \r\n  -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~   \r\n -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~    \r\n    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~\r\n%%\r\n^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~\r\n -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~-\r\n-~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  \r\n-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~\r\n --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~ \r\n    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~\r\n ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -    \r\n  ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~ \r\n    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~\r\n-     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   \r\n ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -    \r\n -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~    \r\n-   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     \r\n   -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~ \r\n%%\r\n~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^~-~ ~- -~^\r\n-~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- -~- -~-~- \r\n~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -~ ~-  ~  -\r\n   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-   ~ ~  ~-\r\n--   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  --   - ~  \r\n   -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~    -~-  ~ \r\n~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     ~ ~ -     \r\n ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~   ~ -   ~  \r\n   ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~    ~  - ~ \r\n     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -     ~   -\r\n~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     ~~  -     \r\n-   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     \r\n   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -   ~     -\r\n  -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~  \r\nasciiend)\r\n\tRiver.x = 0\r\n\tRiver.y = screen.h/2 - 5\r\n\tRiver.anchor = center_left\r\n\tRiver.dock = center_left\r\n\tRiver.color = #323232\r\n\tRiver.duration = 50\r\n\tRiver.frame = 0\r\n\tRiver.loop = true\r\n\tRiver.playOnStart = true\r\n\tRiver.pivotX = 0\r\n\tRiver.pivotY = 0\r\n\tRiver.Play()\r\n\r\n\tedge = ui.AddAnim(ascii\r\n-,-^-,_,- -._-,__,^-_,-,^-_,-,^--,-^-,_,- -._-,__,^-_,-,^-_,-,^--,-^-,_,-^-._-,__,^-_,-,^--,-^-,^\r\n | '||  | '|'|  '|  | '|  |'|  | | '||  | '|'|  '|  | '|  |'|  | | '||  | '|'|  '|  | '| ' | | '|\r\nasciiend)\r\n\tedge.x = 0\r\n\tedge.y = 0\r\n\tedge.anchor = center_left\r\n\tedge.dock = center_left\r\n\tedge.color = #323232\r\n\tedge.duration = 0\r\n\tedge.frame = 0\r\n\tedge.loop = false\r\n\tedge.playOnStart = false\r\n\tedge.pivotX = 0\r\n\tedge.pivotY = 0\r\n\tedge.Stop()\r\n\r\n\tLilyPod0 = ui.AddAnim(ascii\r\n####_\r\n#,´   `.\r\n/       \\\r\n\\       /\r\n#\\/|..-´\r\n%%\r\n#\r\nasciiend)\r\n\tLilyPod0.anchor = center_left\r\n\tLilyPod0.dock = center_left\r\n\tLilyPod0.x = 0\r\n\tLilyPod0.y = 6\r\n\tLilyPod0.w = 10\r\n\tLilyPod0.h = 5\r\n\tLilyPod0.pivotX = 0\r\n\tLilyPod0.pivotY = 0\r\n\tLilyPod0.color = #618a3d\r\n\tLilyPod0.duration = 0\r\n\tLilyPod0.frame = 1\r\n\tLilyPod0.loop = false\r\n\tLilyPod0.playOnStart = false\r\n\tLilyPod0.Stop()\r\n\r\n\tLilyPod1 = ui.AddAnim(ascii\r\n####_\r\n#,´   `.\r\n/       \\\r\n\\       /\r\n#\\/|..-´\r\n%%\r\n#\r\nasciiend)\r\n\tLilyPod1.anchor = center_left\r\n\tLilyPod1.dock = center_left\r\n\tLilyPod1.x = 10\r\n\tLilyPod1.y = 6\r\n\tLilyPod1.w = 10\r\n\tLilyPod1.h = 5\r\n\tLilyPod1.pivotX = 0\r\n\tLilyPod1.pivotY = 0\r\n\tLilyPod1.color = #618a3d\r\n\tLilyPod1.duration = 0\r\n\tLilyPod1.frame = 0\r\n\tLilyPod1.loop = false\r\n\tLilyPod1.playOnStart = false\r\n\tLilyPod1.Stop()\r\n\r\n\tLilyPod2 = ui.AddAnim(ascii\r\n####_\r\n#,´   `.\r\n/       \\\r\n\\       /\r\n#\\/|..-´\r\n%%\r\n#\r\nasciiend)\r\n\tLilyPod2.anchor = center_left\r\n\tLilyPod2.dock = center_left\r\n\tLilyPod2.x = 20\r\n\tLilyPod2.y = 6\r\n\tLilyPod2.w = 10\r\n\tLilyPod2.h = 5\r\n\tLilyPod2.pivotX = 0\r\n\tLilyPod2.pivotY = 0\r\n\tLilyPod2.color = #618a3d\r\n\tLilyPod2.duration = 0\r\n\tLilyPod2.frame = 0\r\n\tLilyPod2.loop = false\r\n\tLilyPod2.playOnStart = false\r\n\tLilyPod2.Stop()\r\n\r\n\tLilyPod3 = ui.AddAnim(ascii\r\n####_\r\n#,´   `.\r\n/       \\\r\n\\       /\r\n#\\/|..-´\r\n%%\r\n#\r\nasciiend)\r\n\tLilyPod3.anchor = center_left\r\n\tLilyPod3.dock = center_left\r\n\tLilyPod3.x = 30\r\n\tLilyPod3.y = 6\r\n\tLilyPod3.w = 10\r\n\tLilyPod3.h = 5\r\n\tLilyPod3.pivotX = 0\r\n\tLilyPod3.pivotY = 0\r\n\tLilyPod3.color = #618a3d\r\n\tLilyPod3.duration = 0\r\n\tLilyPod3.frame = 0\r\n\tLilyPod3.loop = false\r\n\tLilyPod3.playOnStart = false\r\n\tLilyPod3.Stop()\r\n\r\n\tLilyPod4 = ui.AddAnim(ascii\r\n####_\r\n#,´   `.\r\n/       \\\r\n\\       /\r\n#\\/|..-´\r\n%%\r\n#\r\nasciiend)\r\n\tLilyPod4.anchor = center_left\r\n\tLilyPod4.dock = center_left\r\n\tLilyPod4.x = 40\r\n\tLilyPod4.y = 6\r\n\tLilyPod4.w = 10\r\n\tLilyPod4.h = 5\r\n\tLilyPod4.pivotX = 0\r\n\tLilyPod4.pivotY = 0\r\n\tLilyPod4.color = #618a3d\r\n\tLilyPod4.duration = 0\r\n\tLilyPod4.frame = 0\r\n\tLilyPod4.loop = false\r\n\tLilyPod4.playOnStart = false\r\n\tLilyPod4.Stop()\r\n\r\n\tLilyPod5 = ui.AddAnim(ascii\r\n####_\r\n#,´   `.\r\n/       \\\r\n\\       /\r\n#\\/|..-´\r\n%%\r\n#\r\nasciiend)\r\n\tLilyPod5.anchor = center_left\r\n\tLilyPod5.dock = center_left\r\n\tLilyPod5.x = 50\r\n\tLilyPod5.y = 6\r\n\tLilyPod5.w = 10\r\n\tLilyPod5.h = 5\r\n\tLilyPod5.pivotX = 0\r\n\tLilyPod5.pivotY = 0\r\n\tLilyPod5.color = #618a3d\r\n\tLilyPod5.duration = 0\r\n\tLilyPod5.frame = 0\r\n\tLilyPod5.loop = false\r\n\tLilyPod5.playOnStart = false\r\n\tLilyPod5.Stop()\r\n\r\n\tLilyPod6 = ui.AddAnim(ascii\r\n####_\r\n#,´   `.\r\n/       \\\r\n\\       /\r\n#\\/|..-´\r\n%%\r\n#\r\nasciiend)\r\n\tLilyPod6.anchor = center_left\r\n\tLilyPod6.dock = center_left\r\n\tLilyPod6.x = 60\r\n\tLilyPod6.y = 6\r\n\tLilyPod6.w = 10\r\n\tLilyPod6.h = 5\r\n\tLilyPod6.pivotX = 0\r\n\tLilyPod6.pivotY = 0\r\n\tLilyPod6.color = #618a3d\r\n\tLilyPod6.duration = 0\r\n\tLilyPod6.frame = 0\r\n\tLilyPod6.loop = false\r\n\tLilyPod6.playOnStart = false\r\n\tLilyPod6.Stop()\r\n\r\n\tLilyPod7 = ui.AddAnim(ascii\r\n####_\r\n#,´   `.\r\n/       \\\r\n\\       /\r\n#\\/|..-´\r\n%%\r\n#\r\nasciiend)\r\n\tLilyPod7.anchor = center_left\r\n\tLilyPod7.dock = center_left\r\n\tLilyPod7.x = 70\r\n\tLilyPod7.y = 6\r\n\tLilyPod7.w = 10\r\n\tLilyPod7.h = 5\r\n\tLilyPod7.pivotX = 0\r\n\tLilyPod7.pivotY = 0\r\n\tLilyPod7.color = #618a3d\r\n\tLilyPod7.duration = 0\r\n\tLilyPod7.frame = 0\r\n\tLilyPod7.loop = false\r\n\tLilyPod7.playOnStart = false\r\n\tLilyPod7.Stop()\r\n\r\n\tCoin0 = ui.AddAnim(ascii\r\n#_\r\n($)\r\n#‾\r\n%%\r\n#\r\nasciiend)\r\n\tCoin0.anchor = center_left\r\n\tCoin0.dock = center_left\r\n\tCoin0.x = 3\r\n\tCoin0.y = 6\r\n\tCoin0.w = 3\r\n\tCoin0.h = 3\r\n\tCoin0.pivotX = 0\r\n\tCoin0.pivotY = 0\r\n\tCoin0.color = #ffd700\r\n\tCoin0.duration = 0\r\n\tCoin0.frame = 0\r\n\tCoin0.loop = false\r\n\tCoin0.playOnStart = false\r\n\tCoin0.Stop()\r\n\r\n\tCoin1 = ui.AddAnim(ascii\r\n#_\r\n($)\r\n#‾\r\n%%\r\n#\r\nasciiend)\r\n\tCoin1.anchor = center_left\r\n\tCoin1.dock = center_left\r\n\tCoin1.x = 13\r\n\tCoin1.y = 6\r\n\tCoin1.w = 3\r\n\tCoin1.h = 3\r\n\tCoin1.pivotX = 0\r\n\tCoin1.pivotY = 0\r\n\tCoin1.color = #ffd700\r\n\tCoin1.duration = 0\r\n\tCoin1.frame = 0\r\n\tCoin1.loop = false\r\n\tCoin1.playOnStart = false\r\n\tCoin1.Stop()\r\n\r\n\tCoin2 = ui.AddAnim(ascii\r\n#_\r\n($)\r\n#‾\r\n%%\r\n#\r\nasciiend)\r\n\tCoin2.anchor = center_left\r\n\tCoin2.dock = center_left\r\n\tCoin2.x = 23\r\n\tCoin2.y = 6\r\n\tCoin2.w = 3\r\n\tCoin2.h = 3\r\n\tCoin2.pivotX = 0\r\n\tCoin2.pivotY = 0\r\n\tCoin2.color = #ffd700\r\n\tCoin2.duration = 0\r\n\tCoin2.frame = 0\r\n\tCoin2.loop = false\r\n\tCoin2.playOnStart = false\r\n\tCoin2.Stop()\r\n\r\n\tCoin3 = ui.AddAnim(ascii\r\n#_\r\n($)\r\n#‾\r\n%%\r\n#\r\nasciiend)\r\n\tCoin3.anchor = center_left\r\n\tCoin3.dock = center_left\r\n\tCoin3.x = 33\r\n\tCoin3.y = 6\r\n\tCoin3.w = 3\r\n\tCoin3.h = 3\r\n\tCoin3.pivotX = 0\r\n\tCoin3.pivotY = 0\r\n\tCoin3.color = #ffd700\r\n\tCoin3.duration = 0\r\n\tCoin3.frame = 0\r\n\tCoin3.loop = false\r\n\tCoin3.playOnStart = false\r\n\tCoin3.Stop()\r\n\r\n\tCoin4 = ui.AddAnim(ascii\r\n#_\r\n($)\r\n#‾\r\n%%\r\n#\r\nasciiend)\r\n\tCoin4.anchor = center_left\r\n\tCoin4.dock = center_left\r\n\tCoin4.x = 43\r\n\tCoin4.y = 6\r\n\tCoin4.w = 3\r\n\tCoin4.h = 3\r\n\tCoin4.pivotX = 0\r\n\tCoin4.pivotY = 0\r\n\tCoin4.color = #ffd700\r\n\tCoin4.duration = 0\r\n\tCoin4.frame = 0\r\n\tCoin4.loop = false\r\n\tCoin4.playOnStart = false\r\n\tCoin4.Stop()\r\n\r\n\tCoin5 = ui.AddAnim(ascii\r\n#_\r\n($)\r\n#‾\r\n%%\r\n#\r\nasciiend)\r\n\tCoin5.anchor = center_left\r\n\tCoin5.dock = center_left\r\n\tCoin5.x = 53\r\n\tCoin5.y = 6\r\n\tCoin5.w = 3\r\n\tCoin5.h = 3\r\n\tCoin5.pivotX = 0\r\n\tCoin5.pivotY = 0\r\n\tCoin5.color = #ffd700\r\n\tCoin5.duration = 0\r\n\tCoin5.frame = 0\r\n\tCoin5.loop = false\r\n\tCoin5.playOnStart = false\r\n\tCoin5.Stop()\r\n\r\n\tCoin6 = ui.AddAnim(ascii\r\n#_\r\n($)\r\n#‾\r\n%%\r\n#\r\nasciiend)\r\n\tCoin6.anchor = center_left\r\n\tCoin6.dock = center_left\r\n\tCoin6.x = 63\r\n\tCoin6.y = 6\r\n\tCoin6.w = 3\r\n\tCoin6.h = 3\r\n\tCoin6.pivotX = 0\r\n\tCoin6.pivotY = 0\r\n\tCoin6.color = #ffd700\r\n\tCoin6.duration = 0\r\n\tCoin6.frame = 0\r\n\tCoin6.loop = false\r\n\tCoin6.playOnStart = false\r\n\tCoin6.Stop()\r\n\r\n\tCoin7 = ui.AddAnim(ascii\r\n#_\r\n($)\r\n#‾\r\n%%\r\n#\r\nasciiend)\r\n\tCoin7.anchor = center_left\r\n\tCoin7.dock = center_left\r\n\tCoin7.x = 73\r\n\tCoin7.y = 6\r\n\tCoin7.w = 3\r\n\tCoin7.h = 3\r\n\tCoin7.pivotX = 0\r\n\tCoin7.pivotY = 0\r\n\tCoin7.color = #ffd700\r\n\tCoin7.duration = 0\r\n\tCoin7.frame = 0\r\n\tCoin7.loop = false\r\n\tCoin7.playOnStart = false\r\n\tCoin7.Stop()\r\n\r\n\tCurrentCoin = ui.AddText()\r\n\tCurrentCoin.text = CoinNO + \" [color=#ffd700]$[/color]\"\r\n\tCurrentCoin.x = 0\r\n\tCurrentCoin.y = -3\r\n\tCurrentCoin.w = string.Size(\"\" + CoinNO) + 2\r\n\tCurrentCoin.h = 1\r\n\tCurrentCoin.anchor = center_right\r\n\tCurrentCoin.dock = center_right\r\n\tCurrentCoin.visible = false\r\n\tCurrentCoin.align = left\r\n\tCurrentCoin.color = #EEEEEE\r\n\r\n\tTotalCoin = ui.AddText()\r\n\tTotalCoin.text = te.xt(tid_treasures_found) + \" \" + totalCoinNO + \" [color=#ffd700]$[/color]\"\r\n\tTotalCoin.x = 0\r\n\tTotalCoin.y = -4\r\n\tTotalCoin.w = string.Size(te.xt(tid_treasures_found) + totalCoinNO) + 3\r\n\tTotalCoin.h = 1\r\n\tTotalCoin.anchor = center_right\r\n\tTotalCoin.dock = center_right\r\n\tTotalCoin.visible = true\r\n\tTotalCoin.align = left\r\n\tTotalCoin.color = #EEEEEE\r\n\r\n\tCurrentScore = ui.AddText()\r\n\tCurrentScore.text = \"current score\" + \" \" + score\r\n\tCurrentScore.x = 0\r\n\tCurrentScore.y = -screen.h/2 + 1\r\n\tCurrentScore.w = string.Size(\"current score\" + score) + 1\r\n\tCurrentScore.h = 1\r\n\tCurrentScore.anchor = center_left\r\n\tCurrentScore.dock = center_left\r\n\tCurrentScore.visible = false\r\n\tCurrentScore.align = left\r\n\tCurrentScore.color = #EEEEEE\r\n\r\n\tHighScore = ui.AddText()\r\n\tHighScore.text = modename + \" History \" + hscore\r\n\tHighScore.x = 0\r\n\tHighScore.y = -screen.h/2\r\n\tHighScore.w = string.Size(modename + \"History\" + hscore) + 2\r\n\tHighScore.h = 1\r\n\tHighScore.anchor = center_left\r\n\tHighScore.dock = center_left\r\n\tHighScore.visible = true\r\n\tHighScore.align = left\r\n\tHighScore.color = #EEEEEE\r\n\r\n\tModebutton = ui.AddButton()\r\n\tModebutton.x = 0\r\n\tModebutton.y = -3\r\n\tModebutton.text = te.xt(Mode)\r\n\tModebutton.w = string.Size(Modebutton.text) + 2\r\n\tModebutton.h = 3\r\n\tModebutton.anchor = center_center\r\n\tModebutton.dock = center_center\r\n\tModebutton.tcolor = #EEEEEE\r\n\tModebutton.bcolor = #666666\r\n\tModebutton.hcolor = #999999\r\n\tModebutton.sound = confirm\r\n\tModebutton.style = 1\r\n\tModebutton.SetPressed(ModeSelect)\r\n\r\n\tEasybutton = ui.AddButton()\r\n\tEasybutton.x = string.Size(Modebutton.text) + 2\r\n\tEasybutton.y = -3\r\n\tEasybutton.text = te.xt(Easy)\r\n\tEasybutton.w = string.Size(Easybutton.text) + 2\r\n\tEasybutton.h = 3\r\n\tEasybutton.anchor = center_center\r\n\tEasybutton.dock = center_center\r\n\tEasybutton.tcolor = #232323\r\n\tEasybutton.bcolor = #666666\r\n\tEasybutton.hcolor = #999999\r\n\tEasybutton.sound = bronze_guardian_attack1\r\n\tEasybutton.style = 1\r\n\tEasybutton.visible = false\r\n\tEasybutton.SetPressed(SelectEasy)\r\n\r\n\tHardbutton = ui.AddButton()\r\n\tHardbutton.x = string.Size(Modebutton.text) + string.Size(Easybutton.text) + 4\r\n\tHardbutton.y = -3\r\n\tHardbutton.text = te.xt(Hard)\r\n\tHardbutton.w = string.Size(Hardbutton.text) + 2\r\n\tHardbutton.h = 3\r\n\tHardbutton.anchor = center_center\r\n\tHardbutton.dock = center_center\r\n\tHardbutton.tcolor = #232323\r\n\tHardbutton.bcolor = #666666\r\n\tHardbutton.hcolor = #999999\r\n\tHardbutton.sound = bronze_guardian_helmet\r\n\tHardbutton.style = 1\r\n\tHardbutton.visible = false\r\n\tHardbutton.SetPressed(SelectHard)\r\n\r\n\tStartbutton = ui.AddButton()\r\n\tStartbutton.x = 0\r\n\tStartbutton.y = 0\r\n\tStartbutton.text = te.xt(Play)\r\n\tStartbutton.w = string.Size(Startbutton.text) + 6\r\n\tStartbutton.h = 3\r\n\tStartbutton.anchor = center_center\r\n\tStartbutton.dock = center_center\r\n\tStartbutton.tcolor = #EEEEEE\r\n\tStartbutton.bcolor = #666666\r\n\tStartbutton.hcolor = #999999\r\n\tStartbutton.sound = confirm\r\n\tStartbutton.style = 1\r\n\tStartbutton.SetPressed(StartAnim)\r\n\r\n\tMainmenubutton = ui.AddButton()\r\n\tMainmenubutton.x = -string.Size(te.xt(Continue)) - 6\r\n\tMainmenubutton.y = 0\r\n\tMainmenubutton.text = te.xt(\"Back\")\r\n\tMainmenubutton.w = string.Size(te.xt(\"Back\")) + 4\r\n\tMainmenubutton.h = 3\r\n\tMainmenubutton.anchor = center_center\r\n\tMainmenubutton.dock = center_center\r\n\tMainmenubutton.visible = false\r\n\tMainmenubutton.tcolor = #EEEEEE\r\n\tMainmenubutton.bcolor = #666666\r\n\tMainmenubutton.hcolor = #999999\r\n\tMainmenubutton.sound = confirm\r\n\tMainmenubutton.style = 1\r\n\tMainmenubutton.SetPressed(Back)\r\n\r\n\tGAMEOVER = ui.AddText()\r\n\tGAMEOVER.x = 0\r\n\tGAMEOVER.y = -3\r\n\tGAMEOVER.w = 9\r\n\tGAMEOVER.h = 1\r\n\tGAMEOVER.anchor = center_center\r\n\tGAMEOVER.dock = center_center\r\n\tGAMEOVER.visible = false\r\n\tGAMEOVER.align = \"center\"\r\n\tGAMEOVER.text = \"GAME OVER\"\r\n\tGAMEOVER.color = #ff2222\r\n\r\n\teagle = ui.AddAnim(ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n###(`'~-.,_#########'.`'-.\r\n##(`'-~-.,_`.#########':--.;\r\n##(`'-~-.____\\#########;--: \\\r\n###(-.'_______`.,######;--:`|\r\n####(._______.   '.###/--:``/\r\n#####'._____.  /   '.|--:``;\r\n########'.____ (     ;._ `/\r\n##########'..__ '.    \\ ,`'~.-._\r\n#############`._.\\     -:      ò'.\r\n###############`-.\\ .'   \\_.-~-.=.)\r\n################/  `     ;´\r\n############_.-´  .;  ;  ;\r\n###########(_.´ ;  .; ;; :\r\n############(_.´ ;_-‾\\\\_\\\\_\r\n##############'-´####/`(\"/`)-..\r\nasciiend)\r\n\teagle.anchor = center_left\r\n\teagle.dock = center_left\r\n\teagle.x = -10\r\n\teagle.y = -4\r\n\teagle.w = 36\r\n\teagle.h = 20\r\n\teagle.pivotX = 60\r\n\teagle.pivotY = 20\r\n\teagle.color = #9f9f9f\r\n\teagle.duration = 0\r\n\teagle.frame = 0\r\n\teagle.loop = false\r\n\teagle.playOnStart = false\r\n\teagle.visible = true\r\n\teagle.Stop()\r\n\r\n\ttranstyle = ui.AddStyle(\"#########\")\r\n\r\n\tFrog = ui.AddPanel()\r\n\tFrog.x = 9\r\n\tFrog.y = 5\r\n\tFrog.w = 9\r\n\tFrog.h = 5\r\n\tFrog.anchor = center_left\r\n\tFrog.dock = center_left\r\n\tFrog.clip = false\r\n\tFrog.color = #white\r\n\tFrog.style = transtyle\r\n\r\n\tFrogJump = ui.AddAnim(ascii\r\n#\r\n#\r\n#####,--\r\n###(! .-)\r\n###'·-((\r\n%%\r\n#\r\n#####,--\r\n####/ .-)\r\n##_(;-//\r\n###`\r\n%%\r\n#####.=-\r\n### / .-)\r\n##_(/-)´`\r\n#-´‾\r\n#\r\n%%\r\n#####.O-\r\n###,´ .-)\r\n#_(/--‾´‾\r\n-´‾\r\n#\r\n%%\r\n#####.Oo\r\n###,´ .-)\r\n-´-`--‾´‾\r\n#\r\n#\r\n%%\r\n#\r\n#####.Oo\r\n-´-`´ .-)\r\n####`-‾´‾\r\n#\r\n%%\r\n#\r\n#\r\n##_##.Oo\r\n#/-`´ .-)\r\n###`--\\´\\\r\n%%\r\n#\r\n#\r\n#####,Oo\r\n##(\\/ .-)\r\n##´ ·-\\´\\\r\nasciiend)\r\n\tFrogJump.anchor = center_left\r\n\tFrogJump.dock = center_left\r\n\tFrogJump.x = 0\r\n\tFrogJump.y = 0\r\n\tFrogJump.w = 9\r\n\tFrogJump.h = 5\r\n\tFrogJump.pivotX = 0\r\n\tFrogJump.pivotY = 0\r\n\tFrogJump.color = #32da5a\r\n\tFrogJump.duration = 30\r\n\tFrogJump.frame = 0\r\n\tFrogJump.gamePause = true\r\n\tFrogJump.loop = true\r\n\tFrogJump.Play()\r\n\tFrog.Add(FrogJump)\r\n\r\n\tFrogEye = ui.AddAnim(ascii\r\n#\r\n#\r\n######--\r\n#\r\n#\r\n%%\r\n#\r\n######--\r\n#\r\n#\r\n#\r\n%%\r\n######=-\r\n#\r\n#\r\n#\r\n#\r\n%%\r\n######O-\r\n#\r\n#\r\n#\r\n#\r\n%%\r\n######Oo\r\n#\r\n#\r\n#\r\n#\r\n%%\r\n#\r\n######Oo\r\n#\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n######Oo\r\n#\r\n#\r\n%%\r\n#\r\n#\r\n######Oo\r\n#\r\n#\r\nasciiend)\r\n\tFrogEye.anchor = center_left\r\n\tFrogEye.dock = center_left\r\n\tFrogEye.x = 0\r\n\tFrogEye.y = 0\r\n\tFrogEye.w = 9\r\n\tFrogEye.h = 5\r\n\tFrogEye.pivotX = 0\r\n\tFrogEye.pivotY = 0\r\n\tFrogEye.color = #EEEEEE\r\n\tFrogEye.duration = 30\r\n\tFrogEye.frame = 0\r\n\tFrogEye.gamePause = true\r\n\tFrogEye.loop = true\r\n\tFrogEye.Play()\r\n\tFrog.Add(FrogEye)\r\n\r\n\tJumpArrow = ui.AddAnim(ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n.......\r\n##;;;:;\r\n.;;;::;\r\n######'\r\n%%\r\n#\r\n#\r\n#\r\n#\r\n##.......\r\n####;;;:;\r\n##.;;;::;\r\n.;;;:###'\r\n%%\r\n#\r\n#\r\n#\r\n####.......\r\n######;;;:;\r\n####.;;;::;\r\n##.;;;:###'\r\n.;;;:\r\n%%\r\n#\r\n#\r\n######.......\r\n########;;;:;\r\n######.;;;::;\r\n####.;;;:###'\r\n##.;;;:\r\n.;;;:\r\n%%\r\n#\r\n########.......\r\n##########;;;:;\r\n########.;;;::;\r\n######.;;;:###'\r\n####.;;;:\r\n##.;;;:\r\n.;;;:\r\n%%\r\n##########.......\r\n############;;;:;\r\n##########.;;;::;\r\n########.;;;:###'\r\n######.;;;:\r\n####.;;;:\r\n##.;;;:\r\n.;;;:\r\nasciiend)\r\n\tJumpArrow.x = 15\r\n\tJumpArrow.y = 1\r\n\tJumpArrow.w = 17\r\n\tJumpArrow.h = 8\r\n\tJumpArrow.anchor = center_left\r\n\tJumpArrow.dock = center_left\r\n\tJumpArrow.visible = false\r\n\tJumpArrow.pivotX = 0\r\n\tJumpArrow.pivotY = 0\r\n\tJumpArrow.color = #02e5ff\r\n\tJumpArrow.duration = 72\r\n\tJumpArrow.frame = 0\r\n\tJumpArrow.gamePause = true\r\n\tJumpArrow.loop = false\r\n\tJumpArrow.Stop()\r\n\r\nfunc DisplayAryControl(array)\r\n\t?array.Count() > 0\r\n\t\t?array[0] = 1\r\n\t\t\tLilyPod0.frame = 0\r\n\t\t:\r\n\t\t\tLilyPod0.frame = 1\r\n\t\t?array.Count() > 1\r\n\t\t\t?array[1] = 1\r\n\t\t\t\tLilyPod1.frame = 0\r\n\t\t\t:\r\n\t\t\t\tLilyPod1.frame = 1\r\n\t\t\t?array.Count() > 2\r\n\t\t\t\t?array[2] = 1\r\n\t\t\t\t\tLilyPod2.frame = 0\r\n\t\t\t\t:\r\n\t\t\t\t\tLilyPod2.frame = 1\r\n\t\t\t\t?array.Count() > 3\r\n\t\t\t\t\t?array[3] = 1\r\n\t\t\t\t\t\tLilyPod3.frame = 0\r\n\t\t\t\t\t:\r\n\t\t\t\t\t\tLilyPod3.frame = 1\r\n\t\t\t\t\t?array.Count() > 4\r\n\t\t\t\t\t\t?array[4] = 1\r\n\t\t\t\t\t\t\tLilyPod4.frame = 0\r\n\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\tLilyPod4.frame = 1\r\n\t\t\t\t\t\t?array.Count() > 5\r\n\t\t\t\t\t\t\t?array[5] = 1\r\n\t\t\t\t\t\t\t\tLilyPod5.frame = 0\r\n\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\tLilyPod5.frame = 1\r\n\t\t\t\t\t\t\t?array.Count() > 6\r\n\t\t\t\t\t\t\t\t?array[6] = 1\r\n\t\t\t\t\t\t\t\t\tLilyPod6.frame = 0\r\n\t\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\t\tLilyPod6.frame = 1\r\n\t\t\t\t\t\t\t\t?array.Count() > 7\r\n\t\t\t\t\t\t\t\t\t?array[7] = 1\r\n\t\t\t\t\t\t\t\t\t\tLilyPod7.frame = 0\r\n\t\t\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\t\t\tLilyPod7.frame = 1\r\nDisplayAryControl(LotuAry)\r\n\r\nfunc CoinAryControl(array)\r\n\t?array.Count() > 0\r\n\t\t?array[0] = 1\r\n\t\t\tCoin0.frame = 0\r\n\t\t:\r\n\t\t\tCoin0.frame = 1\r\n\t\t?array.Count() > 1\r\n\t\t\t?array[1] = 1\r\n\t\t\t\tCoin1.frame = 0\r\n\t\t\t:\r\n\t\t\t\tCoin1.frame = 1\r\n\t\t\t?array.Count() > 2\r\n\t\t\t\t?array[2] = 1\r\n\t\t\t\t\tCoin2.frame = 0\r\n\t\t\t\t:\r\n\t\t\t\t\tCoin2.frame = 1\r\n\t\t\t\t?array.Count() > 3\r\n\t\t\t\t\t?array[3] = 1\r\n\t\t\t\t\t\tCoin3.frame = 0\r\n\t\t\t\t\t:\r\n\t\t\t\t\t\tCoin3.frame = 1\r\n\t\t\t\t\t?array.Count() > 4\r\n\t\t\t\t\t\t?array[4] = 1\r\n\t\t\t\t\t\t\tCoin4.frame = 0\r\n\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\tCoin4.frame = 1\r\n\t\t\t\t\t\t?array.Count() > 5\r\n\t\t\t\t\t\t\t?array[5] = 1\r\n\t\t\t\t\t\t\t\tCoin5.frame = 0\r\n\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\tCoin5.frame = 1\r\n\t\t\t\t\t\t\t?array.Count() > 6\r\n\t\t\t\t\t\t\t\t?array[6] = 1\r\n\t\t\t\t\t\t\t\t\tCoin6.frame = 0\r\n\t\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\t\tCoin6.frame = 1\r\n\t\t\t\t\t\t\t\t?array.Count() > 7\r\n\t\t\t\t\t\t\t\t\t?array[7] = 1\r\n\t\t\t\t\t\t\t\t\t\tCoin7.frame = 0\r\n\t\t\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\t\t\tCoin7.frame = 1\r\nCoinAryControl(CoinAry)\r\n\r\nfunc GenerateNewLily(array)\r\n\t?staytime = 1\r\n\t\trngLD = rng % 64\r\n\t\tvar carry = rngLD\r\n\t\tfor i = 5..0\r\n\t\t\tcarry = carry - math.Pow(2, i)\r\n\t\t\t?carry >= 0\r\n\t\t\t\tEmAry[5-i] = 1\r\n\t\t\t:\r\n\t\t\t\tEmAry[5-i] = 0\r\n\t\t\t\tcarry = carry + math.Pow(2, i)\r\n\t\t?startpos > 1 & presstime = -1\r\n\t\t\tscore = startpos\r\n\t\t\tfor i = 0..7\r\n\t\t\t\t?i < 9 - startpos\r\n\t\t\t\t\tarray.Emplace(i, array[i + startpos - 1])\r\n\t\t\t\t:?i < 7\r\n\t\t\t\t\tarray.Emplace(i, EmAry[i-2])\r\n\t\t\t\t:?!(array[2] = 0 & array[3] = 0 & array[4] = 0 & array[5] = 0 & array[6] = 0)\r\n\t\t\t\t\tarray.Emplace(7, EmAry[5])\r\n\t\t\t\t:\r\n\t\t\t\t\tarray.Emplace(7, 1)\r\n\t\t:\r\n\t\t\tscore = score + presstime\r\n\t\t\tfor i = 0..7\r\n\t\t\t\t?i < 8 - presstime\r\n\t\t\t\t\tarray.Emplace(i, array[i + presstime])\r\n\t\t\t\t:?i < 7\r\n\t\t\t\t\tarray.Emplace(i, EmAry[i-2])\r\n\t\t\t\t:?!(array[2] = 0 & array[3] = 0 & array[4] = 0 & array[5] = 0 & array[6] = 0)\r\n\t\t\t\t\tarray.Emplace(7, EmAry[5])\r\n\t\t\t\t:\r\n\t\t\t\t\tarray.Emplace(7, 1)\r\nGenerateNewLily(LotuAry)\r\n\r\nfunc GenerateNewCoin(array)\r\n\t?staytime = 1\r\n\t\tfor i = 0..5\r\n\t\t\t?EmAry[i] = 1 & (rngLD + i) % 3 = 0\r\n\t\t\t\tCoinSubAry[i] = 1\r\n\t\t\t:\r\n\t\t\t\tCoinSubAry[i] = 0\r\n\t\t?startpos > 1 & presstime = -1\r\n\t\t\tfor i = 0..7\r\n\t\t\t\t?i < 9 - startpos\r\n\t\t\t\t\tarray.Emplace(i, array[i + startpos - 1])\r\n\t\t\t\t\t?array[1] = 1\r\n\t\t\t\t\t\tarray.Emplace(1,0)\r\n\t\t\t\t\t\tplay equip\r\n\t\t\t\t\t\tCoinNO = CoinNO + math.RoundToInt(12/tranphase)\r\n\t\t\t\t\t\tstorage.Set(totalcoins, totalCoinNO)\r\n\t\t\t\t\t\ttotalCoinNO = storage.Incr(totalcoins,math.RoundToInt(12/tranphase))\r\n\t\t\t\t:\r\n\t\t\t\t\tarray.Emplace(i, CoinSubAry[i-2])\r\n\t\t:\r\n\t\t\tfor i = 0..7\r\n\t\t\t\t?i < 8 - presstime\r\n\t\t\t\t\tarray.Emplace(i, array[i + presstime])\r\n\t\t\t\t\t?array[1] = 1\r\n\t\t\t\t\t\tarray.Emplace(1,0)\r\n\t\t\t\t\t\tplay equip\r\n\t\t\t\t\t\tCoinNO = CoinNO + math.RoundToInt(12/tranphase)\r\n\t\t\t\t\t\tstorage.Set(totalcoins, totalCoinNO)\r\n\t\t\t\t\t\ttotalCoinNO = storage.Incr(totalcoins,math.RoundToInt(12/tranphase))\r\n\t\t\t\t:\r\n\t\t\t\t\tarray.Emplace(i, CoinSubAry[i-2])\r\nGenerateNewCoin(CoinAry)\r\n\r\n?FrogJump.frame = 0 & croakonce = 0\r\n\tplay frog\r\n\tcroakonce = 1\r\n?FrogJump.frame ! 0\r\n\tcroakonce = 0\r\n\r\n?frogtime > 0 & eagle.visible = false\r\n\tfrogtime++\r\n?staytime > 0\r\n\tstaytime++\r\n\r\n?starttime > 0 & key = primaryEnd & frogtime = 0 & (input.x > Frog.absoluteX + 1 & input.x < Frog.absoluteX + Frog.w) & (input.y > Frog.absoluteY + 1 & input.y < Frog.absoluteY + Frog.h)\r\n\tpresstime = math.Clamp(math.CeilToInt(starttime%(6*tranphase)/tranphase),1,6)\r\n\tFrogJump.duration = math.RoundToInt(math.Sqrt(200*presstime))\r\n\tFrogEye.duration = FrogJump.duration\r\n\tstarttime = 0\r\n\tstaytime = 0\r\n\tfrogtime++\r\n\tFrogJump.Play()\r\n\tFrogEye.Play()\r\n:?key = primaryBegin & frogtime = 0 & (input.x > Frog.absoluteX + 1 & input.x < Frog.absoluteX + Frog.w) & (input.y > Frog.absoluteY + 1 & input.y < Frog.absoluteY + Frog.h)\r\n\tstarttime = 1\r\n:?starttime > 0 & key = primary & frogtime = 0 & (input.x > Frog.absoluteX + 1 & input.x < Frog.absoluteX + Frog.w) & (input.y > Frog.absoluteY + 1 & input.y < Frog.absoluteY + Frog.h)\r\n\tstarttime++\r\n:\r\n\tstarttime = 0\r\n\r\n?starttime > 0\r\n\tJumpArrow.visible = true\r\n\t?starttime%(6*tranphase) < tranphase + 1\r\n\t\tJumpArrow.color = color.Lerp(#78EAF7, #02e5ff, starttime%(6*tranphase)/tranphase)\r\n\t\tJumpArrow.frame = 0\r\n\t:?starttime%(6*tranphase) < 2 * tranphase + 1\r\n\t\tJumpArrow.color = color.Lerp(#80F2B0, #ffff62, (starttime%(6*tranphase)-tranphase)/tranphase)\r\n\t\tJumpArrow.frame = 1\r\n\t:?starttime%(6*tranphase) < 3 * tranphase + 1\r\n\t\tJumpArrow.color = color.Lerp(#98ED5E, #32da5a, (starttime%(6*tranphase)-2*tranphase)/tranphase)\r\n\t\tJumpArrow.frame = 2\r\n\t:?starttime%(6*tranphase) < 4 * tranphase + 1\r\n\t\tJumpArrow.color = color.Lerp(#199EAC, #0063ff, (starttime%(6*tranphase)-3*tranphase)/tranphase)\r\n\t\tJumpArrow.frame = 3\r\n\t:?starttime%(6*tranphase) < 5 * tranphase + 1\r\n\t\tJumpArrow.color = color.Lerp(#804290, #ff2222, (starttime%(6*tranphase)-4*tranphase)/tranphase)\r\n\t\tJumpArrow.frame = 4\r\n\t:\r\n\t\tJumpArrow.color = #rainFF\r\n\t\tJumpArrow.frame = 5\r\n:\r\n\tJumpArrow.visible = false\r\n\tJumpArrow.color = #78EAF7\r\n\tJumpArrow.frame = 0\r\n\r\nfunc ModeSelect()\r\n\t?tranphase = 12.0\r\n\t\tEasybutton.style = 3\r\n\t\tEasybutton.tcolor = #EEEEEE\r\n\t\tHardbutton.style = 9\r\n\t\tHardbutton.tcolor = #232323\r\n\t:?tranphase = 6.0\r\n\t\tEasybutton.style = 9\r\n\t\tEasybutton.tcolor = #232323\r\n\t\tHardbutton.style = 3\r\n\t\tHardbutton.tcolor = #EEEEEE\r\n\tEasybutton.visible = !Easybutton.visible\r\n\tHardbutton.visible = !Hardbutton.visible\r\n\r\nfunc SelectEasy()\r\n\ttranphase = 12.0\r\n\tmodename = \"Easy\"\r\n\thscore = storage.Get(\"eahighscore\", 0)\r\n\tHighScore.text = modename + \" History \" + hscore\r\n\tHighScore.w = string.Size(modename + \"History\" + hscore) + 2\r\n\tModebutton.w = string.Size(te.xt(Easy)) + 2\r\n\tModebutton.text = te.xt(Easy)\r\n\tEasybutton.visible = !Easybutton.visible\r\n\tHardbutton.visible = !Hardbutton.visible\r\n\r\nfunc SelectHard()\r\n\ttranphase = 6.0\r\n\tmodename = \"Hard\"\r\n\thscore = storage.Get(\"hdhighscore\", 0)\r\n\tHighScore.text = modename + \" History \" + hscore\r\n\tHighScore.w = string.Size(modename + \"History\" + hscore) + 2\r\n\tModebutton.w = string.Size(te.xt(Hard)) + 2\r\n\tModebutton.text = te.xt(Hard)\r\n\tEasybutton.visible = !Easybutton.visible\r\n\tHardbutton.visible = !Hardbutton.visible\r\n\r\nfunc StartAnim()\r\n\tCoinNO = 0\r\n\tscore = 0\r\n\tCurrentCoin.visible = true\r\n\tCurrentScore.visible = true\r\n\tTotalCoin.visible = false\r\n\tGAMEOVER.visible = false\r\n\tfrogtime = 1\r\n\t?eagle.visible = true\r\n\t\tflytime = 1\r\n\t\tFrogJump.loop = false\r\n\t\tFrogEye.loop = false\r\n\t:\r\n\t\tFrog.visible = true\r\n\t\tFrogJump.duration = math.RoundToInt(math.Sqrt(200*(startpos+1)))\r\n\t\tFrogEye.duration = FrogJump.duration\r\n\t\tFrogJump.Play()\r\n\t\tFrogEye.Play()\r\n\tStartbutton.visible = false\r\n\tModebutton.visible = false\r\n\tEasybutton.visible = false\r\n\tHardbutton.visible = false\r\n\tMainmenubutton.visible = false\r\n\r\nfunc Back()\r\n\tLotuAry = [0,1,1,1,1,1,1,1]\r\n\tCoinAry[0] = 0\r\n\tCoinAry[1] = 0\r\n\trngLD = rng % 64\r\n\tfor i = 0..5\r\n\t\t?(rngLD + i) % 3 = 0\r\n\t\t\tCoinAry[i+2] = 1\r\n\t\t:\r\n\t\t\tCoinAry[i+2] = 0\r\n\tstartpos = 1\r\n\tflytime = 0\r\n\tstaytime = 0\r\n\tfrogtime = -1\r\n\tstarttime = 0\r\n\tpresstime = -1\r\n\tFrog.visible = true\r\n\tFrog.x = 9\r\n\tFrog.y = 5\r\n\tFrogJump.loop = true\r\n\tFrogEye.loop = true\r\n\tFrogJump.duration = 30\r\n\tFrogEye.duration = 30\r\n\tFrogJump.Play()\r\n\tFrogEye.Play()\r\n\teagle.visible = true\r\n\teagle.pivotX = 60\r\n\teagle.pivotY = 20\r\n\tLOGO.visible = true\r\n\tLOGO.pivotX = 0\r\n\tGAMEOVER.visible = false\r\n\tCurrentScore.visible = false\r\n\tModebutton.visible = true\r\n\tStartbutton.text = te.xt(Play)\r\n\tStartbutton.w = string.Size(Startbutton.text) + 6\r\n\tMainmenubutton.visible = false\r\n\r\nCurrentCoin.text = CoinNO + \" [color=#ffd700]$[/color]\"\r\nCurrentCoin.w = string.Size(\"\" + CoinNO) + 2\r\n\r\nCurrentScore.text = \"current score\" + \" \" + score\r\nCurrentScore.w = string.Size(\"current score\" + score) + 1\r\n\r\n?flytime = 1\r\n\tplay scout_arrives\r\n?flytime > 0\r\n\tflytime++\r\n?flytime > 60\r\n\tLOGO.visible = false\r\n\teagle.visible = false\r\n\tflytime = 0\r\n\t?frogtime = 1\r\n\t\tFrogJump.duration = 20\r\n\t\tFrogEye.duration = 20\r\n\t\tFrogJump.Play()\r\n\t\tFrogEye.Play()\r\n:?flytime > 30\r\n\teagle.pivotX = 60 - 2*flytime\r\n\teagle.pivotY = math.RoundToInt(5*math.Pow((flytime-30)*0.066, 2))\r\n\tFrog.x = 9 - eagle.pivotX\r\n\tFrog.y = 5 - eagle.pivotY\r\n:?flytime > 0\r\n\teagle.pivotX = 60 - 2*flytime\r\n\teagle.pivotY = math.RoundToInt(20 - 5*math.Pow(flytime*0.066, 2))\r\n\tLOGO.pivotX = -3*flytime\r\n\r\n?presstime = -1\r\n\t?frogtime > 0 & eagle.visible = false\r\n\t\tFrog.x = math.RoundToInt(math.Sqrt((startpos+1)/2.0)*frogtime-11)\r\n\t\tFrog.y = math.RoundToInt(math.Sqrt((startpos+1)/2.0)*frogtime*(math.Sqrt((startpos+1)/2.0)*frogtime-10*(startpos+1))/(10*(startpos+1))+5)\r\n\t\t?Frog.x >= 10*startpos - 1\r\n\t\t\tfrogtime = 0\r\n\t\t\t?startpos > 1\r\n\t\t\t\tstaytime = 1\r\n\t?frogtime = 0 & eagle.visible = false\r\n\t\tFrog.x = 9\r\n\t\tFrog.y = 5\r\n:\r\n\tFrog.x = math.Min(math.RoundToInt(math.Sqrt(presstime/2.0)*frogtime+9),10*presstime+9)\r\n\tFrog.y = math.Min(math.RoundToInt((math.Sqrt(presstime/2.0)*frogtime)*(math.Sqrt(presstime/2.0)*frogtime-10*presstime)/(10*presstime)+5),5)\r\n\t?Frog.x >= 10*presstime+9\r\n\t\tfrogtime = 0\r\n\t\tstaytime = 1\r\n\r\n?FrogJump.frame = 6 & frogtime > 0\r\n\tFrogJump.Pause()\r\n\tFrogEye.Pause()\r\n?FrogJump.paused & Frog.y > 3\r\n\tFrogJump.Play()\r\n\tFrogEye.Play()\r\n\r\n?presstime ! - 1 & LotuAry[1] = 0 & staytime = 2\r\n\tCurrentCoin.visible = false\r\n\t?hscore < score\r\n\t\t?string.Equals(modename, \"Easy\")\r\n\t\t\tstorage.Set(\"eahighscore\", score)\r\n\t\t:?string.Equals(modename, \"Hard\")\r\n\t\t\tstorage.Set(\"hdhighscore\", score)\r\n\t?string.Equals(modename, \"Easy\")\r\n\t\thscore = storage.Get(\"eahighscore\", 0)\r\n\t:?string.Equals(modename, \"Hard\")\r\n\t\thscore = storage.Get(\"hdhighscore\", 0)\r\n\tHighScore.text = modename + \" History \" + hscore\r\n\tHighScore.w = string.Size(modename + \"History\" + hscore) + 2\r\n\tTotalCoin.text = te.xt(tid_treasures_found) + \" \" + totalCoinNO + \" [color=#ffd700]$[/color]\"\r\n\tTotalCoin.w = string.Size(te.xt(tid_treasures_found) + totalCoinNO) + 3\r\n\tTotalCoin.visible = true\r\n\tplay cross_deadwood_splash\r\n\teagle.visible = true\r\n\tGAMEOVER.visible = true\r\n\tflytime = 1\r\n\tfrogtime = -1\r\n\tstarttime = 0\r\n\tpresstime = -1\r\n\tstaytime = 0\r\n\tfor i = 1..7\r\n\t\t?LotuAry[i] = 1\r\n\t\t\tstartpos = i\r\n\t\t\ti = 8\r\n?LotuAry[1] = 0 & flytime = 60\r\n\tStartbutton.text = te.xt(Continue)\r\n\tStartbutton.w = string.Size(Startbutton.text) + 6\r\n\tStartbutton.visible = true\r\n\tMainmenubutton.visible = true\r\n\tFrog.visible = false\r\nimport UI/RecordPlayer\r\n/*\r\n>`0,0,frogtime @frogtime@ flytime @flytime@ startpos @startpos@ duration @FrogJump.duration@\r\n>`0,1,starttime@starttime@ presstime@presstime@ staytime@staytime@ mode @tranphase@\r\n>`0,2,@rngLD@ @EmAry[0]@ @EmAry[1]@ @EmAry[2]@ @EmAry[3]@ @EmAry[4]@ @EmAry[5]@\r\n>`0,3,@CoinSubAry[0]@ @CoinSubAry[1]@ @CoinSubAry[2]@ @CoinSubAry[3]@ @CoinSubAry[4]@ @CoinSubAry[5]@ \r\n*/"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Metallophone.txt" - Parse error: Failed to parse completely. Remaining: "=[0,2,4,5,7,9,11]\r\nvar bl=[1,3,6,8,10]\r\n\r\nvar y=0\r\nvar x=0\r\nvar isMobile=sys.isMobile\r\nvar played=-2\r\nvar w=screen.w\r\nvar h=screen.h\r\n?played<0\r\n    ?played=-2\r\n        play ui_starold2\r\n        played=-1\r\n    ambient.Stop()\r\n    music.Stop()\r\n>`0,@h-10@,@key1@\r\n?w>28*3\r\n    >`28,@h-10@,@key2@\r\n    >`56,@h-10@,@key2@\r\n:?w>28*2\r\n    >`28,@h-10@,@key2@\r\nfunc pitch(num)\r\n    return math.RoundToInt(39.9429*math.Pow(2.0, num/12.0))\r\ny=input.y-h+10\r\nx=input.x\r\n?!isMobile\r\n    w=screen.w\r\n    h=screen.h\r\n?key=primaryBegin&y>0&x<((w/28))*28&x>-1&y<8\r\n    ?isMobile\r\n        draw.Bg(input.x-1,input.y-1,\"#FFFFFF\",3,3)\r\n    ?played+3<totaltime\r\n        ?y<5&((x-3)%28)%4<3\r\n            ?((x-3)%28)/4=2|((x-3)%28)/4=6\r\n                play ui_starold2 @pitch((x/28)*12+wh[(x/4)%7])@\r\n            :?((x-3)%28)/4>2\r\n                play ui_starold2 @pitch((x/28)*12+bl[((x-3)/4)%7-1])@\r\n            :\r\n                play ui_starold2 @pitch((x/28)*12+bl[((x-3)/4)%7])@\r\n        :\r\n            play ui_starold2 @pitch((x/28)*12+wh[(x/4)%7])@\r\n        played=totaltime\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Snake.txt" - Parse error: Failed to parse completely. Remaining: "= []\r\nvar titleText\r\nvar speedChooseText\r\nvar guideText\r\n\r\nvar height = screen.h - 2\r\nvar width = height\r\n\r\nvar loopStopTime = 0\r\nvar timer = 0\r\n\r\nvar space = []\r\n\r\nvar headX = width / 2\r\nvar headY = height / 2\r\n\r\nvar direction = 8\r\nvar currentDirection = 8\r\n\r\nvar initialLevel = 1\r\nvar currentLevel = 1\r\nvar speed = 10\r\n\r\nvar length = 0\r\nvar eaten = 0\r\n\r\nvar food = true\r\nvar foodX = headX\r\nvar foodY = headY\r\n\r\nvar body = []\r\nvar color = \"#FFFFFF\"\r\nvar ouroborosColor = [\"#FF0000\",\"#FF7F00\",\"#FFFF00\",\"#00FF00\",\"#00FFFF\",\"#0000FF\",\"#8B00FF\"]\r\nvar ouroboros = -1\r\n\r\nvar score = 0\r\nvar highestScore = storage.Get(\"snake_high\", 0)\r\nvar highestScoreX\r\n\r\nvar state = \"initialize\"\r\n\r\nvar cc = 0\r\n\r\n\r\n\r\n//////////////////////////////////\r\n//////////     main     //////////\r\n//////////////////////////////////\r\n\r\n\r\nfunc main()\r\n\t?loc.loop\r\n\t\tBuildUI()\r\n\t\t\r\n\t\t?body.Count()\r\n\t\t\tfor i = 0..body.Count() - 1\r\n\t\t\t\tshowCanvas.Set(body[i][0] * 2, body[i][1], color, \"o\")\r\n\t\tshowCanvas.Set(headX * 2, headY, color, \"O\")\r\n\r\n\t\t?string.Equals(state, \"title\")\r\n\t\t\ttitle()\r\n\t\t:?string.Equals(state, \"gameover\")\r\n\t\t\tgameover()\r\n\t\t:?string.Equals(state, \"playing\")\r\n\t\t\tsetConfirmButton(\"stop\")\r\n\t\t\tloopStopTime = 30\r\n\t\t\ttimer = 0\r\n\r\n\t?string.Equals(state, \"initialize\")\r\n\t\tBuildUI()\r\n\t\ttitle()\r\n\t\tfoodt.visible = false\r\n\t\tstate = \"title\"\r\n\t:?string.Equals(state, \"setupData\")\r\n\t\tfor i = 1..height\r\n\t\t\t?cc < width * height\r\n\t\t\t\t?cc ! getIndex(headX, headY)\r\n\t\t\t\t\tspace.Add(cc)\r\n\t\t\t\tcc++\r\n\t\t\t:\r\n\t\t\t\tsetFood()\r\n\t\t\t\tfoodt.visible = true\r\n\t\t\t\ttitleText.visible = false\r\n\t\t\t\tspeedChooseText.visible = false\r\n\t\t\t\tguideText.visible = false\r\n\t\t\t\tsetConfirmButton(\"stop\")\r\n\t\t\t\tstate = \"playing\"\r\n\t\t\t\tbreak\r\n\t:?string.Equals(state, \"playing\")\r\n\t\t?loopStopTime\r\n\t\t\tloopStopTime--\r\n\t\t\t>c0,0,@loopStopTime@\r\n\t\t:\r\n\t\t\tplaying()\r\n\t:?string.Equals(state, \"stop\")\r\n\t\t>c-3,0,s t o p\r\n\t:?string.Equals(state, \"gameover\")\r\n\t\t?ouroboros ! -1 & totaltime % 3 = 0\r\n\t\t\touroboros = (ouroboros + 1) % 7\r\n\t\t\tfor i = 0..body.Count() - 1\r\n\t\t\t\tshowCanvas.Set(body[i][0] * 2, body[i][1], ouroborosColor[(ouroboros + i) % 7], \"o\")\r\n\r\n\tdisplayScore()\r\n\tcheckInput()\r\n\t\r\n////////////////////////////////////////\r\n\r\n\r\nfunc BuildUI()\r\n\tmainWindow = ui.AddPanel()\r\n\tmainWindow.w = width * 2 + 2\r\n\tmainWindow.h = height + 2\r\n\tmainWindow.style = 3\r\n\t//mainWindow\r\n\r\n\tpnlCtrl = ui.AddPanel()\r\n\tpnlCtrl.w = 15\r\n\tpnlCtrl.h = 9\r\n\tpnlCtrl.x = 1\r\n\tpnlCtrl.y = 0\r\n\tpnlCtrl.style = 0\r\n\tpnlCtrl.anchor = center_left\r\n\tpnlCtrl.dock = center_left\r\n\tpnlCtrl.clip = true\r\n\tpnlCtrl.visible = true\r\n\t//mainWindow.Add(pnlCtrl)\r\n\r\n\tbuttonList.Clear()\r\n\r\n\tBuildConfirmButton()\r\n\tBuildArrowButton(5, 3, ascii\r\n#_\r\n| |\r\n\\_/\r\nasciiend)\r\n\tBuildArrowButton(0, 0, ascii\r\n#_\r\n/ |\r\n\\_|\r\nasciiend)\r\n\tBuildArrowButton(10, 0, ascii\r\n#_\r\n| \\\r\n|_/\r\nasciiend)\r\n\tBuildArrowButton(5, -3, ascii\r\n#_\r\n/ \\\r\n|_|\r\nasciiend)\r\n\tBuildShowCanvas()\r\n\tBuildTitleText()\r\n\tBuildSpeedChooseText()\r\n\tBuildguideText()\r\n\t\r\n\tfoodt = ui.AddText()\r\n\tfoodt.text = ascii\r\n#_\r\n(ʘ)\r\n#‾\r\nasciiend\r\n\tfoodt.w = 3\r\n\tfoodt.h = 3\r\n\tfoodt.x = foodX * 2\r\n\tfoodt.y = foodY\r\n\tfoodt.color = ouroborosColor[rng % 7]\r\n\tfoodt.anchor = top_left\r\n\tfoodt.dock = top_left\r\n\tmainWindow.Add(foodt)\r\n\r\n\thighestScoreX = mainWindow.absoluteX + mainWindow.w - numberLength(highestScore)\r\n\r\nfunc BuildConfirmButton()\r\n\tvar button = ui.AddButton()\r\n\tbutton.text = \"\"\r\n\tbutton.w = 5\r\n\tbutton.h = 3\r\n\tbutton.x = 5\r\n\tbutton.y = 0\r\n\tbutton.style = 0\r\n\tbutton.anchor = center_left\r\n\tbutton.dock = center_left\r\n\tbutton.SetPressed(buttonAction)\r\n\tbuttonList.Add(button)\r\n\tpnlCtrl.Add(button)\r\n\t\r\nfunc BuildFood(x, y, c)\r\n\tfoodt.x = x + 1\r\n\tfoodt.y = y\r\n\tfoodt.color = c\r\n\r\nfunc BuildArrowButton(x, y, t)\r\n\tvar button = ui.AddButton()\r\n\tbutton.text = \"\"\r\n\tbutton.w = 5\r\n\tbutton.h = 3\r\n\tbutton.x = x\r\n\tbutton.y = y\r\n\tbutton.tcolor = #EEEEEE\r\n\tbutton.bcolor = #666666\r\n\tbutton.hcolor = #999999\r\n\tbutton.style = 0\r\n\tbutton.anchor = center_left\r\n\tbutton.dock = center_left\r\n\tbutton.SetPressed(buttonAction)\r\n\tbuttonList.Add(button)\r\n\r\n\tvar text = ui.AddText()\r\n\ttext.text = t\r\n\ttext.w = 3\r\n\ttext.h = 3\r\n\ttext.x = x + 1\r\n\ttext.y = y\r\n\ttext.anchor = center_left\r\n\ttext.dock = center_left\r\n\r\n\tpnlCtrl.Add(button)\r\n\tpnlCtrl.Add(text)\r\n\r\nfunc BuildShowCanvas()\r\n\tshowCanvas = ui.AddCanvas()\r\n\tshowCanvas.w = mainWindow.w - 2\r\n\tshowCanvas.h = mainWindow.h - 2\r\n\tmainWindow.Add(showCanvas)\r\n\r\n\tshowCanvas.Set(headX * 2, headY, color, \"O\")\r\n\r\nfunc BuildTitleText()\r\n\ttitleText = ui.AddText()\r\n\ttitleText.w = mainWindow.w\r\n\ttitleText.h = 2\r\n\ttitleText.y = -mainWindow.h / 4\r\n\ttitleText.align = center\r\n\tmainWindow.Add(titleText)\r\n\r\nfunc BuildSpeedChooseText()\r\n\tspeedChooseText = ui.AddText()\r\n\tspeedChooseText.w = 9\r\n\tspeedChooseText.h = 2\r\n\tspeedChooseText.y = mainWindow.h / 8\r\n\tspeedChooseText.align = center\r\n\tmainWindow.Add(speedChooseText)\r\n\r\nfunc BuildguideText()\r\n\tguideText = ui.AddText()\r\n\tguideText.w = 18\r\n\tguideText.h = 1\r\n\tguideText.y = mainWindow.h / 4\r\n\tguideText.align = center\r\n\tmainWindow.Add(guideText)\r\n\r\nfunc buttonAction(btn)\r\n\t?buttonList[0] = btn\r\n\t\tconfirm()\r\n\t:\r\n\t\tfor i = 1..buttonList.Count() - 1\r\n\t\t\t?buttonList[i] = btn\r\n\t\t\t\t?string.Equals(state, \"title\") | string.Equals(state, \"gameover\")\r\n\t\t\t\t\tchangeInitialSpeed([-5,-1,1,5][i-1])\r\n\t\t\t\t:?string.Equals(state, \"playing\")\r\n\t\t\t\t\tsetDirection(i * 2)\r\n\t\t\t\tbreak\r\n\r\nfunc setSpeed()\r\n\t?eaten >= currentLevel * currentLevel * 10\r\n\t\tspeed = math.clamp(speed - 1, 1, 10)\r\n\t\tcurrentLevel = levelCalculation(speed)\r\n\r\nfunc reset()\r\n\ttimer = 0\r\n\t\r\n\theadX = width / 2\r\n\theadY = height / 2\r\n\tdirection = 8\r\n\tcurrentDirection = 8\r\n\tlength = 6\r\n\teaten = 0\r\n\t\r\n\tbody.Clear()\r\n\tcolor = \"#FFFFFF\"\r\n\t\r\n\tscore = 0\r\n\touroboros = -1\r\n\t\r\n\tcurrentLevel = initialLevel\r\n\tspeed = levelCalculation(initialLevel)\r\n\r\n\tshowCanvas.Set(\"#\")\r\n\tshowCanvas.Set(headX * 2, headY, color, \"O\")\r\n\r\n\tcc = 0\r\n\tspace.Clear()\r\n\tstate = \"setupData\"\r\n\r\n\r\n//////////     food     //////////\r\n\r\nfunc setFood()\r\n\tvar i\r\n\t?space.Count()\r\n\t\ti = space[rng % space.Count()]\r\n\t\tfoodX = i % width\r\n\t\tfoodY = (i - foodX) / width\r\n\t:\r\n\t\ti = body[0]\r\n\t\tfoodX = i[0]\r\n\t\tfoodY = i[1]\r\n\tBuildFood(foodX * 2, foodY, ouroborosColor[rng % 7])\r\n\r\n//////////     move     //////////\r\n\r\nfunc playing()\r\n\ttimer = (timer + 1) % speed\r\n\t?!timer\r\n\t\tbody.Add([headX, headY])\r\n\t\tshowCanvas.Set(headX * 2, headY, color, \"o\")\r\n\r\n\t\t?body.Count() > length\r\n\t\t\tvar x = body[0][0]\r\n\t\t\tvar y = body[0][1]\r\n\t\t\tspace.Add(getIndex(x, y))\r\n\t\t\tshowCanvas.Set(x * 2, y, \"#\")\r\n\t\t\tbody.RemoveAt(0)\r\n\r\n\t\t?direction = 2\r\n\t\t\theadY++\r\n\t\t\tcurrentDirection = 2\r\n\t\t:?direction = 4\r\n\t\t\theadX--\r\n\t\t\tcurrentDirection = 4\r\n\t\t:?direction = 6\r\n\t\t\theadX++\r\n\t\t\tcurrentDirection = 6\r\n\t\t:?direction = 8\r\n\t\t\theadY--\r\n\t\t\tcurrentDirection = 8\r\n\t\t\r\n\t\t?!inRange(headX, headY) | isBody(headX, headY)\r\n\t\t\tstartGameover()\r\n\t\t:\r\n\t\t\tspace.RemoveAt(space.IndexOf(getIndex(headX, headY)))\r\n\t\t\tshowCanvas.Set(headX * 2, headY, color, \"O\")\r\n\t\t\r\n\t\t?headX > foodX - 2 & headX < foodX + 2 & headY > foodY - 2 & headY < foodY + 2\r\n\t\t\tcc = currentLevel\r\n\t\t\t?speed = 1\r\n\t\t\t\tcc = cc * 2\r\n\t\t\tscore = score + cc\r\n\t\t\tlength++\r\n\t\t\teaten++\r\n\t\t\tsetSpeed()\r\n\t\t\tsetFood()\r\n\r\n//////////     input     //////////\r\n\r\n\r\nfunc checkInput()\r\n\t?key = bumpRBegin\r\n\t\tconfirm()\r\n\r\n\t?string.Equals(state, \"title\") | string.Equals(state, \"gameover\")\r\n\t\t?key = downBegin\r\n\t\t\tchangeInitialSpeed(-5)\r\n\t\t:?key = leftBegin\r\n\t\t\tchangeInitialSpeed(-1)\r\n\t\t:?key = rightBegin\r\n\t\t\tchangeInitialSpeed(1)\r\n\t\t:?key = upbegin\r\n\t\t\tchangeInitialSpeed(5)\r\n\t:?string.Equals(state, \"playing\")\r\n\t\t?key = down\r\n\t\t\tsetDirection(2)\r\n\t\t:?key = left\r\n\t\t\tsetDirection(4)\r\n\t\t:?key = right\r\n\t\t\tsetDirection(6)\r\n\t\t:?key = up\r\n\t\t\tsetDirection(8)\r\n\r\nfunc setDirection(d)\r\n\t?10 - d ! currentDirection\r\n\t\tdirection = d\r\n\r\nfunc confirm()\r\n\t?string.Equals(state, \"playing\")\r\n\t\tstate = \"stop\"\r\n\t:?string.Equals(state, \"stop\")\r\n\t\tstate = \"playing\"\r\n\t:?string.Equals(state, \"title\") | string.Equals(state, \"gameover\")\r\n\t\treset()\r\n\r\n//////////               //////////\r\n\r\nfunc title()\r\n\tchangeInitialSpeed(0)\r\n\tsetGuideText(\"[C] start / stop\")\r\n\tsetConfirmButton(\"start\")\r\n\r\nfunc gameover()\t\r\n\tchangeInitialSpeed(0)\r\n\tsetGuideText(\"[C] restart / stop\")\r\n\tsetConfirmButton(\"Retry\")\r\n\r\nfunc changeInitialSpeed(n)\r\n\tinitialLevel = initialLevel + n\r\n\tinitialLevel = math.clamp(initialLevel, 1, 10)\r\n\tvar t = toString(initialLevel)\r\n\tspeedChooseText.text = string.Format(ascii\r\nspeed\r\n<- {0} {1} ->\r\nasciiend,\r\n^string.sub(t, 0, 1), string.sub(t, 1, 1))\r\n\tspeedChooseText.visible = inherit\r\n\r\nfunc setGuideText(t)\r\n\tguideText.text = t\r\n\tguideText.visible = inherit\r\n\r\nfunc setConfirmButton(t)\r\n\tbuttonList[0].text = t\r\n\r\nfunc startGameover()\r\n\t?score > highestScore\r\n\t\thighestScore = score\r\n\t\tstorage.Set(\"snake_high\", highestScore)\r\n\t\thighestScoreX = mainWindow.absoluteX + mainWindow.w - numberLength(highestScore)\r\n\t\ttitleText.text = \"n e w\\n\" + score\r\n\t:\r\n\t\ttitleText.text = \"\\n\" + score\r\n\ttitleText.visible = inherit\r\n\r\n\t?headX = body[0][0] & headY = body[0][1]\r\n\t\touroboros = 0\r\n\tgameover()\r\n\tstate = \"gameover\"\r\n\r\n\r\n//////////     display score     //////////\r\n\r\nfunc displayScore()\r\n\t>`@mainWindow.absoluteX@,@mainWindow.absoluteY@,@score@\r\n\t>`@highestScoreX@,@mainWindow.absoluteY@,#rainFF,@highestScore@\r\n\r\n\t>`@mainWindow.absoluteX@,@mainWindow.absoluteY+mainWindow.h-1@,speed:@currentLevel@\r\n\r\n\r\n////////////////////////////////////////\r\nfunc inRange(x, y)\r\n\treturn x >= 0 & x < width & y >= 0 & y < height\r\n\r\nfunc isBody(x, y)\r\n\t?body.Count()\r\n\t\tfor i = 0..body.Count() - 1\r\n\t\t\t?x = body[i][0] & y = body[i][1]\r\n\t\t\t\treturn true\r\n\treturn false\r\n\r\nfunc levelCalculation(n)\r\n\treturn 11 - n\r\n\r\nfunc getIndex(x, y)\r\n\treturn width * y + x\r\n\r\nfunc numberLength(n)\r\n\t?n < 10\r\n\t\treturn 1\r\n\t:?n < 100\r\n\t\treturn 2\r\n\t:?n < 1000\r\n\t\treturn 3\r\n\t:?n < 10000\r\n\t\treturn 4\r\n\t:?n < 100000\r\n\t\treturn 5\r\n\t:?n < 1000000\r\n\t\treturn 6\r\n\r\nfunc toString(n)\r\n\tn = \"0\" + n\r\n\treturn string.sub(n, string.size(n) - 2)\r\n\r\n\r\nmain()"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/GrowPlants.txt" - Parse error: Failed to parse completely. Remaining: "startButton.text = \"Start\"\r\n\tstartButton.SetPressed(StartGame)\r\n\r\n\tflowerWindow = ui.AddPanel()\r\n\tflowerWindow.y = -2\r\n\tflowerWindow.w = 19\r\n\tflowerWindow.h = 14\r\n\r\n\tflowerPot = ui.AddText(FLOWER_POT)\r\n\tflowerPot.anchor = bottom_center\r\n\tflowerPot.dock = bottom_center\r\n\tflowerPot.y = -1\r\n\tflowerPot.w = 9\r\n\tflowerPot.h = 3\r\n\tflowerPot.color = #808080\r\n\r\n\tflowerText = ui.AddAnim(FLOWER_GROWTH)\r\n\tflowerText.anchor = top_center\r\n\tflowerText.dock = top_center\r\n\tflowerText.y = 2\r\n\tflowerText.w = 9\r\n\tflowerText.h = 8\r\n\r\n\tdialogWindow = ui.AddPanel()\r\n\tdialogWindow.anchor = bottom_center\r\n\tdialogWindow.dock = bottom_center\r\n\tdialogWindow.y = -2\r\n\tdialogWindow.w = 41\r\n\tdialogWindow.h = 6\r\n\r\n\tdialogText = ui.AddText()\r\n\tdialogText.anchor = top_left\r\n\tdialogText.dock = top_left\r\n\tdialogText.x = 1\r\n\tdialogText.y = 1\r\n\tdialogText.w = 39\r\n\tdialogText.h = 4\r\n\r\n\twaterButton = ui.AddButton()\r\n\twaterButton.anchor = bottom_left\r\n\twaterButton.dock = bottom_right\r\n\twaterButton.x = 1\r\n\twaterButton.w = 10\r\n\twaterButton.h = 5\r\n\twaterButton.text = \"<-    \"\r\n\twaterButton.SetPressed(GiveWater)\r\n\r\n\twaterDrop = ui.AddText(WATER_DROP)\r\n\twaterDrop.anchor = bottom_left\r\n\twaterDrop.dock = bottom_right\r\n\twaterDrop.x = 6\r\n\twaterDrop.y = -1\r\n\twaterDrop.w = 3\r\n\twaterDrop.h = 3\r\n\twaterDrop.color = #blue\r\n\r\n\tkiButton = ui.AddButton()\r\n\tkiButton.anchor = bottom_left\r\n\tkiButton.dock = bottom_right\r\n\tkiButton.x = 1\r\n\tkiButton.y = -5\r\n\tkiButton.w = 10\r\n\tkiButton.h = 5\r\n\tkiButton.text = \"<-  @ \"\r\n\tkiButton.SetPressed(GiveKi)\r\n\r\n\tretryButton = ui.AddButton()\r\n\tretryButton.anchor = bottom_left\r\n\tretryButton.dock = bottom_right\r\n\tretryButton.x = 1\r\n\tretryButton.w = 10\r\n\tretryButton.h = 5\r\n\tretryButton.text = \"Retry \"\r\n\tretryButton.SetPressed(StartGame)\r\n\r\n\twaterGauge = ui.AddText()\r\n\twaterGauge.anchor = top_left\r\n\twaterGauge.dock = top_right\r\n\twaterGauge.x = 1\r\n\twaterGauge.w = 8\r\n\twaterGauge.h = 1\r\n\r\n\tkiGauge = ui.AddText()\r\n\tkiGauge.anchor = top_left\r\n\tkiGauge.dock = top_right\r\n\tkiGauge.x = 1\r\n\tkiGauge.y = 2\r\n\tkiGauge.w = 8\r\n\tkiGauge.h = 1\r\n\r\n\tgrowthStatus = ui.AddText()\r\n\tgrowthStatus.anchor = top_right\r\n\tgrowthStatus.dock = top_left\r\n\tgrowthStatus.x = -1\r\n\tgrowthStatus.w = 25\r\n\tgrowthStatus.h = 8\r\n\tgrowthStatus.align = right\r\n\r\n\tflowerWindow.Add(flowerPot)\r\n\tflowerWindow.Add(flowerText)\r\n\tflowerWindow.Add(waterGauge)\r\n\tflowerWindow.Add(kiGauge)\r\n\tflowerWindow.Add(waterButton)\r\n\tflowerWindow.Add(waterDrop)\r\n\tflowerWindow.Add(kiButton)\r\n\tflowerWindow.Add(retryButton)\r\n\tflowerWindow.Add(growthStatus)\r\n\r\n\tdialogWindow.Add(dialogText)\r\n\r\n\r\nfunc ShowTitle()\r\n\ttitleText.visible = true\r\n\tstartButton.visible = true\r\n\tflowerWindow.visible = false\r\n\tdialogWindow.visible = false\r\n\r\nfunc ShowGame()\r\n\ttitleText.visible = false\r\n\tstartButton.visible = false\r\n\tflowerWindow.visible = true\r\n\tdialogWindow.visible = true\r\n\twaterButton.visible = true\r\n\twaterDrop.visible = true\r\n\tkiButton.visible = true\r\n\tretryButton.visible = false\r\n\r\nfunc ShowRetryButton()\r\n\twaterButton.visible = false\r\n\twaterDrop.visible = false\r\n\tkiButton.visible = false\r\n\tretryButton.visible = true\r\n\r\n\r\n////////////////////////////////////////////////////////////\r\n\r\nfunc InitializeGame()\r\n\telapsedTime = 0\r\n\twaterCast = 45\r\n\tkiCast = 30\r\n\twaterCastTime = 0\r\n\tkiCastTime = 0\r\n\r\n\twaterLevel = 30\r\n\tkiLevel = 20\r\n\twaterCooldown = 0\r\n\tflowerGrowth = 0\r\n\ttreeGrowth = 10\r\n\r\n\tdialogText.text = \" \"\r\n\r\nfunc StartGame()\r\n\tInitializeGame()\r\n\tShowGame()\r\n\tgameMode = START_GAME\r\n\r\n\r\nfunc IsCasting()\r\n\treturn waterCastTime > 0 | kiCastTime > 0\r\n\r\nfunc UpdateResources()\r\n\t?elapsedTime%30 = 0\r\n\t\t?waterLevel > 0\r\n\t\t\twaterLevel -= 0.75\r\n\t\t?kiLevel > 0\r\n\t\t\tkiLevel -= 0.5\r\n\r\n\t?waterCastTime > 0\r\n\t\twaterCastTime++\r\n\t\t?waterCastTime = waterCast\r\n\t\t\t?treeGrowth > 70 & treeTextNum >= 4\r\n\t\t\t\ttreeGrowth += 7\r\n\t\t\twaterLevel = math.Min(100, waterLevel + 20)\r\n\t\t\twaterCooldown = 900\r\n\t\t\tdialogText.text = \"Water added!\"\r\n\t\t\twaterCastTime = 0\r\n\t?kiCastTime > 0\r\n\t\tkiCastTime++\r\n\t\t?kiCastTime = kiCast\r\n\t\t\tkiLevel = math.Min(100, kiLevel + 10)\r\n\t\t\ttreeGrowth += 3\r\n\t\t\t?waterCooldown > 0\r\n\t\t\t\twaterCooldown = math.Max(0, waterCooldown - 150)\r\n\t\t\tdialogText.text = \"Ki added!\"\r\n\t\t\tkiCastTime = 0\r\n\r\n\twaterGauge.text = string.Format(\"Water {0}/100\", math.FloorToInt(waterLevel))\r\n\tkiGauge.text = string.Format(\"Ki {0}/100\", math.FloorToInt(kiLevel))\r\n\r\nfunc CheckGrowthMult()\r\n\t?waterLevel >= 85 & kiLevel >= 85\r\n\t\tgrowthMult = 2.5\r\n\t:?waterLevel >= 70 & kiLevel >= 70\r\n\t\tgrowthMult = 2.0\r\n\t:?waterLevel >= 50 & kiLevel >= 50\r\n\t\tgrowthMult = 1.5\r\n\t:?waterLevel >= 30 & kiLevel >= 30\r\n\t\tgrowthMult = 1.0\r\n\t:?waterLevel >= 5\r\n\t\tgrowthMult = 0.5\r\n\t:\r\n\t\tgrowthMult = 0\r\n\t\tdialogText.text = \"The flower's growth seems to have halted. It needs water.\"\r\n\r\nfunc GiveWater()\r\n\t?waterCooldown <= 0 & !IsCasting()\r\n\t\twaterCastTime++\r\n\t\tdialogText.text = \"Watering...\"\r\n\t:?waterCooldown > 0\r\n\t\tdialogText.text = \"I can’t water the flower too much in such a short time.\"\r\n\r\nfunc GiveKi()\r\n\t? !IsCasting()\r\n\t\tkiCastTime++\r\n\t\tdialogText.text = \"Nourishing with Ki...\"\r\n\r\nfunc CheckGrowthStatus()\r\n\t?elapsedTime%30 = 0\r\n\t\tflowerGrowth += growthMult * 0.5\r\n\t\ttreeGrowth += 0.25\r\n\r\n\t?flowerGrowth >= 100\r\n\t\tflowerText.frame = 9\r\n\t\tdialogText.text = \"I did it! The flower has bloomed! I'm so fortunate to witness such a beautiful flower at the very end. Yes, I'll call this flower 'Moonbloom.'\"\r\n\t\tgameMode = END_GAME\r\n\t:?flowerGrowth >= 95\r\n\t\tflowerText.frame = 8\r\n\t\t?flowerTextNum ! 4 & !IsCasting()\r\n\t\t\tdialogText.text = \"It's about to bloom!\"\r\n\t\t\tflowerTextNum++\r\n\t:?flowerGrowth >= 80\r\n\t\tflowerText.frame = 7\r\n\t\t?flowerTextNum ! 3 & !IsCasting()\r\n\t\t\tdialogText.text = \"The bud is growing bigger!\"\r\n\t\t\tflowerTextNum++\r\n\t:?flowerGrowth >= 60\r\n\t\tflowerText.frame = 6\r\n\t:?flowerGrowth >= 50\r\n\t\tflowerText.frame = 5\r\n\t\t?flowerTextNum ! 2 & !IsCasting()\r\n\t\t\tdialogText.text = \"A small bud has formed!\"\r\n\t\t\tflowerTextNum++\r\n\t:?flowerGrowth >= 40\r\n\t\tflowerText.frame = 4\r\n\t:?flowerGrowth >= 25\r\n\t\tflowerText.frame = 3\r\n\t:?flowerGrowth >= 10\r\n\t\tflowerText.frame = 2\r\n\t:?flowerGrowth >= 5\r\n\t\tflowerText.frame = 1\r\n\t\t?flowerTextNum ! 1 & !IsCasting()\r\n\t\t\tdialogText.text = \"A sprout has appeared!\"\r\n\t\t\tflowerTextNum++\r\n\t:\r\n\t\tflowerText.frame = 0\r\n\r\n\t?treeGrowth >= 100\r\n\t\tdialogText.text = \"I became a tree before I could witness the flower bloom. But even if it had bloomed, my fate would not have changed.\"\r\n\t\tgameMode = END_GAME\r\n\t:?treeGrowth >= 80\r\n\t\t?treeTextNum ! 5 & !IsCasting()\r\n\t\t\tdialogText.text = \"My whole body is in pain... My mind is growing foggy...\\nAll actions are less effective.\"\r\n\t\t\twaterCast = 75\r\n\t\t\tkiCast = 60\r\n\t\t\ttreeTextNum++\r\n\t:?treeGrowth >= 70\r\n\t\t?treeTextNum ! 4 & !IsCasting()\r\n\t\t\tdialogText.text = \"My arms have turned into wood, and I can't move them anymore. I can't hold the watering can, so I'll have to convert my Ki into water instead.\"\r\n\t\t\ttreeTextNum++\r\n\t:?treeGrowth >= 60\r\n\t\t?treeTextNum ! 3 & !IsCasting()\r\n\t\t\tdialogText.text = \"My body is losing strength, and I can no longer focus properly...\\nFeeding efficiency has decreased.\"\r\n\t\t\ttreeTextNum++\r\n\t:?treeGrowth >= 50\r\n\t\t?treeTextNum ! 2 & !IsCasting()\r\n\t\t\tdialogText.text = \"Looking down, I see roots spreading from my feet.\"\r\n\t\t\tkiCast = 45\r\n\t\t\ttreeTextNum++\r\n\t:?treeGrowth >= 40\r\n\t\t?treeTextNum ! 1 & !IsCasting()\r\n\t\t\tdialogText.text = \"My fingertips are aching, it's becoming difficult to hold the watering can...\\nWatering efficiency has decreased.\"\r\n\t\t\twaterCast = 60\r\n\t\t\ttreeTextNum++\r\n\r\n\tgrowthStatus.text = string.Format(ascii\r\nGrowth Status\r\nFlower Stage : {0}\r\nTree Stage: {1}\r\nGrowth Mult: {2}\r\n\r\nWater Cooldown\r\n{3}s {4}f\r\nasciiend,\r\n^flowerText.frame + 1,\r\n^math.FloorToInt(treeGrowth / 10),\r\n^growthMult,\r\n^waterCooldown / 30, waterCooldown % 30)\r\n\r\n////////////////////////////////////////////////////////////\r\n\r\nfunc Update()\r\n\t?gameMode = TITLE\r\n\t\tShowTitle()\r\n\t:?gameMode = START_GAME\r\n\t\tShowGame()\r\n\t\telapsedTime++\r\n\t\t?waterCooldown > 0\r\n\t\t\twaterCooldown--\r\n\t\tUpdateResources()\r\n\t\tCheckGrowthStatus()\r\n\t\tCheckGrowthMult()\r\n\t:?gameMode = END_GAME\r\n\t\tShowRetryButton()\r\n\r\n?loc.begin | loc.loop\r\n\tSetup()\r\nUpdate()\r\n\r\n//////////////////////////////////////////////////////////"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Simon.txt" - Parse error: Failed to parse completely. Remaining: "(＂#########＂)\r\n\r\n?blink = true\r\n^& totaltime > 1\r\n  yellowB.visible = false\r\n  greenB.visible = false\r\n  redB.visible = false\r\n  blueB.visible = false\r\n:?blink = false\r\n  yellowB.visible = true\r\n  greenB.visible = true\r\n  redB.visible = true\r\n  blueB.visible = true\r\n\r\nyellowB.SetPressed(yellowF)\r\nyellowB.x = -9\r\nyellowB.y = 4\r\nyellowB.w = 13\r\nyellowB.style = NoBorder\r\n\r\ngreenB.SetPressed(greenF)\r\ngreenB.x = -9\r\ngreenB.y = -4\r\ngreenB.w = yellowB.w\r\ngreenB.style = NoBorder\r\n\r\nblueB.SetPressed(blueF)\r\nblueB.x = 9\r\nblueB.y = 4\r\nblueB.w = yellowB.w\r\nblueB.style = NoBorder\r\n\r\nredB.SetPressed(redF)\r\nredB.x = 9\r\nredB.y = -4\r\nredB.w = yellowB.w\r\nredB.style = NoBorder\r\n\r\nyellowB.text = ＂yellow＂\r\ngreenB.text = ＂green＂\r\nblueB.text = ＂blue＂\r\nredB.text = ＂red＂\r\nvar trueAnswer = ［］\r\nvar playerAnswer = ［］\r\n\r\nfunc yellowF()\r\n  playerAnswer.Add(＂3＂)\r\nfunc greenF()\r\n  playerAnswer.Add(＂1＂)\r\nfunc blueF()\r\n  playerAnswer.Add(＂4＂)\r\nfunc redF()\r\n  playerAnswer.Add(＂2＂)\r\n\r\nvar actualAnswer\r\nactualAnswer = rng%4 + 1 + ＂＂\r\n\r\nvar trueAnswerS\r\nvar trueAnswerI\r\nvar playerAnswerI\r\nvar round = 0\r\n\r\n?trueAnswer.Count() > 0\r\n  trueAnswerS = string.Join(＂＂,trueAnswer)\r\n  ?string.Size(trueAnswerS) > 0\r\n    trueAnswerI = int.Parse(trueAnswerS)\r\nvar playerAnswerS\r\n?playerAnswer.Count() > 0\r\n  playerAnswerS = string.Join(＂＂, playerAnswer)\r\n  ?string.Size(playerAnswerS) > 0\r\n    playerAnswerI = int.Parse(playerAnswerS)\r\n\r\nvar isTrue\r\n?trueAnswerI = playerAnswerI\r\n  isTrue = ＂correct＂\r\n:?playerAnswer.Count()=trueAnswer.Count()\r\n  playerAnswer.Clear()\r\n  trueAnswer.Clear()\r\n  isTrue = ＂wrong＂\r\n  play smithy_hammer_fail\r\n  round=0\r\n\r\n\r\n?trueAnswer.Count() = playerAnswer.Count()\r\n^& round < 9\r\n  playerAnswer = ［］\r\n  trueAnswer.Add(actualAnswer)\r\n  round++\r\n  ?totaltime > 1\r\n    ind = 0\r\n:?round = 9\r\n  >c-3,-8,you won!\r\n  var prevtime_w = totaltime\r\n  ?totaltime-prevtime_w > 59\r\n    loc.Leave()\r\n>`31,7,#222226,\r\n^###▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒###\\n\r\n^#▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒#\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^#▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒#\\n\r\n^###▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒###\\n\r\n\r\n>`44,12,#750396,\r\n^▒▒▒▒▒\\n\r\n^▒▒▒▒▒\\n\r\n^▒▒▒▒▒\\n\r\n\r\n>`45,20,#750396,@round@\r\n>`31,15,#66660a,\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^#▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^###▒▒▒▒▒▒▒▒▒▒\\n\r\n\r\n>`31,7,#0a660f,\r\n^###▒▒▒▒▒▒▒▒▒▒\\n\r\n^#▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n\r\n>`49,15,#0a0a66,\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒#\\n\r\n^▒▒▒▒▒▒▒▒▒▒###\\n\r\n\r\n>`49,7,#660a0a,\r\n^▒▒▒▒▒▒▒▒▒▒###\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒#\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n\r\nvar ind = 0\r\nvar prevTime = 30\r\nvar blink = true\r\n?ind = trueAnswer.Count()\r\n  blink = false\r\n:\r\n  blink = true\r\n\r\n?totaltime > 30 & blink = true\r\n^& playerAnswer.Count() = 0\r\n  ?prevTime + 15 > totaltime\r\n    ?ind ! -1\r\n      ?trueAnswer［ind］ = 1\r\n        >`31,7,#55ff59,\r\n^###▒▒▒▒▒▒▒▒▒▒\\n\r\n^#▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n      :?trueAnswer［ind］ = 2\r\n        >`49,7,#ff5559,\r\n^▒▒▒▒▒▒▒▒▒▒###\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒#\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n      :?trueAnswer［ind］ = 3\r\n        >`31,15,#ffff59,\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^#▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^###▒▒▒▒▒▒▒▒▒▒\\n\r\n      :?trueAnswer［ind］ = 4\r\n        >`49,15,#5955ff,\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒▒\\n\r\n^▒▒▒▒▒▒▒▒▒▒▒▒#\\n\r\n^▒▒▒▒▒▒▒▒▒▒###\\n\r\n\r\n  :?prevTime+30 > totaltime\r\n\r\n    ?ind < trueAnswer.Count()\r\n    ^& prevTime+28=totaltime\r\n      ind++\r\n  :\r\n    prevTime = totaltime\r\n?totaltime > 15\r\n^!(trueAnswer［0］ = ＂4＂ |\r\n^trueAnswer［0］ = ＂1＂ |\r\n^trueAnswer［0］ = ＂2＂ |\r\n^trueAnswer［0］ = ＂3＂)\r\n  trueAnswer.Clear()\r\n  trueAnswer.Add(actualAnswer)\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/StoneBoxman/StoneBoxmanMain.txt" - Parse error: Failed to parse completely. Remaining: "\\StoneBoxman\\StoneBoxmanCore\r\n\r\nvar selectedIndex = 0\r\nvar maxIndex = 0\r\n\r\nvar BGPanel = CreateBGPanel()\r\n\r\nfunc CreateBGPanel()\r\n  var a = ui.AddPanel()\r\n  a.w = screen.w + 2\r\n  a.h = screen.h + 2\r\n  return a\r\n\r\n//0: Show title, 1: Initialize, 2: Gameplay, 3: Win\r\nvar GameStep = 0\r\n\r\n?GameStep = 0\r\n  ?map.MapTextUIGenerated\r\n    map.MapText.text = \"\"\r\n  ShowTitleScreen()\r\n  ShowTipsForTitleScreen()\r\n  MonitorKeysForTitleScreen()\r\n\r\n?GameStep = 1\r\n  GameInitialize()\r\n\r\n?GameStep = 2\r\n  DrawTheGame()\r\n  ShowTipsForGamePlay()\r\n  MonitorKeysForGamePlay()\r\n\r\n?GameStep = 3\r\n  DrawTheGame()\r\n  ShowWining()\r\n  MonitorKeysWiningScreen()\r\n\r\nfunc ShowTitleScreen()\r\n  var titleWidth = 63\r\n  var titleHeight = 7\r\n  var titleString = ascii\r\nBBBBBB      OOOO    XX      XX  MM      MM    AAAA    NN    NN\r\nBB    BB  OO    OO    XX  XX    MMMM  MMMM  AA    AA  NNNN  NN\r\nBBBBBB    OO    OO      XX      MM  MM  MM  AAAAAAAA  NN  NNNN\r\nBB    BB  OO    OO    XX  XX    MM      MM  AA    AA  NN    NN\r\nBBBBBB      OOOO    XX      XX  MM      MM  AA    AA  NN    NN\r\n                                                              \r\n                                             Coded By Okamiroy\r\nasciiend\r\n\r\n  var titlePosX = 0\r\n  titlePosX = (screen.w - titleWidth) / 2\r\n  ?titlePosX < 0\r\n    titlePosX = 0\r\n  var titlePosY = 0\r\n  titlePosY = (screen.h - titleHeight - 7) / 2\r\n  ?titlePosY < 0\r\n    titlePosY = 0\r\n\r\n  >`@titlePosX@,@titlePosY@,#white,@titleString@\r\n  \r\n  var rawData = map.GetMapRawData()\r\n  var dataCount = rawData.Count()\r\n  maxIndex = dataCount - 1\r\n\r\n  var optionBasicPosX = titlePosX + 28\r\n  var optionBasicPosY = titlePosY + titleHeight + 3\r\n\r\n  ?maxIndex >= 0\r\n    var optionObjA = null\r\n    var optionObjB = null\r\n    var optionObjC = null\r\n    var optionA\r\n    var optionB\r\n    var optionC\r\n\r\n    var optionAPosX = optionBasicPosX\r\n    var optionAPosY = optionBasicPosY\r\n    var optionBPosX = optionBasicPosX\r\n    var optionBPosY = optionBasicPosY + 2\r\n    var optionCPosX = optionBasicPosX\r\n    var optionCPosY = optionBasicPosY + 4\r\n\r\n    var arrowMarkPosX = optionAPosX - 2\r\n    var arrowMarkPosY = optionAPosY\r\n\r\n    ?maxIndex = 0\r\n      optionObjA = rawData[0]\r\n      optionA = optionObjA.MapTitle\r\n      PrintOption(optionAPosX, optionAPosY, optionA, true)\r\n    :?maxIndex = 1\r\n      optionObjA = rawData[0]\r\n      optionObjB = rawData[1]\r\n      optionA = optionObjA.MapTitle\r\n      optionB = optionObjB.MapTitle\r\n      ?selectedIndex = 0\r\n        PrintOption(optionAPosX, optionAPosY, optionA, true)\r\n        PrintOption(optionBPosX, optionBPosY, optionB, false)\r\n      :\r\n        PrintOption(optionAPosX, optionAPosY, optionA, false)\r\n        PrintOption(optionBPosX, optionBPosY, optionB, true)\r\n    :\r\n      ?selectedIndex = 0\r\n        optionObjA = rawData[0]\r\n        optionObjB = rawData[1]\r\n        optionObjC = rawData[2]\r\n        optionA = optionObjA.MapTitle\r\n        optionB = optionObjB.MapTitle\r\n        optionC = optionObjC.MapTitle\r\n        PrintOption(optionAPosX, optionAPosY, optionA, true)\r\n        PrintOption(optionBPosX, optionBPosY, optionB, false)\r\n        PrintOption(optionCPosX, optionCPosY, optionC, false)\r\n      :?selectedIndex = maxIndex\r\n        optionObjA = rawData[maxIndex - 2]\r\n        optionObjB = rawData[maxIndex - 1]\r\n        optionObjC = rawData[maxIndex]\r\n        optionA = optionObjA.MapTitle\r\n        optionB = optionObjB.MapTitle\r\n        optionC = optionObjC.MapTitle\r\n        PrintOption(optionAPosX, optionAPosY, optionA, false)\r\n        PrintOption(optionBPosX, optionBPosY, optionB, false)\r\n        PrintOption(optionCPosX, optionCPosY, optionC, true)\r\n      :?selectedIndex > 0 & selectedIndex < maxIndex\r\n        optionObjA = rawData[selectedIndex - 1]\r\n        optionObjB = rawData[selectedIndex]\r\n        optionObjC = rawData[selectedIndex + 1]\r\n        optionA = optionObjA.MapTitle\r\n        optionB = optionObjB.MapTitle\r\n        optionC = optionObjC.MapTitle\r\n        PrintOption(optionAPosX, optionAPosY, optionA, false)\r\n        PrintOption(optionBPosX, optionBPosY, optionB, true)\r\n        PrintOption(optionCPosX, optionCPosY, optionC, false)\r\n\r\nfunc PrintOption(posX, posY, optionString, isSelected)\r\n  ?isSelected\r\n    var arrowMarkPosX = posX - 2\r\n    var arrowMarkPosY = posY\r\n    >`@posX@,@posY@,#rainFF,@optionString@\r\n    >`@arrowMarkPosX@,@arrowMarkPosY@,#white,▶\r\n  :\r\n    >`@posX@,@posY@,#white,@optionString@\r\n\r\nfunc ShowTipsForTitleScreen()\r\n  var tips = ascii\r\n   ↑↓: Select\r\nENTER: Confirm\r\nSHIFT: Show/Hide BG\r\nasciiend\r\n  var tipsHeight = 3\r\n  var tipsPosY = screen.h - tipsHeight\r\n  >`0,@tipsPosY@,#white,@tips@\r\n  \r\nfunc MonitorKeysForTitleScreen()\r\n  ?key = upBegin\r\n    selectedIndex--\r\n    ?selectedIndex < 0\r\n      selectedIndex = maxIndex\r\n  :?key = downBegin\r\n    selectedIndex++\r\n    ?selectedIndex > maxIndex\r\n      selectedIndex = 0\r\n  :?key = primaryBegin\r\n    ?maxIndex >= 0\r\n      GameStep = 1\r\n\r\nfunc GameInitialize()\r\n  map.InitMapData(selectedIndex)\r\n  GameStep = 2\r\n\r\nfunc DrawTheGame()\r\n  map.MapOffsetX = (screen.w - map.RealWidth) / 2\r\n  map.MapOffsetY = (screen.h - map.RealHeight) / 2\r\n  //map.ShowMap()\r\n  map.ShowBox()\r\n  map.ShowPlayer()\r\n\r\nfunc ShowTipsForGamePlay()\r\n  var tips = ascii\r\n ↑↓←→: Move\r\n    Z: Undo\r\n    X: Retry\r\n    C: Back To Title\r\nSHIFT: Show/Hide BG\r\nasciiend\r\n  var tipsHeight = 5\r\n  var tipsPosY = screen.h - tipsHeight\r\n  >`0,@tipsPosY@,#white,@tips@\r\n  \r\n  >`1,1,#white,Push all the boxes \"  \" onto target cells \"  \" to win the game!\r\n  >`21,1,#green,[]\r\n  >`44,1,#yellow,<>\r\n\r\nfunc MonitorKeysForGamePlay()\r\n  ?key = begin\r\n    ?key = upBegin\r\n      map.TryMove(0)\r\n    :?key = rightBegin\r\n      map.TryMove(1)\r\n    :?key = downBegin\r\n      map.TryMove(2)\r\n    :?key = leftBegin\r\n      map.TryMove(3)\r\n    :?key = bumpLBegin\r\n      map.Undo()\r\n    :?key = backBegin\r\n      GameStep = 1\r\n    :?key = bumpRBegin\r\n      GameStep = 0\r\n    \r\n    ?map.JudgeToWin()\r\n      GameStep = 3\r\n\r\nfunc ShowWining()\r\n  var message = ascii\r\n                  Conguatulations!                    \r\n                                                      \r\nIf you want to create your own map, please check the  \r\nfile \"MapRawData.txt\" in \"\\Games\\StoneBoxman\\\" folder.\r\n                                                      \r\n                                                      \r\n                                                      \r\n                                                      \r\n           Press ENTER to go back to title.           \r\nasciiend\r\n  var messageWidth = 55\r\n  var messageHeight = 9\r\n  var messagePosX = 0\r\n  var messagePosY = 0\r\n  var windowWidth = messageWidth + 4\r\n  var windowHeight = messageHeight + 4\r\n  var windowPosX = 0\r\n  var windowPosY = 0\r\n\r\n  messagePosX = (screen.w - messageWidth) / 2\r\n  messagePosY = (screen.h - messageHeight) / 2\r\n  windowPosX = messagePosX - 2\r\n  windowPosY = messagePosY - 2\r\n\r\n  >`@messagePosX@,@messagePosY@,#white,@message@\r\n  draw.Box(windowPosX, windowPosY, windowWidth, windowHeight, white, 2)\r\n  \r\nfunc MonitorKeysWiningScreen()\r\n  ?key = primaryBegin\r\n    GameStep = 0"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/StoneBoxman/MapRawDataObject.txt" - Parse error: Failed to parse completely. Remaining: "= \"DEFAULTMAP\"\r\nvar MapWidth = 8\r\nvar MapHeight = 8\r\nvar MapCode = ascii\r\n00222000\r\n002T2000\r\n00212222\r\n222B1BT2\r\n2T1BS222\r\n2222B200\r\n0002T200\r\n00022200\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/StoneBoxman/SimpleStack.txt" - Parse error: Failed to parse completely. Remaining: "= []\r\n\r\nfunc Push(trace)\r\n  DataArray.Add(trace)\r\n\r\n// Get the top element and delete it in stack\r\nfunc Pop()\r\n  var resultTrace = null\r\n  ?DataArray.Count() > 0\r\n    resultTrace = DataArray[DataArray.Count() - 1]\r\n    DataArray.RemoveAt(DataArray.Count() - 1)\r\n  :\r\n    resultTrace = null\r\n  return resultTrace\r\n\r\n// Get the top element\r\nfunc GetTop()\r\n  var resultTrace = null\r\n  ?DataArray.Count() > 0\r\n    resultTrace = DataArray[DataArray.Count() - 1]\r\n  :\r\n    resultTrace = null\r\n  return resultTrace\r\n\r\nfunc Count()\r\n  return DataArray.Count()\r\n\r\nfunc Clear()\r\n  DataArray.Clear()"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/StoneBoxman/MapElement.txt" - Parse error: Failed to parse completely. Remaining: "= \"  \"\r\nvar ImageWidth = 2\r\nvar ImageHeight = 1\r\n\r\n// Type of map cell, 0: Empty cell, 1: Road cell, 2: Wall cell, B: Box cell, S: Start cell, T: Target cell\r\nvar CellType = \"\"\r\n\r\nvar Name = \"\"\r\nvar Color = CCCCCC\r\n\r\n// If box of player can move onto it\r\nvar CanStack = false\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/StoneBoxman/Box.txt" - Parse error: Failed to parse completely. Remaining: "= \"[]\"\r\nvar ImageWidth = 2\r\nvar ImageHeight = 1\r\nvar PositionX = 0\r\nvar PositionY = 0\r\n\r\nvar ColorCommon = green\r\nvar ColorOnTarget = blue\r\nvar Color = ColorCommon\r\n\r\n// 0: Common, 1: On target\r\nvar Status = 0"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/StoneBoxman/Player.txt" - Parse error: Failed to parse completely. Remaining: "= \"WW\"\r\nvar ImageToRight = \"EE\"\r\nvar ImageToDown = \"MM\"\r\nvar ImageToLeft = \"33\"\r\n\r\n// 0: Up, 1: Right, 2: Down, 3: Left\r\nvar Direction = 0\r\n\r\nvar Image = ImageToUp\r\nvar ImageWidth = 2\r\nvar ImageHeight = 1\r\nvar Color = red\r\n\r\nvar PositionX = 0\r\nvar PositionY = 0"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/StoneBoxman/StoneBoxmanCore.txt" - Parse error: Failed to parse completely. Remaining: "\\StoneBoxman\\MapElement\r\nCellEmpty.CellType = \"0\"\r\nCellEmpty.Name = \"CellEmpty\"\r\nCellEmpty.Image = \"░░\"\r\nCellEmpty.CanStack = false\r\n\r\nvar CellRoad = new Games\\StoneBoxman\\MapElement\r\nCellRoad.CellType = \"1\"\r\nCellRoad.Name = \"CellRoad\"\r\nCellRoad.Image = \"::\"\r\nCellRoad.CanStack = true\r\n\r\nvar CellWall = new Games\\StoneBoxman\\MapElement\r\nCellWall.CellType = \"2\"\r\nCellWall.Name = \"CellWall\"\r\nCellWall.Image = \"██\"\r\nCellWall.CanStack = false\r\n\r\nvar CellTarget = new Games\\StoneBoxman\\MapElement\r\nCellTarget.CellType = \"T\"\r\nCellTarget.Name = \"CellTarget\"\r\nCellTarget.Image = \"<>\"\r\nCellTarget.Color = yellow\r\nCellTarget.CanStack = true\r\n\r\nvar MapRawData = new Games\\StoneBoxman\\MapRawData\r\n\r\nvar CurrentMapRawData\r\nvar CellWidth = 0\r\nvar CellHeight = 0\r\nvar RealWidth = 0\r\nvar RealHeight = 0\r\n\r\nvar MapOffsetX = 0\r\nvar MapOffsetY = 0\r\n\r\nvar MapData = []\r\nvar BoxData = []\r\nvar Player\r\nvar TraceRecorder\r\n\r\nfunc GetMapRawData()\r\n  return MapRawData.RawDataList\r\n\r\n// Read map raw data\r\n// mapIndex: The index of map level\r\n\r\nvar MapText\r\nvar MapTextUIGenerated = false\r\n\r\nfunc InitMapData(mapIndex)\r\n  CurrentMapRawData = MapRawData.RawDataList[mapIndex]\r\n  CellWidth = CurrentMapRawData.MapWidth\r\n  CellHeight = CurrentMapRawData.MapHeight\r\n  RealWidth = CellWidth * CellEmpty.ImageWidth\r\n  RealHeight = CellHeight * CellEmpty.ImageHeight\r\n\r\n  MapData.Clear()\r\n  BoxData.Clear()\r\n  Player = new Games\\StoneBoxman\\Player\r\n  TraceRecorder = new Games\\StoneBoxman\\SimpleStack\r\n\r\n  ?!MapTextUIGenerated\r\n    MapText = ui.AddText(\"\")\r\n    MapText.align = left\r\n    MapTextUIGenerated = true\r\n  MapText.y = 2 - CellHeight/2 // + CellHeight%2\r\n  var EmptyString = \"\"\r\n  MapText.w = CellWidth * 2\r\n  var mapCodeIndex = 0\r\n  for i = 0 .. CellHeight - 1\r\n    var rowData\r\n    rowData = []\r\n    for j = 0 .. CellWidth - 1\r\n      var cellValue\r\n      cellValue = string.Sub(CurrentMapRawData.MapCode, mapCodeIndex, 1)\r\n      ?cellValue = \"0\"\r\n        rowData.Add(CellEmpty)\r\n        EmptyString += \"▒▒\"\r\n      :?cellValue = \"1\"\r\n        rowData.Add(CellRoad)\r\n        EmptyString += \"  \"\r\n      :?cellValue = \"2\"\r\n        rowData.Add(CellWall)\r\n        EmptyString += \"██\"\r\n      :?cellValue = \"B\"\r\n        rowData.Add(CellRoad)\r\n        EmptyString += \"  \"\r\n        var box\r\n        box = new Games\\StoneBoxman\\Box\r\n        box.PositionX = j\r\n        box.PositionY = i\r\n        BoxData.Add(box)\r\n      :?cellValue = \"S\"\r\n        rowData.Add(CellRoad)\r\n        EmptyString += \"  \"\r\n        Player.PositionX = j\r\n        Player.PositionY = i\r\n      :?cellValue = \"T\"\r\n        rowData.Add(CellTarget)\r\n        EmptyString += \"<>\"\r\n      :\r\n        rowData.Add(CellWall)\r\n        EmptyString += \"WW\"\r\n      mapCodeIndex++\r\n    EmptyString += \"\\n\"\r\n    mapCodeIndex = mapCodeIndex + 2\r\n    MapData.Add(rowData)\r\n  MapText.text = EmptyString\r\n\r\nfunc ShowMap()\r\n  return\r\n  var offsetX = 0\r\n  var offsetY = 0\r\n  for i = 0 .. CellHeight - 1\r\n    for j = 0 .. CellWidth - 1\r\n      var tempRow\r\n      tempRow = MapData[i]\r\n      var tempCell \r\n      tempCell = tempRow[j]\r\n      offsetX = MapOffsetX + j * tempCell.ImageWidth\r\n      offsetY = MapOffsetY + i * tempCell.ImageHeight\r\n      >`@offsetX@,@offsetY@,#@tempCell.Color@,@tempCell.Image@\r\n\r\nfunc ShowBox()\r\n  var boxOffsetX = 0\r\n  var boxOffsetY = 0\r\n  for i = 0 .. BoxData.Count() - 1\r\n    var tempBox\r\n    tempBox = BoxData[i]\r\n    boxOffsetX = MapOffsetX + tempBox.PositionX * tempBox.ImageWidth\r\n    boxOffsetY = MapOffsetY + tempBox.PositionY * tempBox.ImageHeight\r\n    >`@boxOffsetX@,@boxOffsetY@,#@tempBox.Color@,@tempBox.Image@\r\n\r\nfunc ShowPlayer()\r\n  var playerOffsetX = 0\r\n  var playerOffsetY = 0\r\n  playerOffsetX = MapOffsetX + Player.PositionX * Player.ImageWidth\r\n  playerOffsetY = MapOffsetY + Player.PositionY * Player.ImageHeight\r\n  >`@playerOffsetX@,@playerOffsetY@,#@Player.Color@,@Player.Image@\r\n\r\nfunc GetBoxByPosition(posX, posY)\r\n  var resultBox = null\r\n  for i = 0 .. BoxData.Count() - 1\r\n    var tempBox\r\n    tempBox = BoxData[i]\r\n    ?tempBox.PositionX = posX & tempBox.PositionY = posY\r\n      resultBox = tempBox\r\n  return resultBox\r\n\r\nfunc GetMapCellByPosition(posX, posY)\r\n  var tempRow\r\n  tempRow = MapData[posY]\r\n  var tempCell\r\n  tempCell = tempRow[posX]\r\n  return tempCell\r\n\r\n// Parse the direction into a certain position change.\r\n// direction: Enums of direction, 0: Up, 1: Right, 2: Down, 3: Left\r\nfunc TryMove(direction)\r\n  Player.Direction = direction\r\n  ?direction = 0\r\n    DoMove(direction, 0, -1)\r\n  :?direction = 1\r\n    DoMove(direction, 1, 0)\r\n  :?direction = 2\r\n    DoMove(direction, 0, 1)\r\n  :\r\n    DoMove(direction, -1, 0)\r\n\r\n// Do specific moves\r\nfunc DoMove(direction, moveOffsetX, moveOffsetY)\r\n  var frontBox = null\r\n  frontBox = GetBoxByPosition(Player.PositionX + moveOffsetX, Player.PositionY + moveOffsetY)\r\n  ?frontBox = null\r\n    MovePlayer(direction, moveOffsetX, moveOffsetY)\r\n  :\r\n    PushBox(frontBox, direction, moveOffsetX, moveOffsetY)\r\n\r\nfunc MovePlayer(direction, moveOffsetX, moveOffsetY)\r\n  var mapCell = null\r\n  mapCell = GetMapCellByPosition(Player.PositionX + moveOffsetX, Player.PositionY + moveOffsetY)\r\n  ?mapCell.CanStack\r\n    var traceObj = null\r\n    traceObj = new Games\\StoneBoxman\\TraceObject\r\n    traceObj.PlayerOldPosX = Player.PositionX\r\n    traceObj.PlayerOldPosY = Player.PositionY\r\n    var lastTrace = null\r\n    lastTrace = TraceRecorder.GetTop()\r\n    ?lastTrace ! null\r\n      traceObj.PlayerOldDirection = lastTrace.PlayerNewDirection\r\n    :\r\n      traceObj.PlayerOldDirection = 0\r\n    traceObj.PlayerNewPosX = Player.PositionX + moveOffsetX\r\n    traceObj.PlayerNewPosY = Player.PositionX + moveOffsetY\r\n    traceObj.PlayerNewDirection = direction\r\n    TraceRecorder.Push(traceObj)\r\n    SetPlayerStatus(direction, Player.PositionX + moveOffsetX, Player.PositionY + moveOffsetY)\r\n  :\r\n    SetPlayerStatus(direction, Player.PositionX, Player.PositionY)\r\n\r\nfunc SetPlayerStatus(direction, posX, posY)\r\n  Player.PositionX = posX\r\n  Player.PositionY = posY\r\n  Player.Direction = direction\r\n  ?direction = 0\r\n    Player.Image = Player.ImageToUp\r\n  :?direction = 1\r\n    Player.Image = Player.ImageToRight\r\n  :?direction = 2\r\n    Player.Image = Player.ImageToDown\r\n  :\r\n    Player.Image = Player.ImageToLeft\r\n\r\nfunc PushBox(boxToPush, direction, moveOffsetX, moveOffsetY)\r\n  var frontFrontCellPosX = 0\r\n  var frontFrontCellPosY = 0\r\n  frontFrontCellPosX = Player.PositionX + moveOffsetX + moveOffsetX\r\n  frontFrontCellPosY = Player.PositionY + moveOffsetY + moveOffsetY\r\n  var frontFrontBox = null\r\n  frontFrontBox = GetBoxByPosition(frontFrontCellPosX, frontFrontCellPosY)\r\n  ?frontFrontBox = null\r\n    var mapCell = null\r\n    mapCell = GetMapCellByPosition(frontFrontCellPosX, frontFrontCellPosY)\r\n    ?mapCell.CanStack\r\n      var traceObj = null\r\n      traceObj = new Games\\StoneBoxman\\TraceObject\r\n\r\n      traceObj.PlayerOldPosX = Player.PositionX\r\n      traceObj.PlayerOldPosY = Player.PositionY\r\n      var lastTrace = null\r\n      lastTrace = TraceRecorder.GetTop()\r\n      ?lastTrace ! null\r\n        traceObj.PlayerOldDirection = lastTrace.PlayerNewDirection\r\n      :\r\n        traceObj.PlayerOldDirection = 0\r\n      traceObj.PlayerNewPosX = Player.PositionX + moveOffsetX\r\n      traceObj.PlayerNewPosY = Player.PositionX + moveOffsetY\r\n      traceObj.PlayerNewDirection = direction\r\n      SetPlayerStatus(direction, Player.PositionX + moveOffsetX, Player.PositionY + moveOffsetY)\r\n\r\n      traceObj.Box = boxToPush\r\n      traceObj.BoxOldPosX = boxToPush.PositionX\r\n      traceObj.BoxOldPosY = boxToPush.PositionY\r\n      traceObj.BoxOldStatus = boxToPush.Status\r\n      traceObj.BoxNewPosX = frontFrontCellPosX\r\n      traceObj.BoxNewPosY = frontFrontCellPosY\r\n      ?IsBoxOnTarget(frontFrontCellPosX, frontFrontCellPosY)\r\n        traceObj.BoxNewStatus = 1\r\n      :\r\n        traceObj.BoxNewStatus = 0\r\n      TraceRecorder.Push(traceObj)\r\n      SetBoxStatus(boxToPush, frontFrontCellPosX, frontFrontCellPosY)\r\n    :\r\n      // The cell in front of the being pushed box cannot be moved onto (it is the cell of wall), so the player doesn't move, just face another direction.\r\n      SetPlayerStatus(direction, Player.PositionX, Player.PositionY)\r\n  :\r\n    SetPlayerStatus(direction, Player.PositionX, Player.PositionY)\r\n\r\nfunc SetBoxStatus(box, posX, posY)\r\n  box.PositionX = posX\r\n  box.PositionY = posY\r\n  ?IsBoxOnTarget(posX, posY)\r\n    box.Status = 1\r\n    box.Color = box.ColorOnTarget\r\n  :\r\n    box.Status = 0\r\n    box.Color = box.ColorCommon\r\n\r\nfunc IsBoxOnTarget(posX, posY)\r\n  var mapCell = null\r\n  mapCell = GetMapCellByPosition(posX, posY)\r\n  ?mapCell.CellType = \"T\"\r\n    return true\r\n  :\r\n    return false\r\n\r\nfunc JudgeToWin()\r\n  var judgeResult = true\r\n  var boxCount = 0\r\n  boxCount = BoxData.Count()\r\n  for i = 0 .. boxCount - 1\r\n    var tempBox = null\r\n    tempBox = BoxData[i]\r\n    ?tempBox.Status = 0\r\n      judgeResult = false\r\n  return judgeResult\r\n\r\n// Pop the trace from stack, then refresh the status of player and box.\r\nfunc Undo()\r\n  var traceObj = null\r\n  traceObj = TraceRecorder.Pop()\r\n  ?traceObj ! null\r\n    SetPlayerStatus(traceObj.PlayerOldDirection, traceObj.PlayerOldPosX, traceObj.PlayerOldPosY)\r\n    ?traceObj.Box ! null\r\n      SetBoxStatus(traceObj.Box, traceObj.BoxOldPosX, traceObj.BoxOldPosY)\r\n\r\nfunc ShowStepCount()\r\n  var count = 0\r\n  count = TraceRecorder.Count()"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/StoneBoxman/MapRawData.txt" - Parse error: Failed to parse completely. Remaining: "= []\r\nvar RawData\r\n\r\nRawData = new Games\\StoneBoxman\\MapRawDataObject\r\nRawData.MapTitle = \"LEVEL 1\"\r\nRawData.MapWidth = 8\r\nRawData.MapHeight = 8\r\nRawData.MapCode = ascii\r\n02222000\r\n02S12220\r\n021B1120\r\n22212122\r\n2T212112\r\n2TB11212\r\n2T111B12\r\n22222222\r\nasciiend\r\nRawDataList.Add(RawData)\r\n\r\nRawData = new Games\\StoneBoxman\\MapRawDataObject\r\nRawData.MapTitle = \"LEVEL 2\"\r\nRawData.MapWidth = 8\r\nRawData.MapHeight = 7\r\nRawData.MapCode = ascii\r\n02222220\r\n02111122\r\n22T22B12\r\n21TTB112\r\n2112B112\r\n211S1222\r\n22222200\r\nasciiend\r\nRawDataList.Add(RawData)\r\n\r\nRawData = new Games\\StoneBoxman\\MapRawDataObject\r\nRawData.MapTitle = \"LEVEL 3\"\r\nRawData.MapWidth = 10\r\nRawData.MapHeight = 7\r\nRawData.MapCode = ascii\r\n0222222220\r\n2211111122\r\n2211222112\r\n21BSB11B12\r\n21TT22B112\r\n22TT221112\r\n0222222222\r\nasciiend\r\nRawDataList.Add(RawData)\r\n\r\nRawData = new Games\\StoneBoxman\\MapRawDataObject\r\nRawData.MapTitle = \"LEVEL 4\"\r\nRawData.MapWidth = 8\r\nRawData.MapHeight = 8\r\nRawData.MapCode = ascii\r\n00222200\r\n002TT200\r\n0221T220\r\n0211BT20\r\n221B1122\r\n2112BB12\r\n211S1112\r\n22222222\r\nasciiend\r\nRawDataList.Add(RawData)\r\n\r\nRawData = new Games\\StoneBoxman\\MapRawDataObject\r\nRawData.MapTitle = \"LEVEL 5\"\r\nRawData.MapWidth = 10\r\nRawData.MapHeight = 7\r\nRawData.MapCode = ascii\r\n0002222220\r\n0222111120\r\n22T1B22122\r\n2TTB1B11S2\r\n2TT1B1B122\r\n2222221120\r\n0000022220\r\nasciiend\r\nRawDataList.Add(RawData)\r\n\r\nRawData = new Games\\StoneBoxman\\MapRawDataObject\r\nRawData.MapTitle = \"LEVEL 6\"\r\nRawData.MapWidth = 11\r\nRawData.MapHeight = 9\r\nRawData.MapCode = ascii\r\n02222222220\r\n02112211120\r\n02111B11120\r\n02B12221B20\r\n0212TTT2120\r\n2212TTT2122\r\n21B11B11B12\r\n21111S21112\r\n22222222222\r\nasciiend\r\nRawDataList.Add(RawData)\r\n\r\nRawData = new Games\\StoneBoxman\\MapRawDataObject\r\nRawData.MapTitle = \"LEVEL 7\"\r\nRawData.MapWidth = 8\r\nRawData.MapHeight = 7\r\nRawData.MapCode = ascii\r\n02222220\r\n22111122\r\n21B1BB12\r\n2TTTTTT2\r\n21BB1B12\r\n2221S222\r\n00222200\r\nasciiend\r\nRawDataList.Add(RawData)\r\n\r\nRawData = new Games\\StoneBoxman\\MapRawDataObject\r\nRawData.MapTitle = \"LEVEL 8\"\r\nRawData.MapWidth = 7\r\nRawData.MapHeight = 8\r\nRawData.MapCode = ascii\r\n2222222\r\n2TTBTT2\r\n2TT2TT2\r\n21BBB12\r\n211B112\r\n21BBB12\r\n2112S12\r\n2222222\r\nasciiend\r\nRawDataList.Add(RawData)\r\n\r\nRawData = new Games\\StoneBoxman\\MapRawDataObject\r\nRawData.MapTitle = \"LEVEL 9\"\r\nRawData.MapWidth = 7\r\nRawData.MapHeight = 7\r\nRawData.MapCode = ascii\r\n2222222\r\n2T1T1T2\r\n21BBB12\r\n2TBSBT2\r\n21BBB12\r\n2T1T1T2\r\n2222222\r\nasciiend\r\nRawDataList.Add(RawData)\r\n\r\nRawData = new Games\\StoneBoxman\\MapRawDataObject\r\nRawData.MapTitle = \"LEVEL 10\"\r\nRawData.MapWidth = 9\r\nRawData.MapHeight = 7\r\nRawData.MapCode = ascii\r\n222222200\r\n211TB1222\r\n2BTBTB112\r\n2TBTBTS12\r\n21TBTB122\r\n211TB1120\r\n222222220\r\nasciiend\r\nRawDataList.Add(RawData)\r\n\r\nRawData = new Games\\StoneBoxman\\MapRawDataObject\r\nRawData.MapTitle = \"LEVEL 11\"\r\nRawData.MapWidth = 15\r\nRawData.MapHeight = 5\r\nRawData.MapCode = ascii\r\n222222222222222\r\n21T1T1T1T1T1T12\r\n21B1B1B1B1B1B12\r\n222221S11122222\r\n000022222220000\r\nasciiend\r\nRawDataList.Add(RawData)\r\n\r\nRawData = new Games\\StoneBoxman\\MapRawDataObject\r\nRawData.MapTitle = \"LEVEL 12\"\r\nRawData.MapWidth = 13\r\nRawData.MapHeight = 12\r\nRawData.MapCode = ascii\r\n0002222220000\r\n0002111120000\r\n0002111122220\r\n2222121221122\r\n211B11121B112\r\n21SB2TTTTT212\r\n2221212B2B112\r\n0021112111122\r\n0022221121120\r\n0000021122220\r\n0000021120000\r\n0000022220000\r\nasciiend\r\nRawDataList.Add(RawData)\r\n\r\nRawData = new Games\\StoneBoxman\\MapRawDataObject\r\nRawData.MapTitle = \"LEVEL 13\"\r\nRawData.MapWidth = 12\r\nRawData.MapHeight = 16\r\nRawData.MapCode = ascii\r\n002222220000\r\n022111120000\r\n021111122220\r\n021221211120\r\n021TTTT11120\r\n222TTTT22220\r\n211TTTT20000\r\n212TTTT22220\r\n212222B11120\r\n2111B11B1120\r\n2221B1B1B122\r\n002B1B1B1B12\r\n0021B111B112\r\n002B1BBB1222\r\n002111S12200\r\n002222222000\r\nasciiend\r\nRawDataList.Add(RawData)\r\n\r\nRawData = new Games\\StoneBoxman\\MapRawDataObject\r\nRawData.MapTitle = \"LEVEL 14\"\r\nRawData.MapWidth = 9\r\nRawData.MapHeight = 9\r\nRawData.MapCode = ascii\r\n222222220\r\n211111120\r\n212222120\r\n21TBT1120\r\n22B2B2122\r\n02TBT1112\r\n021221212\r\n02S111112\r\n022222222\r\nasciiend\r\nRawDataList.Add(RawData)\r\n\r\nRawData = new Games\\StoneBoxman\\MapRawDataObject\r\nRawData.MapTitle = \"LEVEL 15\"\r\nRawData.MapWidth = 11\r\nRawData.MapHeight = 8\r\nRawData.MapCode = ascii\r\n22222222222\r\n21T1T1T1112\r\n21B11TB1112\r\n22122222122\r\n21121112120\r\n211B1BS1120\r\n21122222220\r\n22220000000\r\nasciiend\r\nRawDataList.Add(RawData)\r\n\r\nRawData = new Games\\StoneBoxman\\MapRawDataObject\r\nRawData.MapTitle = \"LEVEL 16\"\r\nRawData.MapWidth = 8\r\nRawData.MapHeight = 7\r\nRawData.MapCode = ascii\r\n00022222\r\n22221112\r\n211TBT12\r\n2S2B1B12\r\n211TBT12\r\n22111222\r\n12222200\r\nasciiend\r\nRawDataList.Add(RawData)\r\n\r\nRawData = new Games\\StoneBoxman\\MapRawDataObject\r\nRawData.MapTitle = \"LEVEL 17\"\r\nRawData.MapWidth = 15\r\nRawData.MapHeight = 9\r\nRawData.MapCode = ascii\r\n222222222222222\r\n211111111111112\r\n21BBBB212BBBB12\r\n221111111111122\r\n2222222S2222222\r\n221TTTT1TTTT112\r\n211111111111112\r\n211122222222112\r\n222220000002222\r\nasciiend\r\nRawDataList.Add(RawData)\r\n\r\nRawData = new Games\\StoneBoxman\\MapRawDataObject\r\nRawData.MapTitle = \"LEVEL 18\"\r\nRawData.MapWidth = 11\r\nRawData.MapHeight = 9\r\nRawData.MapCode = ascii\r\n22222220000\r\n21121122220\r\n21121B11122\r\n211TTT2B112\r\n2212B121212\r\n211T1T21B12\r\n2112B111222\r\n21121S22200\r\n22222220000\r\nasciiend\r\nRawDataList.Add(RawData)\r\n\r\nRawData = new Games\\StoneBoxman\\MapRawDataObject\r\nRawData.MapTitle = \"LEVEL 19\"\r\nRawData.MapWidth = 9\r\nRawData.MapHeight = 11\r\nRawData.MapCode = ascii\r\n002222200\r\n0221S1220\r\n221BBB122\r\n21B1T1B12\r\n21T111T12\r\n2111T1B12\r\n211111112\r\n21B1T1112\r\n21T111T12\r\n211111112\r\n222222222\r\nasciiend\r\nRawDataList.Add(RawData)\r\n\r\nRawData = new Games\\StoneBoxman\\MapRawDataObject\r\nRawData.MapTitle = \"LEVEL 20\"\r\nRawData.MapWidth = 19\r\nRawData.MapHeight = 15\r\nRawData.MapCode = ascii\r\n0000000022222200000\r\n2222222221111222200\r\n2111111221221B11200\r\n212B21B11121B111222\r\n21111B1211S11211112\r\n21211212B222222B212\r\n21B11B12T1T1TT21112\r\n2222B122T2T1T11BB12\r\n00021121T1T1TT2B122\r\n00022121TTT1TT21120\r\n000021222B222121220\r\n00002B1111111111120\r\n00002112222222B2120\r\n0000222200000211120\r\n0000000000000222220\r\nasciiend\r\nRawDataList.Add(RawData)\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/FrogBog.txt" - Parse error: Failed to parse completely. Remaining: "?loc.begin\r\n      count = 0\r\n      dircount = 0\r\n      flightcount = 0\r\n      turn = 1\r\n      landflag = 0\r\n      landflag2 = 0\r\n      landflag3 = 0\r\n      message = 0\r\n//create location banner\r\n      ui.ShowBanner(te.xt(\"Frog Bog Game\"))\r\n\r\n//draw objects\r\n  River = ui.AddAnim(ascii\r\n                                                                                                    \r\n====================================================================================================\r\n|__|__|__|__|__|__|__|__|__|__|__|__|__|__|__|__|__|__|__|__|__|__|__|__|__|__|__|__|__|__|__|__|__|\r\n ~-  ~  -                     ~-  ~             -  ~       ~  -     ~  -       ~        ~  -~\r\n   ~  ~-              ~     ~-         ~-   ~         ~        ~           ~   -      ~       ~    - \r\n-             - ~  --   -               - ~      ~  --   -        - ~      --     - ~  -            \r\n  -~-  ~                 --  ~         ~                       ~      ~            -                \r\n             -       -         -                   ~-     ~        -         -            ~         \r\n~ -   ~       -   ~   ~ -        -         ~        ~     -   ~       -   ~           ~        ~    \r\n                 ~  - ~                         -                        -                          \r\n    ~   -     ~   -     ~   -                ~   -     ~   -     ~     -     ~   -                   \r\n~  -              -                 -                   -          -     -                            \r\n   ~     -   ~     -   ~     -   ~     -         -   ~     -                 - -    -   ~     -      \r\n  ~     -                            -         -         -   ~     -   ~     -         -        -    \r\n -    ~    -    ~    -      -                                 -         -    ~    -                  \r\n -           ~ -        -      -             ~ -   -         ~                 -                     \r\n      -        ~    ~               ~  -                             ~  -     -        -             \r\n~  -  ~      -         -        -           -     ~  -        -      -         -     ~               \r\n   - ~                           --          --          - ~  -                                       \r\n  ~     -   ~     -   ~     -   ~     -   ~     -   -                 ~     -   ~     -             \r\n~ -                -                   -          -         -      ~   -             ~   -     ~   \r\n -   ~        ~         ~ -   ~          ~         ~  - ~       ~           ~             -               \r\n   ~   -     ~   -        -     ~              -              -     ~   -     ~         ~   -  \r\n  -         -           -           -      -           -      -          -         -              -\r\n  ~     -          ~    ~     -                  -   ~     -        -              -                       \r\n ~     -   ~     -   ~               -   ~         ~     -         -   ~     -   ~     -   ~     -  \r\n-    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    -    ~    \r\n\r\nasciiend)\r\n        River.x = 0\r\n\tRiver.y = 0\r\n\tRiver.color = #888888\r\n\r\n  button = ui.AddButton()\r\n  button.y = 0\r\n  button.x = -40\r\n  button.text = \" \"\r\n  button.SetPressed(OnPressed)\r\n  button.sound = hammer_cast\r\n\r\n\tSeesaw = ui.AddAnim(ascii\r\n##\r\n########--.__#####____\r\n########     '---/    \\\r\n########   __.---\\____/\r\n########--'_/_\\_\r\n\r\nasciiend)\r\n\tSeesaw.color = #A54A10 //#CCCCCC\r\n\tSeesaw.x = -27\r\n\tSeesaw.y = 0\r\n\r\n\tTarget = ui.AddAnim(ascii\r\n  _____ \r\n / ___ \\ \r\n/ /   \\ \\\r\n\\ \\___/ /\r\n \\_____/\r\n\r\nasciiend)\r\n\tTarget.color = #A54A10\r\n\tTarget.x = -35\r\n\tTarget.y = 0\r\n\r\n\tLilyFlower = ui.AddAnim(ascii\r\n####\r\n#/\\##/\\##/\\##\r\n/  \\/  \\/  \\\r\n\\\\/\\ /\\ /\\//\r\n#\\/|.....Â/\r\n%%\r\n#\r\nasciiend)\r\n\tLilyFlower.color = #white\r\n\tLilyFlower.x = 20\r\n\tLilyFlower.y = 0\r\n\r\n\tLilyPad1 = ui.AddAnim(ascii\r\n####_\r\n#,Â´   `.\r\n/    1  \\\r\n\\       /\r\n#\\/|..-Â´\r\n%%\r\n#\r\nasciiend)\r\n\tLilyPad1.color = #618a3d\r\n\r\n\r\n\tLilyPad2 = ui.AddAnim(ascii\r\n####_\r\n#,Â´   `.\r\n/    2  \\\r\n\\       /\r\n#\\/|..-Â´\r\n%%\r\n#\r\nasciiend)\r\n\tLilyPad2.color = #618a3d\r\n\r\n\r\n\tLilyPad3 = ui.AddAnim(ascii\r\n####_\r\n#,Â´   `.\r\n/   3   \\\r\n\\       /\r\n#\\/|..-Â´\r\n%%\r\n#\r\nasciiend)\r\n\tLilyPad3.color = #618a3d\r\n\r\n\r\n//Lilypad rotation instructions. incriments x value a 2 per 1 y value. \r\n//does the inverse when a half rotation is complete to do a full rotation. \r\n//dir and dircount determine the when to inverse the values \r\n  ?count > 0 & count <= 5\r\n    dir = (dircount % 2)\r\n    ?dir = 0\r\n      LilyPad1.x = LilyFlower.x\r\n      LilyPad1.y = -7\r\n      LilyPad2.x = LilyFlower.x - 8\r\n      LilyPad2.y = 4\r\n      LilyPad3.x = LilyFlower.x + 8\r\n      LilyPad3.y = 4\r\n    ?dir = 1\r\n      LilyPad1.x = LilyFlower.x\r\n      LilyPad1.y = 7\r\n      LilyPad2.x = LilyFlower.x + 8\r\n      LilyPad2.y = -4\r\n      LilyPad3.x = LilyFlower.x - 8\r\n      LilyPad3.y = -4\r\n\r\n  ?count > 5 & count <= 10\r\n    ?dir = 0\r\n      LilyPad1.x = LilyFlower.x +2\r\n      LilyPad1.y = -7\r\n      LilyPad2.x = LilyFlower.x - 10\r\n      LilyPad2.y = 3\r\n      LilyPad3.x = LilyFlower.x +6\r\n      LilyPad3.y = 5\r\n    ?dir = 1\r\n      LilyPad1.x = LilyFlower.x -2\r\n      LilyPad1.y = 7\r\n      LilyPad2.x = LilyFlower.x +10\r\n      LilyPad2.y = -3\r\n      LilyPad3.x = LilyFlower.x - 6\r\n      LilyPad3.y = -5\r\n\r\n  ?count > 10 & count <= 15\r\n    ?dir = 0\r\n      LilyPad1.x = LilyFlower.x + 4\r\n      LilyPad1.y = -6\r\n      LilyPad2.x = LilyFlower.x -12\r\n      LilyPad2.y = 2\r\n      LilyPad3.x = LilyFlower.x + 4\r\n      LilyPad3.y = 6\r\n    ?dir = 1\r\n      LilyPad1.x = LilyFlower.x - 4\r\n      LilyPad1.y = 6\r\n      LilyPad2.x = LilyFlower.x + 12\r\n      LilyPad2.y = -2\r\n      LilyPad3.x = LilyFlower.x - 4\r\n      LilyPad3.y = -6\r\n\r\n  ?count > 15 & count <= 20\r\n    ?dir = 0\r\n      LilyPad1.x = LilyFlower.x + 6\r\n      LilyPad1.y = -5\r\n      LilyPad2.x = LilyFlower.x - 13\r\n      LilyPad2.y = 1\r\n      LilyPad3.x = LilyFlower.x +2\r\n      LilyPad3.y = 7\r\n    ?dir = 1\r\n      LilyPad1.x = LilyFlower.x - 6\r\n      LilyPad1.y = 5\r\n      LilyPad2.x = LilyFlower.x +13\r\n      LilyPad2.y = -1\r\n      LilyPad3.x = LilyFlower.x - 2\r\n      LilyPad3.y = -7\r\n\r\n  ?count > 20 & count <= 25\r\n    ?dir = 0\r\n      LilyPad1.x = LilyFlower.x + 8\r\n      LilyPad1.y = -4\r\n      LilyPad2.x = LilyFlower.x - 14\r\n      LilyPad2.y = 0\r\n      LilyPad3.x = LilyFlower.x \r\n      LilyPad3.y = 7\r\n    ?dir = 1\r\n      LilyPad1.x = LilyFlower.x - 8\r\n      LilyPad1.y = 4\r\n      LilyPad2.x = LilyFlower.x + 14\r\n      LilyPad2.y = 0\r\n      LilyPad3.x = LilyFlower.x \r\n      LilyPad3.y = -7\r\n\r\n  ?count > 25 & count <= 30\r\n    ?dir = 0\r\n      LilyPad1.x = LilyFlower.x +10\r\n      LilyPad1.y = -3\r\n      LilyPad2.x = LilyFlower.x - 13\r\n      LilyPad2.y = -1\r\n      //LilyPad3.x = LilyFlower.x +14\r\n      //LilyPad3.y = 0\r\n      LilyPad3.x = LilyFlower.x -2\r\n      LilyPad3.y = 7\r\n    ?dir = 1\r\n      LilyPad1.x = LilyFlower.x - 10\r\n      LilyPad1.y = 3\r\n      LilyPad2.x = LilyFlower.x + 13\r\n      LilyPad2.y = 1\r\n      LilyPad3.x = LilyFlower.x + 2\r\n      LilyPad3.y = -7\r\n\r\n  ?count > 30 & count <= 35\r\n    ?dir = 0\r\n      LilyPad1.x = LilyFlower.x +12\r\n      LilyPad1.y = -2\r\n      LilyPad2.x = LilyFlower.x - 12\r\n      LilyPad2.y = -2\r\n      LilyPad3.x = LilyFlower.x - 4\r\n      LilyPad3.y = 6\r\n    ?dir = 1\r\n      LilyPad1.x = LilyFlower.x - 12\r\n      LilyPad1.y = 2\r\n      LilyPad2.x = LilyFlower.x + 12\r\n      LilyPad2.y = 2\r\n      LilyPad3.x = LilyFlower.x + 4\r\n      LilyPad3.y = -6\r\n\r\n  ?count > 35 & count <= 40\r\n    ?dir = 0\r\n      LilyPad1.x = LilyFlower.x +13\r\n      LilyPad1.y = -1\r\n      LilyPad2.x = LilyFlower.x - 10\r\n      LilyPad2.y = -3\r\n      LilyPad3.x = LilyFlower.x - 6\r\n      LilyPad3.y = 5\r\n    ?dir = 1\r\n      LilyPad1.x = LilyFlower.x - 13\r\n      LilyPad1.y = 1\r\n      LilyPad2.x = LilyFlower.x + 10\r\n      LilyPad2.y = 3\r\n      LilyPad3.x = LilyFlower.x + 6\r\n      LilyPad3.y = -5\r\n\r\n  ?count > 40 & count <= 45\r\n    ?dir = 0\r\n      LilyPad1.x = LilyFlower.x +14\r\n      LilyPad1.y = 0\r\n      LilyPad2.x = LilyFlower.x - 8\r\n      LilyPad2.y = -4\r\n      LilyPad3.x = LilyFlower.x - 8\r\n      LilyPad3.y = 4\r\n    ?dir = 1\r\n      LilyPad1.x = LilyFlower.x - 14\r\n      LilyPad1.y = 0\r\n      LilyPad2.x = LilyFlower.x + 8\r\n      LilyPad2.y = 4\r\n      LilyPad3.x = LilyFlower.x + 8\r\n      LilyPad3.y = -4\r\n\r\n  ?count > 45 & count <= 50\r\n    ?dir = 0\r\n      LilyPad1.x = LilyFlower.x +13\r\n      LilyPad1.y = 1\r\n      LilyPad2.x = LilyFlower.x - 6\r\n      LilyPad2.y = -5\r\n      LilyPad3.x = LilyFlower.x - 10\r\n      LilyPad3.y = 3\r\n    ?dir = 1\r\n      LilyPad1.x = LilyFlower.x - 13\r\n      LilyPad1.y = -1\r\n      LilyPad2.x = LilyFlower.x + 6\r\n      LilyPad2.y = 5\r\n      LilyPad3.x = LilyFlower.x + 10\r\n      LilyPad3.y = -3\r\n\r\n  ?count > 50 & count <= 55\r\n    ?dir = 0\r\n      LilyPad1.x = LilyFlower.x +12\r\n      LilyPad1.y = 2\r\n      LilyPad2.x = LilyFlower.x - 4\r\n      LilyPad2.y = -6\r\n      LilyPad3.x = LilyFlower.x - 12\r\n      LilyPad3.y = 2\r\n    ?dir = 1\r\n      LilyPad1.x = LilyFlower.x - 12\r\n      LilyPad1.y = -2\r\n      LilyPad2.x = LilyFlower.x + 4\r\n      LilyPad2.y = 6\r\n      LilyPad3.x = LilyFlower.x + 12\r\n      LilyPad3.y = -2\r\n\r\n  ?count > 55 & count <= 60\r\n    ?dir = 0\r\n      LilyPad1.x = LilyFlower.x +10\r\n      LilyPad1.y = 3\r\n      LilyPad2.x = LilyFlower.x - 2\r\n      LilyPad2.y = -7\r\n      LilyPad3.x = LilyFlower.x - 13\r\n      LilyPad3.y = 1\r\n    ?dir = 1\r\n      LilyPad1.x = LilyFlower.x - 10\r\n      LilyPad1.y = -3\r\n      LilyPad2.x = LilyFlower.x + 2\r\n      LilyPad2.y = 7\r\n      LilyPad3.x = LilyFlower.x + 13\r\n      LilyPad3.y = -1\r\n\r\n  ?count > 60 & count <= 65\r\n    ?dir = 0\r\n      LilyPad1.x = LilyFlower.x +8\r\n      LilyPad1.y = 4\r\n      LilyPad2.x = LilyFlower.x \r\n      LilyPad2.y = -8\r\n      LilyPad3.x = LilyFlower.x - 13\r\n      LilyPad3.y = 0\r\n    ?dir = 1\r\n      LilyPad1.x = LilyFlower.x - 8\r\n      LilyPad1.y = -4\r\n      LilyPad2.x = LilyFlower.x \r\n      LilyPad2.y = 8\r\n      LilyPad3.x = LilyFlower.x + 13\r\n      LilyPad3.y = 0\r\n\r\n  ?count > 65 & count <= 70\r\n    ?dir = 0\r\n      LilyPad1.x = LilyFlower.x +6\r\n      LilyPad1.y = 5\r\n      LilyPad2.x = LilyFlower.x + 2\r\n      LilyPad2.y = -7\r\n      LilyPad3.x = LilyFlower.x - 13\r\n      LilyPad3.y = -1\r\n    ?dir = 1\r\n      LilyPad1.x = LilyFlower.x - 6\r\n      LilyPad1.y = -5\r\n      LilyPad2.x = LilyFlower.x + -2\r\n      LilyPad2.y = 7\r\n      LilyPad3.x = LilyFlower.x + 13\r\n      LilyPad3.y = 1\r\n\r\n  ?count > 70 & count <= 75\r\n    ?dir = 0\r\n      LilyPad1.x = LilyFlower.x +4\r\n      LilyPad1.y = 6\r\n      LilyPad2.x = LilyFlower.x + 4\r\n      LilyPad2.y = -6\r\n      LilyPad3.x = LilyFlower.x - 12\r\n      LilyPad3.y = -2\r\n    ?dir = 1\r\n      LilyPad1.x = LilyFlower.x - 4\r\n      LilyPad1.y = -6\r\n      LilyPad2.x = LilyFlower.x - 4\r\n      LilyPad2.y = 6\r\n      LilyPad3.x = LilyFlower.x + 12\r\n      LilyPad3.y = 2\r\n\r\n  ?count > 75 & count <= 80\r\n    ?dir = 0\r\n      LilyPad1.x = LilyFlower.x +2\r\n      LilyPad1.y = 7\r\n      LilyPad2.x = LilyFlower.x + 6\r\n      LilyPad2.y = -5\r\n      LilyPad3.x = LilyFlower.x - 10\r\n      LilyPad3.y = -3\r\n    ?dir = 1\r\n      LilyPad1.x = LilyFlower.x - 2\r\n      LilyPad1.y = -7\r\n      LilyPad2.x = LilyFlower.x - 6\r\n      LilyPad2.y = 5\r\n      LilyPad3.x = LilyFlower.x + 10\r\n      LilyPad3.y = 3\r\n    dircount++\r\n \r\n//draw frogs and logic on moving and determining if each frog lands on pad\r\n Frog1 = ui.AddAnim(ascii\r\n#####,Oo\r\n##(\\/ .-)\r\n##´ ·-\\´\\\r\nasciiend)\r\n\r\n\tFrog1.color = #green\r\n\t?turn = 1 & flightcount = 28 & Frog1.x >= (LilyPad1.x - 10) & Frog1.x <= (LilyPad1.x + 10) & Frog1.y >= (LilyPad1.y -1) & Frog1.y <= (LilyPad1.y +1)\r\n\t  landflag = 1\r\n\t  play pickup_success\r\n\t  Frog1.x = LilyPad1.x\r\n\t  Frog1.y = LilyPad1.y\r\n\t  turn = 2\r\n\t  flightcount = 0\r\n\t:?turn = 1 & flightcount = 28 & Frog1.x >= (LilyPad2.x - 10) & Frog1.x <= (LilyPad2.x + 10) & Frog1.y >= (LilyPad2.y -1) & Frog1.y <= (LilyPad2.y +1)\r\n\t  landflag = 2\r\n\t  play pickup_success\r\n\t  Frog1.x = LilyPad2.x\r\n\t  Frog1.y = LilyPad2.y\r\n\t  turn = 2\r\n\t  flightcount = 0\r\n\t:?turn = 1 & flightcount = 28 & Frog1.x >= (LilyPad3.x - 10) & Frog1.x <= (LilyPad3.x + 10) & Frog1.y >= (LilyPad3.y -1) & Frog1.y <= (LilyPad3.y +1)\r\n\t  landflag = 3\r\n\t  turn = 2\r\n\t  play pickup_success\r\n\t  Frog1.x = LilyPad3.x\r\n\t  Frog1.y = LilyPad3.y\r\n\t  flightcount = 0\r\n\t:?turn = 1 & flightcount = 28\r\n\t  Frog1.x = 100\r\n\t  Frog1.y = 100\r\n\t  play cross_deadwood_splash\r\n\t  turn = 2\r\n\t  flightcount = 0\r\n  \t  >`45,13,ascii\r\n.\\:.|.:/.#\r\nasciiend\r\n\t:?turn = 1\r\n\t  Frog1.x = -20 + flightcount\r\n\t  Frog1.y = 0\r\n\t:?turn > 1\r\n\t  ?landflag = 1 \r\n\t    Frog1.x = LilyPad1.x\r\n\t    Frog1.y = LilyPad1.y\r\n\t  :?landflag = 2 \r\n\t    Frog1.x = LilyPad2.x\r\n\t    Frog1.y = LilyPad2.y\r\n\t  :?landflag = 3 \r\n\t    Frog1.x = LilyPad3.x\r\n\t    Frog1.y = LilyPad3.y\r\n\t  :?landflag = 0\r\n\t    Frog1.x = 100\r\n\t    Frog1.y = 100\r\n\r\n Frog1eyes = ui.AddAnim(ascii\r\n######^^\r\n######'=\r\n##\r\nasciiend)\r\n\r\n\tFrog1eyes.color = #green\r\n\t?landflag > 0\r\n\t  Frog1eyes.x = Frog1.x\r\n\t  Frog1eyes.y = Frog1.y\r\n\t:\r\n\t  Frog1eyes.x = 100\r\n\t  Frog1eyes.y = 100\r\n\r\n\tFrog2 = ui.AddAnim(ascii\r\n#####,Oo\r\n##(\\/ .-)\r\n##´ ·-\\´\\\r\nasciiend)\r\n\tFrog2.color = #green\r\n\t?turn < 2\r\n\t  Frog2.x = 25\r\n\t  Frog2.y = 11\r\n\r\n\t?turn = 2 & flightcount = 28 & Frog2.x >= (LilyPad1.x - 10) & Frog2.x <= (LilyPad1.x + 10) & Frog2.y >= (LilyPad1.y -1) & Frog2.y <= (LilyPad1.y +1) & landflag ! 1\r\n\t  landflag2 = 1\r\n\t  turn = 3\r\n\t  play pickup_success\r\n\t  Frog2.x = LilyPad1.x\r\n\t  Frog2.y = LilyPad1.y\r\n\t  flightcount = 0\r\n\t:?turn = 2 & flightcount = 28 & Frog2.x >= (LilyPad2.x - 10) & Frog2.x <= (LilyPad2.x + 10) & Frog2.y >= (LilyPad2.y -1) & Frog2.y <= (LilyPad2.y +1) & landflag ! 2\r\n\t  landflag2 = 2\r\n\t  turn = 3\r\n\t  play pickup_success\r\n\t  Frog2.x = LilyPad2.x\r\n\t  Frog2.y = LilyPad2.y\r\n\t  flightcount = 0\r\n\t:?turn = 2 & flightcount = 28 & Frog2.x >= (LilyPad3.x - 10) & Frog2.x <= (LilyPad3.x + 10) & Frog2.y >= (LilyPad3.y -1) & Frog2.y <= (LilyPad3.y +1) & landflag ! 3\r\n\t  landflag2 = 3\r\n\t  turn = 3\r\n\t  play pickup_success\r\n\t  Frog2.x = LilyPad3.x\r\n\t  Frog2.y = LilyPad3.y\r\n\t  flightcount = 0\r\n\t:?turn = 2 & flightcount = 28\r\n\t  Frog2.x = 100\r\n\t  Frog2.y = 100\r\n\t  play cross_deadwood_splash\r\n\t  turn = 3 \r\n\t  flightcount = 0\r\n  \t  >`45,13,ascii\r\n.\\:.|.:/.#\r\nasciiend\r\n\t:?turn = 2 \r\n\t  Frog2.x = -20 + flightcount\r\n\t  Frog2.y = 0\r\n\t:?turn > 2\r\n\t  ?landflag2 = 1 \r\n\t    Frog2.x = LilyPad1.x\r\n\t    Frog2.y = LilyPad1.y\r\n\t  :?landflag2 = 2 \r\n\t    Frog2.x = LilyPad2.x\r\n\t    Frog2.y = LilyPad2.y\r\n\t  :?landflag2 = 3 \r\n\t    Frog2.x = LilyPad3.x\r\n\t    Frog2.y = LilyPad3.y\r\n\t  :?landflag2 = 0\r\n\t    Frog2.x = 100\r\n\t    Frog2.y = 100\r\n\r\n Frog2eyes = ui.AddAnim(ascii\r\n######^^\r\n######'=\r\n##\r\nasciiend)\r\n\r\n\tFrog2eyes.color = #green\r\n\t?landflag2 > 0\r\n\t  Frog2eyes.x = Frog2.x\r\n\t  Frog2eyes.y = Frog2.y\r\n\t:\r\n\t  Frog2eyes.x = 100\r\n\t  Frog2eyes.y = 100\r\n\r\n\tFrog3 = ui.AddAnim(ascii\r\n#####,Oo\r\n##(\\/ .-)\r\n##´ ·-\\´\\\r\nasciiend)\r\n\tFrog3.color = #green\r\n\t?turn < 3\r\n\t  Frog3.x = 33\r\n\t  Frog3.y = 11\r\n\r\n\t?turn = 3 & flightcount = 28 & Frog3.x >= (LilyPad1.x - 10) & Frog3.x <= (LilyPad1.x + 10) & Frog3.y >= (LilyPad1.y -1) & Frog3.y <= (LilyPad1.y +1) & landflag ! 1 & landflag2 ! 1\r\n\t  landflag3 = 1\r\n\t  turn = 4\r\n\t  play pickup_success\r\n\t  Frog3.x = LilyPad1.x\r\n\t  Frog3.y = LilyPad1.y\r\n\t:?turn = 3 & flightcount = 28 & Frog3.x >= (LilyPad2.x - 10) & Frog3.x <= (LilyPad2.x + 10) & Frog3.y >= (LilyPad2.y -1) & Frog3.y <= (LilyPad2.y +1) & landflag ! 2 & landflag2 ! 2\r\n\t  landflag3 = 2\r\n\t  turn = 4\r\n\t  play pickup_success\r\n\t  Frog3.x = LilyPad2.x\r\n\t  Frog3.y = LilyPad2.y\r\n\t:?turn = 3 & flightcount = 28 & Frog3.x >= (LilyPad3.x - 10) & Frog3.x <= (LilyPad3.x + 10) & Frog3.y >= (LilyPad3.y -1) & Frog3.y <= (LilyPad3.y +1) & landflag ! 3 & landflag2 ! 3\r\n\t  landflag3 = 3\r\n\t  turn = 4\r\n\t  play pickup_success\r\n\t  Frog3.x = LilyPad3.x\r\n\t  Frog3.y = LilyPad3.y\r\n\t:?turn = 3 & flightcount = 28\r\n\t  Frog3.x = 100\r\n\t  Frog3.y = 100\r\n\t  play cross_deadwood_splash\r\n  \t  >`45,13,ascii\r\n.\\:.|.:/.#\r\nasciiend\r\n\t  turn = 4\r\n\r\n\r\n\t:?turn = 3\r\n\t  Frog3.x = -20 + flightcount\r\n\t  Frog3.y = 0\r\n\t:?turn > 3\r\n\t  ?landflag3 = 1 \r\n\t    Frog3.x = LilyPad1.x\r\n\t    Frog3.y = LilyPad1.y\r\n\t  :?landflag3 = 2 \r\n\t    Frog3.x = LilyPad2.x\r\n\t    Frog3.y = LilyPad2.y\r\n\t  :?landflag3 = 3 \r\n\t    Frog3.x = LilyPad3.x\r\n\t    Frog3.y = LilyPad3.y\r\n\t  :?landflag3 = 0\r\n\t    Frog3.x = 100\r\n\t    Frog3.y = 100\r\n\r\n Frog3eyes = ui.AddAnim(ascii\r\n######^^\r\n######'=\r\n##\r\nasciiend)\r\n\r\n\tFrog3eyes.color = #green\r\n\t?landflag3 > 0\r\n\t  Frog3eyes.x = Frog3.x\r\n\t  Frog3eyes.y = Frog3.y\r\n\t:\r\n\t  Frog3eyes.x = 100\r\n\t  Frog3eyes.y = 100\r\n\r\n//Game over banner message determined on performance\r\n  ?turn = 4 & message = 0\r\n    ui.ShowBanner(te.xt(\"GAME OVER\"))\r\n    ?landflag > 0 & landflag2 > 0 & landflag3 > 0\r\n      ui.ShowBanner(te.xt(\"PERFECT GAME!!\"))\r\n    message = 1\r\n\r\n//airborne frog draws based on early period of flightcount variable\r\n  frogjump1 = ui.AddAnim(ascii\r\n###\\\\\r\n\\\\##\\\\ ##.(o)O\r\n#\\\\##'..'   ..`.\r\n###'-'     .===.)__  \r\n######`--\\'.-_-'  \r\n##########\\\r\nasciiend)\r\n\tfrogjump1.color = #green\r\n\t?flightcount > 2 & flightcount < 18 & turn < 4\r\n\t  frogjump1.x = flightcount - 20\r\n\t  frogjump1.y = 0\r\n\t:\r\n\t  frogjump1.x = 100\r\n\t  frogjump1.y = 0\r\n\r\n  frogjump2 = ui.AddAnim(ascii\r\n#\r\n#\r\n#####.Oo\r\n-´-`´ .-)\r\n####`-‾´‾\r\n#\r\nasciiend)\r\n\tfrogjump2.color = #green\r\n\t?flightcount > 18 & flightcount < 28 & turn < 4\r\n\t  frogjump2.x = flightcount - 20\r\n\t  frogjump2.y = 0\r\n\t:\r\n\t  frogjump2.x = 100\r\n\t  frogjump2.y = 0\r\n\r\n//Hammer Smack Animation relies on the first frames of flightcount\r\n\t?flightcount >= 1 & flightcount < 3\r\n\t  >`2,10,ascii\r\n####,----,\r\n###/    ' \\`.\r\n##/ _      . \\\r\n#/ (,'     |  \\\r\n/          |   .\r\n\\   /'    _/.  |\r\n#`.   _.-'  ': |.\r\n## `-.      _.`_ `-.\r\n#######` ' \"####`._ `,\r\n################## `'\r\nasciiend\r\n\r\n\t?flightcount >= 3 & flightcount < 5\r\n\t  >`2,10,ascii\r\n####___\r\n###/   \\`.\r\n##/ _   \\ `.\r\n#/ (/    \\  \\\r\n/      . ':. \\  \r\n\\_.- '\"     '/-.\r\n##`-.___.' `-.  `-.\r\n############## `-.  `-.\r\n################# `-.'_}\r\nasciiend\r\n\r\n\r\n\t?flightcount >= 5 & flightcount < 8\r\n\t  >`2,10,ascii\r\n####__\r\n###/ \\`.\r\n##/_  \\ `\r\n#/(/   \\ \\\r\n/   ,. '. | \r\n\\_.'     '/`-.\r\n##`-.__.'`-.  `-.\r\n############`-.  `-.\r\n###############`-.  `-.\r\n##################`-._)}\r\nasciiend\r\n\r\n\t?flightcount = 5\r\n\t   play level_up\r\n\r\n//ripples in water occur at specific periods in the counter\r\n\t?count > 0 & count <= 20\r\n\t  >`28,20,#888888,ascii\r\n####\r\n    ~\r\nasciiend \r\n\r\n\t?count > 25 & count <= 45\r\n\t  >`30,7,#888888,ascii\r\n####\r\n    ~\r\nasciiend\r\n\r\n\t?count > 15 & count <= 35\r\n\t  >`76,6,#888888,ascii\r\n####\r\n    ~\r\nasciiend\r\n\r\n\t?count > 30 & count <= 50\r\n\t  >`9,3,#888888,ascii\r\n####\r\n    ~\r\nasciiend\r\n\r\n\t?count > 20 & count <= 40\r\n\t  >`74,20,#888888,ascii\r\n####\r\n    ~\r\nasciiend\r\n\r\n\t?count > 10 & count <= 30\r\n\t  >`0,20,#888888,ascii\r\n####\r\n    ~\r\nasciiend\r\n\r\n//keeps timing for lily postions and water animations\r\n  count++\r\n  ?count > 80\r\n    count = 1\r\n\r\n//play intermittent croaks for ambience\r\n  ?count = 20 | count = 40\r\n    play frog\r\n\r\n//keep flightcount incrementing until the frog reaches the lilypad\r\n  ?flightcount >= 1\r\n    flightcount++\r\n  ?flightcount > 28\r\n    flightcount = 0\r\n\r\n\r\n/*\r\n//Debug stuff that should have been removed before posting\r\n>`0,1,Counter @count@ \r\n>`0,2,Padx @LilyPad1.x@ \r\n>`0,3,Pady @LilyPad1.y@ \r\n>`0,4,dir @dir@ \r\n>`0,5,dirc @dircount@\r\n>`0,6,flight @flightcount@\r\n>`0,7,frog @Frog1.x@\r\n>`0,8,turn @turn@\r\n*/\r\n\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Stonemon/BattlePhase.txt" - Parse error: Failed to parse completely. Remaining: "\\Stonemon\\Art\r\n\r\nvar playerStatsOpen = false\r\nvar foeStatsOpen = false\r\n\r\nvar currentWindow = \"Battle\"\r\nvar cursor = 0\r\nvar cursorLast = 0\r\nvar cursorGray = false\r\nvar delay = 0\r\nvar turn = \"Player\"\r\nvar lastDamage = 0\r\nvar round = 1\r\nvar envy = 0\r\n\r\nvar itemCount = 1\r\nvar killCount = 0\r\n\r\nvar skipTurn = false\r\n\r\n//test stuff\r\nvar a = -1\r\nvar b = -1\r\nvar c = -1\r\n\r\nfunc Restart(character, enemy)\r\n\tcharacter.GenerateCreature(\"Starter\")\r\n\tenemy.GenerateCreature(\"scarab\")\r\n\titemCount = 1\r\n\tcursor = 0\r\n\tdelay = 0\r\n\tround = 1\r\n\tkillCount = 0\r\n\r\n\tturn = \"Player\"\r\n\r\nfunc EmpowerCreature(index, creature)\r\n\tvar startVal = 0\r\n\tvar newVal = 0\r\n\t\r\n\t?index = 0\r\n\t\tstartVal = creature.Max_HP\r\n\t\tnewVal = RamdomEmpower(creature.Max_HP, 1, creature.MaxHPGrowth, creature.Quality)\r\n\t\tcreature.Max_HP = newVal\r\n\t\tcreature.CurrentHP = creature.CurrentHP + (newVal - startVal)\r\n\t\t\r\n\t:?index = 1\r\n\t\tstartVal = creature.Max_MP\r\n\t\tnewVal = RamdomEmpower(creature.Max_MP, 1, creature.MaxMPGrowth, creature.Quality)\r\n\t\tcreature.Max_MP = newVal\r\n\t\tcreature.CurrentMP = creature.CurrentMP + (newVal - startVal)\r\n\t\t\r\n\t:?index = 2\r\n\t\tcreature.SkillCost = RamdomEmpower(creature.SkillCost, -4, creature.SkillCostMinimum, creature.Quality)\r\n\t\t\r\n\t:?index = 3\r\n\t\tcreature.Damage = RamdomEmpower(creature.Damage, 5, creature.DamageGrowth, creature.Quality)\r\n\tenvy--\r\n\t\t\t\r\n\t?envy\r\n\t\t?creature.Max_HP = creature.MaxHPGrowth &\r\n\t\t^creature.Max_MP = creature.MaxMPGrowth & \r\n\t\t^creature.SkillCost = creature.SkillCostMinimum &\r\n\t\t^creature.Damage = creature.DamageGrowth\r\n\t\t\tcreature.MaxHPGrowth = creature.MaxHPGrowth * 2\r\n\t\t\tcreature.MaxMPGrowth = creature.MaxMPGrowth * 2\r\n\t\t\tcreature.SkillCostMinimum = creature.SkillCostMinimum / 2\r\n\t\t\tcreature.DamageGrowth = creature.DamageGrowth * 2\r\n\r\nfunc RamdomEmpower(value, statValue, limit, Quality)\r\n\tvar rngVal = rng\r\n\tvar startVal = value\r\n\t?value < limit\r\n\t\tvalue = value + (rngVal % (limit/10))\r\n\t\t?value-startVal = 0\r\n\t\t\tvalue++\r\n\t\tvalue = math.Clamp(value, 0, limit)  \r\n\t:?value > limit\r\n\t\tvalue = value - (rngVal % ((limit*2)/10))\r\n\t\t?value-startVal = 0\r\n\t\t\tvalue--\r\n\t\tvalue = math.Clamp(value, limit, 999)\r\n\t\t\r\n\tQuality = Quality + ((value-startVal)*statValue)\r\n\t\r\n\treturn value\r\n\t\t\t\r\nfunc SkillHandeler(source, target)\r\n\tvar skillDam = source.Damage + source.DamageMod\r\n\tvar skill = source.SkillName\r\n\r\n\tvar ignoreDefense = false\r\n\t\r\n\t?skill = \"Vent Jealously\"\r\n\t\tskillDam = skillDam * 2\r\n\t:?skill = \"Reckless Charge\"\r\n\t\tskillDam = skillDam + (skillDam / 2)\r\n\t\t?rng % 3 = 0\r\n\t\t\tsource.CurrentHP = source.CurrentHP - (source.Max_HP / 10)\r\n\t:?skill = \"Mean Branches\"\r\n\t\tskillDam = skillDam * 3\r\n\t:?skill = \"Sate Craving\"\r\n\t\tskillDam = skillDam * 2\r\n\t:?skill = \"Annoyance Rising\"\r\n\t\tskillDam = 0\r\n\t\tsource.DamageMod = source.DamageMod + (source.Damage / 4)\r\n\t:?skill = \"Slimy Touch\"\r\n\t\tskillDam = skillDam + (skillDam / 2)\r\n\t:?skill = \"Alpha Punch\"\r\n\t\tskillDam = skillDam * 5 / 2\r\n\t:?skill = \"Entropy Slam\"\r\n\t\tskillDam = skillDam + (skillDam / 2)\r\n\t\ttarget.CurrentMP = target.CurrentMP - RandomRangeFrom(skillDam)\r\n\t:?skill = \"BF Sword\"\r\n\t\tsource.CurrentMP = source.CurrentMP - RandomRangeFrom(skillDam)\r\n\t\tskillDam = skillDam * 2\r\n\t\ttarget.CurrentMP = target.CurrentMP - RandomRangeFrom(skillDam)\r\n\t:?skill = \"Sadistic Glee\"\r\n\t\tskillDam = skillDam - (skillDam / 5)\r\n\t:?skill = \"Expensive Hammer\"\r\n\t\tsource.Pay2Win++\r\n\t\t?source.Pay2Win = 1\r\n\t\t\tskillDam = 100\r\n\t\t:?source.Pay2Win = 2\r\n\t\t\tskillDam = 175\r\n\t\t:\r\n\t\t\tskillDam = 999\r\n\t\tignoreDefense = true\r\n\t:?skill = \"Kamehame-Sneeze\"\r\n\t\t?rng % 10 = 0\r\n\t\t\tskipTurn = true\r\n\t:?skill = \"SnowBall o'Matic\"\r\n\t\t?rng % 4 = 0\r\n\t\t\tskipTurn = true\r\n\t:?skill = \"Spooky Lantern\"\r\n\t\tsource.DamageMod = source.DamageMod + (source.Damage / 10)\r\n\t:?skill = \"Swallow\"\r\n\t\t?source.Pay2Win = source.CurrentHP\r\n\t\t\tskillDam = 999\r\n\t\t:\r\n\t\t\tsource.Pay2Win = source.CurrentHP\r\n\t\tignoreDefense = true\r\n\t:?skill = \"Javelin Prod\"\r\n\t\tskillDam = skillDam * 5 / 2\r\n\t:?skill = \"Raw Power\"\r\n\t\tskillDam = skillDam * 7 / 2\r\n\t:?skill = \"Elemental Lotto\"\r\n\t\tskillDam = skillDam * 2\r\n\t\t?rng % 5 = 0\r\n\t\t\ttarget.DamageMod = target.DamageMod - 5\r\n\t\t\t/*\r\n\t\t:?\r\n\t\t\tsource.DamageMod = source.DamageMod + (source.Damage / 10)\r\n\t\t:?\r\n\t\t\t?turn = \"Foe\"\r\n\t\t\t\tturn = \"Player\"\r\n\t\t\t:?turn = \"Player\"\r\n\t\t\t\tturn = \"Foe\"\r\n\t\t:?\r\n\t\t\ttarget.CurrentMP = target.CurrentMP - RandomRangeFrom(skillDam)\r\n\t\t\t*/\r\n\t\t:\r\n\t\t\tsource.Pay2Win++\r\n\t:?skill = \"Perfection\"\r\n\t\tskillDam = 0\r\n\t\ttarget.CurrentHP = target.CurrentHP - (target.Max_HP / 3)\r\n\t:\r\n\t\tskillDam = skillDam + (skillDam / 2)\r\n\t\r\n\tDealDamage(skillDam, target, ignoreDefense)\r\n\t\r\n\tsource.CurrentMP = source.CurrentMP - source.SkillCost\r\n\treturn\r\n\r\nfunc RandomRangeFrom(dam)\r\n\tdam = dam + ((rng % ((dam / 5) + 1)) - (dam / 10))\r\n\treturn dam\r\n\t\r\nfunc DealDamage(dam, target, ignoreDefense)\r\n\t?target.Defending & !ignoreDefense\r\n\t\tdam = dam / 4\r\n\tdam = RandomRangeFrom(dam)\r\n\t\r\n\ttarget.CurrentHP = target.CurrentHP - dam\r\n\t\r\n\tlastDamage = dam\r\n\treturn\r\n\t\r\nfunc ItemHandler(source)\r\n\tvar heal = source.RandomVeriance(source.Max_HP - (source.Max_HP / 4), 0)\r\n\theal = math.Clamp(heal, 0, source.Max_HP - source.CurrentHP)\r\n\t\r\n\tsource.CurrentHP = source.CurrentHP + heal\r\n\titemCount--\r\n\r\n\tlastDamage = heal\r\n\treturn\r\n\r\nfunc foeTrue(source, target)\r\n\tTurnHandler(randomFoeAction(source), source, target)\r\n\r\nfunc randomFoeAction(source)\r\n\tvar index\r\n\t?source.Name = \"Bronze Guardian\"\r\n\t\tindex = 1\r\n\t:\r\n\t\tindex = rng % 6\r\n\t\t?index > 0\r\n\t\t\t?index < 3\r\n\t\t\t\tindex = 1\r\n\t\t\t:\r\n\t\t\t\tindex = 2\r\n\t?canUseFromBattle(index, source)\r\n\t\tindex = 0\r\n\treturn index\r\n\r\nfunc TurnHandler(index, source, target)\r\n\t?index = 0\r\n\t\t//attack\r\n\t\tDealDamage(source.Damage + source.DamageMod, target, false)\r\n\t\t\r\n\t:?index = 1\r\n\t\t//skills\r\n\t\tSkillHandeler(source, target)\r\n\t\r\n\t:?index = 2 \r\n\t\t//defend\r\n\t\tsource.Defending = true\r\n\t\tsource.DefendingCD = 2\r\n\t\r\n\t:?index = 3\r\n\t\t//item\r\n\t\tItemHandler(source)\r\n\r\nfunc turnStart(source)\r\n\tsource.Defending = false\r\n\tsource.DefendingCD--\r\n\tsource.Regenerate()\r\n\r\nfunc turnEnd()\r\n\t?!skipTurn\r\n\t\t?turn = \"Player\"\r\n\t\t\tturn = \"Foe\"\r\n\t\t:\r\n\t\t\tturn = \"Player\"\r\n\tskipTurn = false\r\n\r\nfunc RoundControl(character, enemy)\r\n\tcharacter.DamageMod = 0\r\n\tkillCount++\r\n\tround++\r\n\tturn = \"Player\"\r\n\r\n\t?round ! 25 | round ! 26\r\n\t\tenvy++\r\n\t?round % 3 = 1 & round ! 1 & round ! 25\r\n\t\titemCount++\r\n\t\tenvy++\r\n\t?round = 10\r\n\t\tcharacter.RegenHP = true\r\n\t\t\r\n\t?round = 1 | round = 2\r\n\t\tenemy.GenerateCreature(\"Scarab\")\r\n\t:?round = 3\r\n\t\tenemy.GenerateCreature(\"Xyloalgia\")\r\n\t:?round = 4 | round = 5\r\n\t\tenemy.GenerateCreature(\"Knee Chopper\")\r\n\t:?round = 6\r\n\t\tenemy.GenerateCreature(\"Bolesh\")\r\n\t:?round = 7 | round = 8\r\n\t\tenemy.GenerateCreature(\"Big A** Snail\")\r\n\t:?round = 9\r\n\t\tenemy.GenerateCreature(\"Angry Shroom\")\r\n\t:?round = 10 | round = 11\r\n\t\tenemy.GenerateCreature(\"Skeletony\")\r\n\t:?round = 12\r\n\t\tenemy.GenerateCreature(\"Pallas\")\r\n\t:?round = 13 | round = 14\r\n\t\tenemy.GenerateCreature(\"Dominotaur\")\r\n\t:?round = 15\r\n\t\tenemy.GenerateCreature(\"Bronze Guardian\")\r\n\t:?round = 16 | round = 17\r\n\t\tenemy.GenerateCreature(\"Giant Ice Elemental\")\r\n\t:?round = 18\r\n\t\tenemy.GenerateCreature(\"Hrimnir\")\r\n\t:?round = 19 | round = 20\r\n\t\tenemy.GenerateCreature(\"Acronian Cultist\")\r\n\t:?round = 21\r\n\t\tenemy.GenerateCreature(\"Nagaraja\")\r\n\t:?round = 22 | round = 23\r\n\t\tenemy.GenerateCreature(\"Acronian Scout\")\r\n\t:?round = 24\r\n\t\tenemy.GenerateCreature(\"Dysangelos Has Stones\")\r\n\t:?round = 25\r\n\t\tenemy.GenerateCreature(\"Dysangelos Elemental\")\r\n\t:?round = 26\r\n\t\tenemy.GenerateCreature(\"Dysangelos Perfected\")\r\n\t:\r\n\t\tenemy.GenerateCreature(\"\")\r\n\t\tenemy.DamageMod = round\r\n\r\n\r\nfunc canUseFromEmpower(index, source)\r\n\treturn index = 0 & source.Max_HP ! source.MaxHPGrowth |\r\n\t^index = 1 & source.Max_MP ! source.MaxMPGrowth |\r\n\t^index = 2 & source.SkillCost ! source.SkillCostMinimum |\r\n\t^index = 3 & source.Damage ! source.DamageGrowth\r\n\r\nfunc canUseFromBattle(index, source)\r\n\treturn index = 0 |\r\n\t^index = 1 & source.CurrentMP >= source.SkillCost |\r\n\t^index = 2 & source.DefendingCD <= 0 |\r\n\t^index = 3 & itemCount > 0"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Stonemon/Intro.txt" - Parse error: Failed to parse completely. Remaining: "\\Stonemon\\fade\r\n\r\nvar centeredX = (screen.w / 2) - 26\r\nvar centeredY = (screen.h / 2) - 2\r\nvar sceneState = -1\r\nvar scene\r\n\r\nvar intro = [ascii\r\n\r\n\r\n\r\n                        o\r\nasciiend,ascii\r\n\r\n\r\n                   I See them...\r\n                        o\r\nasciiend,ascii\r\n\r\n\r\n                They have so Much...\r\n                        o\r\nasciiend,ascii\r\n\r\n\r\n            But they dont apreciate it...\r\n                        o\r\nasciiend,ascii\r\n\r\n\r\n                      I...\r\n                        o\r\nasciiend,ascii\r\n\r\n\r\n               I would be Diffrent!\r\n                        o\r\nasciiend,ascii\r\n\r\n\r\n             I wouldnt waste that Power!\r\n                        o\r\nasciiend,ascii\r\n\r\n\r\n                     But...\r\n                        o\r\nasciiend,ascii\r\n\r\n\r\n                  What can i do?\r\n                        o\r\nasciiend,ascii\r\n\r\n\r\n               I'M STUCK LIKE THIS!\r\n                        o\r\nasciiend,ascii\r\n\r\n\r\n                  Just a stone...\r\n                        o\r\nasciiend,ascii\r\n\r\n\r\n                      Hu..?\r\n                        o\r\nasciiend,ascii\r\n\r\n\r\n                What's this feeling?\r\n                        o\r\nasciiend,ascii\r\n\r\n\r\n\r\n                        o/\r\nasciiend,ascii\r\n\r\n\r\n                    I think...\r\n                       .on\r\nasciiend,ascii\r\n\r\n\r\n                       _o\r\n                      '/\\\r\nasciiend,ascii\r\n\r\n                        __o\r\n                        _/\\\r\n                       ' '\r\nasciiend,ascii\r\n                     I'm...\r\n                        o\r\n                       /|\\\r\n                       / \\\r\nasciiend,ascii\r\n                     I See...\r\n                        o\r\n                       /|\\\r\n                       / \\\r\nasciiend,ascii\r\n           Yes... I wont waste this chance!\r\n                        o\r\n                       /|\\\r\n                       / \\\r\nasciiend,ascii\r\n        I will take what they Dont Deserve!\r\n                        o\r\n                       /|\\\r\n                       / \\\r\nasciiend,ascii\r\nI will take that which should have always been MINE!\r\n                        o\r\n                       /|\\\r\n                       / \\\r\nasciiend,ascii\r\n            I am Envy! ALL will Envy ME!\r\n                       \\o/\r\n                        |\r\n                       / \\\r\nasciiend]\r\n\r\nfunc Restart()\r\n   fade.index = 15\r\n\r\nfunc Run()\r\n\t?fade.state\r\n\t\t>`@centeredX@,@centeredY@,@fade.color@,@scene@\r\n\t\t?fade.index > -10 | sceneState = 22 & fade.index > -20\r\n\t\t\tfade.chengeIndex(-(totaltime % 2))\r\n\t\t:\r\n\t\t\tfade.state = false\r\n\t:\r\n\t\t?fade.index < 20\r\n\t\t\t>`@centeredX@,@centeredY@,@fade.color@,@scene@\r\n\t\t\tfade.chengeIndex(totaltime % 2)\r\n\t\t:\r\n\t\t\tfade.state = true\r\n\t\t\tsceneState++\r\n\t\t\t?sceneState < 23\r\n\t\t\t\tscene = intro[sceneState]\r\n\t\t\t:\r\n\t\t\t\treturn true\r\n\treturn false\r\n\r\nRestart()"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Stonemon/GameUIController.txt" - Parse error: Failed to parse completely. Remaining: "\\Stonemon\\Art\r\nvar fade = new Games\\Stonemon\\fade\r\nvar deathFade = new Games\\Stonemon\\fade\r\n\r\n//death stuff\r\nvar deathString = \"Your Jealously Has Failed you!\\n\\n   But Envy Will Find A Way\"\r\nvar deathX = (screen.w / 2) - 15\r\nvar deathY = (screen.h / 2) - 2\r\n\r\nvar foeApproachOffset = 0\r\n\r\nvar characterHPbar = new Games\\Stonemon\\bar\r\nvar characterMPbar = new Games\\Stonemon\\bar\r\nvar foeHPbar = new Games\\Stonemon\\bar\r\nvar foeMPbar = new Games\\Stonemon\\bar\r\nvar needUpdateBar = true\r\n\r\nvar mainWindow\r\nvar basedata\r\nvar playerArt\r\nvar foeArt\r\nvar playerDefending\r\nvar foeDefending\r\nvar playerStatBar\r\nvar foeStatBar\r\nvar battleWindow\r\nvar battleWindowButton = []\r\nvar statsWindow\r\nvar statsWindowText\r\nvar statsWindowButton = []\r\nvar empowerWindow\r\nvar empowerWindowText\r\nvar empowerWindowButton = []\r\nvar instructionsText\r\nvar filter\r\n\r\nvar corsurIndex = 0\r\nvar corsurShowTimer = 90\r\n\r\nvar confirmType = \"\"\r\nvar confirmIndex = -1\r\n\r\nfunc Restart(name)\r\n\tresetFoeArt(name)\r\n\r\nfunc RestartConfirm()\r\n\tsetCorsurIndex(0)\r\n\r\n\tconfirmType = \"\"\r\n\tconfirmIndex = -1\r\n\r\nfunc isConfirm(type)\r\n\treturn string.Equals(type, confirmType) & confirmIndex >= 0\r\n\r\nfunc setCorsurPos(index, btnList)\r\n\t?corsurIndex ! index\r\n\t\tsetCorsurIndex(index)\r\n\t?corsurShowTimer\r\n\t\tfor i = 0..btnList.Count() - 1\r\n\t\t\t?i = index\r\n\t\t\t\tbtnList[i].style = 7\r\n\t\t\t:\t\t\t\r\n\t\t\t\tbtnList[i].style = 1\r\n\t\tcorsurShowTimer--\r\n\t\t?!corsurShowTimer\r\n\t\t\tbtnList[index].style = 1\r\n\r\nfunc setCorsurIndex(index)\r\n\tcorsurIndex = index\r\n\tcorsurShowTimer = 90\r\n\r\nfunc updateBar(character, enemy)\r\n\t?characterHPbar.needUpdate() | characterMPbar.needUpdate() |\r\n\t^foeHPbar.needUpdate() | foeMPbar.needUpdate()\r\n\t\t?characterHPbar.needUpdate()\r\n\t\t\tcharacterHPbar.update()\r\n\t\t?characterMPbar.needUpdate()\r\n\t\t\tcharacterMPbar.update()\r\n\t\tupdatePlayerStatBar(character)\r\n\r\n\t\t?foeHPbar.needUpdate()\r\n\t\t\tfoeHPbar.update()\r\n\t\t?foeMPbar.needUpdate()\r\n\t\t\tfoeMPbar.update()\r\n\t\tupdateFoeStatBar(enemy)\r\n\t:\r\n\t\tneedUpdateBar = false\r\n\r\nfunc updatePlayerStatBar(character)\r\n\tplayerStatBar.text = string.Format(\r\n\t^\"       {0}:{1}☆\\nHP:{2} {3}\\nMP:{4} {5}\",\r\n\t^character.Name,character.Quality,\r\n\t^characterHPbar.stringCurrent,characterHPbar.bar,\r\n\t^characterMPbar.stringCurrent,characterMPbar.bar)\r\n\r\nfunc updateFoeStatBar(enemy)\r\n\tfoeStatBar.text = string.Format(\r\n\t^\"       {0}:{1}☆\\nHP:{2} {3}\\nMP:{4} {5}\",\r\n\t^enemy.Name,enemy.Quality,\r\n\t^foeHPbar.stringCurrent,foeHPbar.bar,\r\n\t^foeMPbar.stringCurrent,foeMPbar.bar)\r\n\r\nfunc updateScreenOpacity()\r\n\tchangeScreenOpacity(totaltime % 3)\r\n\r\n\r\nfunc resetFoeArt(name)\r\n\tfoeApproachOffset = 40\r\n\r\n\tfoeArt.text = art.GetArt(name)\r\n\tfoeArt.w = art.GetArtWidth(name)\r\n\tfoeArt.h = art.GetArtHeight(name)\r\n\tfoeArt.x = (screen.w - (screen.w / 4)) - (foeArt.w / 2)\r\n\tfoeArt.y = (screen.h / 4) - (foeArt.h / 2)\r\n\tfoeArt.color = #FFFFFF\r\n\r\n\tfoeDefending.x = foeArt.x - foeArt.w - 1\r\n\tfoeDefending.y = foeArt.y\r\n\r\n\tfoeArt.x += foeApproachOffset\r\n\r\nfunc updateFoeOffset()\r\n\t?totaltime % 2 = 0\r\n\t\tfoeArt.x--\r\n\t\tfoeApproachOffset--\r\n\r\nfunc turnStart(character, enemy, battlePhase)\r\n\tsetBasedata(battlePhase)\r\n\tsetDefendingVisible(character, enemy)\r\n\tturnEnd(character, enemy, battlePhase)\r\n\r\nfunc turnEnd(character, enemy, battlePhase)\r\n\tsetBar(character, enemy)\r\n\tsetBattleButtonAvailable(character, battlePhase)\r\n\r\nfunc setBasedata(battlePhase)\r\n\tbasedata.text = string.Format(ascii\r\n{0}'s turn\r\nLast Damage: {1}\r\nHealItems:{2}\r\nDefeated: {3}\r\nasciiend,\r\n^battlePhase.turn, battlePhase.lastDamage, battlePhase.itemCount, battlePhase.killCount)\r\n\r\nfunc setDefendingVisible(character, enemy)\r\n\t?character.Defending\r\n\t\tplayerDefending.visible = inherit\r\n\t:\r\n\t\tplayerDefending.visible = false\r\n\t?enemy.Defending\r\n\t\tfoeDefending.visible = inherit\r\n\t:\r\n\t\tfoeDefending.visible = false\r\n\r\nfunc setBar(character, enemy)\r\n\tcharacterHPbar.set(character.CurrentHP, character.Max_HP)\r\n\tcharacterMPbar.set(character.CurrentMP, character.Max_MP)\r\n\tfoeHPbar.set(enemy.CurrentHP, enemy.Max_HP)\r\n\tfoeMPbar.set(enemy.CurrentMP, enemy.Max_MP)\r\n\tneedUpdateBar = true\r\n\r\nfunc setBattleButtonAvailable(character, battlePhase)\r\n\tfor i = 0..battleWindowButton.Count() - 1\r\n\t\t?battlePhase.canUseFromBattle(i, character)\r\n\t\t\tbattleWindowButton[i].bcolor = #FFFFFF\r\n\t\t:\r\n\t\t\tbattleWindowButton[i].bcolor = #777777\r\n\r\nfunc setBattleCursorPos(index)\r\n\tsetCorsurPos(index, battleWindowButton)\r\n\r\nfunc startEmpower(character, battlePhase)\r\n\tsetEmpowerButtonAvailable(character, battlePhase)\r\n\tempowerWindowText.text = string.Format(\"Sate your Jealousy:   {0}\", battlePhase.envy)\r\n\tempowerWindow.visible = inherit\r\n\r\nfunc setEmpowerButtonAvailable(character, battlePhase)\r\n\tfor i = 0..empowerWindowButton.Count() - 1\r\n\t\t?battlePhase.canUseFromEmpower(i, character)\r\n\t\t\tempowerWindowButton[i].bcolor = #FFFFFF\r\n\t\t:\r\n\t\t\tempowerWindowButton[i].bcolor = #777777\r\n\r\nfunc setEmpowerCursorPos(index)\r\n\tsetCorsurPos(index, empowerWindowButton)\r\n\r\nfunc closeEmpowerWindow()\r\n\tempowerWindow.visible = false\r\n\r\nfunc openStatsWindow(type, creature)\r\n\t?type = \"player\"\r\n\t\tCreatureStats(creature, characterHPbar.stringMax, characterMPbar.stringMax)\r\n\t:\r\n\t\tCreatureStats(creature, foeHPbar.stringMax, foeMPbar.stringMax)\r\n\tsetStatsButtonText(type)\r\n\tstatsWindow.visible = inherit\r\n\r\nfunc closeStatsWindow()\r\n\tsetStatsButtonText(\"\")\r\n\tstatsWindow.visible = false\r\n\r\nfunc setStatsButtonText(type)\r\n\t?type = \"foe\"\r\n\t\tstatsWindowButton[0].text = \"X\"\r\n\t:\r\n\t\tstatsWindowButton[0].text = \"Enemy\"\r\n\t?type = \"player\"\r\n\t\tstatsWindowButton[1].text = \"X\"\r\n\t:\r\n\t\tstatsWindowButton[1].text = \"Envy\"\r\n\r\n\r\nfunc CreatureStats(creature, HPString, MPString)\r\n\tvar totalDamage = creature.Damage + creature.DamageMod\r\n\t\r\n\tstatsWindowText.text = string.Format(ascii\r\n######Creature Stats\r\nName:#{0}\r\nMaxHP:#{1}###MaxMP:#{2}\r\nDamage:#{3}\r\nSkill Name:#{4}\r\nSkill Cost:#{5}\r\nSkill Effect:\r\n#{6}\r\nSkill Description:\r\n#{7}\r\nasciiend,\r\n^creature.Name, HPString, MPString,\r\n^totalDamage, creature.SkillName, creature.SkillCost,\r\n^creature.SkillEffect,creature.SkillDescription)\r\n\r\nfunc initFoeDeath()\r\n\tdeathFade.index = 0\r\n\tdeathFade.changeColor()\r\n\r\nfunc foeDeath()\r\n\t?deathFade.index > 0\r\n\t\t?totaltime % 2\r\n\t\t\tdeathFade.chengeIndex(-1)\r\n\t\t\tfoeArt.color = deathFade.color\r\n\t\treturn false\r\n\treturn true\r\n\r\nfunc initPlayerDeath()\r\n\tdeathFade.index = 15\r\n\tdeathFade.changeColor()\r\n\tdeathFade.state = true\r\n\r\nfunc playerDeath()\r\n\t>`@deathX@,@deathY@,@deathFade.color@,@deathString@\r\n\t?totaltime % 2 = 0\r\n\t\t?fade.index > 0\r\n\t\t\tchangeScreenOpacity(-1)\r\n\r\n\t\t?deathFade.state = true\r\n\t\t\tdeathFade.chengeIndex(-1)\r\n\t\t\t?deathFade.index < -15\r\n\t\t\t\tdeathFade.state = false\r\n\t\t:\r\n\t\t\tdeathFade.chengeIndex(1)\r\n\t\t\t?deathFade.index > 16\r\n\t\t\t\treturn true\r\n\treturn false\r\n\r\nfunc changeScreenOpacity(n)\r\n\tfade.chengeIndex(n)\r\n\tfilter.SetFG(fade.color)\r\n\r\nfunc createUI(character, enemy)\r\n\tcreateMainWindow()\r\n\tcreateBaseDataWindow()\r\n\tcreatePlayerArt(character.Name)\r\n\tcreatefoeArt()\r\n\tcreateDefending()\r\n\tcreateBattleWindow()\r\n\tcreatePlayerStatBar()\r\n\tcreateFoeStatBar()\r\n\tcreateStatsWindow()\r\n\tcreateEmpowerWindow()\r\n\tcreateStatsWindowButton()\r\n\t//createInstructions()\r\n\tcreateFilter()\r\n\r\n\tresetFoeArt(enemy.Name)\r\n\r\nfunc createMainWindow()\r\n\tmainWindow = ui.AddPanel()\r\n\tmainWindow.w = screen.w\r\n\tmainWindow.h = screen.h\r\n\tmainWindow.style = 0\r\n\r\nfunc createBaseDataWindow()\r\n\tbasedata = ui.AddText()\r\n\tbasedata.w = 16\r\n\tbasedata.h = 4\r\n\tbasedata.anchor = center_left\r\n\tbasedata.dock = center_left\r\n\tmainWindow.Add(basedata)\r\n\r\nfunc createPlayerArt(name)\r\n\tplayerArt = ui.AddText()\r\n\tplayerArt.text = art.GetArt(name)\r\n\tplayerArt.w = art.GetArtWidth(name)\r\n\tplayerArt.h = art.GetArtHeight(name)\r\n\tplayerArt.x = (screen.w / 4) - (playerArt.w / 2)\r\n\tplayerArt.y = (screen.h - (screen.h / 4)) - (playerArt.h / 2)\r\n\tplayerArt.anchor = top_left\r\n\tplayerArt.dock = top_left\r\n\tmainWindow.Add(playerArt)\r\n\r\nfunc createfoeArt()\r\n\tfoeArt = ui.AddText()\r\n\tfoeArt.anchor = top_left\r\n\tfoeArt.dock = top_left\r\n\tmainWindow.Add(foeArt)\r\n\r\nfunc createDefending()\r\n\tvar art = ascii\r\n  ___\r\n (   )\r\n  \\_/\r\nDefense+\r\nasciiend\r\n\r\n\tplayerDefending = ui.AddText()\r\n\tplayerDefending.text = art\r\n\tplayerDefending.w = 8\r\n\tplayerDefending.h = 4\r\n\tplayerDefending.x = playerArt.x + playerArt.w + 2\r\n\tplayerDefending.y = playerArt.y - 3\r\n\tplayerDefending.anchor = top_left\r\n\tplayerDefending.dock = top_left\r\n\tplayerDefending.visible = false\r\n\tmainWindow.Add(playerDefending)\r\n\r\n\tfoeDefending = ui.AddText()\r\n\tfoeDefending.text = art\r\n\tfoeDefending.w = 8\r\n\tfoeDefending.h = 4\r\n\tfoeDefending.anchor = top_left\r\n\tfoeDefending.dock = top_left\r\n\tfoeDefending.visible = false\t\r\n\tmainWindow.Add(foeDefending)\r\n\r\nfunc createPlayerStatBar()\r\n\tplayerStatBar = ui.AddText()\r\n\tplayerStatBar.w = 30\r\n\tplayerStatBar.h = 3\r\n\t//playerStatBar.x = -1\r\n\tplayerStatBar.y = battleWindow.y - battleWindow.h\r\n\tplayerStatBar.anchor = bottom_right\r\n\tplayerStatBar.dock = bottom_right\r\n\tmainWindow.Add(playerStatBar)\r\n\r\nfunc createFoeStatBar()\r\n\tfoeStatBar = ui.AddText()\r\n\tfoeStatBar.w = 30\r\n\tfoeStatBar.x = 2\r\n\tfoeStatBar.y = 1\r\n\tfoeStatBar.anchor = top_left\r\n\tfoeStatBar.dock = top_left\r\n\tmainWindow.Add(foeStatBar)\r\n\r\nfunc createBattleWindow()\r\n\tbattleWindow = ui.AddPanel()\r\n\tbattleWindow.w = 30\r\n\tbattleWindow.h = 8\r\n\tbattleWindow.x = -1\r\n\tbattleWindow.y = -3\r\n\tbattleWindow.anchor = bottom_right\r\n\tbattleWindow.dock = bottom_right\r\n\r\n\tvar button\r\n\tbutton = ui.AddButton()\r\n\tbutton.text = \"Attack\"\r\n\tbutton.w = 12\r\n\tbutton.h = 3\r\n\tbutton.x = -1\r\n\tbutton.anchor = bottom_right\r\n\tbutton.bcolor = #FFFFFF\r\n\tbutton.SetUp(action)\r\n\tbattleWindow.Add(button)\r\n\r\n\tbattleWindowButton.Add(button)\r\n\r\n\tbutton = ui.AddButton()\r\n\tbutton.text = \"Skill\"\r\n\tbutton.w = 12\r\n\tbutton.h = 3\r\n\tbutton.x = 1\r\n\tbutton.anchor = bottom_left\r\n\tbutton.bcolor = #FFFFFF\r\n\tbutton.SetUp(action)\r\n\tbattleWindow.Add(button)\r\n\r\n\tbattleWindowButton.Add(button)\r\n\t\r\n\tbutton = ui.AddButton()\r\n\tbutton.text = \"Defend\"\r\n\tbutton.w = 12\r\n\tbutton.h = 3\r\n\tbutton.x = -1\r\n\tbutton.anchor = top_right\r\n\tbutton.bcolor = #FFFFFF\r\n\tbutton.SetUp(action)\r\n\tbattleWindow.Add(button)\r\n\r\n\tbattleWindowButton.Add(button)\r\n\t\r\n\tbutton = ui.AddButton()\r\n\tbutton.text = \"Items\"\r\n\tbutton.w = 12\r\n\tbutton.h = 3\r\n\tbutton.x = 1\r\n\tbutton.anchor = top_left\r\n\tbutton.bcolor = #FFFFFF\r\n\tbutton.SetUp(action)\r\n\tbattleWindow.Add(button)\r\n\r\n\tbattleWindowButton.Add(button)\r\n\r\n\tmainWindow.Add(battleWindow)\r\n\r\nfunc createStatsWindow()\r\n\tstatsWindow = ui.AddPanel()\r\n\tstatsWindow.w = 30\r\n\tstatsWindow.h = 13\r\n\tstatsWindow.clip = true\r\n\tstatsWindow.visible = false\r\n\r\n\tstatsWindowText = ui.AddText()\r\n\tstatsWindowText.w = statsWindow.w - 2\r\n\tstatsWindowText.h = statsWindow.h - 2\r\n\tstatsWindow.Add(statsWindowText)\r\n\r\n\tmainWindow.Add(statsWindow)\r\n\r\nfunc createEmpowerWindow()\r\n\tempowerWindow = ui.AddPanel()\r\n\tempowerWindow.w = 30\r\n\tempowerWindow.h = 9\r\n\tempowerWindow.clip = true\r\n\tempowerWindow.visible = false\r\n\r\n\tempowerWindowText = ui.AddText()\r\n\tempowerWindowText.w = 30\r\n\tempowerWindowText.x = 3\r\n\tempowerWindowText.y = 1\r\n\tempowerWindowText.anchor = top_center\r\n\tempowerWindowText.dock = top_center\r\n\tempowerWindow.Add(empowerWindowText)\r\n\t\r\n\tvar button\r\n\tbutton = ui.AddButton()\r\n\tbutton.text = \"Max HP\"\r\n\tbutton.w = 12\r\n\tbutton.h = 3\r\n\tbutton.x = -1\r\n\tbutton.y = 1\r\n\tbutton.anchor = bottom_right\r\n\tbutton.bcolor = #FFFFFF\r\n\tbutton.SetUp(action)\r\n\tempowerWindow.Add(button)\r\n\r\n\tempowerWindowButton.Add(button)\r\n\r\n\tbutton = ui.AddButton()\r\n\tbutton.text = \"Max MP\"\r\n\tbutton.w = 12\r\n\tbutton.h = 3\r\n\tbutton.x = 1\r\n\tbutton.y = 1\r\n\tbutton.anchor = bottom_left\r\n\tbutton.bcolor = #FFFFFF\r\n\tbutton.SetUp(action)\r\n\tempowerWindow.Add(button)\r\n\r\n\tempowerWindowButton.Add(button)\r\n\t\r\n\tbutton = ui.AddButton()\r\n\tbutton.text = \"Skill Cost\"\r\n\tbutton.w = 12\r\n\tbutton.h = 3\r\n\tbutton.x = -1\r\n\tbutton.y = 1\r\n\tbutton.anchor = top_right\r\n\tbutton.bcolor = #FFFFFF\r\n\tbutton.SetUp(action)\r\n\tempowerWindow.Add(button)\r\n\r\n\tempowerWindowButton.Add(button)\r\n\t\r\n\tbutton = ui.AddButton()\r\n\tbutton.text = \"Damage\"\r\n\tbutton.w = 12\r\n\tbutton.h = 3\r\n\tbutton.x = 1\r\n\tbutton.y = 1\r\n\tbutton.anchor = top_left\r\n\tbutton.bcolor = #FFFFFF\r\n\tbutton.SetUp(action)\r\n\tempowerWindow.Add(button)\r\n\r\n\tempowerWindowButton.Add(button)\r\n\r\n\tmainWindow.Add(empowerWindow)\r\n\r\nfunc createStatsWindowButton()\r\n\tvar button\r\n\tbutton = ui.AddButton()\r\n\tbutton.text = \"Enemy\"\r\n\tbutton.w = string.Size(button.text) + 2\r\n\tbutton.h = 3\r\n\tbutton.x = 1\r\n\tbutton.anchor = bottom_left\r\n\tbutton.dock = bottom_left\r\n\tbutton.SetUp(action)\r\n\tstatsWindowButton.Add(button)\r\n\tmainWindow.Add(button)\r\n\tbutton = ui.AddButton()\r\n\r\n\tbutton.text = \"Envy\"\r\n\tbutton.w = string.Size(button.text) + 2\r\n\tbutton.h = 3\r\n\tbutton.x = statsWindowButton[0].x + statsWindowButton[0].w\r\n\tbutton.anchor = bottom_left\r\n\tbutton.dock = bottom_left\r\n\tbutton.SetUp(action)\t\r\n\tstatsWindowButton.Add(button)\r\n\tmainWindow.Add(button)\r\n\r\nfunc createInstructions()\r\n\tinstructionsText = ui.AddText()\r\n\tinstructionsText.text = \"Shift + Control - Restart\\nZ - View Enemy Stats, X - View Your Stats, C - Action\"\r\n\tinstructionsText.w = screen.w\r\n\tinstructionsText.h = 2\r\n\tinstructionsText.anchor = bottom_left\r\n\tinstructionsText.dock = bottom_left\r\n\tmainWindow.Add(instructionsText)\r\n\r\nfunc createFilter()\r\n\tfilter = ui.AddCanvas()\r\n\tfilter.w = screen.w\r\n\tfilter.h = screen.h\r\n\tfilter.blend = subtract\r\n\tfilter.SetFG(#FFFFFF)\r\n\tmainWindow.Add(filter)\r\n\r\nfunc action(btn)\r\n\treturn actionCheck(\"Battle\", btn, battleWindowButton) |\r\n\t^actionCheck(\"Empower\", btn, empowerWindowButton) |\r\n\t^actionCheck(\"Stats\", btn, statsWindowButton)\r\n\r\nfunc actionCheck(type, btn, btnList)\r\n\tfor i = 0..btnList.Count() - 1\r\n\t\t?btn = btnList[i]\r\n\t\t\tconfirmIndex = i\r\n\t\t\tconfirmType = type\r\n\t\t\treturn true\r\n\treturn false"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Stonemon/fade.txt" - Parse error: Failed to parse completely. Remaining: "= [\"#FFFFFF\",\"#EEEEEE\",\"#DDDDDD\",\"#CCCCCC\",\"#BBBBBB\",\"#AAAAAA\",\"#999999\",\"#888888\",\"#777777\",\"#666666\",\"#555555\",\"#444444\",\"#333333\",\"#222222\",\"#111111\",\"#000000\"]\r\n\r\nvar state = true\r\nvar index = 0\r\nvar color\r\n\r\nfunc chengeIndex(n)\r\n    ?n\r\n        index += n\r\n        changeColor()\r\n\r\nfunc changeColor()\r\n\tcolor = palette[math.Clamp(index, 0, palette.Count() - 1)]\r\n\r\nchangeColor()"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Stonemon/Art.txt" - Parse error: Failed to parse completely. Remaining: "?name = \"Pusher\" | name = \"Envy\" \r\n\t\treturn pusher\r\n\t:?name = \"Scarab\"\r\n\t\treturn scarab \r\n\t:?name = \"Xyloalgia\"\r\n\t\treturn xyloalgia\r\n\t:?name = \"Knee Chopper\"\r\n\t\treturn kneeChopper\r\n\t:?name = \"Bolesh\"\r\n\t\treturn bolesh\r\n\t:?name = \"Big A** Snail\"\r\n\t\treturn bigAssSnail\r\n\t:?name = \"Angry Shroom\"\r\n\t\treturn angryShroom\r\n\t:?name = \"Skeletony\"\r\n\t\treturn skeletony\r\n\t:?name = \"Pallas\"\r\n\t\treturn pallas\r\n\t:?name = \"Dominotaur\"\r\n\t\treturn dominotaur\r\n\t:?name = \"Bronze Guardian\"\r\n\t\treturn bronzeGuardian\r\n\t:?name = \"Giant Ice Elemental\"\r\n\t\treturn giantIceElemental\r\n\t:?name = \"Hrimnir\"\r\n\t\treturn hrimnir\r\n\t:?name = \"Acronian Cultist\"\r\n\t\treturn acronianCultist\r\n\t:?name = \"Nagaraja\"\r\n\t\treturn nagaraja\r\n\t:?name = \"Acronian Scout\"\r\n\t\treturn acronianScout\r\n\t:?name = \"Dysangelos Has Stones\"\r\n\t\treturn dysangelosHasStones\r\n\t:?name = \"Dysangelos Elemental\"\r\n\t\treturn dysangelosElemental\r\n\t:?name = \"Dysangelos Perfected\"\r\n\t\treturn dysangelosPerfected\r\n\t\t\r\n\t:?name = \"Cursor\"\r\n\t\treturn cursor\r\n\t:?name = \"BattleWindow\"\r\n\t\treturn battleWindow\r\n\t:?name = \"Empower Window\"\r\n\t\treturn empowerWindow\r\n\t:?name = \"StatsWindow\"\r\n\t\treturn statsWindow\r\n\t\t\r\n\t:?name = \"Defending\"\r\n\t\treturn shield\r\n\r\n\r\nfunc GetArtHeight(name)\r\n\t?name = \"Pusher\" | name = \"Envy\" \r\n\t\treturn 3\r\n\t:?name = \"Scarab\"\r\n\t\treturn 6\r\n\t:?name = \"Xyloalgia\"\r\n\t\treturn 16\r\n\t:?name = \"Knee Chopper\"\r\n\t\treturn 6\r\n\t:?name = \"Bolesh\"\r\n\t\treturn 11\r\n\t:?name = \"Big A** Snail\"\r\n\t\treturn 6\r\n\t:?name = \"Angry Shroom\"\r\n\t\treturn 15\r\n\t:?name = \"Angry Shroom\"\r\n\t\treturn 15\r\n\t:?name = \"Skeletony\"\r\n\t\treturn 9\r\n\t:?name = \"Pallas\"\r\n\t\treturn 21\r\n\t:?name = \"Dominotaur\"\r\n\t\treturn 8\r\n\t:?name = \"Bronze Guardian\"\r\n\t\treturn 15\r\n\t:?name = \"Giant Ice Elemental\"\r\n\t\treturn 9\r\n\t:?name = \"Hrimnir\"\r\n\t\treturn 13\r\n\t:?name = \"Acronian Cultist\"\r\n\t\treturn 9\r\n\t:?name = \"Nagaraja\"\r\n\t\treturn 18\r\n\t:?name = \"Acronian Scout\"\r\n\t\treturn 9\r\n\t:?name = \"Dysangelos Has Stones\"\r\n\t\treturn 8\r\n\t:?name = \"Dysangelos Elemental\"\r\n\t\treturn 10\r\n\t:?name = \"Dysangelos Perfected\"\r\n\t\treturn 16\r\n\r\n\t:?name = \"Cursor\"\r\n\t\treturn 3\r\n\t:?name = \"BattleWindow\"\r\n\t\treturn 8 \r\n\t:?name = \"Empower Window\"\r\n\t\treturn 9\r\n\t:?name = \"StatsWindow\"\r\n\t\treturn 13\r\n\t\t\r\n\t:?name = \"Defending\"\r\n\t\treturn 4\r\n\r\nfunc GetArtWidth(name)\r\n\t?name = \"Pusher\" | name = \"Envy\" \r\n\t\treturn 3\r\n\t:?name = \"Scarab\"\r\n\t\treturn 10\r\n\t:?name = \"Xyloalgia\"\r\n\t\treturn 26\r\n\t:?name = \"Knee Chopper\"\r\n\t\treturn 14\r\n\t:?name = \"Bolesh\"\r\n\t\treturn 30\r\n\t:?name = \"Big A** Snail\"\r\n\t\treturn 15\r\n\t:?name = \"Angry Shroom\"\r\n\t\treturn 29\r\n\t:?name = \"Skeletony\"\r\n\t\treturn 8\r\n\t:?name = \"Pallas\"\r\n\t\treturn 48\r\n\t:?name = \"Dominotaur\"\r\n\t\treturn 18\r\n\t:?name = \"Bronze Guardian\"\r\n\t\treturn 26\r\n\t:?name = \"Giant Ice Elemental\"\r\n\t\treturn 11\r\n\t:?name = \"Hrimnir\"\r\n\t\treturn 27\r\n\t:?name = \"Acronian Cultist\"\r\n\t\treturn 14\r\n\t:?name = \"Nagaraja\"\r\n\t\treturn 23\r\n\t:?name = \"Acronian Scout\"\r\n\t\treturn 11\r\n\t:?name = \"Dysangelos Has Stones\"\r\n\t\treturn 23\r\n\t:?name = \"Dysangelos Elemental\"\r\n\t\treturn 25\r\n\t:?name = \"Dysangelos Perfected\"\r\n\t\treturn 31\r\n\t\t\r\n\t:?name = \"Cursor\"\r\n\t\treturn 12\r\n\t:?name = \"BattleWindow\"\r\n\t\treturn 30\r\n\t:?name = \"Empower Window\"\r\n\t\treturn 30\r\n\t:?name = \"StatsWindow\"\r\n\t\treturn 30\r\n\t\r\n\t:?name = \"Defending\"\r\n\t\treturn 8\r\n\r\nvar shield = ascii\r\n  ___\r\n (   )\r\n  \\_/\r\nDefense+\r\nasciiend\r\n\r\nvar pusher = ascii\r\n o\r\n/|V\r\n/ \\\r\nasciiend\r\n\r\nvar scarab = ascii\r\n /\r\n/(_,\\ ___\r\n) o /´ -´\\\r\n`──´_,_,_/\r\n    ( ( `.\r\n     ` ` ´\r\nasciiend\r\n\r\n//             ,           \r\n//     _  |'  /  ` /-,     \r\n//     ´\\\\/   '      |     \r\n//      |          /       \r\n// -\\\\!  /   |      |      \r\n//   \\\\ '  | '     (/     / \r\n//    \\|            \\'|   '\r\n//    \\`              `-´_.\r\n//    |              ,-´   \r\n//    \\        /`\\  /      \r\n//   /(\\      /) ; /       \r\n//   \\ `\\    / -´  `- _,   \r\n//    \\        /   ,´ `    \r\n//    |, _ . /'\\  /        \r\n//    ' | ' |  |  |        \r\n//             /  /        \r\n//   _|,_| | ,/   |   ,--. \r\n//  /_'   ¯ '    _ \\ / /¯`\\\r\n// `¯  `.,-     ´ \\ ¯ /    \r\n//      .  ,-´  `. \\¯¯     \r\n//     _' /       ` `-     \r\n//     `-´                 \r\n  \r\nvar xyloalgia = ascii\r\n    \\|            \\'|   '/\r\n    \\`              `-´_.´\r\n    |              ,-´\r\n    \\        /`\\  /\r\n   /(\\      /) ; /\r\n   \\ `\\    / -´  `- _,\r\n    \\        /   ,´ `\r\n    |, _ . /'\\  /\r\n    ' | ' |  |  |\r\n             /  /\r\n   _|,_| | ,/   |   ,--.\r\n  /_'   ¯ '    _ \\ / /¯`\\\r\n `¯  `.,-     ´ \\ ¯ /\r\n      .  ,-´¯ `. \\¯¯\r\n     _' /       ` `-\r\n     `-´\r\nasciiend\r\n\r\nvar kneeChopper = ascii\r\n       ___\r\n      ()`-.\\\r\n ,--. _`__(/\r\n'´‾‾'∞.,)´)\\\r\n _,--_/ ` ` `\r\n ‾‾‾´\r\nasciiend\r\n\r\nvar bolesh = ascii\r\n              _\r\n    _____/\\  ||\\  /|\r\n   /,---.\\\\\\ ||\\\\/_'--._\r\n  //  -´´\\\\\\\\||/¯ _/\\ __`._\r\n-´´    __ \\/¯¯¯\\/.|/\\\\--(\\/\r\n    ,-°∞ ) /\\  //||/_\\\\-´\\\\\r\n      _/¯ //\\`´/´||  //   \\\\\r\n         //  ¯¯  // (´     ``-\r\n         \\\\     (´   `\r\n          `)    `\r\n           ´\r\nasciiend\r\n\r\nvar bigAssSnail = ascii\r\nO O  ,'¯¯¯`.\r\n((  / ,--.  \\\r\n/¯\\| /  _ \\ |\r\nVv,\\ \\ (__/ /\r\n  \\ `._____/-,\r\n   `..-.___.´\r\nasciiend\r\n\r\nvar angryShroom = ascii\r\n         ./¯)¯`.\r\n     _,-' ¯¯  ,-\\\r\n  .-'        (__'`._\r\n /  ,--.            `.\r\n|   \\ _.'  /`-.    _,-.\\\r\n\\  .;::,_  `-._)  (   / |\r\n ':. ':  `--..__   `-' /\r\n    `\"|         `--.--'\r\n /¯¯\\ /           |_\r\n \\ //¯,   \\   /     `---.\r\n | V /|   o   o    \\¯¯¯`.`.\r\n  \\,' |            |    /  \\\r\n     /    (---)     \\   \\)_/\r\n     \\              |\r\n       `--.___..__,'\r\nasciiend\r\n\r\nvar skeletony = ascii\r\n  __\r\n ,o_)\r\n  \"':_\r\n _.-/)\\\r\n\"`,-´_/\r\n '\"   ;\r\n     /|\r\n    / \\\r\n  ,-' ,/\r\nasciiend\r\n\r\nvar pallas = ascii\r\n          _.---._\r\n         /       \\\r\n        |.-  ,-   |__\r\n        \\ *)  *)( |_/\\\r\n         )  ^`  _/(\\\\-\\\r\n         `v\"uuV`  // |-|\r\n          |   <..<'  /-/   _______.-._____.-,._\r\n          |    _ ,-.|-|.-(_.-----`-'-----.\\¯\\¯`\r\n          |  ( (   /\\  / )                 \\)|\r\n          .  //(`._'`-' / )              (_| |_\r\n            // (`._/\\`-' /               `-'¯'-)\r\n           /(   `._/ `.-'                  / |\r\n          (v)       .-.\\-\\.-.              | |\r\n          //       (  ( \\-)  )             ) |\r\n_        //         \\   `-'  /_           /  |\r\n \\_   __//          ('`--^--'v )          )  |\r\n   \\/`/'-`.          \\(      )/   _  ,,,  \\  /\r\n /  `(   '`)          \\\\    //  _/ \\`_/   |  |\r\n        `  \\           \\\\  //,-'_)-' _     ) |\r\n    '                   )\\/(.-.___.-/ \\._  \\ |\r\n                       (_(._)_.---._)_)._)_>\\/\r\nasciiend\r\n\r\nvar dominotaur = ascii\r\n   ,--.   ( __ )\r\n  /  /     ¯\\/¯\r\n '  |    _,-´'-.\r\n     `==´¯¯\\. ¯`)\r\n           /-´\\\"\r\n          ( `\\ \\\r\n           )/ )/\r\n           \"  \"\r\nasciiend\r\n\r\nvar bronzeGuardian = ascii\r\n    _____\r\n    )\\ __\\     //¯¯\\\r\n   / /  .´    (() {-}\r\n  / /  /       `-,-'|\r\n / /,-/    .---./   .---.\r\n| /  \\\\   /  /¯¯¯¯¯/ / `\\\\\r\n '--´|`,) \\ (      \\ ` ,'/\r\n     \\ \\\\.'`-\\  `   `---'\r\n      \\ \\\\  / )'|`  /  |\r\n       \\ \\\\'  |_ _ |  /\r\n        \\/\\\\ [____.' /\r\n           \\\\/  .' .'\\\r\n            \\.-'_.'  |\r\n            (_.',     \\\r\n           | _\\\\/\\_ _ _|\r\n           |   \\\\| ¯ ¯ |\r\nasciiend\r\n\r\nvar giantIceElemental = ascii\r\n    ,\r\n    |\\\r\n . /' \\ ,\r\n |` '  ´|_\r\n\\'__·   ;/_\r\n\\/  \\  ´ ,´\r\n<\\  / ,  >\r\n \\‾‾  _.'\r\n  ¯‾‾‾\r\nasciiend\r\n\r\nvar hrimnir = ascii\r\n            )\r\n           /(__\r\n          (_   )_ /\\. ^ .\r\n        .^ )¯ ´  V /     >\r\n       <  (•`´- ) /  ,    >\r\n      <   {,-,`´ (  \\_   >\r\n     , <|  `.,.-'´  /   |\r\n __.´   \\           |   /\r\n/ _  .-´ `\"•\"´ `\"•\"´'  /\r\n\\`.) /   ,/ `.___.´/  /\r\n `(.´   / \\__/  _.´   \\\r\n       (_(_(__)'--| | \\`:.\r\n                  '-'`-`-`\r\nasciiend\r\n\r\nvar acronianCultist = ascii\r\n   ,-.\r\n   )o))\r\n  /`/ (\r\n / :   \\\r\n('\\   /`┼══──\r\n:  ) /\r\n∞ /' `.\r\n' \\._, `-.__\r\n      ¯¯¯\r\nasciiend\r\n\r\nvar nagaraja = ascii\r\n   _____\r\n   `Vv-,`-.\r\n      \\ ´, `-.\r\n       )  \\   `'-.\r\n      /  _ \\      `.\r\n     /  ´x) \\       \\\r\n   .´   `   |        \\\r\n ,´,.---._  |         \\\r\n/ /      .`.'  |      |\r\n`.\\       '/  ,'      |\r\n      __.-'_.´        |\r\n      `---´          /\r\n       /            /\r\n      /            /\r\n     /            /\r\n    .            /\r\n    |            |\r\n    |            |\r\n    |            |\r\nasciiend\r\n\r\nvar acronianScout = ascii\r\n      /\r\n   ),_ ____\r\n   `o/(  -´\r\n  ,/_\\ );\r\n  /  /\\´\r\n / -´ _)_\r\nL    / .´\r\n    ; (\r\n   /   \\\r\nasciiend\r\n\r\nvar dysangelosHasStones = ascii\r\n          ___\r\n         /.-,\\\r\n  .--.  (´  o´\r\n (:¯`.\\  \\`.        .-.\r\n  `o  \\ `.) \\      //o'\r\n       `.´__ `-.,-´/\r\n _    .´)(o_) .--'´  _\r\n(o'_.´.-\\,-, _'._   o,\\\r\n `---´   `--´ `-.`._.'/\r\n                 `---´\r\nasciiend\r\n\r\nvar dysangelosElemental = ascii\r\n           .--.\r\n  .--.    /,´`.\\     __\r\n (:¯`.\\   \\\\  *´   /.-.)\r\n  `♥  \\ `. )\\     // φ´\r\n       `.´__ `-.-´/  _\r\n _    .´)(•_) .--´ ❄.\\\r\n(∞'_.´.-\\  _  _'-.__.´/\r\n `---´   /- )´ `'----´\r\n        /  /\r\n        '  '\r\nasciiend\r\n\r\nvar dysangelosPerfected = ascii\r\n            .--. ___\r\n           ( '--´   `.\r\n            `.__.-,   \\\r\n    .--.     _.--´    /\r\n   /    `. .´      .-'¯¯¯¯¯¯'.\r\n  _|    \\  \\!.  --(_   ,-     )\r\n /  `.  |  ´          (    -:´\r\n|   _   /,    ____    \\/`-.  \\\r\n \\ ( `-´_|  <´(_) `>  '`___) /\r\n  `-- .´ \\   `.,.-´     `---´\r\n    _|              /     \\\r\n   /  `.  `.__.___.´`,--.  |\r\n  |   _   !         /  _   /\r\n   \\ ( `-´          \\ ( `-´\r\n    `.`._            `.`._\r\n      ¯¯¯¯             ¯¯¯¯\r\nasciiend"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Stonemon/bar.txt" - Parse error: Failed to parse completely. Remaining: "= string + \"\"\r\n\t?string.Size(string) < length\r\n\t\tfor i = string.Size(string)+1..length\r\n\t\t\tstring = string + append\r\n\t\t\t\r\n\treturn string\r\n\t\t\r\nfunc GetBarArt(percent)\r\n\tbar = \"\"\r\n\r\n\t?percent >= 100\r\n\t\tbar = \"████████████████████\"\r\n\t:\r\n\t\t?percent >= 5\r\n\t\t\tfor i = 0..percent / 5\r\n\t\t\t\tbar += \"█\"\r\n\t\t\r\n\t\t?percent % 5 = 4\r\n\t\t\tbar += \"█\"\r\n\t\t:?percent % 5 = 3\r\n\t\t\tbar += \"▓\"\r\n\t\t:?percent % 5 = 2\r\n\t\t\tbar += \"▒\"\r\n\t\t:?percent % 5 = 1\r\n\t\t\tbar += \"░\"\r\n\t\r\n\t\tbar = MinLengthA(bar, 20, \"─\")\r\n\r\nfunc needUpdate()\r\n\treturn currentLength ! maxLength\r\n\r\nfunc update()\r\n\tcurrentLength += math.Clamp(maxLength - currentLength, -2, 2)\r\n\tGetBarArt(currentLength)\r\n\r\nfunc setMaxLength(current, max)\r\n\tmaxLength = 100 * current / max\r\n\r\nfunc setCurrent(current)\r\n\tstringCurrent = MinLengthA(current, 3, \" \")\r\n\r\nfunc setMax(max)\r\n\tstringMax = MinLengthA(max, 3, \" \")\r\n\r\nfunc set(current, max)\r\n\tsetCurrent(current)\r\n\tsetMax(max)\r\n\tsetMaxLength(current, max)\r\n\r\nfunc restart(current, max)\r\n\tcurrentLength = 0\r\n\tmaxLength = 100\r\n\tset(current, max)"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Stonemon/Creatures.txt" - Parse error: Failed to parse completely. Remaining: "= value + ((rngVal % ((value/5)+1)) - (value/10))\r\n\tvalue = math.Clamp(value, 0, 999)\r\n\t\r\n\tQuality = Quality + ((value-startVal)*statValue)\r\n\t\r\n\treturn value\r\n\r\nfunc GenerateCreature(name)\r\n\t?name\r\n\t\tGenerateNew(name)\r\n\t:\r\n\t\tGenerateNew(rng % 18 + 1)\r\n\t\r\nfunc GenerateNew(name)\r\n\tQuality = 0\r\n\t?name = \"Starter\" | name = 0\r\n\t\tName = \"Envy\"\r\n\t\tCurrentHP = 100\r\n\t\tMax_HP = CurrentHP + (CurrentHP / 5)\r\n\t\tCurrentMP = 100\r\n\t\tMax_MP = CurrentMP + (CurrentMP / 5)\r\n\t\tSkillName = \"Vent Jealously\"\r\n\t\tSkillCost = 50\r\n\t\tSkillEffect = \"Damage 2x\"\r\n\t\tSkillDescription = \"Someone has Something, \\n##Beat them till it's Yours\"\r\n\t\tDamage = 20\r\n\t\tDamageMod = 5\r\n\t\tRegenHP = false\r\n\t\tRegenMP = true\r\n\t\t\r\n\t:?name = \"Scarab\" | name = 1\r\n\t\tName = \"Scarab\"\r\n\t\tCurrentHP = RandomVeriance(50, 1)\r\n\t\tMax_HP = CurrentHP + (CurrentHP / 5)\r\n\t\tMax_MP = RandomVeriance(100, 1)\r\n\t\tCurrentMP = Max_MP - (Max_MP / 5)\r\n\t\tSkillName = \"Reckless Charge\"\r\n\t\tSkillCost = RandomVeriance(90, -4)\r\n\t\tSkillEffect = \"Damage 1.5x, May Hurt Self\"\r\n\t\tSkillDescription = \"Charges with Blind Rage\"\r\n\t\tDamage = RandomVeriance(5, 5)\r\n\t\tDamageMod = 0\r\n\t\tRegenHP = false\r\n\t\tRegenMP = true\r\n\t\t\r\n\t:?name = \"Xyloalgia\" | name = 2\r\n\t\tName = \"Xyloalgia\"\r\n\t\tCurrentHP = RandomVeriance(200, 1)\r\n\t\tMax_HP = CurrentHP + (CurrentHP / 5)\r\n\t\tMax_MP = RandomVeriance(200, 1)\r\n\t\tCurrentMP = Max_MP - (Max_MP / 5)\r\n\t\tSkillName = \"Mean Branches\"\r\n\t\tSkillCost = RandomVeriance(150, -4)\r\n\t\tSkillEffect = \"Damage 3x\"\r\n\t\tSkillDescription = \"Xylo Lives in Agony,\\n##Now so do you! REJOICE!\"\r\n\t\tDamage = RandomVeriance(15, 5)\r\n\t\tDamageMod = 0\r\n\t\tRegenHP = false\r\n\t\tRegenMP = true\r\n\t\t\r\n\t:?name = \"Knee Chopper\" | name = 3\r\n\t\tName = \"Knee Chopper\"\r\n\t\tCurrentHP = RandomVeriance(120, 1)\r\n\t\tMax_HP = CurrentHP + (CurrentHP / 5)\r\n\t\tMax_MP = RandomVeriance(120, 1)\r\n\t\tCurrentMP = Max_MP - (Max_MP / 5)\r\n\t\tSkillName = \"Sate Craving\"\r\n\t\tSkillCost = RandomVeriance(90, -4)\r\n\t\tSkillEffect = \"Damage 2x\"\r\n\t\tSkillDescription = \"He has the Rumblies that,\\n##only Knees can satisfy\"\r\n\t\tDamage = RandomVeriance(8, 5)\r\n\t\tDamageMod = 0\r\n\t\tRegenHP = false\r\n\t\tRegenMP = true\r\n\t\t\r\n\t:?name = \"Bolesh\" | name = 4\r\n\t\tName = \"Bolesh\"\r\n\t\tCurrentHP = RandomVeriance(240, 1)\r\n\t\tMax_HP = CurrentHP + (CurrentHP / 5)\r\n\t\tMax_MP = RandomVeriance(200, 1)\r\n\t\tCurrentMP = 0\r\n\t\tSkillName = \"Annoyance Rising\"\r\n\t\tSkillCost = RandomVeriance(80, -4)\r\n\t\tSkillEffect = \"Damage+ 25% Anger+ 50%\"\r\n\t\tSkillDescription = \"These Bugs... just \\n##wont leave me alone...\"\r\n\t\tDamage = RandomVeriance(8, 5)\r\n\t\tDamageMod = 0\r\n\t\tRegenHP = false\r\n\t\tRegenMP = true\r\n\t\t\r\n\t:?name = \"Big A** Snail\" | name = 5\r\n\t\tName = \"Big A** Snail\"\r\n\t\tCurrentHP = RandomVeriance(125, 1)\r\n\t\tMax_HP = CurrentHP + (CurrentHP / 5)\r\n\t\tMax_MP = RandomVeriance(120, 1)\r\n\t\tCurrentMP = Max_MP - (Max_MP / 5)\r\n\t\tSkillName = \"Slimy Touch\"\r\n\t\tSkillCost = RandomVeriance(90, -4)\r\n\t\tSkillEffect = \"Damage 1.5x, Icky+\"\r\n\t\tSkillDescription = \"Some people like that \\n##sort of thing...\"\r\n\t\tDamage = RandomVeriance(5, 5)\r\n\t\tDamageMod = 0\r\n\t\tRegenHP = true\r\n\t\tRegenMP = true\r\n\t\t\r\n\t:?name = \"Angry Shroom\" | name = 6\r\n\t\tName = \"Angry Shroom\"\r\n\t\tCurrentHP = RandomVeriance(175, 1)\r\n\t\tMax_HP = CurrentHP + (CurrentHP / 5)\r\n\t\tMax_MP = RandomVeriance(200, 1)\r\n\t\tCurrentMP = Max_MP - (Max_MP / 5)\r\n\t\tSkillName = \"Alpha Punch\"\r\n\t\tSkillCost = RandomVeriance(125, -4)\r\n\t\tSkillEffect = \"Damage 2.5x\"\r\n\t\tSkillDescription = \"It feels good to Hit stuff\"\r\n\t\tDamage = RandomVeriance(12, 5)\r\n\t\tDamageMod = 0\r\n\t\tRegenHP = true\r\n\t\tRegenMP = true\r\n\t\t\r\n\t:?name = \"Skeletony\" | name = 7\r\n\t\tName = \"Skeletony\"\r\n\t\tCurrentHP = RandomVeriance(150, 1)\r\n\t\tMax_HP = CurrentHP + (CurrentHP / 5)\r\n\t\tMax_MP = RandomVeriance(120, 1)\r\n\t\tCurrentMP = Max_MP - (Max_MP / 5)\r\n\t\tSkillName = \"Entropy Slam\"\r\n\t\tSkillCost = RandomVeriance(90, -4)\r\n\t\tSkillEffect = \"1.5x > HP & MP\"\r\n\t\tSkillDescription = \"The Energies that Animate \\n##can also Disintegrate\"\r\n\t\tDamage = RandomVeriance(22, 5)\r\n\t\tDamageMod = 0\r\n\t\tRegenHP = false\r\n\t\tRegenMP = true\r\n\t\t\r\n\t:?name = \"Pallas\" | name = 8\r\n\t\tName = \"Pallas\"\r\n\t\tCurrentHP = RandomVeriance(300, 1)\r\n\t\tMax_HP = CurrentHP + (CurrentHP / 5)\r\n\t\tMax_MP = RandomVeriance(300, 1)\r\n\t\tCurrentMP = Max_MP / 5\r\n\t\tSkillName = \"BF Sword\"\r\n\t\tSkillCost = RandomVeriance(150, -4)\r\n\t\tSkillEffect = \"2x to HP & MP, Drain Effect\"\r\n\t\tSkillDescription = \"Pallas is practically\\n##Immortal, are you?\"\r\n\t\tDamage = RandomVeriance(25, 5)\r\n\t\tDamageMod = 0\r\n\t\tRegenHP = false\r\n\t\tRegenMP = true\r\n\t\t\r\n\t:?name = \"Dominotaur\" | name = 9\r\n\t\tName = \"Dominotaur\"\r\n\t\tCurrentHP = RandomVeriance(200, 1)\r\n\t\tMax_HP = CurrentHP + (CurrentHP / 5)\r\n\t\tMax_MP = RandomVeriance(300, 1)\r\n\t\tCurrentMP = Max_MP - (Max_MP / 5)\r\n\t\tSkillName = \"Sadistic Glee\"\r\n\t\tSkillCost = RandomVeriance(40, -4)\r\n\t\tSkillEffect = \"0.8x Damage\"\r\n\t\tSkillDescription = \"For when you get pleasure \\n##from violence\"\r\n\t\tDamage = RandomVeriance(26, 5)\r\n\t\tDamageMod = 0\r\n\t\tRegenHP = false\r\n\t\tRegenMP = true\r\n\t\t\r\n\t:?name = \"Bronze Guardian\" | name = 10\r\n\t\tName = \"Bronze Guardian\"\r\n\t\tCurrentHP = 700\r\n\t\tMax_HP = 700\r\n\t\tMax_MP = 100\r\n\t\tCurrentMP = 0\r\n\t\tSkillName = \"Expensive Hammer\"\r\n\t\tSkillCost = 50\r\n\t\tSkillEffect = \"Increasingly Powerful\"\r\n\t\tSkillDescription = \"This is how you Pay2Win\\n##3rd Hit KO, True Damage\"\r\n\t\tDamage = RandomVeriance(0, 5)\r\n\t\tDamageMod = 0\r\n\t\tRegenHP = false\r\n\t\tRegenMP = true\r\n\t\t\r\n\t\tPay2Win = 0\r\n\t\t\r\n\t:?name = \"Giant Ice Elemental\" | name = 11\r\n\t\tName = \"Giant Ice Elemental\"\r\n\t\tCurrentHP = RandomVeriance(300, 1)\r\n\t\tMax_HP = CurrentHP + (CurrentHP / 5)\r\n\t\tMax_MP = RandomVeriance(400, 1)\r\n\t\tCurrentMP = Max_MP - (Max_MP / 5)\r\n\t\tSkillName = \"Kamehame-Sneeze\"\r\n\t\tSkillCost = RandomVeriance(80, -4)\r\n\t\tSkillEffect = \"Damage 1x, Freeze 10%\"\r\n\t\tSkillDescription = \"Ice Elementals Like to make\\n##Ice Sculpture. Are you one?\"\r\n\t\tDamage = RandomVeriance(35, 5)\r\n\t\tDamageMod = 0\r\n\t\tRegenHP = false\r\n\t\tRegenMP = true\r\n\t\t\r\n\t:?name = \"Hrimnir\" | name = 12\r\n\t\tName = \"Hrimnir\"\r\n\t\tCurrentHP = RandomVeriance(400, 1)\r\n\t\tMax_HP = CurrentHP + (CurrentHP / 5)\r\n\t\tMax_MP = RandomVeriance(400, 1)\r\n\t\tCurrentMP = Max_MP - (Max_MP / 5)\r\n\t\tSkillName = \"SnowBall o'Matic\"\r\n\t\tSkillCost = RandomVeriance(40, -4)\r\n\t\tSkillEffect = \"Damage 1x, Freeze 25%\"\r\n\t\tSkillDescription = \"He Knows what it's like to\\n##be Frozen, Now You Too!\"\r\n\t\tDamage = RandomVeriance(40, 5)\r\n\t\tDamageMod = 0\r\n\t\tRegenHP = false\r\n\t\tRegenMP = true\r\n\t\t\r\n\t:?name = \"Acronian Cultist\" | name = 13\r\n\t\tName = \"Acronian Cultist\"\r\n\t\tCurrentHP = RandomVeriance(350, 1)\r\n\t\tMax_HP = CurrentHP + (CurrentHP / 5)\r\n\t\tMax_MP = RandomVeriance(300, 1)\r\n\t\tCurrentMP = Max_MP - (Max_MP / 5)\r\n\t\tSkillName = \"Spooky Lantern\"\r\n\t\tSkillCost = RandomVeriance(60, -4)\r\n\t\tSkillEffect = \"Damage+ 10%\"\r\n\t\tSkillDescription = \"Some think he's using souls\\n##for power, don't chance it!\"\r\n\t\tDamage = RandomVeriance(44, 5)\r\n\t\tDamageMod = 0\r\n\t\tRegenHP = false\r\n\t\tRegenMP = true\r\n\t\t\r\n\t:?name = \"Nagaraja\" | name = 14\r\n\t\tName = \"Nagaraja\"\r\n\t\tCurrentHP = RandomVeriance(400, 1)\r\n\t\tMax_HP = CurrentHP + (CurrentHP / 5)\r\n\t\tMax_MP = RandomVeriance(999, 1)\r\n\t\tCurrentMP = Max_MP - (Max_MP / 5)\r\n\t\tSkillName = \"Swallow\"\r\n\t\tSkillCost = RandomVeriance(10, -4)\r\n\t\tSkillEffect = \"Instant Kill\"\r\n\t\tSkillDescription = \"Don't Let up or he'll\\n##Swallow you Whole\"\r\n\t\tDamage = RandomVeriance(45, 5)\r\n\t\tDamageMod = 0\r\n\t\tRegenHP = false\r\n\t\tRegenMP = true\r\n\t\t\r\n\t\tPay2Win = CurrentHP\r\n\t\t\r\n\t:?name = \"Acronian Scout\" | name = 15\r\n\t\tName = \"Acronian Scout\"\r\n\t\tCurrentHP = RandomVeriance(400, 1)\r\n\t\tMax_HP = CurrentHP + (CurrentHP / 5)\r\n\t\tMax_MP = RandomVeriance(400, 1)\r\n\t\tCurrentMP = Max_MP - (Max_MP / 5)\r\n\t\tSkillName = \"Javelin Prod\"\r\n\t\tSkillCost = RandomVeriance(120, -4)\r\n\t\tSkillEffect = \"Damage 2.5x\"\r\n\t\tSkillDescription = \"Surprisingly Effective\"\r\n\t\tDamage = RandomVeriance(32, 5)\r\n\t\tDamageMod = 0\r\n\t\tRegenHP = false\r\n\t\tRegenMP = true\r\n\t\t\r\n\t:?name = \"Dysangelos Has Stones\" | name = 16\r\n\t\tName = \"Dysangelos Has Stones\"\r\n\t\tCurrentHP = RandomVeriance(500, 1)\r\n\t\tMax_HP = CurrentHP + (CurrentHP / 5)\r\n\t\tMax_MP = RandomVeriance(999, 1)\r\n\t\tCurrentMP = 0\r\n\t\tSkillName = \"Raw Power\"\r\n\t\tSkillCost = RandomVeriance(500, -4)\r\n\t\tSkillEffect = \"Damage 3.5x\"\r\n\t\tSkillDescription = \"He's Got the Stones\"\r\n\t\tDamage = RandomVeriance(40, 5)\r\n\t\tDamageMod = 0\r\n\t\tRegenHP = false\r\n\t\tRegenMP = true\r\n\t\t\r\n\t:?name = \"Dysangelos Elemental\" | name = 17\r\n\t\tName = \"Dysangelos Elemental\"\r\n\t\tCurrentHP = RandomVeriance(500, 1)\r\n\t\tMax_HP = CurrentHP + (CurrentHP / 5)\r\n\t\tMax_MP = RandomVeriance(999, 1)\r\n\t\tCurrentMP = 0\r\n\t\tSkillName = \"Elemental Lotto\"\r\n\t\tSkillCost = RandomVeriance(500, -4)\r\n\t\tSkillEffect = \"Damage 2x, Random Effect\"\r\n\t\tSkillDescription = \"...Poison,Vigor,Æther,Fire\\n##and Ice, not Wind Though!\"\r\n\t\tDamage = RandomVeriance(50, 5)\r\n\t\tDamageMod = 0\r\n\t\tRegenHP = false\r\n\t\tRegenMP = true\r\n\t\t\r\n\t:?name = \"Dysangelos Perfected\" | name = 18\r\n\t\tName = \"Dysangelos Perfected\"\r\n\t\tCurrentHP = 999\r\n\t\tMax_HP = 999\r\n\t\tMax_MP = 999\r\n\t\tCurrentMP = 0\r\n\t\tSkillName = \"Perfection\"\r\n\t\tSkillCost = 999\r\n\t\tSkillCostMinimum = 999\r\n\t\tSkillEffect = \"Perfect\"\r\n\t\tSkillDescription = \"you cant improve on\\n##Perfection!\"\r\n\t\tDamage = 55\r\n\t\tDamageMod = 0\r\n\t\tRegenHP = false\r\n\t\tRegenMP = true\r\n\t\t\r\n\tMaxHPGrowth = Max_HP * 2\r\n\tMaxMPGrowth = Max_MP * 2\r\n\tSkillCostMinimum = SkillCost / 2\r\n\tDamageGrowth = Damage * 2\r\n\r\n\tDefending = false\r\n\tDefendingCD = 0\r\n\r\nfunc Regenerate()\r\n\t?RegenHP\r\n\t\tCurrentHP = math.Clamp(CurrentHP + Max_HP / 10, 0, Max_HP)\r\n\t?RegenMP\r\n\t\tCurrentMP = math.Clamp(CurrentMP + Max_MP / 10, 0, Max_MP)\r\n\t\t\r\nGenerateNew(0)"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Stonemon/GlobalVars.txt" - Parse error: Failed to parse completely. Remaining: "= \"Boot\"\r\n\r\nvar creatures = new Games\\Stonemon\\Creatures\r\nvar PC = new Games\\Stonemon\\Creatures\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Stonemon/InputControl.txt" - Parse error: Failed to parse completely. Remaining: "?key = \"ability1\" & key = \"ability2End\"\r\n\t\tphase = \"Restart\"\r\n\t:?key = \"backEnd\"\r\n\t\tphase = \"startPlayerStats\"\r\n\t:?key = \"bumpLEnd\"\r\n\t\tphase = \"startFoeStats\"\r\n\r\nfunc playerStats()\r\n\t?key = \"backEnd\"\r\n\t\tphase = \"endStats\"\r\n\t:?key = \"bumpLEnd\"\r\n\t\tphase = \"startFoeStats\"\r\n\r\nfunc foeStats()\r\n\t?key = \"bumpLEnd\"\r\n\t\tphase = \"endStats\"\r\n\t:?key = \"backEnd\"\r\n\t\tphase = \"startPlayerStats\"\r\n\r\nfunc optionsControl()\r\n\tcursorMovement()\r\n\tconfirmAction()\r\n\r\nfunc cursorMovement()\r\n\t?key = \"downEnd\"\r\n\t\tcursor = cursor + 2\r\n\t:?key = \"upEnd\"\r\n\t\tcursor = cursor - 2\r\n\t:?key = \"leftEnd\"\r\n\t\tcursor--\r\n\t:?key = \"rightEnd\"\r\n\t\tcursor++\r\n\tcursor = math.Clamp(cursor,0,3)\r\n\r\nfunc confirmAction()\r\n\tconfirm = key = \"bumpREnd\"\r\n\treturn confirm\r\n\r\nfunc Restart()\r\n\tphase = \"\"\r\n\tcursor = 0"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/StoneDungeon.txt" - Parse error: Failed to parse completely. Remaining: "= \"EN\"\r\nvar LANGUAGE_ZH_CN = \"ZH-CN\"\r\nvar LANGUAGE_ZH_TW = \"ZH-TW\"\r\nvar LANGUAGE_CODE_EN = 0\r\nvar LANGUAGE_CODE_CN = 1\r\nvar LANGUAGE_CODE_OTHER = LANGUAGE_CODE_EN\r\nvar languageCode = LANGUAGE_CODE_EN\r\n\r\nvar GAME_MODE_HARD = 0\r\nvar GAME_MODE_NORMAL = 1\r\nvar GAME_MODE_EASY = 2\r\nvar gameMode = GAME_MODE_HARD\r\n\r\n//------------------------------------------------------------------------------------------------------\r\n\r\nvar STRING_ENTER_TO_START\r\nvar STRING_ENTER_TO_CONTINUE\r\nvar STRING_ENTER_TO_RETURN\r\nvar HINT_INITIALIZING\r\nvar HINT_GENERATING\r\nvar HINT_DRAWING\r\nvar HINT_COMPLETED\r\nvar GLYPH_DESCRIPTIONS = []\r\nvar TITLE_STORY = []\r\nvar BEGINNING_STORY= []\r\nvar ENDING_STORY = []\r\nfunc InitLanguageSettings()\r\n  ?te.language = LANGUAGE_EN\r\n    languageCode = LANGUAGE_CODE_EN\r\n  :?te.language = LANGUAGE_ZH_CN | te.language = LANGUAGE_ZH_TW\r\n    languageCode = LANGUAGE_CODE_CN\r\n  :\r\n    languageCode = LANGUAGE_CODE_OTHER\r\n\r\n  ?languageCode = LANGUAGE_CODE_CN\r\n    STRING_ENTER_TO_START = \"按 回车 键开始\"\r\n    STRING_ENTER_TO_CONTINUE = \"按 回车 键继续\"\r\n    STRING_ENTER_TO_RETURN = \"按 回车 键返回\"\r\n    HINT_INITIALIZING = \"正在初始化...\"\r\n    HINT_GENERATING = \"正在生成地牢...\"\r\n    HINT_DRAWING = \"正在绘制地牢...\"\r\n    HINT_COMPLETED = \"已完成\"\r\n\r\n    GLYPH_DESCRIPTIONS.Clear()\r\n    GLYPH_DESCRIPTIONS.Add(\"我过不去。\")\r\n    GLYPH_DESCRIPTIONS.Add(\"不知道通向哪里的道路。\")\r\n    GLYPH_DESCRIPTIONS.Add(\"普普通通的房间.\")\r\n    GLYPH_DESCRIPTIONS.Add(\"石之屋。到处都是碎石。\")\r\n    GLYPH_DESCRIPTIONS.Add(\"水之屋。我讨厌潮湿的空气。\")\r\n    GLYPH_DESCRIPTIONS.Add(\"火之屋。太热了，我得赶紧离开这里。\")\r\n    GLYPH_DESCRIPTIONS.Add(\"冰之屋。我快要冻僵了。\")\r\n\r\n    TITLE_STORY.Clear()\r\n    TITLE_STORY.Add(\"\\\"好不容易逃出了那该死的矿坑！我只想要活下去！\\\"\")\r\n    TITLE_STORY.Add(\"在一场混乱中，我跟着同伴逃离了灼热矿坑，但左臂上突然出现了几道蛇形印记。\")\r\n    TITLE_STORY.Add(\"一位路过的商人操着奇怪的口音向我透露，这些印记意味着我被蛇神选为了祭品。\")\r\n    TITLE_STORY.Add(\"但是在卫城的宝庫中，或许会有万灵药可以解除这道诅咒。\")\r\n    TITLE_STORY.Add(\"我倾尽所有从商人手中购得这条传送护符，据说它可以直接送我去往宝庫。\")\r\n    TITLE_STORY.Add(\"我别无选择，不论真假我只能激活这条护符。而结果是，我真的来到了宝庫内部。那位商人到底是谁？\")\r\n    TITLE_STORY.Add(\"我无视遍地的金银财宝，只专注于寻找万灵药。忽然，一道强光闪过，我失去了意识......\")\r\n    TITLE_STORY.Add(\"游戏玩法：寻找 [color=#1abc9c]<>[/color] 标记从而逃出地牢。\")\r\n\r\n    BEGINNING_STORY.Clear()\r\n    var hardBeginningStory = []\r\n    BEGINNING_STORY.Add(hardBeginningStory)\r\n    hardBeginningStory.Add(\"不知过了多久，我醒了过来。四周十分昏暗，只有墙上的火把有微弱的光亮。\")\r\n    hardBeginningStory.Add(\"看来我是中了陷阱，被传送到了这个阴森的地牢。我到底该怎么逃出去？\")\r\n    hardBeginningStory.Add(\"我拿起墙上的火把，沿着不知通往何方的道路前行。\")\r\n    hardBeginningStory.Add(\"\\\"要是至少能在刚才的宝庫中找到些发光的宝贝也好啊......\\\"\")\r\n    var normalBeginningStory = []\r\n    BEGINNING_STORY.Add(normalBeginningStory)\r\n    normalBeginningStory.Add(\"不知过了多久，我醒了过来。与此同时，我发现我的口袋正在发光。\")\r\n    normalBeginningStory.Add(\"我拿出口袋里的东西，是一颗之前得到的绿色宝石。它闪烁着光芒，似乎在指引我向着某个方向前行。\")\r\n    normalBeginningStory.Add(\"虽然应该是被陷阱传送到了这个地牢，但是还好有这颗宝石在。它应该能带我逃出去吧......\")\r\n    var easyBeginningStory = []\r\n    BEGINNING_STORY.Add(easyBeginningStory)\r\n    easyBeginningStory.Add(\"一阵温暖让我醒了过来。原来是我的口袋正在发出强烈的光芒。\")\r\n    easyBeginningStory.Add(\"我拿出口袋里的东西，是之前在宝庫中获得的黄色宝石，它正闪烁着温暖的光芒。\")\r\n    easyBeginningStory.Add(\"在房间的角落，我发现了一根被废弃的法杖，它的顶端似乎缺了点什么。\")\r\n    easyBeginningStory.Add(\"我尝试将这颗宝石放上去。忽然，黑暗被彻底驱散，整个地牢都被照亮了。\")\r\n\r\n    ENDING_STORY.Clear()\r\n    var hardEndingStory = []\r\n    ENDING_STORY.Add(hardEndingStory)\r\n    hardEndingStory.Add(\"地上有一个奇怪的魔法阵，然而为了逃出去，我似乎也只能踩上去了。\")\r\n    hardEndingStory.Add(\"一阵炫目的光芒过后，我回到了地面，就在遇到那位商人的地方，只是商人已经不见。\")\r\n    hardEndingStory.Add(\"我看了看我的左臂，蛇形印记依然存在。没有万灵药，我该怎么逃脱蛇神的追捕啊......\")\r\n    var normalEndingStory = []\r\n    ENDING_STORY.Add(normalEndingStory)\r\n    normalEndingStory.Add(\"地上有一个奇怪的魔法阵，我手中的宝石似乎就是指引着我来到这里。\")\r\n    normalEndingStory.Add(\"虽然犹豫了一会儿，但我还是决定踩了上去。\")\r\n    normalEndingStory.Add(\"一阵炫目的光芒过后，我回到了地面，那位商人还在那里，面带微笑。\")\r\n    normalEndingStory.Add(\"\\\"找到万灵药了吗？\\\"\")\r\n    normalEndingStory.Add(\"我刚想冲上去质问他地牢是怎么回事，只见他指了指我的左臂。\")\r\n    normalEndingStory.Add(\"只见蛇形印记已经消失得无影无踪。待我再次看向那位商人时，他也消失得无影无踪了......\")\r\n    var easyEndingStory = []\r\n    ENDING_STORY.Add(easyEndingStory)\r\n    easyEndingStory.Add(\"地上有一个奇怪的魔法阵，配合着手杖上的黄色宝石，闪烁着柔和的光芒。\")\r\n    easyEndingStory.Add(\"我毫不犹豫地踩了上去，顿时一阵温暖围绕着我的左臂。\")\r\n    easyEndingStory.Add(\"等我回过神来，我已经回到了地面，就在遇到那位商人的地方，只是商人已经不见。\")\r\n    easyEndingStory.Add(\"我想向那位商人道谢，但是却发现我根本不知道他叫什么，更是连他的样貌和声音也完全忘却了......\")\r\n  :\r\n    STRING_ENTER_TO_START = \"Press ENTER to Start\"\r\n    STRING_ENTER_TO_CONTINUE = \"Press ENTER to Continue\"\r\n    STRING_ENTER_TO_RETURN = \"Press ENTER to Return\"\r\n\r\n    HINT_INITIALIZING = \"Initializing...\"\r\n    HINT_GENERATING = \"Generating Dungeon...\"\r\n    HINT_DRAWING = \"Drawing Dungeon...\"\r\n    HINT_COMPLETED = \"Completed\"\r\n    \r\n    GLYPH_DESCRIPTIONS.Clear()\r\n    GLYPH_DESCRIPTIONS.Add(\"It blocks me.\")\r\n    GLYPH_DESCRIPTIONS.Add(\"Road to somewhere.\")\r\n    GLYPH_DESCRIPTIONS.Add(\"An ordinary room.\")\r\n    GLYPH_DESCRIPTIONS.Add(\"Room of stone. Crushed stones every where.\")\r\n    GLYPH_DESCRIPTIONS.Add(\"Room of water. I don't like the damp air.\")\r\n    GLYPH_DESCRIPTIONS.Add(\"Room of fire. So hot. I should leave here quickly.\")\r\n    GLYPH_DESCRIPTIONS.Add(\"Room of ice. I'm almost freezing.\")\r\n\r\n    TITLE_STORY.Clear()\r\n    TITLE_STORY.Add(\"\\\"I finally managed to escape from that damn mine! I just want to live on! \\\"\")\r\n    TITLE_STORY.Add(\"During a disturbance, I fled the Boiling Mine along with my companions, but serveral snake-like tattoos appeared on my left arm soon after. \")\r\n    TITLE_STORY.Add(\"A passing merchant with a strange accent told me that I had been chosen to be the sacrifice for Nagaraja. \")\r\n    TITLE_STORY.Add(\"\\\"In the Grand Treasury of Acropolis, it should have some Elixir to dispel your curse. \\\"\")\r\n    TITLE_STORY.Add(\"I spent all I have to buy this Talisman of Teleportation, which could take me directly to the treasury, the merchant explained. \")\r\n    TITLE_STORY.Add(\"I had no choice, only touched and activated the talisman. As a result, I did arrive at the inside of the treasury. Who exactly is that merchant? \")\r\n    TITLE_STORY.Add(\"Gold and treasures were piled up everywhere, while I only focused on finding the Elixir. Suddenly, a strong light flashed from the ground. I lost my consciousness...... \")\r\n    TITLE_STORY.Add(\"Game Play: Find the [color=#1abc9c]<>[/color] mark to escape from the dungeon! \")\r\n\r\n    BEGINNING_STORY.Clear()\r\n    var hardBeginningStory = []\r\n    BEGINNING_STORY.Add(hardBeginningStory)\r\n    hardBeginningStory.Add(\"I don't know how long it's been. I woke up. It was very dark all around. Only the torch on the wall gave off a weak light. \")\r\n    hardBeginningStory.Add(\"It seems the trap in the treasury sent me to this scary dungeon. How could I get out? \")\r\n    hardBeginningStory.Add(\"I took the torch on the wall and walked through the road to anywhere unknown. \")\r\n    hardBeginningStory.Add(\"\\\"If I could have something to light up the dungeon, at least it would not be this hard......\\\"\")\r\n    var normalBeginningStory = []\r\n    BEGINNING_STORY.Add(normalBeginningStory)\r\n    normalBeginningStory.Add(\"I don't know how long it's been. I woke up, while I found my pocket was shinning. \")\r\n    normalBeginningStory.Add(\"I took it out. It's a piece of green gem I had obtained before. Its light seems to guide me to somewhere. \")\r\n    normalBeginningStory.Add(\"Maybe it was the trap in the treasury sent me to this dungeon, but at least I hoped this gem could help me escape from here......\")\r\n    var easyBeginningStory = []\r\n    BEGINNING_STORY.Add(easyBeginningStory)\r\n    easyBeginningStory.Add(\"A warm feeling woke me up. It was my pocket, shining a bright light. \")\r\n    easyBeginningStory.Add(\"I took it out. It's the yellow gem found from the box in the treasury. Its light made me feel warm and calm. \")\r\n    easyBeginningStory.Add(\"In the corner of the room, I found a broken staff lying there, with something lost on its crown. \")\r\n    easyBeginningStory.Add(\"I tried to set the gem on the staff. Suddenly, darkness was banished, all the dungeon was lit up. \")\r\n\r\n    ENDING_STORY.Clear()\r\n    var hardEndingStory = []\r\n    ENDING_STORY.Add(hardEndingStory)\r\n    hardEndingStory.Add(\"There was a weird magic circle on the ground. To get out of here, it seems stepping on it is the only choice. \")\r\n    hardEndingStory.Add(\"After a dazzling light flashing past my eyes, I came back to where I had met the merchant, but nowhere to found him. \")\r\n    hardEndingStory.Add(\"I looked at my left arm, snake-like tattoos were still there. Without the Elixir, how could I escaped from Nagaraja......\")\r\n    var normalEndingStory = []\r\n    ENDING_STORY.Add(normalEndingStory)\r\n    normalEndingStory.Add(\"There was a weird magic circle on the ground. It seems it's the gem guided me to come here. \")\r\n    normalEndingStory.Add(\"Although I had some hesitation, I still decided to step on it. \")\r\n    normalEndingStory.Add(\"After a dazzling light flashing past my eyes, I came back to earth, where the merchant stood there, smiling. \")\r\n    normalEndingStory.Add(\"\\\"Did you find the Elixir? \\\"\")\r\n    normalEndingStory.Add(\"When I rushed to him for my questions of the dungeon, he just pointed at my left arm with his finger. \")\r\n    normalEndingStory.Add(\"I looked at my left arm, none tattoo was existing. When I wanted to spoke something to the merchant again, he was nowhere to find......\")\r\n    var easyEndingStory = []\r\n    ENDING_STORY.Add(easyEndingStory)\r\n    easyEndingStory.Add(\"There was a weird magic circle on the ground, flashing a soft light, along with the yellow gem on the staff. \")\r\n    easyEndingStory.Add(\"I stepped on it without any hesitation, and soon I felt a relaxing warmth embracing my left arm. \")\r\n    easyEndingStory.Add(\"When I came back to myself again, I was on the earth, where I had met the merchant, but nowhere to found him. \")\r\n    easyEndingStory.Add(\"I wanted to thank that guy, but I just found I don't know his name. And what's more, I had forgot everything about his appearance, his words, and his voice......\")\r\n\r\n//------------------------------------------------------------------------------------------------------\r\n\r\nvar SHOW_TITLE_STEP_INIT = 0\r\nvar SHOW_TITLE_STEP_SHOW_TEXT = 1\r\nvar showTitleStep = SHOW_TITLE_STEP_INIT\r\nfunc ShowTitleScreen()\r\n  ?showTitleStep = SHOW_TITLE_STEP_INIT\r\n    InitTileScreen()\r\n    showTitleStep = SHOW_TITLE_STEP_SHOW_TEXT\r\n  :?showTitleStep = SHOW_TITLE_STEP_SHOW_TEXT\r\n    ShowTitleText()\r\n    ?ReadTitleCommand() = STATE_FINISHED\r\n      showTitleStep = STATE_FINISHED\r\n  return showTitleStep\r\n\r\nvar TITLE_WIDTH = 75\r\nvar TITLE_HEIGHT = 21\r\nvar TITLE_POS_Y = (screen.h - TITLE_HEIGHT) / 2\r\nvar TITLE_STRING = ascii\r\n                                                                          \r\n              SSSSSS  TTTTTTTT    OOOO    NN     NN  EEEEEEEE             \r\n            SS           TT     OO    OO  NNNN   NN  EE                   \r\n              SSSS       TT     OO    OO  NN  N  NN  EEEEEEE              \r\n                  SS     TT     OO    OO  NN   NNNN  EE                   \r\n            SSSSSS       TT       OOOO    NN     NN  EEEEEEEE             \r\n                                                                          \r\n  DDDDDD    UU    UU  NN     NN    GGGGG   EEEEEEEE    OOOO    NN     NN  \r\n  DD    DD  UU    UU  NNNN   NN  GG        EE        OO    OO  NNNN   NN  \r\n  DD    DD  UU    UU  NN  N  NN  GG  GGGG  EEEEEEE   OO    OO  NN  N  NN  \r\n  DD    DD  UU    UU  NN   NNNN  GG    GG  EE        OO    OO  NN   NNNN  \r\n  DDDDDD      UUUU    NN     NN    GGGG    EEEEEEEE    OOOO    NN     NN  \r\n                                                                          \r\n                                                                          \r\n                                                       Coded By Okamiroy  \r\n                                                                          \r\n                                                                          \r\n                                                                          \r\n                                                                          \r\n                                                                          \r\n                                                                          \r\nasciiend\r\n\r\nvar SELECTION_POS_Y = TITLE_POS_Y + TITLE_HEIGHT - 3\r\nvar COMMAND_COUNT = 4\r\nvar COMMAND_DEFAULT = \"xxxx\"\r\nvar DIRECTION_RIGHT = 0\r\nvar DIRECTION_DOWN = 1\r\nvar DIRECTION_LEFT = 2\r\nvar DIRECTION_UP = 3\r\nvar titleText\r\nvar selectiongText\r\nvar commandLine = COMMAND_DEFAULT\r\nfunc InitTileScreen()\r\n  titleText = ui.AddText()\r\n  titleText.anchor = top_center\r\n  titleText.dock = top_center\r\n  titleText.w = TITLE_WIDTH\r\n  titleText.h = TITLE_HEIGHT\r\n  titleText.y = TITLE_POS_Y\r\n\r\n  selectiongText = ui.AddText()\r\n  selectiongText.anchor = top_center\r\n  selectiongText.dock = top_center\r\n  selectiongText.w = string.Size(STRING_ENTER_TO_START)\r\n  selectiongText.y = TITLE_POS_Y + TITLE_HEIGHT - 3\r\n\r\n  commandLine = COMMAND_DEFAULT\r\n\r\nvar c1 = \"#ff4400\"\r\nvar c2 = \"#8888ff\"\r\nvar t = 0.5\r\n//Changing text color by manual example.\r\nfunc ShowTitleText()\r\n  titleText.text = TITLE_STRING\r\n  selectiongText.text = STRING_ENTER_TO_START\r\n  t = math.sin(time * 0.1) / 2 + 0.5\r\n  selectiongText.color = color.Lerp(c1, c2, t)\r\n\r\n//Normal is up->left->down->right\r\nvar MODE_NORMAL_COMMAND_LINE = \"3210\"\r\n\r\n//Easy is left->left->right->right\r\nvar MODE_EASY_COMMAND_LINE = \"2200\"\r\n\r\n//Read the command to set the difficulty and start the game.\r\n//If you find the secret by reading this code, please just keep it in your own mind.\r\n//These hints will be mentioned in other minigames.\r\nfunc ReadTitleCommand()\r\n  ?key = leftBegin\r\n    commandLine = string.Sub(commandLine, 1) + DIRECTION_LEFT\r\n  :?key = rightBegin\r\n    commandLine = string.Sub(commandLine, 1) + DIRECTION_RIGHT\r\n  :?key = upBegin\r\n    commandLine = string.Sub(commandLine, 1) + DIRECTION_UP\r\n  :?key = downBegin\r\n    commandLine = string.Sub(commandLine, 1) + DIRECTION_DOWN\r\n  :?key = primaryBegin\r\n    ?commandLine = MODE_EASY_COMMAND_LINE\r\n      gameMode = GAME_MODE_EASY\r\n    :?commandLine = MODE_NORMAL_COMMAND_LINE\r\n      gameMode = GAME_MODE_NORMAL\r\n    :\r\n      gameMode = GAME_MODE_HARD\r\n    showTitleStep = STATE_FINISHED\r\n\r\n//------------------------------------------------------------------------------------------------------\r\n\r\nvar INIT_STEP_CANVAS = 0\r\nvar INIT_STEP_EXPLORE_RANGE = 1\r\nvar INIT_STEP_MARKS = 2\r\nvar INIT_STEP_RIGHT_BLACK = 3\r\nvar INIT_STEP_LOG = 4\r\nvar initStep = INIT_STEP_CANVAS\r\n\r\n//I use several components of canvas to draw the whole map, which is larger than the screen.\r\n//However, by my tests, I found the attribute \"visible\" would not work on canvas.\r\n//And canvas cannot be clipped in panel by panel.Clip().\r\n//So the addition order of components will be the stack order.\r\n//To make log panel on the top, I should add it at the last.\r\nfunc InitComponent()\r\n  ?initStep = INIT_STEP_CANVAS\r\n    ?InitCanvas() = STATE_FINISHED\r\n      initStep = INIT_STEP_EXPLORE_RANGE\r\n  :?initStep = INIT_STEP_EXPLORE_RANGE\r\n    InitExploreRange()\r\n    initStep = INIT_STEP_MARKS\r\n  :?initStep = INIT_STEP_MARKS\r\n    InitMarks()\r\n    initStep = INIT_STEP_RIGHT_BLACK\r\n  :?initStep = INIT_STEP_RIGHT_BLACK\r\n    InitRightBlack()\r\n    initStep = INIT_STEP_LOG\r\n  :?initStep = INIT_STEP_LOG\r\n    InitLog()\r\n    initStep = STATE_FINISHED\r\n  return initStep\r\n\r\nvar LOG_PANEL_WIDTH = REAL_WIDTH\r\nvar LOG_PANEL_HEIGHT = 5\r\nvar CANVAS_WIDTH = REAL_WIDTH\r\nvar CANVAS_HEIGHT = REAL_HEIGHT - LOG_PANEL_HEIGHT\r\nvar CANVAS_ROW_COUNT = 2\r\nvar CANVAS_COL_COUNT = 2\r\nvar gameCanvasArray = []\r\nvar initCanvasStep = 0\r\nvar workingCanvasRowIndex = 0\r\nvar workingCanvasColIndex = 0\r\n\r\n//Init canvas of dungeon map\r\nfunc InitCanvas()\r\n  ?initCanvasStep = 0\r\n    for oneCanvasRow : gameCanvasArray\r\n      oneCanvasRow.Clear()\r\n    gameCanvasArray.Clear()\r\n    for i = 0 .. CANVAS_ROW_COUNT - 1\r\n      var oneRow = []\r\n      gameCanvasArray.Add(oneRow)\r\n    initCanvasStep = 1\r\n  :?initCanvasStep = 1\r\n    var gameCanvas = ui.AddCanvas()\r\n    gameCanvas.anchor = top_left\r\n    gameCanvas.dock = top_left\r\n    gameCanvas.x = workingCanvasColIndex * CANVAS_WIDTH\r\n    gameCanvas.y = workingCanvasRowIndex * CANVAS_HEIGHT\r\n    gameCanvas.w = CANVAS_WIDTH\r\n    gameCanvas.h = CANVAS_HEIGHT\r\n    gameCanvasArray[workingCanvasRowIndex].Add(gameCanvas)\r\n\r\n    ?workingCanvasRowIndex = CANVAS_ROW_COUNT - 1 & workingCanvasColIndex = CANVAS_COL_COUNT - 1\r\n      workingCanvasRowIndex = 0\r\n      workingCanvasColIndex = 0\r\n      initCanvasStep = STATE_FINISHED\r\n    :\r\n      ?workingCanvasColIndex = CANVAS_COL_COUNT - 1\r\n        workingCanvasColIndex = 0\r\n        workingCanvasRowIndex++\r\n      :\r\n        workingCanvasColIndex++\r\n\r\n  return initCanvasStep\r\n\r\nvar EXPLORE_RANGE = 6\r\nvar EXPLORE_CENTER_X = EXPLORE_RANGE\r\nvar EXPLORE_CENTER_Y = EXPLORE_RANGE\r\nvar REAL_EXPLORE_WIDTH = (EXPLORE_RANGE * 2 + 1) * 2\r\nvar REAL_EXPLORE_HEIGHT = EXPLORE_RANGE * 2 + 1\r\nvar exploreCanvas\r\n\r\n//Player exploring range is a diamond shape over the map.\r\n//I use blend mode for a shade effect.\r\n//More closer,  more brighter.\r\nfunc InitExploreRange()\r\n  exploreCanvas = ui.AddCanvas()\r\n  exploreCanvas.anchor = top_left\r\n  exploreCanvas.dock = top_left\r\n  exploreCanvas.w = REAL_EXPLORE_WIDTH\r\n  exploreCanvas.h = REAL_EXPLORE_HEIGHT\r\n  exploreCanvas.x = 0 - REAL_EXPLORE_WIDTH\r\n  exploreCanvas.y = 0 - REAL_EXPLORE_HEIGHT\r\n  exploreCanvas.SetFG(#000000)\r\n\r\n  for level = 1 .. EXPLORE_RANGE\r\n    var color\r\n    ?level = 1 | level = 2\r\n      color = #dddddd\r\n    :?level = 3 | level = 4\r\n      color = #aaaaaa\r\n    :?level = 5\r\n      color = #777777\r\n    :\r\n      color = #444444\r\n\r\n    for i = level .. 1\r\n      exploreCanvas.SetFG((EXPLORE_CENTER_X + i) * 2, EXPLORE_CENTER_Y + (level - i), color)\r\n      exploreCanvas.SetFG((EXPLORE_CENTER_X + i) * 2 + 1, EXPLORE_CENTER_Y + (level - i), color)\r\n\r\n      exploreCanvas.SetFG((EXPLORE_CENTER_X - (level - i)) * 2, EXPLORE_CENTER_Y + i, color)\r\n      exploreCanvas.SetFG((EXPLORE_CENTER_X - (level - i)) * 2 + 1, EXPLORE_CENTER_Y + i, color)\r\n\r\n      exploreCanvas.SetFG((EXPLORE_CENTER_X - i) * 2, EXPLORE_CENTER_Y - (level - i), color)\r\n      exploreCanvas.SetFG((EXPLORE_CENTER_X - i) * 2 + 1, EXPLORE_CENTER_Y - (level - i), color)\r\n\r\n      exploreCanvas.SetFG((EXPLORE_CENTER_X + (level - i)) * 2, EXPLORE_CENTER_Y - i, color)\r\n      exploreCanvas.SetFG((EXPLORE_CENTER_X + (level - i)) * 2 + 1, EXPLORE_CENTER_Y - i, color)\r\n\r\n  exploreCanvas.blend = add\r\n\r\nvar TARGET_GLYPH = \"<>\"\r\nvar TARGET_COLOR = #1abc9c\r\nvar targetText\r\nvar targetPosX = screen.w\r\nvar targetPosY = screen.h\r\n\r\nvar PLAYER_GLYPH_ARRAY = []\r\nvar PLAYER_COLOR = #f08080\r\nvar playerText\r\nvar playerPosX = -1\r\nvar playerPosY = -1\r\n\r\nvar GLYPH_ARRAY = []\r\nvar GLYPH_WALL_INDEX = 0\r\nvar GLYPH_ROAD_INDEX = 1\r\nvar ROOM_TYPE_COUNT = 5\r\n\r\n//Player will finally step on target, so add target later than player.\r\nfunc InitMarks()\r\n  targetText = ui.AddText(TARGET_GLYPH)\r\n  targetText.anchor = top_left\r\n  targetText.dock = top_left\r\n  targetText.w = 2\r\n  targetText.h = 1\r\n  targetText.x = targetPosX\r\n  targetText.y = targetPosY\r\n  targetText.color = TARGET_COLOR\r\n  targetText.visible = false\r\n\r\n  PLAYER_GLYPH_ARRAY.Clear()\r\n  PLAYER_GLYPH_ARRAY = [\"EE\", \"MM\", \"33\", \"WW\"]  //right, down, left, up\r\n  playerText = ui.AddText(PLAYER_GLYPH_ARRAY[0])\r\n  playerText.anchor = top_left\r\n  playerText.dock = top_left\r\n  playerText.w = 2\r\n  playerText.h = 1\r\n  playerText.x = playerPosX * 2\r\n  playerText.y = playerPosY\r\n  playerText.color = PLAYER_COLOR\r\n\r\n  GLYPH_ARRAY.Clear()\r\n  GLYPH_ARRAY = [\r\n                  [\"█\", \"█\", GLYPH_DESCRIPTIONS[0]],  //wall\r\n                  [\".\", \".\", GLYPH_DESCRIPTIONS[1]],  //road\r\n                  [\":\", \":\", GLYPH_DESCRIPTIONS[2]],  //common\r\n                  [\"^\", \" \", GLYPH_DESCRIPTIONS[3]],  //stone\r\n                  [\"~\", \" \", GLYPH_DESCRIPTIONS[4]],  //water\r\n                  [\"φ\", \" \", GLYPH_DESCRIPTIONS[5]],  //fire\r\n                  [\"❄\", \" \", GLYPH_DESCRIPTIONS[6]]  //ice\r\n                ]\r\n                       \r\nvar blackPanel\r\n\r\n//Two screen cells combine into one map cell.\r\n//If screen.w is an odd number, I should make the extra one colomn if screen cells black.\r\n//Because the canvas cannot be clipped in panel, I must hide the cells out of the screen.\r\nfunc InitRightBlack()\r\n  ?screen.w - REAL_WIDTH = 1\r\n    blackPanel = ui.AddPanel()\r\n    blackPanel.anchor = top_right\r\n    blackPanel.dock = top_right\r\n    blackPanel.style = 0\r\n    blackPanel.w = 1\r\n    blackPanel.h = screen.h\r\n\r\nvar LOG_PANEL_X = REAL_WIDTH - LOG_PANEL_WIDTH\r\nvar LOG_PANEL_Y = 0\r\nvar LOG_LINE_COUNT = LOG_PANEL_HEIGHT - 2\r\nvar logTextArray = []\r\nvar logPanel\r\nvar logQueue = []\r\nvar logDataArray = []\r\nvar logHistory = []\r\n//Rolling log panel.\r\n//Later log message may push older messages up.\r\nfunc InitLog()\r\n  logPanel = ui.AddPanel()\r\n  logPanel.anchor = bottom_left\r\n  logPanel.dock = bottom_left\r\n  logPanel.w = LOG_PANEL_WIDTH\r\n  logPanel.h = LOG_PANEL_HEIGHT\r\n\r\n  logTextArray.Clear()\r\n  logQueue.Clear()\r\n  logDataArray.Clear()\r\n  logHistory.Clear()\r\n  var logText\r\n  for i = 1 .. LOG_LINE_COUNT\r\n    logText = ui.AddText()\r\n    logText.anchor = top_left\r\n    logText.dock = top_left\r\n    logText.x = 1\r\n    logText.y = 0 + i\r\n    logText.w = logPanel.w - 2\r\n    logDataArray.Add(\"\")\r\n    logPanel.Add(logText)\r\n    logTextArray.Add(logText)\r\n\r\n//I use message queue for log panel.\r\n//All the log message only needs to be write into the queue, and wait to be consumed for drawing.\r\nfunc WriteLog(logContent)\r\n  ?logContent ! null \r\n    ?Type(logContent) = string\r\n      logQueue.Add(logContent)\r\n    :\r\n      ?logContent.Count() > 0\r\n        for i = 0 .. logContent.Count() - 1\r\n          logQueue.Add(logContent[i])\r\n\r\n//Consume one line of log message per frame, and then do rolling update for current messages.\r\nfunc ShowLog(log)\r\n  ?logQueue.Count() > 0\r\n    for i = 0 .. LOG_LINE_COUNT - 1\r\n      ?i = 0\r\n        logHistory.Add(logDataArray[i])\r\n      ?i < LOG_LINE_COUNT - 1\r\n        logDataArray[i] = logDataArray[i + 1]\r\n      :\r\n        logDataArray[i] = logQueue[0]\r\n    logQueue.RemoveAt(0)\r\n  \r\n  for i = 0 .. LOG_LINE_COUNT - 1\r\n    logTextArray[i].text = logDataArray[i]\r\n\r\n//------------------------------------------------------------------------------------------------------\r\n\r\nvar GENERATE_STEP_PATTERN_DATA = 0\r\nvar GENERATE_STEP_PATTERN_DETAIL = 1\r\nvar GENERATE_STEP_DUNGEON_DATA = 2\r\nvar GENERATE_STEP_FAST_DATA = 3\r\nvar generateStep = GENERATE_STEP_PATTERN_DATA\r\nfunc GenerateDungeon()\r\n  ?generateStep = GENERATE_STEP_PATTERN_DATA\r\n    WriteLog(HINT_GENERATING + \"0%\")\r\n    GenreatePatternData()\r\n    generateStep = GENERATE_STEP_PATTERN_DETAIL\r\n    WriteLog(HINT_GENERATING + \"10%\")\r\n  :?generateStep = GENERATE_STEP_PATTERN_DETAIL\r\n    ?GeneratePatternDetail() = STATE_FINISHED\r\n      generateStep = GENERATE_STEP_DUNGEON_DATA\r\n      WriteLog(HINT_GENERATING + \"30%\")\r\n  ?generateStep = GENERATE_STEP_DUNGEON_DATA\r\n    ?GenerateDungeonData() = STATE_FINISHED\r\n      generateStep = GENERATE_STEP_FAST_DATA\r\n      WriteLog(HINT_GENERATING + \"80%\")\r\n  ?generateStep = GENERATE_STEP_FAST_DATA\r\n    ?GenerateFastData() = STATE_FINISHED\r\n      generateStep = STATE_FINISHED\r\n      WriteLog(HINT_GENERATING + HINT_COMPLETED)\r\n  return generateStep\r\n\r\nvar ROOM_ROW_COUNT = 4\r\nvar ROOM_COL_COUNT = 6\r\nvar PATTERN_WIDTH = ROOM_COL_COUNT + (ROOM_COL_COUNT - 1)\r\nvar PATTERN_HEIGHT = ROOM_ROW_COUNT + (ROOM_ROW_COUNT - 1)\r\nvar BASIC_PATTERN_DATA = [[2, 1, 2, 0, 2, 0, 2, 0, 2, 1, 2], \r\n                          [0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0], \r\n                          [2, 1, 2, 0, 2, 0, 2, 0, 2, 1, 2], \r\n                          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], \r\n                          [2, 0, 2, 0, 2, 1, 2, 0, 2, 0, 2], \r\n                          [1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1], \r\n                          [2, 0, 2, 0, 2, 1, 2, 0, 2, 0, 2]]\r\nvar patternData = []\r\n\r\n//1.Genrating pattern data.\r\n//Basic map is an n*n rooms with roads between soom adjoining rooms.\r\n//Then add random roads between other adjoining rooms.\r\n//And in my design, every room must connect to at least one road.\r\nfunc GenreatePatternData()\r\n  patternData = BASIC_PATTERN_DATA\r\n\r\n  var toRandomLinkRoad = []\r\n  for i = 1 .. patternData.Count() - 2\r\n    for j = 1 .. patternData[i].Count() - 2\r\n      ?patternData[i][j - 1] = 0 & patternData[i][j + 1] = 0\r\n        toRandomLinkRoad.Add(i + \"_\" + (j - 1) + \"_\" + i + \"_\" + (j + 1))\r\n        j += 3\r\n      :\r\n        j++\r\n    i++\r\n\r\n  for j = 1 .. patternData[0].Count() - 2\r\n    for i = 1 .. patternData.Count() - 2\r\n      ?patternData[i - 1][j] = \"0\" & patternData[i + 1][j] = 0\r\n        toRandomLinkRoad.Add((i - 1) + \"_\" + j + \"_\" + (i + 1) + \"_\" + j)\r\n        i += 3\r\n      :\r\n        i++\r\n    j++\r\n\r\n  var factor = 2\r\n  for posStr : toRandomLinkRoad\r\n    var posStrArray = string.Split(posStr, \"_\")\r\n    var rowA = int.Parse(posStrArray[0])\r\n    var colA = int.Parse(posStrArray[1])\r\n    var rowB = int.Parse(posStrArray[2])\r\n    var colB = int.Parse(posStrArray[3])\r\n    ?rng % factor < factor / 2\r\n      patternData[rowA][colA] = 1\r\n    :\r\n      patternData[rowB][colB] = 1\r\n    factor *= 2\r\n\r\nvar GAME_WIDTH = REAL_WIDTH / 2 * 2\r\nvar GAME_HEIGHT = (REAL_HEIGHT - LOG_PANEL_HEIGHT) * 2\r\nvar GAP_SIZE = 3\r\nvar MIN_ROOM_WIDTH = 4\r\nvar MAX_ROOM_WIDTH = (GAME_WIDTH - 2 - GAP_SIZE * (ROOM_COL_COUNT - 1)) / ROOM_COL_COUNT\r\nvar MIN_ROOM_HEIGHT = 3\r\nvar MAX_ROOM_HEIGHT = (GAME_HEIGHT - 2 - GAP_SIZE * (ROOM_ROW_COUNT - 1)) / ROOM_ROW_COUNT\r\nvar patternDetailData = []\r\nvar generateDetailStep = 0\r\nvar workingCellIndex = 0\r\n\r\n//2.Genrating pattern detail.\r\n//With pattern data, randomly generate detailed parameters of room size, room position, and other data of rooms and roads.\r\n//Generate one room per frame.\r\n//When it has road on right or bottom side, generate the road parameters of beginning.\r\n//When it has road on left or top side, complete the road parameters of ending.\r\nfunc GeneratePatternDetail()\r\n  ?generateDetailStep = 0\r\n    patternDetailData.Clear()\r\n    for i = 0 .. patternData.Count() - 1\r\n      var oneDetailRow = []\r\n      patternDetailData.Add(oneDetailRow)\r\n      for j = 0 .. patternData[i].Count() - 1\r\n        oneDetailRow.Add(\"0\")\r\n\r\n    generateDetailStep = 1\r\n  :?generateDetailStep = 1\r\n    var rowIndex = workingCellIndex / PATTERN_WIDTH\r\n    var colIndex = workingCellIndex % PATTERN_WIDTH\r\n\r\n    ?patternData[rowIndex][colIndex] ! 2\r\n      ?colIndex = 0\r\n        workingCellIndex += PATTERN_WIDTH\r\n        rowIndex++\r\n      :\r\n        workingCellIndex++\r\n        colIndex++\r\n\r\n    var offsetX = 1 + (MAX_ROOM_WIDTH + GAP_SIZE) * (colIndex / 2)\r\n    var offsetY = 1 + (MAX_ROOM_HEIGHT + GAP_SIZE) * (rowIndex / 2)\r\n    var roomType = rng % (ROOM_TYPE_COUNT * 10) / 10 + 2\r\n    var roomWidth = rng % (MAX_ROOM_WIDTH - MIN_ROOM_WIDTH + 1) + MIN_ROOM_WIDTH\r\n    var roomHeight = rng % (MAX_ROOM_HEIGHT - MIN_ROOM_HEIGHT + 1) + MIN_ROOM_HEIGHT\r\n    var roomX = offsetX + rng % (MAX_ROOM_WIDTH - roomWidth + 1)\r\n    var roomY = offsetY + rng % (MAX_ROOM_HEIGHT - roomHeight + 1) \r\n\r\n    patternDetailData[rowIndex][colIndex] = roomType + \"_\" + roomWidth + \"_\" + roomHeight + \"_\" + roomX + \"_\" + roomY\r\n\r\n    var roadX = 0\r\n    var roadY = 0\r\n    var gapX = 0\r\n    var gapY = 0\r\n    ?colIndex + 1 < PATTERN_WIDTH & patternData[rowIndex][colIndex + 1] = 1\r\n      roadX = roomX + roomWidth\r\n      roadY = roomY + rng % roomHeight\r\n      gapX = offsetX + MAX_ROOM_WIDTH + GAP_SIZE / 2\r\n      gapY = 0\r\n      //第一个参数roadTyppe，0表示水平通路，1表示竖直通路\r\n      patternDetailData[rowIndex][colIndex + 1] = \"0_\" + gapX + \"_\" + gapY + \"_\" + roadX + \"_\" + roadY\r\n    ?rowIndex + 1 < PATTERN_HEIGHT & patternData[rowIndex + 1][colIndex] = 1\r\n      roadX = roomX + rng % roomWidth\r\n      roadY = roomY + roomHeight\r\n      gapX = 0\r\n      gapY = offsetY + MAX_ROOM_HEIGHT + GAP_SIZE / 2\r\n      patternDetailData[rowIndex + 1][colIndex] = \"1_\" + gapX + \"_\" + gapY + \"_\" + roadX + \"_\" + roadY\r\n    ?colIndex - 1 >= 0 & patternData[rowIndex][colIndex - 1] = 1\r\n      roadX = roomX - 1\r\n      roadY = roomY + rng % roomHeight\r\n      patternDetailData[rowIndex][colIndex - 1] += \"_\" + roadX + \"_\" + roadY\r\n    ?rowIndex - 1 >= 0 & patternData[rowIndex - 1][colIndex] = 1\r\n      roadX = roomX + rng % roomWidth\r\n      roadY = roomY - 1\r\n      patternDetailData[rowIndex - 1][colIndex] += \"_\" + roadX + \"_\" + roadY\r\n  \r\n    ?rowIndex = PATTERN_HEIGHT - 1 & colIndex = PATTERN_WIDTH - 1\r\n      workingCellIndex = 0\r\n      generateDetailStep = STATE_FINISHED\r\n    :\r\n      workingCellIndex++\r\n\r\n  return generateDetailStep\r\n\r\nvar GENERATE_TARGET_RATE = 10\r\nvar dungeonMapData = []\r\nvar generateDungeonDataStep = 0\r\nvar hasTarget = false\r\n\r\n//3.Generate dungeon map data.\r\n//With pattern detail data, write everything into the map data array.\r\n//GAP_SIZE is the smallest distance between rooms.\r\n//This ensure all the roads can have a \"Z\" shape.\r\n//For example: \r\n//     GAP   \r\n//     ↓↓↓   \r\n//000000↓0000\r\n//022200↓0000\r\n//0222111←←←←\r\n//02220010220\r\n//→→→→→→11220\r\n//000000↑0220\r\n//000000↑0000\r\nfunc GenerateDungeonData()\r\n  ?generateDungeonDataStep = 0\r\n    dungeonMapData.Clear()\r\n    for i = 0 .. GAME_HEIGHT - 1\r\n      var row = []\r\n      dungeonMapData.Add(row)\r\n      for j = 0 .. GAME_WIDTH - 1\r\n        row.Add(0)\r\n    generateDungeonDataStep = 1\r\n\r\n  ?generateDungeonDataStep = 1\r\n    var rowIndex = workingCellIndex / PATTERN_WIDTH\r\n    var colIndex = workingCellIndex % PATTERN_WIDTH\r\n    ?patternData[rowIndex][colIndex] >= 2\r\n      var roomParams = string.Split(patternDetailData[rowIndex][colIndex], \"_\")\r\n      var roomType = int.Parse(roomParams[0])\r\n      var roomWidth = int.Parse(roomParams[1])\r\n      var roomHeight = int.Parse(roomParams[2])\r\n      var roomX = int.Parse(roomParams[3])\r\n      var roomY = int.Parse(roomParams[4])\r\n      for i = roomY .. roomY + roomHeight - 1\r\n        for j = roomX .. roomX + roomWidth - 1\r\n          dungeonMapData[i][j] = roomType\r\n      \r\n      ?rowIndex = 0 & colIndex = 0\r\n        playerPosX = roomX + 1\r\n        playerPosY = roomY + 1\r\n      \r\n      ?!hasTarget\r\n        ?rowIndex / 2 = ROOM_ROW_COUNT - 1 & colIndex / 2 = ROOM_COL_COUNT - 1\r\n          targetPosX = roomX + roomWidth / 2\r\n          targetPosY = roomY + roomHeight / 2\r\n          hasTarget = true\r\n        :?rowIndex / 2 > ROOM_ROW_COUNT - 2 | colIndex / 2 > ROOM_COL_COUNT - 3\r\n          ?rng % 100 < GENERATE_TARGET_RATE\r\n            targetPosX = roomX + roomWidth / 2\r\n            targetPosY = roomY + roomHeight / 2\r\n            hasTarget = true\r\n\r\n    :?patternData[rowIndex][colIndex] = 1\r\n      var roadParams = string.Split(patternDetailData[rowIndex][colIndex], \"_\")\r\n      var roadType = int.Parse(roadParams[0])\r\n      var gapX = int.Parse(roadParams[1])\r\n      var gapY = int.Parse(roadParams[2])\r\n      var roadStartX = int.Parse(roadParams[3])\r\n      var roadStartY = int.Parse(roadParams[4])\r\n      var roadEndX = int.Parse(roadParams[5])\r\n      var roadEndY = int.Parse(roadParams[6])\r\n      ?roadType = 0\r\n        for i = roadStartX .. gapX\r\n          dungeonMapData[roadStartY][i] = 1\r\n        for i = roadEndX .. gapX \r\n          dungeonMapData[roadEndY][i] = 1\r\n        for i = roadStartY .. roadEndY\r\n          dungeonMapData[i][gapX] = 1\r\n      :\r\n        for i = roadStartY .. gapY\r\n          dungeonMapData[i][roadStartX] = 1\r\n        for i = roadEndY .. gapY\r\n          dungeonMapData[i][roadEndX] = 1\r\n        for i = roadStartX .. roadEndX\r\n          dungeonMapData[gapY][i] = 1\r\n    \r\n    ?rowIndex = PATTERN_HEIGHT - 1 & colIndex = PATTERN_WIDTH - 1\r\n      workingCellIndex = 0\r\n      generateDungeonDataStep = STATE_FINISHED\r\n    :\r\n      workingCellIndex++\r\n  \r\n  return generateDungeonDataStep\r\n\r\nvar PARAM_OFFSET = 1000\r\nvar fastDataOfPosX = []\r\nvar generateFastDataStep = 0\r\n\r\n//4. Generate fast data for drawing.\r\n//Instead of drawing walls, I \"dig the hole\" to draw the map.\r\n//First fill the backgroud with wall, and then draw rooms and roads.\r\n//The fast data contains cell type and x-position. Row index of array is cell y-position.\r\nfunc GenerateFastData()\r\n  ?generateFastDataStep = 0\r\n    fastDataOfPosX.Clear()\r\n    generateFastDataStep = 1\r\n  :?generateFastDataStep = 1\r\n    var fastDataRow = []\r\n    fastDataOfPosX.Add(fastDataRow)\r\n    for i = 0 .. dungeonMapData[workingCellIndex].Count() - 1\r\n      ?dungeonMapData[workingCellIndex][i] ! 0\r\n        fastDataRow.Add(dungeonMapData[workingCellIndex][i] * PARAM_OFFSET + i)\r\n    \r\n    ?workingCellIndex < GAME_HEIGHT - 1\r\n      workingCellIndex++\r\n    :\r\n      workingCellIndex = 0\r\n      generateFastDataStep = STATE_FINISHED\r\n\r\n  return generateFastDataStep\r\n\r\n//------------------------------------------------------------------------------------------------------\r\n\r\nvar drawStep = 0\r\nfunc DrawDungeon()\r\n  ?drawStep = 0\r\n    WriteLog(HINT_DRAWING)\r\n    drawStep = 1\r\n  ?drawStep = 1\r\n    ?DrawRoomAndRoad() = STATE_FINISHED\r\n      drawStep = STATE_FINISHED  \r\n      WriteLog(HINT_DRAWING + HINT_COMPLETED)\r\n  return drawStep\r\n\r\nvar ONE_SCREEN_CELL_WIDTH = CANVAS_WIDTH / 2\r\nvar ONE_SCREEN_CELL_HEIGHT = CANVAS_HEIGHT\r\nvar drawRoomAndRoadStep = 0\r\n\r\n//With fast data, only set the glyphs on each own canvas.\r\n//Set one canvas per frame.\r\nfunc DrawRoomAndRoad()\r\n  var currentCanvas = gameCanvasArray[workingCanvasRowIndex][workingCanvasColIndex]\r\n  currentCanvas.Set(GLYPH_ARRAY[GLYPH_WALL_INDEX][0])\r\n  ?gameMode = GAME_MODE_EASY\r\n    currentCanvas.SetFG(#aaaaaa)\r\n  :  \r\n    currentCanvas.SetFG(#000000)\r\n\r\n  var drawOffsetY = workingCanvasRowIndex * ONE_SCREEN_CELL_HEIGHT\r\n  var drawOffsetX = workingCanvasColIndex * ONE_SCREEN_CELL_WIDTH\r\n  var groundType = 0\r\n  var cellPosX = 0\r\n  var glyphL = \"\"\r\n  var glyphR = \"\"\r\n  for i = 0 .. ONE_SCREEN_CELL_HEIGHT - 1\r\n    ?fastDataOfPosX[drawOffsetY + i].Count() > 0\r\n      for j = 0 .. fastDataOfPosX[drawOffsetY + i].Count() - 1\r\n        groundType = fastDataOfPosX[drawOffsetY + i][j] / PARAM_OFFSET\r\n        cellPosX = fastDataOfPosX[drawOffsetY + i][j] % PARAM_OFFSET\r\n        ?cellPosX < drawOffsetX\r\n          continue\r\n        :?cellPosX > drawOffsetX + ONE_SCREEN_CELL_WIDTH - 1\r\n          break\r\n        :\r\n          ?i % 2 = 0\r\n            glyphL = GLYPH_ARRAY[groundType][0]\r\n            glyphR = GLYPH_ARRAY[groundType][1]\r\n          :\r\n            glyphL = GLYPH_ARRAY[groundType][1]\r\n            glyphR = GLYPH_ARRAY[groundType][0]\r\n          currentCanvas.Set((cellPosX - drawOffsetX) * 2, i, glyphL)\r\n          currentCanvas.Set((cellPosX - drawOffsetX) * 2 + 1, i, glyphR)\r\n  \r\n  ?workingCanvasRowIndex = CANVAS_ROW_COUNT - 1 & workingCanvasColIndex = CANVAS_COL_COUNT - 1\r\n    workingCanvasRowIndex = 0\r\n    workingCanvasColIndex = 0\r\n    drawRoomAndRoadStep = STATE_FINISHED\r\n  :\r\n    ?workingCanvasColIndex = CANVAS_COL_COUNT - 1\r\n      workingCanvasColIndex = 0\r\n      workingCanvasRowIndex++\r\n    :\r\n      workingCanvasColIndex++\r\n\r\n  return drawRoomAndRoadStep\r\n\r\n//------------------------------------------------------------------------------------------------------\r\n\r\nvar POPUP_PANEL_WIDTH = 40\r\nvar POPUP_PANEL_HEIGHT = 12\r\nvar popupPanel\r\nvar popupStep = 0\r\nvar scaleLevel = 0\r\nvar MAX_SCALE_LEVEL = 5\r\nfunc popupMessagePanel(message, hint)\r\n  ?popupStep = 0\r\n    popupPanel = ui.AddPanel()\r\n    popupPanel.w = 1\r\n    popupPanel.h = 1\r\n    popupPanel.style = 2\r\n    popupPanel.clip = true\r\n\r\n    var messageText = ui.AddText(message)\r\n    messageText.anchor = top_center\r\n    messageText.dock = top_center\r\n    messageText.w = POPUP_PANEL_WIDTH - 6\r\n    messageText.y = 2\r\n    popupPanel.Add(messageText)\r\n\r\n    var hintText = ui.AddText(hint)\r\n    hintText.anchor = top_center\r\n    hintText.dock = top_center\r\n    hintText.w = string.Size(hint)\r\n    hintText.y = POPUP_PANEL_HEIGHT - 3\r\n    popupPanel.Add(hintText)\r\n\r\n    popupStep = 1\r\n  :?popupStep = 1\r\n    scaleLevel++\r\n      popupPanel.w = POPUP_PANEL_WIDTH / MAX_SCALE_LEVEL * scaleLevel\r\n      popupPanel.h = POPUP_PANEL_HEIGHT / MAX_SCALE_LEVEL * scaleLevel\r\n    ?scaleLevel = MAX_SCALE_LEVEL\r\n      popupPanel.w = POPUP_PANEL_WIDTH\r\n      popupPanel.h = POPUP_PANEL_HEIGHT\r\n      scaleLevel = 0\r\n      popupStep = 2\r\n  :?popupStep = 2\r\n    ?key = primaryBegin\r\n      popupStep = 3\r\n  :?popupStep = 3\r\n    scaleLevel++\r\n    popupPanel.w = POPUP_PANEL_WIDTH - POPUP_PANEL_WIDTH / MAX_SCALE_LEVEL * scaleLevel\r\n    popupPanel.h = POPUP_PANEL_HEIGHT - POPUP_PANEL_HEIGHT / MAX_SCALE_LEVEL * scaleLevel\r\n    ?scaleLevel = MAX_SCALE_LEVEL\r\n      popupPanel.Recycle()\r\n      scaleLevel = 0\r\n      popupStep = 0\r\n      return STATE_FINISHED\r\n\r\n  return popupStep\r\n\r\nvar canvasOffsetX = 0\r\nvar canvasOffsetY = 0\r\nvar currentDirection = 0\r\nvar currentGround = 0\r\n\r\n//Draw other marks on map.\r\n//Move player, target and canvas.\r\nfunc DrawMarks()\r\n  var realTargetPosX = (targetPosX + canvasOffsetX) * 2\r\n  var realTargetPosY = targetPosY + canvasOffsetY\r\n  targetText.x = realTargetPosX\r\n  targetText.y = realTargetPosY\r\n  ?gameMode = GAME_MODE_EASY | gameMode = GAME_MODE_NORMAL\r\n    targetText.visible = true\r\n  :?math.Abs(targetPosX - playerPosX) + math.Abs(targetPosY - playerPosY) <= EXPLORE_RANGE\r\n    targetText.visible = true\r\n  :\r\n    targetText.visible = false\r\n  \r\n  var realPlayerPosX = (playerPosX + canvasOffsetX) * 2\r\n  var realPlayerPosY = playerPosY + canvasOffsetY\r\n  playerText.text = PLAYER_GLYPH_ARRAY[currentDirection]\r\n  playerText.x = realPlayerPosX\r\n  playerText.y = realPlayerPosY\r\n\r\n  exploreCanvas.x = (playerPosX + canvasOffsetX - EXPLORE_CENTER_X) * 2\r\n  exploreCanvas.y = playerPosY + canvasOffsetY - EXPLORE_CENTER_Y\r\n\r\nvar LEFT_MOVE_CAMERA_BORDER = ONE_SCREEN_CELL_WIDTH / 2\r\nvar RIGHT_MOVE_CAMERA_BORDER = GAME_WIDTH - 2 - ONE_SCREEN_CELL_WIDTH / 2\r\nvar UP_MOVE_CAMERA_BORDER = ONE_SCREEN_CELL_HEIGHT / 2\r\nvar DOWN_MOVE_CAMERA_BORDER = GAME_HEIGHT - 2 - ONE_SCREEN_CELL_HEIGHT / 2\r\n\r\n//When player moves in the center area of the map, move the canvas instead of move player on screen.\r\nfunc MovePlayer(direction)\r\n  currentDirection = direction\r\n  var shouldMoveCanvas = false\r\n  ?direction = DIRECTION_RIGHT\r\n    ?playerPosX + 1 <= GAME_WIDTH - 1 & dungeonMapData[playerPosY][playerPosX + 1] ! 0\r\n      playerPosX++\r\n      ?playerPosX >= LEFT_MOVE_CAMERA_BORDER & playerPosX <= RIGHT_MOVE_CAMERA_BORDER + 1\r\n        canvasOffsetX -= 1\r\n        shouldMoveCanvas = true\r\n  :?direction = DIRECTION_DOWN\r\n    ?playerPosY + 1 <= GAME_HEIGHT - 1 & dungeonMapData[playerPosY + 1][playerPosX] ! 0\r\n      playerPosY++\r\n      ?playerPosY >= UP_MOVE_CAMERA_BORDER & playerPosY <= DOWN_MOVE_CAMERA_BORDER + 1\r\n        canvasOffsetY -= 1\r\n        shouldMoveCanvas = true\r\n  :?direction = DIRECTION_LEFT\r\n    ?playerPosX - 1 > 0 & dungeonMapData[playerPosY][playerPosX - 1] ! 0\r\n      playerPosX--\r\n      ?playerPosX >= LEFT_MOVE_CAMERA_BORDER - 1 & playerPosX <= RIGHT_MOVE_CAMERA_BORDER\r\n        canvasOffsetX += 1\r\n        shouldMoveCanvas = true\r\n  :\r\n    ?playerPosY - 1 > 0 & dungeonMapData[playerPosY - 1][playerPosX] ! 0\r\n      playerPosY--\r\n      ?playerPosY >= UP_MOVE_CAMERA_BORDER - 1 & playerPosY <= DOWN_MOVE_CAMERA_BORDER\r\n        canvasOffsetY += 1\r\n        shouldMoveCanvas = true\r\n\r\n  ?shouldMoveCanvas\r\n    for i = 0 .. CANVAS_ROW_COUNT - 1\r\n      for j = 0 .. CANVAS_COL_COUNT - 1\r\n        gameCanvasArray[i][j].x = canvasOffsetX * 2 + j * CANVAS_WIDTH\r\n        gameCanvasArray[i][j].y = canvasOffsetY + i * CANVAS_HEIGHT\r\n  \r\n  var groundType = dungeonMapData[playerPosY][playerPosX]\r\n  ?groundType >= 2 & groundType ! currentGround\r\n    WriteLog(GLYPH_ARRAY[groundType][2])\r\n  currentGround = groundType\r\n\r\nfunc CheckFinished()\r\n  ?playerPosX = targetPosX & playerPosY = targetPosY\r\n    return true\r\n  :\r\n    return false\r\n\r\nvar showTitleStoryStep = 0\r\nfunc ShowTitleStory()\r\n  ?popupMessagePanel(TITLE_STORY[showTitleStoryStep], STRING_ENTER_TO_CONTINUE) = STATE_FINISHED\r\n    showTitleStoryStep++\r\n  ?showTitleStoryStep = TITLE_STORY.Count()\r\n    showTitleStoryStep = STATE_FINISHED\r\n  return showTitleStoryStep    \r\n\r\nvar showBeginningStoryStep = 0\r\nfunc ShowBeginningStory()\r\n  ?popupMessagePanel(BEGINNING_STORY[gameMode][showBeginningStoryStep], STRING_ENTER_TO_CONTINUE) = STATE_FINISHED\r\n    showBeginningStoryStep++\r\n  ?showBeginningStoryStep = BEGINNING_STORY[gameMode].Count()\r\n    showBeginningStoryStep = STATE_FINISHED\r\n  return showBeginningStoryStep \r\n\r\nvar showEndingStoryStep = 0\r\nfunc ShowEndingStory()\r\n  var hintString = STRING_ENTER_TO_CONTINUE\r\n  ?showEndingStoryStep = ENDING_STORY[gameMode].Count() - 1\r\n    hintString = STRING_ENTER_TO_RETURN\r\n  ?popupMessagePanel(ENDING_STORY[gameMode][showEndingStoryStep], hintString) = STATE_FINISHED\r\n    showEndingStoryStep++\r\n  ?showEndingStoryStep = ENDING_STORY[gameMode].Count()\r\n    showEndingStoryStep = STATE_FINISHED\r\n  return showEndingStoryStep \r\n\r\nfunc ResetAllStates()\r\n  showTitleStep = SHOW_TITLE_STEP_INIT\r\n  initStep = INIT_STEP_CANVAS\r\n  initCanvasStep = 0\r\n  workingCanvasRowIndex = 0\r\n  workingCanvasColIndex = 0\r\n  generateStep = GENERATE_STEP_PATTERN_DATA\r\n  generateDetailStep = 0\r\n  workingCellIndex = 0\r\n  generateDungeonDataStep = 0\r\n  generateFastDataStep = 0\r\n  drawStep = 0\r\n  drawRoomAndRoadStep = 0\r\n  popupStep = 0\r\n  showTitleStoryStep = 0\r\n  showBeginningStoryStep = 0\r\n  showEndingStoryStep = 0\r\n\r\n  targetPosX = screen.w\r\n  targetPosY = screen.h\r\n  playerPosX = -1\r\n  playerPosY = -1\r\n  hasTarget = false\r\n  canvasOffsetX = 0\r\n  canvasOffsetY = 0\r\n  currentDirection = 0\r\n  currentGround = 0\r\n\r\n?loc = waterfall\r\n  ?gameState = GAME_STATE_INIT_LANGUAGE\r\n    InitLanguageSettings()\r\n    gameState = GAME_STATE_SHOW_GAME_TITLE\r\n  :?gameState = GAME_STATE_SHOW_GAME_TITLE\r\n    ?ShowTitleScreen() = STATE_FINISHED\r\n      gameState = GAME_STATE_CLEAR_TITLE_UI\r\n  :?gameState = GAME_STATE_CLEAR_TITLE_UI\r\n    ui.Clear()\r\n    gameState = GAME_STATE_SHOW_TITLE_STORY\r\n  :?gameState = GAME_STATE_SHOW_TITLE_STORY\r\n    ?ShowTitleStory() = STATE_FINISHED\r\n      gameState = GAME_STATE_RESET_ALL_STATE\r\n  :?gameState = GAME_STATE_RESET_ALL_STATE\r\n    ResetAllStates()\r\n    gameState = GAME_STATE_INIT_COMPONENT\r\n  :?gameState = GAME_STATE_INIT_COMPONENT\r\n    ?InitComponent() = STATE_FINISHED\r\n      gameState = GAME_STATE_GENERATE_DUNGEON\r\n  :?gameState = GAME_STATE_GENERATE_DUNGEON\r\n    ?GenerateDungeon() = STATE_FINISHED\r\n      gameState = GAME_STATE_DRAW_DUNGEON\r\n  :?gameState = GAME_STATE_DRAW_DUNGEON\r\n    ?DrawDungeon() = STATE_FINISHED\r\n      gameState = GAME_STATE_SHOW_BEGINNING_STORY\r\n  :?gameState = GAME_STATE_SHOW_BEGINNING_STORY\r\n    DrawMarks()\r\n    ?ShowBeginningStory() = STATE_FINISHED\r\n      gameState = GAME_STATE_PLAYING\r\n  :?gameState = GAME_STATE_PLAYING\r\n    ?key = leftBegin\r\n      MovePlayer(DIRECTION_LEFT)\r\n    :?key = rightBegin\r\n      MovePlayer(DIRECTION_RIGHT)\r\n    :?key = upBegin\r\n      MovePlayer(DIRECTION_UP)\r\n    :?key = downBegin\r\n      MovePlayer(DIRECTION_DOWN)\r\n    DrawMarks()\r\n    ?CheckFinished()\r\n      gameState = GAME_STATE_SHOW_ENDING_STORY\r\n  :?gameState = GAME_STATE_SHOW_ENDING_STORY\r\n    ?ShowEndingStory() = STATE_FINISHED\r\n      gameState = GAME_STATE_CLEAR_GAME_UI\r\n  :?gameState = GAME_STATE_CLEAR_GAME_UI\r\n    ui.Clear()\r\n    gameState = GAME_STATE_SHOW_GAME_TITLE\r\n  \r\n  ?gameState > GAME_STATE_INIT_COMPONENT\r\n    ShowLog(log)\r\n  "
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/DigitsPuzzle.txt" - Parse error: Failed to parse completely. Remaining: "\\DigitsPuzzle\\DigitsPuzzleMain"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/StoneBoxman.txt" - Parse error: Failed to parse completely. Remaining: "\\StoneBoxman\\StoneBoxmanMain"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/BurgerRush.txt" - Parse error: Failed to parse completely. Remaining: "= #ffffff\r\nvar timerColourHigh = #00ff00\r\nvar timerColourMed = #ffff00\r\nvar timerColourLow = #ff0000\r\n\r\n// Set colours for ingredients\r\nvar ingred0Color = #9f9f9f\r\nvar ingred1Color = #f5d562\r\nvar ingred2Color = #8f4a00\r\nvar ingred3Color = #ffca00\r\nvar ingred4Color = #ff0000\r\nvar ingred5Color = #00ff00\r\nvar ingred6Color = #f5d562\r\nvar heldItemColor\r\n\r\n// function to spawn a random ingredient\r\nvar rngMin = 1\r\nvar rngMax = 6\r\nvar rngN\r\nfunc NewIngredient()\r\n plateStateArray = [plate1State, plate2State, plate3State]\r\n plateStateArray.Sort()\r\n rngMin = plateStateArray[0]+1\r\n rngMax = plateStateArray[2]+1\r\n rngN = rngMin + rng % (rngMax - rngMin + 1)\r\n handState = rngN\r\n \r\n// ASCII art\r\n\r\nvar plateSprite\r\nplateSprite = ascii\r\n#\r\n#\r\n#\r\n#\r\n##________\r\n.´ ------ `.\r\n: `------´ :\r\n#`--------´\r\nasciiend\r\n\r\nvar arrowSprite\r\narrowSprite = ascii\r\n __|\\\r\n|    \\\r\n|__  /\r\n   |/\r\nasciiend\r\n\r\nvar bottomBunSprite\r\nbottomBunSprite = ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#__________\r\n'.________.'\r\nasciiend\r\n\r\nvar pattySprite\r\npattySprite = ascii\r\n#\r\n#\r\n#\r\n#\r\n#\r\n#≡≡≡≡≡≡≡≡≡≡\r\n#\r\nasciiend\r\n\r\nvar cheeseSprite\r\ncheeseSprite = ascii\r\n#\r\n#\r\n#\r\n#\r\n#╤════╤═══╤\r\n#γ####τ###!\r\n#\r\nasciiend\r\n\r\nvar tomatoSprite\r\ntomatoSprite = ascii\r\n#\r\n#\r\n#\r\n#==========\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar lettuceSprite\r\nlettuceSprite = ascii\r\n#\r\n#\r\n#εΩσραΩρεΩσ\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar topBunSprite\r\ntopBunSprite = ascii\r\n###.·::·. \r\n#/________\\\r\n#\r\n#\r\n#\r\n#\r\n#\r\nasciiend\r\n\r\nvar inboundHelper\r\ninboundHelper = ascii\r\n#\r\n#\r\n#######o/\r\n##___#/|\r\n##|X|#/#\\\r\n\\‾‾‾‾‾‾‾‾‾‾‾‾/\r\n#\\__________/\r\nasciiend\r\n\r\nvar readyHelper\r\nreadyHelper = ascii\r\n#\r\n#\r\n#######o/\r\n##\\###/|\r\n##|X|#/#\\\r\n\\‾‾‾‾‾‾‾‾‾‾‾‾/\r\n#\\__________/\r\nasciiend\r\n\r\n\r\nvar outboundHelper\r\noutboundHelper = ascii\r\n#\r\n#\r\n#######o\r\n##___#<|\\\r\n##| |#/ \\\r\n\\‾‾‾‾‾‾‾‾‾‾‾‾/\r\n#\\__________/\r\nasciiend\r\n\r\n// ingredient icons held by helper\r\n\r\nvar heldItem0Sprite\r\nheldItem0Sprite = ascii\r\n#\r\n#\r\n#\r\n##___\r\n##| |\r\nasciiend\r\n\r\nvar heldItem1Sprite\r\nheldItem1Sprite = ascii\r\n#########_______\r\n########'._____.'\r\n#\r\n#\r\n###1\r\nasciiend\r\n\r\nvar heldItem2Sprite\r\nheldItem2Sprite = ascii\r\n#########____\r\n########(~~~~)\r\n#########‾‾‾‾\r\n#\r\n###2\r\nasciiend\r\n\r\nvar heldItem3Sprite\r\nheldItem3Sprite = ascii\r\n#########____\r\n########/___/\r\n#\r\n#\r\n###3\r\nasciiend\r\n\r\nvar heldItem4Sprite\r\nheldItem4Sprite = ascii\r\n########.-v-.\r\n########(___)\r\n#\r\n#\r\n###4\r\nasciiend\r\n\r\nvar heldItem5Sprite\r\nheldItem5Sprite = ascii\r\n########':,:'\r\n########(/-\\)\r\n#\r\n#\r\n###5\r\nasciiend\r\n\r\nvar heldItem6Sprite\r\nheldItem6Sprite = ascii\r\n########## .---. \r\n#########´'-----'`\r\n#\r\n#\r\n###6\r\nasciiend\r\n\r\n\r\n// DRAWING TO THE SCREEN\r\n\r\n// Initial splash screen\r\n?gameState = 0\r\n >`10,10,#00ff00,ascii\r\nBURGER RUSH [version 1.2]\r\nby Fyda\r\nasciiend\r\n >`55,15,#rainff,ascii\r\n- press Enter to begin -\r\nasciiend\r\n\r\n// Score display during game\r\n?gameState = 1\r\n draw.Box(2, 5, 20, 5, #cacaca, 2)\r\n >`4,6,#ffca00,SCORE:      @playerScore@\r\n >`4,8,@timerColour@,TIME LEFT: @gameTimer@\r\n\r\n// Controls helper text during game\r\nvar controlsBoxY = screen.h - 6\r\n?gameState < 2\r\n draw.Box(2, controlsBoxY, 30, 5, #cacaca, 2)\r\n >`4,@controlsBoxY@,#ffffff,ascii\r\n\r\n ↑/↓  Select Plate\r\n  Z   Place Ingredient\r\n  C   Send Back Ingredient\r\nasciiend\r\n\r\n// Game over screen\r\n?gameState = 2\r\n draw.Box(2, 5, 20, 5, #cacaca, 2)\r\n >`7,6,#ff0000,GAME OVER\r\n >`4,8,#ffca00,FINAL SCORE:  @playerScore@\r\n >`44,15,#rainff,ascii\r\n- press Enter to restart -\r\nasciiend\r\n\r\n?gameState > 0\r\n >c@plate1X@,@plate1Y@,#cacaca,@plateSprite@\r\n >c@plate2X@,@plate2Y@,#cacaca,@plateSprite@\r\n >c@plate3X@,@plate3Y@,#cacaca,@plateSprite@\r\n\r\n?gameState = 1\r\n >c@arrowX@,@arrowY@,#rainFF,@arrowSprite@\r\n\r\n// Draw current state of each plate:\r\n\r\n// PLATE 1\r\n?gameState > 0\r\n ?plate1State = 1\r\n  >c@plate1X@,@plate1Y@,@ingred1Color@,@bottomBunSprite@\r\n ?plate1State = 2\r\n  >c@plate1X@,@plate1Y@,#f5d562,@bottomBunSprite@\r\n  >c@plate1X@,@plate1Y@,#8f4a00,@pattySprite@\r\n ?plate1State = 3\r\n  >c@plate1X@,@plate1Y@,#f5d562,@bottomBunSprite@\r\n  >c@plate1X@,@plate1Y@,#8f4a00,@pattySprite@\r\n  >c@plate1X@,@plate1Y@,#ffca00,@cheeseSprite@\r\n ?plate1State = 4\r\n  >c@plate1X@,@plate1Y@,#f5d562,@bottomBunSprite@\r\n  >c@plate1X@,@plate1Y@,#8f4a00,@pattySprite@\r\n  >c@plate1X@,@plate1Y@,#ffca00,@cheeseSprite@\r\n  >c@plate1X@,@plate1Y@,#ff0000,@tomatoSprite@\r\n ?plate1State = 5\r\n  >c@plate1X@,@plate1Y@,#f5d562,@bottomBunSprite@\r\n  >c@plate1X@,@plate1Y@,#8f4a00,@pattySprite@\r\n  >c@plate1X@,@plate1Y@,#ffca00,@cheeseSprite@\r\n  >c@plate1X@,@plate1Y@,#ff0000,@tomatoSprite@\r\n  >c@plate1X@,@plate1Y@,#00ff00,@lettuceSprite@\r\n ?plate1State = 6\r\n  burger1AnimX++\r\n  >c@burger1AnimX@,@plate1Y@,#f5d562,@bottomBunSprite@\r\n  >c@burger1AnimX@,@plate1Y@,#8f4a00,@pattySprite@\r\n  >c@burger1AnimX@,@plate1Y@,#ffca00,@cheeseSprite@\r\n  >c@burger1AnimX@,@plate1Y@,#ff0000,@tomatoSprite@\r\n  >c@burger1AnimX@,@plate1Y@,#00ff00,@lettuceSprite@\r\n  >c@burger1AnimX@,@plate1Y@,#f5d562,@topBunSprite@\r\n\r\n?gameState > 0\r\n ?plate2State = 1\r\n  >c@plate2X@,@plate2Y@,#f5d562,@bottomBunSprite@\r\n ?plate2State = 2\r\n  >c@plate2X@,@plate2Y@,#f5d562,@bottomBunSprite@\r\n  >c@plate2X@,@plate2Y@,#8f4a00,@pattySprite@\r\n ?plate2State = 3\r\n  >c@plate2X@,@plate2Y@,#f5d562,@bottomBunSprite@\r\n  >c@plate2X@,@plate2Y@,#8f4a00,@pattySprite@\r\n  >c@plate2X@,@plate2Y@,#ffca00,@cheeseSprite@\r\n ?plate2State = 4\r\n  >c@plate2X@,@plate2Y@,#f5d562,@bottomBunSprite@\r\n  >c@plate2X@,@plate2Y@,#8f4a00,@pattySprite@\r\n  >c@plate2X@,@plate2Y@,#ffca00,@cheeseSprite@\r\n  >c@plate2X@,@plate2Y@,#ff0000,@tomatoSprite@\r\n ?plate2State = 5\r\n  >c@plate2X@,@plate2Y@,#f5d562,@bottomBunSprite@\r\n  >c@plate2X@,@plate2Y@,#8f4a00,@pattySprite@\r\n  >c@plate2X@,@plate2Y@,#ffca00,@cheeseSprite@\r\n  >c@plate2X@,@plate2Y@,#ff0000,@tomatoSprite@\r\n  >c@plate2X@,@plate2Y@,#00ff00,@lettuceSprite@\r\n ?plate2State = 6\r\n  burger2AnimX++\r\n  >c@burger2AnimX@,@plate2Y@,#f5d562,@bottomBunSprite@\r\n  >c@burger2AnimX@,@plate2Y@,#8f4a00,@pattySprite@\r\n  >c@burger2AnimX@,@plate2Y@,#ffca00,@cheeseSprite@\r\n  >c@burger2AnimX@,@plate2Y@,#ff0000,@tomatoSprite@\r\n  >c@burger2AnimX@,@plate2Y@,#00ff00,@lettuceSprite@\r\n  >c@burger2AnimX@,@plate2Y@,#f5d562,@topBunSprite@\r\n \r\n // PLATE 3\r\n?gameState > 0\r\n ?plate3State = 1\r\n  >c@plate3X@,@plate3Y@,#f5d562,@bottomBunSprite@\r\n ?plate3State = 2\r\n  >c@plate3X@,@plate3Y@,#f5d562,@bottomBunSprite@\r\n  >c@plate3X@,@plate3Y@,#8f4a00,@pattySprite@\r\n ?plate3State = 3\r\n  >c@plate3X@,@plate3Y@,#f5d562,@bottomBunSprite@\r\n  >c@plate3X@,@plate3Y@,#8f4a00,@pattySprite@\r\n  >c@plate3X@,@plate3Y@,#ffca00,@cheeseSprite@\r\n ?plate3State = 4\r\n  >c@plate3X@,@plate3Y@,#f5d562,@bottomBunSprite@\r\n  >c@plate3X@,@plate3Y@,#8f4a00,@pattySprite@\r\n  >c@plate3X@,@plate3Y@,#ffca00,@cheeseSprite@\r\n  >c@plate3X@,@plate3Y@,#ff0000,@tomatoSprite@\r\n ?plate3State = 5\r\n  >c@plate3X@,@plate3Y@,#f5d562,@bottomBunSprite@\r\n  >c@plate3X@,@plate3Y@,#8f4a00,@pattySprite@\r\n  >c@plate3X@,@plate3Y@,#ffca00,@cheeseSprite@\r\n  >c@plate3X@,@plate3Y@,#ff0000,@tomatoSprite@\r\n  >c@plate3X@,@plate3Y@,#00ff00,@lettuceSprite@\r\n ?plate3State = 6\r\n  burger3AnimX++\r\n  >c@burger3AnimX@,@plate3Y@,#f5d562,@bottomBunSprite@\r\n  >c@burger3AnimX@,@plate3Y@,#8f4a00,@pattySprite@\r\n  >c@burger3AnimX@,@plate3Y@,#ffca00,@cheeseSprite@\r\n  >c@burger3AnimX@,@plate3Y@,#ff0000,@tomatoSprite@\r\n  >c@burger3AnimX@,@plate3Y@,#00ff00,@lettuceSprite@\r\n  >c@burger3AnimX@,@plate3Y@,#f5d562,@topBunSprite@\r\n\r\n// Reset the burger animation position once it's off-screen.\r\n// Also reset the plate state.\r\n?burger1AnimX > 91\r\n plate1State = 0\r\n burger1AnimX = 0\r\n?burger2AnimX > 91\r\n plate2State = 0\r\n burger2AnimX = 0\r\n?burger3AnimX > 91\r\n plate3State = 0\r\n burger3AnimX = 0\r\n\r\n// Set the helper's currently held item sprite\r\n?handState = 0\r\n helperHeldItem = heldItem0Sprite\r\n heldItemColor = ingred0Color\r\n?handState = 1\r\n helperHeldItem = heldItem1Sprite\r\n heldItemColor = ingred1Color\r\n?handState = 2\r\n helperHeldItem = heldItem2Sprite\r\n heldItemColor = ingred2Color\r\n?handState = 3\r\n helperHeldItem = heldItem3Sprite\r\n heldItemColor = ingred3Color\r\n?handState = 4\r\n helperHeldItem = heldItem4Sprite\r\n heldItemColor = ingred4Color\r\n?handState = 5\r\n helperHeldItem = heldItem5Sprite\r\n heldItemColor = ingred5Color\r\n?handState = 6\r\n helperHeldItem = heldItem6Sprite\r\n heldItemColor = ingred6Color\r\n\r\n// Animate helper arriving; switch to ready state when arrived\r\n?helperState = 0\r\n ?helperAnimX < 23\r\n  helperAnimX++\r\n  >`@helperAnimX@,11,#ffffff,@inboundHelper@\r\n  >`@helperAnimX@,11,@heldItemColor@,@helperHeldItem@\r\n :\r\n  helperState = 1\r\n\r\n// Animate helper standing by\r\n?helperState = 1\r\n >`@helperAnimX@,11,#ffffff,@readyHelper@\r\n >`@helperAnimX@,11,@heldItemColor@,@helperHeldItem@\r\n\r\n// Animate helper leaving, clearing the hand; when off screen, switch back to arriving state\r\n?helperState = 2\r\n ?helperAnimX > -14\r\n  helperAnimX--\r\n  >`@helperAnimX@,11,#ffffff,@outboundHelper@\r\n :\r\n  ?gameState = 1\r\n   NewIngredient()\r\n   helperState = 0\r\n\r\n// BIND KEYS TO ACTIONS\r\n\r\n// Move the arrow when the player presses Up or Down (wraps around)\r\n?gameState = 1\r\n ?key = downBegin\r\n  ?arrowPos < 3\r\n   arrowPos++\r\n  :\r\n   arrowPos = 1\r\n ?key = upBegin\r\n  ?arrowPos > 1\r\n   arrowPos--\r\n  :\r\n   arrowPos = 3\r\n\r\n// When Z is pressed, check if ingredient is the next correct one. If so,\r\n// update plate and clear the hand. Otherwise, show an error.\r\n?gameState = 1\r\n ?key = bumpLBegin\r\n  ?helperState = 1\r\n   ?arrowPos = 1\r\n    ?handState = plate1State+1\r\n     plate1State++\r\n     play treasure_item_pop\r\n     handState = 0\r\n     helperState = 2\r\n    :\r\n     play error\r\n    ?plate1State = 6\r\n     playerScore++\r\n     gameTimer = gameTimer + timerReward\r\n     play treasure_item_show\r\n     burger1AnimX = plate1X\r\n   ?arrowPos = 2\r\n    ?handState = plate2State+1\r\n     plate2State++\r\n     play treasure_item_pop\r\n     handState = 0\r\n     helperState = 2\r\n    :\r\n     play error\r\n    ?plate2State = 6\r\n     playerScore++\r\n     gameTimer = gameTimer + timerReward\r\n     play treasure_item_show\r\n     burger2AnimX = plate2X\r\n   ?arrowPos = 3\r\n    ?handState = plate3State+1\r\n     plate3State++\r\n     play treasure_item_pop\r\n     handState = 0\r\n     helperState = 2\r\n    :\r\n     play error\r\n    ?plate3State = 6\r\n     playerScore++\r\n     gameTimer = gameTimer + timerReward\r\n     play treasure_item_show\r\n     burger3AnimX = plate3X\r\n\r\n// When C is pressed, send helper away to replace ingredient\r\n?gameState = 1\r\n ?key = bumpRBegin\r\n  helperState = 2\r\n\r\n// When Enter is pressed, start the game\r\n?key = primaryBegin & gameState ! 1\r\n gameTimer = gameTimerTotal\r\n gameState = 1\r\n handState = 1\r\n plate1State = 0\r\n plate2State = 0\r\n plate3State = 0\r\n helperState = 0\r\n playerScore = 0\r\n\r\n// Tick down game timer, and end game when it runs out\r\n?gameState = 1\r\n gameTimer--\r\n ?gameTimer > gameTimerTotal / 2\r\n  timerColour = timerColourHigh\r\n ?gameTimer < gameTimerTotal / 2 & gameTimer > gameTimerTotal / 4\r\n  timerColour = timerColourMed\r\n ?gameTimer < gameTimerTotal / 4\r\n  timerColour = timerColourLow\r\n ?gameTimer <= 0\r\n  gameState = 2\r\n  helperState = 2"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/SSRPGIdle.txt" - Parse error: Failed to parse completely. Remaining: "=\"\\n\r\n^#######.-.###\\n\r\n^######(==')##\\n\r\n^#####[>`.´###\\n\r\n^######\\/|\\o##\\n\r\n^####<¯¯] \\###\\n\r\n^####´¯¯`#####\"\r\n\r\n// shady guy\r\nvar shadyGuyArt =\"\\n\r\n^######_####\\n\r\n^#####{ )###\\n\r\n^###┌┐_/`###\\n\r\n^####│/ /\\##\\n\r\n^####│#(\\_|_\"\r\n\r\n\r\n// Stan\r\nvar stanArt = \"\\n\r\n^######.-.####\\n\r\n^####O(-- )###\\n\r\n^####\\_`.´_###\\n\r\n^#######╤#O,\\n\r\n^######/#\\##\"\r\n\r\n// Arvid\r\nvar arvidArt = \"\\n\r\n^#######.-.#♣\\n\r\n^######(~~ )├\\n\r\n^#######`.´_,\\n\r\n^####>8´#╤##┤\\n\r\n^#######/#\\#├\"\r\n\r\n// Blakely\r\nvar blakelyArt = \"\\n\r\n^##########_,~#\\n\r\n^#####_,-.( )##\\n\r\n^####(~) ∞.´\\\\#\\n\r\n^#####¯#`-´##``\"\r\n\r\n// black box\r\nvar blackBoxArt = \"\\n\r\n^######_\\`-´/##\\n\r\n^#####|\\ \\_/ \\#\\n\r\n^#####| \\_____\\\\n\r\n^####╔══|     |\\n\r\n^####!| | ??? |\\n\r\n^####:.\\|_____|\"\r\n\r\nvar item1 = \"\\n\\n\\n\r\n^##### _o/¯\\####\\n\r\n^#####/.¯, /`O##\\n\r\n^#####¯¯`¯¯¯¯¯\"\r\n\r\n\r\n// hang-glider\r\nvar item2 = \"\\n\r\n^########</|>######\\n\r\n^###,####/ |######,\\n\r\n^##,####/  |#####,#\\n\r\n^#/¯¯¯¯¯¯¯¯¯¯¯¯¯¯/#\\n\r\n^/______________/`#\\n\r\n^/____|\\O/|;____/##\\n\r\n^#####\\¯¯¯/########\\n\r\n^####o´¯¯¯`o#######\"\r\n\r\n\r\nvar item3 = \"\r\n^####|\\#####\\n\r\n^####| \\####\\n\r\n^####\\  \\###\\n\r\n^#####\\ |###\\n\r\n^#####|\\|###\\n\r\n^/\\___|___/\\\\n\r\n^\\ \\_______/\\n\r\n^#`-------´###\"\r\n\r\n// Walker\r\nvar walkerArt = \"\\n\r\n^######♫#└O┘#####\\n\r\n^#######./|)#####\\n\r\n^######_|/ \\\\_###\\n\r\n^#_###/\\`¯¯¯'/###\\n\r\n^::\\-/ /`-|-'\\###\\n\r\n^.;/-'O###O###O##\\n\r\n^.¯#..)###|###(\"\r\n\r\n\r\n?cheat = 1\r\n karma ++\r\n stoneclick = 1000\r\n woodclick = 1000\r\n tarclick = 1000\r\n bronzeclick = 1000\r\n\r\n\r\n\r\n//                                                        Setup\r\n\r\n\r\n//clearing the screen\r\n>`0,0,#ffffff,  \r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\n^                                                                                                  \\n\r\nshortTermTimer ++\r\ntotalTicks ++\r\nresourceautotimer ++\r\nmaxautotimer++\r\n\r\n\r\n//                 auto production\r\n?resourceautotimer >= 10 | reward = 2 & resourcetimer = 1\r\n stones = stones + stoneauto\r\n stones = stones - woodauto\r\n wood = wood+ woodauto\r\n wood = wood - tarauto\r\n tar = tar + tarauto\r\n tar = tar - bronzeauto\r\n bronze = bronze + bronzeauto\r\n resourceautotimer = 0\r\n\r\n?maxautotimer > 150\r\n stonecap = stonecap + stoneautostorage\r\n woodcap = woodcap+ woodautostorage\r\n tarcap = tarcap + tarautostorage\r\n bronzecap = bronzecap + bronzeautostorage\r\n maxautotimer = 0\r\n\r\n//                                    upgrade names\r\n?upgradesunlocked > 0\r\n var descriptionColumnStartPosX = 0\r\n >`@descriptionColumnStartPosX@,@upgradeTableStartYPos@,#ffffff,\\n\r\n ^Storage Space\\n\r\n ?upgradesunlocked > 1\r\n  >`@descriptionColumnStartPosX@,@upgradeTableStartYPos@,#ffffff,\\n\\n\r\n^Tools\\n\r\n  ?upgradesunlocked > 2\r\n   >`@descriptionColumnStartPosX@,@upgradeTableStartYPos@,#ffffff,\\n\\n\\n\r\n^Workers\\n\r\n   ?upgradesunlocked > 3\r\n    >`@descriptionColumnStartPosX@,@upgradeTableStartYPos@,#ffffff,\\n\\n\\n\\n\r\n^Expanding Storage\\n\r\n    ?upgradesunlocked > 4\r\n     >`@descriptionColumnStartPosX@,@upgradeTableStartYPos@,#ffffff,\\n\\n\\n\\n\\n\r\n^Multiplier\r\n\r\n//                                                                    code resources\r\n\r\n\r\n//                                           items \r\n?itemnext = 1\r\n >`15,14,#ffffff,\r\n ^@item1@\\n\r\n ^Cost: @item1price@ Stones\r\n?itemnext = 2\r\n >`35,13,#ffffff,\r\n ^@item2@\\n\r\n ^Cost: @item2price@ Wood\r\n?itemnext = 3\r\n >`45,15,#ffffff,\r\n ^@item3@\\n\r\n ^Cost: @item3price@ Tar\r\n\r\n\r\n?unlockeditems > 0\r\n >`15,17,#ffffff,\r\n ^@item1@\\n\r\n ?unlockeditems > 1\r\n  >`35,13,#ffffff,\r\n  ^@item2@\\n\r\n  ?unlockeditems > 2\r\n   >`45,15,#ffffff,\r\n   ^@item3@\\n\r\n \r\n//                                          upgrade code\r\n\r\n\r\n\r\nvar stoneColumnPos = upgradeColumnStartPosX\r\n?stoneupgradeunlocks > 0\r\n >`@stoneColumnPos@,@upgradeTableStartYPos@,#888c8d,\r\n^ Stone Upgrades\\n\r\n >`@stoneColumnPos@,@upgradeTableStartYPos@,#ffffff,\\n\r\n ^ Cost: @stonecapupgrade@\\n\r\n ?stoneupgradeunlocks >1\r\n  >`@stoneColumnPos@,@upgradeTableStartYPos@,#ffffff,\\n\\n\r\n  ^ Cost: @stoneclickupgrade@\\n\r\n  ?stoneupgradeunlocks >2\r\n   >`@stoneColumnPos@,@upgradeTableStartYPos@,#ffffff,\\n\\n\\n\r\n   ^ Cost: @stoneautoupgrade@\\n\r\n   ?stoneupgradeunlocks >3\r\n    >`@stoneColumnPos@,@upgradeTableStartYPos@,#ffffff,\\n\\n\\n\\n\r\n    ^ Cost: @stoneautostorageupgrade@\\n\r\n    ?stoneupgradeunlocks >4\r\n     >`@stoneColumnPos@,@upgradeTableStartYPos@,#ffffff,\\n\\n\\n\\n\\n\r\n     ^ Cost: @stonemultiplierupgrade@\r\n\r\nvar woodColumnPos = upgradeColumnStartPosX + columnWidth\r\n?woodupgradeunlocks > 0\r\n >`@woodColumnPos@,@upgradeTableStartYPos@,#caa472,\r\n^ Wood Upgrades\\n\r\n >`@woodColumnPos@,@upgradeTableStartYPos@,#ffffff,\\n\r\n ^ Cost: @woodcapupgrade@\\n\r\n ?woodupgradeunlocks >1\r\n  >`@woodColumnPos@,@upgradeTableStartYPos@,#ffffff,\\n\\n\r\n  ^ Cost: @woodclickupgrade@\\n\r\n  ?woodupgradeunlocks >2\r\n   >`@woodColumnPos@,@upgradeTableStartYPos@,#ffffff,\\n\\n\\n\r\n   ^ Cost: @woodautoupgrade@\\n\r\n   ?woodupgradeunlocks >3\r\n    >`@woodColumnPos@,@upgradeTableStartYPos@,#ffffff,\\n\\n\\n\\n\r\n    ^ Cost: @woodautostorageupgrade@\\n\r\n    ?woodupgradeunlocks >4\r\n     >`@woodColumnPos@,@upgradeTableStartYPos@,#ffffff,\\n\\n\\n\\n\\n\r\n     ^ Cost: @woodmultiplierupgrade@\r\n\r\nvar tarColumnPos = upgradeColumnStartPosX + columnWidth * 2\r\n?tarupgradeunlocks > 0\r\n >`@tarColumnPos@,@upgradeTableStartYPos@,#4d4e4f,\r\n^ Tar Upgrades\\n\r\n >`@tarColumnPos@,@upgradeTableStartYPos@,#ffffff,\\n\r\n ^ Cost: @tarcapupgrade@\\n\r\n ?tarupgradeunlocks >1\r\n  >`@tarColumnPos@,@upgradeTableStartYPos@,#ffffff,\\n\\n\r\n  ^ Cost: @tarclickupgrade@\\n\r\n  ?tarupgradeunlocks >2\r\n   >`@tarColumnPos@,@upgradeTableStartYPos@,#ffffff,\\n\\n\\n\r\n   ^ Cost: @tarautoupgrade@\\n\r\n   ?tarupgradeunlocks >3\r\n    >`@tarColumnPos@,@upgradeTableStartYPos@,#ffffff,\\n\\n\\n\\n\r\n    ^ Cost: @tarautostorageupgrade@\\n\r\n    ?tarupgradeunlocks >4\r\n     >`@tarColumnPos@,@upgradeTableStartYPos@,#ffffff,\\n\\n\\n\\n\\n\r\n     ^ Cost: @tarmultiplierupgrade@\r\n\r\nvar bronzeColumnPos = upgradeColumnStartPosX + columnWidth * 3\r\n?bronzeupgradeunlocks > 0\r\n >`@bronzeColumnPos@,@upgradeTableStartYPos@,#cd7f32,\r\n^ Bronze Upgrades\\n\r\n >`@bronzeColumnPos@,@upgradeTableStartYPos@,#ffffff,\\n\r\n ^ Cost: @bronzecapupgrade@\\n\r\n ?bronzeupgradeunlocks >1\r\n  >`@bronzeColumnPos@,@upgradeTableStartYPos@,#ffffff,\\n\\n\r\n  ^ Cost: @bronzeclickupgrade@\\n\r\n  ?bronzeupgradeunlocks >2\r\n   >`@bronzeColumnPos@,@upgradeTableStartYPos@,#ffffff,\\n\\n\\n\r\n   ^ Cost: @bronzeautoupgrade@\\n\r\n   ?bronzeupgradeunlocks >3\r\n    >`@bronzeColumnPos@,@upgradeTableStartYPos@,#ffffff,\\n\\n\\n\\n\r\n    ^ Cost: @bronzeautostorageupgrade@\\n\r\n    ?bronzeupgradeunlocks >4\r\n     >`@bronzeColumnPos@,@upgradeTableStartYPos@,#ffffff,\\n\\n\\n\\n\\n\r\n     ^ Cost: @bronzemultiplierupgrade@\r\n\r\n\r\n//                                                                           top bar display\r\n//one more then you think it is :D\r\n?display = 1\r\n >`@stoneColumnPos@,0,#ffffff, o @stones@\r\n?display >1\r\n >`@stoneColumnPos@,0,#ffffff, o @stones@/@stonecap@\r\n ?display > 2\r\n  >`@woodColumnPos@,0,#ffffff, _/`@wood@/@woodcap@\r\n  ?display > 3\r\n   >`@tarColumnPos@,0,#ffffff, ≈@tar@/@tarcap@\r\n   ?display > 4\r\n    >`@bronzeColumnPos@,0,#ffffff, :.@bronze@/@bronzecap@\r\n    \r\n    \r\n//                                                                             clicking\r\n?key = bumpREnd\r\n ?resourceselected=1\r\n  stones = stones + stoneclick\r\n ?resourceselected=2\r\n  ?stones >= stonewoodconversionratio\r\n   wood = wood + woodclick\r\n   stones = stones - stonewoodconversionratio\r\n ?resourceselected=3\r\n  ?wood >= woodtarconversionratio\r\n   tar = tar + tarclick\r\n   wood = wood - woodtarconversionratio\r\n   ?dialogueonoff = 7\r\n    dialogueonoff = 1\r\n ?resourceselected=4\r\n  ?tar >= tarbronzeconversionratio\r\n   bronze = bronze + bronzeclick\r\n   tar = tar - tarbronzeconversionratio\r\n   ?dialogueonoff = 10\r\n    dialogueonoff = 1\r\n//game sequence stuff\r\n ?resourceselected=0\r\n  gameStage ++\r\n  resourceselected=1\r\n  shortTermTimer=0\r\n  \r\n//cap restriction on resources\r\n?stones > stonecap\r\n stones = stonecap\r\n?wood > woodcap\r\n wood = woodcap\r\n?tar > tarcap\r\n tar = tarcap\r\n?bronze > bronzecap\r\n bronze = bronzecap\r\n \r\n \r\n //                                            cursor \r\n?abletomove > 0\r\n >`@cursorPosX@,@cursorPosY@,#ffffff,-->\r\n \r\n \r\n \r\n//                          area / resource selected\r\n?resourcesunlocked>1\r\n ?resourceselected=1\r\n  >`3,2,#ffffff,\r\n^______________________\\n\r\n^│<  Rocky Plateau   >│\\n\r\n^¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\r\n ?resourceselected=2\r\n   >`3,2,#ffffff,\r\n^______________________\\n\r\n^│< Deadwood Canyon  >│\\n\r\n^¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\r\n ?resourceselected=3\r\n   >`3,2,#ffffff,\r\n^______________________\\n\r\n^│<  Caves of Fear   >│\\n\r\n^¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\r\n ?resourceselected=4\r\n  >`3,2,#ffffff,\r\n^______________________\\n\r\n^│<   Boiling Mine   >│\\n\r\n^¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\r\n\r\n\r\n\r\n\r\n\r\n//                                             moving \r\n\r\n\r\n\r\n//shift key stuff\r\nselectedsection=2\r\n?key = ability1\r\n selectedsection=1\r\n \r\n \r\n \r\n//general moving\r\n?abletomove > 0\r\n\r\n\r\n//left\r\n ?key = leftBegin\r\n //area\r\n  ?selectedsection = 1\r\n   resourceselected --\r\n   ?resourceselected < 1\r\n    resourceselected = 1\r\n\r\n//upgrades\r\n  ? selectedsection = 2\r\n   upgradeselectedX--\r\n   cursorPosX--\r\n   cursorPosX=cursorPosX-columnWidth+1\r\n   maths = upgradeColumnStartPosX-3\r\n   ?cursorPosX < maths\r\n    cursorPosX = maths\r\n   ?upgradeselectedX<1\r\n    upgradeselectedX=1\r\n\r\n//right\r\n ?key = rightBegin\r\n //area\r\n  ?selectedsection = 1\r\n   resourceselected ++\r\n   ?resourceselected > resourcesunlocked\r\n    resourceselected = resourcesunlocked \r\n//upgrades\r\n  ? selectedsection = 2\r\n   cursorPosX++\r\n   upgradeselectedX++\r\n   cursorPosX=columnWidth+cursorPosX-1\r\n   maths = resourcesunlocked*columnWidth+14\r\n   ?cursorPosX > maths\r\n    cursorPosX = maths\r\n   ?upgradeselectedX>resourcesunlocked\r\n    upgradeselectedX=resourcesunlocked\r\n//up\r\n ?key=upBegin\r\n  ? selectedsection = 2\r\n   cursorPosY--\r\n   upgradeselectedY--\r\n   ?cursorPosY < 6\r\n    cursorPosY=6\r\n   ?upgradeselectedY<1\r\n    upgradeselectedY=1\r\n   \r\n//down\r\n ?key=downBegin\r\n  ? selectedsection = 2\r\n   cursorPosY++\r\n   upgradeselectedY++\r\n   maths = cursorposy//\r\n   ?cursorPosY > 10\r\n    cursorPosY=10\r\n   ?upgradeselectedX = 1\r\n    ?upgradeselectedY > stoneupgradeunlocks\r\n     upgradeselectedY = stoneupgradeunlocks\r\n\r\n   ?upgradeselectedX = 2\r\n    ?upgradeselectedY > woodupgradeunlocks\r\n     upgradeselectedY = woodupgradeunlocks\r\n\r\n   ?upgradeselectedX = 3\r\n    ?upgradeselectedY > tarupgradeunlocks\r\n     upgradeselectedY = tarupgradeunlocks\r\n\r\n   ?upgradeselectedX = 4\r\n    ?upgradeselectedY > bronzeupgradeunlocks\r\n     upgradeselectedY = bronzeupgradeunlocks\r\n\r\n   ?upgradeselectedMaxY>5\r\n    upgradeselectedMaxY=5\r\n    //TODO - resourceselected 3\r\n\r\n//fixes because this code is bad\r\n\r\n?cursorPosY < 6\r\n cursorPosY=6\r\n?upgradeselectedY< 1\r\n upgradeselectedY = 1\r\n\r\n\r\n//                                                                          actually upgrading hopefully\r\n?key = backEnd\r\n //                       items\r\n ?selectedsection = 1\r\n  ?itemnext = 1 & stones >= item1price\r\n   stones = stones - item1price\r\n   resourcesunlocked = 2\r\n   woodupgradeunlocks ++\r\n   display = 3\r\n   itemnext = 0\r\n   unlockeditems = 1\r\n   dialogueonoff = 1\r\n  ?itemnext = 2\r\n   ?wood >= item2price\r\n    wood = wood - item2price\r\n    resourcesunlocked = 3\r\n    tarupgradeunlocks ++\r\n    display = 4\r\n    itemnext = 0\r\n    dialogueonoff = 1\r\n    unlockeditems = 2\r\n  ?itemnext = 3\r\n   ?tar >= item3price\r\n    tar = tar - item3price\r\n    resourcesunlocked =4\r\n    bronzeupgradeunlocks ++\r\n    display = 5\r\n    itemnext = 0\r\n    dialogueonoff = 1\r\n    unlockeditems = 3\r\n //stones\r\n ?selectedsection = 2\r\n  ?upgradeselectedX = 1\r\n //cap\r\n   ?upgradeselectedY = 1 & stones >= stonecapupgrade\r\n    stones = stones - stonecapupgrade\r\n    stonecapupgrade = stonecapupgrade+capupgradepriceincrease\r\n    stonecap=stonecap+capupgrademultiplyer*totalmultiplier\r\n //click amnt\r\n   ?upgradeselectedY = 2 & stones >= stoneclickupgrade\r\n    stones = stones - stoneclickupgrade\r\n    ?reward = 1 \r\n     stoneclickupgrade = stoneclickupgrade+100\r\n    :\r\n     stoneclickupgrade = stoneclickupgrade*clickupgradepriceincrease\r\n    stoneclick=stoneclick+clickupgradeamountincrease*totalmultiplier\r\n //auto\r\n   ?upgradeselectedY = 3 & stones >= stoneautoupgrade\r\n    stones = stones - stoneautoupgrade\r\n    stoneautoupgrade = stoneautoupgrade+autoupgradepriceincrease\r\n    stoneauto=stoneauto+autoupgradeamountincrease*totalmultiplier\r\n    karma++\r\n //auto max\r\n   ?upgradeselectedY = 4 & stones >= stoneautostorageupgrade\r\n    stones = stones - stoneautostorageupgrade\r\n    stoneautostorageupgrade = stoneautostorageupgrade+autostorageupgradepriceincrease\r\n    stoneautostorage=stoneautostorage+autostorageupgradeamountincrease*totalmultiplier\r\n //multiplier\r\n   ?upgradeselectedY = 5 & stones >= stonemultiplierupgrade\r\n    stones = stones - stonemultiplierupgrade\r\n    stonemultiplierupgrade = (stonemultiplierupgrade*multiplierupgradepriceincrease)+3000\r\n    stonemultiplier=stonemultiplier+multiplierupgradeamountincrease\r\n//wood\r\n  ?upgradeselectedX = 2\r\n //cap\r\n   ?upgradeselectedY = 1 & wood >= woodcapupgrade\r\n    wood = wood - woodcapupgrade\r\n    woodcapupgrade = woodcapupgrade+capupgradepriceincrease\r\n    woodcap=woodcap+capupgrademultiplyer*totalmultiplier\r\n //click amnt\r\n   ?upgradeselectedY = 2 & wood >= woodclickupgrade\r\n    wood = wood - woodclickupgrade\r\n    ?reward = 1 \r\n     woodclickupgrade = woodclickupgrade+100\r\n    :\r\n     woodclickupgrade = woodclickupgrade*clickupgradepriceincrease\r\n    woodclick=woodclick+clickupgradeamountincrease*totalmultiplier\r\n //auto\r\n   ?upgradeselectedY = 3 & wood >= woodautoupgrade\r\n    wood = wood - woodautoupgrade\r\n    woodautoupgrade = woodautoupgrade+autoupgradepriceincrease\r\n    woodauto=woodauto+autoupgradeamountincrease*totalmultiplier\r\n    karma++\r\n //auto max\r\n   ?upgradeselectedY = 4 & wood >= woodautostorageupgrade\r\n    wood = wood - woodautostorageupgrade\r\n    woodautostorageupgrade = woodautostorageupgrade+autostorageupgradepriceincrease\r\n    woodautostorage=woodautostorage+autostorageupgradeamountincrease*totalmultiplier\r\n //multiplier\r\n   ?upgradeselectedY = 5 & wood >= woodmultiplierupgrade\r\n    wood = wood - woodmultiplierupgrade\r\n    woodmultiplierupgrade = (woodmultiplierupgrade*multiplierupgradepriceincrease)+3000\r\n    woodmultiplier=woodmultiplier+multiplierupgradeamountincrease\r\n//tar\r\n  ?upgradeselectedX = 3\r\n //cap\r\n   ?upgradeselectedY = 1 & tar >= tarcapupgrade\r\n    tar = tar - tarcapupgrade\r\n    tarcapupgrade = tarcapupgrade+capupgradepriceincrease\r\n    tarcap=tarcap+capupgrademultiplyer*totalmultiplier\r\n //click amnt\r\n   ?upgradeselectedY = 2 & tar >= tarclickupgrade\r\n    tar = tar - tarclickupgrade\r\n    ?reward = 1 \r\n     tarclickupgrade = tarclickupgrade+100\r\n    :\r\n     tarclickupgrade = tarclickupgrade*clickupgradepriceincrease\r\n    tarclick=tarclick+clickupgradeamountincrease*totalmultiplier\r\n //auto\r\n   ?upgradeselectedY = 3 & tar >= tarautoupgrade\r\n    tar = tar - tarautoupgrade\r\n    tarautoupgrade = tarautoupgrade+autoupgradepriceincrease\r\n    tarauto=tarauto+autoupgradeamountincrease*totalmultiplier\r\n    karma++\r\n //auto max\r\n   ?upgradeselectedY = 4 & tar >= tarautostorageupgrade\r\n    tar = tar - tarautostorageupgrade\r\n    tarautostorageupgrade = tarautostorageupgrade+autostorageupgradepriceincrease\r\n    tarautostorage=tarautostorage+autostorageupgradeamountincrease*totalmultiplier\r\n //multiplier\r\n   ?upgradeselectedY = 5 & tar >= tarmultiplierupgrade\r\n    tar = tar - tarmultiplierupgrade\r\n    tarmultiplierupgrade = (tarmultiplierupgrade*multiplierupgradepriceincrease)+3000\r\n    tarmultiplier=tarmultiplier+multiplierupgradeamountincrease\r\n//bronze\r\n  ?upgradeselectedX = 4\r\n //cap\r\n   ?upgradeselectedY = 1 & bronze >= bronzecapupgrade\r\n    bronze = bronze - bronzecapupgrade\r\n    bronzecapupgrade = bronzecapupgrade+capupgradepriceincrease\r\n    bronzecap=bronzecap+capupgrademultiplyer*totalmultiplier\r\n //click amnt\r\n   ?upgradeselectedY = 2 & bronze >= bronzeclickupgrade\r\n    bronze = bronze - bronzeclickupgrade\r\n    ?reward = 1 \r\n     bronzeclickupgrade = bronzeclickupgrade+100\r\n    :\r\n     bronzeclickupgrade = bronzeclickupgrade*clickupgradepriceincrease\r\n    bronzeclick=bronzeclick+clickupgradeamountincrease*totalmultiplier\r\n //auto\r\n   ?upgradeselectedY = 3 & bronze >= bronzeautoupgrade\r\n    bronze = bronze - bronzeautoupgrade\r\n    bronzeautoupgrade = bronzeautoupgrade+autoupgradepriceincrease\r\n    bronzeauto=bronzeauto+autoupgradeamountincrease*totalmultiplier\r\n    karma++\r\n //auto max\r\n   ?upgradeselectedY = 4 & bronze >= bronzeautostorageupgrade\r\n    bronze = bronze - bronzeautostorageupgrade\r\n    bronzeautostorageupgrade = bronzeautostorageupgrade+autostorageupgradepriceincrease\r\n    bronzeautostorage=bronzeautostorage+autostorageupgradeamountincrease*totalmultiplier\r\n //multiplier\r\n   ?upgradeselectedY = 5 & bronze >= bronzemultiplierupgrade\r\n    bronze = bronze - bronzemultiplierupgrade\r\n    bronzemultiplierupgrade = (bronzemultiplierupgrade*multiplierupgradepriceincrease)+3000\r\n    bronzemultiplier=bronzemultiplier+multiplierupgradeamountincrease\r\n   \r\n\r\n\r\n\r\n//getting the menu to work fully \r\n\r\n?upgradeselectedX = 1\r\n maths2 = cursorPosY - 5\r\n ?stoneupgradeunlocks < maths2\r\n  cursorPosY = stoneupgradeunlocks + 5\r\n  upgradeselectedY = stoneupgradeunlocks\r\n?upgradeselectedX = 2\r\n maths2 = cursorPosY - 5\r\n ?woodupgradeunlocks < maths2\r\n  cursorPosY = woodupgradeunlocks + 5\r\n  upgradeselectedY = woodupgradeunlocks\r\n?upgradeselectedX = 3\r\n maths2 = cursorPosY - 5\r\n ?tarupgradeunlocks < maths2\r\n  cursorPosY = tarupgradeunlocks + 5\r\n  upgradeselectedY = tarupgradeunlocks\r\n?upgradeselectedX = 4\r\n maths2 = cursorPosY - 5\r\n ?bronzeupgradeunlocks < maths2\r\n  cursorPosY = bronzeupgradeunlocks + 5\r\n  upgradeselectedY = bronzeupgradeunlocks\r\n  \r\n  \r\n\r\n\r\n\r\n//                                                   dialog\r\n\r\n// Dialogue strings for intro sequence\r\n//                    =======================================================\r\nvar dialogueIntro9 = \"                            o\"\r\nvar dialogueIntro0 = \"                    PRESS C TO BEGIN\"\r\nvar dialogueIntro1 = \"                    You see nothing.\"\r\nvar dialogueIntro2 = \"                    You hear nothing.\"\r\nvar dialogueIntro3 = \"                          Wait --\"\r\nvar dialogueIntro4 = \"                 Didn't we just do this?\"\r\nvar dialogueIntro5 = \"                  Let me put this back.\"\r\nvar dialogueIntro6 = \"      Now you can get to collecting those stones.\"\r\n\r\n//                                                                       start sequence\r\n?gameStage = 0\r\n ?shortTermTimer >=100 & gameStage = 0 & shortTermTimer <= 130\r\n  >`15,15,#ffffff,@dialogueIntro9@\r\n ?shortTermTimer >= 160 \r\n  shortTermTimer = 99\r\n ?totalTicks > 200 & gameStage = 0\r\n   >`15,17,#ffffff,@dialogueIntro0@\r\n  \r\n//intro\r\n?shortTermTimer >= 0 & gameStage = 1 \r\n >`15,17,#ffffff,@dialogueIntro1@\r\n ?shortTermTimer >= 50\r\n  shortTermTimer=0\r\n  gameStage=2\r\n \r\n?shortTermTimer >= 0 & gameStage = 2\r\n >`15,17,#ffffff,@dialogueIntro2@\r\n ?shortTermTimer = 90\r\n  shortTermTimer=0\r\n  gameStage=3\r\n \r\n \r\n var helpnumber = 0\r\n?shortTermTimer >= 30 & gameStage = 3\r\n >`15,17,#ffffff,@dialogueIntro3@\r\n ?shortTermTimer > 50 & shortTermTimer < 100\r\n  >`15,17,#ffffff,@dialogueIntro4@\r\n ?shortTermTimer >= 100 & shortTermTimer < 150\r\n  >`15,17,#ffffff,@dialogueIntro5@\r\n ?shortTermTimer >= 150\r\n  display = 1\r\n ?shortTermTimer >= 150\r\n//playing the game\r\n  >`15,17,#ffffff,@dialogueIntro6@\r\n  helpnumber = 1\r\n  ?stones >= 10\r\n   gameStage = 4\r\n   shortTermTimer = 0\r\n   \r\n   \r\n?stones >= 30 & stoneupgradeunlocks = 0\r\n stoneupgradeunlocks = 1\r\n gameStage = 5\r\n shortTermTimer = 0\r\n display = 2\r\n \r\n// introducing upgrades\r\nvar dialogueUpgrades0 = \"Looks like you're having trouble carrying all those stones.\"\r\nvar dialogueUpgrades1 = \"Why don't you put them down?\"\r\nvar dialogueUpgrades2 = \"Are you afraid someone will steal them?\"\r\nvar dialogueUpgrades3 = \"Don't worry, I'll keep an eye on them.\"\r\nvar dialogueUpgrades4 = \"You want to collect more stones?\"\r\nvar dialogueUpgrades5 = \"You can make a bigger pile, but it'll be messy...\"\r\nvar dialogueUpgrades6 = \"I can sell you some tarps to hold it together.\"\r\n\r\n// trigger at 90 stones: introduce shadowy dude who will bring in \"workers\" for a price\r\n\r\nvar sequence1number1 = \"Well hello there.\"\r\nvar sequence1number2 = \"This is a cute operation you've got going on.\"\r\nvar sequence1number3 = \"You won't get very far here all alone, though.\"\r\nvar sequence1number4 = \"But don't worry, I can help. I know a guy.\"\r\nvar sequence1number5 = \"And he knows a guy.\"\r\nvar sequence1number6 = \"Long story short, I can get you some good workers... for a price.\"\r\nvar sequence1number7 = \"They're not easy to find... or convince. But they do like resources.\"\r\nvar sequence1number8 = \"So how about it? I get you workers, you pay me a finder's fee.\"\r\nvar sequence1number9 = \"My guys always love new customers.\"\r\nvar sequence1number10 = \"Bring me 200 stones and I might be able to set something up.\"\r\nvar sequence1number11 = \"Oh, they call you Pusher, eh? Good to know.\"\r\nvar sequence1number12 = \"Be seeing you, Pusher...\"\r\n\r\n// introduce upgrades\r\nvar sequence2number1 = \"Oh, are these upgrades too slow for you?\"\r\nvar sequence2number2 = \"Tsk. I'm running a business here.\"\r\nvar sequence2number3 = \"But, hey... I'm always looking for new investors.\"\r\nvar sequence2number4 = \"Invest some capital upfront, and I'll reward you...\"\r\nvar sequence2number5 = \"... by applying a multiplier to the upgrades you buy.\"\r\nvar sequence2number6 = \"The more you invest, the more you get from future upgrades.\"\r\n\r\n// introduce stan at ??? stones\r\nvar sequence3number1 =  \"I found you a resource. This here is Stan.\"\r\nvar sequence3number2 =  \"Stan will get you wood.\"\r\nvar sequence3number3 =  \"He's... really, really, really into collecting stones.\"\r\nvar sequence3number4 =  \"Just let him do his thing.\"\r\nvar sequence3number5 =  \"\"\r\n// load stanArt\r\nvar sequence3number6 =  \"Hi.\"\r\n//different color\r\nvar sequence3number7 = \"You see him softly petting a rock in his hand.\"\r\n// stan offers to trade you 1 click of wood for 100 stones\r\nvar sequence3number8 = \"I need a lot of stones.\"\r\nvar sequence3number9 = \"No, you don't need to know why.\"\r\nvar sequence3number10 = \"You see those trees down there? I'll get you one trip's worth of wood for 100 stones.\"\r\nvar sequence3number11 = \"You need to find a way down, though.\"\r\n\r\n// unlock Deadwood\r\nvar sequence4number1 =  \"  Why did you throw all those stones off that cliff?\"\r\nvar sequence4number2 =  \"                  ... Never mind.\"\r\nvar sequence4number3 =  \"    Anyway, you've made a nice slope to walk down.\"\r\nvar sequence4number4 =  \"         Now you can go into Deadwood Canyon.\"\r\n\r\n// introduce arvid at ??? wood\r\nvar sequence5number1 = \"Here's another one you can use. Arvid's... alright.\"\r\nvar sequence5number2 = \"Arvid barely glances at you before staring into the trees.\"\r\nvar sequence5number2 = \"Don't let him dawdle. Last boss caught him staring at birds all the time.\"\r\nvar sequence5number3 = \"He can probably build you a kiln without messing it up.\"\r\nvar sequence5number4 = \"It'll cost you, though.\"\r\n\r\n// unlock Caves\r\nvar sequence6number1 = \"While collecting wood, you spot a sinkhole leading into the Caves of Fear.\"\r\nvar sequence6number2 = \"Back at camp, you mention it to Arvid, who stares into the distance for a while.\"\r\nvar sequence6number3 = \"Then, he fetches his knife and starts whittling.\"\r\nvar sequence6number4 = \"You wake up the next day and see a... hang-glider next to you.\"\r\nvar sequence6number5a = \"That scoundrel took \"\r\nvar sequence6number5b = \" wood to do it, too.\"\r\n\r\n// convert wood to tar\r\nvar sequence7number1 = \"You go to one of Arvid's kilns and put some chopped wood into it.\"\r\nvar sequence7number2 = \"A few hours later, tar pours out of it. It makes a mess.\"\r\nvar sequence7number3 = \"This seems really inefficient. Maybe you can improve it?\"\r\n\r\n// introducing tar worker Blakely\r\nvar sequence8number1 = \"You hear the skittering approach of a large spider.\"\r\nvar sequence8number2 = \"Clicking and hissing, she deftly pushes together a clump of tar and flings it at you.\"\r\nvar sequence8number3 = \"You decide to call her Blakely. She doesn't seem aggressive, yet.\"\r\n\r\n// unlock Mine\r\nvar sequence9number1 = \"You haven't used your canoe in a while, so you apply some tar to its hull for waterproofing.\"\r\nvar sequence9number2 = \"There! Good as new. You find some canvas and add a sail.\"\r\nvar sequence9number3 = \"Taking it out to the river to try it out, you spot the familiar Bronze Gate.\"\r\nvar sequence9number4 = \"With all the workers gone, you can probably find lots of bronze for the taking.\"\r\n\r\n// convert tar to bronze\r\nvar sequence10number1 = \"You find a black box with a funnel at the top and an opening in the side.\"\r\nvar sequence10number2 = \"The funnel, box, and opening are labelled 'TAR', '???', and 'PROFIT!'\"\r\nvar sequence10number3 = \"You pour in some tar. The machine whirs and chugs, then spits out some bronze.\"\r\nvar sequence10number4 = \"That was only mildly profitable.\"\r\n\r\n// if auto upgrades\r\nvar sequence11number1 = \"You find a Mine Walker. It is heavily dented, but it still works.\"\r\nvar sequence11number2 = \"After using the Mind Stone on it, you manage to get the Walker up and running.\"\r\nvar sequence11number3 = \"Maybe you can use it to keep your 'workers' in line.\"\r\n\r\n// good ending - if no auto upgrades, then shopkeep gives you a large boost to clicking and thanks you, you never see @shadyguyname@ again\r\n// price of click upgrades stops doubling, and instead increases by @number@ per upgrade\r\nvar sequence12anumber1 = \"Hey, I don't usually like to interrupt, but...\"\r\nvar sequence12anumber2 = \"Good call on not making any deals with that guy in the robe.\"\r\nvar sequence12anumber3 = \"Some say he's a genius who invented new ways of harvesting and producing resources, but...\"\r\nvar sequence12anumber4 = \"Just between you and me, I'm pretty sure he uses slave labour to work all those 'miracles'.\"\r\nvar sequence12anumber5 = \"I prefer to deal with people who keep their hands clean.\"\r\nvar sequence12anumber6 = \"So, as a gesture of my appreciation, I'll lower the price of my tools.\"\r\nvar sequence12anumber7 = \"Consider it a discount for good conduct.\" // here I disable auto upgrades permanently\r\n\r\n// bad ending - if you bought any auto upgrades\r\nvar sequence12bnumber1 = \"Well hello there. Again.\"\r\nvar sequence12bnumber2 = \"I see you're getting decent use out of these resources.\"\r\nvar sequence12bnumber3 = \"Did you know that you are the one who made my business possible?\"\r\nvar sequence12bnumber4 = \"Acropolis had total control of the slave market until you let them out of the Boiling Mines.\"\r\nvar sequence12bnumber5 = \"Because you are such a loyal customer and made this possible, I will give you my best Dominotaur.\"\r\nvar sequence12bnumber6 = \"Your production should increase tenfold.\"\r\nvar sequence12bnumber7 = \"Again, you have my thanks.\"\r\nvar sequence12bnumber8 = \"Be seeing you...\"\r\n\r\n// =======================================================\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n//start of upgrades\r\n?gameStage = 5\r\n ?shortTermTimer > 30 & shortTermTimer < 120\r\n  >`15,17,#ffffff,@dialogueUpgrades0@\r\n ?shortTermTimer > 120 & shortTermTimer < 210\r\n  >`15,17,#ffffff,@dialogueUpgrades1@\r\n ?shortTermTimer > 210 & shortTermTimer < 300\r\n  >`15,17,#ffffff,@dialogueUpgrades2@\r\n ?shortTermTimer > 300 & shortTermTimer < 390\r\n  >`15,17,#ffffff,@dialogueUpgrades3@\r\n ?shortTermTimer > 570\r\n  gameStage = 6\r\n  shortTermTimer = 0\r\n?stones = 50 & gameStage < 6\r\n gameStage = 6\r\n shortTermTimer = 0\r\n\r\n?gameStage = 6\r\n ?shortTermTimer > 0 & shortTermTimer <90\r\n  >`15,17,#ffffff,@dialogueUpgrades4@\r\n ?shortTermTimer > 90 & shortTermTimer < 180\r\n  >`15,17,#ffffff,@dialogueUpgrades5@\r\n ?shortTermTimer > 180 & shortTermTimer < 270\r\n  >`15,17,#ffffff,@dialogueUpgrades6@\r\n  stoneupgradeunlocks = 1\r\n  abletomove= 1\r\n ?stonecap > 60\r\n  shortTermTimer = 0\r\n  stoneupgradeunlocks = 2 \r\n  gameStage =  7\r\n  abletomove = 1\r\n  upgradesunlocked = 2\r\n\r\n\r\n//                              UNLOCKS\r\n\r\n\r\n\r\n?stones >= 90 & stoneupgradeunlocks < 3\r\n stoneupgradeunlocks=3\r\n upgradesunlocked = 3\r\n dialogueonoff = 1\r\n \r\n   //once you get 90 stones auto click shows up\r\n?stoneupgradeunlocks <4 & stones >= 300\r\n stoneupgradeunlocks = 4\r\n upgradesunlocked = 4\r\n  //once you get 300 stones auto cap shows up\r\n?stoneupgradeunlocks <5 & stones > 650\r\n stoneupgradeunlocks = 5\r\n upgradesunlocked = 5\r\n dialogueonoff = 1\r\n //once you get 650 stones the multiplier shows up\r\n?stones >= 1200 & itemnext < 1\r\n ?resourcesunlocked = 0\r\n  itemnext = 1\r\n  dialogueonoff = 1\r\n  \r\n?wood >= 40 & woodupgradeunlocks < 2\r\n woodupgradeunlocks=2\r\n?wood >= 90 & woodupgradeunlocks < 3\r\n woodupgradeunlocks=3\r\n?woodupgradeunlocks <4 & wood > 700\r\n woodupgradeunlocks = 4\r\n?woodupgradeunlocks <5 & wood > 1200\r\n woodupgradeunlocks = 5\r\n?wood >= 2000 & itemnext < 2\r\n ?resourcesunlocked = 2\r\n  itemnext = 2\r\n  dialogueonoff = 1\r\n  \r\n?tar >= 40 & tarupgradeunlocks < 2\r\n tarupgradeunlocks=2\r\n?tar >= 90 & tarupgradeunlocks < 3\r\n tarupgradeunlocks=3\r\n?tarupgradeunlocks <4 & tar > 700\r\n tarupgradeunlocks = 4\r\n dialogueonoff = 1\r\n?tarupgradeunlocks <5 & tar > 1200\r\n tarupgradeunlocks = 5\r\n?tar >= 3000 & itemnext < 3\r\n ? resourcesunlocked = 3\r\n  itemnext = 3\r\n?bronze >= 40 & bronzeupgradeunlocks < 2\r\n bronzeupgradeunlocks=2\r\n?bronze >= 90 & bronzeupgradeunlocks < 3\r\n bronzeupgradeunlocks=3\r\n?bronzeupgradeunlocks <4 & bronze > 700\r\n bronzeupgradeunlocks = 4\r\n?bronzeupgradeunlocks <5 & bronze > 1200\r\n bronzeupgradeunlocks = 5\r\n dialogueonoff = 1\r\n\r\nvar boxPosX = 0\r\nvar boxPosY = 0\r\n?locationstarting = 0\r\n boxPosX = screen.w - 16\r\n boxPosY = 0\r\n locationstarting=1\r\n\r\n\r\nvar dialogueinsequence = 12\r\nvar dialogueonoff = 0\r\nvar dialogueboxPosX = 0\r\nvar dialogueboxPosY = 0\r\nvar dialoguenumber = 1\r\nvar sequence = 1\r\n\r\n func SetVarstoZero()\r\n  dialogueonoff = 0\r\n  dialoguenumber = 1\r\n  sequence ++\r\n\r\n\r\n?dialogueonoff = 1\r\n >`@dialogueboxPosX@,@dialogueboxPosY@,#ffffff,\r\n^                                                                                                                                     \\n\r\n^                                                                                                                                     \\n\r\n^                                                                                                                                     \\n\r\n^                                                                                                                                     \\n\r\n^                                                                                                                                     \\n\r\n^                                                                                                                                     \\n\r\n^                                                                                                                                     \\n\r\n^                                                                                                                                     \\n\r\n^                                                                                                                                     \\n\r\n^                                                                                                                                     \\n\r\n^                                                                                                                                     \\n\r\n^                                                                                                                                     \\n\r\n^                                                                                                                                     \\n\r\n^                                                                                                                                     \\n\r\n^                                                                                                                                     \\n\r\n^                                                                                                                                     \\n\r\n^                                                                                                                                     \\n\r\n^                                                                                                                                     \\n\r\n^                                                                                                                                     \\n\r\n^                                                                                                                                     \\n\r\n^                                                                                                                                     \\n\r\n^                                                                                                                                     \\n\r\n^                                                                                                                                     \\n\r\n^                                                                                                                                     \\n\r\n^                                                                                                                                     \\n\r\n\r\n >`@boxPosX@,@boxPosY@,#ffffff,\r\n^┌──────────────┐\\n\r\n^│              │\\n\r\n^│              │\\n\r\n^│              │\\n\r\n^│              │\\n\r\n^│              │\\n\r\n^│              │\\n\r\n^└──────────────┘\r\n// if Enter is pressed\r\n ?key = bumpLEnd\r\n  dialoguenumber++\r\n\r\n ?sequence = 1\r\n  >`@boxPosX@,@boxPosY@,#ffffff,@shadyGuyArt@\r\n  ?dialoguenumber = 1\r\n   >`1,1,#ffffff,\r\n   ^@sequence1number1@\r\n  :?dialoguenumber = 2\r\n   >`1,1,#ffffff,\\n\r\n   ^@sequence1number2@\r\n  :?dialoguenumber = 3\r\n   >`1,1,#ffffff,\\n\\n\r\n   ^@sequence1number3@\r\n  :?dialoguenumber = 4\r\n   >`1,1,#ffffff,\\n\\n\\n\r\n   ^@sequence1number4@\r\n  :?dialoguenumber = 5\r\n   >`1,1,#ffffff,\\n\\n\\n\\n\r\n   ^@sequence1number5@\r\n  :?dialoguenumber = 6\r\n   >`1,1,#ffffff,\\n\\n\\n\\n\\n\r\n   ^@sequence1number6@\r\n  :?dialoguenumber = 7\r\n   >`1,1,#ffffff,\\n\\n\\n\\n\\n\\n\r\n   ^@sequence1number7@\r\n  :?dialoguenumber = 8\r\n   >`1,1,#ffffff,\\n\\n\\n\\n\\n\\n\\n\r\n   ^@sequence1number8@\r\n  :?dialoguenumber = 9\r\n   >`1,1,#ffffff,\\n\\n\\n\\n\\n\\n\\n\\n\r\n   ^@sequence1number9@\r\n  :?dialoguenumber = 10\r\n   >`1,1,#ffffff,\\n\\n\\n\\n\\n\\n\\n\\n\\n\r\n   ^@sequence1number10@\r\n  :?dialoguenumber = 11\r\n   >`1,1,#ffffff,\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\r\n   ^@sequence1number11@ \r\n  :?dialoguenumber = 12\r\n   >`1,1,#ffffff,\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\r\n   ^@sequence1number12@\r\n  :?dialoguenumber = 13\r\n   SetVarstoZero()\r\n   \r\n   \r\n ?sequence = 2\r\n  >`@boxPosX@,@boxPosY@,#ffffff,@shopkeeperArt@\r\n  ?dialoguenumber = 1\r\n   >`1,1,#ffffff,\r\n   ^@sequence2number1@\r\n  ?dialoguenumber = 2\r\n   >`1,1,#ffffff,\\n\r\n   ^@sequence2number2@\r\n  ?dialoguenumber = 3\r\n   >`1,1,#ffffff,\\n\\n\r\n   ^@sequence2number3@\r\n  ?dialoguenumber = 4\r\n   >`1,1,#ffffff,\\n\\n\\n\r\n   ^@sequence2number4@\r\n  ?dialoguenumber = 5\r\n   >`1,1,#ffffff,\\n\\n\\n\\n\r\n   ^@sequence2number5@\r\n  ?dialoguenumber = 6\r\n   >`1,1,#ffffff,\\n\\n\\n\\n\\n\r\n   ^@sequence2number6@\r\n  ?dialoguenumber = 7\r\n   SetVarstoZero()\r\n    \r\n ?sequence = 3\r\n  ?dialoguenumber = 1\r\n   >`@boxPosX@,@boxPosY@,#ffffff,@shadyGuyArt@\r\n   >`1,1,#ffffff,\r\n   ^@sequence3number1@\r\n  ?dialoguenumber = 2\r\n   >`@boxPosX@,@boxPosY@,#ffffff,@shadyGuyArt@\r\n   >`1,1,#ffffff,\\n\r\n   ^@sequence3number2@\r\n  ?dialoguenumber = 3\r\n   >`@boxPosX@,@boxPosY@,#ffffff,@shadyGuyArt@\r\n   >`1,1,#ffffff,\\n\\n\r\n   ^@sequence3number3@\r\n  ?dialoguenumber = 4\r\n   >`@boxPosX@,@boxPosY@,#ffffff,@shadyGuyArt@\r\n   >`1,1,#ffffff,\\n\\n\\n\r\n   ^@sequence3number4@\r\n  ?dialoguenumber = 5\r\n   >`@boxPosX@,@boxPosY@,#ffffff,@stanArt@\r\n   >`1,1,#afafaf,\\n\\n\\n\\n\r\n   ^@sequence3number5@\r\n  ?dialoguenumber = 6\r\n   >`@boxPosX@,@boxPosY@,#ffffff,@stanArt@\r\n   >`1,1,#ffffff,\\n\\n\\n\\n\\n\r\n   ^@sequence3number6@\r\n  ?dialoguenumber = 7\r\n   >`@boxPosX@,@boxPosY@,#ffffff,@stanArt@  \r\n   >`1,1,#afafaf,\\n\\n\\n\\n\\n\\n\r\n   ^@sequence3number7@\r\n  ?dialoguenumber = 8\r\n   >`@boxPosX@,@boxPosY@,#ffffff,@stanArt@\r\n   >`1,1,#ffffff,\\n\\n\\n\\n\\n\\n\\n\r\n   ^@sequence3number8@\r\n  ?dialoguenumber = 9\r\n   >`@boxPosX@,@boxPosY@,#ffffff,@stanArt@\r\n   >`1,1,#ffffff,\\n\\n\\n\\n\\n\\n\\n\\n\r\n   ^@sequence3number9@\r\n  ?dialoguenumber = 10\r\n   >`@boxPosX@,@boxPosY@,#ffffff,@stanArt@\r\n   >`1,1,#ffffff,\\n\\n\\n\\n\\n\\n\\n\\n\\n\r\n   ^@sequence3number10@\r\n  ?dialoguenumber = 11\r\n   >`@boxPosX@,@boxPosY@,#ffffff,@stanArt@\r\n   >`1,1,#ffffff,\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\r\n   ^@sequence3number11@\r\n  ?dialoguenumber = 12\r\n   SetVarstoZero()\r\n   \r\n   \r\n ?sequence = 4\r\n  >`@boxPosX@,@boxPosY@,#ffffff,@item1@\r\n  ?dialoguenumber = 1\r\n   >`1,1,#ffffff,\r\n   ^@sequence4number1@\r\n  ?dialoguenumber = 2\r\n   >`1,1,#ffffff,\\n\r\n   ^@sequence4number2@\r\n  ?dialoguenumber = 3\r\n   >`1,1,#ffffff,\\n\\n\r\n   ^@sequence4number3@\r\n  ?dialoguenumber = 4\r\n   >`1,1,#ffffff,\\n\\n\\n\r\n   ^@sequence4number4@\r\n  ?dialoguenumber = 5\r\n   SetVarstoZero()\r\n   \r\n ?sequence = 5\r\n  ?dialoguenumber = 1\r\n   >`@boxPosX@,@boxPosY@,#ffffff,@shadyGuyArt@\r\n   >`1,1,#ffffff,\r\n   ^@sequence5number1@\r\n  ?dialoguenumber = 2\r\n   >`@boxPosX@,@boxPosY@,#ffffff,@arvidArt@\r\n   >`1,1,#afafaf,\\n\r\n   ^@sequence5number2@\r\n  ?dialoguenumber = 3\r\n   >`@boxPosX@,@boxPosY@,#ffffff,@shadyGuyArt@\r\n   >`1,1,#ffffff,\\n\\n\r\n   ^@sequence5number3@\r\n  ?dialoguenumber = 4\r\n   >`@boxPosX@,@boxPosY@,#ffffff,@shadyGuyArt@\r\n   >`1,1,#ffffff,\\n\\n\\n\r\n   ^@sequence5number4@\r\n  ?dialoguenumber = 5\r\n   SetVarstoZero()\r\n   \r\n   \r\n   \r\n ?sequence = 6\r\n  ?dialoguenumber = 1\r\n   >`1,1,#afafaf,\r\n   ^@sequence6number1@\r\n  ?dialoguenumber = 2\r\n   >`@boxPosX@,@boxPosY@,#ffffff,@arvidArt@\r\n   >`1,1,#afafaf,\\n\r\n   ^@sequence6number2@\r\n  ?dialoguenumber = 3\r\n   >`@boxPosX@,@boxPosY@,#ffffff,@arvidArt@\r\n   >`1,1,#afafaf,\\n\\n\r\n   ^@sequence6number3@\r\n  ?dialoguenumber = 4\r\n   >`@boxPosX@,@boxPosY@,#ffffff,@item2@\r\n   >`1,1,#afafaf,\\n\\n\\n\r\n   ^@sequence6number4@\r\n  ?dialoguenumber = 5\r\n   >`1,1,#afafaf,\\n\\n\\n\\n\r\n   ^@sequence6number5a@\r\n   ^@item2price@\r\n   ^@sequence6number5b@\r\n  ?dialoguenumber = 6\r\n   SetVarstoZero()\r\n   \r\n   \r\n ?sequence = 7\r\n  ?dialoguenumber = 1\r\n   >`1,1,#ffffff,\r\n   ^@sequence7number1@\r\n  ?dialoguenumber = 2\r\n   >`1,1,#ffffff,\\n\r\n   ^@sequence7number2@\r\n  ?dialoguenumber = 3\r\n   >`1,1,#ffffff,\\n\\n\r\n   ^@sequence7number3@\r\n  ?dialoguenumber = 4\r\n   SetVarstoZero()\r\n\r\n\r\n\r\n ?sequence = 8\r\n  >`@boxPosX@,@boxPosY@,#ffffff,@blakelyArt@\r\n  ?dialoguenumber = 1\r\n   >`1,1,#afafaf,\r\n   ^@sequence8number1@\r\n  ?dialoguenumber = 2\r\n   >`1,1,#afafaf,\\n\r\n   ^@sequence8number2@\r\n  ?dialoguenumber = 3\r\n   >`1,1,#afafaf,\\n\\n\r\n   ^@sequence8number3@\r\n  ?dialoguenumber = 4\r\n   SetVarstoZero()\r\n\r\n\r\n\r\n ?sequence = 9\r\n  >`@boxPosX@,@boxPosY@,#ffffff,@item3@\r\n  ?dialoguenumber = 1\r\n   >`1,1,#afafaf,\r\n   ^@sequence9number1@\r\n  ?dialoguenumber = 2\r\n   >`1,1,#afafaf,\\n\r\n   ^@sequence9number2@\r\n  ?dialoguenumber = 3\r\n   >`1,1,#afafaf,\\n\\n\r\n   ^@sequence9number3@\r\n  ?dialoguenumber = 4\r\n   >`1,1,#afafaf,\\n\\n\\n\r\n   ^@sequence9number4@\r\n  ?dialoguenumber = 5\r\n   SetVarstoZero()\r\n\r\n\r\n\r\n ?sequence = 10\r\n  >`@boxPosX@,@boxPosY@,#ffffff,@blackBoxArt@\r\n  ?dialoguenumber = 1\r\n   >`1,1,#afafaf,\r\n   ^@sequence10number1@\r\n  ?dialoguenumber = 2\r\n   >`1,1,#afafaf,\\n\r\n   ^@sequence10number2@\r\n  ?dialoguenumber = 3\r\n   >`1,1,#afafaf,\\n\\n\r\n   ^@sequence10number3@\r\n  ?dialoguenumber = 4\r\n   dialoguenumber = 1\r\n   sequence++\r\n   dialogueonoff = 0\r\n   ?karma = 0\r\n    sequence = 12\r\n   ?karma > 0\r\n    sequence = 11\r\n\r\n ?sequence = 11\r\n  >`@boxPosX@,@boxPosY@,#ffffff,@walkerArt@\r\n  ?dialoguenumber = 1\r\n   >`1,1,#afafaf,\r\n   ^@sequence11number1@\r\n  ?dialoguenumber = 2\r\n   >`1,1,#afafaf,\\n\r\n   ^@sequence11number2@\r\n  ?dialoguenumber = 3\r\n   >`1,1,#afafaf,\\n\\n\r\n   ^@sequence11number3@\r\n  ?dialoguenumber = 4\r\n   dialoguenumber = 1\r\n   dialogueonoff = 0\r\n   sequence = 13\r\n   \r\n ?sequence = 12\r\n  >`@boxPosX@,@boxPosY@,#ffffff,@shopkeeperArt@\r\n  ?dialoguenumber = 1\r\n   >`1,1,#ffffff,\r\n   ^@sequence12anumber1@\r\n  ?dialoguenumber = 2\r\n   >`1,1,#ffffff,\\n\r\n   ^@sequence12anumber2@\r\n  ?dialoguenumber = 3\r\n   >`1,1,#ffffff,\\n\\n\r\n   ^@sequence12anumber3@\r\n  ?dialoguenumber = 4\r\n   >`1,1,#ffffff,\\n\\n\\n\r\n   ^@sequence12anumber4@\r\n  ?dialoguenumber = 5\r\n   >`1,1,#ffffff,\\n\\n\\n\\n\r\n   ^@sequence1number5@\r\n  ?dialoguenumber = 6\r\n   >`1,1,#ffffff,\\n\\n\\n\\n\\n\r\n   ^@sequence1number6@\r\n  ?dialoguenumber = 7\r\n   >`1,1,#ffffff,\\n\\n\\n\\n\\n\\n\r\n   ^@sequence1number7@\r\n   dialogueonoff = 0\r\n   reward = 1\r\n\r\n ?sequence = 13\r\n  >`@boxPosX@,@boxPosY@,#ffffff,@shadyGuyArt@\r\n  ?dialoguenumber = 1\r\n   >`1,1,#ffffff,\r\n   ^@sequence12bnumber1@\r\n  ?dialoguenumber = 2\r\n   >`1,1,#ffffff,\\n\r\n   ^@sequence12bnumber2@\r\n  ?dialoguenumber = 3\r\n   >`1,1,#ffffff,\\n\\n\r\n   ^@sequence12bnumber3@\r\n  ?dialoguenumber = 4\r\n   >`1,1,#ffffff,\\n\\n\\n\r\n   ^@sequence12bnumber4@\r\n  ?dialoguenumber = 5\r\n   >`1,1,#ffffff,\\n\\n\\n\\n\r\n   ^@sequence12bnumber5@\r\n  ?dialoguenumber = 6\r\n   >`1,1,#ffffff,\\n\\n\\n\\n\\n\r\n   ^@sequence12bnumber6@\r\n  ?dialoguenumber = 7\r\n   >`1,1,#ffffff,\\n\\n\\n\\n\\n\\n\r\n   ^@sequence12bnumber7@\r\n  ?dialoguenumber = 8\r\n   >`1,1,#ffffff,\\n\\n\\n\\n\\n\\n\\n\r\n   ^@sequence12bnumber8@\r\n   dialogueonoff = 0\r\n   reward = 2\r\n\r\n//                                                   help / instructions\r\n// first line\r\nvar keyControlReferenceC = \"[C] Collect Resource\"\r\nvar keyControlReferenceCHighlight = \"#C\"\r\nvar keyControlReferenceX = \"######################[X] Buy Item\"\r\nvar keyControlReferenceXHighlight = \"#######################X\"\r\nvar keyControlReferenceZ = \"####################################[Z] Advance Dialogue\"\r\nvar keyControlReferenceZHighlight = \"#####################################Z\"\r\n\r\n// second line\r\nvar keyControlReferenceShiftX = \"      [Shift+X] Build\"\r\nvar keyControlReferenceShiftXHighlight = \"#######Shift#X\"\r\nvar keyControlReferenceMove = \"#######################[Shift+←/→] Change Location\"\r\nvar keyControlReferenceMoveHighlight = \"########################Shift#←#→\"\r\n\r\n// only show C after it's mentioned\r\n?helpnumber > 0\r\n >`15,@instructionsLine1@,#ffffff,@keyControlReferenceC@\r\n >`15,@instructionsLine1@,#ffff00,@keyControlReferenceCHighlight@\r\n\r\n// only show X after it's mentioned\r\n?gameStage >= 6\r\n >`15,@instructionsLine1@,#ffffff,@keyControlReferenceX@\r\n >`15,@instructionsLine1@,#ffff00,@keyControlReferenceXHighlight@\r\n \r\n // only show Z when dialogue pops up\r\n?dialogueonoff = 1\r\n >`15,@instructionsLine1@,#ffffff,@keyControlReferenceZ@\r\n >`15,@instructionsLine1@,#ffff00,@keyControlReferenceZHighlight@\r\n \r\n // only show Shift+X after buildable becomes available\r\n?itemnext > 0\r\n >`15,@instructionsLine2@,#ffffff,@keyControlReferenceShiftX@\r\n >`15,@instructionsLine2@,#ffff00,@keyControlReferenceShiftXHighlight@\r\n \r\n // only show Shift Arrows after Deadwood is unlocked\r\n?resourcesunlocked > 0\r\n >`15,@instructionsLine2@,#ffffff,@keyControlReferenceMove@\r\n >`15,@instructionsLine2@,#ffff00,@keyControlReferenceMoveHighlight@\r\n \r\n var notificationLine = screen.h - 4\r\n \r\n ?resourcesunlocked = 1 & stones > item1price\r\n  ?shortTermTimer >= 60\r\n   >`10,@notificationLine@,#ffffff,\r\n   ^\"[Shift+X] to use the stones\"\r\n   ?shortTermTimer > 120\r\n    shortTermTimer = 0\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Arena.txt" - Parse error: Failed to parse completely. Remaining: "(\"#########\")\r\nvar corners = ui.AddStyle(\"╔#╗###╚#╝\")\r\n\r\nvar back\r\nvar health\r\nvar maxhealth\r\nvar level\r\nvar xp\r\nvar maxxp\r\nvar xpperc\r\nvar xpbar\r\nvar xpcolor=#rainff\r\nvar floor\r\nvar room\r\nvar inventory = []\r\nvar weapon1=sword\r\nvar weapon2=bow\r\nvar weapon3=magic_book\r\nvar actions=0\r\nvar maxactions=1\r\nvar turn=false\r\nvar turns=0\r\nvar foes = []\r\nvar playerC=7\r\nvar playerR=3\r\nvar upbtn\r\nvar downbtn\r\nvar leftbtn\r\nvar rightbtn\r\nvar uiborders\r\n\r\nvar score=0\r\nvar difficulty=1\r\nvar foecount=0\r\n\r\n//var RoomData=import Games/Rooms\r\n\r\nvar attackbtns=[]\r\nvar meleeattack\r\nvar rangedattack\r\nvar magicattack\r\n\r\nvar damage=0\r\nvar bufftimer=0\r\n\r\nvar inv\r\nvar invbtn\r\nvar invpnl\r\nvar invscreen\r\nvar invopen=false\r\nvar invarray=[[Sword,GreatSword],[Bow,Crossbow],[Staff,Book]] //Melee 0, Ranged 1, Magic 2\r\nvar melee=\"sword\"\r\nvar ranged=\"longbow\"\r\nvar magic=\"staff\"\r\nvar meleeasci\r\nvar rangedasci\r\nvar magicasci\r\nvar meleetxt\r\nvar rangedtxt\r\nvar magictxt\r\nvar meleetab\r\nvar rangedtab\r\nvar magictab\r\nvar invpage=1\r\nvar invbtnsword\r\nvar invbtngreatsword\r\nvar invbtnlongbow\r\nvar invbtncrossbow\r\nvar invbtnstaff\r\nvar invbtnbook\r\n\r\nvar undiscovered=ascii\r\n .-.\r\n  .'\r\n  •\r\nasciiend\r\n\r\nvar sword=ascii\r\n\r\n  ─╣≡≡══──\r\nasciiend\r\n\r\nvar greatsword=ascii\r\n   |________\r\n ─<╣       /\r\n   |¯¯¯¯¯¯¯\r\nasciiend\r\n\r\nvar longbow=ascii\r\n          \r\n   .-´¯`-.\r\n   ¯¯¯¯¯¯¯\r\nasciiend\r\n\r\nvar crossbow=ascii\r\n\r\n    ╤══}\r\nasciiend\r\n\r\nvar staff=ascii\r\n\r\n  -═══════O\r\nasciiend\r\n\r\nvar book=ascii\r\n    _____\r\n   ´\\ .: \\\r\n   '´\\ :' \\\r\nasciiend\r\n\r\nvar arena=ascii\r\nWLWLWLWLWLWLWLWLWLWLWLWLWLWLWLWLWL\r\nWLEMEMEMEMEMEMEMEMEMEMEMEMEMEMEMWL\r\nWLEMEMEMEMEMEMEMEMEMEMEMEMEMEMEMWL\r\nWLEMEMEMEMEMEMEMEMEMEMEMEMEMEMEMWL\r\nWLEMEMEMEMEMEMEMEMEMEMEMEMEMEMEMWL\r\nWLEMEMEMEMEMEMEMMFEMEMEMEMEMEMEMWL\r\nWLEMEMEMEMEMEMEMEMEMEMEMEMEMEMEMWL\r\nWLEMEMEMEMEMEMEMEMEMEMEMEMEMEMEMWL\r\nWLEMEMEMEMEMEMEMPLEMEMEMEMEMEMEMWL\r\nWLEMEMEMEMEMEMEMEMEMEMEMEMEMEMEMWL\r\nWLEMEMEMEMEMEMEMEMEMEMEMEMEMEMEMWL\r\nWLEMEMEMEMEMEMEMEMEMEMEMEMEMEMEMWL\r\nWLEMEMEMEMEMEMEMEMEMEMEMEMEMEMEMWL\r\nWLEMEMEMEMEMEMEMEMEMEMEMEMEMEMEMWL\r\nWLEMEMEMEMEMEMEMMFEMEMEMEMEMEMEMWL\r\nWLEMEMEMEMEMEMEMEMEMEMEMEMEMEMEMWL\r\nWLWLWLWLWLWLWLWLWLWLWLWLWLWLWLWLWL\r\nasciiend\r\n\r\nvar loaded=false\r\n\r\nfunc InventoryScreen()\r\n  invscreen=uiAP()\r\n  invscreen.anchor=top_right\r\n  invscreen.dock=top_right\r\n  invscreen.w=55\r\n  invscreen.h=21\r\n  invscreen.x=-2\r\n  invscreen.y=1\r\n  invpnl=uiAP()\r\n  invpnl.w=55\r\n  invpnl.h=19\r\n  invpnl.y=1\r\n  CreateTabs()\r\n  invscreen.Add(invpnl)\r\n  ShowInventory()\r\n\r\nfunc OpenInventory()\r\n  ?invopen=false\r\n    invopen=true\r\n    InventoryScreen()\r\n  :\r\n    invopen=false\r\n    invpage=1\r\n    invscreen.Recycle()\r\n\r\nfunc CreateTabs()\r\n  meleetab=uiAB()\r\n  meleetab.anchor=top_left\r\n  meleetab.dock=top_left\r\n  meleetab.w=18\r\n  meleetab.h=3\r\n  meleetab.x=0\r\n  meleetab.bcolor=#ffffff\r\n  meleetab.text=te.xt(\"Melee\")\r\n  meleetab.SetPressed(Tabs)\r\n  rangedtab=uiAB()\r\n  rangedtab.anchor=top_left\r\n  rangedtab.dock=top_left\r\n  rangedtab.w=19\r\n  rangedtab.h=3\r\n  rangedtab.x=18\r\n  rangedtab.text=te.xt(\"Ranged\")\r\n  rangedtab.SetPressed(Tabs)\r\n  magictab=uiAB()\r\n  magictab.anchor=top_left\r\n  magictab.dock=top_left\r\n  magictab.w=18\r\n  magictab.h=3\r\n  magictab.x=37\r\n  magictab.text=te.xt(\"Magic\")\r\n  magictab.SetPressed(Tabs)\r\n  //statstab=uiAB()\r\n  //statstab.anchor=top_left\r\n  //statstab.dock=top_left\r\n  //statstab.w=17\r\n  //statstab.h=3\r\n  //statstab.x=51\r\n  //statstab.text=te.xt(\"Stats\")\r\n  //statstab.SetPressed(Tabs)\r\n  invscreen.Add(meleetab)\r\n  invscreen.Add(rangedtab)\r\n  invscreen.Add(magictab)\r\n  //invpnl.Add(statstab)\r\n\r\nfunc Tabs(btn)\r\n  ?btn=meleetab\r\n    invpage=1\r\n    meleetab.bcolor=#ffffff\r\n    rangedtab.bcolor=#808080\r\n    magictab.bcolor=#808080\r\n    //statstab.bcolor=#808080\r\n  :?btn=rangedtab\r\n    invpage=2\r\n    meleetab.bcolor=#808080\r\n    rangedtab.bcolor=#ffffff\r\n    magictab.bcolor=#808080\r\n    //statstab.bcolor=#808080\r\n  :?btn=magictab\r\n    invpage=3\r\n    meleetab.bcolor=#808080\r\n    rangedtab.bcolor=#808080\r\n    magictab.bcolor=#ffffff\r\n    //statstab.bcolor=#808080\r\n  //:?btn=statstab\r\n  //  upgradepage=0\r\n  //  weapontab.bcolor=#808080\r\n  //  towertab.bcolor=#808080\r\n  //  utiltab.bcolor=#808080\r\n  //  statstab.bcolor=#ffffff\r\n  ShowInventory()\r\n\r\nfunc Select(btn)\r\n  ?btn.text=\"Great Sword\"\r\n    melee=\"greatsword\"\r\n    meleetxt.text=\"Great Sword\"\r\n    meleeasci.Load(greatsword)\r\n  :?btn.text=\"Sword\"\r\n    melee=\"sword\"\r\n    meleetxt.text=\"Sword\"\r\n    meleeasci.Load(sword)\r\n  :?btn.text=\"Long Bow\"\r\n    ranged=\"longbow\"\r\n    rangedtxt.text=\"Long Bow\"\r\n    rangedasci.Load(longbow)\r\n  :?btn.text=\"Crossbow\"\r\n    ranged=\"crossbow\"\r\n    rangedtxt.text=\"Crossbow\"\r\n    rangedasci.Load(crossbow)\r\n  :?btn.text=\"Staff\"\r\n    magic=\"staff\"\r\n    magictxt.text=\"Staff\"\r\n    magicasci.Load(staff)\r\n  :?btn.text=\"Book\"\r\n    magic=\"book\"\r\n    magictxt.text=\"Book\"\r\n    magicasci.Load(book)\r\n\r\nfunc CreateInventoryBtn(x,y,text,anim)\r\n  var panel=uiAP()\r\n  panel.anchor=top_left\r\n  panel.dock=top_left\r\n  panel.x=x\r\n  panel.y=y\r\n  panel.h=6\r\n  panel.w=17\r\n  var button=uiAB()\r\n  button.anchor=top_left\r\n  button.dock=top_left\r\n  button.h=6\r\n  button.w=17\r\n  button.text=text\r\n  button.tcolor=#010101\r\n  button.SetPressed(Select)\r\n  var txt=uiAT()\r\n  txt.anchor=top_left\r\n  txt.dock=top_left\r\n  txt.x=1\r\n  txt.y=1\r\n  txt.h=2\r\n  txt.w=15\r\n  txt.align=center\r\n  txt.text=te.xt(text)\r\n  //var temp=text+asci\r\n  //temp=string.Split(temp,true)\r\n  //temp=string.Join(\"\",temp)\r\n  //temp=string.ToLower(temp)\r\n  var asci=uiAA(anim)\r\n  asci.anchor=top_left\r\n  asci.dock=top_left\r\n  asci.x=2\r\n  asci.y=2\r\n  panel.Add(button)\r\n  panel.Add(asci)\r\n  panel.Add(txt)\r\n  return [panel,button,txt,asci]\r\n\r\nfunc ShowInventory()\r\n  invpnl.Clear()\r\n  //?upgradepage=0  //Stats\r\n  //  stattxt1=uiAT()\r\n  //  stattxt1.anchor=top_left\r\n  //  stattxt1.dock=top_left\r\n  //  stattxt1.w=24\r\n  //  stattxt1.h=19\r\n  //  stattxt1.y=1\r\n  //  stattxt1.x=1\r\n  //  upgradepnl.Add(stattxt1)\r\n  //  stattxt2=uiAT()\r\n  //  stattxt2.anchor=top_left\r\n  //  stattxt2.dock=top_left\r\n  //  stattxt2.w=24\r\n  //  stattxt2.h=19\r\n  //  stattxt2.y=1\r\n  //  stattxt2.x=26\r\n  //  upgradepnl.Add(stattxt2)\r\n  //  Stats()\r\n  ?invpage=1  //Melee Weapons\r\n    invbtnsword=CreateInventoryBtn(1,1,\"Sword\",sword)\r\n    invpnl.Add(invbtnsword[0])\r\n    invbtngreatsword=CreateInventoryBtn(18,1,\"Great Sword\",greatsword)\r\n    invpnl.Add(invbtngreatsword[0])\r\n    //invbtnlongbow=CreateInventoryBtn(35,1,\"Long Bow\",longbow)\r\n    //invpnl.Add(invbtnlongbow[0])\r\n  :?invpage=2  //Ranged Weapons\r\n    invbtnlongbow=CreateInventoryBtn(1,1,\"Long Bow\",longbow)\r\n    invpnl.Add(invbtnlongbow[0])\r\n    invbtncrossbow=CreateInventoryBtn(18,1,\"Crossbow\",crossbow)\r\n    invpnl.Add(invbtncrossbow[0])\r\n  :?invpage=3  //Magic Weapons\r\n    invbtnstaff=CreateInventoryBtn(1,1,\"Staff\",staff)\r\n    invpnl.Add(invbtnstaff[0])\r\n    invbtnbook=CreateInventoryBtn(18,1,\"Book\",book)\r\n    invpnl.Add(invbtnbook[0])\r\n  :?invpage=4\r\n    >effects\r\n\r\nvar uiback=ascii\r\n                             ╔═══════════════════════════════════════════════════════╗ \r\n┌───────────┬───────────────┐║#######################################################║ \r\n                             ║#######################################################║ \r\n                             ║#######################################################║ \r\n            ├───────────────┤║#######################################################║ \r\n                             ║#######################################################║ \r\n╞═══════════╪═══════════════╡║#######################################################║ \r\n                             ║#######################################################║ \r\n                             ║#######################################################║ \r\n            ├───────────────┤║#######################################################║ \r\n                             ║#######################################################║ \r\n╞═══════════╪═══════════════╡║#######################################################║ \r\n                             ║#######################################################║ \r\n                             ║#######################################################║ \r\n            ├───────────────┤║#######################################################║ \r\n                             ║#######################################################║ \r\n└───────────┴───────────────┘║#######################################################║ \r\n┌──────┬──────┬──────┬──────┐║#######################################################║ \r\n│      │      │      │      │║#######################################################║ \r\n│      │      │      │      │║#######################################################║ \r\n│      │      │      │      │║#######################################################║ \r\n└──────┴──────┴──────┴──────┘║#######################################################║ \r\n┌─────────────┬─────────────┐╚═══════════════════════════════════════════════════════╝ \r\n│             │             │                                                          \r\n└─────────────┴─────────────┘                                                          \r\n                                                                                       \r\nasciiend\r\n\r\n/*\r\n┌───────────┬───────────────┐\r\n Bone GreatS  EarthSplitter \r\n   |_______       Ready     \r\n -<       .´├───────────────┤\r\n   |´`´`´`     Weapon Info\r\n╞═══════════╪═══════════════╡\r\n     Bow         Ability    \r\n               Unavailable  \r\n   .-´¯`-.  ├───────────────┤\r\n   ¯¯¯¯¯¯¯     Weapon Info\r\n╞═══════════╪═══════════════╡\r\n    Staff         Spell     \r\n              Cooldown: 3/5 \r\n  -═══════O ├───────────────┤\r\n               Weapon Info\r\n└───────────┴───────────────┘\r\n*/\r\n\r\nvar empty=ascii\r\n╔   ╗\r\n     \r\n╚   ╝\r\nasciiend\r\n\r\nvar player_=ascii\r\n#.-.\r\n(   )\r\n#`-´\r\nasciiend\r\n\r\nvar foe_=ascii\r\n#.-.#\r\n(   )\r\n#`-´#\r\nasciiend\r\n\r\nvar wood=ascii\r\n###.\r\n._/-\r\n#/\r\nasciiend\r\n\r\nvar heal=ascii\r\n  █\r\n█████\r\n  █  \r\nasciiend\r\n\r\nvar strength=ascii\r\n  _\r\n( | )\r\n  ¯\r\nasciiend\r\n\r\nvar speed=ascii\r\n  ──O\r\n──</V\r\n──/>\r\nasciiend\r\n\r\nvar Test=ascii\r\nYeet\r\nasciiend\r\n\r\nvar wall=ascii\r\n█████\r\n█████\r\n█████\r\nasciiend\r\n\r\nfunc AttackMelee(btn)\r\n  var C=(btn.x/5)\r\n  var R=(btn.y/3)\r\n  ?meleetxt.text=\"Great Sword\"\r\n    ?roomarray[C][R][0].Count()>0\r\n      ?roomarray[C][R][0][0]=\"foe\"\r\n        roomarray[C][R][0][3]=roomarray[C][R][0][3]-(level+damage)*1.25\r\n    ?roomarray[C-1][R][0].Count()>0 //Right\r\n      ?roomarray[C-1][R][0][0]=\"player\"\r\n        ?roomarray[C][R+1][0].Count()>0\r\n          ?roomarray[C][R+1][0][0]=\"foe\"\r\n            roomarray[C][R+1][0][3]=roomarray[C][R+1][0][3]-(level+damage)*1.25\r\n        ?roomarray[C][R-1][0].Count()>0\r\n          ?roomarray[C][R-1][0][0]=\"foe\"\r\n            roomarray[C][R-1][0][3]=roomarray[C][R-1][0][3]-(level+damage)*1.25\r\n    ?roomarray[C+1][R][0].Count()>0 //Left\r\n      ?roomarray[C+1][R][0][0]=\"player\"\r\n        ?roomarray[C][R+1][0].Count()>0\r\n          ?roomarray[C][R+1][0][0]=\"foe\"\r\n            roomarray[C][R+1][0][3]=roomarray[C][R+1][0][3]-(level+damage)*1.25\r\n        ?roomarray[C][R-1][0].Count()>0\r\n          ?roomarray[C][R-1][0][0]=\"foe\"\r\n            roomarray[C][R-1][0][3]=roomarray[C][R-1][0][3]-(level+damage)*1.25\r\n    ?roomarray[C][R-1][0].Count()>0 //Down\r\n      ?roomarray[C][R-1][0][0]=\"player\"\r\n        ?roomarray[C+1][R][0].Count()>0\r\n          ?roomarray[C+1][R][0][0]=\"foe\"\r\n            roomarray[C+1][R][0][3]=roomarray[C+1][R][0][3]-(level+damage)*1.25\r\n        ?roomarray[C-1][R][0].Count()>0\r\n          ?roomarray[C-1][R][0][0]=\"foe\"\r\n            roomarray[C-1][R][0][3]=roomarray[C-1][R][0][3]-(level+damage)*1.25\r\n    ?roomarray[C][R+1][0].Count()>0 //Up\r\n      ?roomarray[C][R+1][0][0]=\"player\"\r\n        ?roomarray[C+1][R][0].Count()>0\r\n          ?roomarray[C+1][R][0][0]=\"foe\"\r\n            roomarray[C+1][R][0][3]=roomarray[C+1][R][0][3]-(level+damage)*1.25\r\n        ?roomarray[C-1][R][0].Count()>0\r\n          ?roomarray[C-1][R][0][0]=\"foe\"\r\n            roomarray[C-1][R][0][3]=roomarray[C-1][R][0][3]-(level+damage)*1.25\r\n  :?meleetxt.text=\"Sword\"\r\n    ?roomarray[C][R][0].Count()>0\r\n      ?roomarray[C][R][0][0]=\"foe\"\r\n        roomarray[C][R][0][3]=roomarray[C][R][0][3]-(level+damage)*1.5\r\n  for A : attackbtns\r\n    A.Recycle()\r\n  attackbtns.Clear()\r\n  actions++\r\n\r\nfunc AttackRanged(btn)\r\n  var C=(btn.x/5)\r\n  var R=(btn.y/3)\r\n  var pierce=0\r\n  var maxpierce=1\r\n  var mult=1.25\r\n  ?rangedtxt.text=\"Crossbow\"\r\n    maxpierce=2\r\n    mult=1\r\n  ?roomarray[C-1][R][0].Count()>0 //Right\r\n    ?roomarray[C-1][R][0][0]=\"player\"\r\n      for A = C..16\r\n        ?roomarray[A][R][0].Count()>0\r\n          ?roomarray[A][R][0][0]=\"foe\"\r\n            roomarray[A][R][0][3]=roomarray[A][R][0][3]-(level+damage)*mult\r\n            pierce++\r\n            ?pierce=maxpierce\r\n              break\r\n  ?roomarray[C+1][R][0].Count()>0 //Left\r\n    ?roomarray[C+1][R][0][0]=\"player\"\r\n      for A = C..0\r\n        ?roomarray[A][R][0].Count()>0\r\n          ?roomarray[A][R][0][0]=\"foe\"\r\n            roomarray[A][R][0][3]=roomarray[A][R][0][3]-(level+damage)*mult\r\n            pierce++\r\n            ?pierce=maxpierce\r\n              break\r\n  ?roomarray[C][R-1][0].Count()>0 //Down\r\n    ?roomarray[C][R-1][0][0]=\"player\"\r\n      for A = R..16\r\n        ?roomarray[C][A][0].Count()>0\r\n          ?roomarray[C][A][0][0]=\"foe\"\r\n            roomarray[C][A][0][3]=roomarray[C][A][0][3]-(level+damage)*mult\r\n            pierce++\r\n            ?pierce=maxpierce\r\n              break\r\n  ?roomarray[C][R+1][0].Count()>0 //Up\r\n    ?roomarray[C][R+1][0][0]=\"player\"\r\n      for A = R..0\r\n        ?roomarray[C][A][0].Count()>0\r\n          ?roomarray[C][A][0][0]=\"foe\"\r\n            roomarray[C][A][0][3]=roomarray[C][A][0][3]-(level+damage)*mult\r\n            pierce++\r\n            ?pierce=maxpierce\r\n              break\r\n  for A : attackbtns\r\n    A.Recycle()\r\n  attackbtns.Clear()\r\n  actions++\r\n\r\nfunc AttackMagic(btn)\r\n  var C=(btn.x/5)\r\n  var R=(btn.y/3)\r\n  ?magictxt.text=\"Staff\"\r\n    ?roomarray[C][R][0].Count()>0\r\n      ?roomarray[C][R][0][0]=\"foe\"\r\n        roomarray[C][R][0][3]=roomarray[C][R][0][3]-(level+damage)\r\n  ?magictxt.text=\"Book\"\r\n    ?roomarray[C][R][0].Count()>0\r\n      ?roomarray[C][R][0][0]=\"foe\"\r\n        roomarray[C][R][0][3]=roomarray[C][R][0][3]-(level+damage)*0.75\r\n    ?roomarray[C-1][R][0].Count()>0\r\n      ?roomarray[C-1][R][0][0]=\"foe\"\r\n        roomarray[C-1][R][0][3]=roomarray[C-1][R][0][3]-(level+damage)*0.75\r\n    ?roomarray[C+1][R][0].Count()>0\r\n      ?roomarray[C+1][R][0][0]=\"foe\"\r\n        roomarray[C+1][R][0][3]=roomarray[C+1][R][0][3]-(level+damage)*0.75\r\n    ?roomarray[C][R-1][0].Count()>0\r\n      ?roomarray[C][R-1][0][0]=\"foe\"\r\n        roomarray[C][R-1][0][3]=roomarray[C][R-1][0][3]-(level+damage)*0.75\r\n    ?roomarray[C][R+1][0].Count()>0\r\n      ?roomarray[C][R+1][0][0]=\"foe\"\r\n        roomarray[C][R+1][0][3]=roomarray[C][R+1][0][3]-(level+damage)*0.75\r\n  for A : attackbtns\r\n    A.Recycle()\r\n  attackbtns.Clear()\r\n  actions++\r\n\r\nfunc AttackCell(cellc,cellr,attacktype)\r\n  var btn=uiAB()\r\n  btn.dock=top_left\r\n  btn.anchor=top_left\r\n  btn.h=3\r\n  btn.w=5\r\n  btn.x=5*cellc\r\n  btn.y=3*cellr\r\n  btn.text=\"\"\r\n  btn.style=corners\r\n  btn.SetPressed(attacktype)\r\n  roompnl.Add(btn)\r\n  return btn\r\n  \r\nfunc AttackMeleeStart()\r\n  attackbtns.Add(AttackCell(playerC+1,playerR,AttackMelee))\r\n  attackbtns.Add(AttackCell(playerC-1,playerR,AttackMelee))\r\n  attackbtns.Add(AttackCell(playerC,playerR+1,AttackMelee))\r\n  attackbtns.Add(AttackCell(playerC,playerR-1,AttackMelee))\r\n\r\nfunc AttackRangedStart()\r\n  attackbtns.Add(AttackCell(playerC+1,playerR,AttackRanged))\r\n  attackbtns.Add(AttackCell(playerC-1,playerR,AttackRanged))\r\n  attackbtns.Add(AttackCell(playerC,playerR+1,AttackRanged))\r\n  attackbtns.Add(AttackCell(playerC,playerR-1,AttackRanged))\r\n\r\nfunc AttackMagicStart()\r\n  for c = 0..roomarray.Count()-1\r\n    for r = 0..roomarray[c].Count()-1\r\n      ?roomarray[c][r][0].Count()>0\r\n        ?roomarray[c][r][0][0]=\"foe\"\r\n          attackbtns.Add(AttackCell(c,r,AttackMagic))\r\n\r\n//func CreateFoe(type)\r\n//  return \"foe\",false\r\nfunc FoeTurn()\r\n  room=2\r\nfunc PlayerTurn()\r\n  room=3\r\nfunc Save()\r\n  storage.Set(\"level\",level)\r\n  storage.Set(\"xp\",xp)\r\n\r\nvar roomarray=[]\r\nvar showarray=[]\r\nvar floorarray=[]\r\nvar roompnl\r\n\r\nfunc FoeActions()\r\n  for c = 0..roomarray.Count()-1\r\n    for r = 0..roomarray[c].Count()-1\r\n      ?roomarray[c][r][0].Count()>0\r\n        ?roomarray[c][r][0][0]=\"foe\"&roomarray[c][r][0][1]=false\r\n          roomarray[c][r][0][1]=true\r\n          ?roomarray[c][r][0][3]<=0\r\n            roomarray[c][r][0].Clear()\r\n            xp++\r\n            continue\r\n          ?roomarray[c-1][r][0].Count()>0\r\n            ?roomarray[c-1][r][0][0]=\"player\"\r\n              health--\r\n              continue\r\n          ?roomarray[c][r-1][0].Count()>0\r\n            ?roomarray[c][r-1][0][0]=\"player\"\r\n              health--\r\n              continue\r\n          ?roomarray[c+1][r][0].Count()>0\r\n            ?roomarray[c+1][r][0][0]=\"player\"\r\n              health--\r\n              continue\r\n          ?roomarray[c][r+1][0].Count()>0\r\n            ?roomarray[c][r+1][0][0]=\"player\"\r\n              health--\r\n              continue\r\n          var foedata=[]\r\n          for d = 0..roomarray[c][r][0].Count()-1\r\n            foedata.Add(roomarray[c][r][0][d])\r\n          roomarray[c][r][0].Clear()\r\n          ?c>playerC&roomarray[c-1][r][0].Count()=0\r\n            for d = 0..foedata.Count()-1\r\n              roomarray[c-1][r][0].Add(foedata[d])\r\n          :?c<playerC&roomarray[c+1][r][0].Count()=0\r\n            for d = 0..foedata.Count()-1\r\n              roomarray[c+1][r][0].Add(foedata[d])\r\n          :?r>playerR&roomarray[c][r-1][0].Count()=0\r\n            for d = 0..foedata.Count()-1\r\n              roomarray[c][r-1][0].Add(foedata[d])\r\n          :?r<playerR&roomarray[c][r+1][0].Count()=0\r\n            for d = 0..foedata.Count()-1\r\n              roomarray[c][r+1][0].Add(foedata[d])\r\n          :\r\n            for d = 0..foedata.Count()-1\r\n              roomarray[c][r][0].Add(foedata[d])\r\n           \r\n  for c = 0..roomarray.Count()-1\r\n    for r = 0..roomarray[c].Count()-1\r\n      ?roomarray[c][r][0].Count()>0\r\n        ?roomarray[c][r][0][0]=\"foe\"\r\n          roomarray[c][r][0][1]=false\r\n\r\nfunc AddFoe()\r\n  var c=rng%17\r\n  var r=rng%17\r\n  ?roomarray[c][r][0].Count()=0\r\n    roomarray[c][r][0].Add(\"foe\",false,\"melee\",5*difficulty)\r\n    foecount--\r\n\r\nfunc AddBuff()\r\n  var c=rng%17\r\n  var r=rng%17\r\n  var random=rng%3\r\n  ?roomarray[c][r][1].Count()=0\r\n    ?random=0\r\n      roomarray[c][r][1].Add(\"heal\")\r\n    :?random=1\r\n      roomarray[c][r][1].Add(\"strength\")\r\n    :\r\n      roomarray[c][r][1].Add(\"speed\")\r\n\r\n//\r\n//func AddHarvest(c,r)\r\n//  roomarray[c][r][1].Add(\"wood\")\r\n//\r\n//func AddPickup(c,r)\r\n//  roomarray[c][r][2].Add(\"test\")\r\n//\r\n//func AddWall(c,r)\r\n//  roomarray[c][r][0].Add(\"wall\")\r\n\r\nfunc BtnMovePlayer(btn)\r\n  ?!invopen\r\n    roomarray[playerC][playerR][0].Clear()\r\n    ?btn=leftbtn&playerC>0\r\n      ?roomarray[playerC-1][playerR][0].Count()=0\r\n        playerC--\r\n        ?playerC>4&playerC<11\r\n          roompnl.x=roompnl.x+5\r\n    ?btn=upbtn&playerR>0\r\n      ?roomarray[playerC][playerR-1][0].Count()=0\r\n        playerR--\r\n        ?playerR>2&playerR<13\r\n          roompnl.y=roompnl.y+3\r\n    ?btn=rightbtn&playerC<16\r\n      ?roomarray[playerC+1][playerR][0].Count()=0\r\n        playerC++\r\n        ?playerC<12&playerC>5\r\n          roompnl.x=roompnl.x-5\r\n    ?btn=downbtn&playerR<16\r\n      ?roomarray[playerC][playerR+1][0].Count()=0\r\n        playerR++\r\n        ?playerR<14&playerR>3\r\n          roompnl.y=roompnl.y-3\r\n    roomarray[playerC][playerR][0].Add(\"player\")\r\n    Grab()\r\n    DisplayRoom()\r\n    actions++\r\n\r\nfunc MovePlayer()\r\n  ?key=leftBegin&playerC>0\r\n    ?roomarray[playerC-1][playerR][0].Count()=0\r\n      roomarray[playerC][playerR][0].Clear()\r\n      playerC--\r\n      roomarray[playerC][playerR][0].Add(\"player\")\r\n      ?playerC>4&playerC<11\r\n        roompnl.x=roompnl.x+5\r\n    Grab()\r\n    DisplayRoom()\r\n    actions++\r\n  ?key=upBegin&playerR>0\r\n    ?roomarray[playerC][playerR-1][0].Count()=0\r\n      roomarray[playerC][playerR][0].Clear()\r\n      playerR--\r\n      roomarray[playerC][playerR][0].Add(\"player\")\r\n      ?playerR>2&playerR<13\r\n        roompnl.y=roompnl.y+3\r\n    Grab()\r\n    DisplayRoom()\r\n    actions++\r\n  ?key=rightBegin&playerC<16\r\n    ?roomarray[playerC+1][playerR][0].Count()=0\r\n      roomarray[playerC][playerR][0].Clear()\r\n      playerC++\r\n      roomarray[playerC][playerR][0].Add(\"player\")\r\n      ?playerC<12&playerC>5\r\n        roompnl.x=roompnl.x-5\r\n    Grab()\r\n    DisplayRoom()\r\n    actions++\r\n  ?key=downBegin&playerR<16\r\n    ?roomarray[playerC][playerR+1][0].Count()=0\r\n      roomarray[playerC][playerR][0].Clear()\r\n      playerR++\r\n      roomarray[playerC][playerR][0].Add(\"player\")\r\n      ?playerR<14&playerR>3\r\n        roompnl.y=roompnl.y-3\r\n    Grab()\r\n    DisplayRoom()\r\n    actions++\r\n\r\n/*func InitilizeFloor()\r\n  for c = 0..16\r\n    roomarray.Add([]) //Add Columns\r\n    for r = 0..16\r\n      roomarray[c].Add([]) //Add Rowa\r\n  floorarray[0][0].Add(RoomData.emptyroom)\r\n  floorarray[1][0].Add(RoomData.emptyroom)\r\n*/\r\nfunc MoveRooms()\r\n  >yeet\r\n\r\nfunc CreateCell(c,r,type)\r\n  var cell=uiAA(type)\r\n  cell.anchor=top_left\r\n  cell.dock=top_left\r\n  cell.x=c*5\r\n  cell.y=r*3\r\n  ?type=player_\r\n    cell.color=#cyan\r\n  :?type=foe_\r\n    cell.color=#red\r\n  :?type=heal\r\n    cell.color=#green\r\n  :?type=strength\r\n    cell.color=#magenta\r\n  :?type=speed\r\n    cell.color=#yellow\r\n  roompnl.Add(cell)\r\n  return cell\r\n\r\nfunc InitilizeRoom()\r\n  for c = 0..16\r\n    roomarray.Add([]) //Add columns\r\n    for r = 0..16\r\n      roomarray[c].Add([[],[],[]]) //Add Rows and foe/player, harvest/exit, and pickup slots\r\n  var ccount=0\r\n  var rcount=0\r\n  var datapos=0\r\n  for cellcount = 0..(17*17)-1\r\n    var celldata\r\n    celldata=string.Sub(arena, datapos, 2)\r\n    ?celldata=\"EM\"\r\n      //showarray.Add(CreateCell(ccount,rcount,empty))\r\n      roomarray[ccount][rcount][1].Add(\"\")\r\n    :?celldata=\"PL\"\r\n      playerC=ccount\r\n      playerR=rcount\r\n      roomarray[playerC][playerR][0].Add(\"player\")\r\n      showarray.Add(CreateCell(playerC,playerR,player_))\r\n    :?celldata=\"MF\"\r\n      roomarray[ccount][rcount][0].Add(\"foe\",false,\"melee\",5*difficulty)\r\n      showarray.Add(CreateCell(ccount,rcount,foe_))\r\n    :?celldata=\"WH\"\r\n      roomarray[ccount][rcount][1].Add(\"wood\")\r\n    :?celldata=\"WL\"\r\n      roomarray[ccount][rcount][0].Add(\"wall\")\r\n      showarray.Add(CreateCell(ccount,rcount,wall))\r\n    :?celldata=\"EX\"\r\n      roomarray[ccount][rcount][2].Add(\"exit\")\r\n    datapos=datapos+2\r\n    ccount++\r\n    ?ccount>16\r\n      ccount=0\r\n      rcount++\r\n      datapos=datapos+2\r\n\r\nfunc DisplayRoom()\r\n  ?showarray.Count()>0\r\n    roompnl.Clear()\r\n    showarray.Clear()\r\n  ?roomarray.Count()>0\r\n    for c = 0..roomarray.Count()-1\r\n      for r = 0..roomarray[c].Count()-1\r\n        ?roomarray[c][r][0].Count()>0\r\n          ?roomarray[c][r][0][0]=\"player\"\r\n            showarray.Add(CreateCell(playerC,playerR,player_))\r\n          :?roomarray[c][r][0][0]=\"foe\"\r\n            showarray.Add(CreateCell(c,r,foe_))\r\n          :?roomarray[c][r][0][0]=\"wall\"\r\n            showarray.Add(CreateCell(c,r,wall))\r\n        :?roomarray[c][r][1].Count()>0\r\n          ?roomarray[c][r][1][0]=\"heal\"\r\n            showarray.Add(CreateCell(c,r,heal))\r\n          :?roomarray[c][r][1][0]=\"strength\"\r\n            showarray.Add(CreateCell(c,r,strength))\r\n          :?roomarray[c][r][1][0]=\"speed\"\r\n            showarray.Add(CreateCell(c,r,speed))\r\n        :?roomarray[c][r][2].Count()>0\r\n          ?roomarray[c][r][2][0]=\"test\"\r\n            >`@30+5*c@,@1+3*r@,#green,@test@\r\n          :?roomarray[c][r][2][0]=\"exit\"\r\n            >`@30+5*c@,@1+3*r@,#yellow,@empty@\r\n        //:\r\n          //showarray.Add(CreateCell(c,r,empty))\r\n\r\nfunc Grab()\r\n  ?roomarray[playerC][playerR][1].Count()>0\r\n    ?roomarray[playerC][playerR][1][0]=\"heal\"\r\n      health=health+5\r\n    :?roomarray[playerC][playerR][1][0]=\"strength\"\r\n      damage++\r\n    :?roomarray[playerC][playerR][1][0]=\"speed\"\r\n      maxactions=2\r\n      bufftimer=5\r\n    roomarray[playerC][playerR][1].Clear()\r\n\r\nvar deathtxt\r\nvar stattxt\r\nvar deathpnl\r\nvar retrybtn\r\n\r\nfunc Restart()\r\n  level=1\r\n  xp=0\r\n  damage=0\r\n  health=maxhealth\r\n  roompnl.x=30-3*5\r\n  roompnl.y=1-5*3\r\n  roompnl.Clear()\r\n  roomarray.Clear()\r\n  showarray.Clear()\r\n  floorarray.Clear()\r\n  InitilizeRoom()\r\n  deathpnl.Recycle()\r\n\r\nfunc DeathScreen()\r\n  deathpnl=uiAP()\r\n  deathpnl.anchor=top_right\r\n  deathpnl.dock=top_right\r\n  deathpnl.w=55\r\n  deathpnl.h=21\r\n  deathpnl.x=-2\r\n  deathpnl.y=1\r\n  deathtxt=uiAT(\"You have been defeated!\")\r\n  deathtxt.w=53\r\n  deathtxt.h=3\r\n  deathtxt.y=-2\r\n  deathtxt.align=center\r\n  deathpnl.Add(deathtxt)\r\n  stattxt=uiAT(\"Score:\"+score+\"   Turns Survived:\"+turns)\r\n  stattxt.w=53\r\n  stattxt.h=3\r\n  stattxt.x=0\r\n  stattxt.y=0\r\n  stattxt.align=center\r\n  deathpnl.Add(stattxt)\r\n  retrybtn=uiAB()\r\n  retrybtn.y=2\r\n  retrybtn.text=\"Retry?\"\r\n  retrybtn.SetPressed(Restart)\r\n  deathpnl.Add(retrybtn)\r\n\r\nfunc CreateUI()\r\n  //Room\r\n  roompnl=uiAP()\r\n  roompnl.anchor=top_left\r\n  roompnl.dock=top_left\r\n  roompnl.x=30-3*5\r\n  roompnl.y=1-5*3\r\n  roompnl.style=invis\r\n  //UI\r\n  uiborders=uiAA(uiback)\r\n  uiborders.anchor=top_left\r\n  uiborders.dock=top_left\r\n  uiborders.color=#808080\r\n  //Inventory Button\r\n  invbtn=uiAB()\r\n  invbtn.style=invis\r\n  invbtn.anchor=bottom_left\r\n  invbtn.dock=bottom_left\r\n  invbtn.x=1\r\n  invbtn.y=-2\r\n  invbtn.w=13\r\n  invbtn.h=3\r\n  invbtn.text=te.xt(\"Inventory\")\r\n  invbtn.SetPressed(OpenInventory)\r\n  //Move Buttons\r\n  leftbtn=uiAB()\r\n  leftbtn.anchor=top_left\r\n  leftbtn.dock=top_left\r\n  leftbtn.x=1\r\n  leftbtn.y=18\r\n  leftbtn.w=6\r\n  leftbtn.h=3\r\n  leftbtn.text=\"\"\r\n  leftbtn.style=invis\r\n  leftbtn.SetPressed(BtnMovePlayer)\r\n  upbtn=uiAB()\r\n  upbtn.anchor=top_left\r\n  upbtn.dock=top_left\r\n  upbtn.x=8\r\n  upbtn.y=18\r\n  upbtn.w=6\r\n  upbtn.h=3\r\n  upbtn.text=\"\"\r\n  upbtn.style=invis\r\n  upbtn.SetPressed(BtnMovePlayer)\r\n  downbtn=uiAB()\r\n  downbtn.anchor=top_left\r\n  downbtn.dock=top_left\r\n  downbtn.x=15\r\n  downbtn.y=18\r\n  downbtn.w=6\r\n  downbtn.h=3\r\n  downbtn.text=\"\"\r\n  downbtn.style=invis\r\n  downbtn.SetPressed(BtnMovePlayer)\r\n  rightbtn=uiAB()\r\n  rightbtn.anchor=top_left\r\n  rightbtn.dock=top_left\r\n  rightbtn.x=22\r\n  rightbtn.y=18\r\n  rightbtn.w=6\r\n  rightbtn.h=3\r\n  rightbtn.text=\"\"\r\n  rightbtn.style=invis\r\n  rightbtn.SetPressed(BtnMovePlayer)\r\n  //Weapon Buttons\r\n  meleetxt=uiAT(\"Sword\")\r\n  meleetxt.anchor=top_left\r\n  meleetxt.dock=top_left\r\n  meleetxt.w=11\r\n  meleetxt.h=4\r\n  meleetxt.x=1\r\n  meleetxt.y=2\r\n  meleetxt.align=center\r\n  meleeasci=uiAA(sword)\r\n  meleeasci.anchor=top_left\r\n  meleeasci.dock=top_left\r\n  meleeasci.x=0\r\n  meleeasci.y=3\r\n  meleeattack=uiAB()\r\n  meleeattack.anchor=top_left\r\n  meleeattack.dock=top_left\r\n  meleeattack.w=11\r\n  meleeattack.h=4\r\n  meleeattack.x=1\r\n  meleeattack.y=2\r\n  meleeattack.text=\"\"\r\n  meleeattack.style=invis\r\n  meleeattack.SetPressed(AttackMeleeStart)\r\n  rangedtxt=uiAT(\"Long Bow\")\r\n  rangedtxt.anchor=top_left\r\n  rangedtxt.dock=top_left\r\n  rangedtxt.w=11\r\n  rangedtxt.h=4\r\n  rangedtxt.x=1\r\n  rangedtxt.y=7\r\n  rangedtxt.align=center\r\n  rangedasci=uiAA(longbow)\r\n  rangedasci.anchor=top_left\r\n  rangedasci.dock=top_left\r\n  rangedasci.x=0\r\n  rangedasci.y=8\r\n  rangedattack=uiAB()\r\n  rangedattack.anchor=top_left\r\n  rangedattack.dock=top_left\r\n  rangedattack.w=11\r\n  rangedattack.h=4\r\n  rangedattack.x=1\r\n  rangedattack.y=7\r\n  rangedattack.text=\"\"\r\n  rangedattack.style=invis\r\n  rangedattack.SetPressed(AttackRangedStart)\r\n  magictxt=uiAT(\"Staff\")\r\n  magictxt.anchor=top_left\r\n  magictxt.dock=top_left\r\n  magictxt.w=11\r\n  magictxt.h=4\r\n  magictxt.x=1\r\n  magictxt.y=12\r\n  magictxt.align=center\r\n  magicasci=uiAA(staff)\r\n  magicasci.anchor=top_left\r\n  magicasci.dock=top_left\r\n  magicasci.x=0\r\n  magicasci.y=13\r\n  magicattack=uiAB()\r\n  magicattack.anchor=top_left\r\n  magicattack.dock=top_left\r\n  magicattack.w=11\r\n  magicattack.h=4\r\n  magicattack.x=1\r\n  magicattack.y=12\r\n  magicattack.text=\"\"\r\n  magicattack.style=invis\r\n  magicattack.SetPressed(AttackMagicStart)\r\n\r\n?loc=\"waterfall\"\r\n  ?!loaded\r\n    level=storage.Get(\"level\",1)\r\n    xp=storage.Get(\"xp\",0)\r\n    maxhealth=15+level*5\r\n    maxxp=level*2\r\n    xpperc=(xp*100)/maxxp\r\n    back=ui.AddCanvas()\r\n    back.w=screen.w\r\n    back.h=screen.h\r\n    back.Set(\" \")\r\n    health=maxhealth\r\n    //AddPickup(3,4)\r\n    CreateUI()\r\n    InitilizeRoom()\r\n    loaded=true\r\n    \r\n  ?!invopen\r\n    //DisplayRoom()\r\n    MovePlayer()\r\n  ?actions>=maxactions\r\n    turn=true\r\n  ?turn\r\n    FoeActions()\r\n    ?xp>=maxxp\r\n      level++\r\n      xp=xp-maxxp\r\n      health=health+5\r\n    DisplayRoom()\r\n    turns++\r\n    ?turns%50=0\r\n      difficulty++\r\n    ?turns%5=0\r\n      foecount=1+math.FloorToInt(difficulty/5)\r\n    ?rng%2=0\r\n      AddBuff()\r\n    ?bufftimer>0\r\n      bufftimer--\r\n      ?bufftimer=0\r\n        maxactions=1\r\n    ?health<=0\r\n      DeathScreen()\r\n    score=score+50\r\n    actions=0\r\n    turn=false\r\n  ?foecount>0\r\n    AddFoe()\r\n  maxhealth=15+level*5\r\n  maxxp=level*2\r\n  xpperc=((xp*screen.w)/maxxp)\r\n  \r\n  for i = 1..screen.w\r\n    >`@-1+i@,26,#565656,-\r\n  \r\n  >`0,25,@health@/@maxhealth@\r\n  >`10,25,Level:@level@\r\n  ?xpperc>0\r\n    for i = 1..xpperc\r\n      >`@-1+i@,26,@xpcolor@,█\r\n  \r\n  ?key=backBegin\r\n    xp=xp+10\r\n  >c0,12,@xp@\r\n  \r\n  >`80,23,ascii\r\n .•.\r\n•(•)•\r\n '•'\r\nasciiend\r\n  >`0,18,ascii\r\n# _.-' #  ▲   # \\¯¯¯/# '-._ \r\n#◀   | # / \\  #  \\ / # |   ▶\r\n# ¯'-. #/___\\ #   ▼  # .-'¯ \r\nasciiend\r\n  ?meleetxt.text=\"Great Sword\"\r\n    >`15,2,@(level+damage)*1.25@\r\n  :\r\n    >`15,2,@(level+damage)*1.5@\r\n  ?rangedtxt.text=\"Crossbow\"\r\n    >`15,7,@(level+damage)@\r\n  :\r\n    >`15,7,@(level+damage)*1.25@\r\n  ?magictxt.text=\"Book\"\r\n    >`15,12,@(level+damage)*0.75@\r\n  :\r\n    >`15,12,@(level+damage)@\r\n  >`30,23,Speed:@bufftimer@\r\n\r\n/*\r\nSight Stone- Can see where you are, Shows enemy descriptions\r\nStar Stone- Unlocks difficulty, Picks up all resources in a room\r\nKi Stone- Gain Ki, 2x Ki\r\nXp Stone- Unlocks Levels, 2x Xp\r\nOuroborous- Unlocks \"looping\" (going deeper?), heals 1 hp per pi sec\r\nQuest Stone- Unlock Missions, +armor when held\r\nFissure Stone- Unlock breaking weapons for resources, fires a beam that deals x damage\r\nTri- Unlock enchant fusing, +move range\r\nMind- , dashes x spaces\r\nMoon- , -ability cds\r\n*/"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Minesweeper.txt" - Parse error: Failed to parse completely. Remaining: "= [\r\n\t[\"#000000\", \"#000000\", \"#\"], // 0\r\n\t[\"#0000f7\", \"#c6c6c6\", \"1\"], // 1\r\n\t[\"#007700\", \"#c6c6c6\", \"2\"], // 2\r\n\t[\"#ec0000\", \"#c6c6c6\", \"3\"], // 3\r\n\t[\"#000080\", \"#c6c6c6\", \"4\"], // 4\r\n\t[\"#800000\", \"#c6c6c6\", \"5\"], // 5\r\n\t[\"#008080\", \"#c6c6c6\", \"6\"], // 6\r\n\t[\"#000000\", \"#c6c6c6\", \"7\"], // 7\r\n\t[\"#707070\", \"#c6c6c6\", \"8\"], // 8\r\n\t[\"#ff0000\", \"#cc3030\", \"@\"], // mine\r\n\t[\"#ffffff\", \"#000000\", \"o\"], // close\r\n\t[\"#ff0000\", \"#000000\", \"▶\"] // flag\r\n]\r\n\r\n// [[mineCount, state: -1-flag, 0-close, 1-open]]\r\nvar data = []\r\nvar width = 9\r\nvar height = 9\r\n\r\n// [[x, y]]\r\nvar mine = []\r\nvar mineCount = 0\r\n\r\nvar flagCount = 0\r\nvar targetCount = 0\r\n\r\n\r\n\r\nvar mainBox\r\nvar mainBoxText\r\nvar mainBoxCanvas\r\n\r\nvar targetBox\r\nvar targetBoxText\r\n\r\nvar timerBox\r\nvar timerBoxText\r\n\r\nvar titleText\r\nvar guideText\r\nvar difficultySelectionText\r\n\r\nvar titleTextList = [[],\r\n[\"#rainFF\", \"M I N E S W E E P E R\"],\r\n[\"#rainFF\", \"Y O U   W I N\"],\r\n[\"#cc0000\", \"gameover\"]\r\n]\r\n\r\nvar guideTextList_pc = [[\"Z/R.->flag\"],\r\n[\"#99ccff\", \"↑↓-SwchLv  X-Back  C-(Re)Start\"],\r\n[\"#99ccff\", \"X-GoToTitle  C-RestartGame\"]\r\n]\r\n\r\nvar guideTextList_mobile = [[\"•->flag\"],\r\n[\"#99ccff\", \"↑↓-SwchLv  ←-Back  •-(Re)Start\"],\r\n[\"#99ccff\", \"←-GoToTitle  •-RestartGame\"]\r\n]\r\n\r\n\r\nvar buttonList = []\r\n\r\n/*\r\n0: initialize\r\n1: restart\r\n2: title\r\n3: setupTarget\r\n4: setupData\r\n5: playing\r\n6: processVicinityData\r\n7: win\r\n8: drawMines\r\n9: gameover\r\n*/\r\nvar state = 0\r\n\r\n\r\n// [[width, height, mineCount]]\r\nvar difficulty = [[8,8,10], [16,16,40], [30,16,99]]\r\n// [[color, text]]\r\nvar difficultyText = [\r\n\t[\"#0000ff\",\"beginner\"],\r\n\t[\"#00ff00\",\"intermediate\"],\r\n\t[\"#ff0000\",\"expert\"]\r\n]\r\nvar difficultyTextLength = 14\r\nvar difficultyIndex = difficulty.Count() - 1\r\n\r\n// timer variables\r\nvar timer = 0\r\nvar secTimer = 0\r\n\r\n// cache variables\r\nvar cx = 0\r\nvar cy = 0\r\nvar cx2 = 0\r\nvar cy2 = 0\r\nvar cl = []\r\nvar ct = 0\r\nvar cc = 0\r\n\r\n// test variables\r\nvar a = 0\r\nvar b = 0\r\n\r\nfunc main(fre)\r\n\t?loc.stars = 0 & loc ! waterfall\r\n\t\treturn\r\n\r\n\t?loc.loop\r\n\t\tcreateUI()\r\n\t\tredraw()\r\n\t\treturn\r\n\t\r\n\tfor i = 1..fre\r\n\t\t?state = 5\r\n\t\t\t?playing()\r\n\t\t\t\tbreak\r\n\t\t:?state = 6\r\n\t\t\t?processVicinityData()\r\n\t\t\t\tbreak\r\n\t\t:?state = 2\r\n\t\t\t?title()\r\n\t\t\t\tbreak\r\n\t\t:?state = 8\r\n\t\t\t?drawMines()\r\n\t\t\t\tbreak\r\n\t\t:?state = 4\r\n\t\t\t?setupData()\r\n\t\t\t\tbreak\r\n\t\t:?state = 3\r\n\t\t\t?setupTarget()\r\n\t\t\t\tbreak\r\n\t\t:?state = 1\r\n\t\t\t?restart()\r\n\t\t\t\tbreak\r\n\t\t:?state = 0\r\n\t\t\t?initialize()\r\n\t\t\t\tbreak\r\n\t\t:\r\n\t\t\tbreak\r\n\r\n\tglobalInput()\r\n\r\n\t//showdata(fre)\r\n\r\nfunc globalInput()\r\n\t?key = bumpRBegin\r\n\t\tcreateMap()\r\n\t:?key = backEnd\r\n\t\tchangeState(1)\r\n\r\nfunc initialize()\r\n\tkey.Bind(BumpL, Z, Mouse1)\r\n\tcreateUI()\r\n\tchangeState(1)\r\n\treturn true\r\n\r\nfunc restart()\r\n\tclearCanvas()\r\n\tsetupLevel(difficulty.Count() - 1)\r\n\tsetTimerBoxText(0)\r\n\tsetDifficultySelectionText()\r\n\tdifficultySelectionText.visible = inherit\r\n\tchangeState(2)\r\n\treturn true\r\n\r\nfunc setupScreen()\r\n\tmainBox.w = width + 2\r\n\tmainBox.h = height + 2\r\n\tmainBox.y = 1\r\n\r\n\tmainBoxCanvas.w = width\r\n\tmainBoxCanvas.h = height\r\n\r\n\ttitleText.y = -mainBox.h / 4\r\n\r\n\ttargetBox.x = mainBox.x - mainBox.w / 2 + 2\r\n\ttargetBox.y = mainBox.y - mainBox.h / 2 - 2\r\n\r\n\ttimerBox.x = mainBox.x + mainBox.w / 2 - 3\r\n\ttimerBox.y = targetBox.y\r\n\r\nfunc initCache()\r\n\tcx = 0\r\n\tcy = 0\r\n\tcx2 = 0\r\n\tcy2 = 0\r\n\tcl.Clear()\r\n\tct = 0\r\n\tcc = 0\r\n\r\nfunc setupLevel(i)\r\n\twidth = difficulty[i][0]\r\n\theight = difficulty[i][1]\r\n\tmineCount = difficulty[i][2]\r\n\r\n\tsetTargetBoxText(0)\r\n\r\n\tflagCount = 0\r\n\ttargetCount = width * height - mineCount\r\n\t\r\n\tsetupScreen()\r\n\r\nfunc createMap()\r\n\tmainBoxCanvas.visible = false\r\n\ttitleText.visible = false\r\n\tguideText.visible = false\r\n\tdifficultySelectionText.text = \"loading...\"\r\n\tdifficultySelectionText.visible = inherit\r\n\r\n\tsetupLevel(difficultyIndex)\r\n\r\n\tinitTimer()\r\n\r\n\tinitCache()\r\n\tclearCanvas()\r\n\tdata.Clear()\r\n\tmine.Clear()\r\n\tchangeState(3)\r\n\r\nfunc title()\r\n\tsetTitleText(1) // \"M I N E S W E E P E R\"\r\n\tsetGuideText(1)\r\n\r\n\t?key = up | key = down\r\n\t\t?key = upEnd | key = downEnd\r\n\t\t\tct = 0 // delay timer reset\r\n\t\t:\r\n\t\t\t?!ct // delay timer check\r\n\t\t\t\t?key = up\r\n\t\t\t\t\taddDifficultyIndex(-1)\r\n\t\t\t\t:?key = down\r\n\t\t\t\t\taddDifficultyIndex(1)\r\n\t\t\tct = (ct + 1) % 5 // delay timer update (5 frames)\r\n\r\n\treturn true\r\n\r\nfunc setDifficultyIndex(i)\r\n\tdifficultyIndex = i\r\n\tsetDifficultySelectionText()\r\n\r\nfunc addDifficultyIndex(i)\r\n\tsetDifficultyIndex((difficultyIndex + difficulty.Count() + i) % difficulty.Count())\r\n\r\nfunc setDifficultySelectionText()\r\n\tvar t = \"\"\r\n\tvar d\r\n\t?difficultyIndex - 1 >= 0\r\n\t\td = difficultyText[difficultyIndex - 1]\r\n\t\tt += string.Format(\"▲\\n[color={0}]{1}[/color]\\n\", d[0],  d[1])\r\n\t:\r\n\t\tt += \"\\n\\n\"\r\n\td = difficultyText[difficultyIndex]\r\n\tt += string.Format(\"[[color={0}]{1}[/color]]\", d[0], d[1])\r\n\t?difficultyIndex + 1 < difficulty.Count()\r\n\t\td = difficultyText[difficultyIndex + 1]\r\n\t\tt += string.Format(\"\\n[color={0}]{1}[/color]\\n▼\", d[0],  d[1])\r\n\t:\r\n\t\tt += \"\\n\\n\"\r\n\tdifficultySelectionText.text = t\r\n\r\nfunc setTitleText(i)\r\n\tvar d = titleTextList[i]\r\n\ttitleText.color = d[0]\r\n\ttitleText.frame = i\r\n\ttitleText.visible = inherit\r\n\r\nfunc setGuideText(i)\r\n\t?sys.isPC\r\n\t\tvar d = guideTextList_pc[i]\r\n\t:?sys.isMobile\r\n\t\tvar d = guideTextList_mobile[i]\r\n\tguideText.color = d[0]\r\n\tguideText.text = d[1]\r\n\tguideText.visible = inherit\r\n\r\n\r\nfunc win()\r\n\tsetTitleText(2) // \"Y O U  W I N\"\r\n\tsetGuideText(2) // \"X-GoToTitle  C-RestartGame\"\r\n\r\nfunc drawMines()\r\n\t?mine.Count()\r\n\t\tvar z = mine[0]\r\n\t\tcx = z[0]\r\n\t\tcy = z[1]\r\n\t\tdrawCanvas(cx, cy, 9)\r\n\t\tmine.RemoveAt(0)\r\n\t:\r\n\t\tgameover()\r\n\t\tchangeState(9)\r\n\treturn true\r\n\r\nfunc gameover()\r\n\tsetTitleText(3) // \"gameover\"\r\n\tsetGuideText(2) // \"X-GoToTitle  C-RestartGame\"\r\n\r\nfunc setupData()\r\n\t?data.Count() < height * width\r\n\t\t?ct ! data.Count()\r\n\t\t\tcx = data.Count() % width\r\n\t\t\tcy = math.FloorToInt(data.Count() / width)\r\n\r\n\t\t\t?isTarget(cx, cy)\r\n\t\t\t\tcc = -8\r\n\t\t\t:\r\n\t\t\t\tcx2 = cx - 1\r\n\t\t\t\tcy2 = cy - 1\r\n\t\t\t\tcc = 0\r\n\r\n\t\t\tct = data.Count()\r\n\r\n\t\t// 如果目標位置是地雷, 為防止玩家根據時間差異作弊, 設定為與正常計算相同的執行次數\r\n\t\t:?cc < 0\r\n\t\t\tcc++\r\n\t\t\t?cc = 0\r\n\t\t\t\taddData(cx, cy, 9)\r\n\r\n\t\t// 如果目標位置不是地雷, 計算附近8格內有幾個地雷\r\n\t\t:?cy2 > cy + 1\r\n\t\t\t?cc\r\n\t\t\t\taddData(cx, cy, cc)\r\n\t\t\t:\r\n\t\t\t\taddData(cx, cy, 0)\r\n\r\n\t\t:\r\n\t\t\t?!(cx2 = cx & cy2 = cy) & isTarget(cx2, cy2)\r\n\t\t\t\tcc++\r\n\t\t\tcx2++\r\n\t\t\t?cx2 > cx + 1\r\n\t\t\t\tcx2 = cx - 1\r\n\t\t\t\tcy2++\r\n\t:\r\n\t\tmainBoxCanvas.visible = inherit\r\n\t\tdifficultySelectionText.visible = false\r\n\t\tchangeState(5)\r\n\t\treturn true\r\n\treturn false\r\n\r\nfunc addData(x, y, s)\r\n\tdata.Add([s, 0])\r\n\tdrawCanvas(x, y, 10)\r\n\tsetTimerBoxText(width * height - data.Count())\r\n\r\nfunc setupTarget()\r\n\t?mine.Count() < mineCount\r\n\t\tvar x = rng % width\r\n\t\tvar y = rng % height\r\n\t\t?!isTarget(x, y)\r\n\t\t\tmine.Add([x, y])\r\n\t\t\tsetTargetBoxText(mine.Count())\r\n\t:\r\n\t\tchangeState(4)\r\n\t\treturn true\r\n\treturn false\r\n\r\nfunc isTarget(x, y)\r\n\t?mine.Count() & inRange(x, y)\r\n\t\tfor i = 0..mine.Count() - 1\r\n\t\t\t?x = mine[i][0] & y = mine[i][1]\r\n\t\t\t\treturn true\r\n\treturn false\r\n\r\nfunc playing()\r\n\t?sys.isPC // \r\n\t\t>`@mainBox.absoluteX@,@mainBox.absoluteY+mainBox.h-1@,Z/R.->flag\r\n\t\r\n\tupdateTimer()\r\n\t?key = primaryBegin | key = bumpLBegin\r\n\t\tvar x = input.x - (mainBox.absoluteX + 1)\r\n\t\tvar y = input.y - (mainBox.absoluteY + 1)\r\n\t\t?inRange(x, y)\r\n\t\t\t?key = bumpLBegin\r\n\t\t\t\t?flagTile(x, y)\r\n\t\t\t\t\treturn false\r\n\t\t\t:?key = primaryBegin\r\n\t\t\t\t?openTile(x, y)\r\n\t\t\t\t\treturn false\r\n\treturn true\r\n\r\nfunc initTimer()\r\n\ttimer = 0\r\n\tsecTimer = 0\r\n\tsetTimerBoxText(width * height)\r\n\r\nfunc updateTimer()\r\n\ttimer = (timer + 1) % 30\r\n\t?!timer\r\n\t\tsecTimer++\r\n\t\tsetTimerBoxText(secTimer)\r\n\r\nfunc flagTile(x,y)\r\n\tvar z = data[getIndex(x, y)]\r\n\t?z[1] = 0\r\n\t\tz[1] = -1\r\n\t\tdrawCanvas(x, y, 11)\r\n\t\tflagCount++\r\n\t\tsetTargetBoxText(mineCount - flagCount)\r\n\t:?z[1] = -1\r\n\t\tz[1] = 0\r\n\t\tdrawCanvas(x, y, 10)\r\n\t\tflagCount--\r\n\t\tsetTargetBoxText(mineCount - flagCount)\r\n\treturn false\r\n\r\nfunc openTile(x, y)\r\n\tvar z = data[getIndex(x, y)]\r\n\r\n\t?z[1] // flag(-1) or open(1)\r\n\t\treturn false\r\n\r\n\t?z[0] = 9 // mine\r\n\t\tdrawCanvas(x, y, z[0])\r\n\t\tstartGameOver()\r\n\t\treturn true\r\n\r\n\t// close\r\n\tz[1] = 1\r\n\ttargetCount--\r\n\r\n\tdrawCanvas(x, y, z[0])\r\n\r\n\t?z[0] = 0\r\n\t\tstartProcessVicinityData(x, y)\r\n\t\treturn true\r\n\t:?!targetCount\r\n\t\twin()\r\n\t\tchangeState(7)\r\n\treturn false\r\n\r\nfunc drawCanvas(x, y, n)\r\n\tvar art = artList[n]\r\n\tmainBoxCanvas.Set(x, y, art[0], art[1], art[2])\r\n\r\nfunc startGameOver()\r\n\tinitCache()\r\n\tchangeState(8)\r\n\r\nfunc startProcessVicinityData(x, y)\r\n\t?state ! 6\r\n\t\tinitCache()\r\n\t\tchangeState(6)\r\n\tcl.Add([x, y])\r\n\r\nfunc processVicinityData()\r\n\t?!cc\r\n\t\t?ct < cl.Count()\r\n\t\t\tvar z = cl[ct]\r\n\r\n\t\t\tcx = z[0]\r\n\t\t\tcy = z[1]\r\n\r\n\t\t\tcc = 8\r\n\r\n\t\t\tct++\r\n\t\t:\r\n\t\t\tchangeState(5)\r\n\t\t\treturn true\r\n\r\n\t:\r\n\t\tcx2 = cx + getoffset(cc + 1) // cache x offset\r\n\t\tcy2 = cy + getoffset(cc + 3) // cache y offset\r\n\r\n\t\t?!(cx2 = cx & cy2 = cy) & inRange(cx2, cy2)\r\n\t\t\topenTile(cx2, cy2)\r\n\r\n\t\tcc--\r\n\treturn false\r\n\r\nfunc getoffset(n)\r\n\tn = n % 8\r\n\t?n % 4\r\n\t\t?n < 4\r\n\t\t\treturn -1\r\n\t\t:\r\n\t\t\treturn 1\r\n\treturn 0\r\n\r\nfunc inRange(x, y)\r\n\treturn x >= 0 & x < width & y >= 0 & y < height\r\n\r\nfunc showdata(fre)\r\n\t>@fre@ @state@ @difficultyIndex@\\n\r\n\t^@ct@ @cc@ @cx@ @cy@ @cx2@ @cy2@\\n\r\n\t^@cl.Count()@ @input.x@ @input.y@\\n\r\n\t^@screen.w@ @screen.h@ @targetCount@\\n\r\n\t^@mainBox.absoluteX@ @mainBox.absoluteY@ @a@ @b@\r\n\r\nfunc setTimerBoxText(n)\r\n\ttimerBoxText.text = numberToString(n)\r\n\r\nfunc setTargetBoxText(n)\r\n\ttargetBoxText.text = numberToString(n)\r\n\r\nfunc changeState(i)\r\n\tstate = i\r\n\r\nfunc createUI()\r\n\tmainBox = ui.AddPanel()\r\n\t\r\n\t//mainBoxText = ui.AddText()\r\n\t//mainBoxText.visible = false\r\n\t//mainBox.Add(mainBoxText)\r\n\r\n\tmainBoxCanvas = ui.AddCanvas()\r\n\tmainBoxCanvas.w = width\r\n\tmainBoxCanvas.h = height\r\n\tmainBoxCanvas.visible = false\r\n\tmainBox.Add(mainBoxCanvas)\r\n\r\n\ttargetBox = ui.AddPanel()\r\n\ttargetBox.w = 5\r\n\ttargetBox.h = 3\r\n\r\n\ttargetBoxText = ui.AddText()\r\n\ttargetBoxText.text = \"000\"\r\n\ttargetBoxText.w = 3\r\n\ttargetBoxText.h = 1\r\n\ttargetBox.Add(targetBoxText)\r\n\r\n\ttimerBox = ui.AddPanel()\r\n\ttimerBox.w = 5\r\n\ttimerBox.h = 3\r\n\r\n\ttimerBoxText = ui.AddText()\r\n\ttimerBoxText.text = \"000\"\r\n\ttimerBoxText.w = 3\r\n\ttimerBoxText.h = 1\r\n\ttimerBox.Add(timerBoxText)\r\n\r\n\ttitleText = ui.AddAnim(ascii\r\n\r\n%%\r\nM I N E S W E E P E R\r\n%%\r\n####Y O U   W I N\r\n%%\r\n######gameover\r\nasciiend)\r\n\ttitleText.Stop()\r\n\tmainBox.Add(titleText)\r\n\r\n\tguideText = ui.AddText()\r\n\tguideText.w = screen.w\r\n\tguideText.h = 1\r\n\tguideText.y = -1\r\n\tguideText.align = center\r\n\tguideText.anchor = bottom_center\r\n\tguideText.dock = bottom_center\r\n\tmainBox.Add(guideText)\r\n\t\r\n\r\n\tdifficultySelectionText = ui.AddText()\r\n\tdifficultySelectionText.w = screen.w\r\n\tdifficultySelectionText.y = mainBox.y + mainBox.h * 2 / 3\r\n\tdifficultySelectionText.align = center\r\n\tmainBox.Add(difficultySelectionText)\r\n\r\n\tsetupScreen()\r\n\t\r\n\t?sys.isMobile\r\n\t\tBuildArrowButton(0, 0, •)\r\n\t\tBuildArrowButton(0, -3, ↑)\r\n\t\tBuildArrowButton(0, 3, ↓)\r\n\t\tBuildArrowButton(5, 0, ←)\r\n\r\nfunc BuildArrowButton(x, y, t)\r\n\tvar button = ui.AddButton()\r\n\tbutton.text = t\r\n\tbutton.w = 5\r\n\tbutton.h = 3\r\n\tbutton.x = x\r\n\tbutton.y = y\r\n\tbutton.style = 1\r\n\tbutton.anchor = center_left\r\n\tbutton.dock = center_left\r\n\tbutton.SetPressed(buttonAction)\r\n\tbuttonList.Add(button)\r\n\r\nfunc buttonAction(btn)\r\n\t?buttonList[0] = btn\r\n\t\tcreateMap()\r\n\t:?buttonList[1] = btn\r\n\t\t?state = 2\r\n\t\t\taddDifficultyIndex(-1)\r\n\t:?buttonList[2] = btn\r\n\t\t?state = 2\r\n\t\t\taddDifficultyIndex(1)\r\n\t:?buttonList[3] = btn\r\n\t\tchangeState(1)\r\n\r\nfunc redraw()\r\n\tredrawCanvas()\r\n\t?state = 5 | state = 8 |\r\n\t^state = 7 | state = 9\r\n\t\tsetTargetBoxText(mineCount - flagCount)\r\n\t\tsetTimerBoxText(secTimer)\r\n\t\t?state = 7\r\n\t\t\twin()\r\n\t\t:?state = 9\r\n\t\t\tgameover()\r\n\t:?state = 2\r\n\t\trestart()\r\n\r\nfunc redrawCanvas()\r\n\tfor y = 0..height - 1\r\n\t\tfor x = 0..width - 1\r\n\t\t\tvar i = getIndex(x, y)\r\n\t\t\t?i >= data.Count()\r\n\t\t\t\treturn\r\n\r\n\t\t\tvar z = data[i]\r\n\t\t\t?z[1] = -1\r\n\t\t\t\tdrawCanvas(x, y, 11)\r\n\t\t\t:?z[1] = 0\r\n\t\t\t\tdrawCanvas(x, y, 10)\r\n\t\t\t:\r\n\t\t\t\tdrawCanvas(x, y, z[0])\r\n\treturn\r\n\r\nfunc run(fre)\r\n\tmain(fre)\r\n\r\nmain(20)\r\n\r\n\r\nfunc getIndex(x, y)\r\n\treturn width * y + x\r\n\r\nfunc numberToString(n)\r\n\t?n <= 0\r\n\t\treturn \"000\"\r\n\r\n\tn = \"00\" + n\r\n\treturn string.sub(n, string.size(n) - 3)\r\n\r\nfunc clearCanvas()\r\n\tmainBoxCanvas.SetFG(\"#000000\")\r\n\tmainBoxCanvas.SetBG(\"#000000\")\r\n\tmainBoxCanvas.Set(\"#\")"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Blackjack.txt" - Parse error: Failed to parse completely. Remaining: "= \"blackjack_money\"\r\n\r\nvar DEAL_CARDS = 2\r\nvar CARD_DEAL_RATE = 0.3\r\nvar CARD_DEAL_ERR = 0.2\r\n\r\nvar CARD_FLIP_TIME = 5\r\n\r\nvar MINIM_RATE = 0.2\r\nvar MINIM_ERR = 0.2\r\nvar MINIMIZED_W = 27\r\nvar MAXIMIZED_W = 45\r\n\r\n\r\n\r\n//- VARIABLES -\r\n// Game state machine\r\n//states:\r\n//  SETUP\r\n//  BET\r\n//  DEAL_PLAYER_CARD\r\n//  DEAL_PLAYER_FLIP\r\n//  DEAL_DEALER_CARD\r\n//  DEAL_DEALER_FLIP\r\n//  DEAL_INIT_EVALUATE\r\n//  PLAYER_TURN\r\n//  DRAW_PLAYER_CARD\r\n//  DRAW_PLAYER_FLIP\r\n//  PLAYER_EVALUATE\r\n//  DEALER_TURN\r\n//  DRAW_DEALER_CARD\r\n//  DRAW_DEALER_FLIP\r\n//  DEALER_EVALUATE\r\n//  WIN\r\n//  TIE\r\n//  LOSE\r\nvar state = SETUP\r\nvar next_state = state\r\nvar state_time = 0\r\n\r\nvar enter = true\r\nvar exit = false\r\n\r\n// State variables - used to help decide state transitions\r\n//   be very careful about when these are updated,\r\n//   could lead to inconsistent state transitions\r\nvar SV_doubleDown = false\r\nvar SV_helpVisible = false\r\nvar SV_playerDealTarget = DEAL_CARDS\r\nvar SV_dealerDealTarget = DEAL_CARDS\r\nvar SV_cardDealError = 0.0\r\nvar SV_playerRequest = none\r\n\r\n// General status variables\r\nvar initialized = false\r\nvar minimized = (DEFAULT_TO_MINIMIZED | loc.IsQuest | loc = uulaa_shop)\r\n\r\nvar prev_bet = 0\r\n\r\nvar deckX\r\nvar deckY\r\nvar f_cardX = 0.0\r\nvar f_cardY = 0.0\r\nvar handX\r\nvar handY\r\n\r\nvar f_frmW = 0.0\r\nvar f_frmY = 0.0\r\nvar windowY\r\n\r\n// UI objects\r\nvar stlTransp = ui.AddStyle(\"#########\")\r\nvar stlFrame = ui.AddStyle(\"╓─╖║ ║╙─╜\")\r\nvar stlSimple = ui.AddStyle(\"┌─┐│ │└─┘\")\r\nvar stlStack = ui.AddStyle(\"┌─┐│ │├─┤\")\r\nvar stlHand = ui.AddStyle(\"╒═-│  '  \")\r\n\r\nvar strTitle = \"[ BLACKJACK ]\"\r\nvar strMin = \"[-]\"\r\nvar strMax = \"[+]\"\r\n\r\nvar pnlMain\r\nvar pnlHelp\r\nvar pnlGame\r\nvar pnlBet\r\nvar pnlPlay\r\nvar pnlSettle\r\n\r\nvar pnlHelp\r\nvar txtHelp\r\nvar btnHelp\r\n\r\nvar txtTitle\r\nvar txtMinMax\r\nvar txtInfo\r\n\r\nvar btnMinMax\r\nvar btnBet\r\nvar btnBetUp\r\nvar btnBetDown\r\nvar btnReBet\r\nvar btnHit\r\nvar btnStay\r\nvar btnDouble\r\nvar btnSettle\r\n\r\nvar bnkPlayer\r\n\r\nvar hndPlayer\r\nvar hndDealer\r\n\r\nvar crdDeck\r\nvar crdNewCard\r\n\r\nvar clrFrame =        #999999\r\nvar clrTitle =        #white\r\nvar clrPlayer =       #cyan\r\nvar clrPlayerAccent = #yellow\r\nvar clrDealer =       #white\r\nvar clrDealerAccent = #cyan\r\nvar clrInfoGood =     #green\r\nvar clrInfoBad =      #red\r\n\r\n\r\n\r\n//- MAIN LOOP -\r\nUpdate()\r\n\r\n\r\n\r\n//- FUNCTIONS -\r\n// Main setup function\r\nfunc TryReset()\r\n  //rerun initialization at every: level start, level loop, boss transition\r\n  ?initialized & (loc.begin | loc.loop | time = 1)\r\n    initialized = false\r\n  \r\n  //reset variables and build components\r\n  ?!initialized\r\n    initialized = true\r\n    \r\n    state = SETUP\r\n    \r\n    SV_doubleDown = false\r\n    SV_helpVisible = false\r\n    SV_playerDealTarget = DEAL_CARDS\r\n    SV_dealerDealTarget = DEAL_CARDS\r\n    SV_cardDealError = 0.0\r\n    SV_playerRequest = none\r\n    \r\n    BuildUI()\r\n    ResetHands()\r\n\r\n// Gameplay reset function\r\nfunc ResetHands()\r\n  hndPlayer.Clear()\r\n  hndDealer.Clear()\r\n  hndPlayer.UpdateValueDisp()\r\n  hndDealer.UpdateValueDisp()\r\n  \r\n  SV_playerDealTarget = DEAL_CARDS\r\n  SV_dealerDealTarget = DEAL_CARDS\r\n\r\n\r\n\r\n// Main loop function\r\nfunc Update()\r\n  TryReset()\r\n  \r\n  // Main state machine\r\n  Enter()\r\n  Loop()\r\n  Exit()\r\n  \r\n  state = next_state\r\n  state_time++\r\n\r\n\r\n\r\n// Called on transition TO new state\r\nfunc Enter()\r\n  ?enter\r\n    enter = false\r\n    \r\n    state_time = 0\r\n    SV_playerRequest = none\r\n    \r\n    ? state = BET\r\n      pnlBet.visible = inherit\r\n      \r\n      //only show re-bet button if there's a prior bet\r\n      ?prev_bet ! 0\r\n        btnReBet.visible = inherit\r\n      \r\n      //borrow money\r\n      ?bnkPlayer.money = 0\r\n        ShowUpdateInfo(false)\r\n        bnkPlayer.AddMoney(LOAN_MONEY)\r\n    \r\n    :?state = DEAL_PLAYER_CARD | state = DRAW_PLAYER_CARD\r\n      play booklet_turn_page\r\n      crdNewCard.MoveTo(deckX, deckY)\r\n      crdNewCard.SetVisible(inherit)\r\n      \r\n      f_cardX = 0.0 + deckX\r\n      f_cardY = 0.0 + deckY\r\n      handX = hndPlayer.pnlMain.x + hndPlayer.size*4 + 1\r\n      handY = hndPlayer.pnlMain.y + 1\r\n    \r\n    :?state = DEAL_PLAYER_FLIP | state = DRAW_PLAYER_FLIP\r\n      play click\r\n      hndPlayer.GetAt(-1).SetFaceUp(true)\r\n      hndPlayer.UpdateValueDisp()\r\n    \r\n    :?state = DEAL_DEALER_CARD | state = DRAW_DEALER_CARD\r\n      play booklet_turn_page\r\n      crdNewCard.MoveTo(deckX, deckY)\r\n      crdNewCard.SetVisible(inherit)\r\n      \r\n      f_cardX = 0.0 + deckX\r\n      f_cardY = 0.0 + deckY\r\n      handX = hndDealer.pnlMain.x + hndDealer.size*4 + 1\r\n      handY = hndDealer.pnlMain.y + 1\r\n    \r\n    :?state = DEAL_DEALER_FLIP | state = DRAW_DEALER_FLIP\r\n      play click\r\n      hndDealer.GetAt(-1).SetFaceUp(true)\r\n      hndDealer.UpdateValueDisp()\r\n    \r\n    :?state = PLAYER_TURN\r\n      pnlPlay.visible = inherit\r\n      SV_playerDealTarget = hndPlayer.size + 1\r\n    \r\n    :?state = DEALER_TURN\r\n      SV_dealerDealTarget = hndDealer.size + 1\r\n    \r\n    :?state = WIN | state = TIE | state = LOSE\r\n      pnlSettle.visible = inherit\r\n      ShowUpdateInfo( (state ! LOSE) )\r\n      \r\n      //reveal hidden dealer card\r\n      var d_c = hndDealer.GetAt(-1)\r\n      ?!d_c.face_up\r\n        play booklet_turn_page\r\n        d_c.SetFaceUp(true)\r\n        hndDealer.UpdateValueDisp()\r\n      \r\n      //set win payout rate\r\n      ? state = WIN & SV_dealerDealTarget = DEAL_CARDS //player blackjack\r\n        bnkPlayer.SetBetMult(1.5)\r\n      :?state = WIN\r\n        bnkPlayer.SetBetMult(2)\r\n      :?state = TIE\r\n        bnkPlayer.SetBetMult(1)\r\n      :?state = LOSE\r\n        bnkPlayer.SetBetMult(0)\r\n\r\n\r\n\r\n// Called once per tick while in state\r\nfunc Loop()\r\n  \r\n  // Update game window position\r\n  UpdateFrame()\r\n  \r\n  // Update money/bet display\r\n  bnkPlayer.UpdateDisplay()\r\n  \r\n  ?state = BET\r\n    // Multiply bet buttons x10 while shift is held\r\n    ?key = ability1Begin\r\n      btnBetUp.text = \"+10\"\r\n      btnBetDown.text = \"-10\"\r\n    :?key = ability1End\r\n      btnBetUp.text = \"+\"\r\n      btnBetDown.text = \"-\"\r\n  \r\n  :?state = DEAL_PLAYER_CARD | state = DEAL_DEALER_CARD | state = DRAW_PLAYER_CARD | state = DRAW_DEALER_CARD\r\n    // Move cards during deal/draw states\r\n    f_cardX = math.Lerp(f_cardX, handX, CARD_DEAL_RATE)\r\n    f_cardY = math.Lerp(f_cardY, handY, CARD_DEAL_RATE)\r\n    \r\n    //composite x and y error into 1 variable\r\n    SV_cardDealError = math.Abs(handX-f_cardX) + math.Abs(handY-f_cardY)\r\n    \r\n    crdNewCard.MoveTo(f_cardX, f_cardY)\r\n  \r\n  // Move to next state and schedule exit logic if necessary\r\n  next_state = NextState()\r\n  ?next_state ! state\r\n    exit = true\r\n\r\n\r\n\r\n// Called on transition FROM old state\r\nfunc Exit()\r\n  ?exit\r\n    exit = false\r\n    enter = true\r\n    \r\n    ? state = BET\r\n      pnlBet.visible = false\r\n      HideInfo()\r\n      \r\n      SV_playerDealTarget = DEAL_CARDS\r\n      SV_dealerDealTarget = DEAL_CARDS\r\n    \r\n    :?state = DEAL_PLAYER_CARD | state = DRAW_PLAYER_CARD\r\n      hndPlayer.Add(GetRandomCard(), GetRandomSuit())\r\n      hndPlayer.GetAt(-1).SetFaceUp(false)\r\n      crdNewCard.SetVisible(false)\r\n    \r\n    :?state = DEAL_DEALER_CARD | state = DRAW_DEALER_CARD\r\n      hndDealer.Add(GetRandomCard(), GetRandomSuit())\r\n      hndDealer.GetAt(-1).SetFaceUp(false)\r\n      crdNewCard.SetVisible(false)\r\n    \r\n    :?state = PLAYER_TURN\r\n      pnlPlay.visible = false\r\n    \r\n    :?state = WIN | state = TIE | state = LOSE\r\n      pnlSettle.visible = false\r\n      HideInfo()\r\n      play booklet_close\r\n      \r\n      SV_doubleDown = false\r\n      bnkPlayer.Settle()\r\n      ResetHands()\r\n\r\n\r\n\r\n// Determine next state\r\nfunc NextState()\r\n  ? state = SETUP\r\n    return BET\r\n\r\n  :?state = BET\r\n    ?SV_playerRequest = bet\r\n      return DEAL_PLAYER_CARD\r\n\r\n  :?state = DEAL_PLAYER_CARD\r\n    ?SV_cardDealError < CARD_DEAL_ERR*2\r\n      return DEAL_PLAYER_FLIP\r\n  \r\n  :?state = DEAL_PLAYER_FLIP\r\n    ?state_time > CARD_FLIP_TIME\r\n      ?ReachedPlrDealTarget()\r\n        return DEAL_DEALER_CARD\r\n      :\r\n        return DEAL_PLAYER_CARD\r\n  \r\n  :?state = DEAL_DEALER_CARD\r\n    ?SV_cardDealError < CARD_DEAL_ERR*2\r\n      ?ReachedDlrDealTarget()\r\n        return DEAL_INIT_EVALUATE\r\n      :\r\n        return DEAL_DEALER_FLIP\r\n  \r\n  :?state = DEAL_DEALER_FLIP\r\n    ?state_time > CARD_FLIP_TIME\r\n      return DEAL_DEALER_CARD\r\n  \r\n  :?state = DRAW_PLAYER_CARD\r\n    ?SV_cardDealError < CARD_DEAL_ERR*2\r\n      return DRAW_PLAYER_FLIP\r\n  \r\n  :?state = DRAW_PLAYER_FLIP\r\n    ?state_time > CARD_FLIP_TIME\r\n      return PLAYER_EVALUATE\r\n  \r\n  :?state = DRAW_DEALER_CARD\r\n    ?SV_cardDealError < CARD_DEAL_ERR*2\r\n      return DRAW_DEALER_FLIP\r\n  \r\n  :?state = DRAW_DEALER_FLIP\r\n    ?state_time > CARD_FLIP_TIME\r\n      return DEALER_TURN\r\n  \r\n  :?state = DEAL_INIT_EVALUATE\r\n    ?hndPlayer.HasBlackjack()\r\n      ?hndDealer.HasBlackjack()\r\n        return TIE\r\n      :\r\n        return WIN\r\n    :?hndDealer.HasBlackjack()\r\n      return LOSE\r\n    :\r\n      return PLAYER_TURN\r\n  \r\n  :?state = PLAYER_EVALUATE\r\n    ?hndPlayer.HasBusted()\r\n      return LOSE\r\n    :?SV_doubleDown\r\n      return DRAW_DEALER_FLIP\r\n    :\r\n      return PLAYER_TURN\r\n  \r\n  :?state = DEALER_EVALUATE\r\n    ?hndDealer.HasBusted() | (hndDealer.GetBestTotal() < hndPlayer.GetBestTotal())\r\n      return WIN\r\n    :? hndDealer.GetBestTotal() = hndPlayer.GetBestTotal()\r\n      return TIE\r\n    :\r\n      return LOSE\r\n  \r\n  :?state = PLAYER_TURN\r\n    ?SV_playerRequest = hit | SV_playerRequest = double\r\n      return DRAW_PLAYER_CARD\r\n    :?SV_playerRequest = stay\r\n      return DRAW_DEALER_FLIP\r\n  \r\n  :?state = DEALER_TURN\r\n    ?hndDealer.GetBestTotal() < 17\r\n      return DRAW_DEALER_CARD\r\n    :\r\n      return DEALER_EVALUATE\r\n\r\n  :?state = WIN | state = TIE | state = LOSE\r\n    ?SV_playerRequest = settle\r\n      return BET\r\n  :\r\n    return BET\r\n  \r\n  return state\r\n\r\n\r\n\r\n// Create and arrange UI components\r\nfunc BuildUI()\r\n  pnlMain = ui.AddPanel()\r\n  pnlMain.style = stlFrame\r\n  pnlMain.color = clrFrame\r\n  pnlMain.anchor = bottom_center\r\n  pnlMain.dock = bottom_center\r\n  pnlMain.clip = true\r\n  pnlMain.x = 0\r\n  pnlMain.y = 0\r\n  pnlMain.w = MAXIMIZED_W\r\n  pnlMain.h = 17\r\n  \r\n  pnlGame = ui.AddPanel()\r\n  pnlGame.style = 0\r\n  pnlGame.anchor = bottom_center\r\n  pnlGame.dock = bottom_center\r\n  pnlGame.clip = true\r\n  pnlGame.y = -1\r\n  pnlGame.w = pnlMain.w-2\r\n  pnlGame.h = pnlMain.h-2\r\n  pnlGame.visible = inherit\r\n  \r\n  pnlHelp = ui.AddPanel()\r\n  pnlHelp.style = 0\r\n  pnlHelp.anchor = bottom_center\r\n  pnlHelp.dock = bottom_center\r\n  pnlHelp.y = -1\r\n  pnlHelp.w = pnlMain.w-2\r\n  pnlHelp.h = pnlMain.h-2\r\n  pnlHelp.visible = false\r\n  \r\n  pnlBet = ui.AddPanel()\r\n  pnlBet.style = 0\r\n  pnlBet.anchor = bottom_center\r\n  pnlBet.dock = bottom_center\r\n  pnlBet.w = pnlGame.w\r\n  pnlBet.h = 5\r\n  pnlBet.visible = false\r\n  \r\n  pnlPlay = ui.AddPanel()\r\n  pnlPlay.style = 0\r\n  pnlPlay.anchor = bottom_center\r\n  pnlPlay.dock = bottom_center\r\n  pnlPlay.w = pnlMain.w - 18\r\n  pnlPlay.h = 3\r\n  pnlPlay.visible = false\r\n  \r\n  pnlSettle = ui.AddPanel()\r\n  pnlSettle.style = 0\r\n  pnlSettle.anchor = bottom_center\r\n  pnlSettle.dock = bottom_center\r\n  pnlSettle.w = pnlGame.w\r\n  pnlSettle.h = 3\r\n  pnlSettle.visible = false\r\n  \r\n  btnHelp = ui.AddButton()\r\n  btnHelp.SetPressed(ShowHideHelp)\r\n  btnHelp.visible = inherit\r\n  btnHelp.style = stlSimple\r\n  btnHelp.anchor = bottom_left\r\n  btnHelp.dock = bottom_left\r\n  btnHelp.text = \"?\"\r\n  btnHelp.x = 1\r\n  btnHelp.y = -1\r\n  btnHelp.w = 5\r\n  btnHelp.h = 3\r\n  \r\n  btnBet = ui.AddButton()\r\n  btnBet.SetPressed(PlaceBet)\r\n  btnBet.visible = inherit\r\n  btnBet.style = stlSimple\r\n  btnBet.anchor = bottom_center\r\n  btnBet.dock = bottom_center\r\n  btnBet.text = \"Place Bet\"\r\n  btnBet.w = 13\r\n  btnBet.h = 3\r\n  \r\n  btnBetDown = ui.AddButton()\r\n  btnBetDown.SetDown(DecrBet)\r\n  btnBetDown.visible = inherit\r\n  btnBetDown.style = stlSimple\r\n  btnBetDown.anchor = bottom_right\r\n  btnBetDown.dock = bottom_right\r\n  btnBetDown.text = \"-\"\r\n  btnBetDown.x = 0 //-btnBetUp.w\r\n  btnBetDown.w = 5\r\n  btnBetDown.h = 3\r\n  \r\n  btnBetUp = ui.AddButton()\r\n  btnBetUp.SetDown(IncrBet)\r\n  btnBetUp.visible = inherit\r\n  btnBetUp.style = stlStack\r\n  btnBetUp.anchor = bottom_right\r\n  btnBetUp.dock = bottom_right\r\n  btnBetUp.text = \"+\"\r\n  btnBetUp.y = -2\r\n  btnBetUp.w = 5\r\n  btnBetUp.h = 3\r\n  \r\n  btnReBet = ui.AddButton()\r\n  btnReBet.SetDown(ReBet)\r\n  btnReBet.visible = false  //hidden for first hand\r\n  btnReBet.style = stlSimple\r\n  btnReBet.anchor = bottom_right\r\n  btnReBet.dock = bottom_right\r\n  btnReBet.text = \"Re-Bet\"\r\n  btnReBet.x = -btnBetDown.w\r\n  btnReBet.w = 8\r\n  btnReBet.h = 3\r\n  \r\n  btnMinMax = ui.AddButton()\r\n  btnMinMax.SetPressed(MinMaxFrame)\r\n  btnMinMax.visible = inherit\r\n  btnMinMax.style = stlTransp\r\n  btnMinMax.anchor = top_right\r\n  btnMinMax.dock = top_right\r\n  btnMinMax.text = \"\"\r\n  btnMinMax.x = 0\r\n  btnMinMax.y = -1\r\n  btnMinMax.w = 5\r\n  btnMinMax.h = 3\r\n  \r\n  btnHit = ui.AddButton()\r\n  btnHit.SetPressed(Hit)\r\n  btnHit.visible = inherit\r\n  btnHit.style = stlSimple\r\n  btnHit.anchor = bottom_left\r\n  btnHit.dock = bottom_left\r\n  btnHit.text = \"Hit\"\r\n  btnHit.w = 7\r\n  btnHit.h = 3\r\n  \r\n  btnStay = ui.AddButton()\r\n  btnStay.SetPressed(Stay)\r\n  btnStay.visible = inherit\r\n  btnStay.style = stlSimple\r\n  btnStay.anchor = bottom_left\r\n  btnStay.dock = bottom_left\r\n  btnStay.text = \"Stay\"\r\n  btnStay.x = btnHit.w\r\n  btnStay.w = 8\r\n  btnStay.h = 3\r\n  \r\n  btnDouble = ui.AddButton()\r\n  btnDouble.SetPressed(DoubleDown)\r\n  btnDouble.visible = inherit\r\n  btnDouble.style = stlSimple\r\n  btnDouble.anchor = bottom_left\r\n  btnDouble.dock = bottom_left\r\n  btnDouble.text = \"Double Down\"\r\n  btnDouble.x = btnHit.w + btnStay.w\r\n  btnDouble.w = 15\r\n  btnDouble.h = 3\r\n  \r\n  btnSettle = ui.AddButton()\r\n  btnSettle.SetPressed(SettleUp)\r\n  btnSettle.visible = inherit\r\n  btnSettle.style = stlSimple\r\n  btnSettle.anchor = bottom_center\r\n  btnSettle.dock = bottom_center\r\n  btnSettle.text = \"Settle Up\"\r\n  btnSettle.w = 13\r\n  btnSettle.h = 3\r\n  \r\n  txtTitle = ui.AddText(strTitle)\r\n  txtTitle.color = clrTitle\r\n  txtTitle.anchor = top_center\r\n  txtTitle.dock = top_center\r\n  txtTitle.w = 13\r\n  txtTitle.h = 1\r\n  \r\n  txtHelp = ui.AddText()\r\n  txtHelp.text = GetHelpText()\r\n  txtHelp.color = clrTitle\r\n  txtHelp.anchor = top_left\r\n  txtHelp.dock = top_left\r\n  txtHelp.visible = inherit\r\n  txtHelp.w = pnlHelp.w\r\n  txtHelp.h = pnlHelp.h\r\n  \r\n  txtMinMax = ui.AddText(strMin)\r\n  txtMinMax.color = clrTitle\r\n  txtMinMax.anchor = top_right\r\n  txtMinMax.dock = top_right\r\n  txtMinMax.x = -1\r\n  txtMinMax.w = 3\r\n  txtMinMax.h = 1\r\n  \r\n  txtInfo = ui.AddText()\r\n  txtInfo.visible = false\r\n  txtInfo.align = center\r\n  txtInfo.anchor = bottom_left\r\n  txtInfo.dock = bottom_left\r\n  txtInfo.x = 1\r\n  txtInfo.y = -pnlPlay.h-1\r\n  txtInfo.w = pnlGame.w\r\n  txtInfo.h = 1\r\n  \r\n  hndDealer = new Games/Blackjack/Hand\r\n  hndDealer.Init(\"Dealer\", stlHand, clrDealer, clrDealerAccent)\r\n  hndDealer.MoveTo(1,0)\r\n  hndDealer.Size(25,5)\r\n  \r\n  hndPlayer = new Games/Blackjack/Hand\r\n  hndPlayer.Init(player.name, stlHand, clrPlayer, clrPlayerAccent)\r\n  hndPlayer.MoveTo(1,5)\r\n  hndPlayer.Size(25,5)\r\n  \r\n  bnkPlayer = new Games/Blackjack/Bank\r\n  bnkPlayer.Init(MONEY_KEY, SEED_MONEY)\r\n  \r\n  deckX = pnlMain.w-7\r\n  deckY = 0\r\n  \r\n  //card to represent deck, right-aligned\r\n  crdDeck = new Games/Blackjack/Card\r\n  crdDeck.Init(0, 0) //will never be played\r\n  crdDeck.SetFaceUp(false)\r\n  crdDeck.pnlMain.anchor = top_right\r\n  crdDeck.pnlMain.dock = top_right\r\n  crdDeck.pnlMain.x = -1\r\n  crdDeck.pnlMain.y = 0\r\n  \r\n  //card to represent drawn card, left-aligned to match coords w/ hands\r\n  crdNewCard = new Games/Blackjack/Card\r\n  crdNewCard.Init(0, 0) //also will never be played\r\n  crdNewCard.SetFaceUp(false)\r\n  crdNewCard.MoveTo(deckX, deckY)\r\n  crdNewCard.SetVisible(false)\r\n  \r\n  //start game in minimized state, if required\r\n  ?minimized\r\n    txtMinMax.text = strMax\r\n    pnlMain.w = MINIMIZED_W\r\n    pnlMain.y = pnlMain.h-1\r\n  \r\n  f_frmY = 0.0 + pnlMain.y\r\n  f_frmW = 0.0 + pnlMain.w\r\n  \r\n  //add Components to their containers\r\n  pnlMain.Add(txtTitle)\r\n  pnlMain.Add(txtMinMax)\r\n  pnlMain.Add(btnMinMax)\r\n  \r\n  pnlGame.Add(hndDealer.pnlMain)\r\n  pnlGame.Add(hndPlayer.pnlMain)\r\n  pnlGame.Add(crdDeck.pnlMain)\r\n  pnlGame.Add(crdNewCard.pnlMain)\r\n  pnlGame.Add(bnkPlayer.pnlMain)\r\n  \r\n  pnlBet.Add(btnBet)\r\n  pnlBet.Add(btnBetDown)\r\n  pnlBet.Add(btnBetUp)\r\n  pnlBet.Add(btnReBet)\r\n  pnlGame.Add(pnlBet)\r\n  \r\n  pnlSettle.Add(btnSettle)\r\n  pnlGame.Add(pnlSettle)\r\n  \r\n  pnlPlay.Add(btnHit)\r\n  pnlPlay.Add(btnStay)\r\n  pnlPlay.Add(btnDouble)\r\n  pnlGame.Add(pnlPlay)\r\n  \r\n  pnlGame.Add(txtInfo)\r\n  \r\n  pnlHelp.Add(txtHelp)\r\n  \r\n  pnlMain.Add(pnlGame)\r\n  pnlMain.Add(pnlHelp)\r\n  pnlMain.Add(btnHelp)\r\n\r\n\r\n// Functions for minimizing frame\r\nfunc MinMaxFrame()\r\n  minimized = !minimized\r\n\r\nfunc UpdateFrame()\r\n  ?minimized\r\n    f_frmY = math.Lerp(f_frmY, pnlMain.h-1, MINIM_RATE)\r\n    f_frmW = math.Lerp(f_frmW, MINIMIZED_W, MINIM_RATE)\r\n  :\r\n    f_frmY = math.Lerp(f_frmY, 0, MINIM_RATE)\r\n    f_frmW = math.Lerp(f_frmW, MAXIMIZED_W, MINIM_RATE)\r\n  \r\n  //update component parameters only during min/max transition\r\n  ?math.Abs(pnlMain.y - f_frmY) > MINIM_ERR\r\n    ?minimized\r\n      txtMinMax.text = strMax\r\n    :\r\n      txtMinMax.text = strMin\r\n    \r\n    pnlMain.y = math.RoundToInt(f_frmY)\r\n    pnlMain.w = math.RoundToInt(f_frmW)\r\n    pnlGame.w = pnlMain.w-2\r\n    pnlHelp.w = pnlMain.w-2\r\n    pnlBet.w = pnlGame.w\r\n\r\n\r\n\r\nfunc ReachedPlrDealTarget()\r\n  return (hndPlayer.size = SV_playerDealTarget)\r\n\r\nfunc ReachedDlrDealTarget()\r\n  //evaluated before latest card gets added to dealer's hand, so -1\r\n  return (hndDealer.size = SV_dealerDealTarget-1)\r\n\r\n// Infinite decks, even 1-13 value distribution\r\nfunc GetRandomCard()\r\n  return rng%13 + 1\r\n\r\n// Infinite decks, even 0-3 suit distribution\r\nfunc GetRandomSuit()\r\n  return rng%4\r\n\r\n\r\n\r\n//- PLAYER BUTTON FUNCTIONS -\r\n// Submit player interactions to the state machine\r\nfunc ShowHideHelp()\r\n  SV_helpVisible = !SV_helpVisible\r\n  \r\n  ?SV_helpVisible\r\n    pnlHelp.visible = inherit\r\n    pnlGame.visible = false\r\n    btnHelp.text = \"X\"\r\n  :\r\n    pnlHelp.visible = false\r\n    pnlGame.visible = inherit\r\n    btnHelp.text = \"?\"\r\n\r\nfunc ShowUpdateInfo(good)\r\n  txtInfo.visible = inherit\r\n  txtInfo.text = GetInfoStr()\r\n  \r\n  ?good\r\n    txtInfo.color = clrInfoGood\r\n  :\r\n    txtInfo.color = clrInfoBad\r\n\r\nfunc HideInfo()\r\n  txtInfo.visible = false\r\n\r\nfunc IncrBet()\r\n  ?key = ability1\r\n    bnkPlayer.AddBetImmediate(10)\r\n  :\r\n    bnkPlayer.AddBetImmediate(1)\r\n\r\nfunc DecrBet()\r\n  ?key = ability1\r\n    bnkPlayer.AddBetImmediate(-10)\r\n  :\r\n    bnkPlayer.AddBetImmediate(-1)\r\n\r\nfunc ReBet()\r\n  bnkPlayer.AddBet(prev_bet - bnkPlayer.bet)\r\n\r\nfunc PlaceBet()\r\n  ?bnkPlayer.bet <= 0\r\n    return\r\n  \r\n  prev_bet = bnkPlayer.bet\r\n  SV_playerRequest = bet\r\n\r\nfunc Hit()\r\n  SV_playerRequest = hit\r\n\r\nfunc Stay()\r\n  SV_playerRequest = stay\r\n\r\nfunc DoubleDown()\r\n  ?!bnkPlayer.CanDoubleDown()\r\n    return\r\n  \r\n  SV_doubleDown = true\r\n  bnkPlayer.AddBet(bnkPlayer.bet)\r\n  SV_playerRequest = double\r\n\r\nfunc SettleUp()\r\n  SV_playerRequest = settle\r\n\r\n\r\n\r\n//- TEXT STRINGS -\r\n// tucked away here at the bottom since they're not super important\r\n\r\n// BASIC rules of blackjack, look up online for more detailed ones\r\nfunc GetHelpText()\r\n  return ascii\r\n###########################################\r\n Blackjack is a 2-person betting game. Try\r\n to draw more points than the dealer, but\r\n don't bust over 21!\r\n \r\n [color=#cyan]Hit:[/color] Draw another card.\r\n [color=#cyan]Stay:[/color] End turn.\r\n [color=#cyan]Double Down:[/color] Double your bet and draw\r\n              1 more card. End turn.\r\n [color=#cyan]Blackjack:[/color] Win 1.5x your bet if dealt 21.\r\n [color=#cyan]Soften:[/color] If you would bust with an [color=#cyan]A[/color], make\r\n       it worth 1 and keep playing.\r\n#####\r\n##### [color=#cyan]J[/color],[color=#cyan]Q[/color],[color=#cyan]K[/color] = 10. [color=#cyan]A[/color] = 1 or 11, you choose.\r\n#####\r\nasciiend\r\n\r\n// Get the appropriate info string, based on current game state and state variable status\r\nfunc GetInfoStr()\r\n  ? state = BET\r\n    return \"Got a loan to keep gambling...\"\r\n  \r\n  :?state = WIN\r\n    ? hndPlayer.HasBlackjack()\r\n      return \"Blackjack! You win 1.5x your bet.\"\r\n    :?hndDealer.HasBusted()\r\n      return \"Dealer went bust! You win!\"\r\n    :\r\n      return \"You win!\"\r\n  \r\n  :?state = TIE\r\n    return \"It's a tie! Your bet is returned.\"\r\n  \r\n  :?state = LOSE\r\n    ? hndDealer.HasBlackjack()\r\n      return \"Dealer blackjack! You lose...\"\r\n    :?hndPlayer.HasBusted()\r\n      return \"You went bust! You lose...\"\r\n    :\r\n      return \"You lose...\"\r\n  \r\n  return \"Unknown status in: \" + state\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/KillerRPG.txt" - Parse error: Failed to parse completely. Remaining: "(＂points＂ ,0)\r\n//Var with priority\r\nvar PotionMI = 1\r\nvar MutageMission = Sg(＂MutageM＂,0)\r\nvar number = 0.09999\r\nnumber = Mr(number*10)/10\r\nvar ColorReward = #yellow\r\n\r\n//Event var\r\nvar XpEvent = 1\r\nvar KillEvent = 1\r\n//Event system\r\n//Kill Event\r\n?Td > 20 & Td < 24\r\n KillEvent = 2\r\n ?Ti < 151\r\n  >`0,0,#red,DOUBLE KILL EVENT IS ACTIVE\r\n:?Td = 20\r\n ?Ti < 151\r\n  >`0,0,#red,\r\n  ^Double kill Event available tomorrow\r\n//Xp Event\r\n?Td > 0 & Td < 3\r\n XpEvent = 2\r\n ColorReward = #rainbow\r\n ?Ti < 151\r\n  >`0,0,#rainbow,DOUBLE XP EVENT IS ACTIVE\r\n:?Td = 31\r\n ?Ti < 151\r\n  >`0,0,#00FFFF,\r\n  ^Double XP Event available tomorrow\r\n?Td > 13 & Td < 16\r\n XpEvent = 2\r\n ColorReward = #rainbow\r\n ?Ti < 151\r\n  >`0,0,#rainbow,DOUBLE XP EVENT IS ACTIVE\r\n:?Td = 13\r\n ?Ti < 151\r\n  >`0,0,#00FFFF,\r\n  ^Double XP Event available tomorrow\r\n\r\n//Mutagen Event\r\n?Td > 6 & Td < 10\r\n >`0,0,#FF10F0,\r\n ^DOUBLE MUTAGENS EVENT ACTIVATE\r\n number = 0.19999\r\n number = Mr(number*10)/10\r\n:?Td = 6\r\n >`0,0,#00FF00,\r\n ^Double Mutagens Event available tomorrow\r\n\r\n\r\n//ascii\r\nvar Rt = ［ascii\r\n.__________________________.\r\n|—————————REWARDS——————————|\r\n|#####################     |\r\n|###################       |\r\n|#####################     |\r\n|######################### |\r\n|                          |\r\n|                          |\r\n|                          |\r\n|##########################|\r\n|__________________________|\r\n'##########################'\r\nasciiend,ascii\r\n.__________________________.\r\n|—————————REWARDS——————————|\r\n|#####################     |\r\n|###################       |\r\n|#####################     |\r\n|######################### |\r\n|__________________________|\r\n'##########################'\r\nasciiend］\r\n\r\nvar help = ［ascii\r\nEVENT DATES:\r\n2x XP Event: Day 1 to Day 2 & Day 14 to Day 15\r\n2x Kill Event: Day 21 to Day 23\r\n2x Mutagens Event: Day 7 to Day 9\r\n\r\nOne day before the event a warning will be given\r\nto remind you that the event is the next day, \r\nand when active it will also open a warning\r\n(warnings are only shown during the first 150\r\nframes of the map)\r\n\r\n•REWARDS: Check the ＂REWARDS＂ button. There you \r\nwill find a list of all the rewards for the \r\nrespective missions.\r\n\r\n•MISSIONS: There are 3 types - items, bosses, and\r\nFOE.\r\n\r\n•Item: requires a specific item to complete the\r\nmission.\r\n\r\n•Boss: requires defeating a boss to complete the\r\nmission. Each boss defeat increases the counter \r\naccording to the star of the location you are in.\r\n\r\n•FOE: requires defeating an enemy to complete\r\nthe mission\r\n\r\n•XP: necessary to level up. You can earn XP by \r\ncompleting missions or fulfilling requirements\r\nwithin 2 maps for the XP points to be counted.\r\n\r\n•SKIP MISSIONS: After earning 20 XP, you will\r\nhave \r\naccess to skip missions. Each skip costs 1 XP,so \r\nit is recommended not to abuse it. Only 1 map is \r\nneeded to skip the mission.\r\n\r\n•REQUIREMENTS: Any way to earn XP that does not \r\ninvolve completing missions.\r\n\r\n•KILL XP: Earn KILL XP by defeating an enemy. The\r\namount of Kill XP earned varies according to the \r\nstar of the location divided by 2 (even for item \r\nand enemy missions).\r\n\r\n•Market: Store where you can buy potions (that\r\ngive some kind of buff)\r\n\r\n•Gems:Gems are remnants of power from a foe,\r\nleft when killing an enemy,each enemy leaves the \r\ngem respective to its element \r\n\r\n•«» = Fire Gem, left by fire enemies \r\n\r\n•<> = Ice Gem, left by ice enemies \r\n\r\n•:∞: = Poison Gem, left by poison enemies \r\n\r\n•\\V/ = Vigor Gem, left by vigor enemies \r\n\r\n•± = Aether Gem, left by Aether enemies \r\n\r\n•©:Acropolis Coin,Few enemies have it,Rare to see\r\n2% chance of an enemy dropping it after its death \r\n•Potions: Found in the Market,\r\nbuff gem and © gain and accelerate your progress\r\nin the RPG\r\n\r\n•LABORATORY(LAB):In the Laboratory are Found\r\nto the MUTAGENS\r\n\r\n•MUTAGENS: These are permanent improvements \r\npurchased with ©\r\n\r\nMutagen Killer: Multiplies all Kill gains\r\nboth in missions and in requirements\r\n\r\nMutagen Gem: Multiply the gain of all Gems\r\n\r\nMutage ©: Increases an enemy's chance of Dropping\r\n©\r\n\r\nMutagenic Mission: Reduces the number of deaths\r\nRequired to complete missions\r\n\r\nSearch: Offline Search, when starting a Search\r\nwill be taken off the map and when entering another map\r\nA new interface will be available in this\r\ninterface There will be the option to receive you will have\r\n10 seconds to receive the search if it will not be\r\nkicked off the map\r\nasciiend,ascii\r\nDATAS DE EVENTOS:\r\n2x XP Event: Dia 1 á Dia 2 & Dia 14 á Dia 15\r\n2x Kill Event: Dia 21 á Dia 23\r\n2x Mutagens Event: Dia 7 á Dia 9\r\n\r\nUm dia antes do evento um aviso será mostrado\r\npara lhe lembrar que o evento é no próximo dia e \r\ndurante um evento tambem haverá um aviso sendo\r\nmostrado(os avisos são mostrados nos primeiros\r\n150 frames do mapa)\r\n\r\n•RECOMPENSAS: verifique o botão ＂RECOMPENSAS＂ Lá\r\nestarão listadas todas as recompensas para as \r\nrespectivas missões.\r\n\r\n•MISSÕES: Existem 3 tipos - itens, chefes e FOE\r\n\r\n•Item: requer um certo item para completar a missão\r\n•Chefe: requer derrotar um chefe para completar a\r\nmissão. Cada derrota de chefe sobe  o contador \r\nconforme a estrela da localização que você está.\r\n•FOE: requer derrotar um inimigo para completar a\r\nmissão\r\n\r\n•XP: necessário para subir de nível. Você pode \r\nganhar XP completando missões ou cumprindo \r\nrequisitos\r\n\r\n•PULAR MISSÕES: Após ganhar 20 XP, você terá \r\nacesso a pular missões. Cada pulo custa 1 XP, por\r\nisso é recomendado não abusar. É necessário\r\napenas 1 mapa para pular a missão.\r\n•REQUISITOS: Qualquer forma de ganhar XP que não \r\nenvolve completar missões.\r\n\r\n•KILL XP: Ganhe KILL XP ao derrotar um inimigo. A\r\nquantidade de Kill XP  ganhado varia conforme a \r\nestrela da localização  dividida por 2 (mesmo\r\npara missões de itens e inimigos).\r\n\r\n•Market: Loja aonde se compras poções\r\n(que dão algum tipo de buff)\r\n\r\n•Gems: Gemas são resquícios de poder de um foe,\r\ndeixado ao matar um inimigo,\r\ncada inimigo deixa a gema respectiva a seu\r\nelemento\r\n\r\n•«» = Fire Gem,deixada por inimigos de fogo\r\n\r\n•<> = Ice Gem,deixada por inimigos de gelo\r\n\r\n•:∞: = Poison Gem,deixada por inimigos de veneno\r\n\r\n•\\V/ = Vigor Gem,deixada por inimigos de vigor\r\n\r\n•± = Aether Gem,deixada por inimigos de Aether\r\n\r\n•©: Moeda Da Acrópole,Poucos inimigos á \r\npossuem,Rara de se ver\r\n2% de chance de um inimigo dropar após sua morte\r\nchance pode ser aumentada no ＂LAB＂\r\n\r\n•Potions: Encontradas no Market,\r\nbuffam ganho de Gems e © e aceleram seu progress\r\nno RPG\r\n\r\n•LABORATORY(LAB):No Laboratório são Encontradas\r\nas MUTAGENS\r\n\r\n•MUTAGENS:São melhorias permanentes compradas \r\ncom ©\r\n\r\nMutagen Killer: Multiplica todo ganho de Kills\r\ntanto em missões tanto em requerimentos\r\n\r\nMutagen Gem: Multiplica o ganho de todas as Gems\r\n\r\nMutagem ©: Aumenta a chance de um inimigo Dropar\r\n©\r\nMutagen Mission: Diminui a quantidade de Kills\r\nNecessárias para completar as missões\r\n\r\nSearch: Busca Offline,ao iniciar uma Search \r\nserá tirado do mapa e ao entrar em outro mapa\r\numa nova interface Estará Disponível,nessa\r\ninterface Estará a opcão de receber você terá\r\n10 secundos para receber a busca se não será\r\nexpulso do mapa\r\nasciiend］\r\n\r\n\r\nvar MarketAscii = ［ascii\r\n+-------------------------------------------+\r\n|    POTION 2XGEMS    |     POTION 2X       |\r\n| Effect: 2XALLGEMS   | Effect: 2X          |\r\n| Cost: 25            | Cost:1K ALL GEMS    |\r\n|         ###         |         ###         |\r\n+---------------------+---------------------+\r\n|    POTION Missions  |     POTION 2X       |\r\n| Effect:Missions/2   | Effect: 2X          |\r\n| Cost:1K ALLGEMS& 50 | Cost: 100           |\r\n|         ###         |         ###         |\r\n+-------------------------------------------+\r\nasciiend,ascii\r\n/////////////////##########\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\r\n+=====================×=====================+\r\n|    KILLER MUTAGE    |     GEM MUTAGE      |\r\n|MUTAGEN:             |MUTAGEN:             |\r\n|Cost: 25             |Cost: 25             |\r\n|         ###         |         ###         |\r\n+=====================×=====================+\r\n|  DROP CHANCE MUTAGE |   MISSION MUTAGE    |\r\n|MUTAGEN:             |MUTAGEN:             |\r\n|Cost: 50             |Cost: 25             |\r\n|         ###         |         ###         |\r\n+=====================×=====================+\r\n\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\|//////////////////////\r\nasciiend］\r\n\r\n\r\n\r\n//var Random Missions\r\nvar val1 = Sg(＂val1＂,0)\r\nvar SM = false\r\nvar RV = false\r\nvar RB = false\r\nvar RL = false\r\nvar MMComplete = false\r\nvar MBComplete = false\r\nvar MTComplete = false\r\nvar MLComplete = false\r\nvar it = Sg(＂it＂,0)\r\nvar val2 = Sg(＂val2＂,0)\r\nvar val3 = Sg(＂rv＂,0)\r\nvar val4 = Sg(＂val4＂,0)\r\nvar val5 = Sg(＂val5＂,0)\r\nvar val6 = Sg(＂val6＂,0)\r\nvar val7 = Sg(＂val7＂,0)\r\nvar T = Sg(＂Map＂,0)\r\n//Missions\r\nvar MM = Sg(＂mm＂,0)\r\nvar MB = Sg(＂mb＂,0)\r\nvar MT = Sg(＂mt＂,0)\r\nvar ML = Sg(＂ml＂,0)\r\nvar A\r\n\r\nvar AB\r\n//Random system\r\n?LB | LL\r\n RV = false\r\n RB = false\r\n SM = false\r\n RL = false\r\n\r\n?RL = true\r\n St(＂val6＂,rng%8)\r\n St(＂val7＂,rng%4)\r\n MLComplete = true\r\n ML = 0\r\n St(＂ml＂,ML)\r\n?RV = true\r\n St(＂rv＂,rng%3)\r\n MM = 0\r\n St(＂mm＂,MM)\r\n MMComplete = true\r\n St(＂val1＂,rng%12)\r\n?RB = true\r\n St(＂val2＂,rng%6)\r\n St(＂val4＂,rng%5)\r\n MB = 0\r\n St(＂mb＂,MB)\r\n MBComplete = true\r\n?SM = true\r\n St(＂val5＂,rng%5)\r\n MT = 0\r\n St(＂mt＂,MT)\r\n MTComplete = true\r\n St(＂it＂,rng%25)\r\n\r\n//>@it@\r\n//var of requirements and identification of item\r\n//and foes\r\nvar G\r\nvar H\r\nvar C\r\nvar D\r\nvar B\r\nvar E\r\nvar IRW \r\n\r\n\r\n//identification\r\nvar LocArray = ［\r\nDeadwood Canyon,\r\nTemple,\r\nMushroom Florest,\r\nRocky Plateau,\r\nCaves of Fear,\r\nHaunted Halls,\r\nBoiling Mine,\r\nIcy Ridge］\r\nG = LocArray［val6］\r\n\r\nvar foeArray = ［\r\nStone Scarab,\r\nHuge Mosquito,\r\nSkin Peeler,\r\nMinotaur,\r\nIce Elemental,\r\nBooo,\r\nAnt,\r\nGroud Serpent,\r\nWasp,\r\nKnee Chopper,\r\nWound Licker,\r\nNail Biter,\r\nHuge Snail］\r\nA = foeArray［val1］\r\n\r\nvar bossArray = ［\r\nDysangelos,\r\nBolesh,\r\nAngry Shroom,\r\nPallas,\r\nHrímnir,\r\nBronze Guardian,\r\nNagaraja］\r\nAB = bossArray［val2］\r\n\r\nvar N1 = ［\r\n100,\r\n200,\r\n300,\r\n400,\r\n500,\r\n600］\r\nD = N1［val3］\r\nD = (D/PotionMI) - MutageMission\r\nB = N1［val4］\r\nB = (B/PotionMI) - MutageMission\r\n\r\nvar N3 = ［\r\n500,\r\n1000,\r\n2000,\r\n3000,\r\n4000,\r\n10000］\r\nC = N3［val5］\r\nC = (C/PotionMI) - MutageMission\r\nvar N4 = ［\r\n2000,\r\n3000,\r\n4000,\r\n5000］\r\nH = N4［val7］ \r\nH = (H/PotionMI)-MutageMission\r\n\r\nvar IRWw = ［\r\n5,\r\n6,\r\n8,\r\n10,\r\n12,\r\n20］\r\n\r\nIRW = IRWw［val5］\r\nIRW = IRW*XpEvent\r\n\r\nvar ARM = ［\r\nCultist Mask,\r\nBardiche,\r\nSkeleton Arm,\r\nBlade of the Fallen God,\r\nRepeating Crossbow,\r\nHeavy hammer,\r\nIce Hammer,\r\nFire Hammer,\r\nVigor Hammer,\r\nPoison Hammer,\r\nStone Hammer,\r\nSword,\r\nFire Sword,\r\nIce Sword,\r\nVigor Sword,\r\nPoison Sword,\r\nStone Sword,\r\nHeavy Crossbow, \r\nQuarterstaff,\r\nCrossbow,\r\nWar Hammer,\r\nVigor Wand,\r\nFire Wand,\r\nIce Wand,\r\nPoison Wand,\r\nStone Wand］\r\nE = ARM［it］\r\n//Coins\r\nvar PotionCR = 1\r\nvar CF = Sg(＂CF＂,0)\r\nvar CI = Sg(＂CI＂,0)\r\nvar CVI = Sg(＂CVI＂,0)\r\nvar CP = Sg(＂CP＂,0)\r\nvar CAE = Sg(＂CAE＂,0)\r\n//Drop\r\nvar chance = Sg(＂cd＂,2.0)\r\n\r\n\r\n//Kill count system\r\nvar Dmgt = Sg(＂dmgt＂,0.0)\r\nvar Dmg = Sg(＂DmgP＂,0)\r\nvar Fkill = Sg(＂FK＂ ,0.0)\r\nvar killP = Sg(＂Kpoints＂,0.0)\r\nvar killed = Sg(＂Kcount＂,0)\r\n//Potions and Mutagens\r\n\r\nvar PotionE = 1\r\nvar PotionK = 1\r\nvar PotionP = 1\r\nvar PotionAE = 1\r\nvar MutageKiller = Sg(＂MutageKL＂,1)\r\nvar MutageGem = Sg(＂MutageGM＂,1)\r\n\r\n\r\nvar Pi = 0\r\nvar missionItemac = false\r\nvar missionLocAC = false\r\n?item.right = E | item.left = E\r\n missionItemac = true\r\n:\r\n missionItemac = false\r\n?l = G\r\n missionLocAC = true\r\n:\r\n missionLocAC = false\r\n?Pi > foe.getcount(100000)\r\n  killed = killed + (Pi-foe.getcount(1000))\r\n  St(＂Kcount＂, killed)\r\n  ?point >= 20\r\n     Drop = rngf*100\r\n     Drop = Mr(Drop*10)/10\r\n   ?f = Fire\r\n    CF = CF +(Pi-foe.getcount(1000)) *2*\r\n    ^(MutageGem+PotionE)\r\n    CF = Mr(CF*10)/10\r\n    St(＂CF＂,CF)\r\n   :?f = Ice\r\n    CI = CI +(Pi-foe.getcount(1000))*2\r\n    ^*(MutageGem+PotionE)\r\n    CI = Mr(CI*10)/10\r\n    St(＂CI＂,CI)\r\n   :?f = Poison\r\n    CP = CP +(Pi-foe.getcount(1000))*2\r\n    ^*(MutageGem+PotionE)\r\n    CP = Mr(CP*10)/10\r\n    St(＂CP＂,CP)\r\n   :?f = Vigor\r\n    CVI = CVI +(Pi-foe.getcount(1000)) *2*\r\n    ^(MutageGem+PotionE)\r\n    CVI = Mr(CVI*10)/10\r\n    St(＂CVI＂,CVI)\r\n   :?f = Aether\r\n    CAE = CAE +(Pi-foe.getcount(1000)) *2\r\n    ^* (MutageGem+PotionE)\r\n    CAE = Mr(CAE*10)/10\r\n    St(＂CAE＂,CAE)\r\n  killP = (killP + (Pi-foe.getcount(1000))\r\n  ^+ loc.stars/2 * (MutageKiller+PotionK))\r\n  ^*KillEvent\r\n  killP = Mr(killP*10)/10\r\n  St(＂Kpoints＂, killP)\r\n  Dmg = Dmg + foe.maxhp\r\n  St(＂DmgP＂,Dmg)\r\n  Dmgt = Dmgt + foe.maxhp\r\n  St(＂dmgt＂,Dmgt)  \r\n  ?point >= 10\r\n   ?missionLocAC = true\r\n    ML = (ML + (Pi-foe.getcount(100000))\r\n    ^+loc.stars/2* (MutageKiller+PotionK))\r\n    ^*KillEvent\r\n    ML = Mr(ML*10)/10\r\n    St(＂ml＂,ML)\r\n   ?f = A \r\n    MM = (MM + (Pi-foe.getcount(100000))\r\n    ^+ loc.stars/2* (MutageKiller+PotionK))\r\n    ^*KillEvent\r\n    MM = Mr(MM*10)/10\r\n    St(＂mm＂,MM)\r\n   ?f = AB & f = Phase2 = !Pallas\r\n    MB = (MB + (Pi-foe.getcount(100000))\r\n    ^+ loc.stars * (MutageKiller+PotionK)-1)\r\n    ^*KillEvent\r\n    MB = Mr(MB*10)/10\r\n    St(＂mb＂,MB)\r\n   ?missionItemac = true\r\n     MT = (MT + (Pi-foe.getcount(100000))\r\n     ^+ loc.stars/2*(MutageKiller+PotionK))\r\n     ^*KillEvent\r\n     MT = Mr(MT*10)/10\r\n     St(＂mt＂,MT)\r\nPi = foe.getcount(100000)\r\n\r\nvar Drop = 101\r\n\r\n\r\nvar CR = Sg(＂CR＂,0)\r\n?Drop <= chance*PotionCR\r\n CR = CR + 1\r\n St(＂CR＂,CR)\r\n Drop = 101\r\n \r\n//rewards\r\nvar val = (val3 + 3)*XpEvent\r\nvar valB = (val4 + 5)*XpEvent\r\nvar valL = (val7 + 7)*XpEvent\r\n\r\n\r\n//System Map\r\nvar seenTreasure = false\r\nvar storedData = false\r\n\r\n?LB | LL\r\n  storedData = false\r\n  seenTreasure = false\r\n?pickup=treasure\r\n  seenTreasure = true\r\n?seenTreasure = true & !storedData\r\n  Fkill = Fkill + 1\r\n  St(＂FK＂,Fkill)\r\n  Si(＂Map＂,loc.stars)\r\n storedData = true\r\n\r\n//system requeriments\r\n?Fkill >= 25\r\n   point = point + (3*XpEvent)\r\n   St(＂points＂,point)\r\n   Fkill = 0\r\n   St(＂FK＂,Fkill)\r\n?T >= 150\r\n   point = point + (6*XpEvent)\r\n   St(＂points＂,point)\r\n   T = 0\r\n   St(＂Map＂,T)\r\n?killP >= 2500\r\n   point = point + (4*XpEvent)\r\n   St(＂points＂,point)\r\n   killP = 0\r\n   St(＂Kpoints＂,killP)\r\n\r\n?Dmg >= 300000\r\n   point = point + (5*XpEvent)\r\n   St(＂points＂,point)\r\n   Dmg = 0\r\n   St(＂DmgP＂,Dmg)\r\n?MT >= C\r\n   point = point + IRW\r\n   St(＂points＂,point)\r\n   MT = 0\r\n   St(＂mt＂,MT)\r\n   SM = true\r\n\r\n?MM >= D\r\n   point = point + val\r\n   St(＂points＂,point)\r\n   MM = 0\r\n   St(＂mm＂,MM)\r\n   RV = true\r\n\r\n?MB >= B\r\n   \r\n   point = point + valB\r\n   MB = 0\r\n   St(＂mb＂,MB)\r\n   St(＂points＂,point)\r\n   RB = true\r\n?ML >= H\r\n St(＂ml＂,ML)\r\n point = point + valL\r\n St(＂points＂,point)\r\n ML = 0\r\n RL = true\r\n\r\n//Patents\r\nvar P =［\r\n^［＂3rd Class Soldier＂,10,#00FFFF］,\r\n^［＂2nd Class Soldier＂,20,#00FFFF］,\r\n^［＂1st Class Soldier＂,30,#00FFFF］,\r\n^［＂Cable＂,40,#00FFFF］,\r\n^［＂4th Sergeant＂,50,#00FFFF］,\r\n^［＂3rd Sergeant＂,75,#blue］,\r\n^［＂2nd Sergeant＂,100,#blue］,\r\n^［＂1st Sergeant＂,125,#blue］,\r\n^［＂Warrant Officer＂,150,#blue］,\r\n^［＂Aspiring Officer＂,175,#blue］,\r\n^［＂2nd Lieutenant＂,225,#red］,\r\n^［＂1st Lieutenant＂,275,#red］,\r\n^［＂Captain＂,325,#red］,\r\n^［＂Biggest＂,375,#red］,\r\n^［＂Lieutenant-Colonel＂,475,#red］,\r\n^［＂Colonel＂,575,#rainbow］,\r\n^［＂Brigadier General＂,675,#rainbow］,\r\n^［＂Division General＂,775,#rainbow］,\r\n^［＂General of the Army＂,875,#rainbow］,\r\n^［＂Marshal＂,1075,#rainbow］,\r\n^［＂Rambo＂,2075,#rainbow］,\r\n^［＂Prince Killer＂,3075,#808080］,\r\n^［＂King Killer＂,4075,#DAA520］,\r\n^［＂Demigod Killer＂,5000,#4B0082］,\r\n^］\r\nvar Pcount = P.Count()\r\n\r\nvar Rew = false\r\n//buttons\r\nvar togglepoints = false\r\nvar her = false\r\nfunc OnPressed() \r\n  togglepoints = !togglepoints\r\n  her = !her\r\nfunc pre()\r\n Rew = !Rew\r\n  \r\n?LB | LL\r\n  var button = ui.AddButton()\r\n  button.x = -43\r\n  button.h = 3\r\n  button.w = 7\r\n  button.y = -6\r\n  button.text = RPG\r\n  button.SetPressed(OnPressed)\r\n  var m = ui.AddButton()\r\n  m.x = -40\r\n  m.h = 3\r\n  m.w = 12\r\n  m.y = -3\r\n  m.text = Missions\r\n  m.SetPressed(OnPress)\r\n  m.visible = false\r\n  m.bcolor = #blue\r\n  var Reward = Ui.AddButton()\r\n  Reward.x = -29\r\n  Reward.h = 3\r\n  Reward.w = 11\r\n  Reward.y = -3\r\n  Reward.text = Rewards\r\n  Reward.SetPressed(pre)\r\n  Reward.visible = false\r\n  Reward.tcolor = #yellow\r\n  Reward.bcolor = #yellow\r\nbutton.visible = true\r\n\r\n?togglepoints = true\r\n >c-13,12,Complete Maps = @T@/150\r\n >`0,12,Total Kills = @killed@\\n\r\n ^Total Damage = @Dmgt@\\n\r\n ^Kill XP = @killP@/2.500\\n\r\n ^Damage XP = @Dmg@/300.000\\n\r\n ?point >= 20\r\n  >`25,1,#red,#«» \r\n  >`28,1,@CF@\r\n  >`33,1,#00FFFF,#<>\r\n  >`36,1,@CI@\r\n  >`42,1,#00FF00,:∞:\r\n  >`45,1,@CP@\r\n  >`52,1,#FF00FF,\\V/\r\n  >`55,1,@CVI@\r\n  >`61,1,#808080,±\r\n  >`62,1,@CAE@\r\n  >`68,1,#rainbow,©\r\n  >`69,1,@CR@\r\n ?point > 5000\r\n  >`0,17,#8B0000,Patent = GOD KILLER\r\n  >`0,18,#8B0000,NVL = MAX\r\n  >`0,16,XP = @point@/∞\r\n  >`0,19,#green,Next Patent in future update\r\n :\r\n  for i=0..Pcount-1\r\n   ?point<P［i］［1］\r\n    >`0,17,@P［i］［2］@,Patent = @P［i］［0］@\r\n    >`0,18,@P［i］［2］@,NVL = @i@/24\r\n    >`0,16,XP = @point@/@P［i］［1］@\r\n    >`0,19,#green,Next Patent in @P［i］［1］@XP\r\n    break\r\n \r\n >`0,25,Boss kill = @Fkill@/25\r\n\r\nvar S = false\r\nvar Mission = false\r\nfunc OnPress() \r\n  Mission = !Mission\r\n  S = !S\r\n  \r\n?point >= 20\r\n ?LB | LL\r\n  var skf = Ui.AddButton()\r\n  skf.text = ＂SKIP＂\r\n  skf.x = -20\r\n  skf.y = -9\r\n  skf.h = 1\r\n  skf.w = 6\r\n  skf.tcolor = #red\r\n  skf.bcolor = #000000\r\n  skf.SetPressed(mfs)\r\n\r\n  var skb = Ui.AddButton()\r\n  skb.text = ＂SKIP＂\r\n  skb.x = -20\r\n  skb.y = -10\r\n  skb.h = 1\r\n  skb.w = 6\r\n  skb.tcolor = #red\r\n  skb.bcolor = #000000\r\n  skb.SetPressed(mbs)\r\n\r\n  var ski = Ui.AddButton()\r\n  ski.text = ＂SKIP＂\r\n  ski.x = -20\r\n  ski.y = -8\r\n  ski.h = 1\r\n  ski.w = 6\r\n  ski.tcolor = #red\r\n  ski.bcolor = #000000\r\n  ski.SetPressed(mis)\r\n\r\n  var skl = Ui.AddButton()\r\n  skl.text = ＂SKIP＂\r\n  skl.x = -20\r\n  skl.y = -7\r\n  skl.h = 1\r\n  skl.w = 6\r\n  skl.tcolor = #red\r\n  skl.bcolor = #000000\r\n  skl.SetPressed(mls)\r\n\r\n?Mission = true\r\n ?point < 10\r\n  >`0,0,#red,Missions Unlocked in ＂XP = 10＂\r\n :?point >= 10\r\n   >`29,3,Mission ####:\r\n   >`37,3,#red,Boss\r\n   >`29,4,Mission ####:\r\n   >`37,4,#00FFFF,Foes\r\n   >`29,5,Mission ####:\r\n   >`37,5,#00FF00,Item\r\n   >`29,6,Mission ###:\r\n   >`37,6,#yellow,LOC\r\n   ?MBComplete = true\r\n    >c-4,-10,#yellow,MISSION BOSS COMPLETE!\r\n   :?MB < B\r\n    >c-4,-10,Kill @AB@: @MB@/@B@\r\n\r\n   ?MTComplete = true\r\n    >c-4,-8,#yellow,MISSION ITEM COMPLETE!\r\n   :?MT < C\r\n    >c-4,-8,Kill @MT@/@C@ Using @E@\r\n\r\n   ?MMComplete = true\r\n    >c-4,-9,#yellow,MISSION FOE COMPLETE!\r\n   :?MM < D\r\n    >c-4,-9,Kill @A@: @MM@/@D@\r\n   ?MLComplete = true\r\n    >c-4,-7,#yellow,MISSION LOC COMPLETE!\r\n   :?ML < H\r\n    >c-4,-7,Kill @ML@/@H@ in @G@\r\n\r\nvar SKIC = false\r\nvar SKFC = false\r\nvar SKBC = false\r\nvar SKLC = false\r\n?SKIC = true\r\n  ski.tcolor = #00FF00\r\n?SKBC = true\r\n skb.tcolor = #00FF00\r\n?SKFC = true\r\n skf.tcolor = #00FF00\r\n?SKLC = true\r\n skl.tcolor = #00FF00\r\nfunc mls()\r\n  RL = true\r\n  point = point - 1\r\n  St(＂points＂,point)\r\n  SKLC = true\r\nfunc mfs()\r\n\r\n RV = true\r\n point = point - 1\r\n St(＂points＂,point)\r\n St(＂mm＂,0)\r\n SKFC = true\r\nfunc mbs()\r\n RB = true\r\n \r\n point = point - 1\r\n St(＂points＂,point)\r\n St(＂mb＂,0)\r\n SKBC = true\r\nfunc mis()\r\n St(＂mt＂,0)\r\n SM = true\r\n \r\n point = point - 1\r\n St(＂points＂,point)\r\n SKIC = true\r\n?point >= 20\r\n ?S = true\r\n  skf.visible = true\r\n  skb.visible = true\r\n  ski.visible = true\r\n  skl.visible = true\r\n ?S = false\r\n  skf.visible = false\r\n  skb.visible = false\r\n  ski.visible = false\r\n  skl.visible = false\r\n?Rew = true \r\n >c-15,-5,@ColorReward@,Boss Kill Reward: 3XP\\n\r\n ^Kill XP Reward: 4XP\\n\r\n ^Damage XP Reward: 5XP\\n\r\n ^Complete Maps Reward: 6XP\r\n ?point < 10\r\n  >`30,6,@Rt［1］@\r\n ?point >= 10\r\n  >`30,6,@Rt［0］@\r\n  >c-15,-1,@ColorReward@\r\n  ^,Mission Foes Reward: @val@XP\\n\r\n  ^Mission Boss Reward: @valB@XP\\n\r\n  ^Mission item Reward: @IRW@XP\\n\r\n  ^Mission LOC Reward: @valL@XP\r\n\r\nvar xH = 31\r\nvar yH = 0\r\nvar LimiteYH = 0\r\nfunc Down()\r\n ?yH = LimiteYH\r\n  yH = LimiteYH\r\n :\r\n  yH--\r\n\r\n\r\nfunc Up()\r\n ?yH = 0\r\n  yH = 0\r\n :\r\n  yH++\r\n\r\nvar LabAscii\r\n\r\nvar HT = false\r\nfunc HTH()\r\n HT = !HT\r\n\r\nfunc LABB()\r\n LabAscii = !LabAscii\r\n?LB | LL\r\n var HB = Ui.AddButton()\r\n HB.text = Help\r\n HB.x = -36\r\n HB.y = -6\r\n HB.h = 3\r\n HB.w = 6\r\n HB.bcolor = #red\r\n HB.SetPressed(HTH)\r\n var HBR = Ui.AddButton()\r\n HBR.text = BR\r\n HBR.x = -29\r\n HBR.y = -6\r\n HBR.h = 3\r\n HBR.w = 6\r\n HBR.bcolor = #red\r\n HBR.SetPressed(hbr)\r\n var HE = Ui.AddButton()\r\n HE.text = EN\r\n HE.x = -29\r\n HE.y = -9\r\n HE.h = 3\r\n HE.w = 6\r\n HE.bcolor = #red\r\n HE.SetPressed(he)\r\n var HPDown = Ui.AddButton()\r\n HPDown.h = 3\r\n HPDown.w = 3\r\n HPDown.text = ＂↓＂\r\n HPDown.SetPressed(Down)\r\n HPDown.dock = top_left\r\n HPDown.x = 29\r\n HPDown.y = 7\r\n var HPUp = Ui.AddButton()\r\n HPUp.dock = top_left\r\n HPUp.x = 29\r\n HPUp.y = 4\r\n HPUp.h = 3\r\n HPUp.w = 3\r\n HPUp.text = ＂↑＂\r\n HPUp.SetPressed(Up)\r\n\r\n var Market = Ui.AddButton()\r\n Market.x = -19\r\n Market.h = 3\r\n Market.y = -3\r\n Market.w = 8\r\n Market.text = ＂Market＂\r\n Market.SetPressed(Markett)\r\n var Lab = Ui.AddButton()\r\n Lab.x = -12\r\n Lab.y = -3\r\n Lab.w = 7\r\n Lab.h = 3\r\n Lab.text = ＂LAB＂\r\n Lab.bcolor = #00FF00\r\n Lab.SetPressed(LABB)\r\n var TonicMKL = Ui.AddButton()\r\n TonicMKL.x = 3\r\n TonicMKL.h = 1 \r\n TonicMKL.y = -2\r\n TonicMKL.w = 20\r\n TonicMKL.text = BUY\r\n TonicMKL.tcolor = #FF10F0\r\n TonicMKL.SetPressed(MutageKLAC)\r\n var TonicELc = Ui.AddButton()\r\n TonicELc.x = -3\r\n TonicELc.h = 1\r\n TonicELc.y = -2\r\n TonicELc.w = 20\r\n TonicELc.text = BUY\r\n TonicELc.SetPressed(POTIONEAC)\r\n var TonicCRAc = Ui.AddButton()\r\n TonicCRAc.x = 19\r\n TonicCRAc.h = 1 \r\n TonicCRAc.y = -2\r\n TonicCRAc.w = 20 \r\n TonicCRAc.text = BUY \r\n TonicCRAc.SetPressed(POTIONCRAC)\r\n var TonicMIAC = Ui.AddButton()\r\n TonicMIAC.x = -3\r\n TonicMIAC.h = 1 \r\n TonicMIAC.y = 3\r\n TonicMIAC.w = 20 \r\n TonicMIAC.text = BUY \r\n TonicMIAC.SetPressed(POTIONMIAC)\r\n var TonicVAc = Ui.AddButton()\r\n TonicVAc.x = 19\r\n TonicVAc.h = 1 \r\n TonicVAc.y = 3\r\n TonicVAc.w = 20 \r\n TonicVAc.text = BUY \r\n TonicVAc.SetPressed(POTIONKAC)\r\n var TonicMG = Ui.AddButton()\r\n TonicMG.w = 20\r\n TonicMG.y = -2\r\n TonicMG.h = 1\r\n TonicMG.x = 25\r\n TonicMG.tcolor = #FF10F0\r\n TonicMG.text = BUY\r\n TonicMG.SetPressed(MutageMGAC)\r\n var TonicMCR = Ui.AddButton()\r\n TonicMCR.w = 20\r\n TonicMCR.y = 3\r\n TonicMCR.h = 1\r\n TonicMCR.x = 3\r\n TonicMCR.tcolor = #FF10F0\r\n TonicMCR.text = BUY\r\n TonicMCR.SetPressed(MutageCRAC)\r\n var TonicMM = Ui.AddButton()\r\n TonicMM.w = 20\r\n TonicMM.y = 3\r\n TonicMM.x = 25\r\n TonicMM.tcolor = #FF10F0\r\n TonicMM.text = BUY\r\n TonicMM.h = 1\r\n TonicMM.SetPressed(MutageMissionsAC)\r\nTonicMM.visible = false\r\nTonicMCR.visible = false\r\nTonicMG.visible = false\r\nLab.visible = false\r\nTonicMIAC.visible = false\r\nTonicELc.visible = false\r\nTonicCRAc.visible = false\r\nTonicVAc.visible = false\r\nTonicMKL.visible = false\r\nHPUp.visible = false\r\nHPDown.visible = false\r\nvar HEt = false\r\nvar HBRt = false\r\nfunc he()\r\n HEt = !HEt\r\nfunc hbr()\r\n HBRt = !HBRt\r\n\r\n?HBRt = true\r\n >`@xH@,@yH@,@help［1］@\r\n LimiteYH = -62\r\n HPUp.visible = true\r\n HPDown.visible = true\r\n?HT = true\r\n HE.visible = true\r\n HBR.visible = true\r\n?HT = false\r\n HE.visible = false\r\n HBR.visible = false\r\n?HEt = true\r\n >`@xH@,@yH@,@help［0］@\r\n  LimiteYH = -65\r\n HPUp.visible = true\r\n HPDown.visible = true\r\nvar MarketVisible = false\r\nfunc Markett()\r\n MarketVisible = !MarketVisible\r\n\r\n\r\nvar PotionEActivate = false\r\nvar BuffDE = Sg(＂BuffDE＂,0)\r\n\r\nfunc POTIONEAC()\r\n ?CR >= 25\r\n  CR = CR - 25\r\n  St(＂CR＂,CR)\r\n  BuffDE = BuffDE + 10\r\n  St(＂BuffDE＂,BuffDE)\r\n\r\n?BuffDE > 0\r\n PotionEActivate = true\r\n:?BuffDE = 0\r\n PotionEActivate = false\r\n PotionE = 0\r\n?PotionEActivate = true\r\n >`28,2,#yellow,«»@BuffDE@\r\n >`36,2,#blue,<>@BuffDE@\r\n >`43,2,#90FF00,:∞:@BuffDE@\r\n >`51,2,#FF0000,\\V/@BuffDE@\r\n >`59,2,±@BuffDE@\r\n PotionE = 2\r\n ?LB | LL\r\n  BuffDE = BuffDE - 1\r\n  St(＂BuffDE＂,BuffDE)\r\n\r\n\r\n\r\nvar PotionCRActivate = false \r\nvar BuffDCR = Sg(＂BuffDCR＂,0)\r\nvar CRascii = 1\r\nfunc POTIONCRAC() \r\n  ?CF >= 1000 & CI >= 1000 & CVI >= 1000\r\n  ^& CAE >= 1000 & CP >= 1000\r\n    CAE = CAE - 500\r\n    CVI = CVI - 1000\r\n    CI = CI - 1000\r\n    CP = CP - 1000\r\n    CF = CF - 1000\r\n    St(＂CAE＂,CAE)\r\n    St(＂CI＂,CI)\r\n    St(＂CF＂,CF)\r\n    St(＂CP＂,CP)\r\n    St(＂CVI＂,CVI)\r\n    BuffDCR = BuffDCR + 10\r\n    St(＂BuffDCR＂,BuffDCR)\r\n\r\n?BuffDCR > 0\r\n  PotionCRActivate = true \r\n:?BuffDCR = 0\r\n  \r\n PotionCRActivate = false\r\n?PotionCRActivate = true\r\n //CRascii = 2\r\n PotionCR = 2\r\n \r\n >`65,2,#blue,©@BuffDCR@\r\n ?LB |LL\r\n   BuffDCR = BuffDCR - 1 \r\n   St(＂BuffDCR＂,BuffDCR)\r\n\r\nvar PotionMIActivate = false \r\nvar BuffDMI = Sg(＂BuffDMI＂,0)\r\n\r\nfunc POTIONMIAC()\r\n  ?CF >= 1000 & CI >= 1000 & CVI >= 1000\r\n  ^& CAE >= 1000 & CP >= 1000 & CR >= 50\r\n    CAE = CAE - 500\r\n    CVI = CVI - 1000\r\n    CI = CI - 1000\r\n    CP = CP - 1000\r\n    CF = CF - 1000\r\n    CR = CR - 50\r\n    St(＂CR＂,CR)\r\n    St(＂CAE＂,CAE)\r\n    St(＂CI＂,CI)\r\n    St(＂CF＂,CF)\r\n    St(＂CP＂,CP)\r\n    BuffDMI = BuffDMI + 10\r\n    St(＂BuffDMI＂,BuffDMI) \r\n?BuffDMI > 0\r\n  PotionMIActivate = true \r\n:?BuffDMI = 0\r\n   PotionMIActivate = false\r\n   PotionMI = 1 \r\n?PotionMIActivate = true\r\n  PotionMI = 2\r\n  >`0,24,#rainFF,Missions @BuffDMI@\r\n ?LB | LL \r\n   BuffDMI = BuffDMI - 1\r\n   St(＂BuffDMI＂,BuffDMI)\r\n\r\n\r\nvar PotionKActivate = false \r\nvar BuffDK = Sg(＂BuffDK＂,0)\r\n\r\nfunc POTIONKAC() \r\n  ?CR >= 100\r\n    CR = CR - 100\r\n    St(＂CR＂,CR)\r\n    BuffDK = BuffDK + 10\r\n    St(＂BuffDK＂,BuffDK) \r\n?BuffDK > 0\r\n  PotionKActivate = true \r\n:?BuffDK = 0\r\n   PotionKActivate = false\r\n   PotionK = 0 \r\n?PotionKActivate = true\r\n  PotionK = 2\r\n  >`0,23,#red,KILL2X @BuffDK@\r\n ?LB | LL\r\n   BuffDK = BuffDK - 1 \r\n   St(＂BuffDK＂,BuffDK)\r\n\r\n\r\n\r\n\r\nfunc MutageKLAC() \r\n  ?CR  >= 25\r\n    CR = CR - 25\r\n    St(＂CR＂,CR)\r\n    MutageKiller = MutageKiller + number\r\n    MutageKiller = Mr(MutageKiller*10)\r\n    ^/10\r\n    St(＂MutageKL＂,MutageKiller)\r\nfunc MutageMGAC()\r\n   ?CR  >= 25\r\n    CR = CR - 25\r\n    St(＂CR＂,CR)\r\n    MutageGem = MutageGem + number\r\n    MutageGem = Mr(MutageGem*10)\r\n    ^/10\r\n    St(＂MutageGM＂,MutageGem)\r\n\r\nfunc MutageCRAC()\r\n   ?CR >= 50\r\n    CR = CR - 50\r\n    St(＂CR＂,CR)\r\n    chance = chance + number\r\n    chance = Mr(chance*10)\r\n    ^/10\r\n    St(＂cd＂,chance)\r\n\r\n\r\nfunc MutageMissionsAC()\r\n  ?CR >= 25\r\n   CR = CR - 25\r\n   St(＂CR＂,CR)\r\n   MutageMission = MutageMission + 1.0\r\n   St(＂MutageM＂,MutageMission)\r\n   \r\n\r\nvar MutageCRAscii\r\n\r\nMutageCRAscii = (chance/PotionCR)-2\r\nMutageCRAscii = Mr(MutageCRAscii*10)/10\r\n\r\n//Offline system\r\nvar TimeSaved = 0\r\nvar TimeSavedStorage = Sg(＂Timer＂,0)\r\nvar TimerCompair = 0\r\nvar TimerInt = Sg(＂TimerInt＂,0)\r\nvar OfflineSearch = Sg(＂OffSearch＂,false)\r\nvar OffQuit = 10\r\n//Drop Off\r\nvar MutagenDrop = 0\r\nvar TimerDrop = Sg(＂TimerDrop＂,0)\r\nvar WarningDrop = 0\r\nvar WarningDropNumber = Sg(＂WarningD＂,0)\r\n\r\n?WarningDrop>0\r\n >`0,0,#yellow,You gained @WarningDropNumber@ \r\n ^on all mutages\r\n WarningDrop--\r\n\r\n\r\n\r\nfunc Save()\r\n TimeSaved = time.msbn\r\n TimeSaved = \r\n ^Math.BigNumber(TimeSaved.ToString())\r\n TimeSaved.Div(1000)\r\n TimeSaved.Div(60)\r\n TimeSavedStorage = TimeSaved.ToString()\r\n St(＂Timer＂,TimeSavedStorage)\r\n OfflineSearch = true\r\n St(＂OffSearch＂,OfflineSearch)\r\n loc.leave()\r\n\r\n?OfflineSearch = true\r\n ?TT%2\r\n  TimerCompair = time.msbn\r\n  TimerCompair = \r\n  ^Math.BigNumber(TimerCompair.ToString())\r\n  TimeSaved = Math.BigNumber\r\n  ^(TimeSavedStorage)\r\n  TimerCompair.Div(1000)\r\n  TimerCompair.Div(60)\r\n  TimerCompair.Sub(TimeSaved)\r\n  TimerInt = Int.Parse(TimerCompair.ToString())\r\n  //^*10000\r\n  St(＂TimerInt＂,TimerInt)\r\n  ?TimerDrop < TimerInt/60\r\n   TimerDrop = TimerDrop+1\r\n   St(＂TimerDrop＂,TimerDrop)\r\n   ?TT%2 & TimerDrop>0\r\n     MutagenDrop = rngf*100\r\n     ?MutagenDrop <= 10\r\n      MutageMission = MutageMission + 1\r\n\r\n      St(＂MutageM＂,MutageMission)\r\n      chance = chance + 0.1\r\n      chance = Mr(chance*10)/10\r\n      St(＂cd＂,chance)\r\n      MutageGem = MutageGem + 0.1\r\n      MutageGem = Mr(MutageGem*10)/10\r\n      St(＂MutageGM＂,MutageGem)\r\n      MutageKiller = MutageKiller+0.1\r\n      MutageKiller=\r\n      ^Mr(MutageKiller*10)/10\r\n      St(＂MutageKL＂,MutageKiller)\r\n      WarningDropNumber = \r\n      ^WarningDropNumber+0.1\r\n      WarningDropNumber =\r\n      ^Mr(WarningDropNumber*10)/10\r\n      St(＂WarningD＂,WarningDropNumber)\r\n      WarningDrop = 60\r\n\r\n  \r\n \r\n\r\n\r\n\r\nfunc Claim()\r\n    MT = MT + 1*TimerInt\r\n    MM = MM + 1*TimerInt\r\n    MB = MB + 1*TimerInt\r\n    ML = ML + 1*TimerInt\r\n    CF = CF + 2*TimerInt\r\n    CI = CI + 2*TimerInt\r\n    CAE = CAE + 2*TimerInt\r\n    CVI = CVI + 2*TimerInt\r\n    CP = CP + 2*TimerInt\r\n    CR = CR + 0.1*TimerInt\r\n    CR = Mr(CR*10)/10\r\n     WarningDropNumber = 0\r\n    St(＂WarningD＂,WarningDropNumber)\r\n    St(＂mt＂,MT)\r\n    St(＂MM＂,MM)\r\n    St(＂mb＂,MB)\r\n    St(＂ml＂,ML)\r\n    St(＂CF＂,CF)\r\n    St(＂CI＂,CI)\r\n    St(＂CAE＂,CAE)\r\n    St(＂CVI＂,CVI)\r\n    St(＂CP＂,CP)\r\n    St(＂CR＂,CR)\r\n    TimeSavedStorage = 0\r\n    St(＂Timer＂,TimeSavedStorage)\r\n    OfflineSearch = false\r\n    St(＂OffSearch＂,OfflineSearch)\r\n    TimerDrop = 0\r\n    St(＂TimerDrop＂,TimerDrop)\r\n\r\nvar SearchAscii = ［ascii\r\n        SEARCH OFFLINE\r\nSearch Gains:\r\n120 Gems/per hour\r\n(2 per Minute)\r\n6 ©/per Hour\r\n(0.1 per Minute)\r\n60 Kills in Missions/per Hour\r\n(1 per Minute)\r\n10% chance to Drop Mutagens\r\n(Every hour)\r\nasciiend］\r\n\r\nvar SearchHUDD = false\r\nfunc SearchHUD()\r\n SearchHUDD = !SearchHUDD\r\nvar AnimSearch = 0\r\n?LB | LL\r\n var SearchB = Ui.AddButton()\r\n SearchB.y = -6\r\n SearchB.h = 3\r\n SearchB.w = 8\r\n SearchB.text = ＂Search＂\r\n SearchB.x = -29\r\n SearchB.SetPressed(SearchHUD)\r\n var SearchP = Ui.AddPanel()\r\n SearchP.h = 15\r\n SearchP.color = #yellow\r\n var StartOffButton = Ui.AddButton()\r\n StartOffButton.w = 28\r\n StartOffButton.h = 3\r\n StartOffButton.y = 5\r\n?OfflineSearch = false\r\n StartOffButton.SetPressed(Save)\r\n  StartOffButton.text = ＂Start Search＂\r\n \r\nSearchP.w = AnimSearch\r\nSearchP.visible = false\r\nSearchB.visible = false\r\nStartOffButton.visible = false\r\n?SearchHUDD = true\r\n ?point>=40\r\n  SearchP.visible = true\r\n\r\n  ?AnimSearch >=31\r\n   StartOffButton.visible = true\r\n   >c-14,-6,@SearchAscii［0］@\r\n   AnimSearch = 31\r\n  :\r\n   AnimSearch = AnimSearch+2\r\n :\r\n  >`0,0,#red,\r\n  ^Search Offline available after ＂XP = 40＂\r\n:\r\n AnimSearch = 0\r\n?OfflineSearch = true \r\n button.visible = false\r\n SearchP.visible = true\r\n SearchP.w = 31\r\n StartOffButton.bcolor = #yellow\r\n StartOffButton.visible = true\r\n StartOffButton.text = ＂Claim＂\r\n StartOffButton.SetPressed(Claim)\r\n  ?TT%31 = 30\r\n   OffQuit--\r\n  ?OffQuit = 0\r\n   loc.leave()\r\n\r\n StartOffButton.visible = true\r\n  >c-14,-6,      CLAIM OFFLINE SEARCH\\n\r\n  ^Time Search:\\n\r\n  ^Days:@(TimerInt/60)/24@|\r\n  ^Hours:@TimerInt/60@|Minutes:@TimerInt@\\n\r\n  ^Search Gains:\\n\r\n  ^Gems Gains:@2*TimerInt@\\n\r\n  ^© Gains:@0.1*TimerInt@\\n\r\n  ^Foe Killed:@TimerInt@\\n\r\n  ^Mutage Gains:@WarningDropNumber@\\n\\n\r\n  ^Expulsion in:@OffQuit@\r\n\r\n  AnimSearch = 31\r\n\r\n\r\n?MarketVisible = true\r\n ?point >= 20\r\n  >c-14,-6,@MarketAscii［0］@\r\n  >c23,-5,#rainbow,©\r\n  >c20,1,#red,ALLKILL\r\n  >c23,0,#red,KILL\r\n  >c20,-4,#rainbow,©\r\n  >c-7,-3,#rainbow,©\r\n  >c4,2,#rainbow,©\r\n  >c15,2,#rainbow,©\r\n  TonicELc.visible = true\r\n  TonicCRAc.visible = true\r\n  TonicMIAC.visible = true\r\n  TonicVAc.visible = true\r\n :\r\n  >`0,0,#red,Market available after ＂XP = 20＂\r\n\r\n?LabAscii = true\r\n ?point >= 30\r\n  >c-8,-7,#90FF00,@MarketAscii［1］@\r\n  >c9,-7,#FF10F0,LABORATORY\r\n  TonicMG.visible = true\r\n  TonicMKL.visible = true\r\n  TonicMCR.visible = true\r\n  TonicMM.visible = true\r\n  >c23,-4,#FF10F0,X@MutageGem@\r\n  >c1,-4,#FF10F0,X@MutageKiller@\r\n  >c1,1,#FF10F0,+@MutageCRAscii@\r\n  >c23,1,#FF10F0,-@MutageMission@\r\n  >c-2,-3,#rainFF,©\r\n  >c20,-3,#rainFF,©\r\n  >c-2,2,#rainFF,©\r\n  >c-6,0,#rainFF,©\r\n  >c-6,22,#rainFF,©\r\n :\r\n  >`0,0,#red,Laboratory available after ＂XP = 30＂\r\n\r\n?her = false\r\n m.visible = false\r\n Reward.visible = false\r\n HB.visible = false\r\n Market.visible = false\r\n?her = true\r\n m.visible = true\r\n Reward.visible = true\r\n HB.visible = true\r\n Market.visible = true\r\n Lab.visible = true\r\n ?HT = true\r\n  SearchB.visible = false\r\n :\r\n  SearchB.visible = true\r\n"
✗ "/Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/TowerDefense.txt" - Parse error: Failed to parse completely. Remaining: "(\"Version\")+\" 3.0\"\r\nvar versiontxt\r\nvar difficulty=1\r\nvar diffup\r\nvar diffdown\r\nvar locations=[\"Forest\",\"Volcano\"]\r\nvar location=1\r\nvar locleft\r\nvar locright\r\nvar loctxt\r\nvar title\r\nvar titleasci=ascii\r\n##._._._.##########################____#######____\r\n#/_  __/___#_######_____##_____###/    \\___##/ __/__##____##________\r\n##/ /#/ __ \\ |#/|#/ / _ \\/ ___/##/ __\\ / _ \\/ /_/ _ \\/ __ \\/ ___/ _ \\\r\n#/ /#/ /_/ / |/ |/ /  __/ /#####/   .´/  __/ __/  __/ /#/ (__  )  __/\r\n/_/##\\____/|__/|__/\\___/_/#####/_____/\\___/_/##\\___/_/#/_/____/\\___/\r\nasciiend\r\n//-~-Upgrades-~-\\\\\r\nvar ubtnspeed\r\nvar ubtndamage\r\nvar ubtncritunlock\r\nvar ubtncritdamage\r\nvar ubtncritchance\r\nvar ubtnpierceunlock\r\nvar ubtnpiercechance\r\nvar ubtnpiercemax\r\nvar ubtnbleedunlock\r\nvar ubtnbleeddamage\r\nvar ubtnbleedchance\r\nvar ubtnhealth\r\nvar ubtnregen\r\nvar ubtnarmorunlock\r\nvar ubtnarmormax\r\nvar ubtnarmorregen\r\nvar upgradepage=2\r\nvar basiclvl=0\r\nvar heavylvl=0\r\nvar quicklvl=0\r\nvar speedlvl=1\r\nvar damagelvl=1\r\nvar healthlvl=1\r\nvar regenlvl=1\r\nvar regen=1.5\r\nvar armormaxlvl=0\r\nvar armorregenlvl=0\r\nvar piercemaxlvl=0\r\nvar piercechancelvl=0\r\nvar pierceChance=0\r\nvar pierceRng\r\nvar critdamagelvl=0\r\nvar critchancelvl=0\r\nvar critChance=0\r\nvar critRng\r\nvar critDamage=1.5\r\nvar bleeddamagelvl=0\r\nvar bleedchancelvl=0\r\nvar bleedChance=0\r\nvar bleedRng\r\nvar bleedDmg=0.5\r\nvar bleedDuration=150\r\nvar upgradepnl\r\nvar infopnl\r\nvar infotitle\r\nvar infodesc\r\nvar infoupgrade\r\nvar infocost\r\nvar infolevel\r\nvar selected\r\nvar stattxt1\r\nvar stattxt2\r\nvar upgradeinfo=[]\r\n//-~-Score-~-\\\\\r\nvar score\r\nvar highscore\r\n//-~-Shop-~-\\\\\r\nvar coins\r\nvar coinchancerng\r\nvar coincountrng\r\nvar shop\r\nvar shoppnl\r\nvar shopopen\r\nvar weapontab\r\nvar towertab\r\nvar utiltab\r\nvar statstab\r\nvar shoptxt\r\nvar shopasci = ascii\r\n#_______\r\n|       |\r\n#¯¯¯¯¯¯¯\r\n#-┌───┌\r\n##_)_(_\r\nasciiend\r\n//-~-Tower-~-\\\\\r\nvar twrhptxt\r\nvar towerhp\r\nvar towermaxhp=15+healthlvl*5\r\nvar towerperc\r\nvar tower\r\nvar towerback\r\nvar crystal\r\nvar backpanel\r\nvar backcanvas\r\nvar background\r\nvar forestasci=ascii\r\n                                                                                                         \r\n.                         .                                      .                                       \r\n             .                                .                                            .             \r\n      .            .                                                              .                      \r\n                             .        _,._      _    .                                                   \r\n                                    ,´ ,´ `    ((                     .                                  \r\n                                   /  /         ¯                                                        \r\n                     .             |  '                                                  .               \r\n                   |           .   \\   `.__,/                 .                                          \r\n                   |                `._  _,´                                     .                       \r\n                   |     .             ¯¯    .                               .                           \r\n                   |                        / \\       .                     / \\                          \r\n                   |                      .´ ' `.               .         .´ ' `.                        \r\n                   |    .         .        /   \\         .                 /   \\       .         .       \r\n                   |   / \\               .´     `.      / \\              .´     `.              / \\      \r\n                   |  ´ ' `   .      .  ´  '   '  `    ´ ' `      .     ´  '   '  `      .     ´ ' `     \r\n      100% HP      |  /   \\  / \\    / \\ ./       \\.    /   \\     / \\    ./       \\.     / \\    /   \\     \r\n                   |.´ ' ' `. ' `  ´ '.´ '   '   ' `..´ ' ' `.  ´ ' ` .´ '   '   ' `.  ´ ' ` .´ ' ' `.   \r\n                   | /     \\/   \\  /   /           \\  /     \\   /   \\  /           \\   /   \\  /     \\    \r\n                   |´ '   ' `. ' `. '.´             .´ '   ' `.´ ' ' `.             `.´ ' ' .´ '   ' `.  \r\n                   |         \\   \\  ´  '     '     '/         \\/     \\ '     '     '  `     /         \\  \r\n                   |'   '   ' `.' `.   ' `.|   |  .´ '   '   ' `.   ' `.   |   |    .´ '  .´ '   '   ' `.\r\n                   |  |   |        \\      \\|   |       |   | /         \\   |   |    /        \\ |   |     \r\n                   |  |   |   '   ' `.   ' |   |       |   |´ '   '   ' `. |   |  .´ '   '  ' `|   |     \r\n                   |  |   | |   |  |   |   |   |       |   |     |  |      |   |       |   |   |   |     \r\n%%\r\n                                                                                                         \r\n.                         .                                      .                                       \r\n             .                                .                                            .             \r\n      .            .                                            (¯)      ('¯)     _(¯¯¯¯'¯'  .           \r\n                             .        _,._      _    .         (_( )    (_)_))   ( (     ) ('¯  _(¯¯¯¯'¯'\r\n                                    ,´ ,´ `    ((                     .        (( (  ))   )_)_ ( (     ) \r\n                                   /  /         ¯                ('¯)         _(¯¯¯¯'¯'     '_( (  ))   )\r\n                     .             |  '                         (_)_))    (¯ ( (     )   _(¯¯¯ '__))¯¯¯¯ \r\n                   |           .   \\   `.__,/                 .          (_(( (  ))   ) ( (     )  )   (_\r\n                   |                `._  _,´                                 '__))¯¯¯¯ ( (  ))   )     . \r\n                   |     .             ¯¯    .                      (¯)      .          '__))¯¯¯¯ (¯)    \r\n                   |                        / \\       .            (_( )    / \\       (_( )              \r\n                   |                      .´ ' `.               .         .´ ' `.                        \r\n                   |    .         .        /   \\         .                 /   \\       .         .       \r\n                   |   / \\               .´     `.      / \\              .´     `.              / \\      \r\n    75% HP         |  ´ ' `   .      .  ´  '   '  `    ´ ' `      .     ´  '   '  `      .     ´ ' `     \r\n                   |  /   \\  / \\    / \\ ./       \\.    /   \\     / \\    ./       \\.     / \\    /   \\     \r\n                   |.´ ' ' `. ' `  ´ '.´ '   '   ' `..´ ' ' `.  ´ ' ` .´ '   '   ' `.  ´ ' ` .´ ' ' `.   \r\n                   | /     \\/   \\  /   /           \\  /     \\   /   \\  /           \\   /   \\  /     \\    \r\n                   |´ '   ' `. ' `. '.´             .´ '   ' `.´ ' ' `.             `.´ ' ' .´ '   ' `.  \r\n                   |         \\   \\  ´  '     '     '/         \\/     \\ '     '     '  `     /         \\  \r\n                   |'   '   ' `.' `.   ' `.|   |  .´ '   '   ' `.   ' `.   |   |    .´ '  .´ '   '   ' `.\r\n                   |  |   |        \\      \\|   |       |   | /         \\   |   |    /        \\ |   |     \r\n                   |  |   |   '   ' `.   ' |   |       |   |´ '   '   ' `. |   |  .´ '   '  ' `|   |     \r\n                   |  |   | |   |  |   |   |   |       |   |     |  |      |   |       |   |   |   |     \r\n%%\r\n                                                                                                         \r\n.                         .                                      .                                       \r\n             .                                .     ('¯)                 _(¯¯¯¯'¯'                    .  \r\n      .            .                               (_)_))     _(¯¯¯¯'¯' ( (     )  _(¯¯¯¯'¯ (¯¯¯¯'¯''    \r\n                             .        _,._      _    .       ( (   ' ) ( (  ))    ( (      '    )  )   (_\r\n                                    ,´ ,´ `    ((           _(¯¯¯¯'¯'  (   )   ) '__))¯¯¯¯( (  ))    (  )\r\n                                   /  /         ('¯)       ( (   ' ) ))¯¯  _(¯¯ ¯'¯'¯ ('¯)  '_)¯¯¯¯ '__))\r\n                     .             |  '        (_)_))     ( (  ))    _ ( (     ) )¯ ( (     )   _(¯¯¯ '__\r\n                   |           .   \\   `.__,/              '__))¯¯¯'¯'¯  '  .     ( (  )( (  )   ) ( (   \r\n                   |                `._  _,´                        ( (     )   '__)(¯¯'¯'¯¯¯¯    '__))¯¯\r\n                   |     .             ¯¯    .           ('¯)      ( (  ))   ) (¯)  ( (     )  '__))¯¯¯¯ \r\n                   |                        / \\       . (_)_))      '__))¯¯¯¯ (_( )  ( (  ))   )         \r\n                   |                      .´ ' `.               .         .´ ' `.     '__))¯¯¯¯                     \r\n                   |    .         .        /   \\         .                 /   \\       .         .       \r\n                   |   / \\               .´     `.      / \\              .´     `.              / \\      \r\n     50% HP        |  ´ ' `   .      .  ´  '   '  `    ´ ' `      .     ´  '   '  `      .     ´ ' `     \r\n                   |  /   \\  / \\    / \\ ./       \\.    /   \\     / \\    ./       \\.     / \\    /   \\     \r\n                   |.´ ' ' `. ' `  ´ '.´ '   '   ' `..´ ' ' `.  ´ ' ` .´ '   '   ' `.  ´ ' ` .´ ' ' `.   \r\n                   | /     \\/   \\  /   /           \\  /     \\   /   \\  /           \\   /   \\  /     \\    \r\n                   |´ '   ' `. ' `. '.´             .´ '   ' `.´ ' ' `.             `.´ ' ' .´ '   ' `.  \r\n                   |         \\   \\  ´  '     '     '/         \\/     \\ '     '     '  `     /         \\  \r\n                   |'   '   ' `.' `.   ' `.|   |  .´ '   '   ' `.   ' `.   |   |    .´ '  .´ '   '   ' `.\r\n                   |  |   |        \\      \\|   |       |   | /         \\   |   |    /        \\ |   |     \r\n                   |  |   |   '   ' `.   ' |   |       |   |´ '   '   ' `. |   |  .´ '   '  ' `|   |     \r\n                   |  |   | |   |  |   |   |   |       |   |     |  |      |   |       |   |   |   |     \r\n%%\r\n                                                                                                         \r\n.                         .                                      .                                       \r\n             .                                .     ('¯)                 _(¯¯¯¯'¯'                    .  \r\n      .            .       ('¯)                    _(¯¯¯¯'¯' _(¯¯¯¯'¯' ( (     )  _(¯¯¯¯'¯ (¯¯¯¯'¯''     \r\n                          (_)_))      _,._(¯¯¯¯'¯ ( (     ) '    .       ( (   ' ) ( (  ))    ( (      ' \r\n                                    ,´  ( (     )( (  ))   )         .  _(¯¯¯¯'¯'  (   )   ) '__))¯¯¯¯( (\r\n                        ('¯)       /  /( (  ))    '__))¯¯¯¯ )'¯)   '   ( (   ' ) ))¯¯  _(¯¯ ¯'¯'¯ ('¯)  '\r\n                     . (_)_))      | _(¯¯¯¯'¯'' '__))¯(¯¯'¯'¯¯ '  .    (_))     ( (  ))    _ ( (     ) )¯\r\n                   |           .   \\( (     ) _(¯' ¯'   `.__,/  (    )     _(¯¯¯¯'¯'  '__))¯¯¯'¯'¯  '  . \r\n                   |               ( (  ))  (     ) `._(¯¯¯¯'¯'  _,´   ( (  ))   ( (     )  )            \r\n                   |     .          '__))¯¯¯¯ (  ))   )(       _(¯¯¯¯'¯'  '__))¯¯¯( (  ))   )¯   ('¯)    \r\n                   |          (¯)           / \\ '__))¯   )    ( (     ) __))¯¯¯¯ (_)_))      '__))¯¯¯¯ (_\r\n                   |         (_( )        .´ ' `.      '__))¯( (  ))   )  .´ ' `.     '__))¯¯¯¯          \r\n                   |    .         .        /   \\         .    '__))¯¯¯¯    /   \\       .         .       \r\n                   |   / \\               .´     `.      / \\              .´     `.              / \\      \r\n     25% HP        |  ´ ' `   .      .  ´  '   '  `    ´ ' `      .     ´  '   '  `      .     ´ ' `     \r\n                   |  /   \\  / \\    / \\ ./       \\.    /   \\     / \\    ./       \\.     / \\    /   \\     \r\n                   |.´ ' ' `. ' `  ´ '.´ '   '   ' `..´ ' ' `.  ´ ' ` .´ '   '   ' `.  ´ ' ` .´ ' ' `.   \r\n                   | /     \\/   \\  /   /           \\  /     \\   /   \\  /           \\   /   \\  /     \\    \r\n                   |´ '   ' `. ' `. '.´             .´ '   ' `.´ ' ' `.             `.´ ' ' .´ '   ' `.  \r\n                   |         \\   \\  ´  '     '     '/         \\/     \\ '     '     '  `     /         \\  \r\n                   |'   '   ' `.' `.   ' `.|   |  .´ '   '   ' `.   ' `.   |   |    .´ '  .´ '   '   ' `.\r\n                   |  |   |        \\      \\|   |       |   | /         \\   |   |    /        \\ |   |     \r\n                   |  |   |   '   ' `.   ' |   |       |   |´ '   '   ' `. |   |  .´ '   '  ' `|   |     \r\n                   |  |   | |   |  |   |   |   |       |   |     |  |      |   |       |   |   |   |     \r\nasciiend\r\nvar volcanoasci=ascii\r\n                                                                                                         |\r\n.                        .             .            .                     .                              |\r\n             .             _,._      _                                                      .            |\r\n      .            .     ,´ ,´ `    ((                        .                                          |\r\n                        /  /         ¯       .                                      .                    |\r\n                        |  '                    .-----¯¯¯¯------.        .                         .     |\r\n                        \\   `.__,/            .´-.---______--.-.-`.              ___------___            |\r\n                         `._  _,´           .´  /   /   |    |  \\  `.          .:::;::       `.          |\r\n                   |   .    ¯¯          .  /  .´  _/     \\    \\  `   \\        /:;:::'          \\      .  |\r\n                   |              .       /     ./ |      |   |       `.    .::::::'            \\        |\r\n                   |                    ./     /   |      '    `.__     \\  /::;::'               `.      |\r\n                   |__----__  .       .´      ´   / \\__          \\  `    \\´:;:::'                  \\     |\r\n                   |:::;    `.       /           |     `          \\       \\':::'                    \\    |\r\n                   |:;:'      \\     /:.         /                 /`.      `.:'                      \\   |\r\n                   |:'         `. .::::        /                 ´   |       \\                        `. |\r\n    100% HP        |'            /::;:'        |                      \\       \\                         \\|\r\n                   |            /;::::         |                       \\       \\.                        |\r\n                   |          ./:::;:'       .´                         `.       `.                      |\r\n                   |        .:::;::::       /                                       `.                   |\r\n                   |      .:;::::::'        |                                         \\                  |\r\n                   |     /:::::::;:        /                                           \\                 |\r\n                   |    /::::;:::'       .¯                                             `.               |\r\n                   |  .::;:::::::                                                         \\              |\r\n                   | /:::::;::::'                                                          `.            |\r\n                   |´::;::::::::                                                             `.          |\r\n%%\r\n                                                                                                         |\r\n.                        .             .            .   ('¯)           (¯)           .                   |\r\n             .             _,._      _       ('¯)      (_)_))         (_( )                      .       |\r\n      .            .     ,´ ,´ `    ((      (_)_))               ('¯)     .                              |\r\n                        /  /         ¯       .                  (_)_))              .                    |\r\n                        |  '          (¯)       .-----¯¯¯¯------.        .                         .     |\r\n                        \\   `.__,/   (_( )    .´-.---______--.-.-`.              ___------___            |\r\n                         `._  _,´           .´  /   /   |  (¯)  \\  `.          .:::;::       `.          |\r\n                   |   .    ¯¯          .  /  .´  _/     \\(_( )  `   \\        /:;:::'          \\      .  |\r\n                   |              .       /     ./ |      |   |       `.    .::::::'            \\        |\r\n                   |                    ./     /   |      '    `.__     \\  /::;::'               `.      |\r\n                   |__----__  .       .´      ´   / \\__          \\  `    \\´:;:::'                  \\     |\r\n                   |:::;    `.       /           |     `          \\       \\':::'                    \\    |\r\n                   |:;:'      \\     /:.         /                 /`.      `.:'                      \\   |\r\n                   |:'         `. .::::        /                 ´   |       \\                        `. |\r\n     75% HP        |'            /::;:'        |                      \\       \\                         \\|\r\n                   |            /;::::         |                       \\       \\.                        |\r\n                   |          ./:::;:'       .´                         `.       `.                      |\r\n                   |        .:::;::::       /                                       `.                   |\r\n                   |      .:;::::::'        |                                         \\                  |\r\n                   |     /:::::::;:        /                                           \\                 |\r\n                   |    /::::;:::'       .¯                                             `.               |\r\n                   |  .::;:::::::                                                         \\              |\r\n                   | /:::::;::::'                                                          `.            |\r\n                   |´::;::::::::                                                             `.          |\r\n%%\r\n                                                                                                         |\r\n.                        .             .          _(¯¯¯¯'¯')              .  ('¯)                        |\r\n             .             _,._      _ ('¯)      ( (     ) )   .            (_)_))          .            |\r\n      .            .     ,´ ,´ `    (((_)_))    ( (  ))   ))    _(¯¯¯¯'¯')                               |\r\n                        /  /         ¯       .   '__))¯¯¯¯     ( (     ) ))         .                    |\r\n                        |  '           _(¯¯¯¯'¯') ----¯¯¯¯----( (  ))   ))         (¯)             .     |\r\n                        \\   `. ('¯)   ( (     ) ))---______--. '__))¯¯¯¯         _(_( )---___            |\r\n                         `._  (_)_)) ( (  ))   ))   /   |    |  \\  `.     ('¯) .:::;::       `.          |\r\n                   |   .    ¯¯        '__))¯¯¯¯   _/ ('¯)\\    \\  `   \\   (_)_)):;:::'          \\      .  |\r\n                   |              .       /     ./ |(_)_))|   |   (¯) `.    .::::::'            \\        |\r\n                   |                   (¯)     /   |      '    `.(_( )  \\  /::;::'               `.      |\r\n                   |__----__  .       (_( )   ´   / \\__          \\  `    \\´:;:::'                  \\     |\r\n                   |:::;    `.       /           |     `          \\       \\':::'                    \\    |\r\n                   |:;:'      \\     /:.         /                 /`.      `.:'                      \\   |\r\n                   |:'         `. .::::        /                 ´   |       \\                        `. |\r\n     50% HP        |'            /::;:'        |                      \\       \\                         \\|\r\n                   |            /;::::         |                       \\       \\.                        |\r\n                   |          ./:::;:'       .´                         `.       `.                      |\r\n                   |        .:::;::::       /                                       `.                   |\r\n                   |      .:;::::::'        |                                         \\                  |\r\n                   |     /:::::::;:        /                                           \\                 |\r\n                   |    /::::;:::'       .¯                                             `.               |\r\n                   |  .::;:::::::                                                         \\              |\r\n                   | /:::::;::::'                                                          `.            |\r\n                   |´::;::::::::                                                             `.          |\r\n%%\r\n                                                                                                         \r\n.                        .              _(¯¯¯¯'¯'  _(¯¯¯¯'¯')) .            .                     .      |\r\n             .             _,. ('¯)  _ ( (     )  ( (     )   ))_(¯¯¯¯¯¯¯'¯')                            |\r\n      .            .    (¯) ,´(_)_))((( (  ))   )( (  ))      ( (     ) )    _(¯¯¯¯'¯')                  |\r\n                       (_( )         ¯ '__)  _(¯¯ '__))¯¯¯  _(( (  ))    _(¯ ( (     ) )¯¯¯'¯') ))       |\r\n                        |  '          _(¯¯¯¯'¯'(       ) '__))¯¯¯¯      ( ( ( (     ))   ))   ('¯)) .    |\r\n                        \\    ('¯)    ( (     )  (     )  _(¯¯¯¯'¯') ( (   '__)  )¯¯¯¯  ))   )(_)_)))     |\r\n                         `._(_)_))  ( (  ))   )'__))¯ ( (     )¯¯¯  ' '__))¯¯¯¯  __))¯¯¯¯     )          |\r\n                   |   .  (¯)        '__))¯¯¯¯      .( (  )  )   ))  _(¯¯¯¯'¯')  /     _(¯¯¯¯'¯')        |\r\n                   |     (_( )    .       /     ./ |  '__))¯¯¯¯   ( (     ) )  |  ( (     ) ) ('¯)       |\r\n                   |                    ('¯)   /   |      '    `.( (  ))   ))_( (  ))  ('¯)  (_)_))      |\r\n                   |__----__  .       .(_)_)) ´   / \\__           '__))¯¯¯¯ `__))¯¯¯¯ (_)_))       \\     |\r\n                   |:::;    `.       /           |     `          \\       \\':::'                    \\    |\r\n                   |:;:'      \\     /:.         /                 /`.      `.:'                      \\   |\r\n                   |:'         `. .::::        /                 ´   |       \\                        `. |\r\n     25% HP        |'            /::;:'        |                      \\       \\                         \\|\r\n                   |            /;::::         |                       \\       \\.                        |\r\n                   |          ./:::;:'       .´                         `.       `.                      |\r\n                   |        .:::;::::       /                                       `.                   |\r\n                   |      .:;::::::'        |                                         \\                  |\r\n                   |     /:::::::;:        /                                           \\                 |\r\n                   |    /::::;:::'       .¯                                             `.               |\r\n                   |  .::;:::::::                                                         \\              |\r\n                   | /:::::;::::'                                                          `.            |\r\n                   |´::;::::::::                                                             `.          |\r\nasciiend\r\nvar locasci=[forestasci,volcanoasci]\r\nvar towerasci=ascii\r\n¯|###|¯|###|¯|###|¯|\r\n¯#¯#¯#¯#¯|¯#¯#¯#¯#¯|\r\n\r\n\r\n\r\n\r\n#################|¯|\r\n¯#¯#¯#¯#¯|¯#¯#¯#¯#¯|\r\n\r\n\r\n\r\n\r\n#################|¯|\r\n¯#¯#¯#¯#¯|¯#¯#¯#¯#¯|\r\n\r\n\r\n\r\n\r\n#################|¯|\r\n¯#¯#¯#¯#¯|¯#¯#¯#¯|¯|\r\nasciiend\r\nvar towerbackasci=ascii\r\n  |¯|   |¯|   |¯|  \r\n ─ ┬ ─ ┬ | ┬ ─ ┬ ─ |\r\n ┬ ┴ ┬ ┴ | ┴ ┬ ┴ ┬ |\r\n ┴ ┬ ┴ ┬ | ┬ ┴ ┬ ┴ |\r\n ┬ ┴ ┬ ┴ | ┴ ┬ ┴ ┬ |\r\n ┴ ┬ ┴ ┬ | ┬ ┴ ┬ ┴ |\r\n ┬ ┴ ┬ ┴ | ┴ ┬ ┴ |¯|\r\n ─ ┬ ─ ┬ | ┬ ─ ┬ ─ |\r\n ┬ ┴ ┬ ┴ | ┴ ┬ ┴ ┬ |\r\n ┴ ┬ ┴ ┬ | ┬ ┴ ┬ ┴ |\r\n ┬ ┴ ┬ ┴ | ┴ ┬ ┴ ┬ | \r\n ┴ ┬ ┴ ┬ | ┬ ┴ ┬ ┴ |\r\n ┬ ┴ ┬ ┴ | ┴ ┬ ┴ |¯|\r\n ─ ┬ ─ ┬ | ┬ ─ ┬ ─ |\r\n ┬ ┴ ┬ ┴ | ┴ ┬ ┴ ┬ | \r\n ┴ ┬ ┴ ┬ | ┬ ┴ ┬ ┴ |\r\n ┬ ┴ ┬ ┴ | ┴ ┬ ┴ ┬ | \r\n ┴ ┬ ┴ ┬ | ┬ ┴ ┬ ┴ |\r\n ┬ ┴ ┬ ┴ | ┴ ┬ ┴ |¯|\r\n ─ ┬ ─ ┬ | ┬ ─ ┬ |¯|\r\nasciiend\r\nvar crystalasci=ascii\r\n#___________\r\n/ \\/ \\ / \\/ \\\r\n`.¯¯\\¯¯¯/¯¯.´\r\n##`. \\ / .´\r\n####`._.´\r\nasciiend\r\n//-~-Player-~-\\\\\r\nvar equipped\r\nvar bow\r\nvar bowasci\r\nvar reloadtime\r\nvar reloadtimer\r\nvar reloaded\r\nvar player\r\nvar currentarmor\r\nvar armormax\r\nvar forcefield\r\nvar armortxt\r\nvar armorperc\r\nvar armorpnl\r\nvar playerasci=ascii\r\n#O\r\n(╤═}\r\n/#\\\r\n%%\r\n#O\r\n#\\╤═}\r\n/#\\\r\n%%\r\n#O_╤═}\r\n#`´\r\n/#\\\r\n%%\r\n#O╤═}\r\n#V`\r\n/#\\\r\n%%\r\n#O\r\n(╤══}\r\n/#\\\r\n%%\r\n#O\r\n(╤═}≡\r\n/#\\\r\n%%\r\n#O|¯|\r\n/|)•(\r\n/#|_|\r\nasciiend\r\nvar field=ascii\r\n.\r\n#.\r\n#|\r\n#|\r\n#'\r\n'\r\nasciiend\r\n//-~-Arrows-~-\\\\\r\nvar arrowy\r\nvar arrows = [[],[],[]]\r\nvar arrow=ascii\r\n─→\r\nasciiend\r\n//-~-Foes-~-\\\\\r\nvar foes = [[],[],[]]\r\nvar projectiles = [[],[],[]]\r\nvar pickups = []\r\nvar remove\r\nvar leadArrow\r\n//-Bosses-\\\\\r\nvar perc=0\r\nvar bossBar=\"\"\r\nvar temp=0\r\nvar bosslvl=3\r\nvar moverng=0\r\nvar bossAI\r\nvar attack=\"idle\"\r\nvar spawncount=0\r\nvar animtime=0\r\nvar variable=false\r\nvar bosslayer\r\nvar bosses = []\r\nvar bosshptxt\r\n//-Ascii-\\\\\r\nvar snake=ascii\r\n<\\##;≈~\r\n#(_·-·_,_\r\n%%\r\n<\\#;≈~\r\n#(,-·_,-\r\nasciiend\r\n//Forest\\\\\r\nvar bee=ascii\r\n#/)\r\nO__)>\r\n%%\r\n#.-´\r\nO__)>\r\nasciiend\r\nvar wasp=ascii\r\n_|##|\r\n O()/\\\r\n####)/\r\n###¯`\r\n%%\r\n_\\##/\r\n O()/\\\r\n####)/\r\n###¯`\r\n%%\r\n__##_\r\n O()/\\\r\n####)/\r\n###¯`\r\n%%\r\n_\\##/\r\n O()/\\\r\n####)/\r\n###¯`\r\nasciiend\r\nvar hornet=ascii\r\n\\#(\\_/)_\r\n.O(__)/ .\\\r\n###\\##)´ /\r\n#####¯` ´\r\n%%\r\n\\###_.-´\r\n.O(__)/ .\\\r\n###\\##)´ /\r\n#####¯` ´\r\nasciiend\r\n//0-3 Idle,4-5 Spit, 6-7 Sting, 8-11 Call\r\nvar queenbee=ascii\r\n##._≤≥\r\n##_.()--.───\r\n#####/'-_|─'\r\n#####_/-_'\r\n###-'-.-'\r\n%%\r\n##._≤≥####.\r\n##_.()--./ |\r\n#####/'-_|/\r\n#####_/-_'\r\n###-'-.-'\r\n%%\r\n##._≤≥###|.\r\n##_.()--.||\r\n#####/'-_|'\r\n#####_/-_'\r\n###-'-.-'\r\n%%\r\n##._≤≥####.\r\n##_.()--./ |\r\n#####/'-_|/\r\n#####_/-_'\r\n###-'-.-'\r\n%%\r\n##._≤≥\r\n##_.()--.───\r\n#####/'-_|─'\r\n######_)-_'\r\n####-'-.-'\r\n%%\r\n#._≤≥####.\r\n##-()--./ |\r\n##¯#_'--'./\r\n######_)--'\r\n####-'-.-'\r\n%%\r\n###._≤≥##|.\r\n###_.()--||\r\n#####/'-_|'\r\n#####_/-_'\r\n###-'-.-'\r\n%%\r\n###._≤≥####.\r\n###_.()--./ |\r\n######─'-_|/\r\n#####_.'-_'\r\n####'-.-'\r\n%%\r\n##•\r\n###\\≤≥####.\r\n##_.()--./ |\r\n#####/'-_|/\r\n#####_/-_'\r\n###-'-.-'\r\n%%\r\n#(•) \r\n###\\≤≥###|.\r\n##_.()--.||\r\n#####/'-_|'\r\n#####_/-_'\r\n###-'-.-'\r\n%%\r\n((•))\r\n###\\≤≥    .\r\n##_.()--./ |\r\n#####/'-_|/\r\n#####_/-_'\r\n###-'-.-'\r\n%%\r\n#(•) \r\n###\\≤≥\r\n##_.()--.───\r\n#####/'-_|─'\r\n#####_/-_'\r\n###-'-.-'\r\nasciiend\r\nvar stinger=ascii\r\n<-\r\nasciiend\r\nvar spit=ascii\r\n(≈~\r\nasciiend\r\n//Volcano\\\\\r\nvar missle=ascii\r\n##____/\r\n< / / |:.\r\n##¯¯¯¯\\\r\n%%\r\n##____/\r\n< / / |:'\r\n##¯¯¯¯\\\r\n%%\r\n##____/\r\n< / / |::'\r\n##¯¯¯¯\\\r\n%%\r\n##____/\r\n< / / |::.\r\n##¯¯¯¯\\\r\nasciiend\r\nvar mineflyer=ascii\r\n###└O┘\r\n┐_./|\\.___\r\n╞\\'¯¯¯'/¯/::.\r\n┘#`---´¯¯ '\r\n%%\r\n###└O┘\r\n┐_./|\\.___\r\n╞\\'¯¯¯'/¯/:::.\r\n┘#`---´¯¯ ''\r\n%%\r\n###└O┘\r\n┐_./|\\.___\r\n╞\\'¯¯¯'/¯/::.\r\n┘#`---´¯¯ ''\r\nasciiend\r\nvar rocket=ascii\r\n###└O┘\r\n#__/|___/¯¯/\r\n/  //\\ //¯|::.\r\n\\ //  // _|::'\r\n#¯¯¯¯¯¯¯\\__\\\r\n%%\r\n###└O┘\r\n#__/|___/¯¯/\r\n/  //\\ //¯|::.\r\n\\ //  // _|:::'\r\n#¯¯¯¯¯¯¯\\__\\\r\n%%\r\n###└O┘\r\n#__/|___/¯¯/\r\n/  //\\ //¯|:::.\r\n\\ //  // _|:::'\r\n#¯¯¯¯¯¯¯\\__\\\r\n%%\r\n###└O┘\r\n#__/|___/¯¯/\r\n/  //\\ //¯|:::.\r\n\\ //  // _|::'\r\n#¯¯¯¯¯¯¯\\__\\\r\nasciiend\r\nvar heli=ascii\r\n##___.___\r\n####_|_\r\n###´└O┘`\r\n#_/./|\\,\\\r\n|_\\'¯¯¯'/\r\n#¯¯`---´\r\n%%\r\n###__.__\r\n####_|_\r\n###´└O┘`\r\n#_/./|\\,\\\r\n|_\\'¯¯¯'/\r\n#¯¯`---´\r\n%%\r\n####_._\r\n####_|_\r\n###´└O┘`\r\n#_/./|\\,\\\r\n|_\\'¯¯¯'/\r\n#¯¯`---´\r\n%%\r\n###__.__\r\n####_|_\r\n###´└O┘`\r\n#_/./|\\,\\\r\n|_\\'¯¯¯'/\r\n#¯¯`---´\r\nasciiend\r\n//0-3 idle1, 4-7 idle 2\r\nvar copter=ascii\r\n_______._______#######__.__\r\n##.----'----.________.--'--.\r\n#/[    ] \\   [\\ _____\\   [ ]\\\r\n[_________]  []|______|______]\r\n#\\¯¯¯¯¯¯¯    [/      /  ¯¯¯¯/\r\n##`----------'------'------´\r\n%%\r\n#______.______#######___.___\r\n##.----'----.________.--'--.\r\n#/[    ] \\   [\\ _____\\   [ ]\\\r\n[_________]  []|______|______]\r\n#\\¯¯¯¯¯¯¯    [/      /  ¯¯¯¯/\r\n##`----------'------'------´\r\n%%\r\n##_____._____#######____.____\r\n##.----'----.________.--'--.\r\n#/[    ] \\   [\\ _____\\   [ ]\\\r\n[_________]  []|______|______]\r\n#\\¯¯¯¯¯¯¯    [/      /  ¯¯¯¯/\r\n##`----------'------'------´\r\n%%\r\n###____.____#######_____._____\r\n##.----'----.________.--'--.\r\n#/[    ] \\   [\\ _____\\   [ ]\\\r\n[_________]  []|______|______]\r\n#\\¯¯¯¯¯¯¯    [/      /  ¯¯¯¯/\r\n##`----------'------'------´\r\n%%\r\n_______._______#######__.__\r\n##.----'----._ ___ __.--'--.\r\n##) └O┘  ζ   ζ'   '  !  └O┘ \\\r\n#/  /|    >   >      ζ  /|\\  ]\r\n#\\¯¯^¯¯'¯    ζ_______.´^¯'¯¯/\r\n##`----------'--'---'------´\r\n%%\r\n#______.______#######___.___\r\n##.----'----._ ___ __.--'--.\r\n##) └O┘  ζ   ζ'   '  !  └O┘ \\\r\n#/  /|    >   >      ζ  /|\\  ]\r\n#\\¯¯^¯¯'¯    ζ_______.´^¯'¯¯/\r\n##`----------'--'---'------´\r\n%%\r\n##_____._____#######____.____\r\n##.----'----._ ___ __.--'--.\r\n##) └O┘  ζ   ζ'   '  !  └O┘ \\\r\n#/  /|    >   >      ζ  /|\\  ]\r\n#\\¯¯^¯¯'¯    ζ_______.´^¯'¯¯/\r\n##`----------'--'---'------´\r\n%%\r\n###____.____#######_____._____\r\n##.----'----._ ___ __.--'--.\r\n##) └O┘  ζ   ζ'   '  !  └O┘ \\\r\n#/  /|    >   >      ζ  /|\\  ]\r\n#\\¯¯^¯¯'¯    ζ_______.´^¯'¯¯/\r\n##`----------'--'---'------´\r\nasciiend\r\nvar controller=ascii\r\n###└O┘\r\n##{═╤)\r\n###/#\\\r\n%%\r\n###└O┘\r\n#{═╤/\r\n###/#\\\r\n%%\r\n{═╤_O┘\r\n###`´\r\n###/#\\\r\n%%\r\n#{═╤O┘\r\n###´V\r\n###/#\\\r\nasciiend\r\nvar farrow=ascii\r\n←─\r\nasciiend\r\nvar crate=ascii\r\n.---.\r\n`. .´\r\n _._\r\n|\\_/|\r\n|/ \\|\r\n ¯¯¯\r\nasciiend\r\nvar cannonball=ascii\r\n#_\r\n(')\r\n#¯\r\nasciiend\r\n//-~-WaveController-~-\\\\\r\nvar foelevel\r\nvar foelevelrng\r\nvar foey\r\nvar foeyrng\r\nvar foetype\r\nvar foetyperng\r\nvar spawnrate\r\nvar frng\r\nvar wave\r\nvar foecount\r\nvar maxfoe\r\nvar threat\r\nvar multiplier\r\nvar bossalive\r\n//-~-Effects-~-\\\\\r\nvar effects = []\r\nvar stack\r\nvar duration\r\n//-Debuffs-\\\\\r\nvar debuffsP = [[],[],[]]\r\nvar debuff\r\nvar debuffeffect=[0]\r\nvar bleedeffect=ascii\r\n._\r\n  '\r\nasciiend\r\n//-~-Other-~-\\\\\r\nvar count=0\r\nvar count2=0\r\nvar DeleteList = []\r\nvar DeleteList2 = []\r\nvar invis = ui.AddStyle(\"#########\")\r\n\r\n//-~-~-Functions-~-~-\\\\\r\n//-~-UI-~-\\\\\r\nfunc VarStart()\r\n  towerhp=towermaxhp\r\n  currentarmor=0\r\n  armormax=0\r\n  spawnrate=90\r\n  foelevel=1\r\n  foelevelrng=0\r\n  foey=0\r\n  foeyrng=0\r\n  foetype=\"sfoe\"\r\n  foetyperng=0\r\n  frng=\"\"\r\n  reloaded=true\r\n  reloadtimer=0\r\n  level=1\r\n  gametime=0\r\n  shopopen=false\r\n  wave=0\r\n  threat=0\r\n  foecount=0\r\n  multiplier=1*difficulty\r\n  speedlvl=1\r\n  damagelvl=1\r\n  healthlvl=1\r\n  critdamagelvl=0\r\n  critchancelvl=0\r\n  piercemaxlvl=0\r\n  piercechancelvl=0\r\n  bleeddamagelvl=0\r\n  bleedchancelvl=0\r\n  armormaxlvl=0\r\n  armorregenlvl=0\r\n  coins=0\r\n  score=0\r\n  x2speed=false\r\n\r\nfunc SetUp()\r\n  Background()\r\n  Shop()\r\n  BossHPtxt()\r\n  PauseBtn()\t\t\t\t\t\t\r\n  PlayerStart()\r\n  equipped=\"basic\"\r\n  Buttons()\r\n  VarStart()\r\n  TowerHP()\r\n  Forcefield()\r\n//-Start-\\\\\r\nfunc Start()\r\n  multiplier=1*difficulty\r\n  coins=5*difficulty\r\n  gamerun=true\r\n  gamestart=true\r\n  startpnl.visible=false\r\n  wave=1\r\n\r\nfunc Difficulty(btn)\r\n  ?btn=diffup&difficulty<5\r\n    difficulty++\r\n  :?btn=diffdown&difficulty>1\r\n    difficulty--\r\n\r\nfunc LocChange(btn)\r\n  ?btn=locright\r\n    location++\r\n    ?location>locations.Count()\r\n      location=1\r\n  :?btn=locleft\r\n    location--\r\n    ?location<1\r\n      location=locations.Count()\r\n  loctxt.text=te.xt(locations[location-1])\r\n  background.Load(locasci[location-1])\r\n\r\nfunc ShowDiff()\r\n  ?gamestart=false\r\n    >c-4,8,#565656,☆ ☆ ☆ ☆ ☆\r\n    for i = 0..difficulty-1\r\n      >c@-5+i*2@,8,#white, ☆\r\n  :\r\n    >c-5,-12,#565656,☆ ☆ ☆ ☆ ☆\r\n    for i = 0..difficulty-1\r\n      >c@-5+i*2@,-12,#white,☆ \r\n\r\nfunc StartScreen()\r\n  title=uiAA(titleasci)\r\n  title.y=-8\r\n  startbtn=uiAB()\r\n  startbtn.w=9\r\n  startbtn.h=3\r\n  startbtn.y=2\r\n  startbtn.text=te.xt(\"Play\")\r\n  startbtn.SetPressed(Start)\r\n  locright=uiAB()\r\n  locright.y=5\r\n  locright.x=7\r\n  locright.h=3\r\n  locright.w=3\r\n  locright.text=\"▶\"\r\n  locright.SetPressed(LocChange)\r\n  locleft=uiAB()\r\n  locleft.y=5\r\n  locleft.x=-7\r\n  locleft.h=3\r\n  locleft.w=3\r\n  locleft.text=\"◀\"\r\n  locleft.SetPressed(LocChange)\r\n  loctxt=uiAT(te.xt(locations[location-1]))\r\n  loctxt.y=7\r\n  loctxt.align=\"center\"\r\n  //scoretxt=uiAT()\r\n  //scoretxt.y=12\r\n  //scoretxt.text=\"\"\r\n  //scoretxt.align=\"center\"\r\n  diffup=uiAB()\r\n  diffup.y=8\r\n  diffup.x=7\r\n  diffup.h=3\r\n  diffup.w=3\r\n  diffup.text=\"▶\"\r\n  diffup.SetPressed(Difficulty)\r\n  diffdown=uiAB()\r\n  diffdown.y=8\r\n  diffdown.x=-7\r\n  diffdown.h=3\r\n  diffdown.w=3\r\n  diffdown.text=\"◀\"\r\n  diffdown.SetPressed(Difficulty)\r\n  versiontxt=uiAT(version)\r\n  versiontxt.w=15\r\n  versiontxt.y=-3\r\n  versiontxt.x=32\r\n  startpnl=uiAP()\r\n  startpnl.Add(title)\r\n  startpnl.Add(startbtn)\r\n  startpnl.Add(locright)\r\n  startpnl.Add(locleft)\r\n  startpnl.Add(loctxt)\r\n  startpnl.Add(diffup)\r\n  startpnl.Add(diffdown)\r\n  startpnl.Add(versiontxt)\r\n  startpnl.style=invis\r\n//-Pause-\\\\\r\nfunc PauseBtn()\r\n  pausebtn=uiAB()\r\n  pausebtn.anchor=bottom_left\r\n  pausebtn.dock=bottom_left\r\n  pausebtn.text=\"||\"\r\n  pausebtn.x=0\r\n  pausebtn.y=0\r\n  pausebtn.w=4\r\n  pausebtn.h=3\r\n  pausebtn.SetPressed(Speed)\r\n  speedbtn=uiAB()\r\n  speedbtn.anchor=bottom_left\r\n  speedbtn.dock=bottom_left\r\n  speedbtn.text=\">>\"\r\n  speedbtn.x=4\r\n  speedbtn.y=0\r\n  speedbtn.w=4\r\n  speedbtn.h=3\r\n  speedbtn.SetPressed(Speed)\r\n\r\nfunc PauseScreen()\r\n  pausetxt=uiAT(te.xt(\"Game Paused\"))\r\n  pausetxt.w=24\r\n  pausetxt.h=8\r\n  pausetxt.y=1\r\n  pausetxt.align=center\r\n  //pausetxt.text=te.xt(\"Taking a break, are ye?\")\r\n  startscreenbtn=uiAB()\r\n  startscreenbtn.w=14\r\n  startscreenbtn.h=5\r\n  startscreenbtn.y=1\r\n  startscreenbtn.x=0\r\n  startscreenbtn.text=te.xt(\"Menu\")\r\n  startscreenbtn.SetPressed(StartOver)\r\n  pausepnl=uiAP()\r\n  pausepnl.w=30\r\n  pausepnl.h=10\r\n  pausepnl.Add(pausetxt)\r\n  pausepnl.Add(startscreenbtn)\r\n\r\nfunc Speed(btn)\r\n  ?btn=pausebtn\r\n    ?gamestart=true\r\n      gamerun=!gamerun\r\n      ?gamerun\r\n        pausepnl.Recycle()\r\n      :\r\n        PauseScreen()\r\n  :?btn=speedbtn\r\n    x2speed=!x2speed\r\n    ?x2speed\r\n      speedbtn.tcolor=#green\r\n    :\r\n      speedbtn.tcolor=#white\r\n//-GameOver-\\\\\r\nfunc GameOverScreen()\r\n  gameovertxt=uiAT()\r\n  startoverbtn=uiAB()\r\n  gameoverpnl=uiAP()\r\n  startscreenbtn=uiAB()\r\n  gameovertxt.w=24\r\n  gameovertxt.h=8\r\n  gameovertxt.align=center\r\n  gameovertxt.text=te.xt(\"The Crystal has fallen\")\r\n  startoverbtn.w=14\r\n  startoverbtn.h=5\r\n  startoverbtn.y=1\r\n  startoverbtn.x=-7\r\n  startoverbtn.text=te.xt(\"Retry\")\r\n  startoverbtn.SetPressed(StartOver)\r\n  startscreenbtn.w=14\r\n  startscreenbtn.h=5\r\n  startscreenbtn.y=1\r\n  startscreenbtn.x=7\r\n  startscreenbtn.text=te.xt(\"Menu\")\r\n  startscreenbtn.SetPressed(StartOver)\r\n  gameoverpnl.w=32\r\n  gameoverpnl.h=10\r\n  gameoverpnl.Add(gameovertxt)\r\n  gameoverpnl.Add(startoverbtn)\r\n\r\nfunc GameOver()\r\n  gamerun=false\r\n  GameOverScreen()\r\n  ?score>highscore\r\n    highscore=score\r\n    storage.Set(\"highscore\",highscore)\r\n\r\nfunc StartOver(btn)\r\n  ?btn=startoverbtn\r\n    ui.Clear()\r\n    arrows = [[],[],[]]\r\n    foes = [[],[],[]]\r\n    projectiles = [[],[],[]]\r\n    bosses = []\r\n    debuffsP = [[],[],[]]\r\n    bossalive=false\r\n    foecount=0\r\n    threat=0\r\n    multiplier=1\r\n    SetUp()\r\n    background.Load(locasci[location-1])\r\n    wave=1\r\n    gamestart=true\r\n    gamerun=true\r\n  :?btn=startscreenbtn\r\n    ui.Clear()\r\n    gamestart=false\r\n    gamerun=false\r\n    arrows = [[],[],[]]\r\n    foes = [[],[],[]]\r\n    projectiles = [[],[],[]]\r\n    debuffsP = [[],[],[]]\r\n    bosses = []\r\n    wave=1\r\n    foecount=0\r\n    threat=0\r\n    multiplier=1\r\n    SetUp()\r\n    StartScreen()\r\n//-Move-\\\\\r\nfunc Move(btn)\r\n  ?gamerun=true\r\n    ?btn=upbtn\r\n      level++\r\n    :?btn=downbtn\r\n      level--\r\n\r\nfunc Buttons()\r\n  //Up\r\n  upbtn=uiAB()\r\n  upbtn.anchor=bottom_left\r\n  upbtn.dock=bottom_left\r\n  upbtn.w=9\r\n  upbtn.h=3\r\n  upbtn.text=\"▲\"\r\n  upbtn.y=-10\r\n  upbtn.SetPressed(Move)\r\n  //Down\r\n  downbtn=uiAB()\r\n  downbtn.anchor=bottom_left\r\n  downbtn.dock=bottom_left\r\n  downbtn.w=9\r\n  downbtn.h=3\r\n  downbtn.text=\"▼\"\r\n  downbtn.y=-7\r\n  downbtn.SetPressed(Move)\r\n//-Shop-\\\\\r\nfunc Shop()\r\n  shop=uiAA(shopasci)\r\n  shop.anchor=bottom_left\r\n  shop.dock=bottom_left\r\n  shop.x=0\r\n  shop.y=-13\r\n  shopbtn=uiAB()\r\n  shopbtn.style=invis\r\n  shopbtn.anchor=bottom_left\r\n  shopbtn.dock=bottom_left\r\n  shopbtn.x=0\r\n  shopbtn.y=-13\r\n  shopbtn.w=9\r\n  shopbtn.h=6\r\n  shopbtn.text=\"\"\r\n  shopbtn.SetPressed(OpenShop)\r\n  shoptxt=uiAT(te.xt(\"Upgrade\"))\r\n  shoptxt.anchor=bottom_left\r\n  shoptxt.dock=bottom_left\r\n  shoptxt.x=1\r\n  shoptxt.y=-12\r\n  shoptxt.w=7\r\n  shoptxt.align=\"center\"\r\n\r\nfunc CreateTabs()\r\n  weapontab=uiAB()\r\n  weapontab.anchor=top_left\r\n  weapontab.dock=top_left\r\n  weapontab.w=17\r\n  weapontab.h=3\r\n  weapontab.x=0\r\n  weapontab.bcolor=#ffffff\r\n  weapontab.text=te.xt(\"Offense\")\r\n  weapontab.SetPressed(Tabs)\r\n  towertab=uiAB()\r\n  towertab.anchor=top_left\r\n  towertab.dock=top_left\r\n  towertab.w=17\r\n  towertab.h=3\r\n  towertab.x=17\r\n  towertab.text=te.xt(\"Defense\")\r\n  towertab.SetPressed(Tabs)\r\n  utiltab=uiAB()\r\n  utiltab.anchor=top_left\r\n  utiltab.dock=top_left\r\n  utiltab.w=17\r\n  utiltab.h=3\r\n  utiltab.x=34\r\n  utiltab.text=te.xt(\"Utility\")\r\n  utiltab.SetPressed(Tabs)\r\n  statstab=uiAB()\r\n  statstab.anchor=top_left\r\n  statstab.dock=top_left\r\n  statstab.w=17\r\n  statstab.h=3\r\n  statstab.x=51\r\n  statstab.text=te.xt(\"Stats\")\r\n  statstab.SetPressed(Tabs)\r\n  shoppnl.Add(weapontab)\r\n  shoppnl.Add(towertab)\r\n  shoppnl.Add(utiltab)\r\n  shoppnl.Add(statstab)\r\n\r\nfunc ShopScreen()\r\n  shoppnl=uiAP()\r\n  shoppnl.w=68\r\n  shoppnl.h=23\r\n  shoppnl.y=0\r\n  upgradepnl=uiAP()\r\n  upgradepnl.w=68\r\n  upgradepnl.h=21\r\n  upgradepnl.y=1\r\n  infopnl=uiAP()\r\n  infopnl.w=17\r\n  infopnl.h=21\r\n  infopnl.y=1\r\n  infopnl.x=25\r\n  infotitle=uiAT()\r\n  infotitle.anchor=top_left\r\n  infotitle.dock=top_left\r\n  infotitle.w=15\r\n  infotitle.y=1\r\n  infotitle.x=1\r\n  infotitle.align=center\r\n  infodesc=uiAT()\r\n  infodesc.anchor=top_left\r\n  infodesc.dock=top_left\r\n  infodesc.w=15\r\n  infodesc.h=7\r\n  infodesc.y=3\r\n  infodesc.x=1\r\n  infodesc.align=center\r\n  infolevel=uiAT()\r\n  infolevel.anchor=top_left\r\n  infolevel.dock=top_left\r\n  infolevel.w=15\r\n  infolevel.h=1\r\n  infolevel.y=13\r\n  infolevel.x=1\r\n  infolevel.align=center\r\n  infocost=uiAT()\r\n  infocost.anchor=top_left\r\n  infocost.dock=top_left\r\n  infocost.w=15\r\n  infocost.h=1\r\n  infocost.y=15\r\n  infocost.x=1\r\n  infocost.align=center\r\n  infoupgrade=uiAB()\r\n  infoupgrade.anchor=top_left\r\n  infoupgrade.dock=top_left\r\n  infoupgrade.w=9\r\n  infoupgrade.h=3\r\n  infoupgrade.y=11\r\n  infoupgrade.x=4\r\n  infoupgrade.text=te.xt(\"Upgrade\")\r\n  infoupgrade.visible=false\r\n  infoupgrade.SetPressed(Upgrade)\r\n  infopnl.Add(infotitle)\r\n  infopnl.Add(infodesc)\r\n  infopnl.Add(infocost)\r\n  infopnl.Add(infoupgrade)\r\n  infopnl.Add(infolevel)\r\n  CreateTabs()\r\n  shoppnl.Add(upgradepnl)\r\n  shoppnl.Add(infopnl)\r\n  ShowUpgrades()\r\n\r\nfunc OpenShop()\r\n  ?shopopen=false\r\n    gamerun=false\r\n    shopopen=true\r\n    ShopScreen()\r\n    ?pausepnl\r\n      pausepnl.Recycle()\r\n  :\r\n    ?gamestart\r\n      gamerun=true\r\n    shopopen=false\r\n    upgradepage=2\r\n    shoppnl.Recycle()\r\n//-~-Music-~-\\\\\r\nfunc Musictrack()\r\n  ?gamestart=false\r\n    music.play(rocky_plateau_5)\r\n  :?location=1 //Forest\r\n    ?bossalive\r\n      music.play(poena)\r\n    :?wave<10\r\n      music.play(deadwood_0)\r\n    :?wave>=10&wave<20\r\n      music.play(deadwood_1)\r\n    :?wave>=20&wave<30\r\n      music.play(deadwood_2)\r\n    :?wave>=30&wave<40\r\n      music.play(deadwood_3)\r\n    :?wave>=40&wave<50\r\n      music.play(deadwood_4)\r\n    :?wave>=50&wave<60\r\n      music.play(deadwood_5)\r\n    :?wave>=60\r\n      music.play(deadwood_cyan)\r\n  :?location=2 //Volcano\r\n    ?bossalive\r\n      music.play(bronze_guardian_3)\r\n    :?wave<10\r\n      music.play(bronze_mine_0)\r\n    :?wave>=10&wave<20\r\n      music.play(bronze_mine_1)\r\n    :?wave>=20&wave<30\r\n      music.play(bronze_mine_2)\r\n    :?wave>=30&wave<40\r\n      music.play(bronze_mine_3)\r\n    :?wave>=40&wave<50\r\n      music.play(bronze_mine_4)\r\n    :?wave>=50&wave<60\r\n      music.play(bronze_mine_5)\r\n    :?wave>=60\r\n      music.play(bronze_mine_cyan)\r\n//-~-Upgrades-~-\\\\\r\nfunc Upgrade()\r\n  ?selected=\"Speed\"&speedlvl<10&coins>=(speedlvl*15)\r\n    coins=coins-(speedlvl*15)\r\n    speedlvl++\r\n  :?selected=\"Unlock Crit\"&critdamagelvl=0&coins>=20\r\n    coins=coins-20\r\n    critdamagelvl++\r\n    critchancelvl++\r\n    critChance=999*critchancelvl\r\n    critDamage=1.5*critdamagelvl\r\n  :?selected=\"Crit Damage\"&critdamagelvl<10&coins>=(critdamagelvl*10)\r\n    coins=coins-(critdamagelvl*10)\r\n    critdamagelvl++\r\n    critDamage=1.5*critdamagelvl\r\n  :?selected=\"Crit Chance\"&critchancelvl<10&coins>=(critchancelvl*10)\r\n    coins=coins-(critchancelvl*10)\r\n    critchancelvl++\r\n    critChance=999*critchancelvl\r\n  :?selected=\"Unlock Pierce\"&piercemaxlvl=0&coins>=20\r\n    coins=coins-20\r\n    piercemaxlvl++\r\n    piercechancelvl++\r\n    pierceChance=999*piercechancelvl\r\n  :?selected=\"Max Pierce\"&piercemaxlvl<5&coins>=(piercemaxlvl*20)\r\n    coins=coins-(piercemaxlvl*20)\r\n    piercemaxlvl++\r\n  :?selected=\"Pierce Chance\"&piercechancelvl<10&coins>=(piercechancelvl*10)\r\n    coins=coins-(piercechancelvl*10)\r\n    piercechancelvl++\r\n    pierceChance=999*piercechancelvl\r\n  :?selected=\"Unlock Bleed\"&bleeddamagelvl=0&coins>=20\r\n    coins=coins-20\r\n    bleeddamagelvl++\r\n    bleedchancelvl++\r\n    bleedChance=999*bleedchancelvl\r\n    bleedDmg=bleeddamagelvl/2.0\r\n    bleedDuration=120+30*bleeddamagelvl\r\n  :?selected=\"Bleed Damage\"&bleeddamagelvl<10&coins>=(bleeddamagelvl*10)\r\n    coins=coins-(bleeddamagelvl*10)\r\n    bleeddamagelvl++\r\n    bleedDmg=bleeddamagelvl/2.0\r\n    bleedDuration=120+30*bleeddamagelvl\r\n  :?selected=\"Bleed Chance\"&bleedchancelvl<10&coins>=(bleedchancelvl*10)\r\n    coins=coins-(bleedchancelvl*10)\r\n    bleedchancelvl++\r\n    bleedChance=999*bleedchancelvl\r\n  :?selected=\"Damage\"&damagelvl<100&coins>=(damagelvl*10)\r\n    coins=coins-(damagelvl*10)\r\n    damagelvl++\r\n  :?selected=\"Health\"&healthlvl<100&coins>=(healthlvl*10)\r\n    coins=coins-(healthlvl*10)\r\n    healthlvl++\r\n    towermaxhp=10+healthlvl*10\r\n    towerhp=towerhp+10\r\n    TowerHpUpdate()\r\n  :?selected=\"Unlock Armor\"&armormaxlvl=0&coins>=20\r\n    coins=coins-20\r\n    armorregenlvl++\r\n    armormaxlvl++\r\n    currentarmor=currentarmor+5\r\n    armormax=armormaxlvl*5\r\n    FieldUpdate()\r\n  :?selected=\"Max Armor\"&armormaxlvl<5&coins>=(armormaxlvl*15)\r\n    coins=coins-(armormaxlvl*15)\r\n    armormaxlvl++\r\n    currentarmor=currentarmor+5\r\n    armormax=armormaxlvl*5\r\n    FieldUpdate()\r\n  :?selected=\"Armor Regen\"&armorregenlvl<25&coins>=(armorregenlvl*20)\r\n    coins=coins-(armorregenlvl*20)\r\n    armorregenlvl++\r\n  :?selected=\"Regen\"&regenlvl<25&coins>=(regenlvl*15)\r\n    coins=coins-(regenlvl*15)\r\n    regenlvl++\r\n  ?upgradepage=0\r\n    Stats()\r\n  InfoPanel()\r\n  ShowUpgrades()\r\nfunc Stats()\r\n  stattxt1.text=te.xt(\"Attack Speed\")+\":\"+(30-speedlvl)+\"f\\n\\n\"+te.xt(\"Damage\")+\":\"+damagelvl+\"\\n\\n\"\r\n^+te.xt(\"Crit Chance\")+\":\"+critchancelvl+\"/10\\n\\n\"+te.xt(\"Crit Damage\")+\":\"+critDamage+\"x\\n\\n\"\r\n^+te.xt(\"Pierce Chance\")+\":\"+piercechancelvl+\"/10\\n\\n\"+te.xt(\"Max Pierce\")+\":\"+piercemaxlvl+\"\\n\\n\"\r\n^+te.xt(\"Bleed Chance\")+\":\"+bleedchancelvl+\"/10\\n\\n\"+te.xt(\"Bleed Damage\")+\":\"+bleedDmg+\"per15f\\n\\n\"\r\n  stattxt2.text=te.xt(\"Tower Health\")+\":\"+towerhp+\"/\"+towermaxhp+\"\\n\\n\"+te.xt(\"Health Regen\")+\":\"+regenlvl+\"per\"+(1000-regenlvl*50)+\"f\\n\\n\"\r\n^+te.xt(\"Armor\")+\":\"+currentarmor+\"/\"+armormax+\"\\n\\n\"+te.xt(\"Armor Regen\")+\":1per\"+(1000-armorregenlvl*50)+\"f\\n\\n\"\r\n\r\nfunc CreateUpgradeBtn(x,y,text)\r\n  var button=uiAB()\r\n  button.anchor=top_left\r\n  button.dock=top_left\r\n  button.x=x\r\n  button.y=y\r\n  button.h=4\r\n  button.w=15\r\n  button.text=text\r\n  button.tcolor=#010101\r\n  button.SetPressed(Select)\r\n  var txt=uiAT()\r\n  txt.anchor=top_left\r\n  txt.dock=top_left\r\n  txt.x=x+1\r\n  txt.y=y+1\r\n  txt.h=2\r\n  txt.w=13\r\n  txt.align=center\r\n  txt.text=te.xt(text)\r\n  return [button,txt]\r\n\r\n//func CreateUpgradeTxt(x,y,text)\r\n\r\nfunc ShowUpgrades()\r\n  upgradepnl.Clear()\r\n  ?upgradepage=0  //Stats\r\n    stattxt1=uiAT()\r\n    stattxt1.anchor=top_left\r\n    stattxt1.dock=top_left\r\n    stattxt1.w=24\r\n    stattxt1.h=19\r\n    stattxt1.y=1\r\n    stattxt1.x=1\r\n    upgradepnl.Add(stattxt1)\r\n    stattxt2=uiAT()\r\n    stattxt2.anchor=top_left\r\n    stattxt2.dock=top_left\r\n    stattxt2.w=24\r\n    stattxt2.h=19\r\n    stattxt2.y=1\r\n    stattxt2.x=26\r\n    upgradepnl.Add(stattxt2)\r\n    Stats()\r\n  :?upgradepage=1  //Tower\r\n    ubtnhealth=CreateUpgradeBtn(1,1,\"Health\")\r\n    upgradepnl.Add(ubtnhealth[0])\r\n    upgradepnl.Add(ubtnhealth[1])\r\n    ubtnregen=CreateUpgradeBtn(16,1,\"Regen\")\r\n    upgradepnl.Add(ubtnregen[0])\r\n    upgradepnl.Add(ubtnregen[1])\r\n    ?armormaxlvl>0\r\n      ubtnarmormax=CreateUpgradeBtn(1,5,\"Max Armor\")\r\n      upgradepnl.Add(ubtnarmormax[0])\r\n      upgradepnl.Add(ubtnarmormax[1])\r\n      ubtnarmorregen=CreateUpgradeBtn(1,9,\"Armor Regen\")\r\n      upgradepnl.Add(ubtnarmorregen[0])\r\n      upgradepnl.Add(ubtnarmorregen[1])\r\n    :\r\n      ubtnarmorunlock=CreateUpgradeBtn(1,5,\"Unlock Armor\")\r\n      upgradepnl.Add(ubtnarmorunlock[0])\r\n      upgradepnl.Add(ubtnarmorunlock[1])\r\n  :?upgradepage=2  //Crossbows\r\n    ubtnspeed=CreateUpgradeBtn(1,1,\"Speed\")\r\n    upgradepnl.Add(ubtnspeed[0])\r\n    upgradepnl.Add(ubtnspeed[1])\r\n    ubtndamage=CreateUpgradeBtn(16,1,\"Damage\")\r\n    upgradepnl.Add(ubtndamage[0])\r\n    upgradepnl.Add(ubtndamage[1])\r\n    ?critdamagelvl>0\r\n      ubtncritdamage=CreateUpgradeBtn(1,5,\"Crit Damage\")\r\n      upgradepnl.Add(ubtncritdamage[0])\r\n      upgradepnl.Add(ubtncritdamage[1])\r\n      ubtncritchance=CreateUpgradeBtn(1,9,\"Crit Chance\")\r\n      upgradepnl.Add(ubtncritchance[0])\r\n      upgradepnl.Add(ubtncritchance[1])\r\n    :\r\n      ubtncritunlock=CreateUpgradeBtn(1,5,\"Unlock Crit\")\r\n      upgradepnl.Add(ubtncritunlock[0])\r\n      upgradepnl.Add(ubtncritunlock[1])\r\n    ?piercemaxlvl>0\r\n      ubtnpiercemax=CreateUpgradeBtn(16,5,\"Max Pierce\")\r\n      upgradepnl.Add(ubtnpiercemax[0])\r\n      upgradepnl.Add(ubtnpiercemax[1])\r\n      ubtnpiercechance=CreateUpgradeBtn(16,9,\"Pierce Chance\")\r\n      upgradepnl.Add(ubtnpiercechance[0])\r\n      upgradepnl.Add(ubtnpiercechance[1])\r\n    :\r\n      ubtnpierceunlock=CreateUpgradeBtn(16,5,\"Unlock Pierce\")\r\n      upgradepnl.Add(ubtnpierceunlock[0])\r\n      upgradepnl.Add(ubtnpierceunlock[1])\r\n    ?bleeddamagelvl>0\r\n      ubtnbleeddamage=CreateUpgradeBtn(31,5,\"Bleed Damage\")\r\n      upgradepnl.Add(ubtnbleeddamage[0])\r\n      upgradepnl.Add(ubtnbleeddamage[1])\r\n      ubtnbleedchance=CreateUpgradeBtn(31,9,\"Bleed Chance\")\r\n      upgradepnl.Add(ubtnbleedchance[0])\r\n      upgradepnl.Add(ubtnbleedchance[1])\r\n    :\r\n      ubtnbleedunlock=CreateUpgradeBtn(31,5,\"Unlock Bleed\")\r\n      upgradepnl.Add(ubtnbleedunlock[0])\r\n      upgradepnl.Add(ubtnbleedunlock[1])\r\n  :?upgradepage=3  //Utility\r\n    > \r\n  :?upgradepage=4  //Effects?\r\n    >effects\r\n\r\nfunc Tabs(btn)\r\n  ?btn=weapontab\r\n    upgradepage=2\r\n    weapontab.bcolor=#ffffff\r\n    towertab.bcolor=#808080\r\n    utiltab.bcolor=#808080\r\n    statstab.bcolor=#808080\r\n  :?btn=towertab\r\n    upgradepage=1\r\n    weapontab.bcolor=#808080\r\n    towertab.bcolor=#ffffff\r\n    utiltab.bcolor=#808080\r\n    statstab.bcolor=#808080\r\n  :?btn=utiltab\r\n    upgradepage=3\r\n    weapontab.bcolor=#808080\r\n    towertab.bcolor=#808080\r\n    utiltab.bcolor=#ffffff\r\n    statstab.bcolor=#808080\r\n  :?btn=statstab\r\n    upgradepage=0\r\n    weapontab.bcolor=#808080\r\n    towertab.bcolor=#808080\r\n    utiltab.bcolor=#808080\r\n    statstab.bcolor=#ffffff\r\n  ShowUpgrades()\r\n\r\nfunc Select(btn)\r\n  selected=te.ToEnglish(btn.text)\r\n  InfoPanel()\r\n\r\nfunc InfoPanel()\r\n  ?selected=\"Speed\"\r\n    infodesc.text=te.xt(\"Increases fire rate\")\r\n    infocost.text=\"©\"+speedlvl*15\r\n    infolevel.text=speedlvl+\"/10\"\r\n  :?selected=\"Unlock Crit\"\r\n    infodesc.text=te.xt(\"Unlock Crits, which multiplies the amount of damage dealt\")\r\n    infocost.text=\"©\"+20\r\n    infolevel.text=critdamagelvl+\"/1\"\r\n  :?selected=\"Crit Damage\"\r\n    infodesc.text=te.xt(\"Increases the damage multiplier of Crits\")\r\n    infocost.text=\"©\"+critdamagelvl*10\r\n    infolevel.text=critdamagelvl+\"/10\"\r\n  :?selected=\"Crit Chance\"\r\n    infodesc.text=te.xt(\"Increases the chance to Crit\")\r\n    infocost.text=\"©\"+critchancelvl*10\r\n    infolevel.text=critchancelvl+\"/10\"\r\n  :?selected=\"Unlock Pierce\"\r\n    infodesc.text=te.xt(\"Unlock Pierce, which allows arrows to pass through killed foes\")\r\n    infocost.text=\"©\"+20\r\n    infolevel.text=piercemaxlvl+\"/1\"\r\n  :?selected=\"Max Pierce\"\r\n    infodesc.text=te.xt(\"Increases the amount of times an arrow can Pierce\")\r\n    infocost.text=\"©\"+piercemaxlvl*20\r\n    infolevel.text=piercemaxlvl+\"/5\"\r\n  :?selected=\"Pierce Chance\"\r\n    infodesc.text=te.xt(\"Increases the chance to Pierce\")\r\n    infocost.text=\"©\"+piercechancelvl*10\r\n    infolevel.text=piercechancelvl+\"/10\"\r\n  :?selected=\"Unlock Bleed\"\r\n    infodesc.text=te.xt(\"Unlock Bleed, which makes foes take damage over time\")\r\n    infocost.text=\"©\"+20\r\n    infolevel.text=bleeddamagelvl+\"/1\"\r\n  :?selected=\"Bleed Damage\"\r\n    infodesc.text=te.xt(\"Increases the damage of each Bleed tick\")\r\n    infocost.text=\"©\"+bleeddamagelvl*10\r\n    infolevel.text=bleeddamagelvl+\"/10\"\r\n  :?selected=\"Bleed Chance\"\r\n    infodesc.text=te.xt(\"Increases the chance to Bleed\")\r\n    infocost.text=\"©\"+bleedchancelvl*10\r\n    infolevel.text=bleedchancelvl+\"/10\"\r\n  :?selected=\"Damage\"\r\n    infodesc.text=te.xt(\"Increases damage\")\r\n    infocost.text=\"©\"+damagelvl*10\r\n    infolevel.text=damagelvl+\"/100\"\r\n  :?selected=\"Health\"\r\n    infodesc.text=te.xt(\"Increases the amount of damage the Crystal can take\")\r\n    infocost.text=\"©\"+healthlvl*10\r\n    infolevel.text=healthlvl+\"/100\"\r\n  :?selected=\"Unlock Armor\"\r\n    infodesc.text=te.xt(\"Unlock Armor, which blocks projectiles\")\r\n    infocost.text=\"©\"+20\r\n    infolevel.text=armormaxlvl+\"/1\"\r\n  :?selected=\"Max Armor\"\r\n    infodesc.text=te.xt(\"Increases amount of hits Armor can take\")\r\n    infocost.text=\"©\"+15\r\n    infolevel.text=armormaxlvl+\"/10\"\r\n  :?selected=\"Armor Regen\"\r\n    infodesc.text=te.xt(\"Armor regenerates faster\")\r\n    infocost.text=\"©\"+20\r\n    infolevel.text=armorregenlvl+\"/25\"\r\n  :?selected=\"Regen\"\r\n    infodesc.text=te.xt(\"Heals the Crystal at a slow rate\")\r\n    infocost.text=\"©\"+regenlvl*15\r\n    infolevel.text=regenlvl+\"/25\"\r\n  infotitle.text=te.xt(selected)\r\n  infoupgrade.visible=true\r\n//-~-Coins/Score-~-\\\\\r\nfunc Coins()\r\n  coinchancerng=rng\r\n  ?coinchancerng>=0&coinchancerng<=2999\r\n    coincountrng=rng\r\n    ?coincountrng>=0&coincountrng<=1999\r\n      coins=coins+(1*multiplier)\r\n      score=score+1*multiplier\r\n    :?coincountrng>=2000&coincountrng<=3999\r\n      coins=coins+(2*multiplier)\r\n      score=score+2*multiplier\r\n    :?coincountrng>=4000&coincountrng<=5999\r\n      coins=coins+(3*multiplier)\r\n      score=score+3*multiplier\r\n    :?coincountrng>=6000&coincountrng<=7999\r\n      coins=coins+(4*multiplier)\r\n      score=score+4*multiplier\r\n    :\r\n      coins=coins+(5*multiplier)\r\n      score=score+5*multiplier\r\n//-~-Tower-~-\\\\\r\nfunc TowerHP()\r\n  twrhptxt=uiAT()\r\n  twrhptxt.anchor=top_left\r\n  twrhptxt.dock=top_left\r\n  twrhptxt.w=13\r\n  twrhptxt.x=3\r\n  twrhptxt.y=2\r\n  twrhptxt.color=#FF00FF\r\n  twrhptxt.text=towerhp+＂/＂+towermaxhp\r\n  twrhptxt.align=\"center\"\r\n\r\nfunc Back()\r\n  backcanvas=uiAC()\r\n  backcanvas.anchor=bottom_left\r\n  backcanvas.dock=bottom_left\r\n  backcanvas.w=screen.w\r\n  backcanvas.h=screen.h\r\n  backcanvas.Set(＂ ＂)\r\n  background=uiAA(locasci[location-1])\r\n  background.anchor=bottom_left\r\n  background.dock=bottom_left\r\n  background.color=#565656   //565656 Normal/75%, 845656 50%, c55656 25%\r\n  background.frame=0\r\n\r\nfunc Tower()\r\n  towerback=uiAA(towerbackasci)\r\n  towerback.anchor=bottom_left\r\n  towerback.dock=bottom_left\r\n  towerback.color=#565656\r\n  tower=uiAA(towerasci)\r\n  tower.anchor=bottom_left\r\n  tower.dock=bottom_left\r\n\r\nfunc Crystal()\r\n  crystal=uiAA(crystalasci)\r\n  crystal.anchor=bottom_left\r\n  crystal.dock=bottom_left\r\n  crystal.color=#ff00ff\r\n  crystal.x=3\r\n  crystal.y=-19\r\n\r\nfunc Background()\r\n  Back()\r\n  Tower()\r\n  Crystal()\r\n  backpanel=uiAP()\r\n  backpanel.anchor=bottom_left\r\n  backpanel.dock=bottom_left\r\n  backpanel.Add(background,1)\r\n  backpanel.Add(towerback,2)\r\n  backpanel.Add(crystal,3)\r\n  backpanel.Add(tower,4)\r\n\r\nfunc TowerHpUpdate()\r\n  twrhptxt.text=towerhp+＂/＂+towermaxhp\r\n  towerperc=(towerhp*100)/towermaxhp\r\n  ?towerperc<=25\r\n    background.color=#c55656\r\n    background.frame=3\r\n  :?towerperc<=50\r\n    background.color=#845656\r\n    background.frame=2\r\n  :?towerperc<=75\r\n    background.color=#565656\r\n    background.frame=1\r\n  :\r\n    background.color=#565656\r\n    background.frame=0\r\n//-~-Player-~-\\\\\r\nfunc PlayerStart()\r\n  player=uiAA(playerasci)\r\n  player.anchor=bottom_left\r\n  player.dock=bottom_left\r\n  player.x=10\r\n  player.y=-1\r\n\r\nfunc Reload()\r\n  ?reloaded=true\r\n    ArrowLevel()\r\n    reloaded=false\r\n  ?equipped=\"basic\"\r\n    reloadtime=30-speedlvl  //10 levels, -1 frame per\r\n    ?reloadtime-reloadtimer<=5\r\n      player.frame=2\r\n    :?reloadtime-reloadtimer<=10\r\n      player.frame=1\r\n    :?reloadtime-reloadtimer>=25-speedlvl\r\n      player.frame=3\r\n    :\r\n      player.frame=0\r\n  :?equipped=\"heavy\"\r\n    reloadtime=45\r\n    player.frame=1\r\n  :?equipped=\"repeater\"\r\n    reloadtime=15\r\n    player.frame=2\r\n  ?CheckDebuff(\"player\",level,\"slow\")\r\n    reloadtime=reloadtime+10\r\n  ?reloaded=false\r\n    reloadtimer++\r\n    ?x2speed\r\n      reloadtimer++\r\n  ?reloadtimer>=reloadtime\r\n    reloaded=true\r\n    reloadtimer=0\r\n\r\nfunc LevelMove()\r\n  ?level=1\r\n    player.y=-1\r\n    arrowy=-3\r\n    //player.color=#cyan\r\n  :?level=2\r\n    player.y=-7\r\n    arrowy=-9\r\n    //player.color=#white\r\n  :?level=3\r\n    player.y=-13\r\n    arrowy=-15\r\n    //player.color=#white\r\n  armorpnl.y=player.y\r\n\r\nfunc Forcefield()\r\n  forcefield=uiAA(field)\r\n  forcefield.anchor=top_left\r\n  forcefield.dock=top_left\r\n  forcefield.x=0\r\n  forcefield.y=0\r\n  forcefield.color=#FF00FF\r\n  armortxt=uiAT()\r\n  armortxt.anchor=top_left\r\n  armortxt.dock=top_left\r\n  armortxt.w=9\r\n  armortxt.x=0\r\n  armortxt.y=2\r\n  armortxt.color=#808080\r\n  armortxt.text=currentarmor+\"/\"+armormax\r\n  armortxt.align=\"center\"\r\n  armorpnl=uiAP()\r\n  armorpnl.anchor=bottom_left\r\n  armorpnl.dock=bottom_left\r\n  armorpnl.h=6\r\n  armorpnl.x=20\r\n  armorpnl.y=player.y\r\n  armorpnl.style=invis\r\n  armorpnl.Add(forcefield)\r\n  armorpnl.Add(armortxt)\r\n  armorpnl.visible=false\r\n\r\nfunc FieldUpdate()\r\n  armortxt.text=currentarmor+\"/\"+armormax\r\n  armorperc=(currentarmor*100)/armormax\r\n  armorpnl.visible=true\r\n  ?armorperc=0\r\n    armorpnl.visible=false\r\n  :?armorperc<=25\r\n    forcefield.color=#3a003a\r\n  :?armorperc<=50\r\n    forcefield.color=#7b007b\r\n  :?armorperc<=75\r\n    forcefield.color=#c500c5\r\n  :\r\n    forcefield.color=#ff00ff\r\n//-~-Arrows-~-\\\\\r\nfunc CreateArrow()\r\n  var arrow = uiAA(arrow)\r\n  arrow.anchor = bottom_left\r\n  arrow.dock = bottom_left\r\n  arrow.x = 14\r\n  arrow.y = arrowy\r\n  arrow.Play()\r\n  arrow.duration = 5\r\n  arrow.loop = true\r\n  var damage = 0+damagelvl\r\n  var pierce=0\r\n  return [arrow,damage,pierce]\r\n\r\nfunc ArrowLevel()\r\n  arrows[level-1].Add(CreateArrow())\r\n  play crossbow_cast\r\n\r\nfunc MoveArrow(arrow)\r\n  arrow[0].x=arrow[0].x+1\r\n  ?arrow[0].x>=sw\r\n    return true\r\n  return false\r\n\r\nfunc RunArrows()\r\n  ?(gametime%2=0|x2speed&gametime%2=1) & arrows.Count()>0\r\n    for RowList = 0..arrows.Count()-1\r\n      ?arrows[RowList].Count() > 0\r\n        for Arrow : arrows[RowList]\r\n          ?MoveArrow(Arrow)\r\n            DeleteList.Add(RowList)\r\n            Arrow[0].Recycle()\r\n          //?RowList=0\r\n          //  Arrow[0].color=#yellow\r\n    ?DeleteList.Count()>0 \r\n      for Row : DeleteList\r\n        arrows[Row].RemoveAt(0)\r\n      DeleteList.Clear()\r\n//-~-Foes-~-\\\\\r\nfunc CreateFoe(foetype,foehp,speed,duration,x,y,ftype)\r\n  var gfoe = uiAA(foetype)\r\n  gfoe.anchor = bottom_left\r\n  gfoe.dock = bottom_left\r\n  gfoe.x = x\r\n  gfoe.y = y\r\n  gfoe.Play()\r\n  gfoe.duration = duration\r\n  gfoe.loop = true\r\n  var fhp = foehp*multiplier\r\n  return [gfoe,fhp,speed,[],[],ftype] //[3] is debuffs, [4] is buffs\r\n\r\nfunc MoveFoe(foe,RowList)\r\n  ?foe[5]=\"melee\"\r\n    ?gametime%foe[2]=0|x2speed&gametime%foe[2]=1\r\n      foe[0].x=foe[0].x-1\r\n    ?foe[0].x<=20\r\n      towerhp=towerhp-(multiplier/difficulty)\r\n      TowerHpUpdate()\r\n      play grappling_hit\r\n      return true\r\n  :?foe[5]=\"ranged\"\r\n    ?gametime%foe[2]=0|x2speed&gametime%foe[2]=1\r\n      ?foe[0].x>50\r\n        foe[0].x=foe[0].x-1\r\n    ?gametime%(foe[2]*10)=0|x2speed&gametime%(foe[2]*10)=1\r\n      projectiles[RowList].Add(CreateProjectile(cannonball,RowList+1,\"damage:1\",5,1,foe[0].x,foe[0].y))\r\n  return false\r\n\r\nfunc FoeCollision(foe,leadArrow,RowList)\r\n  ?leadArrow[0].x > foe[0].x\r\n    critRng=rng\r\n    bleedRng=rng\r\n    ?critRng>=0&critRng<=critChance\r\n      foe[1]=foe[1]-(leadArrow[1]*critDamage)\r\n      effects.Add(Crit(leadArrow[1]*critDamage,foe[0].x,foe[0].y))\r\n    :\r\n      foe[1]=foe[1]-leadArrow[1]\r\n    ?foe[1]<=0\r\n      pierceRng=rng\r\n      ?pierceRng>=0&pierceRng<=pierceChance&leadArrow[2]<piercemaxlvl\r\n        Coins()\r\n        score=score+5*multiplier\r\n        leadArrow[2]=leadArrow[2]+1\r\n      :\r\n        leadArrow[0].Recycle()\r\n        arrows[RowList].RemoveAt(0)\r\n        Coins()\r\n        score=score+5*multiplier\r\n      return true\r\n    :\r\n      ?bleedRng>=0&bleedRng<=bleedChance\r\n        ?CheckDebuff(\"foe\",foe,\"bleed\")\r\n          //foe[3][count2][1]=foe[3][count2][1]+1\r\n          foe[3][count2][2]=foe[3][count2][2]+bleedDuration/3\r\n          count2=0\r\n        :\r\n          foe[3].Add([\"bleed\",1,bleedDuration])\r\n      leadArrow[0].Recycle()\r\n      arrows[RowList].RemoveAt(0)\r\n      return false\r\n  :\r\n    return false\r\n\r\nfunc RunFoes()\r\n  ?foes.Count()>0\r\n    for RowList = 0..foes.Count()-1\r\n      ?foes[RowList].Count() > 0\r\n        for Foe : foes[RowList]\r\n          //?RowList=0\r\n          //  Foe[0].color=#red\r\n          ?MoveFoe(Foe,RowList)\r\n            DeleteList.Add([RowList,count])\r\n            Foe[0].Recycle()\r\n          :?arrows[RowList].Count()>0\r\n            leadArrow=arrows[RowList][0]\r\n            ?FoeCollision(Foe,leadArrow,RowList)\r\n              DeleteList.Add([RowList,count])\r\n              Foe[0].Recycle()\r\n              play mosquito_death\r\n          DebuffsF(Foe)\r\n          ?CheckDebuff(\"foe\",Foe,\"bleed\")&Foe[1]>0\r\n            ?Foe[5]=\"small\"\r\n              >`@Foe[0].x+1@,@Foe[0].y-2+screen.h@,#red,@bleedeffect@\r\n            :?Foe[5]=\"med\"\r\n              >`@Foe[0].x+3@,@Foe[0].y-3+screen.h@,#red,@bleedeffect@\r\n            :?Foe[5]=\"large\"\r\n              >`@Foe[0].x+3@,@Foe[0].y-3+screen.h@,#red,@bleedeffect@\r\n            ?gametime%15=0|x2speed&gametime%15=1\r\n              Foe[1]=Foe[1]-Foe[3][count2][1]*bleedDmg\r\n            ?Foe[1]<=0\r\n              DeleteList.Add([RowList,count])\r\n              Foe[0].Recycle()\r\n              play mosquito_death\r\n            count2=0\r\n          count++\r\n        count=0\r\n    ?DeleteList.Count()>0\r\n      for Row : DeleteList\r\n        foes[Row[0]].Emplace(Row[1],0)\r\n      for Row : DeleteList\r\n        remove=foes[Row[0]].IndexOf(0)\r\n        foes[Row[0]].RemoveAt(remove)\r\n      DeleteList.Clear()\r\n//-Projectiles-\\\\\r\nfunc CreateProjectile(projectiletype,lvl,debuff,speed,duration,x,y)\r\n  var projectile = uiAA(projectiletype)\r\n  projectile.anchor = bottom_left\r\n  projectile.dock = bottom_left\r\n  projectile.x = x\r\n  projectile.y = y\r\n  projectile.Play()\r\n  projectile.duration = duration\r\n  projectile.loop = true\r\n  var debuff = debuff\r\n  var fspeed = speed\r\n  var level = lvl\r\n  return [projectile,debuff,speed,level]\r\n\r\nfunc MoveProjectile(P)\r\n  ?gametime%P[2]=0|x2speed&gametime%P[2]=1\r\n    P[0].x=P[0].x-1\r\n  ?P[0].x<=20\r\n    ?currentarmor>0&P[3]=level\r\n      currentarmor--\r\n      FieldUpdate()\r\n    :?P[1]=\"damage\"\r\n      debuffeffect=string.Split(P[1],\"damage:\",true)\r\n      stack=int.Parse(debuffeffect[0])\r\n      towerhp=towerhp-(stack*multiplier/difficulty)\r\n      TowerHpUpdate()\r\n      play grappling_hit\r\n    :?P[1]=\"slow\"\r\n      debuffeffect=string.Split(P[1],\"slow\",\":\",true)\r\n      stack=int.Parse(debuffeffect[0])\r\n      duration=int.Parse(debuffeffect[1])\r\n      ?CheckDebuff(\"player\",P[3],\"slow\")\r\n        //debuffsP[P[3]-1][count][1]=debuffsP[P[3]-1][count][1]+stack\r\n        debuffsP[P[3]-1][count][2]=debuffsP[P[3]-1][count][2]+duration/3\r\n        count=0\r\n      :\r\n        debuffsP[P[3]-1].Add([\"slow\",stack,duration])\r\n      play spider_eggs_spawn\r\n    return true\r\n  return false\r\n\r\nfunc RunProjectiles()\r\n  ?projectiles.Count()>0\r\n    for RowList = 0..projectiles.Count()-1\r\n      ?projectiles[RowList].Count() > 0\r\n        for P : projectiles[RowList]\r\n          ?MoveProjectile(P)\r\n            DeleteList.Add([RowList,count])\r\n            P[0].Recycle()\r\n          count++\r\n        count=0\r\n    ?DeleteList.Count()>0\r\n      for Row : DeleteList\r\n        projectiles[Row[0]].Emplace(Row[1],0)\r\n      for Row : DeleteList\r\n        remove=projectiles[Row[0]].IndexOf(0)\r\n        projectiles[Row[0]].RemoveAt(remove)\r\n      DeleteList.Clear()\r\n//-Pickups-\\\\\r\nfunc CreatePickup(pickuptype,speed,duration,x,y)\r\n  var gpickup = uiAA(pickuptype)\r\n  gpickup.anchor = bottom_left\r\n  gpickup.dock = bottom_left\r\n  gpickup.x = x\r\n  gpickup.y = y\r\n  gpickup.Play()\r\n  gpickup.duration = duration\r\n  gpickup.loop = true\r\n  return [gpickup,speed]\r\n\r\nfunc MovePickup(P)\r\n  ?gametime%P[1]=0|x2speed&gametime%P[1]=1\r\n    P[0].y=P[0].y+1\r\n  ?P[0].y=0\r\n    return true\r\n  for RowList = 0..foes.Count()-1\r\n    ?foes[RowList].Count() > 0\r\n      for Foe : foes[RowList]\r\n        ?Foe[0].y<=P[0].y&Foe[0].y>=P[0].y-3\r\n          ?Foe[0].x>=P[0].x&Foe[0].x<=P[0].x+4\r\n            Foe[2]=Foe[2]-2\r\n            ?Foe[2]<=10\r\n              Foe[2]=10\r\n            return true\r\n  return false\r\n\r\nfunc RunPickups()\r\n  ?pickups.Count()>0\r\n    for P : pickups\r\n      ?MovePickup(P)\r\n        DeleteList.Add(count)\r\n        P[0].Recycle()\r\n      count++\r\n    count=0\r\n    ?DeleteList.Count()>0\r\n      for D : DeleteList\r\n        pickups.Emplace(D,0)\r\n      for D : DeleteList\r\n        remove=pickups.IndexOf(0)\r\n        pickups.RemoveAt(remove)\r\n      DeleteList.Clear()\r\n//-Bosses-\\\\\r\nfunc BossHPtxt()\r\n  bosshptxt=uiAT()\r\n  bosshptxt.anchor=top_right\r\n  bosshptxt.dock=top_right\r\n  bosshptxt.x=0\r\n  bosshptxt.y=3\r\n  bosshptxt.w=25\r\n  bosshptxt.align=\"right\"\r\n  bosshptxt.color=#FF0000\r\n  bosshptxt.text=\"\"\r\n\r\nfunc BossHealth()\r\n  perc=(bosses[0][1]*100)/bosses[0][2]\r\n  temp=math.FloortoInt(perc*25/100)\r\n  bossBar=\"\"\r\n  for i = 0..temp-1\r\n    ?temp ! 0\r\n      bossBar=\"█\"+bossBar\r\n/*\r\n  ?perc>=4\r\n    temp=math.FloortoInt(temp)\r\n    for i = 0..temp-2\r\n      bossBar=\"█\"+bossBar\r\n*/\r\n  ?perc%4=3\r\n    bossBar=\"▓\"+bossBar\r\n  :?perc%4=2\r\n    bossBar=\"▒\"+bossBar\r\n  :?perc%4=1\r\n    bossBar=\"░\"+bossBar\r\n  bosshptxt.text=bosses[0][1]+\"/\"+bosses[0][2]+\" \"+te.xt(bossAI)+\"\\n\"+bossBar\r\n\r\nfunc CreateBoss(bosstype,size)\r\n  var boss = uiAA(bosstype)\r\n  boss.anchor = bottom_left\r\n  boss.dock = bottom_left\r\n  boss.x = sw\r\n  boss.y = -12\r\n  var bosshp = 50*multiplier\r\n  var bossmaxhp = 50*multiplier\r\n  var size = size\r\n  var debuff = []\r\n  return [boss,bosshp,bossmaxhp,size,debuff]\r\n\r\nfunc SpawnBoss()\r\n  ?location=1 //Forest\r\n    bosses.Add(CreateBoss(queenbee,single))\r\n    bossAI=\"QueenBee\"\r\n  :?location=2 //Volcano\r\n    bosses.Add(CreateBoss(copter,single))\r\n    bossAI=\"ControllerCopter\"\r\n\r\nfunc CheckBossCollisions(size)\r\n  for a = 0..2\r\n    ?arrows[a].Count() > 0\r\n      ?size=\"all\"\r\n        ?arrows[a][0][0].x >= bosses[0][0].x\r\n          critRng=rng\r\n          ?critRng>=0&critRng<=critChance\r\n            bosses[0][1]=bosses[0][1]-(arrows[a][0][1]*critDamage)\r\n            effects.Add(Crit(arrows[a][0][1]*critDamage,bosses[0][0].x,bosses[0][0].y))\r\n          :\r\n            bosses[0][1]=bosses[0][1]-arrows[a][0][1]\r\n          arrows[a][0][0].Recycle()\r\n          arrows[a].RemoveAt(0)\r\n      :?size=\"single\"\r\n        ?arrows[a][0][0].x > bosses[0][0].x & a=bosslvl-1\r\n          critRng=rng\r\n          ?critRng>=0&critRng<=critChance\r\n            bosses[0][1]=bosses[0][1]-(arrows[a][0][1]*critDamage)\r\n            effects.Add(Crit(arrows[a][0][1]*critDamage,bosses[0][0].x,bosses[0][0].y))\r\n          :\r\n            bosses[0][1]=bosses[0][1]-arrows[a][0][1]\r\n          ?bleedRng>=0&bleedRng<=bleedChance\r\n            ?CheckDebuff(\"boss\",bosses,\"bleed\")\r\n              bosses[0][4][count][1]=bosses[0][4][count][1]+1\r\n              bosses[0][4][count][2]=bosses[0][4][count][2]+bleedDuration/3\r\n              count2=0\r\n            :\r\n              bosses[0][4].Add([\"bleed\",1,bleedDuration])\r\n          ?bosses[0][1]<=0\r\n            pierceRng=rng\r\n            ?pierceRng>=0&pierceRng<=pierceChance\r\n              Coins()\r\n            :\r\n              arrows[a][0][0].Recycle()\r\n              arrows[a].RemoveAt(0)\r\n              Coins()\r\n          :\r\n            arrows[a][0][0].Recycle()\r\n            arrows[a].RemoveAt(0)\r\n  ?bosses[0][1]>0\r\n    DebuffsB(bosses)\r\n    ?CheckDebuff(\"boss\",bosses,\"bleed\")\r\n      //?bossAI=\"QueenBee\"\r\n      >`@bosses[0][0].x+6@,@bosses[0][0].y-4+screen.h@,#red,@bleedeffect@\r\n      ?gametime%15=0|x2speed&gametime%15=1\r\n        bosses[0][1]=bosses[0][1]-bosses[0][4][count][1]*bleedDmg\r\n      count2=0\r\n  BossHealth()\r\n  ?bosses[0][1]<=0\r\n    bosslvl=3\r\n    bosses[0][0].Recycle()\r\n    bosses.RemoveAt(0)\r\n    coins=coins+25\r\n    bosshptxt.text=\"\"\r\n    score=score+25*multiplier\r\n    play scorpion_death\r\n    ?bosslayer\r\n      bosslayer.Recycle()\r\n  :?bosses[0][0].x<=20\r\n    bosslvl=3\r\n    towerhp=towerhp-perc*(multiplier/difficulty)\r\n    TowerHpUpdate()\r\n    bosses[0][0].Recycle()\r\n    bosses.RemoveAt(0)\r\n    coins=coins+25\r\n    bosshptxt.text=\"\"\r\n    play bomb_cart_explosion\r\n    ?bosslayer\r\n      bosslayer.Recycle()\r\n\r\nfunc RunBoss()\r\n  ?bossAI=\"QueenBee\"\r\n    QueenBee()\r\n  :?bossAI=\"ControllerCopter\"\r\n    ControllerCopter()\r\n//QueenBee\\\\\r\nfunc QueenBee()\r\n  ?bosses[0][0].x>55&(gametime%15=0|x2speed&gametime%15=1)\r\n    bosses[0][0].x=bosses[0][0].x-1\r\n  ?gametime%90=0|x2speed&gametime%90=1\r\n    moverng=rng\r\n    ?moverng%5=0\r\n      ?moverng>=4999&bosslvl<3\r\n        bosslvl++\r\n      :?moverng<4999&bosslvl>1\r\n        bosslvl--\r\n      ?bosslvl=1\r\n        bosses[0][0].y=0\r\n      :?bosslvl=2\r\n        bosses[0][0].y=-6\r\n      :?bosslvl=3\r\n        bosses[0][0].y=-12\r\n    :?moverng%5=1\r\n      attack=\"spit\"\r\n    :?moverng%5=2\r\n      attack=\"sting\"\r\n    :?moverng%5=3\r\n      spawncount=0\r\n      attack=\"spawn\"\r\n  QueenAttack()\r\n  ?spawncount<5&(gametime%15=0|x2speed&gametime%15=1)\r\n    foeyrng=rng\r\n    ?bosslvl=1\r\n      ?foeyrng>=0&foeyrng<=2499\r\n        foey=-2\r\n      :?foeyrng>=2500&foeyrng<=4999\r\n        foey=-3\r\n      :?foeyrng>=5000&foeyrng<=7499\r\n        foey=-4\r\n      :\r\n        foey=-5\r\n    :?bosslvl=2\r\n      ?foeyrng>=0&foeyrng<=2499\r\n        foey=-8\r\n      :?foeyrng>=2500&foeyrng<=4999\r\n        foey=-9\r\n      :?foeyrng>=5000&foeyrng<=7499\r\n        foey=-10\r\n      :\r\n        foey=-11\r\n    :?bosslvl=3\r\n      ?foeyrng>=0&foeyrng<=2499\r\n        foey=-14\r\n      :?foeyrng>=2500&foeyrng<=4999\r\n        foey=-15\r\n      :?foeyrng>=5000&foeyrng<=7499\r\n        foey=-16\r\n      :\r\n        foey=-17\r\n    foes[bosslvl-1].Add(CreateFoe(bee,1,5,5,sw,foey,\"melee\"))\r\n    spawncount++\r\n\r\nfunc QueenAttack()\r\n  ?attack=\"idle\"\r\n    ?gametime%8=0|gametime%8=1\r\n      bosses[0][0].frame=0\r\n    :?gametime%8=2|gametime%8=3\r\n      bosses[0][0].frame=1\r\n    :?gametime%8=4|gametime%8=5\r\n      bosses[0][0].frame=2\r\n    :?gametime%8=6|gametime%8=7\r\n      bosses[0][0].frame=3\r\n  :?attack=\"spit\"\r\n    ?animtime=0\r\n      animtime=3\r\n    :?gametime%10=0|x2speed&gametime%10=1\r\n      animtime--\r\n      ?animtime=3|animtime=1\r\n        bosses[0][0].frame=4\r\n      :?animtime=2\r\n        bosses[0][0].frame=5\r\n        projectiles[bosslvl-1].Add(CreateProjectile(spit,bosslvl,\"slow:1:150\",5,1,bosses[0][0].x,bosses[0][0].y-5))\r\n      :?animtime=0\r\n        attack=\"idle\"\r\n  :?attack=\"sting\"\r\n    ?animtime=0\r\n      animtime=3\r\n    :?gametime%10=0|x2speed&gametime%10=1\r\n      animtime--\r\n      ?animtime=3|animtime=1\r\n        bosses[0][0].frame=6\r\n      :?animtime=2\r\n        bosses[0][0].frame=7\r\n        projectiles[bosslvl-1].Add(CreateProjectile(stinger,bosslvl,\"damage:1\",5,1,bosses[0][0].x,bosses[0][0].y-1))\r\n      :?animtime=0\r\n        attack=\"idle\"\r\n  :?attack=\"spawn\"\r\n    ?animtime=0\r\n      animtime=5\r\n    :?gametime%10=0|x2speed&gametime%10=1\r\n      animtime--\r\n      ?animtime=5|animtime=1\r\n        bosses[0][0].frame=8\r\n      :?animtime=4\r\n        bosses[0][0].frame=9\r\n      :?animtime=3\r\n        bosses[0][0].frame=10\r\n      :?animtime=2\r\n        bosses[0][0].frame=11\r\n      :?animtime=0\r\n        attack=\"idle\"\r\n//ControllerCopter\\\\\r\nfunc ControllerCopter()\r\n  ?bosses[0][0].x>55&(gametime%15=0|x2speed&gametime%15=1)\r\n    bosses[0][0].x=bosses[0][0].x-1\r\n  ?gametime%90=0|x2speed&gametime%90=1\r\n    moverng=rng\r\n    ?moverng%5=0\r\n      ?moverng>=4999&bosslvl<3\r\n        bosslvl++\r\n      :?moverng<4999&bosslvl>1\r\n        bosslvl--\r\n      ?bosslvl=1\r\n        bosses[0][0].y=0\r\n      :?bosslvl=2\r\n        bosses[0][0].y=-6\r\n      :?bosslvl=3\r\n        bosses[0][0].y=-12\r\n    :?moverng%5=1\r\n      ?perc>50\r\n        spawncount=0\r\n        //attack=\"missles\"\r\n    :?moverng%5=2\r\n      ?perc<=50\r\n        attack=\"crossbow\"\r\n    :?moverng%5=3\r\n      pickups.Add(CreatePickup(crate,30,1,bosses[0][0].x+15,bosses[0][0].y+2))\r\n      //attack=\"drop\"\r\n  ?perc<=25&(gametime%30=0|x2speed&gametime%30=1)\r\n    bosses[0][0].x=bosses[0][0].x-1\r\n  ?perc<=50\r\n    ?variable=false\r\n      bosslayer=uiAA(controller)\r\n      bosslayer.anchor = bottom_left\r\n      bosslayer.dock = bottom_left\r\n      bosslayer.x = bosses[0][0].x+13\r\n      bosslayer.y = bosses[0][0].y-1\r\n      variable=true\r\n    :\r\n      bosslayer.x = bosses[0][0].x+13\r\n      bosslayer.y = bosses[0][0].y-1\r\n  CopterAttack()\r\n  ?spawncount<3&(gametime%15=0|x2speed&gametime%15=1)\r\n    foeyrng=rng\r\n    ?bosslvl=1\r\n      ?foeyrng%2=0\r\n        foey=0\r\n      :?foeyrng%2=1\r\n        foey=-1\r\n    :?bosslvl=2\r\n      ?foeyrng%2=0\r\n        foey=-6\r\n      :?foeyrng%2=1\r\n        foey=-7\r\n    :?bosslvl=3\r\n      ?foeyrng%2=0\r\n        foey=-12\r\n      :?foeyrng%2=1\r\n        foey=-13\r\n    foes[bosslvl-1].Add(CreateFoe(missle,1,5,10,bosses[0][0].x+6,foey,\"melee\"))\r\n    spawncount++\r\n\r\nfunc CopterAttack()\r\n  ?perc>50\r\n    ?gametime%12>=0&gametime%12<=2\r\n      bosses[0][0].frame=0\r\n    :?gametime%12>=3&gametime%12<=5\r\n      bosses[0][0].frame=1\r\n    :?gametime%12>=6&gametime%12<=8\r\n      bosses[0][0].frame=2\r\n    :?gametime%12>=9&gametime%12<=11\r\n      bosses[0][0].frame=3\r\n  :\r\n    ?gametime%12>=0&gametime%12<=2\r\n      bosses[0][0].frame=4\r\n    :?gametime%12>=3&gametime%12<=5\r\n      bosses[0][0].frame=5\r\n    :?gametime%12>=6&gametime%12<=8\r\n      bosses[0][0].frame=6\r\n    :?gametime%12>=9&gametime%12<=11\r\n      bosses[0][0].frame=7\r\n  ?attack=\"crossbow\"\r\n    ?animtime=0\r\n      animtime=4\r\n    :?gametime%10=0|x2speed&gametime%10=1\r\n      animtime--\r\n      ?animtime=3\r\n        bosslayer.frame=1\r\n      :?animtime=2\r\n        bosslayer.frame=2\r\n      :?animtime=1\r\n        bosslayer.frame=3\r\n        projectiles[bosslvl-1].Add(CreateProjectile(farrow,bosslvl,\"damage:1\",5,1,bosses[0][0].x+13,bosses[0][0].y-3))\r\n      :?animtime=0\r\n        bosslayer.frame=0\r\n        attack=\"idle\"\r\n//-~-WaveController-~-\\\\\r\nfunc Reroll()\r\n  ?frng=\"flevel\"\r\n    foelevelrng=rng\r\n    FoeLevel()\r\n  :?frng=\"fy\"\r\n    foeyrng=rng\r\n    FoeY()\r\n  :?frng=\"ftype\"\r\n    foetyperng=rng\r\n    FoeType()\r\n\r\nfunc FoeLevel()\r\n  ?foelevelrng>=0&foelevelrng<=2999\r\n    foelevel=1\r\n  :?foelevelrng>=3000&foelevelrng<=5999\r\n    foelevel=2\r\n  :?foelevelrng>=6000&foelevelrng<=8999\r\n    foelevel=3\r\n  :\r\n    frng=\"flevel\"\r\n    Reroll()\r\n\r\nfunc FoeY()\r\n  ?foelevel=1\r\n    ?foeyrng>=0&foeyrng<=2499\r\n      foey=-2\r\n    :?foeyrng>=2500&foeyrng<=4999\r\n      foey=-3\r\n    :?foeyrng>=5000&foeyrng<=7499\r\n      foey=-4\r\n    :\r\n      foey=-5\r\n  :?foelevel=2\r\n    ?foeyrng>=0&foeyrng<=2499\r\n      foey=-8\r\n    :?foeyrng>=2500&foeyrng<=4999\r\n      foey=-9\r\n    :?foeyrng>=5000&foeyrng<=7499\r\n      foey=-10\r\n    :\r\n      foey=-11\r\n  :?foelevel=3\r\n    ?foeyrng>=0&foeyrng<=2499\r\n      foey=-14\r\n    :?foeyrng>=2500&foeyrng<=4999\r\n      foey=-15\r\n    :?foeyrng>=5000&foeyrng<=7499\r\n      foey=-16\r\n    :\r\n      foey=-17\r\n\r\nfunc FoeType()\r\n  ?foetyperng%7=0|foetyperng%7=1\r\n    foetype=\"mfoe\"\r\n  :?foetyperng%7=2|foetyperng%7=3\r\n    foetype=\"sfoe\"\r\n  :?foetyperng%7=4|foetyperng%7=5\r\n    foetype=\"lfoe\"\r\n  :?location=2 //Volcano\r\n    foetype=\"rfoe\"  //Ranged foe\r\n  :\r\n    frng=\"ftype\"\r\n    Reroll()\r\n\t\t\r\nfunc FoeRNG()\r\n  foelevelrng=rng\r\n  foeyrng=rng\r\n  foetyperng=rng\r\n\r\nfunc SpawnRate()\r\n  ?spawnrate>90\r\n    spawnrate=spawnrate-15\r\n  :?spawnrate>30&spawnrate<=90\r\n    spawnrate=spawnrate-5\r\n  :?spawnrate>5&spawnrate<=30\r\n    spawnrate=spawnrate-1\r\n\t  \r\nfunc SpawnFoe()\r\n  ?location=1 //Forest\r\n    ?foetype=\"sfoe\"\r\n      foes[foelevel-1].Add(CreateFoe(bee,1,5,5,sw,foey,\"melee small\"))\r\n    :?foetype=\"mfoe\"\r\n      foes[foelevel-1].Add(CreateFoe(wasp,2,10,5,sw,foey,\"melee med\"))\r\n    :?foetype=\"lfoe\"\r\n      foes[foelevel-1].Add(CreateFoe(hornet,4,15,5,sw,foey,\"melee large\"))\r\n  :?location=2 //Volcano\r\n    ?foetype=\"sfoe\"\r\n      foes[foelevel-1].Add(CreateFoe(missle,1,5,10,sw,foey,\"melee small\"))\r\n    :?foetype=\"mfoe\"\r\n      foes[foelevel-1].Add(CreateFoe(mineflyer,2,10,10,sw,foey,\"melee med\"))\r\n    :?foetype=\"lfoe\"\r\n      foes[foelevel-1].Add(CreateFoe(rocket,4,15,10,sw,foey,\"melee large\"))\r\n    :?foetype=\"rfoe\"\r\n      foes[foelevel-1].Add(CreateFoe(heli,2,15,10,sw,foey,\"ranged med\"))\r\n\r\nfunc WaveController()\r\n  maxfoe=5+(wave%10)+(threat*difficulty)\r\n  ?wave%10=0&bossalive!true\r\n    SpawnBoss()\r\n    bossalive=true\r\n  ?foecount<maxfoe|bosses.Count()>0\r\n    ?bossalive\r\n      ?gametime%(spawnrate*2)=0|x2speed&gametime%(spawnrate*2)=1\r\n        FoeRNG()\r\n        FoeType()\r\n        FoeLevel()\r\n        FoeY()\r\n        SpawnFoe()\r\n        foecount++\r\n    :?gametime%spawnrate=0|x2speed&gametime%spawnrate=1\r\n      FoeRNG()\r\n      FoeType()\r\n      FoeLevel()\r\n      FoeY()\r\n      SpawnFoe()\r\n      foecount++\r\n  :?foes[0].Count()=0&foes[1].Count()=0&foes[2].Count()=0&bosses.Count()=0\r\n    foecount=0\r\n    bossalive=false\r\n    score=score+wave*5\r\n    ?wave%10=0\r\n      threat++\r\n      multiplier=multiplier*2*difficulty\r\n      SpawnRate()\r\n    wave++\r\n//-~-Effects-~-\\\\\r\nfunc Effects()\r\n  ?effects.Count()>0\r\n    for E : effects\r\n      E[1]=E[1]-1\r\n      ?E[1]<=0\r\n        E[0].Recycle()\r\n        DeleteList.Add([count])\r\n      count++\r\n    count=0\r\n    ?DeleteList.Count()>0\r\n      for Row : DeleteList\r\n        effects.Emplace(Row[0],0)\r\n      for Row : DeleteList\r\n        remove=effects.IndexOf(0)\r\n        effects.RemoveAt(remove)\r\n      DeleteList.Clear()\r\n\r\nfunc Crit(damage,x,y)\r\n  var crit=uiAT()\r\n  crit.anchor = bottom_left\r\n  crit.dock = bottom_left\r\n  crit.color=#red\r\n  crit.text=\"\"+damage\r\n  crit.x=x+1\r\n  crit.y=y\r\n  return [crit,15]\r\n//-Debuffs-\\\\\r\nfunc CheckDebuff(source,victim,debuff)\r\n  ?source=\"boss\"\r\n    ?victim[0][4].Count()>0\r\n      for D : victim[0][4]\r\n        ?D.Contains(debuff)\r\n          return true\r\n        :\r\n          count2++\r\n      count2=0\r\n  :?source=\"foe\"\r\n    ?victim[3].Count()>0\r\n      for D : victim[3]\r\n        ?D.Contains(debuff)\r\n          return true\r\n        :\r\n          count2++\r\n      count2=0\r\n  :?source=\"player\"\r\n    ?debuffsP[victim-1].Count()>0\r\n      for D : debuffsP[victim-1]\r\n        ?D.Contains(debuff)\r\n          return true\r\n        :\r\n          count++\r\n      count=0\r\n  return false\r\n\r\nfunc DebuffsF(foe)\r\n  ?foe[3].Count()>0\r\n     for debuff : foe[3]\r\n       debuff[2]=debuff[2]-1\r\n       ?debuff[2]<=0\r\n         DeleteList2.Add([count2])\r\n       count2++\r\n     count2=0\r\n  ?DeleteList2.Count()>0\r\n    for Row : DeleteList2\r\n      foe[3].Emplace(Row[0],0)\r\n    for Row : DeleteList2\r\n      remove=foe[3].IndexOf(0)\r\n      foe[3].RemoveAt(remove)\r\n    DeleteList2.Clear()\r\n\r\nfunc DebuffsB(bosses)\r\n  ?bosses[0][4].Count()>0\r\n     for debuff : bosses[0][4]\r\n       debuff[2]=debuff[2]-1\r\n       ?debuff[2]<=0\r\n         DeleteList2.Add([count2])\r\n       count2++\r\n     count2=0\r\n  ?DeleteList2.Count()>0\r\n    for Row : DeleteList2\r\n      bosses[0][4].Emplace(Row[0],0)\r\n    for Row : DeleteList2\r\n      remove=bosses[0][4].IndexOf(0)\r\n      bosses[0][4].RemoveAt(remove)\r\n    DeleteList2.Clear()\r\n\r\nfunc Debuffs()\r\n  ?debuffsP.Count()>0\r\n    for L = 0..2\r\n      ?debuffsP[L].Count()>0\r\n        for debuff : debuffsP[L]\r\n          debuff[2]=debuff[2]-1\r\n          ?debuff[2]<=0\r\n            DeleteList.Add([L,count])\r\n          count++\r\n          >`21,@(screen.h-2)-L*6@,#yellow,@te.xt(debuff[0])@,@debuff[1]@,@debuff[2]@\r\n        count=0\r\n    ?DeleteList.Count()>0\r\n      for Row : DeleteList\r\n        debuffsP[Row[0]].Emplace(Row[1],0)\r\n      for Row : DeleteList\r\n        remove=debuffsP[Row[0]].IndexOf(0)\r\n        debuffsP[Row[0]].RemoveAt(remove)\r\n      DeleteList.Clear()\r\n//-~-Storage-~-\\\\\r\nfunc Save()\r\n  storage.Set(\"coins\",coins)\r\n  storage.Set(\"basic\",basiclvl)\r\n  storage.Set(\"heavy\",heavylvl)\r\n  storage.Set(\"quick\",quicklvl)\r\n  //storage.Set(\"crit\",critlvl)\r\n  //storage.Set(\"pierce\",piercelvl)\r\n\r\n//-~-~-RunGame-~-~-\\\\\r\n//-Main-\\\\\r\n?loc=waterfall\r\n  ?loc.begin\r\n    gamestart=false\r\n    gamerun=false\r\n    highscore=storage.Get(\"highscore\",0)\r\n/*\r\n    coins=storage.Get(\"coins\",0)\r\n    basiclvl=storage.Get(\"basic\",1)\r\n    heavylvl=storage.Get(\"heavy\",0)\r\n    quicklvl=storage.Get(\"quick\",0)\r\n    critlvl=storage.Get(\"crit\",0)\r\n    piercelvl=storage.Get(\"pierce\",0)\r\n*/\r\n    SetUp()\r\n    StartScreen()\r\n  Musictrack()\r\n  ShowDiff()\r\n  ?gamestart=false\r\n    ?shopopen=true\r\n      startpnl.visible=false\r\n    :\r\n      startpnl.visible=true\r\n  ?key=backBegin\r\n    Save()\r\n  ?gamerun=true\r\n    gametime++\r\n    ?x2speed\r\n      gametime++\r\n/*\r\n    ?key=bumpLBegin\r\n      ?equipped=\"basic\"\r\n        equipped=\"heavy\"\r\n      :?equipped=\"heavy\"\r\n        equipped=\"repeater\"\r\n      :?equipped=\"repeater\"\r\n        equipped=\"basic\"\r\n*/\r\n    ?key=upBegin\r\n      level++\r\n    ?key=downBegin\r\n      level--\r\n    ?level<1\r\n      level=1\r\n    ?level>3\r\n      level=3\r\n    ?towerhp<=0\r\n      GameOver()\r\n    ?(gametime%(1000-regenlvl*50)=0|x2speed&gametime%(1000-regenlvl*50)=1)&towerhp<towermaxhp\r\n      towerhp=towerhp+regenlvl\r\n      ?towerhp>towermaxhp\r\n        towerhp=towermaxhp\r\n      TowerHpUpdate()\r\n    ?armorregenlvl>0\r\n      ?(gametime%(1000-armorregenlvl*50)=0|x2speed&gametime%(1000-armorregenlvl*50)=1)&currentarmor<armormax\r\n        currentarmor++\r\n        ?currentarmor>armormax\r\n          currentarmor=armormax\r\n        FieldUpdate()\r\n    WaveController()\r\n    Effects()\r\n    RunArrows()\r\n    RunFoes()\r\n    RunProjectiles()\r\n    RunPickups()\r\n    Debuffs()\r\n    ?bosses.Count()>0\r\n      RunBoss()\r\n      CheckBossCollisions(bosses[0][3])\r\n    LevelMove()\r\n    Reload()\r\n//-Stats-\\\\\r\n  >c-31,-12,©@coins@\r\n  >c8,-12,@te.xt(Score)@:@score@\r\n  >c22,-12,@te.xt(Highscore)@:@highscore@\r\n  >c-20,-12,@te.xt(Wave)@:@wave@\r\n\r\n//-Debug controls-\\\\\r\nvar debug=true\r\n  ?gamerun=true\r\n    ?debug\r\n      ?key=bumpRBegin\r\n        wave++\r\n      ?key=bumpLBegin\r\n        coins=coins+100"

==============================================
Integration Test Results:
  Total:  285
  Passed: 9
  Failed: 276
==============================================

Failed files:
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/DragController.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/BetterText.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/InfoFloat.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/PefWindow.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/LiveSplit.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/FreeChestTracker.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/BossBar.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/MusicBox.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/ScrollText.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/BorderClock.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/OkamiroyUtils.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/CDTime.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/ToolBelt.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/A2S.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/BragMeter.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/FaceHUD.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/StealMeter.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/MiniMap.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/FoeStateTracker.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/RecordPlayer.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/BetterInfo2.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/ClickAbilities.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/damageFlash.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/FancyUI/colour.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/FancyUI/print.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/FancyUI/fancyui.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/PlayerStateTracker.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/VisualStatusEffects.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/Calculator.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/MindstoneButton.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/BossHealthBar.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/UI/ChiselFiles/SetLayer.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Foes/FlowerFoes.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Foes/PallasCrown.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Foes/PumpkinWraith.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Foes/SurferGuardian.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/CavePets.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Bunny.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Skully.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Dragon.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/CatBalloon.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Panda.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Cranius.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/SpringBuddy.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/BlackHole.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/TarPusher.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Dog.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Mushroom.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Spider.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Fly.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/LegsTurkey.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Dracula.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Snowman.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/FoesNoMore.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/RoyaltyDeliverer.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Sun.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Boo.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Wisp.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Snail.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Snake.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Bear.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Chick.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Pomeranian.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/SnowBunny.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Stonehead.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/JackOLantern.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Frog.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Pets/Crab.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Chisel.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/WitchHat.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/Skully.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/SantaHat.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/MushroomHat.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/DefectFaceplate.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/JesterHat.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/Headphones.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/IroncladMask.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/ReindeerHead.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/ShuffleHat.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/StarCloak.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/Treeman.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/SilentSkull.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/DiscoVisor.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/PirateHat.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/LanternTalisman.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/CatHat.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/Enchanthead.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/HrimnirHair.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Hats/Helmet.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Weapons/PsyCrusher.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Weapons/SpellBook.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Weapons/Scythe.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Weapons/MajPack.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Weapons/MajVines.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Weapons/EmbueDaggers.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Weapons/RootBats.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Weapons/LanternTalisman.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Weapons/ShockwaveWhip.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Weapons/RecoilKick.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Weapons/ArmorGenerator.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Pumpkins.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/StoneheadFall.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetFrog.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/CavePets.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Party.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetCranius.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetCrab.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/CatBalloon.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Mech.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PartyNoisemaker.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetJackOLantern.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetMushroom.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Foes/FlowerFoes.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Foes/PallasCrown.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Foes/PumpkinWraith.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Foes/SurferGuardian.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/FireFly.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/SpringBuddy.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Knight.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/BlackHole.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/TarPusher.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Bolesh.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/SpringBloom.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetDog.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/ConfettiHead.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Hats/WitchHat.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Hats/Skully.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Hats/SantaHat.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Hats/MushroomHat.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Hats/Headphones.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Hats/StarCloak.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Hats/DiscoVisor.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Hats/PirateHat.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Hats/LanternTalisman.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Hats/CatHat.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Hats/Helmet.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/MushroomAnt.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Fireworks.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/quips.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetFly.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/SantaFlyingSleigh.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Giftbag.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/TheSun.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetSnail.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/SpookyScarySkeletons.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetChick.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Infected.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Portobello.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/ChristmasTree.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/MushroomHead.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetSun.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/SuperStoneHead.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/MineManager.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PumpkinCarving.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/CultGroup.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetBoo.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/TrainAdventure/Peak.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/TrainAdventure/Bridge.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/TrainAdventure/Snow.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/TrainAdventure/Sleeper.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/TrainAdventure/Mushrooms.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/TrainAdventure/Main.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/TrainAdventure/Deadwood.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/TrainAdventure/DeadwoodStart.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/TrainAdventure/Mountain.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/AcronianGuardian.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Explosion.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Wisp.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/WavyScarf.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/ChrWings.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetSnowman.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetDracula.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/DragonWorm.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetSkully.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetDragon.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Bear.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/TwinSuns.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Pomeranian.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Beach.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetSnowBunny.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/LanternTalisman.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/LegsTurkeyPet.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Acrocorn.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Drill.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetBunny.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetStonehead.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/CaveParty.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/StoneClause.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/StoneHeadless.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/WitchBroom.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/BadApple.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/SillyGoose.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/StonePhone.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetPanda.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/Turret.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/AuroraBorealis.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/SleepyStonehead.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/PetSpider.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Cosmetics/FrogInvasion.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/CozyCave.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Components/Vector.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Components/OVERHAUL.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/cColorTetris.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/cTetris.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Asteroids.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/SwordGame.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Fishing/RodFactory.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Fishing/FishingShop.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Fishing/FishingHUD.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Fishing/FishingProgress.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Fishing/FishFactory.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Fishing/FishingMoney.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Fishing/RodData.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Fishing/FishingGame.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Fishing/ResultsDialog.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Fishing/FishData.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Fishing/FishingLogo.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/FlyupText.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/DigitsPuzzle/CustomPuzzle.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/DigitsPuzzle/DigitsPuzzleCore.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/DigitsPuzzle/PuzzleGenerator.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/DigitsPuzzle/DigitsPuzzleMain.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/DigitsPuzzle/DigitCell.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/GetawayDriver/main.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/GetawayDriver/drawLines.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/2048.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/FeedABat.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/cGomoku.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/SpearThrowing.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/SudokuEnchant/SudokuJamWindow.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/SudokuEnchant/SudokuStore.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/SudokuEnchant/SudokuStart.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/SudokuEnchant/SudokuCoreEn.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/StoneasaurGame.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Stonemon.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Sudoku/SudokuStore.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Sudoku/SudokuStart.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Sudoku/SudokuCore.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/WhackaMole.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Blackjack/Hand.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Blackjack/Card.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Blackjack/Bank.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/PlayingCards.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/FrogJump.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Metallophone.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Snake.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/GrowPlants.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Simon.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/StoneBoxman/StoneBoxmanMain.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/StoneBoxman/MapRawDataObject.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/StoneBoxman/SimpleStack.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/StoneBoxman/MapElement.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/StoneBoxman/Box.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/StoneBoxman/Player.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/StoneBoxman/StoneBoxmanCore.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/StoneBoxman/MapRawData.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/FrogBog.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Stonemon/BattlePhase.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Stonemon/Intro.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Stonemon/GameUIController.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Stonemon/fade.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Stonemon/Art.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Stonemon/bar.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Stonemon/Creatures.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Stonemon/GlobalVars.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Stonemon/InputControl.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/StoneDungeon.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/DigitsPuzzle.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/StoneBoxman.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/BurgerRush.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/SSRPGIdle.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Arena.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Minesweeper.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/Blackjack.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/KillerRPG.txt
  - /Users/kurbezz/Projects/stonescript/stone-script-lsp/test_scripts/Games/TowerDefense.txt

thread 'test_all_scripts_parse' panicked at crates/stonescript-parser/tests/integration_test.rs:72:5:
assertion `left == right` failed: Some test scripts failed to parse
  left: 276
 right: 0
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
test test_all_scripts_parse ... FAILED

failures:

failures:
    test_all_scripts_parse

test result: FAILED. 0 passed; 1 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.12s

error: test failed, to rerun pass `-p stonescript-parser --test integration_test`
